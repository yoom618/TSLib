Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.1927638
	speed: 0.3327s/iter; left time: 6887.8458s
	iters: 200, epoch: 1 | loss: 4.6541395
	speed: 0.3214s/iter; left time: 6620.1359s
Epoch: 1 cost time: 68.21319127082825
Epoch: 1, Steps: 208 | Train Loss: 4.564 Vali Loss: 4.428 Vali Acc: 0.048 Test Loss: 4.428 Test Acc: 0.048
Validation loss decreased (inf --> -0.048271).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5261798
	speed: 0.7759s/iter; left time: 15900.8564s
	iters: 200, epoch: 2 | loss: 3.3302374
	speed: 0.3270s/iter; left time: 6667.9844s
Epoch: 2 cost time: 67.34621024131775
Epoch: 2, Steps: 208 | Train Loss: 3.846 Vali Loss: 4.376 Vali Acc: 0.050 Test Loss: 4.376 Test Acc: 0.050
Validation loss decreased (-0.048271 --> -0.049464).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2332029
	speed: 0.7645s/iter; left time: 15508.6664s
	iters: 200, epoch: 3 | loss: 4.0757008
	speed: 0.3315s/iter; left time: 6691.8076s
Epoch: 3 cost time: 67.39489316940308
Epoch: 3, Steps: 208 | Train Loss: 3.584 Vali Loss: 4.470 Vali Acc: 0.048 Test Loss: 4.470 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7438850
	speed: 0.7506s/iter; left time: 15070.0799s
	iters: 200, epoch: 4 | loss: 4.1220498
	speed: 0.3048s/iter; left time: 6088.5186s
Epoch: 4 cost time: 64.71104884147644
Epoch: 4, Steps: 208 | Train Loss: 3.488 Vali Loss: 4.446 Vali Acc: 0.067 Test Loss: 4.446 Test Acc: 0.067
Validation loss decreased (-0.049464 --> -0.067358).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0960133
	speed: 0.8009s/iter; left time: 15912.7860s
	iters: 200, epoch: 5 | loss: 4.0772128
	speed: 0.3203s/iter; left time: 6331.4913s
Epoch: 5 cost time: 68.05005526542664
Epoch: 5, Steps: 208 | Train Loss: 3.152 Vali Loss: 4.806 Vali Acc: 0.063 Test Loss: 4.806 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6112409
	speed: 0.8156s/iter; left time: 16036.4566s
	iters: 200, epoch: 6 | loss: 2.8713377
	speed: 0.3435s/iter; left time: 6718.9754s
Epoch: 6 cost time: 71.8529543876648
Epoch: 6, Steps: 208 | Train Loss: 3.071 Vali Loss: 4.899 Vali Acc: 0.066 Test Loss: 4.899 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.2713907
	speed: 0.7840s/iter; left time: 15251.8692s
	iters: 200, epoch: 7 | loss: 3.8871017
	speed: 0.3490s/iter; left time: 6753.2626s
Epoch: 7 cost time: 69.87601709365845
Epoch: 7, Steps: 208 | Train Loss: 2.920 Vali Loss: 4.508 Vali Acc: 0.055 Test Loss: 4.508 Test Acc: 0.055
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.5124466
	speed: 0.9287s/iter; left time: 17871.9967s
	iters: 200, epoch: 8 | loss: 2.7397320
	speed: 0.3657s/iter; left time: 7002.2689s
Epoch: 8 cost time: 81.28451204299927
Epoch: 8, Steps: 208 | Train Loss: 2.700 Vali Loss: 4.580 Vali Acc: 0.069 Test Loss: 4.580 Test Acc: 0.069
Validation loss decreased (-0.067358 --> -0.068848).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5907141
	speed: 0.9231s/iter; left time: 17573.7887s
	iters: 200, epoch: 9 | loss: 2.6225131
	speed: 0.3901s/iter; left time: 7386.6881s
Epoch: 9 cost time: 81.75532221794128
Epoch: 9, Steps: 208 | Train Loss: 2.360 Vali Loss: 5.198 Vali Acc: 0.076 Test Loss: 5.198 Test Acc: 0.076
Validation loss decreased (-0.068848 --> -0.076298).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3632739
	speed: 0.9309s/iter; left time: 17527.7167s
	iters: 200, epoch: 10 | loss: 3.2265434
	speed: 0.3969s/iter; left time: 7432.7593s
Epoch: 10 cost time: 82.67872762680054
Epoch: 10, Steps: 208 | Train Loss: 2.041 Vali Loss: 5.178 Vali Acc: 0.076 Test Loss: 5.178 Test Acc: 0.076
Validation loss decreased (-0.076298 --> -0.076298).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4398631
	speed: 0.9282s/iter; left time: 17284.3891s
	iters: 200, epoch: 11 | loss: 1.9538226
	speed: 0.3781s/iter; left time: 7002.1967s
Epoch: 11 cost time: 80.09093523025513
Epoch: 11, Steps: 208 | Train Loss: 1.740 Vali Loss: 5.834 Vali Acc: 0.071 Test Loss: 5.834 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5770963
	speed: 0.9053s/iter; left time: 16668.5071s
	iters: 200, epoch: 12 | loss: 1.3138702
	speed: 0.3727s/iter; left time: 6825.8132s
Epoch: 12 cost time: 79.35594415664673
Epoch: 12, Steps: 208 | Train Loss: 1.476 Vali Loss: 6.081 Vali Acc: 0.083 Test Loss: 6.081 Test Acc: 0.083
Validation loss decreased (-0.076298 --> -0.083148).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7122296
	speed: 0.9220s/iter; left time: 16785.5208s
	iters: 200, epoch: 13 | loss: 1.0617896
	speed: 0.3807s/iter; left time: 6893.2369s
Epoch: 13 cost time: 79.75398802757263
Epoch: 13, Steps: 208 | Train Loss: 1.299 Vali Loss: 6.377 Vali Acc: 0.085 Test Loss: 6.377 Test Acc: 0.085
Validation loss decreased (-0.083148 --> -0.084636).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2506773
	speed: 0.9118s/iter; left time: 16409.3169s
	iters: 200, epoch: 14 | loss: 1.3030777
	speed: 0.3774s/iter; left time: 6754.8116s
Epoch: 14 cost time: 80.4348840713501
Epoch: 14, Steps: 208 | Train Loss: 1.083 Vali Loss: 6.958 Vali Acc: 0.084 Test Loss: 6.958 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6065498
	speed: 0.9135s/iter; left time: 16249.8106s
	iters: 200, epoch: 15 | loss: 0.9930053
	speed: 0.3907s/iter; left time: 6910.8139s
Epoch: 15 cost time: 81.84301424026489
Epoch: 15, Steps: 208 | Train Loss: 0.900 Vali Loss: 7.272 Vali Acc: 0.079 Test Loss: 7.272 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6416637
	speed: 0.8758s/iter; left time: 15396.6295s
	iters: 200, epoch: 16 | loss: 1.1402138
	speed: 0.3816s/iter; left time: 6669.9351s
Epoch: 16 cost time: 77.47330904006958
Epoch: 16, Steps: 208 | Train Loss: 0.800 Vali Loss: 8.142 Vali Acc: 0.085 Test Loss: 8.142 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1919564
	speed: 0.8945s/iter; left time: 15540.8102s
	iters: 200, epoch: 17 | loss: 0.9763609
	speed: 0.3787s/iter; left time: 6541.2578s
Epoch: 17 cost time: 78.6968023777008
Epoch: 17, Steps: 208 | Train Loss: 0.715 Vali Loss: 8.274 Vali Acc: 0.078 Test Loss: 8.274 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4025096
	speed: 0.8736s/iter; left time: 14995.8009s
	iters: 200, epoch: 18 | loss: 0.9384561
	speed: 0.3882s/iter; left time: 6624.0352s
Epoch: 18 cost time: 78.0920684337616
Epoch: 18, Steps: 208 | Train Loss: 0.612 Vali Loss: 7.687 Vali Acc: 0.089 Test Loss: 7.687 Test Acc: 0.089
Validation loss decreased (-0.084636 --> -0.088501).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0469855
	speed: 0.8921s/iter; left time: 15127.0329s
	iters: 200, epoch: 19 | loss: 0.9899816
	speed: 0.3916s/iter; left time: 6601.9008s
Epoch: 19 cost time: 80.63334536552429
Epoch: 19, Steps: 208 | Train Loss: 0.504 Vali Loss: 8.884 Vali Acc: 0.083 Test Loss: 8.884 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.5929549
	speed: 0.8854s/iter; left time: 14828.9709s
	iters: 200, epoch: 20 | loss: 0.5376971
	speed: 0.3596s/iter; left time: 5986.2737s
Epoch: 20 cost time: 75.91277384757996
Epoch: 20, Steps: 208 | Train Loss: 0.472 Vali Loss: 9.179 Vali Acc: 0.085 Test Loss: 9.179 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2218819
	speed: 0.8961s/iter; left time: 14823.0084s
	iters: 200, epoch: 21 | loss: 0.4292127
	speed: 0.3675s/iter; left time: 6041.4329s
Epoch: 21 cost time: 79.69346857070923
Epoch: 21, Steps: 208 | Train Loss: 0.463 Vali Loss: 9.662 Vali Acc: 0.083 Test Loss: 9.662 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.2056769
	speed: 0.8711s/iter; left time: 14227.2234s
	iters: 200, epoch: 22 | loss: 0.2250091
	speed: 0.3857s/iter; left time: 6260.7354s
Epoch: 22 cost time: 77.6765673160553
Epoch: 22, Steps: 208 | Train Loss: 0.399 Vali Loss: 9.226 Vali Acc: 0.086 Test Loss: 9.226 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.8438902
	speed: 0.9098s/iter; left time: 14670.1302s
	iters: 200, epoch: 23 | loss: 0.1560681
	speed: 0.3740s/iter; left time: 5992.8521s
Epoch: 23 cost time: 78.67433595657349
Epoch: 23, Steps: 208 | Train Loss: 0.323 Vali Loss: 9.433 Vali Acc: 0.083 Test Loss: 9.433 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1726880
	speed: 0.8980s/iter; left time: 14294.0839s
	iters: 200, epoch: 24 | loss: 0.4700187
	speed: 0.3399s/iter; left time: 5376.0466s
Epoch: 24 cost time: 74.44001626968384
Epoch: 24, Steps: 208 | Train Loss: 0.314 Vali Loss: 10.483 Vali Acc: 0.082 Test Loss: 10.483 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6421922
	speed: 0.8838s/iter; left time: 13883.2400s
	iters: 200, epoch: 25 | loss: 0.0774767
	speed: 0.3813s/iter; left time: 5951.0212s
Epoch: 25 cost time: 76.72055554389954
Epoch: 25, Steps: 208 | Train Loss: 0.296 Vali Loss: 9.811 Vali Acc: 0.089 Test Loss: 9.811 Test Acc: 0.089
Validation loss decreased (-0.088501 --> -0.089076).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.2456282
	speed: 0.8575s/iter; left time: 13292.6086s
	iters: 200, epoch: 26 | loss: 0.5658393
	speed: 0.3715s/iter; left time: 5722.1264s
Epoch: 26 cost time: 75.38526177406311
Epoch: 26, Steps: 208 | Train Loss: 0.273 Vali Loss: 10.451 Vali Acc: 0.084 Test Loss: 10.451 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.1830370
	speed: 0.8748s/iter; left time: 13378.5615s
	iters: 200, epoch: 27 | loss: 0.1582083
	speed: 0.3573s/iter; left time: 5427.8557s
Epoch: 27 cost time: 75.7174699306488
Epoch: 27, Steps: 208 | Train Loss: 0.270 Vali Loss: 10.564 Vali Acc: 0.087 Test Loss: 10.564 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.1625561
	speed: 0.8616s/iter; left time: 12996.8433s
	iters: 200, epoch: 28 | loss: 0.2577007
	speed: 0.3882s/iter; left time: 5816.8806s
Epoch: 28 cost time: 77.68310904502869
Epoch: 28, Steps: 208 | Train Loss: 0.217 Vali Loss: 10.659 Vali Acc: 0.084 Test Loss: 10.659 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.1892535
	speed: 0.8590s/iter; left time: 12779.5175s
	iters: 200, epoch: 29 | loss: 0.5411908
	speed: 0.3613s/iter; left time: 5339.3643s
Epoch: 29 cost time: 75.83152389526367
Epoch: 29, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.362 Vali Acc: 0.090 Test Loss: 11.362 Test Acc: 0.090
Validation loss decreased (-0.089076 --> -0.089955).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.3243877
	speed: 0.8772s/iter; left time: 12867.2626s
	iters: 200, epoch: 30 | loss: 0.4171765
	speed: 0.3673s/iter; left time: 5351.0402s
Epoch: 30 cost time: 77.31906819343567
Epoch: 30, Steps: 208 | Train Loss: 0.245 Vali Loss: 10.799 Vali Acc: 0.096 Test Loss: 10.799 Test Acc: 0.096
Validation loss decreased (-0.089955 --> -0.096224).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.1204063
	speed: 0.8654s/iter; left time: 12514.7971s
	iters: 200, epoch: 31 | loss: 0.3039078
	speed: 0.3571s/iter; left time: 5128.1290s
Epoch: 31 cost time: 75.84509658813477
Epoch: 31, Steps: 208 | Train Loss: 0.243 Vali Loss: 11.170 Vali Acc: 0.087 Test Loss: 11.170 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0372613
	speed: 0.8722s/iter; left time: 12432.1567s
	iters: 200, epoch: 32 | loss: 0.0967139
	speed: 0.3845s/iter; left time: 5441.8880s
Epoch: 32 cost time: 78.74855709075928
Epoch: 32, Steps: 208 | Train Loss: 0.195 Vali Loss: 11.445 Vali Acc: 0.087 Test Loss: 11.445 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.1961235
	speed: 0.8668s/iter; left time: 12174.0471s
	iters: 200, epoch: 33 | loss: 0.0267591
	speed: 0.3503s/iter; left time: 4884.7662s
Epoch: 33 cost time: 74.4660804271698
Epoch: 33, Steps: 208 | Train Loss: 0.219 Vali Loss: 10.862 Vali Acc: 0.089 Test Loss: 10.862 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.1007690
	speed: 0.8603s/iter; left time: 11904.1088s
	iters: 200, epoch: 34 | loss: 0.0075046
	speed: 0.3567s/iter; left time: 4900.4975s
Epoch: 34 cost time: 76.0705053806305
Epoch: 34, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.242 Vali Acc: 0.083 Test Loss: 11.242 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.2973340
	speed: 0.8259s/iter; left time: 11255.9875s
	iters: 200, epoch: 35 | loss: 0.5335430
	speed: 0.3629s/iter; left time: 4909.9276s
Epoch: 35 cost time: 74.53706979751587
Epoch: 35, Steps: 208 | Train Loss: 0.202 Vali Loss: 12.196 Vali Acc: 0.091 Test Loss: 12.196 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0209235
	speed: 0.8625s/iter; left time: 11575.8424s
	iters: 200, epoch: 36 | loss: 0.0959284
	speed: 0.3813s/iter; left time: 5079.7801s
Epoch: 36 cost time: 78.73140478134155
Epoch: 36, Steps: 208 | Train Loss: 0.183 Vali Loss: 10.776 Vali Acc: 0.085 Test Loss: 10.776 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.1844609
	speed: 0.8749s/iter; left time: 11559.9214s
	iters: 200, epoch: 37 | loss: 0.1521382
	speed: 0.3604s/iter; left time: 4725.6302s
Epoch: 37 cost time: 76.67724823951721
Epoch: 37, Steps: 208 | Train Loss: 0.186 Vali Loss: 11.791 Vali Acc: 0.091 Test Loss: 11.791 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.1109737
	speed: 0.8485s/iter; left time: 11034.1917s
	iters: 200, epoch: 38 | loss: 0.0775966
	speed: 0.3616s/iter; left time: 4666.8263s
Epoch: 38 cost time: 74.9812707901001
Epoch: 38, Steps: 208 | Train Loss: 0.197 Vali Loss: 12.400 Vali Acc: 0.087 Test Loss: 12.400 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0292224
	speed: 0.8661s/iter; left time: 11083.9117s
	iters: 200, epoch: 39 | loss: 0.0056447
	speed: 0.3406s/iter; left time: 4324.4757s
Epoch: 39 cost time: 74.88736486434937
Epoch: 39, Steps: 208 | Train Loss: 0.181 Vali Loss: 12.182 Vali Acc: 0.083 Test Loss: 12.182 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.1923246
	speed: 0.8609s/iter; left time: 10837.4725s
	iters: 200, epoch: 40 | loss: 0.0845062
	speed: 0.3596s/iter; left time: 4491.5455s
Epoch: 40 cost time: 76.93478512763977
Epoch: 40, Steps: 208 | Train Loss: 0.176 Vali Loss: 12.509 Vali Acc: 0.087 Test Loss: 12.509 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09633164330450343
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.5875449
	speed: 0.3601s/iter; left time: 7455.1141s
	iters: 200, epoch: 1 | loss: 4.7563086
	speed: 0.3390s/iter; left time: 6984.6947s
Epoch: 1 cost time: 72.62922692298889
Epoch: 1, Steps: 208 | Train Loss: 4.522 Vali Loss: 4.427 Vali Acc: 0.049 Test Loss: 4.427 Test Acc: 0.049
Validation loss decreased (inf --> -0.048867).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4476643
	speed: 0.8404s/iter; left time: 17222.6581s
	iters: 200, epoch: 2 | loss: 3.4198501
	speed: 0.3590s/iter; left time: 7321.9559s
Epoch: 2 cost time: 75.86019778251648
Epoch: 2, Steps: 208 | Train Loss: 3.776 Vali Loss: 4.361 Vali Acc: 0.055 Test Loss: 4.361 Test Acc: 0.055
Validation loss decreased (-0.048867 --> -0.054833).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5992355
	speed: 0.8689s/iter; left time: 17626.1640s
	iters: 200, epoch: 3 | loss: 5.1711497
	speed: 0.3610s/iter; left time: 7286.8018s
Epoch: 3 cost time: 75.3634512424469
Epoch: 3, Steps: 208 | Train Loss: 3.406 Vali Loss: 4.677 Vali Acc: 0.058 Test Loss: 4.677 Test Acc: 0.058
Validation loss decreased (-0.054833 --> -0.057812).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5092692
	speed: 0.8787s/iter; left time: 17642.4270s
	iters: 200, epoch: 4 | loss: 3.6064560
	speed: 0.3653s/iter; left time: 7297.7193s
Epoch: 4 cost time: 77.60979223251343
Epoch: 4, Steps: 208 | Train Loss: 3.066 Vali Loss: 5.051 Vali Acc: 0.061 Test Loss: 5.051 Test Acc: 0.061
Validation loss decreased (-0.057812 --> -0.061387).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9893847
	speed: 0.8810s/iter; left time: 17504.7470s
	iters: 200, epoch: 5 | loss: 3.2886624
	speed: 0.3585s/iter; left time: 7087.7252s
Epoch: 5 cost time: 75.93250560760498
Epoch: 5, Steps: 208 | Train Loss: 2.764 Vali Loss: 5.045 Vali Acc: 0.058 Test Loss: 5.045 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4919357
	speed: 0.8571s/iter; left time: 16850.7772s
	iters: 200, epoch: 6 | loss: 3.0488346
	speed: 0.3498s/iter; left time: 6842.7685s
Epoch: 6 cost time: 73.83794355392456
Epoch: 6, Steps: 208 | Train Loss: 2.585 Vali Loss: 5.251 Vali Acc: 0.067 Test Loss: 5.251 Test Acc: 0.067
Validation loss decreased (-0.061387 --> -0.067350).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4812692
	speed: 0.8323s/iter; left time: 16191.5157s
	iters: 200, epoch: 7 | loss: 2.4111667
	speed: 0.3486s/iter; left time: 6746.5697s
Epoch: 7 cost time: 73.62579488754272
Epoch: 7, Steps: 208 | Train Loss: 2.280 Vali Loss: 5.544 Vali Acc: 0.070 Test Loss: 5.544 Test Acc: 0.070
Validation loss decreased (-0.067350 --> -0.069733).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1241677
	speed: 0.8367s/iter; left time: 16102.5384s
	iters: 200, epoch: 8 | loss: 3.0197556
	speed: 0.3694s/iter; left time: 7072.6331s
Epoch: 8 cost time: 76.45725798606873
Epoch: 8, Steps: 208 | Train Loss: 2.016 Vali Loss: 6.025 Vali Acc: 0.064 Test Loss: 6.025 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5818077
	speed: 0.8262s/iter; left time: 15729.1055s
	iters: 200, epoch: 9 | loss: 2.1132100
	speed: 0.3606s/iter; left time: 6829.5419s
Epoch: 9 cost time: 74.47189140319824
Epoch: 9, Steps: 208 | Train Loss: 1.670 Vali Loss: 6.126 Vali Acc: 0.075 Test Loss: 6.126 Test Acc: 0.075
Validation loss decreased (-0.069733 --> -0.075394).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5919956
	speed: 0.8616s/iter; left time: 16222.5100s
	iters: 200, epoch: 10 | loss: 1.2763374
	speed: 0.3676s/iter; left time: 6884.4361s
Epoch: 10 cost time: 75.88882732391357
Epoch: 10, Steps: 208 | Train Loss: 1.400 Vali Loss: 6.850 Vali Acc: 0.075 Test Loss: 6.850 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9361765
	speed: 0.8607s/iter; left time: 16027.6683s
	iters: 200, epoch: 11 | loss: 0.6062307
	speed: 0.3541s/iter; left time: 6559.1001s
Epoch: 11 cost time: 74.73226118087769
Epoch: 11, Steps: 208 | Train Loss: 1.139 Vali Loss: 7.252 Vali Acc: 0.079 Test Loss: 7.252 Test Acc: 0.079
Validation loss decreased (-0.075394 --> -0.079259).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3180516
	speed: 0.8257s/iter; left time: 15204.2142s
	iters: 200, epoch: 12 | loss: 1.3219126
	speed: 0.3635s/iter; left time: 6657.3660s
Epoch: 12 cost time: 75.22681140899658
Epoch: 12, Steps: 208 | Train Loss: 1.057 Vali Loss: 7.597 Vali Acc: 0.074 Test Loss: 7.597 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4050574
	speed: 0.8430s/iter; left time: 15346.0591s
	iters: 200, epoch: 13 | loss: 0.5801515
	speed: 0.3599s/iter; left time: 6515.1899s
Epoch: 13 cost time: 75.12167024612427
Epoch: 13, Steps: 208 | Train Loss: 0.853 Vali Loss: 8.542 Vali Acc: 0.082 Test Loss: 8.542 Test Acc: 0.082
Validation loss decreased (-0.079259 --> -0.081931).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0958855
	speed: 0.8548s/iter; left time: 15383.3171s
	iters: 200, epoch: 14 | loss: 0.4054012
	speed: 0.3755s/iter; left time: 6720.5195s
Epoch: 14 cost time: 77.46003818511963
Epoch: 14, Steps: 208 | Train Loss: 0.744 Vali Loss: 8.290 Vali Acc: 0.080 Test Loss: 8.290 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4451111
	speed: 0.8695s/iter; left time: 15467.8869s
	iters: 200, epoch: 15 | loss: 0.3409964
	speed: 0.3530s/iter; left time: 6243.6174s
Epoch: 15 cost time: 75.03548955917358
Epoch: 15, Steps: 208 | Train Loss: 0.668 Vali Loss: 9.332 Vali Acc: 0.073 Test Loss: 9.332 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7198070
	speed: 0.8694s/iter; left time: 15284.9650s
	iters: 200, epoch: 16 | loss: 0.1822656
	speed: 0.3679s/iter; left time: 6430.8492s
Epoch: 16 cost time: 76.88469171524048
Epoch: 16, Steps: 208 | Train Loss: 0.582 Vali Loss: 9.752 Vali Acc: 0.082 Test Loss: 9.752 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8856093
	speed: 0.8281s/iter; left time: 14386.2145s
	iters: 200, epoch: 17 | loss: 1.5399771
	speed: 0.3616s/iter; left time: 6246.5505s
Epoch: 17 cost time: 74.65399169921875
Epoch: 17, Steps: 208 | Train Loss: 0.556 Vali Loss: 9.524 Vali Acc: 0.080 Test Loss: 9.524 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6830320
	speed: 0.8353s/iter; left time: 14338.3788s
	iters: 200, epoch: 18 | loss: 0.5994192
	speed: 0.3566s/iter; left time: 6084.9778s
Epoch: 18 cost time: 73.63600444793701
Epoch: 18, Steps: 208 | Train Loss: 0.534 Vali Loss: 9.073 Vali Acc: 0.075 Test Loss: 9.073 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8754957
	speed: 0.8270s/iter; left time: 14023.4141s
	iters: 200, epoch: 19 | loss: 0.6010429
	speed: 0.3496s/iter; left time: 5892.7273s
Epoch: 19 cost time: 71.27162194252014
Epoch: 19, Steps: 208 | Train Loss: 0.466 Vali Loss: 9.645 Vali Acc: 0.077 Test Loss: 9.645 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3215842
	speed: 0.8605s/iter; left time: 14412.6085s
	iters: 200, epoch: 20 | loss: 0.4622136
	speed: 0.3530s/iter; left time: 5877.8548s
Epoch: 20 cost time: 75.24717473983765
Epoch: 20, Steps: 208 | Train Loss: 0.440 Vali Loss: 9.714 Vali Acc: 0.087 Test Loss: 9.714 Test Acc: 0.087
Validation loss decreased (-0.081931 --> -0.086989).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1457548
	speed: 0.8440s/iter; left time: 13959.9653s
	iters: 200, epoch: 21 | loss: 0.2902046
	speed: 0.3413s/iter; left time: 5611.7650s
Epoch: 21 cost time: 70.90744662284851
Epoch: 21, Steps: 208 | Train Loss: 0.419 Vali Loss: 10.844 Vali Acc: 0.084 Test Loss: 10.844 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3208073
	speed: 0.8306s/iter; left time: 13565.4558s
	iters: 200, epoch: 22 | loss: 0.4425902
	speed: 0.3351s/iter; left time: 5439.5942s
Epoch: 22 cost time: 72.57759308815002
Epoch: 22, Steps: 208 | Train Loss: 0.378 Vali Loss: 10.428 Vali Acc: 0.083 Test Loss: 10.428 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.0245390
	speed: 0.8623s/iter; left time: 13904.8514s
	iters: 200, epoch: 23 | loss: 0.3207048
	speed: 0.3672s/iter; left time: 5883.9333s
Epoch: 23 cost time: 75.63707280158997
Epoch: 23, Steps: 208 | Train Loss: 0.371 Vali Loss: 11.082 Vali Acc: 0.080 Test Loss: 11.082 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2011282
	speed: 0.8597s/iter; left time: 13684.4618s
	iters: 200, epoch: 24 | loss: 0.2511471
	speed: 0.3597s/iter; left time: 5688.7307s
Epoch: 24 cost time: 74.5995454788208
Epoch: 24, Steps: 208 | Train Loss: 0.319 Vali Loss: 11.302 Vali Acc: 0.077 Test Loss: 11.302 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.6045181
	speed: 0.8503s/iter; left time: 13357.6168s
	iters: 200, epoch: 25 | loss: 0.0629161
	speed: 0.3615s/iter; left time: 5642.0593s
Epoch: 25 cost time: 74.10676717758179
Epoch: 25, Steps: 208 | Train Loss: 0.347 Vali Loss: 10.843 Vali Acc: 0.084 Test Loss: 10.843 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1452571
	speed: 0.8368s/iter; left time: 12971.4794s
	iters: 200, epoch: 26 | loss: 1.1131746
	speed: 0.3490s/iter; left time: 5375.4992s
Epoch: 26 cost time: 73.77199673652649
Epoch: 26, Steps: 208 | Train Loss: 0.347 Vali Loss: 10.794 Vali Acc: 0.084 Test Loss: 10.794 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1195017
	speed: 0.8273s/iter; left time: 12651.4051s
	iters: 200, epoch: 27 | loss: 0.8429621
	speed: 0.3550s/iter; left time: 5393.8837s
Epoch: 27 cost time: 73.63139510154724
Epoch: 27, Steps: 208 | Train Loss: 0.299 Vali Loss: 10.833 Vali Acc: 0.081 Test Loss: 10.833 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.4150500
	speed: 0.8346s/iter; left time: 12589.8245s
	iters: 200, epoch: 28 | loss: 0.2867323
	speed: 0.3667s/iter; left time: 5495.2627s
Epoch: 28 cost time: 76.00607323646545
Epoch: 28, Steps: 208 | Train Loss: 0.291 Vali Loss: 11.220 Vali Acc: 0.081 Test Loss: 11.220 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.6869423
	speed: 0.8354s/iter; left time: 12427.5448s
	iters: 200, epoch: 29 | loss: 0.5181036
	speed: 0.3608s/iter; left time: 5331.5481s
Epoch: 29 cost time: 75.75161552429199
Epoch: 29, Steps: 208 | Train Loss: 0.324 Vali Loss: 10.503 Vali Acc: 0.088 Test Loss: 10.503 Test Acc: 0.088
Validation loss decreased (-0.086989 --> -0.087876).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.3247787
	speed: 0.8592s/iter; left time: 12602.9060s
	iters: 200, epoch: 30 | loss: 0.3885089
	speed: 0.3503s/iter; left time: 5103.7430s
Epoch: 30 cost time: 74.69768452644348
Epoch: 30, Steps: 208 | Train Loss: 0.263 Vali Loss: 11.655 Vali Acc: 0.081 Test Loss: 11.655 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.3088724
	speed: 0.8665s/iter; left time: 12530.7282s
	iters: 200, epoch: 31 | loss: 0.1095475
	speed: 0.3612s/iter; left time: 5187.1100s
Epoch: 31 cost time: 77.24585270881653
Epoch: 31, Steps: 208 | Train Loss: 0.253 Vali Loss: 11.610 Vali Acc: 0.084 Test Loss: 11.610 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.2714245
	speed: 0.8600s/iter; left time: 12257.9956s
	iters: 200, epoch: 32 | loss: 0.5761511
	speed: 0.3520s/iter; left time: 4982.2117s
Epoch: 32 cost time: 74.74808430671692
Epoch: 32, Steps: 208 | Train Loss: 0.261 Vali Loss: 11.539 Vali Acc: 0.088 Test Loss: 11.539 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.2653623
	speed: 0.8393s/iter; left time: 11788.2020s
	iters: 200, epoch: 33 | loss: 0.0154418
	speed: 0.3588s/iter; left time: 5003.6394s
Epoch: 33 cost time: 75.72732329368591
Epoch: 33, Steps: 208 | Train Loss: 0.257 Vali Loss: 11.647 Vali Acc: 0.086 Test Loss: 11.647 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.4054100
	speed: 0.8722s/iter; left time: 12068.2070s
	iters: 200, epoch: 34 | loss: 0.0262852
	speed: 0.3650s/iter; left time: 5013.6778s
Epoch: 34 cost time: 77.15997910499573
Epoch: 34, Steps: 208 | Train Loss: 0.236 Vali Loss: 11.780 Vali Acc: 0.084 Test Loss: 11.780 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.3161370
	speed: 0.8459s/iter; left time: 11529.1795s
	iters: 200, epoch: 35 | loss: 0.0853400
	speed: 0.3677s/iter; left time: 4974.7761s
Epoch: 35 cost time: 76.52123475074768
Epoch: 35, Steps: 208 | Train Loss: 0.252 Vali Loss: 12.434 Vali Acc: 0.084 Test Loss: 12.434 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.3590330
	speed: 0.8765s/iter; left time: 11763.7146s
	iters: 200, epoch: 36 | loss: 0.6307801
	speed: 0.3551s/iter; left time: 4729.9785s
Epoch: 36 cost time: 74.8442006111145
Epoch: 36, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.464 Vali Acc: 0.078 Test Loss: 11.464 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0064934
	speed: 0.8342s/iter; left time: 11022.2606s
	iters: 200, epoch: 37 | loss: 0.8560600
	speed: 0.3232s/iter; left time: 4238.2515s
Epoch: 37 cost time: 71.91615414619446
Epoch: 37, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.742 Vali Acc: 0.078 Test Loss: 11.742 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.1131491
	speed: 0.8520s/iter; left time: 11080.3334s
	iters: 200, epoch: 38 | loss: 0.3872109
	speed: 0.3594s/iter; left time: 4637.9813s
Epoch: 38 cost time: 75.60360884666443
Epoch: 38, Steps: 208 | Train Loss: 0.204 Vali Loss: 11.910 Vali Acc: 0.080 Test Loss: 11.910 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.1958968
	speed: 0.8613s/iter; left time: 11022.5606s
	iters: 200, epoch: 39 | loss: 0.3491627
	speed: 0.3564s/iter; left time: 4525.7671s
Epoch: 39 cost time: 74.33279156684875
Epoch: 39, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.990 Vali Acc: 0.084 Test Loss: 11.990 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08798091261556815
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8069320
	speed: 0.3556s/iter; left time: 7361.9015s
	iters: 200, epoch: 1 | loss: 4.7143874
	speed: 0.3376s/iter; left time: 6955.6302s
Epoch: 1 cost time: 72.57795333862305
Epoch: 1, Steps: 208 | Train Loss: 4.599 Vali Loss: 4.503 Vali Acc: 0.048 Test Loss: 4.503 Test Acc: 0.048
Validation loss decreased (inf --> -0.047673).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9057579
	speed: 0.8087s/iter; left time: 16572.3166s
	iters: 200, epoch: 2 | loss: 3.0747814
	speed: 0.3443s/iter; left time: 7021.7645s
Epoch: 2 cost time: 71.16488814353943
Epoch: 2, Steps: 208 | Train Loss: 3.841 Vali Loss: 4.381 Vali Acc: 0.062 Test Loss: 4.381 Test Acc: 0.062
Validation loss decreased (-0.047673 --> -0.061692).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5395291
	speed: 0.7888s/iter; left time: 16000.1355s
	iters: 200, epoch: 3 | loss: 4.8105655
	speed: 0.3326s/iter; left time: 6713.9338s
Epoch: 3 cost time: 69.9887146949768
Epoch: 3, Steps: 208 | Train Loss: 3.408 Vali Loss: 4.404 Vali Acc: 0.052 Test Loss: 4.404 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7829800
	speed: 0.8928s/iter; left time: 17924.9026s
	iters: 200, epoch: 4 | loss: 3.9020903
	speed: 0.4488s/iter; left time: 8966.1869s
Epoch: 4 cost time: 91.56430673599243
Epoch: 4, Steps: 208 | Train Loss: 3.208 Vali Loss: 5.199 Vali Acc: 0.066 Test Loss: 5.199 Test Acc: 0.066
Validation loss decreased (-0.061692 --> -0.065859).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0087743
	speed: 1.0323s/iter; left time: 20510.4069s
	iters: 200, epoch: 5 | loss: 3.7972469
	speed: 0.4464s/iter; left time: 8825.4668s
Epoch: 5 cost time: 93.78842568397522
Epoch: 5, Steps: 208 | Train Loss: 2.773 Vali Loss: 4.849 Vali Acc: 0.069 Test Loss: 4.849 Test Acc: 0.069
Validation loss decreased (-0.065859 --> -0.068845).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2398369
	speed: 1.0302s/iter; left time: 20254.6316s
	iters: 200, epoch: 6 | loss: 2.1376348
	speed: 0.4326s/iter; left time: 8461.8350s
Epoch: 6 cost time: 92.32008004188538
Epoch: 6, Steps: 208 | Train Loss: 2.463 Vali Loss: 5.720 Vali Acc: 0.073 Test Loss: 5.720 Test Acc: 0.073
Validation loss decreased (-0.068845 --> -0.073012).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6539186
	speed: 1.0092s/iter; left time: 19631.5488s
	iters: 200, epoch: 7 | loss: 2.7901163
	speed: 0.3806s/iter; left time: 7365.3423s
Epoch: 7 cost time: 86.45931363105774
Epoch: 7, Steps: 208 | Train Loss: 2.111 Vali Loss: 5.868 Vali Acc: 0.071 Test Loss: 5.868 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4356136
	speed: 0.9907s/iter; left time: 19066.3006s
	iters: 200, epoch: 8 | loss: 1.9561934
	speed: 0.4397s/iter; left time: 8418.6215s
Epoch: 8 cost time: 93.45525002479553
Epoch: 8, Steps: 208 | Train Loss: 1.845 Vali Loss: 6.082 Vali Acc: 0.069 Test Loss: 6.082 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3628980
	speed: 1.0135s/iter; left time: 19293.4383s
	iters: 200, epoch: 9 | loss: 2.2074015
	speed: 0.4512s/iter; left time: 8544.9444s
Epoch: 9 cost time: 94.48732113838196
Epoch: 9, Steps: 208 | Train Loss: 1.464 Vali Loss: 7.061 Vali Acc: 0.070 Test Loss: 7.061 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4696156
	speed: 0.9994s/iter; left time: 18817.2024s
	iters: 200, epoch: 10 | loss: 1.4739519
	speed: 0.4306s/iter; left time: 8065.1266s
Epoch: 10 cost time: 91.46811628341675
Epoch: 10, Steps: 208 | Train Loss: 1.239 Vali Loss: 7.201 Vali Acc: 0.072 Test Loss: 7.201 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5115952
	speed: 0.9939s/iter; left time: 18507.6298s
	iters: 200, epoch: 11 | loss: 0.7426990
	speed: 0.4363s/iter; left time: 8080.3956s
Epoch: 11 cost time: 91.9579656124115
Epoch: 11, Steps: 208 | Train Loss: 1.028 Vali Loss: 7.773 Vali Acc: 0.083 Test Loss: 7.773 Test Acc: 0.083
Validation loss decreased (-0.073012 --> -0.082535).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6695027
	speed: 0.9769s/iter; left time: 17986.8570s
	iters: 200, epoch: 12 | loss: 1.3959422
	speed: 0.4083s/iter; left time: 7477.8129s
Epoch: 12 cost time: 86.9946129322052
Epoch: 12, Steps: 208 | Train Loss: 0.835 Vali Loss: 8.253 Vali Acc: 0.076 Test Loss: 8.253 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2160625
	speed: 0.9626s/iter; left time: 17524.7996s
	iters: 200, epoch: 13 | loss: 0.8476027
	speed: 0.4323s/iter; left time: 7826.6572s
Epoch: 13 cost time: 88.90573787689209
Epoch: 13, Steps: 208 | Train Loss: 0.750 Vali Loss: 9.143 Vali Acc: 0.086 Test Loss: 9.143 Test Acc: 0.086
Validation loss decreased (-0.082535 --> -0.085802).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6039333
	speed: 1.0114s/iter; left time: 18202.2788s
	iters: 200, epoch: 14 | loss: 0.8503466
	speed: 0.4376s/iter; left time: 7831.4328s
Epoch: 14 cost time: 92.44267416000366
Epoch: 14, Steps: 208 | Train Loss: 0.684 Vali Loss: 9.171 Vali Acc: 0.075 Test Loss: 9.171 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6574577
	speed: 0.9505s/iter; left time: 16908.5084s
	iters: 200, epoch: 15 | loss: 1.0791681
	speed: 0.4420s/iter; left time: 7819.0986s
Epoch: 15 cost time: 91.25902700424194
Epoch: 15, Steps: 208 | Train Loss: 0.657 Vali Loss: 9.435 Vali Acc: 0.066 Test Loss: 9.435 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6551958
	speed: 0.9550s/iter; left time: 16790.1725s
	iters: 200, epoch: 16 | loss: 0.3966575
	speed: 0.4357s/iter; left time: 7617.1686s
Epoch: 16 cost time: 87.99534487724304
Epoch: 16, Steps: 208 | Train Loss: 0.552 Vali Loss: 9.890 Vali Acc: 0.078 Test Loss: 9.890 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3373941
	speed: 0.9462s/iter; left time: 16437.8705s
	iters: 200, epoch: 17 | loss: 0.4889469
	speed: 0.4354s/iter; left time: 7520.4869s
Epoch: 17 cost time: 86.19916248321533
Epoch: 17, Steps: 208 | Train Loss: 0.490 Vali Loss: 9.795 Vali Acc: 0.084 Test Loss: 9.795 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4426250
	speed: 0.9553s/iter; left time: 16398.1605s
	iters: 200, epoch: 18 | loss: 0.1308798
	speed: 0.4266s/iter; left time: 7280.7287s
Epoch: 18 cost time: 90.2767014503479
Epoch: 18, Steps: 208 | Train Loss: 0.511 Vali Loss: 9.752 Vali Acc: 0.072 Test Loss: 9.752 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.0583940
	speed: 0.9413s/iter; left time: 15961.5371s
	iters: 200, epoch: 19 | loss: 0.3473472
	speed: 0.4276s/iter; left time: 7208.4742s
Epoch: 19 cost time: 85.88895082473755
Epoch: 19, Steps: 208 | Train Loss: 0.461 Vali Loss: 10.516 Vali Acc: 0.073 Test Loss: 10.516 Test Acc: 0.073
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.5283345
	speed: 0.9731s/iter; left time: 16299.1713s
	iters: 200, epoch: 20 | loss: 0.1787465
	speed: 0.4227s/iter; left time: 7038.1647s
Epoch: 20 cost time: 89.7707884311676
Epoch: 20, Steps: 208 | Train Loss: 0.432 Vali Loss: 10.389 Vali Acc: 0.074 Test Loss: 10.389 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2424503
	speed: 0.9720s/iter; left time: 16078.1615s
	iters: 200, epoch: 21 | loss: 0.6662410
	speed: 0.4310s/iter; left time: 7085.8191s
Epoch: 21 cost time: 88.0619969367981
Epoch: 21, Steps: 208 | Train Loss: 0.415 Vali Loss: 10.710 Vali Acc: 0.075 Test Loss: 10.710 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.8012518
	speed: 0.9867s/iter; left time: 16115.4073s
	iters: 200, epoch: 22 | loss: 0.6736728
	speed: 0.4097s/iter; left time: 6650.9816s
Epoch: 22 cost time: 88.43790817260742
Epoch: 22, Steps: 208 | Train Loss: 0.426 Vali Loss: 11.165 Vali Acc: 0.072 Test Loss: 11.165 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.9735859
	speed: 0.9691s/iter; left time: 15627.4649s
	iters: 200, epoch: 23 | loss: 0.1533812
	speed: 0.4296s/iter; left time: 6884.0101s
Epoch: 23 cost time: 89.80736994743347
Epoch: 23, Steps: 208 | Train Loss: 0.385 Vali Loss: 10.969 Vali Acc: 0.079 Test Loss: 10.969 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08589322994333433
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.5893450
	speed: 0.4508s/iter; left time: 9331.3655s
	iters: 200, epoch: 1 | loss: 4.5059938
	speed: 0.4314s/iter; left time: 8887.5546s
Epoch: 1 cost time: 92.60073494911194
Epoch: 1, Steps: 208 | Train Loss: 4.563 Vali Loss: 4.522 Vali Acc: 0.051 Test Loss: 4.522 Test Acc: 0.051
Validation loss decreased (inf --> -0.050954).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1552176
	speed: 0.9241s/iter; left time: 18937.7097s
	iters: 200, epoch: 2 | loss: 3.3403671
	speed: 0.4299s/iter; left time: 8766.1470s
Epoch: 2 cost time: 86.35112833976746
Epoch: 2, Steps: 208 | Train Loss: 3.801 Vali Loss: 4.729 Vali Acc: 0.063 Test Loss: 4.729 Test Acc: 0.063
Validation loss decreased (-0.050954 --> -0.062881).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3155484
	speed: 0.9473s/iter; left time: 19215.3456s
	iters: 200, epoch: 3 | loss: 5.0944672
	speed: 0.4322s/iter; left time: 8722.9538s
Epoch: 3 cost time: 87.55369281768799
Epoch: 3, Steps: 208 | Train Loss: 3.305 Vali Loss: 5.206 Vali Acc: 0.064 Test Loss: 5.206 Test Acc: 0.064
Validation loss decreased (-0.062881 --> -0.064070).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9764254
	speed: 0.9682s/iter; left time: 19438.9582s
	iters: 200, epoch: 4 | loss: 3.9184945
	speed: 0.4055s/iter; left time: 8101.0540s
Epoch: 4 cost time: 85.57273602485657
Epoch: 4, Steps: 208 | Train Loss: 2.821 Vali Loss: 5.568 Vali Acc: 0.069 Test Loss: 5.568 Test Acc: 0.069
Validation loss decreased (-0.064070 --> -0.069136).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8257427
	speed: 0.9512s/iter; left time: 18898.7658s
	iters: 200, epoch: 5 | loss: 3.5457015
	speed: 0.3940s/iter; left time: 7789.1301s
Epoch: 5 cost time: 85.1524965763092
Epoch: 5, Steps: 208 | Train Loss: 2.494 Vali Loss: 5.723 Vali Acc: 0.062 Test Loss: 5.723 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1506481
	speed: 0.9128s/iter; left time: 17946.2694s
	iters: 200, epoch: 6 | loss: 2.8668430
	speed: 0.4085s/iter; left time: 7990.1024s
Epoch: 6 cost time: 84.33318543434143
Epoch: 6, Steps: 208 | Train Loss: 2.163 Vali Loss: 6.240 Vali Acc: 0.068 Test Loss: 6.240 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3284982
	speed: 0.9156s/iter; left time: 17811.4423s
	iters: 200, epoch: 7 | loss: 2.1381764
	speed: 0.4056s/iter; left time: 7850.0127s
Epoch: 7 cost time: 84.13012599945068
Epoch: 7, Steps: 208 | Train Loss: 1.877 Vali Loss: 6.966 Vali Acc: 0.075 Test Loss: 6.966 Test Acc: 0.075
Validation loss decreased (-0.069136 --> -0.075385).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6699361
	speed: 0.9604s/iter; left time: 18483.3954s
	iters: 200, epoch: 8 | loss: 2.6705520
	speed: 0.4142s/iter; left time: 7930.7427s
Epoch: 8 cost time: 86.11034107208252
Epoch: 8, Steps: 208 | Train Loss: 1.607 Vali Loss: 6.656 Vali Acc: 0.072 Test Loss: 6.656 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.0506876
	speed: 0.9205s/iter; left time: 17524.4652s
	iters: 200, epoch: 9 | loss: 0.8558170
	speed: 0.4058s/iter; left time: 7683.9978s
Epoch: 9 cost time: 84.88773155212402
Epoch: 9, Steps: 208 | Train Loss: 1.361 Vali Loss: 7.113 Vali Acc: 0.071 Test Loss: 7.113 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7834406
	speed: 0.9727s/iter; left time: 18314.2507s
	iters: 200, epoch: 10 | loss: 1.1004050
	speed: 0.4012s/iter; left time: 7514.7089s
Epoch: 10 cost time: 85.83485102653503
Epoch: 10, Steps: 208 | Train Loss: 1.141 Vali Loss: 8.375 Vali Acc: 0.078 Test Loss: 8.375 Test Acc: 0.078
Validation loss decreased (-0.075385 --> -0.077459).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1276330
	speed: 0.9394s/iter; left time: 17491.7997s
	iters: 200, epoch: 11 | loss: 0.5011896
	speed: 0.4079s/iter; left time: 7555.4899s
Epoch: 11 cost time: 83.55137920379639
Epoch: 11, Steps: 208 | Train Loss: 0.968 Vali Loss: 8.199 Vali Acc: 0.072 Test Loss: 8.199 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6234480
	speed: 0.9603s/iter; left time: 17682.2485s
	iters: 200, epoch: 12 | loss: 0.4356733
	speed: 0.4180s/iter; left time: 7655.3718s
Epoch: 12 cost time: 87.15451908111572
Epoch: 12, Steps: 208 | Train Loss: 0.883 Vali Loss: 9.144 Vali Acc: 0.075 Test Loss: 9.144 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6993814
	speed: 0.9565s/iter; left time: 17412.6760s
	iters: 200, epoch: 13 | loss: 0.1596310
	speed: 0.4038s/iter; left time: 7310.3229s
Epoch: 13 cost time: 86.17295908927917
Epoch: 13, Steps: 208 | Train Loss: 0.773 Vali Loss: 9.009 Vali Acc: 0.075 Test Loss: 9.009 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7978913
	speed: 1.1429s/iter; left time: 20567.9162s
	iters: 200, epoch: 14 | loss: 0.3521779
	speed: 0.5095s/iter; left time: 9118.2547s
Epoch: 14 cost time: 113.0190691947937
Epoch: 14, Steps: 208 | Train Loss: 0.740 Vali Loss: 9.296 Vali Acc: 0.074 Test Loss: 9.296 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2785845
	speed: 1.1944s/iter; left time: 21247.0170s
	iters: 200, epoch: 15 | loss: 1.1122882
	speed: 0.5059s/iter; left time: 8949.0976s
Epoch: 15 cost time: 109.03646755218506
Epoch: 15, Steps: 208 | Train Loss: 0.668 Vali Loss: 9.662 Vali Acc: 0.070 Test Loss: 9.662 Test Acc: 0.070
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.5553588
	speed: 1.1576s/iter; left time: 20352.5724s
	iters: 200, epoch: 16 | loss: 0.2879672
	speed: 0.5045s/iter; left time: 8819.2432s
Epoch: 16 cost time: 109.00805807113647
Epoch: 16, Steps: 208 | Train Loss: 0.632 Vali Loss: 10.037 Vali Acc: 0.077 Test Loss: 10.037 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6314697
	speed: 1.1669s/iter; left time: 20271.8382s
	iters: 200, epoch: 17 | loss: 1.2806709
	speed: 0.5386s/iter; left time: 9303.5733s
Epoch: 17 cost time: 112.69307494163513
Epoch: 17, Steps: 208 | Train Loss: 0.595 Vali Loss: 10.358 Vali Acc: 0.079 Test Loss: 10.358 Test Acc: 0.079
Validation loss decreased (-0.077459 --> -0.079228).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1868078
	speed: 1.1719s/iter; left time: 20115.4637s
	iters: 200, epoch: 18 | loss: 0.9397564
	speed: 0.5242s/iter; left time: 8945.0645s
Epoch: 18 cost time: 108.85124135017395
Epoch: 18, Steps: 208 | Train Loss: 0.600 Vali Loss: 9.938 Vali Acc: 0.086 Test Loss: 9.938 Test Acc: 0.086
Validation loss decreased (-0.079228 --> -0.086092).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9336970
	speed: 1.1825s/iter; left time: 20051.1770s
	iters: 200, epoch: 19 | loss: 0.7774707
	speed: 0.4798s/iter; left time: 8088.3671s
Epoch: 19 cost time: 104.98313069343567
Epoch: 19, Steps: 208 | Train Loss: 0.520 Vali Loss: 9.797 Vali Acc: 0.083 Test Loss: 9.797 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0633678
	speed: 1.1622s/iter; left time: 19465.7045s
	iters: 200, epoch: 20 | loss: 0.2710753
	speed: 0.5421s/iter; left time: 9024.9300s
Epoch: 20 cost time: 112.41373062133789
Epoch: 20, Steps: 208 | Train Loss: 0.524 Vali Loss: 10.805 Vali Acc: 0.078 Test Loss: 10.805 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1857620
	speed: 1.1736s/iter; left time: 19412.1914s
	iters: 200, epoch: 21 | loss: 1.4454302
	speed: 0.5448s/iter; left time: 8957.5438s
Epoch: 21 cost time: 113.42798161506653
Epoch: 21, Steps: 208 | Train Loss: 0.501 Vali Loss: 11.248 Vali Acc: 0.076 Test Loss: 11.248 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1854912
	speed: 1.1680s/iter; left time: 19076.4550s
	iters: 200, epoch: 22 | loss: 0.3696431
	speed: 0.4625s/iter; left time: 7507.5289s
Epoch: 22 cost time: 103.98399138450623
Epoch: 22, Steps: 208 | Train Loss: 0.461 Vali Loss: 10.340 Vali Acc: 0.078 Test Loss: 10.340 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.4708132
	speed: 1.1372s/iter; left time: 18336.8225s
	iters: 200, epoch: 23 | loss: 1.3891146
	speed: 0.5343s/iter; left time: 8562.2801s
Epoch: 23 cost time: 109.6516466140747
Epoch: 23, Steps: 208 | Train Loss: 0.453 Vali Loss: 11.298 Vali Acc: 0.073 Test Loss: 11.298 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.2967087
	speed: 1.1376s/iter; left time: 18107.7033s
	iters: 200, epoch: 24 | loss: 1.3729147
	speed: 0.5331s/iter; left time: 8431.8530s
Epoch: 24 cost time: 109.76994180679321
Epoch: 24, Steps: 208 | Train Loss: 0.416 Vali Loss: 11.363 Vali Acc: 0.080 Test Loss: 11.363 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6794396
	speed: 1.1279s/iter; left time: 17717.4329s
	iters: 200, epoch: 25 | loss: 0.0695992
	speed: 0.5169s/iter; left time: 8068.7999s
Epoch: 25 cost time: 105.76543498039246
Epoch: 25, Steps: 208 | Train Loss: 0.367 Vali Loss: 11.003 Vali Acc: 0.092 Test Loss: 11.003 Test Acc: 0.092
Validation loss decreased (-0.086092 --> -0.091450).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.6806591
	speed: 1.1677s/iter; left time: 18101.2502s
	iters: 200, epoch: 26 | loss: 0.6442047
	speed: 0.5415s/iter; left time: 8339.2210s
Epoch: 26 cost time: 112.65581798553467
Epoch: 26, Steps: 208 | Train Loss: 0.400 Vali Loss: 10.932 Vali Acc: 0.078 Test Loss: 10.932 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0411633
	speed: 1.1512s/iter; left time: 17605.5020s
	iters: 200, epoch: 27 | loss: 0.5417975
	speed: 0.5426s/iter; left time: 8243.9224s
Epoch: 27 cost time: 110.48898100852966
Epoch: 27, Steps: 208 | Train Loss: 0.416 Vali Loss: 10.829 Vali Acc: 0.081 Test Loss: 10.829 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0338980
	speed: 1.1496s/iter; left time: 17342.1279s
	iters: 200, epoch: 28 | loss: 0.7276993
	speed: 0.5422s/iter; left time: 8124.1495s
Epoch: 28 cost time: 111.44857716560364
Epoch: 28, Steps: 208 | Train Loss: 0.384 Vali Loss: 11.255 Vali Acc: 0.079 Test Loss: 11.255 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.2930500
	speed: 1.1106s/iter; left time: 16522.3634s
	iters: 200, epoch: 29 | loss: 1.4065458
	speed: 0.5216s/iter; left time: 7707.3780s
Epoch: 29 cost time: 105.82378792762756
Epoch: 29, Steps: 208 | Train Loss: 0.438 Vali Loss: 10.480 Vali Acc: 0.083 Test Loss: 10.480 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.3997422
	speed: 1.1514s/iter; left time: 16889.3662s
	iters: 200, epoch: 30 | loss: 1.1395546
	speed: 0.4926s/iter; left time: 7176.8519s
Epoch: 30 cost time: 105.73251461982727
Epoch: 30, Steps: 208 | Train Loss: 0.336 Vali Loss: 11.167 Vali Acc: 0.081 Test Loss: 11.167 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0748902
	speed: 1.1317s/iter; left time: 16364.9356s
	iters: 200, epoch: 31 | loss: 0.3232982
	speed: 0.5312s/iter; left time: 7628.9472s
Epoch: 31 cost time: 107.30403923988342
Epoch: 31, Steps: 208 | Train Loss: 0.313 Vali Loss: 11.368 Vali Acc: 0.080 Test Loss: 11.368 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.2035775
	speed: 1.1125s/iter; left time: 15855.8403s
	iters: 200, epoch: 32 | loss: 0.2173796
	speed: 0.4729s/iter; left time: 6693.2040s
Epoch: 32 cost time: 100.79734086990356
Epoch: 32, Steps: 208 | Train Loss: 0.361 Vali Loss: 11.074 Vali Acc: 0.072 Test Loss: 11.074 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.2772481
	speed: 1.1051s/iter; left time: 15521.8311s
	iters: 200, epoch: 33 | loss: 0.1503233
	speed: 0.4864s/iter; left time: 6783.2337s
Epoch: 33 cost time: 102.50498461723328
Epoch: 33, Steps: 208 | Train Loss: 0.298 Vali Loss: 12.045 Vali Acc: 0.083 Test Loss: 12.045 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2445461
	speed: 1.0997s/iter; left time: 15216.8049s
	iters: 200, epoch: 34 | loss: 0.2826194
	speed: 0.5064s/iter; left time: 6955.9952s
Epoch: 34 cost time: 104.77534914016724
Epoch: 34, Steps: 208 | Train Loss: 0.346 Vali Loss: 11.442 Vali Acc: 0.081 Test Loss: 11.442 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.7338756
	speed: 1.1438s/iter; left time: 15588.4938s
	iters: 200, epoch: 35 | loss: 0.1907342
	speed: 0.4939s/iter; left time: 6681.9715s
Epoch: 35 cost time: 106.05955266952515
Epoch: 35, Steps: 208 | Train Loss: 0.331 Vali Loss: 11.326 Vali Acc: 0.083 Test Loss: 11.326 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09155979719654041
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.2618904
	speed: 0.5029s/iter; left time: 10410.4853s
	iters: 200, epoch: 1 | loss: 4.8932014
	speed: 0.4612s/iter; left time: 9500.4968s
Epoch: 1 cost time: 100.6490638256073
Epoch: 1, Steps: 208 | Train Loss: 4.558 Vali Loss: 4.774 Vali Acc: 0.050 Test Loss: 4.774 Test Acc: 0.050
Validation loss decreased (inf --> -0.049758).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3179898
	speed: 1.0945s/iter; left time: 22428.7449s
	iters: 200, epoch: 2 | loss: 3.2509139
	speed: 0.4669s/iter; left time: 9520.9746s
Epoch: 2 cost time: 100.29127907752991
Epoch: 2, Steps: 208 | Train Loss: 3.927 Vali Loss: 4.661 Vali Acc: 0.059 Test Loss: 4.661 Test Acc: 0.059
Validation loss decreased (-0.049758 --> -0.059005).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7922726
	speed: 1.0738s/iter; left time: 21782.1521s
	iters: 200, epoch: 3 | loss: 4.8794503
	speed: 0.4442s/iter; left time: 8967.0179s
Epoch: 3 cost time: 94.29789066314697
Epoch: 3, Steps: 208 | Train Loss: 3.413 Vali Loss: 4.875 Vali Acc: 0.070 Test Loss: 4.875 Test Acc: 0.070
Validation loss decreased (-0.059005 --> -0.069739).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8201697
	speed: 1.1147s/iter; left time: 22380.1396s
	iters: 200, epoch: 4 | loss: 3.7390099
	speed: 0.4820s/iter; left time: 9629.9003s
Epoch: 4 cost time: 102.14837956428528
Epoch: 4, Steps: 208 | Train Loss: 2.935 Vali Loss: 5.587 Vali Acc: 0.078 Test Loss: 5.587 Test Acc: 0.078
Validation loss decreased (-0.069739 --> -0.077785).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8777599
	speed: 1.1149s/iter; left time: 22152.5845s
	iters: 200, epoch: 5 | loss: 2.9930530
	speed: 0.4973s/iter; left time: 9830.8886s
Epoch: 5 cost time: 102.85041618347168
Epoch: 5, Steps: 208 | Train Loss: 2.622 Vali Loss: 5.227 Vali Acc: 0.076 Test Loss: 5.227 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.6549065
	speed: 1.0909s/iter; left time: 21448.9521s
	iters: 200, epoch: 6 | loss: 2.9679456
	speed: 0.4552s/iter; left time: 8904.7221s
Epoch: 6 cost time: 99.34679961204529
Epoch: 6, Steps: 208 | Train Loss: 2.348 Vali Loss: 5.386 Vali Acc: 0.075 Test Loss: 5.386 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1352911
	speed: 1.0973s/iter; left time: 21345.5050s
	iters: 200, epoch: 7 | loss: 2.4514487
	speed: 0.4931s/iter; left time: 9542.8683s
Epoch: 7 cost time: 103.65936326980591
Epoch: 7, Steps: 208 | Train Loss: 2.050 Vali Loss: 5.849 Vali Acc: 0.072 Test Loss: 5.849 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.0121529
	speed: 1.0938s/iter; left time: 21050.3675s
	iters: 200, epoch: 8 | loss: 2.4452634
	speed: 0.5043s/iter; left time: 9654.0398s
Epoch: 8 cost time: 104.17767643928528
Epoch: 8, Steps: 208 | Train Loss: 1.790 Vali Loss: 6.102 Vali Acc: 0.074 Test Loss: 6.102 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.2510369
	speed: 1.0924s/iter; left time: 20796.4366s
	iters: 200, epoch: 9 | loss: 0.9953305
	speed: 0.5081s/iter; left time: 9621.8469s
Epoch: 9 cost time: 104.27758932113647
Epoch: 9, Steps: 208 | Train Loss: 1.498 Vali Loss: 6.802 Vali Acc: 0.081 Test Loss: 6.802 Test Acc: 0.081
Validation loss decreased (-0.077785 --> -0.081352).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4863622
	speed: 1.1086s/iter; left time: 20873.1860s
	iters: 200, epoch: 10 | loss: 1.4084105
	speed: 0.4815s/iter; left time: 9017.7641s
Epoch: 10 cost time: 101.40545630455017
Epoch: 10, Steps: 208 | Train Loss: 1.222 Vali Loss: 7.682 Vali Acc: 0.076 Test Loss: 7.682 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2024363
	speed: 1.1273s/iter; left time: 20991.9251s
	iters: 200, epoch: 11 | loss: 1.0573751
	speed: 0.4999s/iter; left time: 9258.3942s
Epoch: 11 cost time: 104.63181567192078
Epoch: 11, Steps: 208 | Train Loss: 1.067 Vali Loss: 7.566 Vali Acc: 0.085 Test Loss: 7.566 Test Acc: 0.085
Validation loss decreased (-0.081352 --> -0.085221).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9372951
	speed: 1.0770s/iter; left time: 19831.6395s
	iters: 200, epoch: 12 | loss: 1.0462800
	speed: 0.4985s/iter; left time: 9128.6600s
Epoch: 12 cost time: 103.01105427742004
Epoch: 12, Steps: 208 | Train Loss: 0.945 Vali Loss: 7.756 Vali Acc: 0.083 Test Loss: 7.756 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4456521
	speed: 1.1318s/iter; left time: 20605.0489s
	iters: 200, epoch: 13 | loss: 0.5549562
	speed: 0.4901s/iter; left time: 8873.6064s
Epoch: 13 cost time: 105.10586023330688
Epoch: 13, Steps: 208 | Train Loss: 0.880 Vali Loss: 8.305 Vali Acc: 0.075 Test Loss: 8.305 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6431875
	speed: 1.0944s/iter; left time: 19695.3247s
	iters: 200, epoch: 14 | loss: 0.9591733
	speed: 0.4726s/iter; left time: 8458.2991s
Epoch: 14 cost time: 101.07791590690613
Epoch: 14, Steps: 208 | Train Loss: 0.786 Vali Loss: 8.422 Vali Acc: 0.081 Test Loss: 8.422 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9812654
	speed: 1.1154s/iter; left time: 19842.0924s
	iters: 200, epoch: 15 | loss: 2.7542691
	speed: 0.5075s/iter; left time: 8977.8322s
Epoch: 15 cost time: 105.93223094940186
Epoch: 15, Steps: 208 | Train Loss: 0.725 Vali Loss: 8.589 Vali Acc: 0.071 Test Loss: 8.589 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.8143318
	speed: 1.1251s/iter; left time: 19780.9680s
	iters: 200, epoch: 16 | loss: 1.2027271
	speed: 0.5209s/iter; left time: 9105.7198s
Epoch: 16 cost time: 106.28122639656067
Epoch: 16, Steps: 208 | Train Loss: 0.659 Vali Loss: 8.958 Vali Acc: 0.085 Test Loss: 8.958 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0426085
	speed: 1.1100s/iter; left time: 19283.6832s
	iters: 200, epoch: 17 | loss: 0.8489794
	speed: 0.5214s/iter; left time: 9005.4480s
Epoch: 17 cost time: 105.39560651779175
Epoch: 17, Steps: 208 | Train Loss: 0.616 Vali Loss: 9.175 Vali Acc: 0.072 Test Loss: 9.175 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9203477
	speed: 1.0912s/iter; left time: 18730.3388s
	iters: 200, epoch: 18 | loss: 0.4575605
	speed: 0.4706s/iter; left time: 8031.0017s
Epoch: 18 cost time: 99.91786909103394
Epoch: 18, Steps: 208 | Train Loss: 0.584 Vali Loss: 9.084 Vali Acc: 0.080 Test Loss: 9.084 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0960042
	speed: 1.1167s/iter; left time: 18936.4154s
	iters: 200, epoch: 19 | loss: 0.6167530
	speed: 0.5088s/iter; left time: 8577.3825s
Epoch: 19 cost time: 104.92507314682007
Epoch: 19, Steps: 208 | Train Loss: 0.570 Vali Loss: 9.205 Vali Acc: 0.086 Test Loss: 9.205 Test Acc: 0.086
Validation loss decreased (-0.085221 --> -0.086398).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4815464
	speed: 1.1040s/iter; left time: 18491.4863s
	iters: 200, epoch: 20 | loss: 0.4943452
	speed: 0.5045s/iter; left time: 8399.2203s
Epoch: 20 cost time: 101.72062945365906
Epoch: 20, Steps: 208 | Train Loss: 0.481 Vali Loss: 10.150 Vali Acc: 0.085 Test Loss: 10.150 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3351713
	speed: 1.1250s/iter; left time: 18608.5103s
	iters: 200, epoch: 21 | loss: 0.6110718
	speed: 0.5070s/iter; left time: 8335.3442s
Epoch: 21 cost time: 103.50678014755249
Epoch: 21, Steps: 208 | Train Loss: 0.515 Vali Loss: 9.301 Vali Acc: 0.079 Test Loss: 9.301 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1867559
	speed: 1.1233s/iter; left time: 18346.7483s
	iters: 200, epoch: 22 | loss: 0.2901787
	speed: 0.4512s/iter; left time: 7324.5798s
Epoch: 22 cost time: 100.20416140556335
Epoch: 22, Steps: 208 | Train Loss: 0.541 Vali Loss: 9.568 Vali Acc: 0.083 Test Loss: 9.568 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 2.1911044
	speed: 1.1332s/iter; left time: 18272.2705s
	iters: 200, epoch: 23 | loss: 0.3009627
	speed: 0.4968s/iter; left time: 7961.2064s
Epoch: 23 cost time: 103.84895634651184
Epoch: 23, Steps: 208 | Train Loss: 0.479 Vali Loss: 9.839 Vali Acc: 0.084 Test Loss: 9.839 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4096386
	speed: 1.0862s/iter; left time: 17289.2829s
	iters: 200, epoch: 24 | loss: 0.6944324
	speed: 0.4970s/iter; left time: 7860.3560s
Epoch: 24 cost time: 102.6113452911377
Epoch: 24, Steps: 208 | Train Loss: 0.442 Vali Loss: 9.869 Vali Acc: 0.089 Test Loss: 9.869 Test Acc: 0.089
Validation loss decreased (-0.086398 --> -0.088479).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6132008
	speed: 1.0424s/iter; left time: 16374.3638s
	iters: 200, epoch: 25 | loss: 0.1819833
	speed: 0.4910s/iter; left time: 7663.8283s
Epoch: 25 cost time: 95.46633791923523
Epoch: 25, Steps: 208 | Train Loss: 0.430 Vali Loss: 10.179 Vali Acc: 0.080 Test Loss: 10.179 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.4256045
	speed: 1.1030s/iter; left time: 17098.0206s
	iters: 200, epoch: 26 | loss: 1.7701743
	speed: 0.4954s/iter; left time: 7629.2556s
Epoch: 26 cost time: 102.96172785758972
Epoch: 26, Steps: 208 | Train Loss: 0.425 Vali Loss: 9.323 Vali Acc: 0.085 Test Loss: 9.323 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0358668
	speed: 1.0913s/iter; left time: 16689.1822s
	iters: 200, epoch: 27 | loss: 0.1792517
	speed: 0.4962s/iter; left time: 7538.2219s
Epoch: 27 cost time: 103.28151321411133
Epoch: 27, Steps: 208 | Train Loss: 0.375 Vali Loss: 10.095 Vali Acc: 0.083 Test Loss: 10.095 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0234831
	speed: 1.0581s/iter; left time: 15960.7623s
	iters: 200, epoch: 28 | loss: 0.7571112
	speed: 0.5063s/iter; left time: 7587.1060s
Epoch: 28 cost time: 102.80965209007263
Epoch: 28, Steps: 208 | Train Loss: 0.430 Vali Loss: 10.306 Vali Acc: 0.078 Test Loss: 10.306 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.4502991
	speed: 1.0833s/iter; left time: 16116.6121s
	iters: 200, epoch: 29 | loss: 0.3553432
	speed: 0.4477s/iter; left time: 6615.5233s
Epoch: 29 cost time: 97.39902901649475
Epoch: 29, Steps: 208 | Train Loss: 0.403 Vali Loss: 10.059 Vali Acc: 0.079 Test Loss: 10.059 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0714419
	speed: 1.0335s/iter; left time: 15161.0150s
	iters: 200, epoch: 30 | loss: 0.8179665
	speed: 0.4705s/iter; left time: 6854.0671s
Epoch: 30 cost time: 94.9916090965271
Epoch: 30, Steps: 208 | Train Loss: 0.403 Vali Loss: 10.368 Vali Acc: 0.082 Test Loss: 10.368 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.2112329
	speed: 1.0281s/iter; left time: 14867.4551s
	iters: 200, epoch: 31 | loss: 0.3215543
	speed: 0.4739s/iter; left time: 6806.0075s
Epoch: 31 cost time: 97.94528865814209
Epoch: 31, Steps: 208 | Train Loss: 0.373 Vali Loss: 10.111 Vali Acc: 0.081 Test Loss: 10.111 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.5315414
	speed: 1.0846s/iter; left time: 15459.0168s
	iters: 200, epoch: 32 | loss: 0.2328890
	speed: 0.4354s/iter; left time: 6162.4469s
Epoch: 32 cost time: 95.47386384010315
Epoch: 32, Steps: 208 | Train Loss: 0.375 Vali Loss: 10.331 Vali Acc: 0.080 Test Loss: 10.331 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0386140
	speed: 1.0605s/iter; left time: 14894.5830s
	iters: 200, epoch: 33 | loss: 0.3220915
	speed: 0.4651s/iter; left time: 6485.5454s
Epoch: 33 cost time: 98.97553730010986
Epoch: 33, Steps: 208 | Train Loss: 0.386 Vali Loss: 10.292 Vali Acc: 0.072 Test Loss: 10.292 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0970013
	speed: 1.0488s/iter; left time: 14511.6380s
	iters: 200, epoch: 34 | loss: 0.0482775
	speed: 0.4463s/iter; left time: 6130.5829s
Epoch: 34 cost time: 96.28285813331604
Epoch: 34, Steps: 208 | Train Loss: 0.292 Vali Loss: 10.446 Vali Acc: 0.078 Test Loss: 10.446 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08857739337906352
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.5300827
	speed: 0.4995s/iter; left time: 10340.1277s
	iters: 200, epoch: 1 | loss: 5.0959592
	speed: 0.4661s/iter; left time: 9602.0784s
Epoch: 1 cost time: 100.52167463302612
Epoch: 1, Steps: 208 | Train Loss: 4.620 Vali Loss: 5.261 Vali Acc: 0.058 Test Loss: 5.261 Test Acc: 0.058
Validation loss decreased (inf --> -0.058403).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5782108
	speed: 1.0317s/iter; left time: 21142.4386s
	iters: 200, epoch: 2 | loss: 3.6381161
	speed: 0.4396s/iter; left time: 8963.9556s
Epoch: 2 cost time: 93.08230304718018
Epoch: 2, Steps: 208 | Train Loss: 4.093 Vali Loss: 4.755 Vali Acc: 0.063 Test Loss: 4.755 Test Acc: 0.063
Validation loss decreased (-0.058403 --> -0.062583).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6898665
	speed: 1.0724s/iter; left time: 21753.4924s
	iters: 200, epoch: 3 | loss: 5.0763135
	speed: 0.4791s/iter; left time: 9669.6281s
Epoch: 3 cost time: 99.93284201622009
Epoch: 3, Steps: 208 | Train Loss: 3.610 Vali Loss: 4.545 Vali Acc: 0.054 Test Loss: 4.545 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.9897306
	speed: 1.0850s/iter; left time: 21782.8774s
	iters: 200, epoch: 4 | loss: 4.5001554
	speed: 0.4026s/iter; left time: 8043.1024s
Epoch: 4 cost time: 91.96423768997192
Epoch: 4, Steps: 208 | Train Loss: 3.540 Vali Loss: 4.398 Vali Acc: 0.054 Test Loss: 4.398 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.9732232
	speed: 1.0772s/iter; left time: 21403.3328s
	iters: 200, epoch: 5 | loss: 3.8859448
	speed: 0.4895s/iter; left time: 9676.2451s
Epoch: 5 cost time: 101.64279437065125
Epoch: 5, Steps: 208 | Train Loss: 3.563 Vali Loss: 4.234 Vali Acc: 0.061 Test Loss: 4.234 Test Acc: 0.061
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.6221800
	speed: 1.0913s/iter; left time: 21455.4542s
	iters: 200, epoch: 6 | loss: 4.3832130
	speed: 0.4865s/iter; left time: 9515.7468s
Epoch: 6 cost time: 101.36870074272156
Epoch: 6, Steps: 208 | Train Loss: 3.771 Vali Loss: 4.189 Vali Acc: 0.035 Test Loss: 4.189 Test Acc: 0.035
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.6526985
	speed: 1.0647s/iter; left time: 20712.2613s
	iters: 200, epoch: 7 | loss: 4.2879510
	speed: 0.4724s/iter; left time: 9142.4840s
Epoch: 7 cost time: 100.52059841156006
Epoch: 7, Steps: 208 | Train Loss: 4.095 Vali Loss: 3.972 Vali Acc: 0.038 Test Loss: 3.972 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.9626560
	speed: 1.0774s/iter; left time: 20734.6341s
	iters: 200, epoch: 8 | loss: 3.7706165
	speed: 0.4542s/iter; left time: 8696.0532s
Epoch: 8 cost time: 97.64865732192993
Epoch: 8, Steps: 208 | Train Loss: 3.992 Vali Loss: 3.974 Vali Acc: 0.036 Test Loss: 3.974 Test Acc: 0.036
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 4.2335215
	speed: 1.0155s/iter; left time: 19331.1999s
	iters: 200, epoch: 9 | loss: 4.1832581
	speed: 0.4698s/iter; left time: 8896.2328s
Epoch: 9 cost time: 96.6215431690216
Epoch: 9, Steps: 208 | Train Loss: 3.908 Vali Loss: 3.834 Vali Acc: 0.034 Test Loss: 3.834 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.6528447
	speed: 1.0888s/iter; left time: 20501.1049s
	iters: 200, epoch: 10 | loss: 3.6676569
	speed: 0.4929s/iter; left time: 9232.1803s
Epoch: 10 cost time: 103.03520941734314
Epoch: 10, Steps: 208 | Train Loss: 3.801 Vali Loss: 3.812 Vali Acc: 0.039 Test Loss: 3.812 Test Acc: 0.039
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.5748971
	speed: 1.0854s/iter; left time: 20211.7186s
	iters: 200, epoch: 11 | loss: 3.5726073
	speed: 0.4909s/iter; left time: 9092.1764s
Epoch: 11 cost time: 103.09864497184753
Epoch: 11, Steps: 208 | Train Loss: 3.757 Vali Loss: 3.848 Vali Acc: 0.036 Test Loss: 3.848 Test Acc: 0.036
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6171572
	speed: 1.0867s/iter; left time: 20009.2839s
	iters: 200, epoch: 12 | loss: 3.4366157
	speed: 0.4629s/iter; left time: 8477.5149s
Epoch: 12 cost time: 100.13247561454773
Epoch: 12, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.695 Vali Acc: 0.046 Test Loss: 3.695 Test Acc: 0.046
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06263048016701461
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.5321355
	speed: 0.4986s/iter; left time: 10322.3479s
	iters: 200, epoch: 1 | loss: 4.7073979
	speed: 0.4527s/iter; left time: 9325.5866s
Epoch: 1 cost time: 99.1485743522644
Epoch: 1, Steps: 208 | Train Loss: 4.588 Vali Loss: 5.733 Vali Acc: 0.052 Test Loss: 5.733 Test Acc: 0.052
Validation loss decreased (inf --> -0.052135).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4901061
	speed: 1.1072s/iter; left time: 22690.5212s
	iters: 200, epoch: 2 | loss: 3.8835943
	speed: 0.3952s/iter; left time: 8058.8429s
Epoch: 2 cost time: 92.44785046577454
Epoch: 2, Steps: 208 | Train Loss: 4.368 Vali Loss: 5.202 Vali Acc: 0.059 Test Loss: 5.202 Test Acc: 0.059
Validation loss decreased (-0.052135 --> -0.059000).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8968165
	speed: 1.1009s/iter; left time: 22331.0356s
	iters: 200, epoch: 3 | loss: 5.3079882
	speed: 0.4658s/iter; left time: 9401.7682s
Epoch: 3 cost time: 99.6659414768219
Epoch: 3, Steps: 208 | Train Loss: 3.859 Vali Loss: 4.307 Vali Acc: 0.055 Test Loss: 4.307 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7907696
	speed: 1.0475s/iter; left time: 21031.1660s
	iters: 200, epoch: 4 | loss: 4.7351971
	speed: 0.4436s/iter; left time: 8862.4446s
Epoch: 4 cost time: 93.10031223297119
Epoch: 4, Steps: 208 | Train Loss: 3.746 Vali Loss: 4.259 Vali Acc: 0.059 Test Loss: 4.259 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.7942584
	speed: 1.0374s/iter; left time: 20611.9791s
	iters: 200, epoch: 5 | loss: 4.5686588
	speed: 0.4896s/iter; left time: 9677.9480s
Epoch: 5 cost time: 99.7186586856842
Epoch: 5, Steps: 208 | Train Loss: 3.873 Vali Loss: 4.203 Vali Acc: 0.033 Test Loss: 4.203 Test Acc: 0.033
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.8933046
	speed: 1.0531s/iter; left time: 20704.1921s
	iters: 200, epoch: 6 | loss: 4.6448345
	speed: 0.4752s/iter; left time: 9295.0317s
Epoch: 6 cost time: 96.04901695251465
Epoch: 6, Steps: 208 | Train Loss: 4.149 Vali Loss: 4.115 Vali Acc: 0.033 Test Loss: 4.115 Test Acc: 0.033
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.4620066
	speed: 1.0539s/iter; left time: 20501.3999s
	iters: 200, epoch: 7 | loss: 4.2806344
	speed: 0.4596s/iter; left time: 8895.5100s
Epoch: 7 cost time: 95.22760677337646
Epoch: 7, Steps: 208 | Train Loss: 4.169 Vali Loss: 4.028 Vali Acc: 0.030 Test Loss: 4.028 Test Acc: 0.030
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.6691043
	speed: 1.0629s/iter; left time: 20454.9322s
	iters: 200, epoch: 8 | loss: 3.9478750
	speed: 0.4788s/iter; left time: 9166.1415s
Epoch: 8 cost time: 99.16736197471619
Epoch: 8, Steps: 208 | Train Loss: 3.946 Vali Loss: 3.881 Vali Acc: 0.026 Test Loss: 3.881 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.7979929
	speed: 1.0257s/iter; left time: 19526.0170s
	iters: 200, epoch: 9 | loss: 3.7069159
	speed: 0.4679s/iter; left time: 8859.8455s
Epoch: 9 cost time: 94.44867539405823
Epoch: 9, Steps: 208 | Train Loss: 3.878 Vali Loss: 3.875 Vali Acc: 0.033 Test Loss: 3.875 Test Acc: 0.033
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.7528088
	speed: 1.0457s/iter; left time: 19689.9078s
	iters: 200, epoch: 10 | loss: 3.7763174
	speed: 0.4713s/iter; left time: 8826.7816s
Epoch: 10 cost time: 98.34672093391418
Epoch: 10, Steps: 208 | Train Loss: 3.812 Vali Loss: 3.797 Vali Acc: 0.047 Test Loss: 3.797 Test Acc: 0.047
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.5335002
	speed: 1.0629s/iter; left time: 19791.5664s
	iters: 200, epoch: 11 | loss: 3.8356197
	speed: 0.4394s/iter; left time: 8137.8864s
Epoch: 11 cost time: 95.33685088157654
Epoch: 11, Steps: 208 | Train Loss: 3.730 Vali Loss: 3.711 Vali Acc: 0.051 Test Loss: 3.711 Test Acc: 0.051
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.4980607
	speed: 1.0399s/iter; left time: 19148.2904s
	iters: 200, epoch: 12 | loss: 3.5842564
	speed: 0.4610s/iter; left time: 8443.0053s
Epoch: 12 cost time: 95.75051665306091
Epoch: 12, Steps: 208 | Train Loss: 3.675 Vali Loss: 3.677 Vali Acc: 0.038 Test Loss: 3.677 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05905159558604235
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.7371860
	speed: 0.4871s/iter; left time: 10083.6684s
	iters: 200, epoch: 1 | loss: 5.2273979
	speed: 0.4382s/iter; left time: 9026.9012s
Epoch: 1 cost time: 95.60559272766113
Epoch: 1, Steps: 208 | Train Loss: 4.453 Vali Loss: 6.238 Vali Acc: 0.030 Test Loss: 6.238 Test Acc: 0.030
Validation loss decreased (inf --> -0.030358).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6909633
	speed: 1.0282s/iter; left time: 21071.7156s
	iters: 200, epoch: 2 | loss: 3.6306369
	speed: 0.4710s/iter; left time: 9605.6231s
Epoch: 2 cost time: 96.90365028381348
Epoch: 2, Steps: 208 | Train Loss: 4.460 Vali Loss: 5.516 Vali Acc: 0.035 Test Loss: 5.516 Test Acc: 0.035
Validation loss decreased (-0.030358 --> -0.035137).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8988893
	speed: 1.0659s/iter; left time: 21621.9255s
	iters: 200, epoch: 3 | loss: 6.1319394
	speed: 0.4606s/iter; left time: 9297.7181s
Epoch: 3 cost time: 96.50335192680359
Epoch: 3, Steps: 208 | Train Loss: 4.144 Vali Loss: 4.649 Vali Acc: 0.046 Test Loss: 4.649 Test Acc: 0.046
Validation loss decreased (-0.035137 --> -0.045883).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1166687
	speed: 1.0332s/iter; left time: 20743.5910s
	iters: 200, epoch: 4 | loss: 4.0152159
	speed: 0.4424s/iter; left time: 8838.7105s
Epoch: 4 cost time: 90.28902912139893
Epoch: 4, Steps: 208 | Train Loss: 4.185 Vali Loss: 4.382 Vali Acc: 0.044 Test Loss: 4.382 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.4744978
	speed: 1.0403s/iter; left time: 20670.2949s
	iters: 200, epoch: 5 | loss: 4.4067645
	speed: 0.4598s/iter; left time: 9089.7440s
Epoch: 5 cost time: 96.18558883666992
Epoch: 5, Steps: 208 | Train Loss: 4.322 Vali Loss: 4.238 Vali Acc: 0.027 Test Loss: 4.238 Test Acc: 0.027
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 4.3609924
	speed: 1.0807s/iter; left time: 21247.6691s
	iters: 200, epoch: 6 | loss: 4.7983823
	speed: 0.4620s/iter; left time: 9037.5384s
Epoch: 6 cost time: 97.57423520088196
Epoch: 6, Steps: 208 | Train Loss: 4.226 Vali Loss: 4.115 Vali Acc: 0.032 Test Loss: 4.115 Test Acc: 0.032
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 4.1245689
	speed: 1.0563s/iter; left time: 20548.1562s
	iters: 200, epoch: 7 | loss: 4.5512948
	speed: 0.4721s/iter; left time: 9137.1216s
Epoch: 7 cost time: 97.58251619338989
Epoch: 7, Steps: 208 | Train Loss: 4.096 Vali Loss: 3.947 Vali Acc: 0.031 Test Loss: 3.947 Test Acc: 0.031
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.7627273
	speed: 1.0188s/iter; left time: 19607.5226s
	iters: 200, epoch: 8 | loss: 3.9294000
	speed: 0.4465s/iter; left time: 8547.7815s
Epoch: 8 cost time: 92.3916220664978
Epoch: 8, Steps: 208 | Train Loss: 3.979 Vali Loss: 3.962 Vali Acc: 0.022 Test Loss: 3.962 Test Acc: 0.022
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.8128684
	speed: 1.0619s/iter; left time: 20215.9772s
	iters: 200, epoch: 9 | loss: 4.0764303
	speed: 0.4493s/iter; left time: 8508.0310s
Epoch: 9 cost time: 96.08682036399841
Epoch: 9, Steps: 208 | Train Loss: 3.917 Vali Loss: 3.833 Vali Acc: 0.035 Test Loss: 3.833 Test Acc: 0.035
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.9877429
	speed: 1.0913s/iter; left time: 20548.9935s
	iters: 200, epoch: 10 | loss: 3.9969084
	speed: 0.4562s/iter; left time: 8544.7189s
Epoch: 10 cost time: 98.01371169090271
Epoch: 10, Steps: 208 | Train Loss: 3.828 Vali Loss: 3.845 Vali Acc: 0.028 Test Loss: 3.845 Test Acc: 0.028
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.8103986
	speed: 1.1089s/iter; left time: 20648.1592s
	iters: 200, epoch: 11 | loss: 3.7711070
	speed: 0.4748s/iter; left time: 8794.2488s
Epoch: 11 cost time: 100.70520210266113
Epoch: 11, Steps: 208 | Train Loss: 3.758 Vali Loss: 3.737 Vali Acc: 0.040 Test Loss: 3.737 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.7627738
	speed: 1.0748s/iter; left time: 19790.0567s
	iters: 200, epoch: 12 | loss: 3.5929360
	speed: 0.4800s/iter; left time: 8790.6648s
Epoch: 12 cost time: 100.24925351142883
Epoch: 12, Steps: 208 | Train Loss: 3.678 Vali Loss: 3.675 Vali Acc: 0.041 Test Loss: 3.675 Test Acc: 0.041
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.5577340
	speed: 1.1283s/iter; left time: 20540.8467s
	iters: 200, epoch: 13 | loss: 3.6521380
	speed: 0.4620s/iter; left time: 8364.5693s
Epoch: 13 cost time: 99.8171956539154
Epoch: 13, Steps: 208 | Train Loss: 3.647 Vali Loss: 3.679 Vali Acc: 0.042 Test Loss: 3.679 Test Acc: 0.042
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.04592901878914405
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.4264660
	speed: 0.4938s/iter; left time: 10222.2187s
	iters: 200, epoch: 1 | loss: 5.1007323
	speed: 0.4756s/iter; left time: 9797.5026s
Epoch: 1 cost time: 100.9322190284729
Epoch: 1, Steps: 208 | Train Loss: 4.321 Vali Loss: 7.425 Vali Acc: 0.029 Test Loss: 7.425 Test Acc: 0.029
Validation loss decreased (inf --> -0.028855).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.3455176
	speed: 1.0981s/iter; left time: 22503.0338s
	iters: 200, epoch: 2 | loss: 5.9703293
	speed: 0.4485s/iter; left time: 9145.2850s
Epoch: 2 cost time: 97.68639802932739
Epoch: 2, Steps: 208 | Train Loss: 5.121 Vali Loss: 6.764 Vali Acc: 0.035 Test Loss: 6.764 Test Acc: 0.035
Validation loss decreased (-0.028855 --> -0.035423).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.0377946
	speed: 1.0766s/iter; left time: 21838.1001s
	iters: 200, epoch: 3 | loss: 5.9499254
	speed: 0.4800s/iter; left time: 9688.3864s
Epoch: 3 cost time: 99.53829050064087
Epoch: 3, Steps: 208 | Train Loss: 4.905 Vali Loss: 4.822 Vali Acc: 0.035 Test Loss: 4.822 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.7240996
	speed: 1.0496s/iter; left time: 21072.5889s
	iters: 200, epoch: 4 | loss: 4.5449581
	speed: 0.4688s/iter; left time: 9365.7452s
Epoch: 4 cost time: 96.25739789009094
Epoch: 4, Steps: 208 | Train Loss: 4.573 Vali Loss: 4.361 Vali Acc: 0.032 Test Loss: 4.361 Test Acc: 0.032
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.6119304
	speed: 1.0184s/iter; left time: 20234.6498s
	iters: 200, epoch: 5 | loss: 4.2166638
	speed: 0.4557s/iter; left time: 9009.3804s
Epoch: 5 cost time: 92.09456396102905
Epoch: 5, Steps: 208 | Train Loss: 4.344 Vali Loss: 4.284 Vali Acc: 0.027 Test Loss: 4.284 Test Acc: 0.027
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.6286459
	speed: 1.0523s/iter; left time: 20690.2058s
	iters: 200, epoch: 6 | loss: 3.9100504
	speed: 0.4635s/iter; left time: 9066.8405s
Epoch: 6 cost time: 97.28316760063171
Epoch: 6, Steps: 208 | Train Loss: 4.122 Vali Loss: 4.061 Vali Acc: 0.029 Test Loss: 4.061 Test Acc: 0.029
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.7809408
	speed: 1.0794s/iter; left time: 20997.8527s
	iters: 200, epoch: 7 | loss: 3.9112322
	speed: 0.4394s/iter; left time: 8503.4373s
Epoch: 7 cost time: 95.3983404636383
Epoch: 7, Steps: 208 | Train Loss: 3.950 Vali Loss: 3.775 Vali Acc: 0.028 Test Loss: 3.775 Test Acc: 0.028
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.9040365
	speed: 1.0403s/iter; left time: 20020.8472s
	iters: 200, epoch: 8 | loss: 3.6163573
	speed: 0.4771s/iter; left time: 9134.8808s
Epoch: 8 cost time: 100.10487771034241
Epoch: 8, Steps: 208 | Train Loss: 3.829 Vali Loss: 3.834 Vali Acc: 0.026 Test Loss: 3.834 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.8605843
	speed: 1.0933s/iter; left time: 20812.6674s
	iters: 200, epoch: 9 | loss: 3.8513045
	speed: 0.4873s/iter; left time: 9227.6326s
Epoch: 9 cost time: 101.63910698890686
Epoch: 9, Steps: 208 | Train Loss: 3.772 Vali Loss: 3.742 Vali Acc: 0.030 Test Loss: 3.742 Test Acc: 0.030
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.6757188
	speed: 1.0702s/iter; left time: 20151.3869s
	iters: 200, epoch: 10 | loss: 3.7333441
	speed: 0.4306s/iter; left time: 8065.4133s
Epoch: 10 cost time: 95.35134220123291
Epoch: 10, Steps: 208 | Train Loss: 3.739 Vali Loss: 3.759 Vali Acc: 0.031 Test Loss: 3.759 Test Acc: 0.031
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.6652029
	speed: 1.0621s/iter; left time: 19776.4362s
	iters: 200, epoch: 11 | loss: 3.8509402
	speed: 0.4818s/iter; left time: 8922.5428s
Epoch: 11 cost time: 99.26287126541138
Epoch: 11, Steps: 208 | Train Loss: 3.711 Vali Loss: 3.752 Vali Acc: 0.029 Test Loss: 3.752 Test Acc: 0.029
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6694925
	speed: 1.0432s/iter; left time: 19209.2797s
	iters: 200, epoch: 12 | loss: 3.6437442
	speed: 0.4761s/iter; left time: 8717.9552s
Epoch: 12 cost time: 98.41206550598145
Epoch: 12, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.699 Vali Acc: 0.040 Test Loss: 3.699 Test Acc: 0.040
Validation loss decreased (-0.035423 --> -0.039629).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.7622211
	speed: 1.0331s/iter; left time: 18807.2758s
	iters: 200, epoch: 13 | loss: 3.5941343
	speed: 0.4462s/iter; left time: 8078.4189s
Epoch: 13 cost time: 93.57413744926453
Epoch: 13, Steps: 208 | Train Loss: 3.680 Vali Loss: 3.665 Vali Acc: 0.044 Test Loss: 3.665 Test Acc: 0.044
Validation loss decreased (-0.039629 --> -0.043805).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.8805380
	speed: 1.0481s/iter; left time: 18863.3620s
	iters: 200, epoch: 14 | loss: 3.6647153
	speed: 0.4770s/iter; left time: 8536.1658s
Epoch: 14 cost time: 99.48426175117493
Epoch: 14, Steps: 208 | Train Loss: 3.647 Vali Loss: 3.666 Vali Acc: 0.042 Test Loss: 3.666 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 3.5062296
	speed: 1.0231s/iter; left time: 18199.4043s
	iters: 200, epoch: 15 | loss: 3.7303100
	speed: 0.4653s/iter; left time: 8231.0586s
Epoch: 15 cost time: 94.45595407485962
Epoch: 15, Steps: 208 | Train Loss: 3.649 Vali Loss: 3.691 Vali Acc: 0.031 Test Loss: 3.691 Test Acc: 0.031
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 3.6126001
	speed: 1.0442s/iter; left time: 18357.5604s
	iters: 200, epoch: 16 | loss: 3.5374362
	speed: 0.4653s/iter; left time: 8134.4887s
Epoch: 16 cost time: 98.26756596565247
Epoch: 16, Steps: 208 | Train Loss: 3.635 Vali Loss: 3.641 Vali Acc: 0.041 Test Loss: 3.641 Test Acc: 0.041
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 3.7773912
	speed: 1.0111s/iter; left time: 17566.4650s
	iters: 200, epoch: 17 | loss: 3.6109078
	speed: 0.4545s/iter; left time: 7851.4150s
Epoch: 17 cost time: 94.04162263870239
Epoch: 17, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.638 Vali Acc: 0.044 Test Loss: 3.638 Test Acc: 0.044
Validation loss decreased (-0.043805 --> -0.043805).  Saving model ...
	iters: 100, epoch: 18 | loss: 3.8115697
	speed: 1.0427s/iter; left time: 17897.4553s
	iters: 200, epoch: 18 | loss: 3.7661774
	speed: 0.4728s/iter; left time: 8068.7359s
Epoch: 18 cost time: 96.61227035522461
Epoch: 18, Steps: 208 | Train Loss: 3.583 Vali Loss: 3.635 Vali Acc: 0.039 Test Loss: 3.635 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 3.4855402
	speed: 1.0093s/iter; left time: 17113.9698s
	iters: 200, epoch: 19 | loss: 3.6622481
	speed: 0.4436s/iter; left time: 7476.9856s
Epoch: 19 cost time: 90.09049272537231
Epoch: 19, Steps: 208 | Train Loss: 3.581 Vali Loss: 3.634 Vali Acc: 0.048 Test Loss: 3.634 Test Acc: 0.048
Validation loss decreased (-0.043805 --> -0.047980).  Saving model ...
	iters: 100, epoch: 20 | loss: 3.7653770
	speed: 1.0218s/iter; left time: 17113.3257s
	iters: 200, epoch: 20 | loss: 3.4182107
	speed: 0.4415s/iter; left time: 7349.7451s
Epoch: 20 cost time: 94.10777473449707
Epoch: 20, Steps: 208 | Train Loss: 3.574 Vali Loss: 3.614 Vali Acc: 0.047 Test Loss: 3.614 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 3.5069685
	speed: 1.0284s/iter; left time: 17011.5045s
	iters: 200, epoch: 21 | loss: 3.5278780
	speed: 0.4455s/iter; left time: 7323.8179s
Epoch: 21 cost time: 95.00631642341614
Epoch: 21, Steps: 208 | Train Loss: 3.557 Vali Loss: 3.594 Vali Acc: 0.049 Test Loss: 3.594 Test Acc: 0.049
Validation loss decreased (-0.047980 --> -0.048875).  Saving model ...
	iters: 100, epoch: 22 | loss: 3.6630816
	speed: 1.0388s/iter; left time: 16966.5036s
	iters: 200, epoch: 22 | loss: 3.4564116
	speed: 0.4449s/iter; left time: 7222.7003s
Epoch: 22 cost time: 94.27202582359314
Epoch: 22, Steps: 208 | Train Loss: 3.526 Vali Loss: 3.624 Vali Acc: 0.045 Test Loss: 3.624 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 3.1039028
	speed: 0.9896s/iter; left time: 15957.1487s
	iters: 200, epoch: 23 | loss: 3.4815109
	speed: 0.4381s/iter; left time: 7020.5404s
Epoch: 23 cost time: 92.1734926700592
Epoch: 23, Steps: 208 | Train Loss: 3.496 Vali Loss: 3.632 Vali Acc: 0.047 Test Loss: 3.632 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 3.5499158
	speed: 0.9882s/iter; left time: 15729.8934s
	iters: 200, epoch: 24 | loss: 3.3165267
	speed: 0.4320s/iter; left time: 6832.7138s
Epoch: 24 cost time: 89.93382716178894
Epoch: 24, Steps: 208 | Train Loss: 3.455 Vali Loss: 3.686 Vali Acc: 0.046 Test Loss: 3.686 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 3.3508265
	speed: 1.0596s/iter; left time: 16645.5416s
	iters: 200, epoch: 25 | loss: 3.5109906
	speed: 0.5175s/iter; left time: 8078.3042s
Epoch: 25 cost time: 107.18359208106995
Epoch: 25, Steps: 208 | Train Loss: 3.444 Vali Loss: 3.667 Vali Acc: 0.047 Test Loss: 3.667 Test Acc: 0.047
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 3.0217004
	speed: 1.0885s/iter; left time: 16873.2542s
	iters: 200, epoch: 26 | loss: 3.4206729
	speed: 0.4529s/iter; left time: 6974.8003s
Epoch: 26 cost time: 94.79049468040466
Epoch: 26, Steps: 208 | Train Loss: 3.420 Vali Loss: 3.660 Vali Acc: 0.038 Test Loss: 3.660 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 3.1464646
	speed: 1.0371s/iter; left time: 15860.6445s
	iters: 200, epoch: 27 | loss: 3.2579343
	speed: 0.4650s/iter; left time: 7064.9896s
Epoch: 27 cost time: 96.510573387146
Epoch: 27, Steps: 208 | Train Loss: 3.386 Vali Loss: 3.670 Vali Acc: 0.049 Test Loss: 3.670 Test Acc: 0.049
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 3.1953824
	speed: 1.0100s/iter; left time: 15235.3041s
	iters: 200, epoch: 28 | loss: 3.5028281
	speed: 0.4365s/iter; left time: 6541.3814s
Epoch: 28 cost time: 91.93949317932129
Epoch: 28, Steps: 208 | Train Loss: 3.373 Vali Loss: 3.713 Vali Acc: 0.051 Test Loss: 3.713 Test Acc: 0.051
Validation loss decreased (-0.048875 --> -0.050664).  Saving model ...
	iters: 100, epoch: 29 | loss: 3.2782941
	speed: 1.0112s/iter; left time: 15042.8833s
	iters: 200, epoch: 29 | loss: 3.1537139
	speed: 0.4330s/iter; left time: 6398.4620s
Epoch: 29 cost time: 92.7466311454773
Epoch: 29, Steps: 208 | Train Loss: 3.319 Vali Loss: 3.787 Vali Acc: 0.050 Test Loss: 3.787 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 3.1247897
	speed: 1.0277s/iter; left time: 15074.7838s
	iters: 200, epoch: 30 | loss: 3.2648017
	speed: 0.4266s/iter; left time: 6214.6740s
Epoch: 30 cost time: 92.16895985603333
Epoch: 30, Steps: 208 | Train Loss: 3.284 Vali Loss: 3.733 Vali Acc: 0.050 Test Loss: 3.733 Test Acc: 0.050
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 3.4304140
	speed: 0.9719s/iter; left time: 14054.5716s
	iters: 200, epoch: 31 | loss: 3.1870034
	speed: 0.4593s/iter; left time: 6596.0704s
Epoch: 31 cost time: 93.17356300354004
Epoch: 31, Steps: 208 | Train Loss: 3.225 Vali Loss: 3.884 Vali Acc: 0.050 Test Loss: 3.884 Test Acc: 0.050
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 3.4409745
	speed: 1.0115s/iter; left time: 14416.2079s
	iters: 200, epoch: 32 | loss: 3.1251187
	speed: 0.4412s/iter; left time: 6244.0970s
Epoch: 32 cost time: 93.25700116157532
Epoch: 32, Steps: 208 | Train Loss: 3.181 Vali Loss: 3.832 Vali Acc: 0.051 Test Loss: 3.832 Test Acc: 0.051
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 2.9409823
	speed: 0.9813s/iter; left time: 13781.7715s
	iters: 200, epoch: 33 | loss: 3.2642360
	speed: 0.4345s/iter; left time: 6058.7344s
Epoch: 33 cost time: 89.17184567451477
Epoch: 33, Steps: 208 | Train Loss: 3.118 Vali Loss: 3.914 Vali Acc: 0.048 Test Loss: 3.914 Test Acc: 0.048
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 3.0404623
	speed: 1.0003s/iter; left time: 13841.3585s
	iters: 200, epoch: 34 | loss: 2.7837875
	speed: 0.4425s/iter; left time: 6079.0954s
Epoch: 34 cost time: 92.35969805717468
Epoch: 34, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.961 Vali Acc: 0.055 Test Loss: 3.961 Test Acc: 0.055
Validation loss decreased (-0.050664 --> -0.054538).  Saving model ...
	iters: 100, epoch: 35 | loss: 3.0603220
	speed: 0.9619s/iter; left time: 13109.3979s
	iters: 200, epoch: 35 | loss: 3.0056601
	speed: 0.4366s/iter; left time: 5906.7624s
Epoch: 35 cost time: 89.74304103851318
Epoch: 35, Steps: 208 | Train Loss: 2.964 Vali Loss: 4.039 Vali Acc: 0.051 Test Loss: 4.039 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 3.2151771
	speed: 0.9836s/iter; left time: 13200.8651s
	iters: 200, epoch: 36 | loss: 2.5844712
	speed: 0.3947s/iter; left time: 5257.3367s
Epoch: 36 cost time: 86.51497387886047
Epoch: 36, Steps: 208 | Train Loss: 2.859 Vali Loss: 4.170 Vali Acc: 0.049 Test Loss: 4.170 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 2.5364535
	speed: 1.0066s/iter; left time: 13300.6567s
	iters: 200, epoch: 37 | loss: 2.7085814
	speed: 0.4192s/iter; left time: 5496.6850s
Epoch: 37 cost time: 90.80368232727051
Epoch: 37, Steps: 208 | Train Loss: 2.776 Vali Loss: 4.218 Vali Acc: 0.052 Test Loss: 4.218 Test Acc: 0.052
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 2.4831982
	speed: 1.0127s/iter; left time: 13170.3199s
	iters: 200, epoch: 38 | loss: 2.8734128
	speed: 0.4003s/iter; left time: 5165.8617s
Epoch: 38 cost time: 88.53680801391602
Epoch: 38, Steps: 208 | Train Loss: 2.683 Vali Loss: 4.293 Vali Acc: 0.053 Test Loss: 4.293 Test Acc: 0.053
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 2.4876420
	speed: 0.9835s/iter; left time: 12585.7533s
	iters: 200, epoch: 39 | loss: 2.7817070
	speed: 0.4281s/iter; left time: 5435.6443s
Epoch: 39 cost time: 88.84236693382263
Epoch: 39, Steps: 208 | Train Loss: 2.535 Vali Loss: 4.479 Vali Acc: 0.048 Test Loss: 4.479 Test Acc: 0.048
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 1.8119179
	speed: 0.9759s/iter; left time: 12285.1808s
	iters: 200, epoch: 40 | loss: 2.0673113
	speed: 0.4071s/iter; left time: 5084.8853s
Epoch: 40 cost time: 89.04643630981445
Epoch: 40, Steps: 208 | Train Loss: 2.438 Vali Loss: 4.575 Vali Acc: 0.051 Test Loss: 4.575 Test Acc: 0.051
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 2.6407773
	speed: 0.9861s/iter; left time: 12208.5126s
	iters: 200, epoch: 41 | loss: 2.1091404
	speed: 0.4370s/iter; left time: 5366.8936s
Epoch: 41 cost time: 91.62987017631531
Epoch: 41, Steps: 208 | Train Loss: 2.265 Vali Loss: 4.937 Vali Acc: 0.056 Test Loss: 4.937 Test Acc: 0.056
Validation loss decreased (-0.054538 --> -0.055722).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.9701922
	speed: 0.9791s/iter; left time: 11918.3536s
	iters: 200, epoch: 42 | loss: 2.3345652
	speed: 0.3961s/iter; left time: 4781.5404s
Epoch: 42 cost time: 86.9905366897583
Epoch: 42, Steps: 208 | Train Loss: 2.085 Vali Loss: 5.241 Vali Acc: 0.046 Test Loss: 5.241 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.5903254
	speed: 0.9714s/iter; left time: 11622.8430s
	iters: 200, epoch: 43 | loss: 1.7269802
	speed: 0.4382s/iter; left time: 5199.5933s
Epoch: 43 cost time: 89.8858368396759
Epoch: 43, Steps: 208 | Train Loss: 1.954 Vali Loss: 5.435 Vali Acc: 0.052 Test Loss: 5.435 Test Acc: 0.052
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.5059395
	speed: 0.9798s/iter; left time: 11519.6537s
	iters: 200, epoch: 44 | loss: 1.7740812
	speed: 0.4287s/iter; left time: 4997.4726s
Epoch: 44 cost time: 90.35082292556763
Epoch: 44, Steps: 208 | Train Loss: 1.827 Vali Loss: 5.542 Vali Acc: 0.053 Test Loss: 5.542 Test Acc: 0.053
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 2.1572416
	speed: 0.9996s/iter; left time: 11544.9543s
	iters: 200, epoch: 45 | loss: 1.2608740
	speed: 0.4215s/iter; left time: 4826.1286s
Epoch: 45 cost time: 89.64196348190308
Epoch: 45, Steps: 208 | Train Loss: 1.631 Vali Loss: 5.869 Vali Acc: 0.050 Test Loss: 5.869 Test Acc: 0.050
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 1.2505612
	speed: 0.9507s/iter; left time: 10781.4030s
	iters: 200, epoch: 46 | loss: 1.8822808
	speed: 0.4319s/iter; left time: 4855.3263s
Epoch: 46 cost time: 90.84227395057678
Epoch: 46, Steps: 208 | Train Loss: 1.491 Vali Loss: 6.240 Vali Acc: 0.047 Test Loss: 6.240 Test Acc: 0.047
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 1.7010851
	speed: 0.9585s/iter; left time: 10671.4985s
	iters: 200, epoch: 47 | loss: 1.1247706
	speed: 0.5232s/iter; left time: 5772.2772s
Epoch: 47 cost time: 97.29515433311462
Epoch: 47, Steps: 208 | Train Loss: 1.314 Vali Loss: 6.626 Vali Acc: 0.054 Test Loss: 6.626 Test Acc: 0.054
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 1.3405752
	speed: 1.1845s/iter; left time: 12940.4356s
	iters: 200, epoch: 48 | loss: 0.6320888
	speed: 0.5228s/iter; left time: 5659.7274s
Epoch: 48 cost time: 113.61699962615967
Epoch: 48, Steps: 208 | Train Loss: 1.151 Vali Loss: 7.392 Vali Acc: 0.051 Test Loss: 7.392 Test Acc: 0.051
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 1.1354786
	speed: 1.1275s/iter; left time: 12083.6353s
	iters: 200, epoch: 49 | loss: 1.0800045
	speed: 0.5284s/iter; left time: 5610.4467s
Epoch: 49 cost time: 106.44932794570923
Epoch: 49, Steps: 208 | Train Loss: 1.053 Vali Loss: 7.645 Vali Acc: 0.051 Test Loss: 7.645 Test Acc: 0.051
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 1.1897677
	speed: 1.1253s/iter; left time: 11825.7139s
	iters: 200, epoch: 50 | loss: 1.1958723
	speed: 0.5461s/iter; left time: 5684.7824s
Epoch: 50 cost time: 108.81966853141785
Epoch: 50, Steps: 208 | Train Loss: 0.953 Vali Loss: 7.970 Vali Acc: 0.053 Test Loss: 7.970 Test Acc: 0.053
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 0.2018935
	speed: 1.1183s/iter; left time: 11519.9829s
	iters: 200, epoch: 51 | loss: 1.5966060
	speed: 0.5273s/iter; left time: 5378.6345s
Epoch: 51 cost time: 106.84604001045227
Epoch: 51, Steps: 208 | Train Loss: 0.870 Vali Loss: 8.508 Vali Acc: 0.053 Test Loss: 8.508 Test Acc: 0.053
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05577095138681778
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3122096
	speed: 0.5381s/iter; left time: 11138.9613s
	iters: 200, epoch: 1 | loss: 4.7200298
	speed: 0.5194s/iter; left time: 10700.9207s
Epoch: 1 cost time: 109.24058508872986
Epoch: 1, Steps: 208 | Train Loss: 4.271 Vali Loss: 7.077 Vali Acc: 0.032 Test Loss: 7.077 Test Acc: 0.032
Validation loss decreased (inf --> -0.032139).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.0031352
	speed: 1.0817s/iter; left time: 22167.2123s
	iters: 200, epoch: 2 | loss: 4.3797302
	speed: 0.5389s/iter; left time: 10989.5436s
Epoch: 2 cost time: 107.84446907043457
Epoch: 2, Steps: 208 | Train Loss: 4.664 Vali Loss: 5.887 Vali Acc: 0.044 Test Loss: 5.887 Test Acc: 0.044
Validation loss decreased (-0.032139 --> -0.044379).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0674410
	speed: 1.1005s/iter; left time: 22323.9770s
	iters: 200, epoch: 3 | loss: 5.2702560
	speed: 0.5224s/iter; left time: 10544.3181s
Epoch: 3 cost time: 109.01180338859558
Epoch: 3, Steps: 208 | Train Loss: 4.441 Vali Loss: 4.791 Vali Acc: 0.041 Test Loss: 4.791 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.2057672
	speed: 1.1572s/iter; left time: 23232.2990s
	iters: 200, epoch: 4 | loss: 5.2026248
	speed: 0.5375s/iter; left time: 10737.3285s
Epoch: 4 cost time: 110.83728432655334
Epoch: 4, Steps: 208 | Train Loss: 4.196 Vali Loss: 4.561 Vali Acc: 0.055 Test Loss: 4.561 Test Acc: 0.055
Validation loss decreased (-0.044379 --> -0.054532).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9586403
	speed: 1.0469s/iter; left time: 20800.1838s
	iters: 200, epoch: 5 | loss: 4.8925581
	speed: 0.5580s/iter; left time: 11031.6921s
Epoch: 5 cost time: 104.14517617225647
Epoch: 5, Steps: 208 | Train Loss: 4.429 Vali Loss: 4.181 Vali Acc: 0.035 Test Loss: 4.181 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.5226083
	speed: 1.1214s/iter; left time: 22048.0171s
	iters: 200, epoch: 6 | loss: 4.2788873
	speed: 0.5031s/iter; left time: 9841.6502s
Epoch: 6 cost time: 108.44702315330505
Epoch: 6, Steps: 208 | Train Loss: 4.367 Vali Loss: 4.259 Vali Acc: 0.035 Test Loss: 4.259 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.1271396
	speed: 1.0602s/iter; left time: 20624.8390s
	iters: 200, epoch: 7 | loss: 3.6881185
	speed: 0.4668s/iter; left time: 9033.8113s
Epoch: 7 cost time: 98.896413564682
Epoch: 7, Steps: 208 | Train Loss: 4.218 Vali Loss: 3.983 Vali Acc: 0.031 Test Loss: 3.983 Test Acc: 0.031
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 4.1210456
	speed: 1.0662s/iter; left time: 20518.6254s
	iters: 200, epoch: 8 | loss: 4.1347485
	speed: 0.4883s/iter; left time: 9348.7733s
Epoch: 8 cost time: 100.28129363059998
Epoch: 8, Steps: 208 | Train Loss: 3.946 Vali Loss: 3.899 Vali Acc: 0.030 Test Loss: 3.899 Test Acc: 0.030
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.7149186
	speed: 1.0649s/iter; left time: 20271.6015s
	iters: 200, epoch: 9 | loss: 3.7869942
	speed: 0.5034s/iter; left time: 9532.3579s
Epoch: 9 cost time: 104.06546187400818
Epoch: 9, Steps: 208 | Train Loss: 3.900 Vali Loss: 3.787 Vali Acc: 0.034 Test Loss: 3.787 Test Acc: 0.034
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.8323107
	speed: 1.1364s/iter; left time: 21397.4791s
	iters: 200, epoch: 10 | loss: 3.8126540
	speed: 0.4788s/iter; left time: 8967.1234s
Epoch: 10 cost time: 102.74276947975159
Epoch: 10, Steps: 208 | Train Loss: 3.815 Vali Loss: 3.782 Vali Acc: 0.034 Test Loss: 3.782 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7393637
	speed: 1.1380s/iter; left time: 21190.8577s
	iters: 200, epoch: 11 | loss: 3.6532786
	speed: 0.5290s/iter; left time: 9798.3839s
Epoch: 11 cost time: 109.05144500732422
Epoch: 11, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.734 Vali Acc: 0.039 Test Loss: 3.734 Test Acc: 0.039
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 4.0630655
	speed: 1.0480s/iter; left time: 19296.0564s
	iters: 200, epoch: 12 | loss: 3.5679886
	speed: 0.4912s/iter; left time: 8994.9486s
Epoch: 12 cost time: 99.77024102210999
Epoch: 12, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.672 Vali Acc: 0.046 Test Loss: 3.672 Test Acc: 0.046
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.5445778
	speed: 1.0284s/iter; left time: 18722.5635s
	iters: 200, epoch: 13 | loss: 3.6289716
	speed: 0.4641s/iter; left time: 8402.0735s
Epoch: 13 cost time: 97.53192138671875
Epoch: 13, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.703 Vali Acc: 0.046 Test Loss: 3.703 Test Acc: 0.046
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6794167
	speed: 1.0523s/iter; left time: 18937.5653s
	iters: 200, epoch: 14 | loss: 3.7989690
	speed: 0.4499s/iter; left time: 8052.5401s
Epoch: 14 cost time: 97.92742443084717
Epoch: 14, Steps: 208 | Train Loss: 3.676 Vali Loss: 3.673 Vali Acc: 0.041 Test Loss: 3.673 Test Acc: 0.041
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05457798985982702
model parameter : 21152295
model size : 100.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.7097974
	speed: 0.5735s/iter; left time: 11872.4904s
	iters: 200, epoch: 1 | loss: 3.2557874
	speed: 0.5345s/iter; left time: 11011.5638s
Epoch: 1 cost time: 115.17106294631958
Epoch: 1, Steps: 208 | Train Loss: 4.738 Vali Loss: 4.618 Vali Acc: 0.055 Test Loss: 4.618 Test Acc: 0.055
Validation loss decreased (inf --> -0.055128).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0215306
	speed: 1.1896s/iter; left time: 24378.0713s
	iters: 200, epoch: 2 | loss: 4.6658115
	speed: 0.5100s/iter; left time: 10400.3290s
Epoch: 2 cost time: 110.1194372177124
Epoch: 2, Steps: 208 | Train Loss: 3.924 Vali Loss: 4.371 Vali Acc: 0.058 Test Loss: 4.371 Test Acc: 0.058
Validation loss decreased (-0.055128 --> -0.058411).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0587413
	speed: 1.0912s/iter; left time: 22135.7293s
	iters: 200, epoch: 3 | loss: 4.0830975
	speed: 0.5041s/iter; left time: 10175.5990s
Epoch: 3 cost time: 102.35875082015991
Epoch: 3, Steps: 208 | Train Loss: 3.573 Vali Loss: 4.589 Vali Acc: 0.075 Test Loss: 4.589 Test Acc: 0.075
Validation loss decreased (-0.058411 --> -0.075111).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4280171
	speed: 1.1684s/iter; left time: 23458.8262s
	iters: 200, epoch: 4 | loss: 2.8756192
	speed: 0.4454s/iter; left time: 8897.9316s
Epoch: 4 cost time: 102.56111264228821
Epoch: 4, Steps: 208 | Train Loss: 3.208 Vali Loss: 4.869 Vali Acc: 0.075 Test Loss: 4.869 Test Acc: 0.075
Validation loss decreased (-0.075111 --> -0.075406).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5976140
	speed: 1.0668s/iter; left time: 21196.5870s
	iters: 200, epoch: 5 | loss: 3.5349267
	speed: 0.5261s/iter; left time: 10401.4081s
Epoch: 5 cost time: 103.31959009170532
Epoch: 5, Steps: 208 | Train Loss: 2.843 Vali Loss: 4.872 Vali Acc: 0.067 Test Loss: 4.872 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.2968826
	speed: 1.1330s/iter; left time: 22276.3752s
	iters: 200, epoch: 6 | loss: 2.2056866
	speed: 0.5004s/iter; left time: 9788.6265s
Epoch: 6 cost time: 106.60118007659912
Epoch: 6, Steps: 208 | Train Loss: 2.625 Vali Loss: 4.585 Vali Acc: 0.060 Test Loss: 4.585 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.4261329
	speed: 1.1756s/iter; left time: 22869.0575s
	iters: 200, epoch: 7 | loss: 4.0173798
	speed: 0.5526s/iter; left time: 10695.2761s
Epoch: 7 cost time: 117.35260772705078
Epoch: 7, Steps: 208 | Train Loss: 2.436 Vali Loss: 4.943 Vali Acc: 0.061 Test Loss: 4.943 Test Acc: 0.061
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.0478723
	speed: 1.1948s/iter; left time: 22993.6587s
	iters: 200, epoch: 8 | loss: 2.3513963
	speed: 0.5031s/iter; left time: 9631.3799s
Epoch: 8 cost time: 111.28007364273071
Epoch: 8, Steps: 208 | Train Loss: 2.192 Vali Loss: 5.398 Vali Acc: 0.071 Test Loss: 5.398 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0864551
	speed: 1.1546s/iter; left time: 21980.8537s
	iters: 200, epoch: 9 | loss: 2.3819246
	speed: 0.4868s/iter; left time: 9219.3880s
Epoch: 9 cost time: 107.4601457118988
Epoch: 9, Steps: 208 | Train Loss: 1.803 Vali Loss: 5.991 Vali Acc: 0.069 Test Loss: 5.991 Test Acc: 0.069
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5097060
	speed: 1.0710s/iter; left time: 20165.7886s
	iters: 200, epoch: 10 | loss: 1.6393044
	speed: 0.4705s/iter; left time: 8812.7098s
Epoch: 10 cost time: 95.49809789657593
Epoch: 10, Steps: 208 | Train Loss: 1.533 Vali Loss: 6.360 Vali Acc: 0.079 Test Loss: 6.360 Test Acc: 0.079
Validation loss decreased (-0.075406 --> -0.079268).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0552193
	speed: 1.0741s/iter; left time: 20000.3030s
	iters: 200, epoch: 11 | loss: 1.4700278
	speed: 0.4600s/iter; left time: 8519.8278s
Epoch: 11 cost time: 97.41820073127747
Epoch: 11, Steps: 208 | Train Loss: 1.268 Vali Loss: 6.739 Vali Acc: 0.081 Test Loss: 6.739 Test Acc: 0.081
Validation loss decreased (-0.079268 --> -0.080458).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1602852
	speed: 1.1028s/iter; left time: 20306.0723s
	iters: 200, epoch: 12 | loss: 1.2287092
	speed: 0.4535s/iter; left time: 8305.2357s
Epoch: 12 cost time: 98.00480675697327
Epoch: 12, Steps: 208 | Train Loss: 1.026 Vali Loss: 7.587 Vali Acc: 0.081 Test Loss: 7.587 Test Acc: 0.081
Validation loss decreased (-0.080458 --> -0.080747).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5018787
	speed: 1.1188s/iter; left time: 20368.1885s
	iters: 200, epoch: 13 | loss: 0.8207982
	speed: 0.4677s/iter; left time: 8467.9118s
Epoch: 13 cost time: 101.48475384712219
Epoch: 13, Steps: 208 | Train Loss: 0.868 Vali Loss: 7.770 Vali Acc: 0.080 Test Loss: 7.770 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2156149
	speed: 1.0821s/iter; left time: 19474.2832s
	iters: 200, epoch: 14 | loss: 0.8939055
	speed: 0.4701s/iter; left time: 8412.6245s
Epoch: 14 cost time: 99.38763475418091
Epoch: 14, Steps: 208 | Train Loss: 0.764 Vali Loss: 8.102 Vali Acc: 0.078 Test Loss: 8.102 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8004702
	speed: 1.0104s/iter; left time: 17974.6855s
	iters: 200, epoch: 15 | loss: 0.6109933
	speed: 0.4400s/iter; left time: 7782.3953s
Epoch: 15 cost time: 94.02009630203247
Epoch: 15, Steps: 208 | Train Loss: 0.633 Vali Loss: 8.260 Vali Acc: 0.083 Test Loss: 8.260 Test Acc: 0.083
Validation loss decreased (-0.080747 --> -0.082828).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.8519777
	speed: 1.0301s/iter; left time: 18110.8501s
	iters: 200, epoch: 16 | loss: 1.1093984
	speed: 0.4392s/iter; left time: 7678.5194s
Epoch: 16 cost time: 91.39936923980713
Epoch: 16, Steps: 208 | Train Loss: 0.583 Vali Loss: 8.749 Vali Acc: 0.082 Test Loss: 8.749 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1885886
	speed: 1.0128s/iter; left time: 17595.2477s
	iters: 200, epoch: 17 | loss: 0.6222916
	speed: 0.5232s/iter; left time: 9037.0659s
Epoch: 17 cost time: 102.54676747322083
Epoch: 17, Steps: 208 | Train Loss: 0.513 Vali Loss: 9.553 Vali Acc: 0.083 Test Loss: 9.553 Test Acc: 0.083
Validation loss decreased (-0.082828 --> -0.083114).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1870139
	speed: 1.1037s/iter; left time: 18945.6095s
	iters: 200, epoch: 18 | loss: 0.5212559
	speed: 0.4714s/iter; left time: 8043.7258s
Epoch: 18 cost time: 101.54652142524719
Epoch: 18, Steps: 208 | Train Loss: 0.492 Vali Loss: 9.251 Vali Acc: 0.081 Test Loss: 9.251 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4656649
	speed: 1.0223s/iter; left time: 17335.7098s
	iters: 200, epoch: 19 | loss: 0.2787002
	speed: 0.4525s/iter; left time: 7627.8574s
Epoch: 19 cost time: 94.293949842453
Epoch: 19, Steps: 208 | Train Loss: 0.404 Vali Loss: 9.865 Vali Acc: 0.080 Test Loss: 9.865 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6604262
	speed: 1.0048s/iter; left time: 16829.5547s
	iters: 200, epoch: 20 | loss: 0.9448753
	speed: 0.4949s/iter; left time: 8239.5794s
Epoch: 20 cost time: 96.05428576469421
Epoch: 20, Steps: 208 | Train Loss: 0.409 Vali Loss: 9.466 Vali Acc: 0.077 Test Loss: 9.466 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2777967
	speed: 1.1012s/iter; left time: 18215.7277s
	iters: 200, epoch: 21 | loss: 0.3520549
	speed: 0.4984s/iter; left time: 8194.0028s
Epoch: 21 cost time: 104.27247858047485
Epoch: 21, Steps: 208 | Train Loss: 0.349 Vali Loss: 10.481 Vali Acc: 0.081 Test Loss: 10.481 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0749000
	speed: 1.1649s/iter; left time: 19027.0906s
	iters: 200, epoch: 22 | loss: 0.5888938
	speed: 0.5432s/iter; left time: 8818.4963s
Epoch: 22 cost time: 112.2219603061676
Epoch: 22, Steps: 208 | Train Loss: 0.380 Vali Loss: 9.896 Vali Acc: 0.079 Test Loss: 9.896 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0366178
	speed: 1.1460s/iter; left time: 18479.4980s
	iters: 200, epoch: 23 | loss: 0.3996368
	speed: 0.5047s/iter; left time: 8088.0869s
Epoch: 23 cost time: 107.26330018043518
Epoch: 23, Steps: 208 | Train Loss: 0.313 Vali Loss: 10.868 Vali Acc: 0.084 Test Loss: 10.868 Test Acc: 0.084
Validation loss decreased (-0.083114 --> -0.083399).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1216339
	speed: 1.1026s/iter; left time: 17549.8548s
	iters: 200, epoch: 24 | loss: 0.6264579
	speed: 0.4778s/iter; left time: 7557.0416s
Epoch: 24 cost time: 99.29396986961365
Epoch: 24, Steps: 208 | Train Loss: 0.289 Vali Loss: 10.776 Vali Acc: 0.085 Test Loss: 10.776 Test Acc: 0.085
Validation loss decreased (-0.083399 --> -0.085189).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6193411
	speed: 1.1215s/iter; left time: 17617.4502s
	iters: 200, epoch: 25 | loss: 0.4609740
	speed: 0.4428s/iter; left time: 6911.4952s
Epoch: 25 cost time: 97.32849359512329
Epoch: 25, Steps: 208 | Train Loss: 0.305 Vali Loss: 11.153 Vali Acc: 0.075 Test Loss: 11.153 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1898310
	speed: 1.1747s/iter; left time: 18208.6548s
	iters: 200, epoch: 26 | loss: 0.0665525
	speed: 0.5092s/iter; left time: 7842.0664s
Epoch: 26 cost time: 112.29099202156067
Epoch: 26, Steps: 208 | Train Loss: 0.275 Vali Loss: 10.949 Vali Acc: 0.073 Test Loss: 10.949 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.4153824
	speed: 1.1539s/iter; left time: 17646.7324s
	iters: 200, epoch: 27 | loss: 0.2397985
	speed: 0.5015s/iter; left time: 7619.6893s
Epoch: 27 cost time: 105.83982563018799
Epoch: 27, Steps: 208 | Train Loss: 0.267 Vali Loss: 11.450 Vali Acc: 0.075 Test Loss: 11.450 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.3048596
	speed: 1.0564s/iter; left time: 15935.5231s
	iters: 200, epoch: 28 | loss: 0.0152322
	speed: 0.4673s/iter; left time: 7002.9627s
Epoch: 28 cost time: 98.16987133026123
Epoch: 28, Steps: 208 | Train Loss: 0.307 Vali Loss: 11.187 Vali Acc: 0.084 Test Loss: 11.187 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.1290043
	speed: 1.0401s/iter; left time: 15474.2142s
	iters: 200, epoch: 29 | loss: 0.8274719
	speed: 0.4408s/iter; left time: 6513.3038s
Epoch: 29 cost time: 93.86265683174133
Epoch: 29, Steps: 208 | Train Loss: 0.241 Vali Loss: 12.114 Vali Acc: 0.079 Test Loss: 12.114 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.3623104
	speed: 1.0524s/iter; left time: 15436.9416s
	iters: 200, epoch: 30 | loss: 0.2186160
	speed: 0.5346s/iter; left time: 7787.9623s
Epoch: 30 cost time: 106.18546533584595
Epoch: 30, Steps: 208 | Train Loss: 0.223 Vali Loss: 11.448 Vali Acc: 0.079 Test Loss: 11.448 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0334545
	speed: 1.0702s/iter; left time: 15475.8616s
	iters: 200, epoch: 31 | loss: 0.0454117
	speed: 0.5217s/iter; left time: 7492.3214s
Epoch: 31 cost time: 106.17816472053528
Epoch: 31, Steps: 208 | Train Loss: 0.186 Vali Loss: 11.394 Vali Acc: 0.082 Test Loss: 11.394 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0328045
	speed: 1.0583s/iter; left time: 15084.5858s
	iters: 200, epoch: 32 | loss: 0.2149705
	speed: 0.4603s/iter; left time: 6514.0303s
Epoch: 32 cost time: 95.27464890480042
Epoch: 32, Steps: 208 | Train Loss: 0.201 Vali Loss: 11.884 Vali Acc: 0.078 Test Loss: 11.884 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0865219
	speed: 1.0199s/iter; left time: 14324.5936s
	iters: 200, epoch: 33 | loss: 0.0047545
	speed: 0.4051s/iter; left time: 5649.3251s
Epoch: 33 cost time: 87.44303131103516
Epoch: 33, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.165 Vali Acc: 0.080 Test Loss: 11.165 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0753937
	speed: 1.0021s/iter; left time: 13865.4507s
	iters: 200, epoch: 34 | loss: 0.1588367
	speed: 0.4528s/iter; left time: 6219.5937s
Epoch: 34 cost time: 93.46396279335022
Epoch: 34, Steps: 208 | Train Loss: 0.237 Vali Loss: 11.048 Vali Acc: 0.085 Test Loss: 11.048 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08529674917983895
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8584185
	speed: 0.4567s/iter; left time: 9454.5954s
	iters: 200, epoch: 1 | loss: 3.5067704
	speed: 0.4693s/iter; left time: 9667.8518s
Epoch: 1 cost time: 95.97548294067383
Epoch: 1, Steps: 208 | Train Loss: 4.742 Vali Loss: 4.505 Vali Acc: 0.052 Test Loss: 4.505 Test Acc: 0.052
Validation loss decreased (inf --> -0.051849).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0269098
	speed: 1.0578s/iter; left time: 21677.2322s
	iters: 200, epoch: 2 | loss: 4.6114898
	speed: 0.4259s/iter; left time: 8685.7240s
Epoch: 2 cost time: 94.00396203994751
Epoch: 2, Steps: 208 | Train Loss: 3.931 Vali Loss: 4.412 Vali Acc: 0.060 Test Loss: 4.412 Test Acc: 0.060
Validation loss decreased (-0.051849 --> -0.059604).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8397226
	speed: 1.0232s/iter; left time: 20756.5943s
	iters: 200, epoch: 3 | loss: 4.1235805
	speed: 0.4390s/iter; left time: 8861.2413s
Epoch: 3 cost time: 92.33383297920227
Epoch: 3, Steps: 208 | Train Loss: 3.446 Vali Loss: 4.798 Vali Acc: 0.078 Test Loss: 4.798 Test Acc: 0.078
Validation loss decreased (-0.059604 --> -0.077495).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7621646
	speed: 0.9550s/iter; left time: 19172.8528s
	iters: 200, epoch: 4 | loss: 2.9691250
	speed: 0.5018s/iter; left time: 10024.2893s
Epoch: 4 cost time: 94.76394581794739
Epoch: 4, Steps: 208 | Train Loss: 3.104 Vali Loss: 4.900 Vali Acc: 0.076 Test Loss: 4.900 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8507438
	speed: 1.0635s/iter; left time: 21130.0134s
	iters: 200, epoch: 5 | loss: 3.8181179
	speed: 0.4625s/iter; left time: 9142.9855s
Epoch: 5 cost time: 98.10519528388977
Epoch: 5, Steps: 208 | Train Loss: 2.741 Vali Loss: 4.783 Vali Acc: 0.070 Test Loss: 4.783 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.5578229
	speed: 0.9877s/iter; left time: 19420.0303s
	iters: 200, epoch: 6 | loss: 2.3562484
	speed: 0.4414s/iter; left time: 8634.6674s
Epoch: 6 cost time: 93.04492712020874
Epoch: 6, Steps: 208 | Train Loss: 2.577 Vali Loss: 5.132 Vali Acc: 0.066 Test Loss: 5.132 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.4395001
	speed: 0.9546s/iter; left time: 18569.9608s
	iters: 200, epoch: 7 | loss: 3.6228423
	speed: 0.4355s/iter; left time: 8428.7291s
Epoch: 7 cost time: 87.54613780975342
Epoch: 7, Steps: 208 | Train Loss: 2.413 Vali Loss: 5.419 Vali Acc: 0.072 Test Loss: 5.419 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.1170127
	speed: 0.9551s/iter; left time: 18380.8790s
	iters: 200, epoch: 8 | loss: 1.4864455
	speed: 0.4528s/iter; left time: 8669.6195s
Epoch: 8 cost time: 91.71558666229248
Epoch: 8, Steps: 208 | Train Loss: 2.035 Vali Loss: 5.883 Vali Acc: 0.078 Test Loss: 5.883 Test Acc: 0.078
Validation loss decreased (-0.077495 --> -0.078080).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6416318
	speed: 1.0445s/iter; left time: 19883.3366s
	iters: 200, epoch: 9 | loss: 2.6925523
	speed: 0.4720s/iter; left time: 8939.0278s
Epoch: 9 cost time: 96.41718053817749
Epoch: 9, Steps: 208 | Train Loss: 1.671 Vali Loss: 6.471 Vali Acc: 0.072 Test Loss: 6.471 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5498204
	speed: 0.9494s/iter; left time: 17877.0814s
	iters: 200, epoch: 10 | loss: 1.6215541
	speed: 0.4169s/iter; left time: 7808.2415s
Epoch: 10 cost time: 85.58627891540527
Epoch: 10, Steps: 208 | Train Loss: 1.422 Vali Loss: 6.701 Vali Acc: 0.072 Test Loss: 6.701 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0644429
	speed: 0.9322s/iter; left time: 17357.9913s
	iters: 200, epoch: 11 | loss: 1.0571918
	speed: 0.4005s/iter; left time: 7417.5359s
Epoch: 11 cost time: 84.85255432128906
Epoch: 11, Steps: 208 | Train Loss: 1.185 Vali Loss: 7.034 Vali Acc: 0.079 Test Loss: 7.034 Test Acc: 0.079
Validation loss decreased (-0.078080 --> -0.078665).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0270973
	speed: 0.9622s/iter; left time: 17717.2659s
	iters: 200, epoch: 12 | loss: 0.8636181
	speed: 0.4534s/iter; left time: 8303.2773s
Epoch: 12 cost time: 92.35677552223206
Epoch: 12, Steps: 208 | Train Loss: 0.940 Vali Loss: 7.983 Vali Acc: 0.088 Test Loss: 7.983 Test Acc: 0.088
Validation loss decreased (-0.078665 --> -0.088199).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1540292
	speed: 1.0349s/iter; left time: 18840.8050s
	iters: 200, epoch: 13 | loss: 0.5345750
	speed: 0.4577s/iter; left time: 8286.2143s
Epoch: 13 cost time: 95.45938968658447
Epoch: 13, Steps: 208 | Train Loss: 0.814 Vali Loss: 8.519 Vali Acc: 0.077 Test Loss: 8.519 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3445343
	speed: 0.9929s/iter; left time: 17869.2134s
	iters: 200, epoch: 14 | loss: 1.2043087
	speed: 0.4344s/iter; left time: 7773.7942s
Epoch: 14 cost time: 89.83610320091248
Epoch: 14, Steps: 208 | Train Loss: 0.732 Vali Loss: 8.589 Vali Acc: 0.073 Test Loss: 8.589 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3895321
	speed: 0.9087s/iter; left time: 16165.5688s
	iters: 200, epoch: 15 | loss: 1.9506603
	speed: 0.4214s/iter; left time: 7454.6201s
Epoch: 15 cost time: 85.07230710983276
Epoch: 15, Steps: 208 | Train Loss: 0.701 Vali Loss: 8.509 Vali Acc: 0.084 Test Loss: 8.509 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2341557
	speed: 0.9916s/iter; left time: 17432.9100s
	iters: 200, epoch: 16 | loss: 0.7314481
	speed: 0.4315s/iter; left time: 7543.6459s
Epoch: 16 cost time: 90.19588041305542
Epoch: 16, Steps: 208 | Train Loss: 0.563 Vali Loss: 9.758 Vali Acc: 0.082 Test Loss: 9.758 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.8068205
	speed: 0.9853s/iter; left time: 17117.2857s
	iters: 200, epoch: 17 | loss: 0.4188397
	speed: 0.3883s/iter; left time: 6706.8356s
Epoch: 17 cost time: 84.38627696037292
Epoch: 17, Steps: 208 | Train Loss: 0.554 Vali Loss: 9.017 Vali Acc: 0.088 Test Loss: 9.017 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2552591
	speed: 1.0331s/iter; left time: 17733.8016s
	iters: 200, epoch: 18 | loss: 0.7472337
	speed: 0.4423s/iter; left time: 7547.5741s
Epoch: 18 cost time: 94.01640439033508
Epoch: 18, Steps: 208 | Train Loss: 0.489 Vali Loss: 9.793 Vali Acc: 0.079 Test Loss: 9.793 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2223050
	speed: 1.0150s/iter; left time: 17210.7191s
	iters: 200, epoch: 19 | loss: 0.2109901
	speed: 0.4398s/iter; left time: 7413.6966s
Epoch: 19 cost time: 93.07814764976501
Epoch: 19, Steps: 208 | Train Loss: 0.447 Vali Loss: 9.565 Vali Acc: 0.086 Test Loss: 9.565 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.7968315
	speed: 1.0144s/iter; left time: 16991.0026s
	iters: 200, epoch: 20 | loss: 1.1267217
	speed: 0.4583s/iter; left time: 7629.8346s
Epoch: 20 cost time: 94.10860395431519
Epoch: 20, Steps: 208 | Train Loss: 0.409 Vali Loss: 10.702 Vali Acc: 0.080 Test Loss: 10.702 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1004030
	speed: 0.9429s/iter; left time: 15595.7908s
	iters: 200, epoch: 21 | loss: 0.1248843
	speed: 0.4240s/iter; left time: 6971.1952s
Epoch: 21 cost time: 87.8072600364685
Epoch: 21, Steps: 208 | Train Loss: 0.373 Vali Loss: 11.143 Vali Acc: 0.078 Test Loss: 11.143 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2586816
	speed: 0.9544s/iter; left time: 15588.8422s
	iters: 200, epoch: 22 | loss: 0.0785529
	speed: 0.4440s/iter; left time: 7208.0643s
Epoch: 22 cost time: 90.58426475524902
Epoch: 22, Steps: 208 | Train Loss: 0.398 Vali Loss: 10.035 Vali Acc: 0.084 Test Loss: 10.035 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08827915299731584
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8998957
	speed: 0.4473s/iter; left time: 9259.6959s
	iters: 200, epoch: 1 | loss: 3.3962119
	speed: 0.4287s/iter; left time: 8832.5298s
Epoch: 1 cost time: 91.11470198631287
Epoch: 1, Steps: 208 | Train Loss: 4.721 Vali Loss: 4.674 Vali Acc: 0.056 Test Loss: 4.674 Test Acc: 0.056
Validation loss decreased (inf --> -0.056022).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.0105729
	speed: 0.9620s/iter; left time: 19715.1521s
	iters: 200, epoch: 2 | loss: 4.7486448
	speed: 0.4100s/iter; left time: 8361.8687s
Epoch: 2 cost time: 85.62693166732788
Epoch: 2, Steps: 208 | Train Loss: 3.967 Vali Loss: 4.508 Vali Acc: 0.057 Test Loss: 4.508 Test Acc: 0.057
Validation loss decreased (-0.056022 --> -0.057217).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1401565
	speed: 0.9139s/iter; left time: 18539.3312s
	iters: 200, epoch: 3 | loss: 3.9265845
	speed: 0.3814s/iter; left time: 7699.4780s
Epoch: 3 cost time: 80.5328643321991
Epoch: 3, Steps: 208 | Train Loss: 3.472 Vali Loss: 5.240 Vali Acc: 0.060 Test Loss: 5.240 Test Acc: 0.060
Validation loss decreased (-0.057217 --> -0.060192).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3715274
	speed: 0.9527s/iter; left time: 19127.2995s
	iters: 200, epoch: 4 | loss: 2.8270359
	speed: 0.4031s/iter; left time: 8052.3461s
Epoch: 4 cost time: 84.55897045135498
Epoch: 4, Steps: 208 | Train Loss: 2.998 Vali Loss: 5.262 Vali Acc: 0.065 Test Loss: 5.262 Test Acc: 0.065
Validation loss decreased (-0.060192 --> -0.065262).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7707160
	speed: 0.9456s/iter; left time: 18788.1611s
	iters: 200, epoch: 5 | loss: 3.5587964
	speed: 0.4280s/iter; left time: 8461.1639s
Epoch: 5 cost time: 86.19682216644287
Epoch: 5, Steps: 208 | Train Loss: 2.621 Vali Loss: 5.755 Vali Acc: 0.070 Test Loss: 5.755 Test Acc: 0.070
Validation loss decreased (-0.065262 --> -0.070327).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6089015
	speed: 0.9296s/iter; left time: 18277.5744s
	iters: 200, epoch: 6 | loss: 1.6890942
	speed: 0.3839s/iter; left time: 7508.7951s
Epoch: 6 cost time: 80.62947964668274
Epoch: 6, Steps: 208 | Train Loss: 2.334 Vali Loss: 5.683 Vali Acc: 0.072 Test Loss: 5.683 Test Acc: 0.072
Validation loss decreased (-0.070327 --> -0.071819).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9170413
	speed: 0.9105s/iter; left time: 17711.8494s
	iters: 200, epoch: 7 | loss: 3.5778542
	speed: 0.4012s/iter; left time: 7764.0864s
Epoch: 7 cost time: 83.33661961555481
Epoch: 7, Steps: 208 | Train Loss: 2.011 Vali Loss: 6.241 Vali Acc: 0.070 Test Loss: 6.241 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8331599
	speed: 0.9220s/iter; left time: 17743.4693s
	iters: 200, epoch: 8 | loss: 1.7264622
	speed: 0.4105s/iter; left time: 7859.6529s
Epoch: 8 cost time: 83.3539342880249
Epoch: 8, Steps: 208 | Train Loss: 1.691 Vali Loss: 7.042 Vali Acc: 0.070 Test Loss: 7.042 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3205963
	speed: 0.9043s/iter; left time: 17215.8554s
	iters: 200, epoch: 9 | loss: 2.6186576
	speed: 0.3876s/iter; left time: 7339.5597s
Epoch: 9 cost time: 80.92150020599365
Epoch: 9, Steps: 208 | Train Loss: 1.412 Vali Loss: 7.144 Vali Acc: 0.073 Test Loss: 7.144 Test Acc: 0.073
Validation loss decreased (-0.071819 --> -0.072997).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4962116
	speed: 0.9133s/iter; left time: 17197.1165s
	iters: 200, epoch: 10 | loss: 1.7536154
	speed: 0.3970s/iter; left time: 7434.6709s
Epoch: 10 cost time: 83.25066542625427
Epoch: 10, Steps: 208 | Train Loss: 1.142 Vali Loss: 8.008 Vali Acc: 0.067 Test Loss: 8.008 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7942547
	speed: 0.9521s/iter; left time: 17729.3834s
	iters: 200, epoch: 11 | loss: 1.0317215
	speed: 0.4225s/iter; left time: 7825.5724s
Epoch: 11 cost time: 89.31170129776001
Epoch: 11, Steps: 208 | Train Loss: 0.961 Vali Loss: 8.743 Vali Acc: 0.074 Test Loss: 8.743 Test Acc: 0.074
Validation loss decreased (-0.072997 --> -0.074174).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9286747
	speed: 1.0621s/iter; left time: 19556.3712s
	iters: 200, epoch: 12 | loss: 0.7652870
	speed: 0.3984s/iter; left time: 7295.2233s
Epoch: 12 cost time: 90.51183080673218
Epoch: 12, Steps: 208 | Train Loss: 0.839 Vali Loss: 8.784 Vali Acc: 0.080 Test Loss: 8.784 Test Acc: 0.080
Validation loss decreased (-0.074174 --> -0.079542).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5685610
	speed: 0.9881s/iter; left time: 17987.5467s
	iters: 200, epoch: 13 | loss: 0.4987785
	speed: 0.4041s/iter; left time: 7316.8962s
Epoch: 13 cost time: 86.6752552986145
Epoch: 13, Steps: 208 | Train Loss: 0.803 Vali Loss: 9.022 Vali Acc: 0.075 Test Loss: 9.022 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3037356
	speed: 0.9350s/iter; left time: 16827.2976s
	iters: 200, epoch: 14 | loss: 0.4408461
	speed: 0.3805s/iter; left time: 6810.4997s
Epoch: 14 cost time: 82.32643747329712
Epoch: 14, Steps: 208 | Train Loss: 0.722 Vali Loss: 9.579 Vali Acc: 0.073 Test Loss: 9.579 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4260378
	speed: 0.9664s/iter; left time: 17190.7776s
	iters: 200, epoch: 15 | loss: 1.9734409
	speed: 0.4012s/iter; left time: 7096.8404s
Epoch: 15 cost time: 85.2287962436676
Epoch: 15, Steps: 208 | Train Loss: 0.651 Vali Loss: 9.544 Vali Acc: 0.080 Test Loss: 9.544 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1754380
	speed: 0.9594s/iter; left time: 16867.5728s
	iters: 200, epoch: 16 | loss: 0.4810626
	speed: 0.3850s/iter; left time: 6730.8381s
Epoch: 16 cost time: 82.07852935791016
Epoch: 16, Steps: 208 | Train Loss: 0.550 Vali Loss: 9.829 Vali Acc: 0.069 Test Loss: 9.829 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.8480567
	speed: 0.9180s/iter; left time: 15948.8015s
	iters: 200, epoch: 17 | loss: 0.8862079
	speed: 0.3765s/iter; left time: 6503.2293s
Epoch: 17 cost time: 80.20536851882935
Epoch: 17, Steps: 208 | Train Loss: 0.527 Vali Loss: 10.073 Vali Acc: 0.074 Test Loss: 10.073 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3591536
	speed: 0.9423s/iter; left time: 16173.8366s
	iters: 200, epoch: 18 | loss: 0.1952191
	speed: 0.3934s/iter; left time: 6712.8647s
Epoch: 18 cost time: 84.71558833122253
Epoch: 18, Steps: 208 | Train Loss: 0.555 Vali Loss: 9.696 Vali Acc: 0.079 Test Loss: 9.696 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.7102410
	speed: 0.9472s/iter; left time: 16062.4441s
	iters: 200, epoch: 19 | loss: 0.9261657
	speed: 0.4020s/iter; left time: 6775.9858s
Epoch: 19 cost time: 83.74813556671143
Epoch: 19, Steps: 208 | Train Loss: 0.496 Vali Loss: 10.149 Vali Acc: 0.079 Test Loss: 10.149 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0817031
	speed: 0.9266s/iter; left time: 15519.4323s
	iters: 200, epoch: 20 | loss: 0.2649951
	speed: 0.4019s/iter; left time: 6690.9433s
Epoch: 20 cost time: 83.37201952934265
Epoch: 20, Steps: 208 | Train Loss: 0.450 Vali Loss: 10.516 Vali Acc: 0.074 Test Loss: 10.516 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0461991
	speed: 0.9435s/iter; left time: 15605.7282s
	iters: 200, epoch: 21 | loss: 0.0886049
	speed: 0.4200s/iter; left time: 6905.5129s
Epoch: 21 cost time: 86.1427059173584
Epoch: 21, Steps: 208 | Train Loss: 0.441 Vali Loss: 11.060 Vali Acc: 0.074 Test Loss: 11.060 Test Acc: 0.074
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3740433
	speed: 0.9473s/iter; left time: 15471.4906s
	iters: 200, epoch: 22 | loss: 0.0521278
	speed: 0.4067s/iter; left time: 6601.9625s
Epoch: 22 cost time: 84.62670159339905
Epoch: 22, Steps: 208 | Train Loss: 0.417 Vali Loss: 11.074 Vali Acc: 0.078 Test Loss: 11.074 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07963018192663286
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3364682
	speed: 0.3970s/iter; left time: 8218.0948s
	iters: 200, epoch: 1 | loss: 3.7332146
	speed: 0.3930s/iter; left time: 8095.7052s
Epoch: 1 cost time: 82.94165515899658
Epoch: 1, Steps: 208 | Train Loss: 4.723 Vali Loss: 4.718 Vali Acc: 0.061 Test Loss: 4.718 Test Acc: 0.061
Validation loss decreased (inf --> -0.060794).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.0338702
	speed: 0.9327s/iter; left time: 19114.7902s
	iters: 200, epoch: 2 | loss: 3.4683914
	speed: 0.3729s/iter; left time: 7605.2840s
Epoch: 2 cost time: 80.35876822471619
Epoch: 2, Steps: 208 | Train Loss: 4.011 Vali Loss: 4.737 Vali Acc: 0.061 Test Loss: 4.737 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.8662891
	speed: 0.9251s/iter; left time: 18766.2286s
	iters: 200, epoch: 3 | loss: 3.3938825
	speed: 0.3815s/iter; left time: 7700.0760s
Epoch: 3 cost time: 80.15102934837341
Epoch: 3, Steps: 208 | Train Loss: 3.380 Vali Loss: 5.231 Vali Acc: 0.064 Test Loss: 5.231 Test Acc: 0.064
Validation loss decreased (-0.060794 --> -0.064069).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2521899
	speed: 0.8724s/iter; left time: 17515.4994s
	iters: 200, epoch: 4 | loss: 1.9157013
	speed: 0.3740s/iter; left time: 7471.0000s
Epoch: 4 cost time: 77.68620419502258
Epoch: 4, Steps: 208 | Train Loss: 2.906 Vali Loss: 5.485 Vali Acc: 0.069 Test Loss: 5.485 Test Acc: 0.069
Validation loss decreased (-0.064069 --> -0.069137).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0400114
	speed: 0.8558s/iter; left time: 17004.6761s
	iters: 200, epoch: 5 | loss: 2.6020620
	speed: 0.3572s/iter; left time: 7060.9369s
Epoch: 5 cost time: 74.47975897789001
Epoch: 5, Steps: 208 | Train Loss: 2.471 Vali Loss: 6.184 Vali Acc: 0.069 Test Loss: 6.184 Test Acc: 0.069
Validation loss decreased (-0.069137 --> -0.069428).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5834539
	speed: 0.8581s/iter; left time: 16871.4549s
	iters: 200, epoch: 6 | loss: 2.6393523
	speed: 0.3684s/iter; left time: 7205.4602s
Epoch: 6 cost time: 77.38208246231079
Epoch: 6, Steps: 208 | Train Loss: 2.245 Vali Loss: 5.765 Vali Acc: 0.072 Test Loss: 5.765 Test Acc: 0.072
Validation loss decreased (-0.069428 --> -0.072117).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3368640
	speed: 0.8900s/iter; left time: 17313.1294s
	iters: 200, epoch: 7 | loss: 3.5789611
	speed: 0.3531s/iter; left time: 6834.0767s
Epoch: 7 cost time: 77.30877208709717
Epoch: 7, Steps: 208 | Train Loss: 1.968 Vali Loss: 6.134 Vali Acc: 0.069 Test Loss: 6.134 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2117373
	speed: 0.8504s/iter; left time: 16365.6724s
	iters: 200, epoch: 8 | loss: 1.1919421
	speed: 0.3607s/iter; left time: 6904.6821s
Epoch: 8 cost time: 76.71615481376648
Epoch: 8, Steps: 208 | Train Loss: 1.739 Vali Loss: 6.665 Vali Acc: 0.078 Test Loss: 6.665 Test Acc: 0.078
Validation loss decreased (-0.072117 --> -0.078072).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8187087
	speed: 0.8567s/iter; left time: 16309.6682s
	iters: 200, epoch: 9 | loss: 2.9642475
	speed: 0.3445s/iter; left time: 6524.3444s
Epoch: 9 cost time: 72.21937084197998
Epoch: 9, Steps: 208 | Train Loss: 1.393 Vali Loss: 7.322 Vali Acc: 0.083 Test Loss: 7.322 Test Acc: 0.083
Validation loss decreased (-0.078072 --> -0.082838).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8392746
	speed: 0.8422s/iter; left time: 15857.8572s
	iters: 200, epoch: 10 | loss: 1.0055002
	speed: 0.3267s/iter; left time: 6119.4227s
Epoch: 10 cost time: 70.93019843101501
Epoch: 10, Steps: 208 | Train Loss: 1.184 Vali Loss: 8.024 Vali Acc: 0.081 Test Loss: 8.024 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8288614
	speed: 0.8953s/iter; left time: 16670.7640s
	iters: 200, epoch: 11 | loss: 1.1188456
	speed: 0.3863s/iter; left time: 7154.2674s
Epoch: 11 cost time: 80.81744909286499
Epoch: 11, Steps: 208 | Train Loss: 1.039 Vali Loss: 8.142 Vali Acc: 0.081 Test Loss: 8.142 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6772368
	speed: 0.8438s/iter; left time: 15537.3728s
	iters: 200, epoch: 12 | loss: 0.7236230
	speed: 0.3960s/iter; left time: 7252.5763s
Epoch: 12 cost time: 79.66459918022156
Epoch: 12, Steps: 208 | Train Loss: 0.880 Vali Loss: 8.974 Vali Acc: 0.079 Test Loss: 8.974 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.8489617
	speed: 0.8467s/iter; left time: 15413.5432s
	iters: 200, epoch: 13 | loss: 0.5589995
	speed: 0.3784s/iter; left time: 6850.2992s
Epoch: 13 cost time: 76.66294264793396
Epoch: 13, Steps: 208 | Train Loss: 0.779 Vali Loss: 9.119 Vali Acc: 0.085 Test Loss: 9.119 Test Acc: 0.085
Validation loss decreased (-0.082838 --> -0.084609).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1830505
	speed: 0.8491s/iter; left time: 15280.8226s
	iters: 200, epoch: 14 | loss: 0.5702780
	speed: 0.3431s/iter; left time: 6140.1988s
Epoch: 14 cost time: 73.08699822425842
Epoch: 14, Steps: 208 | Train Loss: 0.779 Vali Loss: 9.405 Vali Acc: 0.081 Test Loss: 9.405 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2130005
	speed: 0.8698s/iter; left time: 15472.4990s
	iters: 200, epoch: 15 | loss: 1.7639370
	speed: 0.3547s/iter; left time: 6274.6233s
Epoch: 15 cost time: 75.42780709266663
Epoch: 15, Steps: 208 | Train Loss: 0.674 Vali Loss: 9.802 Vali Acc: 0.077 Test Loss: 9.802 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9033843
	speed: 0.8476s/iter; left time: 14901.5494s
	iters: 200, epoch: 16 | loss: 0.4958141
	speed: 0.3424s/iter; left time: 5986.0808s
Epoch: 16 cost time: 73.44986033439636
Epoch: 16, Steps: 208 | Train Loss: 0.607 Vali Loss: 10.105 Vali Acc: 0.079 Test Loss: 10.105 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6934596
	speed: 0.7925s/iter; left time: 13767.7276s
	iters: 200, epoch: 17 | loss: 0.7732328
	speed: 0.3426s/iter; left time: 5917.9859s
Epoch: 17 cost time: 71.22607469558716
Epoch: 17, Steps: 208 | Train Loss: 0.571 Vali Loss: 10.036 Vali Acc: 0.081 Test Loss: 10.036 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0713288
	speed: 0.8008s/iter; left time: 13746.2997s
	iters: 200, epoch: 18 | loss: 0.4629350
	speed: 0.3423s/iter; left time: 5841.0398s
Epoch: 18 cost time: 70.53303694725037
Epoch: 18, Steps: 208 | Train Loss: 0.539 Vali Loss: 10.257 Vali Acc: 0.083 Test Loss: 10.257 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3678321
	speed: 0.8077s/iter; left time: 13696.8507s
	iters: 200, epoch: 19 | loss: 0.5360206
	speed: 0.3222s/iter; left time: 5431.7561s
Epoch: 19 cost time: 70.08406352996826
Epoch: 19, Steps: 208 | Train Loss: 0.505 Vali Loss: 10.706 Vali Acc: 0.072 Test Loss: 10.706 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.4465483
	speed: 0.8112s/iter; left time: 13586.0976s
	iters: 200, epoch: 20 | loss: 1.2090772
	speed: 0.3381s/iter; left time: 5629.7729s
Epoch: 20 cost time: 70.61541056632996
Epoch: 20, Steps: 208 | Train Loss: 0.504 Vali Loss: 11.143 Vali Acc: 0.076 Test Loss: 11.143 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8406067
	speed: 0.8069s/iter; left time: 13347.4549s
	iters: 200, epoch: 21 | loss: 0.0747917
	speed: 0.3409s/iter; left time: 5604.3254s
Epoch: 21 cost time: 71.59869647026062
Epoch: 21, Steps: 208 | Train Loss: 0.494 Vali Loss: 10.921 Vali Acc: 0.080 Test Loss: 10.921 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4837105
	speed: 0.7810s/iter; left time: 12755.9393s
	iters: 200, epoch: 22 | loss: 0.4066148
	speed: 0.3217s/iter; left time: 5222.9204s
Epoch: 22 cost time: 68.71313571929932
Epoch: 22, Steps: 208 | Train Loss: 0.469 Vali Loss: 10.864 Vali Acc: 0.086 Test Loss: 10.864 Test Acc: 0.086
Validation loss decreased (-0.084609 --> -0.086083).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3820270
	speed: 0.8219s/iter; left time: 13252.3720s
	iters: 200, epoch: 23 | loss: 0.6110659
	speed: 0.3685s/iter; left time: 5905.2103s
Epoch: 23 cost time: 74.6855857372284
Epoch: 23, Steps: 208 | Train Loss: 0.419 Vali Loss: 10.903 Vali Acc: 0.087 Test Loss: 10.903 Test Acc: 0.087
Validation loss decreased (-0.086083 --> -0.086679).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.4234349
	speed: 0.8878s/iter; left time: 14130.3869s
	iters: 200, epoch: 24 | loss: 1.5939261
	speed: 0.3500s/iter; left time: 5535.3654s
Epoch: 24 cost time: 74.62200975418091
Epoch: 24, Steps: 208 | Train Loss: 0.434 Vali Loss: 10.774 Vali Acc: 0.084 Test Loss: 10.774 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.9268004
	speed: 0.8332s/iter; left time: 13088.6533s
	iters: 200, epoch: 25 | loss: 0.6210032
	speed: 0.3573s/iter; left time: 5576.5568s
Epoch: 25 cost time: 74.28144216537476
Epoch: 25, Steps: 208 | Train Loss: 0.441 Vali Loss: 11.599 Vali Acc: 0.069 Test Loss: 11.599 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.1260822
	speed: 0.8419s/iter; left time: 13050.3707s
	iters: 200, epoch: 26 | loss: 0.0277191
	speed: 0.3473s/iter; left time: 5348.4992s
Epoch: 26 cost time: 74.14989566802979
Epoch: 26, Steps: 208 | Train Loss: 0.373 Vali Loss: 11.578 Vali Acc: 0.076 Test Loss: 11.578 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3562256
	speed: 0.8170s/iter; left time: 12495.1085s
	iters: 200, epoch: 27 | loss: 0.3371101
	speed: 0.3391s/iter; left time: 5151.8700s
Epoch: 27 cost time: 72.11499190330505
Epoch: 27, Steps: 208 | Train Loss: 0.355 Vali Loss: 12.153 Vali Acc: 0.081 Test Loss: 12.153 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.5564665
	speed: 0.8193s/iter; left time: 12359.5303s
	iters: 200, epoch: 28 | loss: 0.3086489
	speed: 0.3424s/iter; left time: 5130.8511s
Epoch: 28 cost time: 71.63193225860596
Epoch: 28, Steps: 208 | Train Loss: 0.425 Vali Loss: 11.583 Vali Acc: 0.083 Test Loss: 11.583 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.7329310
	speed: 0.8176s/iter; left time: 12162.8134s
	iters: 200, epoch: 29 | loss: 0.4516456
	speed: 0.3320s/iter; left time: 4905.4895s
Epoch: 29 cost time: 70.20909357070923
Epoch: 29, Steps: 208 | Train Loss: 0.408 Vali Loss: 10.942 Vali Acc: 0.083 Test Loss: 10.942 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1195936
	speed: 0.8149s/iter; left time: 11953.1470s
	iters: 200, epoch: 30 | loss: 0.1915543
	speed: 0.3394s/iter; left time: 4944.2900s
Epoch: 30 cost time: 71.76344871520996
Epoch: 30, Steps: 208 | Train Loss: 0.380 Vali Loss: 10.996 Vali Acc: 0.085 Test Loss: 10.996 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0582574
	speed: 0.8045s/iter; left time: 11633.2056s
	iters: 200, epoch: 31 | loss: 0.2861437
	speed: 0.3417s/iter; left time: 4907.2082s
Epoch: 31 cost time: 71.1794536113739
Epoch: 31, Steps: 208 | Train Loss: 0.331 Vali Loss: 11.404 Vali Acc: 0.078 Test Loss: 11.404 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0085062
	speed: 0.8302s/iter; left time: 11832.7696s
	iters: 200, epoch: 32 | loss: 1.1430700
	speed: 0.3483s/iter; left time: 4929.3905s
Epoch: 32 cost time: 72.85554027557373
Epoch: 32, Steps: 208 | Train Loss: 0.296 Vali Loss: 11.670 Vali Acc: 0.078 Test Loss: 11.670 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1376459
	speed: 0.8432s/iter; left time: 11842.2931s
	iters: 200, epoch: 33 | loss: 0.3617479
	speed: 0.3495s/iter; left time: 4873.2158s
Epoch: 33 cost time: 74.20977139472961
Epoch: 33, Steps: 208 | Train Loss: 0.320 Vali Loss: 11.926 Vali Acc: 0.075 Test Loss: 11.926 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0867879510885774
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.7501044
	speed: 0.3507s/iter; left time: 7260.0497s
	iters: 200, epoch: 1 | loss: 3.8689134
	speed: 0.3401s/iter; left time: 7006.1268s
Epoch: 1 cost time: 72.41562414169312
Epoch: 1, Steps: 208 | Train Loss: 4.671 Vali Loss: 5.575 Vali Acc: 0.056 Test Loss: 5.575 Test Acc: 0.056
Validation loss decreased (inf --> -0.055715).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6471963
	speed: 0.7954s/iter; left time: 16299.5348s
	iters: 200, epoch: 2 | loss: 3.9615407
	speed: 0.3691s/iter; left time: 7526.3337s
Epoch: 2 cost time: 74.53355503082275
Epoch: 2, Steps: 208 | Train Loss: 3.983 Vali Loss: 4.891 Vali Acc: 0.067 Test Loss: 4.891 Test Acc: 0.067
Validation loss decreased (-0.055715 --> -0.066459).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5262377
	speed: 0.8521s/iter; left time: 17285.6398s
	iters: 200, epoch: 3 | loss: 4.9477859
	speed: 0.3633s/iter; left time: 7334.0764s
Epoch: 3 cost time: 75.29250478744507
Epoch: 3, Steps: 208 | Train Loss: 3.359 Vali Loss: 5.362 Vali Acc: 0.073 Test Loss: 5.362 Test Acc: 0.073
Validation loss decreased (-0.066459 --> -0.072717).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2154844
	speed: 0.8379s/iter; left time: 16823.4450s
	iters: 200, epoch: 4 | loss: 2.0136323
	speed: 0.3573s/iter; left time: 7137.8889s
Epoch: 4 cost time: 73.67996978759766
Epoch: 4, Steps: 208 | Train Loss: 2.836 Vali Loss: 5.549 Vali Acc: 0.075 Test Loss: 5.549 Test Acc: 0.075
Validation loss decreased (-0.072717 --> -0.074505).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1925383
	speed: 0.8303s/iter; left time: 16498.0553s
	iters: 200, epoch: 5 | loss: 3.0611932
	speed: 0.3378s/iter; left time: 6677.8591s
Epoch: 5 cost time: 72.14015126228333
Epoch: 5, Steps: 208 | Train Loss: 2.556 Vali Loss: 5.878 Vali Acc: 0.078 Test Loss: 5.878 Test Acc: 0.078
Validation loss decreased (-0.074505 --> -0.077782).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7323370
	speed: 0.8371s/iter; left time: 16459.1351s
	iters: 200, epoch: 6 | loss: 2.4149976
	speed: 0.3397s/iter; left time: 6644.9124s
Epoch: 6 cost time: 71.85537385940552
Epoch: 6, Steps: 208 | Train Loss: 2.253 Vali Loss: 5.528 Vali Acc: 0.076 Test Loss: 5.528 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.6838362
	speed: 0.8049s/iter; left time: 15657.3091s
	iters: 200, epoch: 7 | loss: 3.0943670
	speed: 0.3263s/iter; left time: 6314.1687s
Epoch: 7 cost time: 69.32745409011841
Epoch: 7, Steps: 208 | Train Loss: 2.089 Vali Loss: 5.864 Vali Acc: 0.068 Test Loss: 5.864 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1341033
	speed: 0.7709s/iter; left time: 14836.7138s
	iters: 200, epoch: 8 | loss: 1.3892875
	speed: 0.3243s/iter; left time: 6208.1000s
Epoch: 8 cost time: 66.74488949775696
Epoch: 8, Steps: 208 | Train Loss: 1.815 Vali Loss: 6.635 Vali Acc: 0.072 Test Loss: 6.635 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3719954
	speed: 0.7762s/iter; left time: 14777.0532s
	iters: 200, epoch: 9 | loss: 1.6261425
	speed: 0.3180s/iter; left time: 6021.3358s
Epoch: 9 cost time: 66.77306723594666
Epoch: 9, Steps: 208 | Train Loss: 1.540 Vali Loss: 6.458 Vali Acc: 0.083 Test Loss: 6.458 Test Acc: 0.083
Validation loss decreased (-0.077782 --> -0.083144).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7396642
	speed: 0.7807s/iter; left time: 14700.4765s
	iters: 200, epoch: 10 | loss: 1.6271722
	speed: 0.3226s/iter; left time: 6042.7966s
Epoch: 10 cost time: 67.90942740440369
Epoch: 10, Steps: 208 | Train Loss: 1.338 Vali Loss: 7.051 Vali Acc: 0.085 Test Loss: 7.051 Test Acc: 0.085
Validation loss decreased (-0.083144 --> -0.084928).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1156027
	speed: 0.7808s/iter; left time: 14539.5661s
	iters: 200, epoch: 11 | loss: 1.5904475
	speed: 0.3286s/iter; left time: 6086.0211s
Epoch: 11 cost time: 69.5422773361206
Epoch: 11, Steps: 208 | Train Loss: 1.104 Vali Loss: 7.427 Vali Acc: 0.084 Test Loss: 7.427 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9235932
	speed: 0.7999s/iter; left time: 14729.0103s
	iters: 200, epoch: 12 | loss: 1.1739998
	speed: 0.3269s/iter; left time: 5986.1510s
Epoch: 12 cost time: 69.69173812866211
Epoch: 12, Steps: 208 | Train Loss: 1.001 Vali Loss: 8.013 Vali Acc: 0.091 Test Loss: 8.013 Test Acc: 0.091
Validation loss decreased (-0.084928 --> -0.090883).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2255875
	speed: 0.8089s/iter; left time: 14725.4376s
	iters: 200, epoch: 13 | loss: 0.7251777
	speed: 0.3265s/iter; left time: 5911.5544s
Epoch: 13 cost time: 70.05230951309204
Epoch: 13, Steps: 208 | Train Loss: 0.940 Vali Loss: 8.174 Vali Acc: 0.081 Test Loss: 8.174 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2608183
	speed: 0.7729s/iter; left time: 13909.4949s
	iters: 200, epoch: 14 | loss: 1.0297035
	speed: 0.3502s/iter; left time: 6266.8439s
Epoch: 14 cost time: 71.93953371047974
Epoch: 14, Steps: 208 | Train Loss: 0.866 Vali Loss: 8.193 Vali Acc: 0.069 Test Loss: 8.193 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9778864
	speed: 0.8122s/iter; left time: 14447.4891s
	iters: 200, epoch: 15 | loss: 1.0802538
	speed: 0.3373s/iter; left time: 5967.3707s
Epoch: 15 cost time: 71.25523161888123
Epoch: 15, Steps: 208 | Train Loss: 0.824 Vali Loss: 8.155 Vali Acc: 0.088 Test Loss: 8.155 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0619903
	speed: 0.7828s/iter; left time: 13761.9440s
	iters: 200, epoch: 16 | loss: 0.5023062
	speed: 0.3330s/iter; left time: 5821.1076s
Epoch: 16 cost time: 68.69712448120117
Epoch: 16, Steps: 208 | Train Loss: 0.751 Vali Loss: 8.875 Vali Acc: 0.084 Test Loss: 8.875 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9582323
	speed: 0.8059s/iter; left time: 14001.4556s
	iters: 200, epoch: 17 | loss: 2.0511684
	speed: 0.3241s/iter; left time: 5598.2283s
Epoch: 17 cost time: 68.90673923492432
Epoch: 17, Steps: 208 | Train Loss: 0.702 Vali Loss: 8.934 Vali Acc: 0.076 Test Loss: 8.934 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6076731
	speed: 0.7739s/iter; left time: 13284.4594s
	iters: 200, epoch: 18 | loss: 0.6909251
	speed: 0.3177s/iter; left time: 5420.8103s
Epoch: 18 cost time: 67.58306312561035
Epoch: 18, Steps: 208 | Train Loss: 0.642 Vali Loss: 9.195 Vali Acc: 0.075 Test Loss: 9.195 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4025590
	speed: 0.7807s/iter; left time: 13238.7992s
	iters: 200, epoch: 19 | loss: 0.7405220
	speed: 0.3539s/iter; left time: 5965.0882s
Epoch: 19 cost time: 72.37276673316956
Epoch: 19, Steps: 208 | Train Loss: 0.651 Vali Loss: 9.271 Vali Acc: 0.083 Test Loss: 9.271 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.9081697
	speed: 0.7836s/iter; left time: 13123.9429s
	iters: 200, epoch: 20 | loss: 1.3881739
	speed: 0.3468s/iter; left time: 5773.1411s
Epoch: 20 cost time: 71.69654273986816
Epoch: 20, Steps: 208 | Train Loss: 0.583 Vali Loss: 9.461 Vali Acc: 0.085 Test Loss: 9.461 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1874403
	speed: 0.7708s/iter; left time: 12749.1059s
	iters: 200, epoch: 21 | loss: 0.2910282
	speed: 0.3356s/iter; left time: 5517.3634s
Epoch: 21 cost time: 68.55453753471375
Epoch: 21, Steps: 208 | Train Loss: 0.615 Vali Loss: 9.849 Vali Acc: 0.078 Test Loss: 9.849 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3087878
	speed: 0.7465s/iter; left time: 12193.0871s
	iters: 200, epoch: 22 | loss: 0.6031392
	speed: 0.3272s/iter; left time: 5311.3070s
Epoch: 22 cost time: 67.39547991752625
Epoch: 22, Steps: 208 | Train Loss: 0.576 Vali Loss: 9.869 Vali Acc: 0.083 Test Loss: 9.869 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09096331643304503
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6675191
	speed: 0.3374s/iter; left time: 6985.1780s
	iters: 200, epoch: 1 | loss: 4.0098400
	speed: 0.3160s/iter; left time: 6509.5583s
Epoch: 1 cost time: 68.08119440078735
Epoch: 1, Steps: 208 | Train Loss: 4.639 Vali Loss: 6.239 Vali Acc: 0.067 Test Loss: 6.239 Test Acc: 0.067
Validation loss decreased (inf --> -0.066445).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.8777571
	speed: 0.7528s/iter; left time: 15426.3785s
	iters: 200, epoch: 2 | loss: 5.4447803
	speed: 0.3181s/iter; left time: 6487.1893s
Epoch: 2 cost time: 67.25666642189026
Epoch: 2, Steps: 208 | Train Loss: 4.283 Vali Loss: 5.744 Vali Acc: 0.067 Test Loss: 5.744 Test Acc: 0.067
Validation loss decreased (-0.066445 --> -0.067047).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7311580
	speed: 0.7863s/iter; left time: 15949.6466s
	iters: 200, epoch: 3 | loss: 3.8099699
	speed: 0.3289s/iter; left time: 6639.3973s
Epoch: 3 cost time: 68.59912776947021
Epoch: 3, Steps: 208 | Train Loss: 3.623 Vali Loss: 5.469 Vali Acc: 0.066 Test Loss: 5.469 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1291239
	speed: 0.7532s/iter; left time: 15121.0985s
	iters: 200, epoch: 4 | loss: 3.4628720
	speed: 0.3161s/iter; left time: 6313.9479s
Epoch: 4 cost time: 65.61680889129639
Epoch: 4, Steps: 208 | Train Loss: 3.266 Vali Loss: 5.110 Vali Acc: 0.071 Test Loss: 5.110 Test Acc: 0.071
Validation loss decreased (-0.067047 --> -0.070632).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6028051
	speed: 0.7507s/iter; left time: 14914.8697s
	iters: 200, epoch: 5 | loss: 3.2025633
	speed: 0.3104s/iter; left time: 6135.4969s
Epoch: 5 cost time: 64.09953904151917
Epoch: 5, Steps: 208 | Train Loss: 3.005 Vali Loss: 5.223 Vali Acc: 0.074 Test Loss: 5.223 Test Acc: 0.074
Validation loss decreased (-0.070632 --> -0.073613).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5766966
	speed: 0.7538s/iter; left time: 14821.1334s
	iters: 200, epoch: 6 | loss: 2.5921154
	speed: 0.3187s/iter; left time: 6234.3074s
Epoch: 6 cost time: 66.20649361610413
Epoch: 6, Steps: 208 | Train Loss: 2.843 Vali Loss: 4.724 Vali Acc: 0.074 Test Loss: 4.724 Test Acc: 0.074
Validation loss decreased (-0.073613 --> -0.073618).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7770810
	speed: 0.7497s/iter; left time: 14584.4012s
	iters: 200, epoch: 7 | loss: 4.2005053
	speed: 0.3243s/iter; left time: 6276.4877s
Epoch: 7 cost time: 65.64547920227051
Epoch: 7, Steps: 208 | Train Loss: 2.594 Vali Loss: 4.795 Vali Acc: 0.066 Test Loss: 4.795 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0523367
	speed: 0.7569s/iter; left time: 14565.7189s
	iters: 200, epoch: 8 | loss: 2.7733126
	speed: 0.3107s/iter; left time: 5948.6750s
Epoch: 8 cost time: 65.94140625
Epoch: 8, Steps: 208 | Train Loss: 2.366 Vali Loss: 5.340 Vali Acc: 0.074 Test Loss: 5.340 Test Acc: 0.074
Validation loss decreased (-0.073618 --> -0.074208).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2577183
	speed: 0.7874s/iter; left time: 14990.5421s
	iters: 200, epoch: 9 | loss: 2.2301357
	speed: 0.3097s/iter; left time: 5865.4522s
Epoch: 9 cost time: 65.98286533355713
Epoch: 9, Steps: 208 | Train Loss: 2.120 Vali Loss: 5.102 Vali Acc: 0.078 Test Loss: 5.102 Test Acc: 0.078
Validation loss decreased (-0.074208 --> -0.077790).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0368583
	speed: 0.7395s/iter; left time: 13923.3496s
	iters: 200, epoch: 10 | loss: 2.5799713
	speed: 0.3101s/iter; left time: 5807.3322s
Epoch: 10 cost time: 64.53187084197998
Epoch: 10, Steps: 208 | Train Loss: 1.884 Vali Loss: 5.534 Vali Acc: 0.089 Test Loss: 5.534 Test Acc: 0.089
Validation loss decreased (-0.077790 --> -0.088820).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1732113
	speed: 0.7567s/iter; left time: 14090.2319s
	iters: 200, epoch: 11 | loss: 1.5872823
	speed: 0.2985s/iter; left time: 5527.6872s
Epoch: 11 cost time: 63.32354402542114
Epoch: 11, Steps: 208 | Train Loss: 1.672 Vali Loss: 6.333 Vali Acc: 0.075 Test Loss: 6.333 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.4739180
	speed: 0.7331s/iter; left time: 13498.6403s
	iters: 200, epoch: 12 | loss: 2.6404130
	speed: 0.3021s/iter; left time: 5532.9789s
Epoch: 12 cost time: 63.88151955604553
Epoch: 12, Steps: 208 | Train Loss: 1.513 Vali Loss: 6.281 Vali Acc: 0.087 Test Loss: 6.281 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8739958
	speed: 0.7307s/iter; left time: 13302.8250s
	iters: 200, epoch: 13 | loss: 0.7633674
	speed: 0.2883s/iter; left time: 5219.7188s
Epoch: 13 cost time: 61.919776916503906
Epoch: 13, Steps: 208 | Train Loss: 1.334 Vali Loss: 6.332 Vali Acc: 0.089 Test Loss: 6.332 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.3325119
	speed: 0.7651s/iter; left time: 13768.9761s
	iters: 200, epoch: 14 | loss: 1.6112473
	speed: 0.3176s/iter; left time: 5684.4234s
Epoch: 14 cost time: 67.43533158302307
Epoch: 14, Steps: 208 | Train Loss: 1.182 Vali Loss: 6.963 Vali Acc: 0.076 Test Loss: 6.963 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7389960
	speed: 0.7710s/iter; left time: 13714.8191s
	iters: 200, epoch: 15 | loss: 2.3639441
	speed: 0.3244s/iter; left time: 5737.9227s
Epoch: 15 cost time: 67.84371972084045
Epoch: 15, Steps: 208 | Train Loss: 1.144 Vali Loss: 7.322 Vali Acc: 0.087 Test Loss: 7.322 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3807015
	speed: 0.7629s/iter; left time: 13411.7586s
	iters: 200, epoch: 16 | loss: 0.7880819
	speed: 0.3176s/iter; left time: 5552.4293s
Epoch: 16 cost time: 66.55593466758728
Epoch: 16, Steps: 208 | Train Loss: 1.025 Vali Loss: 7.941 Vali Acc: 0.079 Test Loss: 7.941 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7933910
	speed: 0.7699s/iter; left time: 13374.6044s
	iters: 200, epoch: 17 | loss: 1.0358965
	speed: 0.3185s/iter; left time: 5502.0415s
Epoch: 17 cost time: 66.28027009963989
Epoch: 17, Steps: 208 | Train Loss: 0.980 Vali Loss: 7.428 Vali Acc: 0.078 Test Loss: 7.428 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.6877497
	speed: 0.7572s/iter; left time: 12998.0658s
	iters: 200, epoch: 18 | loss: 1.1079228
	speed: 0.3216s/iter; left time: 5488.0170s
Epoch: 18 cost time: 66.78438568115234
Epoch: 18, Steps: 208 | Train Loss: 0.869 Vali Loss: 8.370 Vali Acc: 0.088 Test Loss: 8.370 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.5943342
	speed: 0.7895s/iter; left time: 13387.3716s
	iters: 200, epoch: 19 | loss: 0.7175297
	speed: 0.3380s/iter; left time: 5697.2213s
Epoch: 19 cost time: 70.25129914283752
Epoch: 19, Steps: 208 | Train Loss: 0.852 Vali Loss: 8.116 Vali Acc: 0.083 Test Loss: 8.116 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.8398396
	speed: 0.7744s/iter; left time: 12969.7070s
	iters: 200, epoch: 20 | loss: 0.7311106
	speed: 0.3266s/iter; left time: 5437.4885s
Epoch: 20 cost time: 68.73662114143372
Epoch: 20, Steps: 208 | Train Loss: 0.805 Vali Loss: 8.398 Vali Acc: 0.079 Test Loss: 8.398 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08887563376081122
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0020232
	speed: 0.3237s/iter; left time: 6699.9378s
	iters: 200, epoch: 1 | loss: 3.8554194
	speed: 0.3132s/iter; left time: 6452.7002s
Epoch: 1 cost time: 66.71303820610046
Epoch: 1, Steps: 208 | Train Loss: 4.650 Vali Loss: 6.785 Vali Acc: 0.058 Test Loss: 6.785 Test Acc: 0.058
Validation loss decreased (inf --> -0.058387).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.1620493
	speed: 0.7472s/iter; left time: 15311.4699s
	iters: 200, epoch: 2 | loss: 6.2105846
	speed: 0.3026s/iter; left time: 6171.8515s
Epoch: 2 cost time: 64.33391070365906
Epoch: 2, Steps: 208 | Train Loss: 4.740 Vali Loss: 6.773 Vali Acc: 0.062 Test Loss: 6.773 Test Acc: 0.062
Validation loss decreased (-0.058387 --> -0.062265).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3736608
	speed: 0.6987s/iter; left time: 14173.8223s
	iters: 200, epoch: 3 | loss: 4.2454720
	speed: 0.2840s/iter; left time: 5732.6101s
Epoch: 3 cost time: 60.17340850830078
Epoch: 3, Steps: 208 | Train Loss: 3.910 Vali Loss: 5.568 Vali Acc: 0.059 Test Loss: 5.568 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.8828149
	speed: 0.6765s/iter; left time: 13581.8931s
	iters: 200, epoch: 4 | loss: 3.0083814
	speed: 0.2903s/iter; left time: 5799.8880s
Epoch: 4 cost time: 60.613685607910156
Epoch: 4, Steps: 208 | Train Loss: 3.772 Vali Loss: 4.667 Vali Acc: 0.066 Test Loss: 4.667 Test Acc: 0.066
Validation loss decreased (-0.062265 --> -0.066163).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.5254893
	speed: 0.7485s/iter; left time: 14872.0035s
	iters: 200, epoch: 5 | loss: 3.1540494
	speed: 0.3022s/iter; left time: 5975.1319s
Epoch: 5 cost time: 64.50356936454773
Epoch: 5, Steps: 208 | Train Loss: 3.469 Vali Loss: 4.452 Vali Acc: 0.070 Test Loss: 4.452 Test Acc: 0.070
Validation loss decreased (-0.066163 --> -0.070042).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1354170
	speed: 0.7186s/iter; left time: 14127.7282s
	iters: 200, epoch: 6 | loss: 3.5907927
	speed: 0.2873s/iter; left time: 5620.3755s
Epoch: 6 cost time: 61.90189456939697
Epoch: 6, Steps: 208 | Train Loss: 3.423 Vali Loss: 4.005 Vali Acc: 0.049 Test Loss: 4.005 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2996047
	speed: 0.7250s/iter; left time: 14102.8849s
	iters: 200, epoch: 7 | loss: 4.2268157
	speed: 0.3005s/iter; left time: 5814.9318s
Epoch: 7 cost time: 63.56648135185242
Epoch: 7, Steps: 208 | Train Loss: 3.466 Vali Loss: 4.003 Vali Acc: 0.037 Test Loss: 4.003 Test Acc: 0.037
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.2514656
	speed: 0.7202s/iter; left time: 13860.1237s
	iters: 200, epoch: 8 | loss: 3.3776534
	speed: 0.3082s/iter; left time: 5900.1535s
Epoch: 8 cost time: 64.54408764839172
Epoch: 8, Steps: 208 | Train Loss: 3.507 Vali Loss: 3.836 Vali Acc: 0.049 Test Loss: 3.836 Test Acc: 0.049
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.3209617
	speed: 0.7086s/iter; left time: 13489.9551s
	iters: 200, epoch: 9 | loss: 3.1831050
	speed: 0.2984s/iter; left time: 5650.4474s
Epoch: 9 cost time: 62.70552611351013
Epoch: 9, Steps: 208 | Train Loss: 3.422 Vali Loss: 3.751 Vali Acc: 0.050 Test Loss: 3.751 Test Acc: 0.050
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.1905224
	speed: 0.7220s/iter; left time: 13594.6433s
	iters: 200, epoch: 10 | loss: 3.1132815
	speed: 0.3167s/iter; left time: 5931.6986s
Epoch: 10 cost time: 66.20584678649902
Epoch: 10, Steps: 208 | Train Loss: 3.254 Vali Loss: 3.820 Vali Acc: 0.055 Test Loss: 3.820 Test Acc: 0.055
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.2544234
	speed: 0.7362s/iter; left time: 13708.7625s
	iters: 200, epoch: 11 | loss: 2.8545723
	speed: 0.3100s/iter; left time: 5741.6550s
Epoch: 11 cost time: 65.7559106349945
Epoch: 11, Steps: 208 | Train Loss: 3.146 Vali Loss: 3.807 Vali Acc: 0.057 Test Loss: 3.807 Test Acc: 0.057
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6402905
	speed: 0.7442s/iter; left time: 13703.8119s
	iters: 200, epoch: 12 | loss: 3.2914786
	speed: 0.3148s/iter; left time: 5764.7792s
Epoch: 12 cost time: 65.91698050498962
Epoch: 12, Steps: 208 | Train Loss: 3.025 Vali Loss: 3.866 Vali Acc: 0.064 Test Loss: 3.866 Test Acc: 0.064
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.3625369
	speed: 0.7607s/iter; left time: 13849.1715s
	iters: 200, epoch: 13 | loss: 2.7949445
	speed: 0.3136s/iter; left time: 5678.3231s
Epoch: 13 cost time: 66.5320508480072
Epoch: 13, Steps: 208 | Train Loss: 2.893 Vali Loss: 3.873 Vali Acc: 0.056 Test Loss: 3.873 Test Acc: 0.056
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.7798665
	speed: 0.7271s/iter; left time: 13084.8012s
	iters: 200, epoch: 14 | loss: 3.0837505
	speed: 0.3200s/iter; left time: 5727.2829s
Epoch: 14 cost time: 66.01067447662354
Epoch: 14, Steps: 208 | Train Loss: 2.787 Vali Loss: 4.050 Vali Acc: 0.060 Test Loss: 4.050 Test Acc: 0.060
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.2088661
	speed: 0.7261s/iter; left time: 12916.0380s
	iters: 200, epoch: 15 | loss: 3.0436561
	speed: 0.3301s/iter; left time: 5839.8196s
Epoch: 15 cost time: 68.14179253578186
Epoch: 15, Steps: 208 | Train Loss: 2.657 Vali Loss: 3.967 Vali Acc: 0.068 Test Loss: 3.967 Test Acc: 0.068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07008648971070683
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8288360
	speed: 0.3420s/iter; left time: 7079.6860s
	iters: 200, epoch: 1 | loss: 3.8850956
	speed: 0.3078s/iter; left time: 6340.8026s
Epoch: 1 cost time: 67.65099430084229
Epoch: 1, Steps: 208 | Train Loss: 4.557 Vali Loss: 6.709 Vali Acc: 0.039 Test Loss: 6.709 Test Acc: 0.039
Validation loss decreased (inf --> -0.038704).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.0825615
	speed: 0.7450s/iter; left time: 15267.5611s
	iters: 200, epoch: 2 | loss: 6.2730861
	speed: 0.2914s/iter; left time: 5943.2112s
Epoch: 2 cost time: 63.62533664703369
Epoch: 2, Steps: 208 | Train Loss: 4.673 Vali Loss: 5.833 Vali Acc: 0.047 Test Loss: 5.833 Test Acc: 0.047
Validation loss decreased (-0.038704 --> -0.046467).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5053716
	speed: 0.7281s/iter; left time: 14769.9659s
	iters: 200, epoch: 3 | loss: 4.8408160
	speed: 0.2824s/iter; left time: 5699.6263s
Epoch: 3 cost time: 60.92413783073425
Epoch: 3, Steps: 208 | Train Loss: 4.062 Vali Loss: 5.466 Vali Acc: 0.040 Test Loss: 5.466 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2674842
	speed: 0.7227s/iter; left time: 14509.0382s
	iters: 200, epoch: 4 | loss: 3.4554369
	speed: 0.2776s/iter; left time: 5545.7137s
Epoch: 4 cost time: 60.77624869346619
Epoch: 4, Steps: 208 | Train Loss: 3.953 Vali Loss: 4.639 Vali Acc: 0.055 Test Loss: 4.639 Test Acc: 0.055
Validation loss decreased (-0.046467 --> -0.054532).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.2227206
	speed: 0.7392s/iter; left time: 14686.2523s
	iters: 200, epoch: 5 | loss: 4.7523966
	speed: 0.3026s/iter; left time: 5981.9946s
Epoch: 5 cost time: 64.08077073097229
Epoch: 5, Steps: 208 | Train Loss: 3.929 Vali Loss: 4.648 Vali Acc: 0.049 Test Loss: 4.648 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.0980692
	speed: 0.7179s/iter; left time: 14113.9408s
	iters: 200, epoch: 6 | loss: 4.0636878
	speed: 0.2974s/iter; left time: 5817.9937s
Epoch: 6 cost time: 62.01857900619507
Epoch: 6, Steps: 208 | Train Loss: 4.315 Vali Loss: 4.414 Vali Acc: 0.030 Test Loss: 4.414 Test Acc: 0.030
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.6629384
	speed: 0.6926s/iter; left time: 13473.5763s
	iters: 200, epoch: 7 | loss: 3.5551848
	speed: 0.2804s/iter; left time: 5426.5990s
Epoch: 7 cost time: 58.260005712509155
Epoch: 7, Steps: 208 | Train Loss: 4.207 Vali Loss: 3.947 Vali Acc: 0.027 Test Loss: 3.947 Test Acc: 0.027
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.4983428
	speed: 0.7383s/iter; left time: 14209.2311s
	iters: 200, epoch: 8 | loss: 3.9131794
	speed: 0.2912s/iter; left time: 5574.2147s
Epoch: 8 cost time: 63.30131506919861
Epoch: 8, Steps: 208 | Train Loss: 3.925 Vali Loss: 3.849 Vali Acc: 0.035 Test Loss: 3.849 Test Acc: 0.035
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.9378190
	speed: 0.7417s/iter; left time: 14120.3012s
	iters: 200, epoch: 9 | loss: 3.8226781
	speed: 0.2865s/iter; left time: 5424.7596s
Epoch: 9 cost time: 61.95727348327637
Epoch: 9, Steps: 208 | Train Loss: 3.840 Vali Loss: 3.793 Vali Acc: 0.031 Test Loss: 3.793 Test Acc: 0.031
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.6529882
	speed: 0.7468s/iter; left time: 14062.2562s
	iters: 200, epoch: 10 | loss: 3.6241570
	speed: 0.3012s/iter; left time: 5640.4351s
Epoch: 10 cost time: 64.44988298416138
Epoch: 10, Steps: 208 | Train Loss: 3.781 Vali Loss: 3.883 Vali Acc: 0.034 Test Loss: 3.883 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7755809
	speed: 0.7576s/iter; left time: 14106.3703s
	iters: 200, epoch: 11 | loss: 3.6849420
	speed: 0.3087s/iter; left time: 5717.4753s
Epoch: 11 cost time: 65.75967836380005
Epoch: 11, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.752 Vali Acc: 0.033 Test Loss: 3.752 Test Acc: 0.033
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6119843
	speed: 0.7407s/iter; left time: 13638.3118s
	iters: 200, epoch: 12 | loss: 3.7959621
	speed: 0.2891s/iter; left time: 5295.1717s
Epoch: 12 cost time: 62.53801679611206
Epoch: 12, Steps: 208 | Train Loss: 3.736 Vali Loss: 3.789 Vali Acc: 0.035 Test Loss: 3.789 Test Acc: 0.035
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6622498
	speed: 0.7375s/iter; left time: 13425.7751s
	iters: 200, epoch: 13 | loss: 3.9592140
	speed: 0.2979s/iter; left time: 5392.8690s
Epoch: 13 cost time: 64.15044784545898
Epoch: 13, Steps: 208 | Train Loss: 3.718 Vali Loss: 3.718 Vali Acc: 0.033 Test Loss: 3.718 Test Acc: 0.033
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.7062936
	speed: 0.7642s/iter; left time: 13753.6575s
	iters: 200, epoch: 14 | loss: 3.6891842
	speed: 0.3006s/iter; left time: 5379.9327s
Epoch: 14 cost time: 65.2578547000885
Epoch: 14, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.700 Vali Acc: 0.033 Test Loss: 3.700 Test Acc: 0.033
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05457798985982702
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4545274
	speed: 0.2867s/iter; left time: 5934.1654s
	iters: 200, epoch: 1 | loss: 3.7859650
	speed: 0.2867s/iter; left time: 5906.1100s
Epoch: 1 cost time: 59.92824864387512
Epoch: 1, Steps: 208 | Train Loss: 4.427 Vali Loss: 8.580 Vali Acc: 0.032 Test Loss: 8.580 Test Acc: 0.032
Validation loss decreased (inf --> -0.032124).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.8870325
	speed: 0.7045s/iter; left time: 14436.3414s
	iters: 200, epoch: 2 | loss: 7.9163008
	speed: 0.2965s/iter; left time: 6047.3550s
Epoch: 2 cost time: 62.52720093727112
Epoch: 2, Steps: 208 | Train Loss: 5.153 Vali Loss: 9.136 Vali Acc: 0.045 Test Loss: 9.136 Test Acc: 0.045
Validation loss decreased (-0.032124 --> -0.044645).  Saving model ...
	iters: 100, epoch: 3 | loss: 6.0328031
	speed: 0.7172s/iter; left time: 14549.0357s
	iters: 200, epoch: 3 | loss: 5.1137958
	speed: 0.3093s/iter; left time: 6243.4137s
Epoch: 3 cost time: 63.75890564918518
Epoch: 3, Steps: 208 | Train Loss: 5.243 Vali Loss: 5.678 Vali Acc: 0.045 Test Loss: 5.678 Test Acc: 0.045
Validation loss decreased (-0.044645 --> -0.044978).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.5744863
	speed: 0.7379s/iter; left time: 14814.6637s
	iters: 200, epoch: 4 | loss: 3.5770223
	speed: 0.2928s/iter; left time: 5849.8687s
Epoch: 4 cost time: 62.13179016113281
Epoch: 4, Steps: 208 | Train Loss: 4.612 Vali Loss: 4.443 Vali Acc: 0.046 Test Loss: 4.443 Test Acc: 0.046
Validation loss decreased (-0.044978 --> -0.046183).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.9084725
	speed: 0.7605s/iter; left time: 15110.2939s
	iters: 200, epoch: 5 | loss: 4.7606559
	speed: 0.3185s/iter; left time: 6297.1322s
Epoch: 5 cost time: 66.6881422996521
Epoch: 5, Steps: 208 | Train Loss: 4.412 Vali Loss: 4.204 Vali Acc: 0.028 Test Loss: 4.204 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.9900992
	speed: 0.7283s/iter; left time: 14319.2051s
	iters: 200, epoch: 6 | loss: 3.8975728
	speed: 0.3000s/iter; left time: 5868.3624s
Epoch: 6 cost time: 63.22986888885498
Epoch: 6, Steps: 208 | Train Loss: 4.078 Vali Loss: 4.076 Vali Acc: 0.030 Test Loss: 4.076 Test Acc: 0.030
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.1548843
	speed: 0.7497s/iter; left time: 14584.4166s
	iters: 200, epoch: 7 | loss: 3.7898886
	speed: 0.2981s/iter; left time: 5769.4247s
Epoch: 7 cost time: 63.73272657394409
Epoch: 7, Steps: 208 | Train Loss: 3.927 Vali Loss: 3.937 Vali Acc: 0.029 Test Loss: 3.937 Test Acc: 0.029
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.7973659
	speed: 0.7120s/iter; left time: 13701.7417s
	iters: 200, epoch: 8 | loss: 3.6862001
	speed: 0.3064s/iter; left time: 5865.3307s
Epoch: 8 cost time: 63.14698648452759
Epoch: 8, Steps: 208 | Train Loss: 3.808 Vali Loss: 3.824 Vali Acc: 0.030 Test Loss: 3.824 Test Acc: 0.030
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.9572964
	speed: 0.7123s/iter; left time: 13559.4209s
	iters: 200, epoch: 9 | loss: 3.7287498
	speed: 0.2842s/iter; left time: 5381.5690s
Epoch: 9 cost time: 61.17356991767883
Epoch: 9, Steps: 208 | Train Loss: 3.781 Vali Loss: 3.824 Vali Acc: 0.024 Test Loss: 3.824 Test Acc: 0.024
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.8669379
	speed: 0.7236s/iter; left time: 13625.5142s
	iters: 200, epoch: 10 | loss: 3.7703798
	speed: 0.3229s/iter; left time: 6047.8691s
Epoch: 10 cost time: 65.56005859375
Epoch: 10, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.726 Vali Acc: 0.037 Test Loss: 3.726 Test Acc: 0.037
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.8223295
	speed: 0.7165s/iter; left time: 13341.0867s
	iters: 200, epoch: 11 | loss: 3.7467630
	speed: 0.3190s/iter; left time: 5907.7600s
Epoch: 11 cost time: 64.86779832839966
Epoch: 11, Steps: 208 | Train Loss: 3.722 Vali Loss: 3.711 Vali Acc: 0.026 Test Loss: 3.711 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7372444
	speed: 0.6941s/iter; left time: 12780.0474s
	iters: 200, epoch: 12 | loss: 3.6789644
	speed: 0.3074s/iter; left time: 5629.1428s
Epoch: 12 cost time: 61.77550554275513
Epoch: 12, Steps: 208 | Train Loss: 3.711 Vali Loss: 3.703 Vali Acc: 0.039 Test Loss: 3.703 Test Acc: 0.039
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7085087
	speed: 0.7168s/iter; left time: 13048.8479s
	iters: 200, epoch: 13 | loss: 3.6488008
	speed: 0.2742s/iter; left time: 4965.1780s
Epoch: 13 cost time: 59.67345118522644
Epoch: 13, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.679 Vali Acc: 0.042 Test Loss: 3.679 Test Acc: 0.042
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6609626
	speed: 0.6961s/iter; left time: 12527.8387s
	iters: 200, epoch: 14 | loss: 3.8225641
	speed: 0.2692s/iter; left time: 4818.3749s
Epoch: 14 cost time: 58.042380809783936
Epoch: 14, Steps: 208 | Train Loss: 3.672 Vali Loss: 3.725 Vali Acc: 0.041 Test Loss: 3.725 Test Acc: 0.041
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.04622725917089174
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7014732
	speed: 0.3155s/iter; left time: 6531.2493s
	iters: 200, epoch: 1 | loss: 3.5434201
	speed: 0.3139s/iter; left time: 6467.3358s
Epoch: 1 cost time: 65.79140782356262
Epoch: 1, Steps: 208 | Train Loss: 4.350 Vali Loss: 7.965 Vali Acc: 0.033 Test Loss: 7.965 Test Acc: 0.033
Validation loss decreased (inf --> -0.033323).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.1392059
	speed: 0.6987s/iter; left time: 14318.6379s
	iters: 200, epoch: 2 | loss: 8.1753407
	speed: 0.2851s/iter; left time: 5813.2647s
Epoch: 2 cost time: 60.041918992996216
Epoch: 2, Steps: 208 | Train Loss: 4.892 Vali Loss: 10.103 Vali Acc: 0.041 Test Loss: 10.103 Test Acc: 0.041
Validation loss decreased (-0.033323 --> -0.040758).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.2136488
	speed: 0.6780s/iter; left time: 13752.5991s
	iters: 200, epoch: 3 | loss: 5.4081202
	speed: 0.2993s/iter; left time: 6041.5897s
Epoch: 3 cost time: 60.931607246398926
Epoch: 3, Steps: 208 | Train Loss: 5.096 Vali Loss: 7.148 Vali Acc: 0.041 Test Loss: 7.148 Test Acc: 0.041
Validation loss decreased (-0.040758 --> -0.041086).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.2782865
	speed: 0.6853s/iter; left time: 13757.9599s
	iters: 200, epoch: 4 | loss: 3.8666162
	speed: 0.2981s/iter; left time: 5954.3675s
Epoch: 4 cost time: 60.160271644592285
Epoch: 4, Steps: 208 | Train Loss: 4.439 Vali Loss: 4.739 Vali Acc: 0.051 Test Loss: 4.739 Test Acc: 0.051
Validation loss decreased (-0.041086 --> -0.051250).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3459849
	speed: 0.6857s/iter; left time: 13624.8879s
	iters: 200, epoch: 5 | loss: 4.0360160
	speed: 0.2887s/iter; left time: 5707.7877s
Epoch: 5 cost time: 59.44873046875
Epoch: 5, Steps: 208 | Train Loss: 3.816 Vali Loss: 4.663 Vali Acc: 0.052 Test Loss: 4.663 Test Acc: 0.052
Validation loss decreased (-0.051250 --> -0.051549).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6043060
	speed: 0.6813s/iter; left time: 13394.6605s
	iters: 200, epoch: 6 | loss: 4.1922903
	speed: 0.2895s/iter; left time: 5662.2118s
Epoch: 6 cost time: 59.62942051887512
Epoch: 6, Steps: 208 | Train Loss: 3.791 Vali Loss: 4.483 Vali Acc: 0.033 Test Loss: 4.483 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 5.0587435
	speed: 0.6902s/iter; left time: 13425.7685s
	iters: 200, epoch: 7 | loss: 3.9496791
	speed: 0.2909s/iter; left time: 5630.6964s
Epoch: 7 cost time: 61.11002707481384
Epoch: 7, Steps: 208 | Train Loss: 4.236 Vali Loss: 3.904 Vali Acc: 0.025 Test Loss: 3.904 Test Acc: 0.025
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7654850
	speed: 0.6711s/iter; left time: 12916.2627s
	iters: 200, epoch: 8 | loss: 3.6013236
	speed: 0.2959s/iter; left time: 5665.7492s
Epoch: 8 cost time: 59.74154591560364
Epoch: 8, Steps: 208 | Train Loss: 3.953 Vali Loss: 3.851 Vali Acc: 0.034 Test Loss: 3.851 Test Acc: 0.034
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 4.3222194
	speed: 0.7093s/iter; left time: 13501.9958s
	iters: 200, epoch: 9 | loss: 3.7344656
	speed: 0.2980s/iter; left time: 5643.1804s
Epoch: 9 cost time: 61.78567886352539
Epoch: 9, Steps: 208 | Train Loss: 3.841 Vali Loss: 3.795 Vali Acc: 0.033 Test Loss: 3.795 Test Acc: 0.033
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.5857153
	speed: 0.7103s/iter; left time: 13375.0329s
	iters: 200, epoch: 10 | loss: 3.5182819
	speed: 0.2961s/iter; left time: 5546.2887s
Epoch: 10 cost time: 60.83886432647705
Epoch: 10, Steps: 208 | Train Loss: 3.783 Vali Loss: 3.752 Vali Acc: 0.038 Test Loss: 3.752 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.8352189
	speed: 0.6854s/iter; left time: 12763.1892s
	iters: 200, epoch: 11 | loss: 3.7824790
	speed: 0.3025s/iter; left time: 5602.4058s
Epoch: 11 cost time: 61.504416942596436
Epoch: 11, Steps: 208 | Train Loss: 3.754 Vali Loss: 3.735 Vali Acc: 0.039 Test Loss: 3.735 Test Acc: 0.039
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6357486
	speed: 0.6895s/iter; left time: 12696.3405s
	iters: 200, epoch: 12 | loss: 3.6202919
	speed: 0.3080s/iter; left time: 5640.1574s
Epoch: 12 cost time: 62.56210899353027
Epoch: 12, Steps: 208 | Train Loss: 3.721 Vali Loss: 3.724 Vali Acc: 0.042 Test Loss: 3.724 Test Acc: 0.042
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.5939174
	speed: 0.6898s/iter; left time: 12556.9218s
	iters: 200, epoch: 13 | loss: 3.7135599
	speed: 0.3028s/iter; left time: 5481.4417s
Epoch: 13 cost time: 61.36121106147766
Epoch: 13, Steps: 208 | Train Loss: 3.689 Vali Loss: 3.661 Vali Acc: 0.042 Test Loss: 3.661 Test Acc: 0.042
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7660131
	speed: 0.6884s/iter; left time: 12389.3054s
	iters: 200, epoch: 14 | loss: 3.7316906
	speed: 0.2886s/iter; left time: 5165.3429s
Epoch: 14 cost time: 59.5663857460022
Epoch: 14, Steps: 208 | Train Loss: 3.670 Vali Loss: 3.694 Vali Acc: 0.039 Test Loss: 3.694 Test Acc: 0.039
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.6634707
	speed: 0.7025s/iter; left time: 12496.8492s
	iters: 200, epoch: 15 | loss: 3.6722283
	speed: 0.2822s/iter; left time: 4992.2525s
Epoch: 15 cost time: 59.213407039642334
Epoch: 15, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.632 Vali Acc: 0.049 Test Loss: 3.632 Test Acc: 0.049
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.051595586042350136
model parameter : 18006567
model size : 88.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.6049786
	speed: 0.3067s/iter; left time: 6349.5536s
	iters: 200, epoch: 1 | loss: 6.2675109
	speed: 0.3039s/iter; left time: 6260.2628s
Epoch: 1 cost time: 63.97518706321716
Epoch: 1, Steps: 208 | Train Loss: 4.972 Vali Loss: 5.366 Vali Acc: 0.054 Test Loss: 5.366 Test Acc: 0.054
Validation loss decreased (inf --> -0.053928).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.3966331
	speed: 0.7062s/iter; left time: 14471.1914s
	iters: 200, epoch: 2 | loss: 4.3885307
	speed: 0.3146s/iter; left time: 6414.6761s
Epoch: 2 cost time: 62.771193504333496
Epoch: 2, Steps: 208 | Train Loss: 4.173 Vali Loss: 4.767 Vali Acc: 0.049 Test Loss: 4.767 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.5141826
	speed: 0.6950s/iter; left time: 14098.9718s
	iters: 200, epoch: 3 | loss: 3.2249417
	speed: 0.2918s/iter; left time: 5890.5052s
Epoch: 3 cost time: 60.85792016983032
Epoch: 3, Steps: 208 | Train Loss: 3.484 Vali Loss: 5.155 Vali Acc: 0.071 Test Loss: 5.155 Test Acc: 0.071
Validation loss decreased (-0.053928 --> -0.070631).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8377345
	speed: 0.7143s/iter; left time: 14341.8391s
	iters: 200, epoch: 4 | loss: 4.5358524
	speed: 0.3001s/iter; left time: 5994.1955s
Epoch: 4 cost time: 62.12921476364136
Epoch: 4, Steps: 208 | Train Loss: 3.094 Vali Loss: 4.426 Vali Acc: 0.063 Test Loss: 4.426 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.7002385
	speed: 0.7202s/iter; left time: 14310.4382s
	iters: 200, epoch: 5 | loss: 3.4941792
	speed: 0.3057s/iter; left time: 6043.7612s
Epoch: 5 cost time: 64.13975548744202
Epoch: 5, Steps: 208 | Train Loss: 2.953 Vali Loss: 4.825 Vali Acc: 0.068 Test Loss: 4.825 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.7059276
	speed: 0.6957s/iter; left time: 13677.9983s
	iters: 200, epoch: 6 | loss: 3.4772842
	speed: 0.2918s/iter; left time: 5706.9813s
Epoch: 6 cost time: 60.93423533439636
Epoch: 6, Steps: 208 | Train Loss: 2.940 Vali Loss: 5.193 Vali Acc: 0.073 Test Loss: 5.193 Test Acc: 0.073
Validation loss decreased (-0.070631 --> -0.072719).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2504747
	speed: 0.6924s/iter; left time: 13469.8973s
	iters: 200, epoch: 7 | loss: 2.0638342
	speed: 0.3001s/iter; left time: 5808.0236s
Epoch: 7 cost time: 62.50756311416626
Epoch: 7, Steps: 208 | Train Loss: 2.674 Vali Loss: 4.938 Vali Acc: 0.061 Test Loss: 4.938 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6988502
	speed: 0.7001s/iter; left time: 13472.5886s
	iters: 200, epoch: 8 | loss: 2.7104795
	speed: 0.2988s/iter; left time: 5721.2070s
Epoch: 8 cost time: 63.00264525413513
Epoch: 8, Steps: 208 | Train Loss: 2.421 Vali Loss: 5.635 Vali Acc: 0.079 Test Loss: 5.635 Test Acc: 0.079
Validation loss decreased (-0.072719 --> -0.078977).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5206103
	speed: 0.7068s/iter; left time: 13454.5398s
	iters: 200, epoch: 9 | loss: 3.4614117
	speed: 0.3028s/iter; left time: 5733.1993s
Epoch: 9 cost time: 62.51931667327881
Epoch: 9, Steps: 208 | Train Loss: 2.125 Vali Loss: 5.589 Vali Acc: 0.072 Test Loss: 5.589 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7022197
	speed: 0.6971s/iter; left time: 13124.7930s
	iters: 200, epoch: 10 | loss: 2.1262219
	speed: 0.2966s/iter; left time: 5555.1066s
Epoch: 10 cost time: 63.17374229431152
Epoch: 10, Steps: 208 | Train Loss: 1.845 Vali Loss: 5.827 Vali Acc: 0.082 Test Loss: 5.827 Test Acc: 0.082
Validation loss decreased (-0.078977 --> -0.081958).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8649251
	speed: 0.6931s/iter; left time: 12906.4598s
	iters: 200, epoch: 11 | loss: 1.1930292
	speed: 0.2883s/iter; left time: 5339.5512s
Epoch: 11 cost time: 60.6108021736145
Epoch: 11, Steps: 208 | Train Loss: 1.503 Vali Loss: 6.562 Vali Acc: 0.084 Test Loss: 6.562 Test Acc: 0.084
Validation loss decreased (-0.081958 --> -0.083740).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6752814
	speed: 0.7139s/iter; left time: 13145.6500s
	iters: 200, epoch: 12 | loss: 1.3010250
	speed: 0.3010s/iter; left time: 5511.5813s
Epoch: 12 cost time: 63.02357292175293
Epoch: 12, Steps: 208 | Train Loss: 1.280 Vali Loss: 6.253 Vali Acc: 0.078 Test Loss: 6.253 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9177226
	speed: 0.7292s/iter; left time: 13275.1520s
	iters: 200, epoch: 13 | loss: 0.9060815
	speed: 0.2954s/iter; left time: 5347.4126s
Epoch: 13 cost time: 63.173372745513916
Epoch: 13, Steps: 208 | Train Loss: 1.046 Vali Loss: 7.069 Vali Acc: 0.076 Test Loss: 7.069 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6323942
	speed: 0.6983s/iter; left time: 12567.6275s
	iters: 200, epoch: 14 | loss: 0.5770097
	speed: 0.2965s/iter; left time: 5305.7136s
Epoch: 14 cost time: 62.38016176223755
Epoch: 14, Steps: 208 | Train Loss: 0.864 Vali Loss: 7.683 Vali Acc: 0.078 Test Loss: 7.683 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6984278
	speed: 0.6962s/iter; left time: 12385.4534s
	iters: 200, epoch: 15 | loss: 0.8535645
	speed: 0.3074s/iter; left time: 5438.2957s
Epoch: 15 cost time: 63.94220685958862
Epoch: 15, Steps: 208 | Train Loss: 0.721 Vali Loss: 8.162 Vali Acc: 0.079 Test Loss: 8.162 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0524714
	speed: 0.7243s/iter; left time: 12733.3966s
	iters: 200, epoch: 16 | loss: 0.3257322
	speed: 0.3052s/iter; left time: 5335.5081s
Epoch: 16 cost time: 62.871121883392334
Epoch: 16, Steps: 208 | Train Loss: 0.612 Vali Loss: 8.573 Vali Acc: 0.089 Test Loss: 8.573 Test Acc: 0.089
Validation loss decreased (-0.083740 --> -0.088492).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6001574
	speed: 0.7166s/iter; left time: 12450.0302s
	iters: 200, epoch: 17 | loss: 0.5785997
	speed: 0.3039s/iter; left time: 5248.5384s
Epoch: 17 cost time: 63.24489140510559
Epoch: 17, Steps: 208 | Train Loss: 0.542 Vali Loss: 8.560 Vali Acc: 0.080 Test Loss: 8.560 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6349064
	speed: 0.7180s/iter; left time: 12325.0200s
	iters: 200, epoch: 18 | loss: 1.3803396
	speed: 0.3113s/iter; left time: 5312.6490s
Epoch: 18 cost time: 64.72439050674438
Epoch: 18, Steps: 208 | Train Loss: 0.487 Vali Loss: 9.315 Vali Acc: 0.087 Test Loss: 9.315 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5963455
	speed: 0.6927s/iter; left time: 11745.3540s
	iters: 200, epoch: 19 | loss: 0.5570127
	speed: 0.2944s/iter; left time: 4962.6761s
Epoch: 19 cost time: 61.89466428756714
Epoch: 19, Steps: 208 | Train Loss: 0.433 Vali Loss: 9.043 Vali Acc: 0.075 Test Loss: 9.043 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1963570
	speed: 0.7041s/iter; left time: 11793.3504s
	iters: 200, epoch: 20 | loss: 0.2259628
	speed: 0.2974s/iter; left time: 4951.5436s
Epoch: 20 cost time: 62.38688135147095
Epoch: 20, Steps: 208 | Train Loss: 0.411 Vali Loss: 8.956 Vali Acc: 0.078 Test Loss: 8.956 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1033550
	speed: 0.7175s/iter; left time: 11867.4220s
	iters: 200, epoch: 21 | loss: 0.0876417
	speed: 0.2835s/iter; left time: 4660.8795s
Epoch: 21 cost time: 62.286449670791626
Epoch: 21, Steps: 208 | Train Loss: 0.360 Vali Loss: 10.143 Vali Acc: 0.083 Test Loss: 10.143 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.7500125
	speed: 0.6913s/iter; left time: 11290.3538s
	iters: 200, epoch: 22 | loss: 0.5636946
	speed: 0.2855s/iter; left time: 4635.0630s
Epoch: 22 cost time: 61.43189787864685
Epoch: 22, Steps: 208 | Train Loss: 0.346 Vali Loss: 9.352 Vali Acc: 0.080 Test Loss: 9.352 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1822385
	speed: 0.6954s/iter; left time: 11214.0136s
	iters: 200, epoch: 23 | loss: 0.3334563
	speed: 0.2865s/iter; left time: 4590.5400s
Epoch: 23 cost time: 61.612125635147095
Epoch: 23, Steps: 208 | Train Loss: 0.366 Vali Loss: 9.797 Vali Acc: 0.088 Test Loss: 9.797 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.5022281
	speed: 0.7155s/iter; left time: 11389.2969s
	iters: 200, epoch: 24 | loss: 0.1908839
	speed: 0.2732s/iter; left time: 4321.4440s
Epoch: 24 cost time: 59.89998984336853
Epoch: 24, Steps: 208 | Train Loss: 0.333 Vali Loss: 9.555 Vali Acc: 0.085 Test Loss: 9.555 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1301962
	speed: 0.6796s/iter; left time: 10675.9992s
	iters: 200, epoch: 25 | loss: 0.6965415
	speed: 0.2819s/iter; left time: 4399.5488s
Epoch: 25 cost time: 60.61841058731079
Epoch: 25, Steps: 208 | Train Loss: 0.283 Vali Loss: 10.531 Vali Acc: 0.081 Test Loss: 10.531 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0091684
	speed: 0.6902s/iter; left time: 10699.2823s
	iters: 200, epoch: 26 | loss: 0.2027039
	speed: 0.2981s/iter; left time: 4591.7624s
Epoch: 26 cost time: 61.810606956481934
Epoch: 26, Steps: 208 | Train Loss: 0.272 Vali Loss: 10.167 Vali Acc: 0.078 Test Loss: 10.167 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08857739337906352
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8554401
	speed: 0.2980s/iter; left time: 6168.6360s
	iters: 200, epoch: 1 | loss: 6.2797761
	speed: 0.2697s/iter; left time: 5556.9866s
Epoch: 1 cost time: 59.139769554138184
Epoch: 1, Steps: 208 | Train Loss: 4.949 Vali Loss: 4.848 Vali Acc: 0.056 Test Loss: 4.848 Test Acc: 0.056
Validation loss decreased (inf --> -0.056021).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.5740552
	speed: 0.6789s/iter; left time: 13913.1388s
	iters: 200, epoch: 2 | loss: 4.2582760
	speed: 0.2873s/iter; left time: 5859.5400s
Epoch: 2 cost time: 59.7363018989563
Epoch: 2, Steps: 208 | Train Loss: 4.140 Vali Loss: 4.686 Vali Acc: 0.062 Test Loss: 4.686 Test Acc: 0.062
Validation loss decreased (-0.056021 --> -0.061987).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0653086
	speed: 0.7610s/iter; left time: 15436.6807s
	iters: 200, epoch: 3 | loss: 3.9361591
	speed: 0.3022s/iter; left time: 6100.2000s
Epoch: 3 cost time: 64.89938521385193
Epoch: 3, Steps: 208 | Train Loss: 3.443 Vali Loss: 5.119 Vali Acc: 0.066 Test Loss: 5.119 Test Acc: 0.066
Validation loss decreased (-0.061987 --> -0.066158).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1079216
	speed: 0.7203s/iter; left time: 14460.6145s
	iters: 200, epoch: 4 | loss: 2.8719013
	speed: 0.2805s/iter; left time: 5604.3022s
Epoch: 4 cost time: 60.27726340293884
Epoch: 4, Steps: 208 | Train Loss: 2.906 Vali Loss: 5.229 Vali Acc: 0.067 Test Loss: 5.229 Test Acc: 0.067
Validation loss decreased (-0.066158 --> -0.066754).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8943624
	speed: 0.7098s/iter; left time: 14103.1359s
	iters: 200, epoch: 5 | loss: 3.8782563
	speed: 0.2803s/iter; left time: 5541.9815s
Epoch: 5 cost time: 60.296101570129395
Epoch: 5, Steps: 208 | Train Loss: 2.578 Vali Loss: 5.575 Vali Acc: 0.066 Test Loss: 5.575 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1709752
	speed: 0.6930s/iter; left time: 13625.6343s
	iters: 200, epoch: 6 | loss: 2.0841997
	speed: 0.2784s/iter; left time: 5445.6596s
Epoch: 6 cost time: 59.76738739013672
Epoch: 6, Steps: 208 | Train Loss: 2.290 Vali Loss: 5.793 Vali Acc: 0.075 Test Loss: 5.793 Test Acc: 0.075
Validation loss decreased (-0.066754 --> -0.075397).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9500329
	speed: 0.6865s/iter; left time: 13355.4541s
	iters: 200, epoch: 7 | loss: 2.1140819
	speed: 0.2772s/iter; left time: 5365.0289s
Epoch: 7 cost time: 58.906644105911255
Epoch: 7, Steps: 208 | Train Loss: 2.035 Vali Loss: 5.940 Vali Acc: 0.072 Test Loss: 5.940 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7554857
	speed: 0.6855s/iter; left time: 13191.8407s
	iters: 200, epoch: 8 | loss: 2.8917847
	speed: 0.2888s/iter; left time: 5529.6888s
Epoch: 8 cost time: 60.79180884361267
Epoch: 8, Steps: 208 | Train Loss: 1.706 Vali Loss: 6.607 Vali Acc: 0.079 Test Loss: 6.607 Test Acc: 0.079
Validation loss decreased (-0.075397 --> -0.078669).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2555852
	speed: 0.6934s/iter; left time: 13199.9955s
	iters: 200, epoch: 9 | loss: 2.6387930
	speed: 0.2817s/iter; left time: 5335.0445s
Epoch: 9 cost time: 58.845136880874634
Epoch: 9, Steps: 208 | Train Loss: 1.387 Vali Loss: 7.372 Vali Acc: 0.078 Test Loss: 7.372 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2836347
	speed: 0.6471s/iter; left time: 12183.9749s
	iters: 200, epoch: 10 | loss: 2.0024128
	speed: 0.2837s/iter; left time: 5312.8041s
Epoch: 10 cost time: 58.017364501953125
Epoch: 10, Steps: 208 | Train Loss: 1.209 Vali Loss: 7.759 Vali Acc: 0.082 Test Loss: 7.759 Test Acc: 0.082
Validation loss decreased (-0.078669 --> -0.081640).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0623229
	speed: 0.7099s/iter; left time: 13218.6672s
	iters: 200, epoch: 11 | loss: 0.5411422
	speed: 0.2978s/iter; left time: 5515.1692s
Epoch: 11 cost time: 62.4943962097168
Epoch: 11, Steps: 208 | Train Loss: 1.033 Vali Loss: 7.997 Vali Acc: 0.080 Test Loss: 7.997 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5158564
	speed: 0.6577s/iter; left time: 12111.0897s
	iters: 200, epoch: 12 | loss: 1.0948708
	speed: 0.2822s/iter; left time: 5168.1504s
Epoch: 12 cost time: 57.63348937034607
Epoch: 12, Steps: 208 | Train Loss: 0.872 Vali Loss: 8.391 Vali Acc: 0.082 Test Loss: 8.391 Test Acc: 0.082
Validation loss decreased (-0.081640 --> -0.081932).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4672926
	speed: 0.6598s/iter; left time: 12011.8146s
	iters: 200, epoch: 13 | loss: 0.4993128
	speed: 0.2701s/iter; left time: 4889.7907s
Epoch: 13 cost time: 55.50069570541382
Epoch: 13, Steps: 208 | Train Loss: 0.760 Vali Loss: 9.008 Vali Acc: 0.072 Test Loss: 9.008 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1540640
	speed: 0.6693s/iter; left time: 12045.4424s
	iters: 200, epoch: 14 | loss: 0.3864522
	speed: 0.2565s/iter; left time: 4590.9584s
Epoch: 14 cost time: 54.97437357902527
Epoch: 14, Steps: 208 | Train Loss: 0.692 Vali Loss: 9.127 Vali Acc: 0.086 Test Loss: 9.127 Test Acc: 0.086
Validation loss decreased (-0.081932 --> -0.085504).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3119408
	speed: 0.6700s/iter; left time: 11918.1782s
	iters: 200, epoch: 15 | loss: 0.7536747
	speed: 0.2599s/iter; left time: 4597.1483s
Epoch: 15 cost time: 55.020079374313354
Epoch: 15, Steps: 208 | Train Loss: 0.640 Vali Loss: 9.494 Vali Acc: 0.080 Test Loss: 9.494 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8422489
	speed: 0.6787s/iter; left time: 11933.1022s
	iters: 200, epoch: 16 | loss: 0.3902685
	speed: 0.2859s/iter; left time: 4996.9622s
Epoch: 16 cost time: 60.03967261314392
Epoch: 16, Steps: 208 | Train Loss: 0.560 Vali Loss: 9.877 Vali Acc: 0.083 Test Loss: 9.877 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7168683
	speed: 0.6905s/iter; left time: 11996.0963s
	iters: 200, epoch: 17 | loss: 0.5441729
	speed: 0.2702s/iter; left time: 4667.6224s
Epoch: 17 cost time: 58.49202513694763
Epoch: 17, Steps: 208 | Train Loss: 0.548 Vali Loss: 10.310 Vali Acc: 0.086 Test Loss: 10.310 Test Acc: 0.086
Validation loss decreased (-0.085504 --> -0.085790).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0109643
	speed: 0.6989s/iter; left time: 11995.9123s
	iters: 200, epoch: 18 | loss: 0.3053110
	speed: 0.2669s/iter; left time: 4554.9930s
Epoch: 18 cost time: 58.15695118904114
Epoch: 18, Steps: 208 | Train Loss: 0.477 Vali Loss: 10.725 Vali Acc: 0.083 Test Loss: 10.725 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5125472
	speed: 0.7052s/iter; left time: 11958.8587s
	iters: 200, epoch: 19 | loss: 0.0739850
	speed: 0.2733s/iter; left time: 4607.0815s
Epoch: 19 cost time: 60.497856855392456
Epoch: 19, Steps: 208 | Train Loss: 0.486 Vali Loss: 10.487 Vali Acc: 0.085 Test Loss: 10.487 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2084631
	speed: 0.6663s/iter; left time: 11159.7358s
	iters: 200, epoch: 20 | loss: 0.1541355
	speed: 0.2770s/iter; left time: 4612.3624s
Epoch: 20 cost time: 58.25127720832825
Epoch: 20, Steps: 208 | Train Loss: 0.451 Vali Loss: 10.604 Vali Acc: 0.075 Test Loss: 10.604 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2974901
	speed: 0.6623s/iter; left time: 10954.3930s
	iters: 200, epoch: 21 | loss: 0.1115093
	speed: 0.2904s/iter; left time: 4774.4425s
Epoch: 21 cost time: 59.8810031414032
Epoch: 21, Steps: 208 | Train Loss: 0.486 Vali Loss: 10.980 Vali Acc: 0.086 Test Loss: 10.980 Test Acc: 0.086
Validation loss decreased (-0.085790 --> -0.086082).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.9284307
	speed: 0.6724s/iter; left time: 10981.7578s
	iters: 200, epoch: 22 | loss: 0.5204633
	speed: 0.2870s/iter; left time: 4659.0171s
Epoch: 22 cost time: 59.016013860702515
Epoch: 22, Steps: 208 | Train Loss: 0.414 Vali Loss: 11.133 Vali Acc: 0.076 Test Loss: 11.133 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2478864
	speed: 0.6777s/iter; left time: 10928.1780s
	iters: 200, epoch: 23 | loss: 0.6086545
	speed: 0.2978s/iter; left time: 4772.4497s
Epoch: 23 cost time: 61.93557000160217
Epoch: 23, Steps: 208 | Train Loss: 0.441 Vali Loss: 10.582 Vali Acc: 0.088 Test Loss: 10.582 Test Acc: 0.088
Validation loss decreased (-0.086082 --> -0.087577).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.6919824
	speed: 0.6696s/iter; left time: 10657.4323s
	iters: 200, epoch: 24 | loss: 0.2509255
	speed: 0.2852s/iter; left time: 4511.0930s
Epoch: 24 cost time: 59.56705594062805
Epoch: 24, Steps: 208 | Train Loss: 0.380 Vali Loss: 11.260 Vali Acc: 0.086 Test Loss: 11.260 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.5257999
	speed: 0.6591s/iter; left time: 10353.2284s
	iters: 200, epoch: 25 | loss: 0.0850443
	speed: 0.2999s/iter; left time: 4681.7712s
Epoch: 25 cost time: 59.28087019920349
Epoch: 25, Steps: 208 | Train Loss: 0.394 Vali Loss: 10.617 Vali Acc: 0.085 Test Loss: 10.617 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3085746
	speed: 0.6957s/iter; left time: 10784.0551s
	iters: 200, epoch: 26 | loss: 0.7312547
	speed: 0.2975s/iter; left time: 4581.6399s
Epoch: 26 cost time: 61.86631202697754
Epoch: 26, Steps: 208 | Train Loss: 0.387 Vali Loss: 10.631 Vali Acc: 0.072 Test Loss: 10.631 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1723926
	speed: 0.6753s/iter; left time: 10327.4049s
	iters: 200, epoch: 27 | loss: 0.0045350
	speed: 0.2912s/iter; left time: 4423.8140s
Epoch: 27 cost time: 59.14980435371399
Epoch: 27, Steps: 208 | Train Loss: 0.325 Vali Loss: 11.209 Vali Acc: 0.083 Test Loss: 11.209 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0046295
	speed: 0.7000s/iter; left time: 10559.3382s
	iters: 200, epoch: 28 | loss: 0.3638187
	speed: 0.2945s/iter; left time: 4412.8458s
Epoch: 28 cost time: 60.89410638809204
Epoch: 28, Steps: 208 | Train Loss: 0.364 Vali Loss: 11.111 Vali Acc: 0.083 Test Loss: 11.111 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.4183375
	speed: 0.6537s/iter; left time: 9724.9028s
	iters: 200, epoch: 29 | loss: 0.2069836
	speed: 0.2924s/iter; left time: 4321.2749s
Epoch: 29 cost time: 58.4576461315155
Epoch: 29, Steps: 208 | Train Loss: 0.299 Vali Loss: 11.071 Vali Acc: 0.084 Test Loss: 11.071 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.2831608
	speed: 0.6676s/iter; left time: 9792.4663s
	iters: 200, epoch: 30 | loss: 0.9703186
	speed: 0.2877s/iter; left time: 4191.7343s
Epoch: 30 cost time: 59.65334105491638
Epoch: 30, Steps: 208 | Train Loss: 0.300 Vali Loss: 11.465 Vali Acc: 0.081 Test Loss: 11.465 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0146838
	speed: 0.7035s/iter; left time: 10173.0796s
	iters: 200, epoch: 31 | loss: 0.0272891
	speed: 0.3022s/iter; left time: 4340.5820s
Epoch: 31 cost time: 61.7134211063385
Epoch: 31, Steps: 208 | Train Loss: 0.323 Vali Loss: 11.150 Vali Acc: 0.082 Test Loss: 11.150 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.4089867
	speed: 0.6427s/iter; left time: 9160.0955s
	iters: 200, epoch: 32 | loss: 0.0462152
	speed: 0.2827s/iter; left time: 4001.1747s
Epoch: 32 cost time: 56.964964151382446
Epoch: 32, Steps: 208 | Train Loss: 0.331 Vali Loss: 11.384 Vali Acc: 0.086 Test Loss: 11.384 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1216421
	speed: 0.6397s/iter; left time: 8984.8960s
	iters: 200, epoch: 33 | loss: 0.4506551
	speed: 0.2718s/iter; left time: 3790.7355s
Epoch: 33 cost time: 55.712321043014526
Epoch: 33, Steps: 208 | Train Loss: 0.293 Vali Loss: 11.493 Vali Acc: 0.078 Test Loss: 11.493 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08768267223382047
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3948622
	speed: 0.2885s/iter; left time: 5971.5041s
	iters: 200, epoch: 1 | loss: 6.4673638
	speed: 0.2831s/iter; left time: 5832.4929s
Epoch: 1 cost time: 59.90102481842041
Epoch: 1, Steps: 208 | Train Loss: 4.980 Vali Loss: 5.061 Vali Acc: 0.057 Test Loss: 5.061 Test Acc: 0.057
Validation loss decreased (inf --> -0.056615).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.3880906
	speed: 0.6593s/iter; left time: 13511.3424s
	iters: 200, epoch: 2 | loss: 4.0349431
	speed: 0.2710s/iter; left time: 5526.4939s
Epoch: 2 cost time: 56.35077953338623
Epoch: 2, Steps: 208 | Train Loss: 4.184 Vali Loss: 4.888 Vali Acc: 0.055 Test Loss: 4.888 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.3622584
	speed: 0.6930s/iter; left time: 14057.1646s
	iters: 200, epoch: 3 | loss: 3.5366719
	speed: 0.2929s/iter; left time: 5911.5118s
Epoch: 3 cost time: 62.118099212646484
Epoch: 3, Steps: 208 | Train Loss: 3.451 Vali Loss: 5.124 Vali Acc: 0.072 Test Loss: 5.124 Test Acc: 0.072
Validation loss decreased (-0.056615 --> -0.071825).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8328381
	speed: 0.6878s/iter; left time: 13808.7983s
	iters: 200, epoch: 4 | loss: 3.0053623
	speed: 0.2809s/iter; left time: 5611.4893s
Epoch: 4 cost time: 59.75351357460022
Epoch: 4, Steps: 208 | Train Loss: 2.947 Vali Loss: 5.075 Vali Acc: 0.063 Test Loss: 5.075 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8215189
	speed: 0.6713s/iter; left time: 13337.7635s
	iters: 200, epoch: 5 | loss: 3.1999314
	speed: 0.2736s/iter; left time: 5409.4384s
Epoch: 5 cost time: 58.707963705062866
Epoch: 5, Steps: 208 | Train Loss: 2.599 Vali Loss: 5.484 Vali Acc: 0.069 Test Loss: 5.484 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.7735791
	speed: 0.7020s/iter; left time: 13801.0784s
	iters: 200, epoch: 6 | loss: 3.4705253
	speed: 0.2869s/iter; left time: 5612.7723s
Epoch: 6 cost time: 61.51833987236023
Epoch: 6, Steps: 208 | Train Loss: 2.356 Vali Loss: 5.368 Vali Acc: 0.066 Test Loss: 5.368 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.6311531
	speed: 0.6616s/iter; left time: 12870.0189s
	iters: 200, epoch: 7 | loss: 1.6205431
	speed: 0.2794s/iter; left time: 5406.5889s
Epoch: 7 cost time: 58.994115352630615
Epoch: 7, Steps: 208 | Train Loss: 2.010 Vali Loss: 6.476 Vali Acc: 0.064 Test Loss: 6.476 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3714980
	speed: 0.6521s/iter; left time: 12549.9585s
	iters: 200, epoch: 8 | loss: 2.5395484
	speed: 0.2887s/iter; left time: 5526.7665s
Epoch: 8 cost time: 61.283642292022705
Epoch: 8, Steps: 208 | Train Loss: 1.656 Vali Loss: 7.016 Vali Acc: 0.072 Test Loss: 7.016 Test Acc: 0.072
Validation loss decreased (-0.071825 --> -0.072402).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7963496
	speed: 0.6879s/iter; left time: 13094.7548s
	iters: 200, epoch: 9 | loss: 2.6072905
	speed: 0.2728s/iter; left time: 5166.8159s
Epoch: 9 cost time: 58.56976270675659
Epoch: 9, Steps: 208 | Train Loss: 1.332 Vali Loss: 7.264 Vali Acc: 0.076 Test Loss: 7.264 Test Acc: 0.076
Validation loss decreased (-0.072402 --> -0.075680).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5584779
	speed: 0.6197s/iter; left time: 11668.7394s
	iters: 200, epoch: 10 | loss: 0.8366777
	speed: 0.2763s/iter; left time: 5175.3796s
Epoch: 10 cost time: 56.85643219947815
Epoch: 10, Steps: 208 | Train Loss: 1.177 Vali Loss: 7.823 Vali Acc: 0.079 Test Loss: 7.823 Test Acc: 0.079
Validation loss decreased (-0.075680 --> -0.079254).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1043656
	speed: 0.6547s/iter; left time: 12190.8990s
	iters: 200, epoch: 11 | loss: 0.6937832
	speed: 0.2831s/iter; left time: 5242.8549s
Epoch: 11 cost time: 57.64995336532593
Epoch: 11, Steps: 208 | Train Loss: 0.940 Vali Loss: 8.193 Vali Acc: 0.076 Test Loss: 8.193 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0630854
	speed: 0.6361s/iter; left time: 11712.5358s
	iters: 200, epoch: 12 | loss: 1.0351963
	speed: 0.2597s/iter; left time: 4755.5672s
Epoch: 12 cost time: 53.850985288619995
Epoch: 12, Steps: 208 | Train Loss: 0.869 Vali Loss: 9.122 Vali Acc: 0.081 Test Loss: 9.122 Test Acc: 0.081
Validation loss decreased (-0.079254 --> -0.081030).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1916724
	speed: 0.6511s/iter; left time: 11852.7431s
	iters: 200, epoch: 13 | loss: 1.1486137
	speed: 0.2494s/iter; left time: 4514.9919s
Epoch: 13 cost time: 52.82017731666565
Epoch: 13, Steps: 208 | Train Loss: 0.746 Vali Loss: 9.155 Vali Acc: 0.070 Test Loss: 9.155 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1582848
	speed: 0.7133s/iter; left time: 12838.0785s
	iters: 200, epoch: 14 | loss: 0.4959010
	speed: 0.3019s/iter; left time: 5403.8691s
Epoch: 14 cost time: 63.0669002532959
Epoch: 14, Steps: 208 | Train Loss: 0.739 Vali Loss: 9.575 Vali Acc: 0.078 Test Loss: 9.575 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4244538
	speed: 0.6775s/iter; left time: 12051.6003s
	iters: 200, epoch: 15 | loss: 0.9490250
	speed: 0.2838s/iter; left time: 5019.7369s
Epoch: 15 cost time: 57.87417030334473
Epoch: 15, Steps: 208 | Train Loss: 0.591 Vali Loss: 9.994 Vali Acc: 0.078 Test Loss: 9.994 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2243621
	speed: 0.6891s/iter; left time: 12115.3370s
	iters: 200, epoch: 16 | loss: 0.2127156
	speed: 0.2792s/iter; left time: 4880.1664s
Epoch: 16 cost time: 59.52795481681824
Epoch: 16, Steps: 208 | Train Loss: 0.577 Vali Loss: 9.401 Vali Acc: 0.080 Test Loss: 9.401 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5240576
	speed: 0.6972s/iter; left time: 12112.5507s
	iters: 200, epoch: 17 | loss: 0.8901278
	speed: 0.2830s/iter; left time: 4888.0026s
Epoch: 17 cost time: 59.49397826194763
Epoch: 17, Steps: 208 | Train Loss: 0.549 Vali Loss: 10.536 Vali Acc: 0.082 Test Loss: 10.536 Test Acc: 0.082
Validation loss decreased (-0.081030 --> -0.081613).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4140490
	speed: 0.6843s/iter; left time: 11745.2639s
	iters: 200, epoch: 18 | loss: 0.3347667
	speed: 0.2720s/iter; left time: 4641.9752s
Epoch: 18 cost time: 57.00277590751648
Epoch: 18, Steps: 208 | Train Loss: 0.536 Vali Loss: 10.550 Vali Acc: 0.078 Test Loss: 10.550 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4778581
	speed: 0.6893s/iter; left time: 11689.1854s
	iters: 200, epoch: 19 | loss: 1.1244762
	speed: 0.2804s/iter; left time: 4727.5070s
Epoch: 19 cost time: 59.65980267524719
Epoch: 19, Steps: 208 | Train Loss: 0.525 Vali Loss: 10.069 Vali Acc: 0.082 Test Loss: 10.069 Test Acc: 0.082
Validation loss decreased (-0.081613 --> -0.081617).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4778240
	speed: 0.7027s/iter; left time: 11770.1716s
	iters: 200, epoch: 20 | loss: 0.0556599
	speed: 0.2683s/iter; left time: 4467.5978s
Epoch: 20 cost time: 57.14302039146423
Epoch: 20, Steps: 208 | Train Loss: 0.464 Vali Loss: 10.627 Vali Acc: 0.074 Test Loss: 10.627 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0697618
	speed: 0.6367s/iter; left time: 10531.8622s
	iters: 200, epoch: 21 | loss: 0.2736343
	speed: 0.2587s/iter; left time: 4252.6800s
Epoch: 21 cost time: 54.09871768951416
Epoch: 21, Steps: 208 | Train Loss: 0.446 Vali Loss: 10.598 Vali Acc: 0.073 Test Loss: 10.598 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2622873
	speed: 0.6529s/iter; left time: 10663.1738s
	iters: 200, epoch: 22 | loss: 0.0222779
	speed: 0.2595s/iter; left time: 4212.9762s
Epoch: 22 cost time: 54.51545453071594
Epoch: 22, Steps: 208 | Train Loss: 0.442 Vali Loss: 10.678 Vali Acc: 0.078 Test Loss: 10.678 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4150631
	speed: 0.6320s/iter; left time: 10190.3831s
	iters: 200, epoch: 23 | loss: 0.2666523
	speed: 0.2509s/iter; left time: 4020.5036s
Epoch: 23 cost time: 54.07274389266968
Epoch: 23, Steps: 208 | Train Loss: 0.432 Vali Loss: 10.773 Vali Acc: 0.083 Test Loss: 10.773 Test Acc: 0.083
Validation loss decreased (-0.081617 --> -0.082505).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.7368039
	speed: 0.7002s/iter; left time: 11145.7994s
	iters: 200, epoch: 24 | loss: 0.0718418
	speed: 0.2944s/iter; left time: 4656.0031s
Epoch: 24 cost time: 61.289772510528564
Epoch: 24, Steps: 208 | Train Loss: 0.372 Vali Loss: 11.339 Vali Acc: 0.079 Test Loss: 11.339 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4366568
	speed: 0.6913s/iter; left time: 10858.9150s
	iters: 200, epoch: 25 | loss: 0.6600348
	speed: 0.2649s/iter; left time: 4134.2540s
Epoch: 25 cost time: 57.6337673664093
Epoch: 25, Steps: 208 | Train Loss: 0.388 Vali Loss: 11.805 Vali Acc: 0.082 Test Loss: 11.805 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.4466388
	speed: 0.6636s/iter; left time: 10286.3683s
	iters: 200, epoch: 26 | loss: 0.7574040
	speed: 0.2693s/iter; left time: 4147.4783s
Epoch: 26 cost time: 57.09308910369873
Epoch: 26, Steps: 208 | Train Loss: 0.424 Vali Loss: 10.874 Vali Acc: 0.073 Test Loss: 10.874 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1056223
	speed: 0.7041s/iter; left time: 10768.5531s
	iters: 200, epoch: 27 | loss: 0.0962950
	speed: 0.2730s/iter; left time: 4147.8131s
Epoch: 27 cost time: 59.45992660522461
Epoch: 27, Steps: 208 | Train Loss: 0.344 Vali Loss: 11.289 Vali Acc: 0.078 Test Loss: 11.289 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.2663173
	speed: 0.6796s/iter; left time: 10251.6214s
	iters: 200, epoch: 28 | loss: 0.2915285
	speed: 0.2622s/iter; left time: 3929.7441s
Epoch: 28 cost time: 57.13711333274841
Epoch: 28, Steps: 208 | Train Loss: 0.381 Vali Loss: 11.330 Vali Acc: 0.069 Test Loss: 11.330 Test Acc: 0.069
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1348451
	speed: 0.6729s/iter; left time: 10010.4007s
	iters: 200, epoch: 29 | loss: 0.6660558
	speed: 0.2865s/iter; left time: 4233.5455s
Epoch: 29 cost time: 60.84672927856445
Epoch: 29, Steps: 208 | Train Loss: 0.378 Vali Loss: 11.055 Vali Acc: 0.080 Test Loss: 11.055 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.6857708
	speed: 0.6965s/iter; left time: 10217.6318s
	iters: 200, epoch: 30 | loss: 0.2564104
	speed: 0.2758s/iter; left time: 4017.9796s
Epoch: 30 cost time: 59.843727588653564
Epoch: 30, Steps: 208 | Train Loss: 0.335 Vali Loss: 11.048 Vali Acc: 0.085 Test Loss: 11.048 Test Acc: 0.085
Validation loss decreased (-0.082505 --> -0.084888).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0292147
	speed: 0.6687s/iter; left time: 9670.2415s
	iters: 200, epoch: 31 | loss: 0.3203681
	speed: 0.2788s/iter; left time: 4003.7164s
Epoch: 31 cost time: 59.479674100875854
Epoch: 31, Steps: 208 | Train Loss: 0.310 Vali Loss: 11.136 Vali Acc: 0.074 Test Loss: 11.136 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.1457195
	speed: 0.6777s/iter; left time: 9658.6958s
	iters: 200, epoch: 32 | loss: 0.1051317
	speed: 0.2996s/iter; left time: 4239.7677s
Epoch: 32 cost time: 62.04861378669739
Epoch: 32, Steps: 208 | Train Loss: 0.291 Vali Loss: 11.172 Vali Acc: 0.075 Test Loss: 11.172 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0533793
	speed: 0.6916s/iter; left time: 9713.2183s
	iters: 200, epoch: 33 | loss: 0.2735946
	speed: 0.2775s/iter; left time: 3869.4905s
Epoch: 33 cost time: 60.523632287979126
Epoch: 33, Steps: 208 | Train Loss: 0.278 Vali Loss: 11.034 Vali Acc: 0.084 Test Loss: 11.034 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.3356476
	speed: 0.6613s/iter; left time: 9150.7843s
	iters: 200, epoch: 34 | loss: 0.9293945
	speed: 0.2821s/iter; left time: 3874.6568s
Epoch: 34 cost time: 60.77244853973389
Epoch: 34, Steps: 208 | Train Loss: 0.304 Vali Loss: 11.680 Vali Acc: 0.080 Test Loss: 11.680 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0074925
	speed: 0.6960s/iter; left time: 9486.3817s
	iters: 200, epoch: 35 | loss: 0.4208610
	speed: 0.2974s/iter; left time: 4023.5456s
Epoch: 35 cost time: 62.901949644088745
Epoch: 35, Steps: 208 | Train Loss: 0.308 Vali Loss: 11.289 Vali Acc: 0.080 Test Loss: 11.289 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.2493009
	speed: 0.7117s/iter; left time: 9551.5977s
	iters: 200, epoch: 36 | loss: 0.0099170
	speed: 0.3079s/iter; left time: 4101.2449s
Epoch: 36 cost time: 63.15851950645447
Epoch: 36, Steps: 208 | Train Loss: 0.300 Vali Loss: 11.611 Vali Acc: 0.090 Test Loss: 11.611 Test Acc: 0.090
Validation loss decreased (-0.084888 --> -0.089952).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.8930544
	speed: 0.6929s/iter; left time: 9155.2762s
	iters: 200, epoch: 37 | loss: 0.1635974
	speed: 0.2914s/iter; left time: 3821.6487s
Epoch: 37 cost time: 61.01657724380493
Epoch: 37, Steps: 208 | Train Loss: 0.281 Vali Loss: 11.156 Vali Acc: 0.083 Test Loss: 11.156 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0646572
	speed: 0.7099s/iter; left time: 9232.3923s
	iters: 200, epoch: 38 | loss: 0.1781882
	speed: 0.2913s/iter; left time: 3759.6616s
Epoch: 38 cost time: 61.07883262634277
Epoch: 38, Steps: 208 | Train Loss: 0.239 Vali Loss: 11.504 Vali Acc: 0.082 Test Loss: 11.504 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.1729389
	speed: 0.7221s/iter; left time: 9240.9747s
	iters: 200, epoch: 39 | loss: 0.4163836
	speed: 0.2887s/iter; left time: 3665.6141s
Epoch: 39 cost time: 60.87657570838928
Epoch: 39, Steps: 208 | Train Loss: 0.247 Vali Loss: 12.091 Vali Acc: 0.084 Test Loss: 12.091 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.2532751
	speed: 0.6968s/iter; left time: 8771.6028s
	iters: 200, epoch: 40 | loss: 0.3468925
	speed: 0.2839s/iter; left time: 3545.3088s
Epoch: 40 cost time: 60.3772873878479
Epoch: 40, Steps: 208 | Train Loss: 0.252 Vali Loss: 11.738 Vali Acc: 0.075 Test Loss: 11.738 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.2829576
	speed: 0.6866s/iter; left time: 8500.4614s
	iters: 200, epoch: 41 | loss: 0.2682289
	speed: 0.2918s/iter; left time: 3583.1009s
Epoch: 41 cost time: 60.013991832733154
Epoch: 41, Steps: 208 | Train Loss: 0.269 Vali Loss: 12.127 Vali Acc: 0.078 Test Loss: 12.127 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0097050
	speed: 0.6920s/iter; left time: 8424.1658s
	iters: 200, epoch: 42 | loss: 0.0489214
	speed: 0.2939s/iter; left time: 3548.5107s
Epoch: 42 cost time: 61.004862785339355
Epoch: 42, Steps: 208 | Train Loss: 0.220 Vali Loss: 11.949 Vali Acc: 0.084 Test Loss: 11.949 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.3140403
	speed: 0.7105s/iter; left time: 8501.6977s
	iters: 200, epoch: 43 | loss: 0.3347131
	speed: 0.3023s/iter; left time: 3586.8568s
Epoch: 43 cost time: 62.64199471473694
Epoch: 43, Steps: 208 | Train Loss: 0.268 Vali Loss: 11.414 Vali Acc: 0.076 Test Loss: 11.414 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0096050
	speed: 0.7362s/iter; left time: 8655.9093s
	iters: 200, epoch: 44 | loss: 0.0780706
	speed: 0.2961s/iter; left time: 3451.1635s
Epoch: 44 cost time: 63.04344344139099
Epoch: 44, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.766 Vali Acc: 0.082 Test Loss: 11.766 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.1789781
	speed: 0.6982s/iter; left time: 8063.5164s
	iters: 200, epoch: 45 | loss: 0.3071810
	speed: 0.3137s/iter; left time: 3591.6843s
Epoch: 45 cost time: 63.19824981689453
Epoch: 45, Steps: 208 | Train Loss: 0.209 Vali Loss: 11.826 Vali Acc: 0.088 Test Loss: 11.826 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.1605625
	speed: 0.7330s/iter; left time: 8312.7388s
	iters: 200, epoch: 46 | loss: 0.1452644
	speed: 0.3070s/iter; left time: 3451.1595s
Epoch: 46 cost time: 64.32016801834106
Epoch: 46, Steps: 208 | Train Loss: 0.213 Vali Loss: 12.060 Vali Acc: 0.080 Test Loss: 12.060 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09006859528780196
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8104105
	speed: 0.3011s/iter; left time: 6232.8763s
	iters: 200, epoch: 1 | loss: 6.3294458
	speed: 0.2905s/iter; left time: 5984.0921s
Epoch: 1 cost time: 61.857146978378296
Epoch: 1, Steps: 208 | Train Loss: 4.929 Vali Loss: 5.008 Vali Acc: 0.066 Test Loss: 5.008 Test Acc: 0.066
Validation loss decreased (inf --> -0.065563).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.3467526
	speed: 0.6659s/iter; left time: 13645.4330s
	iters: 200, epoch: 2 | loss: 4.1098061
	speed: 0.2909s/iter; left time: 5931.3967s
Epoch: 2 cost time: 61.738797187805176
Epoch: 2, Steps: 208 | Train Loss: 4.151 Vali Loss: 4.622 Vali Acc: 0.067 Test Loss: 4.622 Test Acc: 0.067
Validation loss decreased (-0.065563 --> -0.067058).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5084114
	speed: 0.7287s/iter; left time: 14782.6776s
	iters: 200, epoch: 3 | loss: 3.4120355
	speed: 0.2916s/iter; left time: 5886.4859s
Epoch: 3 cost time: 62.48487091064453
Epoch: 3, Steps: 208 | Train Loss: 3.450 Vali Loss: 5.030 Vali Acc: 0.068 Test Loss: 5.030 Test Acc: 0.068
Validation loss decreased (-0.067058 --> -0.067949).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0957005
	speed: 0.7084s/iter; left time: 14222.8258s
	iters: 200, epoch: 4 | loss: 3.3893647
	speed: 0.2846s/iter; left time: 5686.2440s
Epoch: 4 cost time: 61.3953332901001
Epoch: 4, Steps: 208 | Train Loss: 2.892 Vali Loss: 5.263 Vali Acc: 0.078 Test Loss: 5.263 Test Acc: 0.078
Validation loss decreased (-0.067949 --> -0.077490).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6634388
	speed: 0.7026s/iter; left time: 13959.8511s
	iters: 200, epoch: 5 | loss: 4.2483139
	speed: 0.3057s/iter; left time: 6042.9085s
Epoch: 5 cost time: 64.01831412315369
Epoch: 5, Steps: 208 | Train Loss: 2.547 Vali Loss: 5.677 Vali Acc: 0.065 Test Loss: 5.677 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8336692
	speed: 0.7179s/iter; left time: 14114.2022s
	iters: 200, epoch: 6 | loss: 3.2521112
	speed: 0.2969s/iter; left time: 5807.1901s
Epoch: 6 cost time: 62.94589447975159
Epoch: 6, Steps: 208 | Train Loss: 2.270 Vali Loss: 6.018 Vali Acc: 0.067 Test Loss: 6.018 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1717525
	speed: 0.6948s/iter; left time: 13515.1276s
	iters: 200, epoch: 7 | loss: 2.9979153
	speed: 0.2880s/iter; left time: 5573.6165s
Epoch: 7 cost time: 60.514426946640015
Epoch: 7, Steps: 208 | Train Loss: 1.888 Vali Loss: 6.459 Vali Acc: 0.080 Test Loss: 6.459 Test Acc: 0.080
Validation loss decreased (-0.077490 --> -0.079864).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1246523
	speed: 0.7245s/iter; left time: 13943.3687s
	iters: 200, epoch: 8 | loss: 2.0627871
	speed: 0.2839s/iter; left time: 5435.8588s
Epoch: 8 cost time: 61.55384850502014
Epoch: 8, Steps: 208 | Train Loss: 1.645 Vali Loss: 7.231 Vali Acc: 0.082 Test Loss: 7.231 Test Acc: 0.082
Validation loss decreased (-0.079864 --> -0.082242).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2489815
	speed: 0.7338s/iter; left time: 13969.8477s
	iters: 200, epoch: 9 | loss: 3.0244949
	speed: 0.2855s/iter; left time: 5406.9209s
Epoch: 9 cost time: 60.88906931877136
Epoch: 9, Steps: 208 | Train Loss: 1.396 Vali Loss: 7.418 Vali Acc: 0.073 Test Loss: 7.418 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5184758
	speed: 0.7062s/iter; left time: 13297.6196s
	iters: 200, epoch: 10 | loss: 2.5701497
	speed: 0.2929s/iter; left time: 5485.5442s
Epoch: 10 cost time: 60.9426965713501
Epoch: 10, Steps: 208 | Train Loss: 1.172 Vali Loss: 7.892 Vali Acc: 0.080 Test Loss: 7.892 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5780013
	speed: 0.7148s/iter; left time: 13309.6189s
	iters: 200, epoch: 11 | loss: 0.8102559
	speed: 0.2810s/iter; left time: 5205.2557s
Epoch: 11 cost time: 60.301448822021484
Epoch: 11, Steps: 208 | Train Loss: 0.996 Vali Loss: 8.365 Vali Acc: 0.074 Test Loss: 8.365 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2957744
	speed: 0.7066s/iter; left time: 13010.7333s
	iters: 200, epoch: 12 | loss: 0.6921402
	speed: 0.2841s/iter; left time: 5201.9058s
Epoch: 12 cost time: 61.368765115737915
Epoch: 12, Steps: 208 | Train Loss: 0.872 Vali Loss: 8.693 Vali Acc: 0.081 Test Loss: 8.693 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0697262
	speed: 0.7286s/iter; left time: 13263.5546s
	iters: 200, epoch: 13 | loss: 0.2366627
	speed: 0.3029s/iter; left time: 5483.2618s
Epoch: 13 cost time: 64.31799340248108
Epoch: 13, Steps: 208 | Train Loss: 0.819 Vali Loss: 8.806 Vali Acc: 0.072 Test Loss: 8.806 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1146216
	speed: 0.7131s/iter; left time: 12833.0051s
	iters: 200, epoch: 14 | loss: 0.8218312
	speed: 0.2687s/iter; left time: 4809.7958s
Epoch: 14 cost time: 58.85565257072449
Epoch: 14, Steps: 208 | Train Loss: 0.718 Vali Loss: 9.336 Vali Acc: 0.081 Test Loss: 9.336 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4294837
	speed: 0.6994s/iter; left time: 12441.9333s
	iters: 200, epoch: 15 | loss: 0.5070677
	speed: 0.2917s/iter; left time: 5160.1096s
Epoch: 15 cost time: 61.6185302734375
Epoch: 15, Steps: 208 | Train Loss: 0.656 Vali Loss: 9.328 Vali Acc: 0.067 Test Loss: 9.328 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.5501763
	speed: 0.7231s/iter; left time: 12713.5378s
	iters: 200, epoch: 16 | loss: 0.7665951
	speed: 0.2904s/iter; left time: 5076.6436s
Epoch: 16 cost time: 61.535669565200806
Epoch: 16, Steps: 208 | Train Loss: 0.611 Vali Loss: 9.613 Vali Acc: 0.074 Test Loss: 9.613 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.3671108
	speed: 0.6969s/iter; left time: 12107.5666s
	iters: 200, epoch: 17 | loss: 0.9353541
	speed: 0.2767s/iter; left time: 4779.9172s
Epoch: 17 cost time: 58.60128998756409
Epoch: 17, Steps: 208 | Train Loss: 0.601 Vali Loss: 10.045 Vali Acc: 0.068 Test Loss: 10.045 Test Acc: 0.068
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.5124524
	speed: 0.6853s/iter; left time: 11762.3337s
	iters: 200, epoch: 18 | loss: 0.9347563
	speed: 0.2742s/iter; left time: 4679.3898s
Epoch: 18 cost time: 57.65813398361206
Epoch: 18, Steps: 208 | Train Loss: 0.593 Vali Loss: 10.547 Vali Acc: 0.074 Test Loss: 10.547 Test Acc: 0.074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08231434536236207
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1380816
	speed: 0.3055s/iter; left time: 6325.0237s
	iters: 200, epoch: 1 | loss: 5.1965384
	speed: 0.2774s/iter; left time: 5714.0379s
Epoch: 1 cost time: 60.846433877944946
Epoch: 1, Steps: 208 | Train Loss: 4.889 Vali Loss: 6.198 Vali Acc: 0.059 Test Loss: 6.198 Test Acc: 0.059
Validation loss decreased (inf --> -0.058990).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.8429384
	speed: 0.6673s/iter; left time: 13675.7838s
	iters: 200, epoch: 2 | loss: 4.4976249
	speed: 0.2781s/iter; left time: 5670.9149s
Epoch: 2 cost time: 58.174930810928345
Epoch: 2, Steps: 208 | Train Loss: 4.344 Vali Loss: 5.362 Vali Acc: 0.060 Test Loss: 5.362 Test Acc: 0.060
Validation loss decreased (-0.058990 --> -0.059893).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4338920
	speed: 0.6924s/iter; left time: 14045.2501s
	iters: 200, epoch: 3 | loss: 4.3726144
	speed: 0.2747s/iter; left time: 5544.3354s
Epoch: 3 cost time: 59.06123948097229
Epoch: 3, Steps: 208 | Train Loss: 3.500 Vali Loss: 5.526 Vali Acc: 0.079 Test Loss: 5.526 Test Acc: 0.079
Validation loss decreased (-0.059893 --> -0.079277).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2197878
	speed: 0.6958s/iter; left time: 13969.9067s
	iters: 200, epoch: 4 | loss: 4.6107121
	speed: 0.2799s/iter; left time: 5592.2538s
Epoch: 4 cost time: 58.97790336608887
Epoch: 4, Steps: 208 | Train Loss: 3.009 Vali Loss: 4.946 Vali Acc: 0.070 Test Loss: 4.946 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6348109
	speed: 0.6717s/iter; left time: 13346.2445s
	iters: 200, epoch: 5 | loss: 3.7653141
	speed: 0.2667s/iter; left time: 5272.1396s
Epoch: 5 cost time: 57.16098594665527
Epoch: 5, Steps: 208 | Train Loss: 2.577 Vali Loss: 5.452 Vali Acc: 0.075 Test Loss: 5.452 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2456355
	speed: 0.6774s/iter; left time: 13319.1223s
	iters: 200, epoch: 6 | loss: 3.9361458
	speed: 0.2787s/iter; left time: 5451.1457s
Epoch: 6 cost time: 58.73260140419006
Epoch: 6, Steps: 208 | Train Loss: 2.372 Vali Loss: 5.380 Vali Acc: 0.074 Test Loss: 5.380 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.9228189
	speed: 0.6970s/iter; left time: 13557.9767s
	iters: 200, epoch: 7 | loss: 2.5470290
	speed: 0.2765s/iter; left time: 5351.3889s
Epoch: 7 cost time: 59.648122787475586
Epoch: 7, Steps: 208 | Train Loss: 2.119 Vali Loss: 5.897 Vali Acc: 0.072 Test Loss: 5.897 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.4548979
	speed: 0.6795s/iter; left time: 13076.6527s
	iters: 200, epoch: 8 | loss: 2.5278430
	speed: 0.2605s/iter; left time: 4987.9777s
Epoch: 8 cost time: 56.924556732177734
Epoch: 8, Steps: 208 | Train Loss: 1.729 Vali Loss: 5.955 Vali Acc: 0.079 Test Loss: 5.955 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.7205031
	speed: 0.6716s/iter; left time: 12784.6876s
	iters: 200, epoch: 9 | loss: 2.0294888
	speed: 0.2780s/iter; left time: 5265.1857s
Epoch: 9 cost time: 58.88170647621155
Epoch: 9, Steps: 208 | Train Loss: 1.450 Vali Loss: 6.538 Vali Acc: 0.083 Test Loss: 6.538 Test Acc: 0.083
Validation loss decreased (-0.079277 --> -0.083144).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5655494
	speed: 0.6652s/iter; left time: 12525.9683s
	iters: 200, epoch: 10 | loss: 1.3522465
	speed: 0.2639s/iter; left time: 4942.9642s
Epoch: 10 cost time: 56.359633684158325
Epoch: 10, Steps: 208 | Train Loss: 1.288 Vali Loss: 6.856 Vali Acc: 0.077 Test Loss: 6.856 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2649595
	speed: 0.6708s/iter; left time: 12490.9439s
	iters: 200, epoch: 11 | loss: 0.5377139
	speed: 0.2747s/iter; left time: 5088.5794s
Epoch: 11 cost time: 59.00640654563904
Epoch: 11, Steps: 208 | Train Loss: 1.106 Vali Loss: 7.564 Vali Acc: 0.081 Test Loss: 7.564 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1805660
	speed: 0.7010s/iter; left time: 12907.9434s
	iters: 200, epoch: 12 | loss: 1.5683029
	speed: 0.2840s/iter; left time: 5201.1749s
Epoch: 12 cost time: 60.98037266731262
Epoch: 12, Steps: 208 | Train Loss: 0.963 Vali Loss: 7.812 Vali Acc: 0.084 Test Loss: 7.812 Test Acc: 0.084
Validation loss decreased (-0.083144 --> -0.084026).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4973692
	speed: 0.6956s/iter; left time: 12663.0536s
	iters: 200, epoch: 13 | loss: 1.2142845
	speed: 0.2819s/iter; left time: 5104.1198s
Epoch: 13 cost time: 60.011801958084106
Epoch: 13, Steps: 208 | Train Loss: 0.917 Vali Loss: 7.916 Vali Acc: 0.074 Test Loss: 7.916 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6593528
	speed: 0.7000s/iter; left time: 12597.5328s
	iters: 200, epoch: 14 | loss: 0.9247613
	speed: 0.2715s/iter; left time: 4859.1905s
Epoch: 14 cost time: 59.31355309486389
Epoch: 14, Steps: 208 | Train Loss: 0.780 Vali Loss: 8.024 Vali Acc: 0.071 Test Loss: 8.024 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5711790
	speed: 0.6834s/iter; left time: 12156.3306s
	iters: 200, epoch: 15 | loss: 0.4258985
	speed: 0.2792s/iter; left time: 4939.0458s
Epoch: 15 cost time: 59.87911868095398
Epoch: 15, Steps: 208 | Train Loss: 0.791 Vali Loss: 8.631 Vali Acc: 0.084 Test Loss: 8.631 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4253483
	speed: 0.6887s/iter; left time: 12108.2340s
	iters: 200, epoch: 16 | loss: 0.2002244
	speed: 0.2834s/iter; left time: 4954.7942s
Epoch: 16 cost time: 61.795955419540405
Epoch: 16, Steps: 208 | Train Loss: 0.732 Vali Loss: 8.490 Vali Acc: 0.068 Test Loss: 8.490 Test Acc: 0.068
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3276482
	speed: 0.7042s/iter; left time: 12234.7595s
	iters: 200, epoch: 17 | loss: 0.2704196
	speed: 0.2736s/iter; left time: 4726.0668s
Epoch: 17 cost time: 60.803499698638916
Epoch: 17, Steps: 208 | Train Loss: 0.631 Vali Loss: 8.893 Vali Acc: 0.089 Test Loss: 8.893 Test Acc: 0.089
Validation loss decreased (-0.084026 --> -0.089383).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4493413
	speed: 0.6969s/iter; left time: 11961.6987s
	iters: 200, epoch: 18 | loss: 0.7389264
	speed: 0.2659s/iter; left time: 4537.7619s
Epoch: 18 cost time: 58.15404725074768
Epoch: 18, Steps: 208 | Train Loss: 0.626 Vali Loss: 8.598 Vali Acc: 0.083 Test Loss: 8.598 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.7034371
	speed: 0.6849s/iter; left time: 11613.1783s
	iters: 200, epoch: 19 | loss: 1.0594466
	speed: 0.2853s/iter; left time: 4809.5841s
Epoch: 19 cost time: 60.85395956039429
Epoch: 19, Steps: 208 | Train Loss: 0.598 Vali Loss: 9.004 Vali Acc: 0.083 Test Loss: 9.004 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3035979
	speed: 0.7051s/iter; left time: 11809.7657s
	iters: 200, epoch: 20 | loss: 0.9455023
	speed: 0.2939s/iter; left time: 4893.8710s
Epoch: 20 cost time: 61.80823826789856
Epoch: 20, Steps: 208 | Train Loss: 0.546 Vali Loss: 9.073 Vali Acc: 0.085 Test Loss: 9.073 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2407146
	speed: 0.6840s/iter; left time: 11313.6578s
	iters: 200, epoch: 21 | loss: 0.4262221
	speed: 0.2821s/iter; left time: 4637.3680s
Epoch: 21 cost time: 59.34013843536377
Epoch: 21, Steps: 208 | Train Loss: 0.527 Vali Loss: 9.727 Vali Acc: 0.080 Test Loss: 9.727 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2924893
	speed: 0.6775s/iter; left time: 11065.5270s
	iters: 200, epoch: 22 | loss: 0.3525446
	speed: 0.2821s/iter; left time: 4579.8439s
Epoch: 22 cost time: 59.95045208930969
Epoch: 22, Steps: 208 | Train Loss: 0.512 Vali Loss: 10.039 Vali Acc: 0.078 Test Loss: 10.039 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1646905
	speed: 0.7224s/iter; left time: 11648.2946s
	iters: 200, epoch: 23 | loss: 0.5457582
	speed: 0.2915s/iter; left time: 4672.0342s
Epoch: 23 cost time: 62.07185411453247
Epoch: 23, Steps: 208 | Train Loss: 0.557 Vali Loss: 9.443 Vali Acc: 0.082 Test Loss: 9.443 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.8566261
	speed: 0.6787s/iter; left time: 10802.7882s
	iters: 200, epoch: 24 | loss: 0.1046513
	speed: 0.2682s/iter; left time: 4241.4361s
Epoch: 24 cost time: 57.597962379455566
Epoch: 24, Steps: 208 | Train Loss: 0.474 Vali Loss: 10.077 Vali Acc: 0.086 Test Loss: 10.077 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.7929236
	speed: 0.6589s/iter; left time: 10350.6061s
	iters: 200, epoch: 25 | loss: 0.2231388
	speed: 0.2610s/iter; left time: 4074.1969s
Epoch: 25 cost time: 56.65657615661621
Epoch: 25, Steps: 208 | Train Loss: 0.482 Vali Loss: 9.231 Vali Acc: 0.083 Test Loss: 9.231 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.8073968
	speed: 0.6538s/iter; left time: 10135.1809s
	iters: 200, epoch: 26 | loss: 0.3712632
	speed: 0.2865s/iter; left time: 4412.3112s
Epoch: 26 cost time: 60.61948585510254
Epoch: 26, Steps: 208 | Train Loss: 0.454 Vali Loss: 9.999 Vali Acc: 0.070 Test Loss: 9.999 Test Acc: 0.070
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1391384
	speed: 0.7025s/iter; left time: 10742.8744s
	iters: 200, epoch: 27 | loss: 0.0864610
	speed: 0.2618s/iter; left time: 3977.3749s
Epoch: 27 cost time: 58.30295276641846
Epoch: 27, Steps: 208 | Train Loss: 0.480 Vali Loss: 10.065 Vali Acc: 0.070 Test Loss: 10.065 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08947211452430659
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0535488
	speed: 0.2728s/iter; left time: 5646.9885s
	iters: 200, epoch: 1 | loss: 5.8219557
	speed: 0.2517s/iter; left time: 5184.6831s
Epoch: 1 cost time: 54.77548003196716
Epoch: 1, Steps: 208 | Train Loss: 4.718 Vali Loss: 6.811 Vali Acc: 0.064 Test Loss: 6.811 Test Acc: 0.064
Validation loss decreased (inf --> -0.064352).  Saving model ...
	iters: 100, epoch: 2 | loss: 7.0482273
	speed: 0.6630s/iter; left time: 13587.4527s
	iters: 200, epoch: 2 | loss: 4.2041802
	speed: 0.2681s/iter; left time: 5467.4949s
Epoch: 2 cost time: 57.40176224708557
Epoch: 2, Steps: 208 | Train Loss: 4.486 Vali Loss: 5.893 Vali Acc: 0.080 Test Loss: 5.893 Test Acc: 0.080
Validation loss decreased (-0.064352 --> -0.079571).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8007386
	speed: 0.6587s/iter; left time: 13362.3070s
	iters: 200, epoch: 3 | loss: 4.0759234
	speed: 0.2512s/iter; left time: 5070.4426s
Epoch: 3 cost time: 54.152344703674316
Epoch: 3, Steps: 208 | Train Loss: 3.720 Vali Loss: 5.130 Vali Acc: 0.066 Test Loss: 5.130 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.8682523
	speed: 0.6190s/iter; left time: 12427.2412s
	iters: 200, epoch: 4 | loss: 3.3156705
	speed: 0.2599s/iter; left time: 5192.8435s
Epoch: 4 cost time: 55.48423409461975
Epoch: 4, Steps: 208 | Train Loss: 3.302 Vali Loss: 4.951 Vali Acc: 0.069 Test Loss: 4.951 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4407692
	speed: 0.6679s/iter; left time: 13270.9158s
	iters: 200, epoch: 5 | loss: 4.5318007
	speed: 0.2861s/iter; left time: 5656.5859s
Epoch: 5 cost time: 60.3984649181366
Epoch: 5, Steps: 208 | Train Loss: 3.407 Vali Loss: 4.693 Vali Acc: 0.058 Test Loss: 4.693 Test Acc: 0.058
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.2744358
	speed: 0.6368s/iter; left time: 12520.5226s
	iters: 200, epoch: 6 | loss: 3.5344582
	speed: 0.2701s/iter; left time: 5283.9468s
Epoch: 6 cost time: 56.65128779411316
Epoch: 6, Steps: 208 | Train Loss: 3.427 Vali Loss: 4.293 Vali Acc: 0.048 Test Loss: 4.293 Test Acc: 0.048
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.3527203
	speed: 0.6246s/iter; left time: 12150.2882s
	iters: 200, epoch: 7 | loss: 3.9758968
	speed: 0.2874s/iter; left time: 5561.3986s
Epoch: 7 cost time: 58.203916788101196
Epoch: 7, Steps: 208 | Train Loss: 4.079 Vali Loss: 4.092 Vali Acc: 0.033 Test Loss: 4.092 Test Acc: 0.033
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.5587471
	speed: 0.6565s/iter; left time: 12634.3364s
	iters: 200, epoch: 8 | loss: 3.9343500
	speed: 0.2850s/iter; left time: 5456.6626s
Epoch: 8 cost time: 59.573065996170044
Epoch: 8, Steps: 208 | Train Loss: 3.947 Vali Loss: 3.890 Vali Acc: 0.034 Test Loss: 3.890 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.8531976
	speed: 0.6291s/iter; left time: 11975.3802s
	iters: 200, epoch: 9 | loss: 4.1713629
	speed: 0.2753s/iter; left time: 5212.4323s
Epoch: 9 cost time: 55.73848915100098
Epoch: 9, Steps: 208 | Train Loss: 3.837 Vali Loss: 3.794 Vali Acc: 0.031 Test Loss: 3.794 Test Acc: 0.031
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.7425418
	speed: 0.6488s/iter; left time: 12215.8685s
	iters: 200, epoch: 10 | loss: 3.7545540
	speed: 0.2779s/iter; left time: 5205.0830s
Epoch: 10 cost time: 57.45878624916077
Epoch: 10, Steps: 208 | Train Loss: 3.792 Vali Loss: 3.794 Vali Acc: 0.026 Test Loss: 3.794 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.7440586
	speed: 0.6565s/iter; left time: 12225.5149s
	iters: 200, epoch: 11 | loss: 3.8978212
	speed: 0.2738s/iter; left time: 5070.6449s
Epoch: 11 cost time: 57.044474840164185
Epoch: 11, Steps: 208 | Train Loss: 3.756 Vali Loss: 3.721 Vali Acc: 0.038 Test Loss: 3.721 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.7404945
	speed: 0.6660s/iter; left time: 12262.2167s
	iters: 200, epoch: 12 | loss: 3.7247396
	speed: 0.2735s/iter; left time: 5008.7763s
Epoch: 12 cost time: 56.73093295097351
Epoch: 12, Steps: 208 | Train Loss: 3.718 Vali Loss: 3.737 Vali Acc: 0.030 Test Loss: 3.737 Test Acc: 0.030
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07963018192663286
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1215830
	speed: 0.2817s/iter; left time: 5832.4452s
	iters: 200, epoch: 1 | loss: 6.0037780
	speed: 0.2986s/iter; left time: 6152.1543s
Epoch: 1 cost time: 60.63205528259277
Epoch: 1, Steps: 208 | Train Loss: 4.619 Vali Loss: 7.020 Vali Acc: 0.053 Test Loss: 7.020 Test Acc: 0.053
Validation loss decreased (inf --> -0.053017).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.1953979
	speed: 0.6739s/iter; left time: 13809.2501s
	iters: 200, epoch: 2 | loss: 4.5065637
	speed: 0.3015s/iter; left time: 6148.9711s
Epoch: 2 cost time: 61.241570472717285
Epoch: 2, Steps: 208 | Train Loss: 4.706 Vali Loss: 6.964 Vali Acc: 0.071 Test Loss: 6.964 Test Acc: 0.071
Validation loss decreased (-0.053017 --> -0.071210).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.0082574
	speed: 0.6748s/iter; left time: 13688.4671s
	iters: 200, epoch: 3 | loss: 4.9639969
	speed: 0.2687s/iter; left time: 5423.4509s
Epoch: 3 cost time: 56.944459438323975
Epoch: 3, Steps: 208 | Train Loss: 4.070 Vali Loss: 5.947 Vali Acc: 0.061 Test Loss: 5.947 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7535682
	speed: 0.6728s/iter; left time: 13507.4355s
	iters: 200, epoch: 4 | loss: 4.0213523
	speed: 0.2794s/iter; left time: 5580.7076s
Epoch: 4 cost time: 59.40286040306091
Epoch: 4, Steps: 208 | Train Loss: 3.485 Vali Loss: 5.142 Vali Acc: 0.058 Test Loss: 5.142 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3491995
	speed: 0.6930s/iter; left time: 13769.3758s
	iters: 200, epoch: 5 | loss: 3.6680474
	speed: 0.2795s/iter; left time: 5524.6189s
Epoch: 5 cost time: 58.84786009788513
Epoch: 5, Steps: 208 | Train Loss: 3.175 Vali Loss: 4.759 Vali Acc: 0.059 Test Loss: 4.759 Test Acc: 0.059
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.5038092
	speed: 0.6759s/iter; left time: 13288.6579s
	iters: 200, epoch: 6 | loss: 3.6930809
	speed: 0.2596s/iter; left time: 5078.8121s
Epoch: 6 cost time: 55.71232581138611
Epoch: 6, Steps: 208 | Train Loss: 3.101 Vali Loss: 4.509 Vali Acc: 0.059 Test Loss: 4.509 Test Acc: 0.059
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.1049151
	speed: 0.6761s/iter; left time: 13153.0149s
	iters: 200, epoch: 7 | loss: 3.2467740
	speed: 0.2716s/iter; left time: 5256.3809s
Epoch: 7 cost time: 57.682385206222534
Epoch: 7, Steps: 208 | Train Loss: 3.062 Vali Loss: 4.273 Vali Acc: 0.066 Test Loss: 4.273 Test Acc: 0.066
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.5203516
	speed: 0.7115s/iter; left time: 13693.2544s
	iters: 200, epoch: 8 | loss: 4.0149746
	speed: 0.2718s/iter; left time: 5203.0893s
Epoch: 8 cost time: 58.59130382537842
Epoch: 8, Steps: 208 | Train Loss: 3.119 Vali Loss: 4.388 Vali Acc: 0.056 Test Loss: 4.388 Test Acc: 0.056
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.9836392
	speed: 0.6642s/iter; left time: 12644.1178s
	iters: 200, epoch: 9 | loss: 2.9742608
	speed: 0.2680s/iter; left time: 5075.4668s
Epoch: 9 cost time: 57.109285831451416
Epoch: 9, Steps: 208 | Train Loss: 2.987 Vali Loss: 4.247 Vali Acc: 0.060 Test Loss: 4.247 Test Acc: 0.060
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 4.4227705
	speed: 0.6749s/iter; left time: 12707.0609s
	iters: 200, epoch: 10 | loss: 2.1751437
	speed: 0.2886s/iter; left time: 5404.9329s
Epoch: 10 cost time: 60.07552361488342
Epoch: 10, Steps: 208 | Train Loss: 2.690 Vali Loss: 4.555 Vali Acc: 0.061 Test Loss: 4.555 Test Acc: 0.061
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.8940248
	speed: 0.6894s/iter; left time: 12837.5722s
	iters: 200, epoch: 11 | loss: 2.4209168
	speed: 0.2670s/iter; left time: 4944.5472s
Epoch: 11 cost time: 57.50458550453186
Epoch: 11, Steps: 208 | Train Loss: 2.540 Vali Loss: 4.574 Vali Acc: 0.069 Test Loss: 4.574 Test Acc: 0.069
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3707304
	speed: 0.6672s/iter; left time: 12284.2491s
	iters: 200, epoch: 12 | loss: 2.4065173
	speed: 0.2740s/iter; left time: 5016.9697s
Epoch: 12 cost time: 57.692824363708496
Epoch: 12, Steps: 208 | Train Loss: 2.204 Vali Loss: 4.514 Vali Acc: 0.068 Test Loss: 4.514 Test Acc: 0.068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07127945123769758
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0700321
	speed: 0.2918s/iter; left time: 6041.1507s
	iters: 200, epoch: 1 | loss: 5.7745023
	speed: 0.2887s/iter; left time: 5947.9333s
Epoch: 1 cost time: 60.5026741027832
Epoch: 1, Steps: 208 | Train Loss: 4.533 Vali Loss: 6.969 Vali Acc: 0.036 Test Loss: 6.969 Test Acc: 0.036
Validation loss decreased (inf --> -0.036316).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.3696814
	speed: 0.6535s/iter; left time: 13391.5280s
	iters: 200, epoch: 2 | loss: 5.1482248
	speed: 0.2863s/iter; left time: 5837.5116s
Epoch: 2 cost time: 57.99909281730652
Epoch: 2, Steps: 208 | Train Loss: 4.810 Vali Loss: 7.122 Vali Acc: 0.057 Test Loss: 7.122 Test Acc: 0.057
Validation loss decreased (-0.036316 --> -0.056594).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2104850
	speed: 0.7132s/iter; left time: 14467.8058s
	iters: 200, epoch: 3 | loss: 4.4007301
	speed: 0.3043s/iter; left time: 6141.5394s
Epoch: 3 cost time: 62.60138440132141
Epoch: 3, Steps: 208 | Train Loss: 4.619 Vali Loss: 6.339 Vali Acc: 0.051 Test Loss: 6.339 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.2753534
	speed: 0.6897s/iter; left time: 13847.6804s
	iters: 200, epoch: 4 | loss: 4.1948500
	speed: 0.3014s/iter; left time: 6020.9210s
Epoch: 4 cost time: 61.89820861816406
Epoch: 4, Steps: 208 | Train Loss: 4.103 Vali Loss: 4.879 Vali Acc: 0.047 Test Loss: 4.879 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.2958252
	speed: 0.6783s/iter; left time: 13478.0634s
	iters: 200, epoch: 5 | loss: 4.5872283
	speed: 0.2967s/iter; left time: 5866.2985s
Epoch: 5 cost time: 60.94130325317383
Epoch: 5, Steps: 208 | Train Loss: 3.926 Vali Loss: 4.462 Vali Acc: 0.047 Test Loss: 4.462 Test Acc: 0.047
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.8706777
	speed: 0.6543s/iter; left time: 12864.8932s
	iters: 200, epoch: 6 | loss: 4.2533121
	speed: 0.2988s/iter; left time: 5845.6086s
Epoch: 6 cost time: 60.23797059059143
Epoch: 6, Steps: 208 | Train Loss: 4.052 Vali Loss: 4.141 Vali Acc: 0.040 Test Loss: 4.141 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.9234290
	speed: 0.6772s/iter; left time: 13174.4231s
	iters: 200, epoch: 7 | loss: 3.9839497
	speed: 0.2934s/iter; left time: 5677.7637s
Epoch: 7 cost time: 60.704142332077026
Epoch: 7, Steps: 208 | Train Loss: 4.097 Vali Loss: 3.977 Vali Acc: 0.034 Test Loss: 3.977 Test Acc: 0.034
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.9124830
	speed: 0.6648s/iter; left time: 12793.4776s
	iters: 200, epoch: 8 | loss: 4.1142540
	speed: 0.2850s/iter; left time: 5457.2455s
Epoch: 8 cost time: 58.22519874572754
Epoch: 8, Steps: 208 | Train Loss: 3.997 Vali Loss: 4.061 Vali Acc: 0.037 Test Loss: 4.061 Test Acc: 0.037
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.8810811
	speed: 0.6587s/iter; left time: 12540.4811s
	iters: 200, epoch: 9 | loss: 4.1527877
	speed: 0.2984s/iter; left time: 5651.0781s
Epoch: 9 cost time: 60.76434135437012
Epoch: 9, Steps: 208 | Train Loss: 3.912 Vali Loss: 3.939 Vali Acc: 0.038 Test Loss: 3.939 Test Acc: 0.038
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.6490974
	speed: 0.6848s/iter; left time: 12894.3238s
	iters: 200, epoch: 10 | loss: 3.9504206
	speed: 0.2814s/iter; left time: 5271.1629s
Epoch: 10 cost time: 59.114291191101074
Epoch: 10, Steps: 208 | Train Loss: 3.826 Vali Loss: 3.766 Vali Acc: 0.031 Test Loss: 3.766 Test Acc: 0.031
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.6232219
	speed: 0.6333s/iter; left time: 11793.1600s
	iters: 200, epoch: 11 | loss: 3.7238781
	speed: 0.2866s/iter; left time: 5308.5819s
Epoch: 11 cost time: 58.50624179840088
Epoch: 11, Steps: 208 | Train Loss: 3.731 Vali Loss: 3.715 Vali Acc: 0.035 Test Loss: 3.715 Test Acc: 0.035
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.7035232
	speed: 0.6781s/iter; left time: 12485.8318s
	iters: 200, epoch: 12 | loss: 3.5495944
	speed: 0.2920s/iter; left time: 5348.1951s
Epoch: 12 cost time: 61.00417947769165
Epoch: 12, Steps: 208 | Train Loss: 3.654 Vali Loss: 3.667 Vali Acc: 0.040 Test Loss: 3.667 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05666567253206084
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5416765
	speed: 0.2897s/iter; left time: 5996.1741s
	iters: 200, epoch: 1 | loss: 5.8119893
	speed: 0.2504s/iter; left time: 5158.9574s
Epoch: 1 cost time: 56.14396929740906
Epoch: 1, Steps: 208 | Train Loss: 4.404 Vali Loss: 8.622 Vali Acc: 0.031 Test Loss: 8.622 Test Acc: 0.031
Validation loss decreased (inf --> -0.031229).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.2315760
	speed: 0.6469s/iter; left time: 13257.6944s
	iters: 200, epoch: 2 | loss: 5.8304296
	speed: 0.2742s/iter; left time: 5590.7738s
Epoch: 2 cost time: 59.14389419555664
Epoch: 2, Steps: 208 | Train Loss: 5.111 Vali Loss: 8.013 Vali Acc: 0.052 Test Loss: 8.013 Test Acc: 0.052
Validation loss decreased (-0.031229 --> -0.051814).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.1714039
	speed: 0.6484s/iter; left time: 13153.6636s
	iters: 200, epoch: 3 | loss: 6.1963863
	speed: 0.2781s/iter; left time: 5613.8737s
Epoch: 3 cost time: 59.26002264022827
Epoch: 3, Steps: 208 | Train Loss: 5.249 Vali Loss: 5.612 Vali Acc: 0.048 Test Loss: 5.612 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.0564523
	speed: 0.6142s/iter; left time: 12331.4591s
	iters: 200, epoch: 4 | loss: 4.9999886
	speed: 0.2854s/iter; left time: 5701.0272s
Epoch: 4 cost time: 58.25000858306885
Epoch: 4, Steps: 208 | Train Loss: 4.719 Vali Loss: 4.728 Vali Acc: 0.049 Test Loss: 4.728 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.8333368
	speed: 0.5963s/iter; left time: 11847.8634s
	iters: 200, epoch: 5 | loss: 4.8367949
	speed: 0.2694s/iter; left time: 5325.9228s
Epoch: 5 cost time: 55.11908197402954
Epoch: 5, Steps: 208 | Train Loss: 4.491 Vali Loss: 4.531 Vali Acc: 0.029 Test Loss: 4.531 Test Acc: 0.029
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.4570041
	speed: 0.6384s/iter; left time: 12551.2356s
	iters: 200, epoch: 6 | loss: 4.5579281
	speed: 0.2887s/iter; left time: 5646.9419s
Epoch: 6 cost time: 59.705543756484985
Epoch: 6, Steps: 208 | Train Loss: 4.334 Vali Loss: 4.336 Vali Acc: 0.037 Test Loss: 4.336 Test Acc: 0.037
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.8460369
	speed: 0.6101s/iter; left time: 11869.0764s
	iters: 200, epoch: 7 | loss: 3.5539749
	speed: 0.2761s/iter; left time: 5342.5591s
Epoch: 7 cost time: 54.90978670120239
Epoch: 7, Steps: 208 | Train Loss: 4.177 Vali Loss: 3.983 Vali Acc: 0.036 Test Loss: 3.983 Test Acc: 0.036
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.8751900
	speed: 0.5922s/iter; left time: 11396.8010s
	iters: 200, epoch: 8 | loss: 3.8225698
	speed: 0.2666s/iter; left time: 5103.5842s
Epoch: 8 cost time: 54.19664692878723
Epoch: 8, Steps: 208 | Train Loss: 3.955 Vali Loss: 3.789 Vali Acc: 0.040 Test Loss: 3.789 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.6077349
	speed: 0.6605s/iter; left time: 12574.1657s
	iters: 200, epoch: 9 | loss: 3.9706821
	speed: 0.2614s/iter; left time: 4950.7335s
Epoch: 9 cost time: 55.829041481018066
Epoch: 9, Steps: 208 | Train Loss: 3.806 Vali Loss: 3.767 Vali Acc: 0.035 Test Loss: 3.767 Test Acc: 0.035
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.9269466
	speed: 0.6083s/iter; left time: 11454.3837s
	iters: 200, epoch: 10 | loss: 3.6483598
	speed: 0.2539s/iter; left time: 4755.9163s
Epoch: 10 cost time: 53.263174057006836
Epoch: 10, Steps: 208 | Train Loss: 3.762 Vali Loss: 3.773 Vali Acc: 0.027 Test Loss: 3.773 Test Acc: 0.027
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.8169012
	speed: 0.6535s/iter; left time: 12168.9585s
	iters: 200, epoch: 11 | loss: 3.6332686
	speed: 0.2498s/iter; left time: 4625.6960s
Epoch: 11 cost time: 53.77103638648987
Epoch: 11, Steps: 208 | Train Loss: 3.724 Vali Loss: 3.719 Vali Acc: 0.030 Test Loss: 3.719 Test Acc: 0.030
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6973007
	speed: 0.6402s/iter; left time: 11788.7054s
	iters: 200, epoch: 12 | loss: 3.6571167
	speed: 0.2587s/iter; left time: 4738.2355s
Epoch: 12 cost time: 55.10214447975159
Epoch: 12, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.663 Vali Acc: 0.038 Test Loss: 3.663 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05189382642409782
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3990498
	speed: 0.2802s/iter; left time: 5800.5197s
	iters: 200, epoch: 1 | loss: 5.6102824
	speed: 0.2475s/iter; left time: 5098.5316s
Epoch: 1 cost time: 55.203078746795654
Epoch: 1, Steps: 208 | Train Loss: 4.352 Vali Loss: 7.949 Vali Acc: 0.037 Test Loss: 7.949 Test Acc: 0.037
Validation loss decreased (inf --> -0.037201).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.3365870
	speed: 0.6223s/iter; left time: 12753.2526s
	iters: 200, epoch: 2 | loss: 5.4598794
	speed: 0.2540s/iter; left time: 5178.8319s
Epoch: 2 cost time: 53.585744857788086
Epoch: 2, Steps: 208 | Train Loss: 4.752 Vali Loss: 8.292 Vali Acc: 0.053 Test Loss: 8.292 Test Acc: 0.053
Validation loss decreased (-0.037201 --> -0.053004).  Saving model ...
	iters: 100, epoch: 3 | loss: 6.2061396
	speed: 0.6712s/iter; left time: 13615.9392s
	iters: 200, epoch: 3 | loss: 5.9172301
	speed: 0.2659s/iter; left time: 5366.8895s
Epoch: 3 cost time: 57.34745669364929
Epoch: 3, Steps: 208 | Train Loss: 4.825 Vali Loss: 6.973 Vali Acc: 0.046 Test Loss: 6.973 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.5136786
	speed: 0.6351s/iter; left time: 12750.2355s
	iters: 200, epoch: 4 | loss: 5.0347300
	speed: 0.2712s/iter; left time: 5418.5093s
Epoch: 4 cost time: 56.94668245315552
Epoch: 4, Steps: 208 | Train Loss: 4.412 Vali Loss: 5.194 Vali Acc: 0.043 Test Loss: 5.194 Test Acc: 0.043
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 5.0823016
	speed: 0.6767s/iter; left time: 13444.6171s
	iters: 200, epoch: 5 | loss: 4.3283377
	speed: 0.2907s/iter; left time: 5746.1864s
Epoch: 5 cost time: 62.16141200065613
Epoch: 5, Steps: 208 | Train Loss: 4.351 Vali Loss: 4.652 Vali Acc: 0.048 Test Loss: 4.652 Test Acc: 0.048
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.6900682
	speed: 0.6718s/iter; left time: 13208.7514s
	iters: 200, epoch: 6 | loss: 4.8871908
	speed: 0.2597s/iter; left time: 5080.7555s
Epoch: 6 cost time: 58.22642993927002
Epoch: 6, Steps: 208 | Train Loss: 4.501 Vali Loss: 4.107 Vali Acc: 0.036 Test Loss: 4.107 Test Acc: 0.036
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.0436187
	speed: 0.6510s/iter; left time: 12664.0601s
	iters: 200, epoch: 7 | loss: 4.2795391
	speed: 0.2879s/iter; left time: 5572.2802s
Epoch: 7 cost time: 61.194212675094604
Epoch: 7, Steps: 208 | Train Loss: 4.301 Vali Loss: 4.009 Vali Acc: 0.039 Test Loss: 4.009 Test Acc: 0.039
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.8113441
	speed: 0.6486s/iter; left time: 12482.3420s
	iters: 200, epoch: 8 | loss: 3.6394436
	speed: 0.2848s/iter; left time: 5451.7907s
Epoch: 8 cost time: 61.01367139816284
Epoch: 8, Steps: 208 | Train Loss: 4.062 Vali Loss: 3.800 Vali Acc: 0.041 Test Loss: 3.800 Test Acc: 0.041
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.9723201
	speed: 0.6690s/iter; left time: 12736.4440s
	iters: 200, epoch: 9 | loss: 3.9671929
	speed: 0.2987s/iter; left time: 5655.8748s
Epoch: 9 cost time: 63.3240966796875
Epoch: 9, Steps: 208 | Train Loss: 3.862 Vali Loss: 3.823 Vali Acc: 0.034 Test Loss: 3.823 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 4.0461135
	speed: 0.6367s/iter; left time: 11988.5725s
	iters: 200, epoch: 10 | loss: 3.8925915
	speed: 0.2694s/iter; left time: 5044.7579s
Epoch: 10 cost time: 56.80354189872742
Epoch: 10, Steps: 208 | Train Loss: 3.778 Vali Loss: 3.787 Vali Acc: 0.035 Test Loss: 3.787 Test Acc: 0.035
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.7980978
	speed: 0.6766s/iter; left time: 12598.2630s
	iters: 200, epoch: 11 | loss: 3.8668158
	speed: 0.3054s/iter; left time: 5655.5192s
Epoch: 11 cost time: 65.25524878501892
Epoch: 11, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.718 Vali Acc: 0.035 Test Loss: 3.718 Test Acc: 0.035
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6516557
	speed: 0.6421s/iter; left time: 11823.6012s
	iters: 200, epoch: 12 | loss: 3.7374160
	speed: 0.2988s/iter; left time: 5471.2419s
Epoch: 12 cost time: 59.645888328552246
Epoch: 12, Steps: 208 | Train Loss: 3.746 Vali Loss: 3.711 Vali Acc: 0.039 Test Loss: 3.711 Test Acc: 0.039
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05308678795108858
model parameter : 16433703
model size : 82.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8617105
	speed: 0.3293s/iter; left time: 6816.0256s
	iters: 200, epoch: 1 | loss: 5.7056184
	speed: 0.2910s/iter; left time: 5994.3271s
Epoch: 1 cost time: 64.41673493385315
Epoch: 1, Steps: 208 | Train Loss: 5.329 Vali Loss: 5.710 Vali Acc: 0.064 Test Loss: 5.710 Test Acc: 0.064
Validation loss decreased (inf --> -0.064363).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.1244488
	speed: 0.6927s/iter; left time: 14196.0454s
	iters: 200, epoch: 2 | loss: 5.2622099
	speed: 0.2959s/iter; left time: 6034.1767s
Epoch: 2 cost time: 62.70490336418152
Epoch: 2, Steps: 208 | Train Loss: 4.483 Vali Loss: 5.415 Vali Acc: 0.064 Test Loss: 5.415 Test Acc: 0.064
Validation loss decreased (-0.064363 --> -0.064366).  Saving model ...
	iters: 100, epoch: 3 | loss: 6.5533290
	speed: 0.7225s/iter; left time: 14655.7821s
	iters: 200, epoch: 3 | loss: 4.6294065
	speed: 0.2904s/iter; left time: 5861.2246s
Epoch: 3 cost time: 63.17436218261719
Epoch: 3, Steps: 208 | Train Loss: 3.646 Vali Loss: 5.568 Vali Acc: 0.069 Test Loss: 5.568 Test Acc: 0.069
Validation loss decreased (-0.064366 --> -0.069434).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4524536
	speed: 0.6986s/iter; left time: 14025.5949s
	iters: 200, epoch: 4 | loss: 3.0870585
	speed: 0.2835s/iter; left time: 5663.0703s
Epoch: 4 cost time: 61.211100816726685
Epoch: 4, Steps: 208 | Train Loss: 2.821 Vali Loss: 6.516 Vali Acc: 0.064 Test Loss: 6.516 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4755015
	speed: 0.7163s/iter; left time: 14231.3862s
	iters: 200, epoch: 5 | loss: 3.9026561
	speed: 0.3161s/iter; left time: 6249.2701s
Epoch: 5 cost time: 65.75021123886108
Epoch: 5, Steps: 208 | Train Loss: 2.396 Vali Loss: 6.541 Vali Acc: 0.073 Test Loss: 6.541 Test Acc: 0.073
Validation loss decreased (-0.069434 --> -0.072705).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7654911
	speed: 0.7097s/iter; left time: 13953.7624s
	iters: 200, epoch: 6 | loss: 1.5844736
	speed: 0.3026s/iter; left time: 5919.0913s
Epoch: 6 cost time: 62.18159079551697
Epoch: 6, Steps: 208 | Train Loss: 2.014 Vali Loss: 6.214 Vali Acc: 0.073 Test Loss: 6.214 Test Acc: 0.073
Validation loss decreased (-0.072705 --> -0.073305).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8763769
	speed: 0.7320s/iter; left time: 14239.7762s
	iters: 200, epoch: 7 | loss: 3.4188671
	speed: 0.3081s/iter; left time: 5961.8964s
Epoch: 7 cost time: 66.13600325584412
Epoch: 7, Steps: 208 | Train Loss: 1.664 Vali Loss: 7.016 Vali Acc: 0.075 Test Loss: 7.016 Test Acc: 0.075
Validation loss decreased (-0.073305 --> -0.075385).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9664230
	speed: 0.7270s/iter; left time: 13991.2912s
	iters: 200, epoch: 8 | loss: 1.4401869
	speed: 0.3156s/iter; left time: 6041.9358s
Epoch: 8 cost time: 65.39961290359497
Epoch: 8, Steps: 208 | Train Loss: 1.428 Vali Loss: 7.297 Vali Acc: 0.075 Test Loss: 7.297 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6250073
	speed: 0.7204s/iter; left time: 13713.3207s
	iters: 200, epoch: 9 | loss: 2.0171046
	speed: 0.3054s/iter; left time: 5783.4516s
Epoch: 9 cost time: 62.38560748100281
Epoch: 9, Steps: 208 | Train Loss: 1.180 Vali Loss: 7.589 Vali Acc: 0.079 Test Loss: 7.589 Test Acc: 0.079
Validation loss decreased (-0.075385 --> -0.079256).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1214043
	speed: 0.7496s/iter; left time: 14114.8669s
	iters: 200, epoch: 10 | loss: 0.9096063
	speed: 0.3256s/iter; left time: 6097.3061s
Epoch: 10 cost time: 67.24414420127869
Epoch: 10, Steps: 208 | Train Loss: 1.033 Vali Loss: 8.152 Vali Acc: 0.066 Test Loss: 8.152 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0033636
	speed: 0.7253s/iter; left time: 13505.2924s
	iters: 200, epoch: 11 | loss: 0.7079610
	speed: 0.3035s/iter; left time: 5621.3560s
Epoch: 11 cost time: 64.26731610298157
Epoch: 11, Steps: 208 | Train Loss: 0.895 Vali Loss: 8.461 Vali Acc: 0.060 Test Loss: 8.461 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5822774
	speed: 0.7236s/iter; left time: 13323.5247s
	iters: 200, epoch: 12 | loss: 0.7805135
	speed: 0.3128s/iter; left time: 5727.5714s
Epoch: 12 cost time: 63.422826528549194
Epoch: 12, Steps: 208 | Train Loss: 0.765 Vali Loss: 9.730 Vali Acc: 0.075 Test Loss: 9.730 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4173293
	speed: 0.7391s/iter; left time: 13455.4818s
	iters: 200, epoch: 13 | loss: 1.0485532
	speed: 0.3163s/iter; left time: 5726.1745s
Epoch: 13 cost time: 65.47694253921509
Epoch: 13, Steps: 208 | Train Loss: 0.686 Vali Loss: 9.695 Vali Acc: 0.072 Test Loss: 9.695 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3266401
	speed: 0.7597s/iter; left time: 13673.1576s
	iters: 200, epoch: 14 | loss: 1.1289897
	speed: 0.2950s/iter; left time: 5279.1680s
Epoch: 14 cost time: 64.60574436187744
Epoch: 14, Steps: 208 | Train Loss: 0.610 Vali Loss: 9.552 Vali Acc: 0.077 Test Loss: 9.552 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2459495
	speed: 0.7071s/iter; left time: 12578.3169s
	iters: 200, epoch: 15 | loss: 1.5990233
	speed: 0.3138s/iter; left time: 5550.3875s
Epoch: 15 cost time: 63.41707944869995
Epoch: 15, Steps: 208 | Train Loss: 0.645 Vali Loss: 9.753 Vali Acc: 0.077 Test Loss: 9.753 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.0854033
	speed: 0.7208s/iter; left time: 12672.5907s
	iters: 200, epoch: 16 | loss: 0.3679458
	speed: 0.3087s/iter; left time: 5396.6252s
Epoch: 16 cost time: 64.54899954795837
Epoch: 16, Steps: 208 | Train Loss: 0.573 Vali Loss: 10.053 Vali Acc: 0.077 Test Loss: 10.053 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2402260
	speed: 0.7105s/iter; left time: 12343.7880s
	iters: 200, epoch: 17 | loss: 0.4151955
	speed: 0.2785s/iter; left time: 4810.2447s
Epoch: 17 cost time: 60.78708243370056
Epoch: 17, Steps: 208 | Train Loss: 0.564 Vali Loss: 9.597 Vali Acc: 0.080 Test Loss: 9.597 Test Acc: 0.080
Validation loss decreased (-0.079256 --> -0.079534).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1996075
	speed: 0.6981s/iter; left time: 11982.8323s
	iters: 200, epoch: 18 | loss: 0.4044126
	speed: 0.2973s/iter; left time: 5073.5035s
Epoch: 18 cost time: 62.13367033004761
Epoch: 18, Steps: 208 | Train Loss: 0.540 Vali Loss: 10.560 Vali Acc: 0.073 Test Loss: 10.560 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4202975
	speed: 0.7056s/iter; left time: 11965.2271s
	iters: 200, epoch: 19 | loss: 0.9594435
	speed: 0.2957s/iter; left time: 4985.0721s
Epoch: 19 cost time: 62.39483857154846
Epoch: 19, Steps: 208 | Train Loss: 0.497 Vali Loss: 10.436 Vali Acc: 0.070 Test Loss: 10.436 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.8285962
	speed: 0.6862s/iter; left time: 11493.0897s
	iters: 200, epoch: 20 | loss: 0.1703536
	speed: 0.2818s/iter; left time: 4691.8730s
Epoch: 20 cost time: 59.21129608154297
Epoch: 20, Steps: 208 | Train Loss: 0.516 Vali Loss: 10.296 Vali Acc: 0.083 Test Loss: 10.296 Test Acc: 0.083
Validation loss decreased (-0.079534 --> -0.082510).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3818628
	speed: 0.7246s/iter; left time: 11985.3333s
	iters: 200, epoch: 21 | loss: 0.4382427
	speed: 0.2855s/iter; left time: 4693.6631s
Epoch: 21 cost time: 62.36380362510681
Epoch: 21, Steps: 208 | Train Loss: 0.447 Vali Loss: 10.482 Vali Acc: 0.079 Test Loss: 10.482 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0672157
	speed: 0.7275s/iter; left time: 11881.9434s
	iters: 200, epoch: 22 | loss: 0.8611257
	speed: 0.2995s/iter; left time: 4861.0945s
Epoch: 22 cost time: 63.40971660614014
Epoch: 22, Steps: 208 | Train Loss: 0.437 Vali Loss: 11.128 Vali Acc: 0.081 Test Loss: 11.128 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.6134033
	speed: 0.6757s/iter; left time: 10895.9402s
	iters: 200, epoch: 23 | loss: 1.3273920
	speed: 0.3142s/iter; left time: 5034.4417s
Epoch: 23 cost time: 62.632747411727905
Epoch: 23, Steps: 208 | Train Loss: 0.492 Vali Loss: 9.969 Vali Acc: 0.078 Test Loss: 9.969 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0149578
	speed: 0.6904s/iter; left time: 10989.5577s
	iters: 200, epoch: 24 | loss: 0.0435345
	speed: 0.3109s/iter; left time: 4917.7849s
Epoch: 24 cost time: 63.17591452598572
Epoch: 24, Steps: 208 | Train Loss: 0.402 Vali Loss: 10.956 Vali Acc: 0.080 Test Loss: 10.956 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2706275
	speed: 0.7162s/iter; left time: 11250.1542s
	iters: 200, epoch: 25 | loss: 0.8229095
	speed: 0.2913s/iter; left time: 4547.4853s
Epoch: 25 cost time: 61.05203986167908
Epoch: 25, Steps: 208 | Train Loss: 0.392 Vali Loss: 11.215 Vali Acc: 0.085 Test Loss: 11.215 Test Acc: 0.085
Validation loss decreased (-0.082510 --> -0.085185).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.6008376
	speed: 0.7056s/iter; left time: 10937.1918s
	iters: 200, epoch: 26 | loss: 0.3402892
	speed: 0.2940s/iter; left time: 4528.5663s
Epoch: 26 cost time: 63.11015057563782
Epoch: 26, Steps: 208 | Train Loss: 0.352 Vali Loss: 10.649 Vali Acc: 0.083 Test Loss: 10.649 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.7330124
	speed: 0.6984s/iter; left time: 10680.0279s
	iters: 200, epoch: 27 | loss: 0.1279444
	speed: 0.3060s/iter; left time: 4649.7443s
Epoch: 27 cost time: 62.286892890930176
Epoch: 27, Steps: 208 | Train Loss: 0.362 Vali Loss: 11.365 Vali Acc: 0.081 Test Loss: 11.365 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.8875011
	speed: 0.7160s/iter; left time: 10801.5911s
	iters: 200, epoch: 28 | loss: 0.4978725
	speed: 0.2880s/iter; left time: 4314.9445s
Epoch: 28 cost time: 61.861685276031494
Epoch: 28, Steps: 208 | Train Loss: 0.395 Vali Loss: 11.244 Vali Acc: 0.084 Test Loss: 11.244 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0727468
	speed: 0.7221s/iter; left time: 10743.2707s
	iters: 200, epoch: 29 | loss: 0.4141688
	speed: 0.2741s/iter; left time: 4049.8543s
Epoch: 29 cost time: 60.42211437225342
Epoch: 29, Steps: 208 | Train Loss: 0.345 Vali Loss: 11.132 Vali Acc: 0.077 Test Loss: 11.132 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1875109
	speed: 0.7185s/iter; left time: 10540.3588s
	iters: 200, epoch: 30 | loss: 0.9175286
	speed: 0.3097s/iter; left time: 4512.7350s
Epoch: 30 cost time: 65.04027581214905
Epoch: 30, Steps: 208 | Train Loss: 0.303 Vali Loss: 11.626 Vali Acc: 0.080 Test Loss: 11.626 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.1374665
	speed: 0.7052s/iter; left time: 10198.4887s
	iters: 200, epoch: 31 | loss: 0.8770261
	speed: 0.2994s/iter; left time: 4299.7655s
Epoch: 31 cost time: 63.45168709754944
Epoch: 31, Steps: 208 | Train Loss: 0.326 Vali Loss: 11.339 Vali Acc: 0.089 Test Loss: 11.339 Test Acc: 0.089
Validation loss decreased (-0.085185 --> -0.088762).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0660756
	speed: 0.6969s/iter; left time: 9933.3639s
	iters: 200, epoch: 32 | loss: 0.4005977
	speed: 0.3086s/iter; left time: 4367.4164s
Epoch: 32 cost time: 62.25896406173706
Epoch: 32, Steps: 208 | Train Loss: 0.314 Vali Loss: 11.645 Vali Acc: 0.080 Test Loss: 11.645 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.1298847
	speed: 0.6943s/iter; left time: 9751.2673s
	iters: 200, epoch: 33 | loss: 1.0631227
	speed: 0.2877s/iter; left time: 4012.6412s
Epoch: 33 cost time: 62.089197874069214
Epoch: 33, Steps: 208 | Train Loss: 0.343 Vali Loss: 11.449 Vali Acc: 0.089 Test Loss: 11.449 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.2114484
	speed: 0.7284s/iter; left time: 10078.3431s
	iters: 200, epoch: 34 | loss: 1.1091926
	speed: 0.2909s/iter; left time: 3996.7620s
Epoch: 34 cost time: 61.680487632751465
Epoch: 34, Steps: 208 | Train Loss: 0.339 Vali Loss: 11.507 Vali Acc: 0.080 Test Loss: 11.507 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0336629
	speed: 0.6973s/iter; left time: 9503.9389s
	iters: 200, epoch: 35 | loss: 0.0306160
	speed: 0.2896s/iter; left time: 3918.2261s
Epoch: 35 cost time: 62.01331400871277
Epoch: 35, Steps: 208 | Train Loss: 0.286 Vali Loss: 11.775 Vali Acc: 0.079 Test Loss: 11.775 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0872453
	speed: 0.7071s/iter; left time: 9490.3936s
	iters: 200, epoch: 36 | loss: 0.3621069
	speed: 0.3076s/iter; left time: 4097.2473s
Epoch: 36 cost time: 65.04048418998718
Epoch: 36, Steps: 208 | Train Loss: 0.298 Vali Loss: 11.294 Vali Acc: 0.080 Test Loss: 11.294 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0820563
	speed: 0.6870s/iter; left time: 9077.8896s
	iters: 200, epoch: 37 | loss: 1.1284503
	speed: 0.3218s/iter; left time: 4219.3649s
Epoch: 37 cost time: 62.917858839035034
Epoch: 37, Steps: 208 | Train Loss: 0.316 Vali Loss: 11.990 Vali Acc: 0.083 Test Loss: 11.990 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.1954042
	speed: 0.6912s/iter; left time: 8989.3390s
	iters: 200, epoch: 38 | loss: 0.1698727
	speed: 0.2839s/iter; left time: 3663.3931s
Epoch: 38 cost time: 58.652435064315796
Epoch: 38, Steps: 208 | Train Loss: 0.304 Vali Loss: 11.844 Vali Acc: 0.085 Test Loss: 11.844 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0301021
	speed: 0.7340s/iter; left time: 9392.5868s
	iters: 200, epoch: 39 | loss: 0.2185300
	speed: 0.3087s/iter; left time: 3920.0540s
Epoch: 39 cost time: 64.85029363632202
Epoch: 39, Steps: 208 | Train Loss: 0.296 Vali Loss: 11.513 Vali Acc: 0.082 Test Loss: 11.513 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.5873114
	speed: 0.7105s/iter; left time: 8944.9887s
	iters: 200, epoch: 40 | loss: 0.1677302
	speed: 0.3022s/iter; left time: 3774.2563s
Epoch: 40 cost time: 63.34258723258972
Epoch: 40, Steps: 208 | Train Loss: 0.278 Vali Loss: 12.160 Vali Acc: 0.079 Test Loss: 12.160 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0948037
	speed: 0.7022s/iter; left time: 8694.2794s
	iters: 200, epoch: 41 | loss: 0.1137425
	speed: 0.3107s/iter; left time: 3816.2773s
Epoch: 41 cost time: 64.74110651016235
Epoch: 41, Steps: 208 | Train Loss: 0.279 Vali Loss: 11.589 Vali Acc: 0.079 Test Loss: 11.589 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08887563376081122
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.1011000
	speed: 0.3226s/iter; left time: 6677.3324s
	iters: 200, epoch: 1 | loss: 5.6294346
	speed: 0.2824s/iter; left time: 5817.7865s
Epoch: 1 cost time: 63.006343126297
Epoch: 1, Steps: 208 | Train Loss: 5.305 Vali Loss: 5.752 Vali Acc: 0.061 Test Loss: 5.752 Test Acc: 0.061
Validation loss decreased (inf --> -0.061082).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.7507696
	speed: 0.6965s/iter; left time: 14273.1096s
	iters: 200, epoch: 2 | loss: 4.5515847
	speed: 0.2922s/iter; left time: 5959.7051s
Epoch: 2 cost time: 60.809685945510864
Epoch: 2, Steps: 208 | Train Loss: 4.439 Vali Loss: 5.329 Vali Acc: 0.065 Test Loss: 5.329 Test Acc: 0.065
Validation loss decreased (-0.061082 --> -0.064963).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.3095531
	speed: 0.7027s/iter; left time: 14253.3471s
	iters: 200, epoch: 3 | loss: 3.7118232
	speed: 0.2880s/iter; left time: 5812.3896s
Epoch: 3 cost time: 60.970669746398926
Epoch: 3, Steps: 208 | Train Loss: 3.632 Vali Loss: 5.484 Vali Acc: 0.064 Test Loss: 5.484 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.4932284
	speed: 0.7184s/iter; left time: 14423.5442s
	iters: 200, epoch: 4 | loss: 3.0219712
	speed: 0.2600s/iter; left time: 5194.4434s
Epoch: 4 cost time: 59.23589205741882
Epoch: 4, Steps: 208 | Train Loss: 2.785 Vali Loss: 6.196 Vali Acc: 0.066 Test Loss: 6.196 Test Acc: 0.066
Validation loss decreased (-0.064963 --> -0.066147).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7258704
	speed: 0.6761s/iter; left time: 13432.7575s
	iters: 200, epoch: 5 | loss: 3.3429649
	speed: 0.2895s/iter; left time: 5723.9528s
Epoch: 5 cost time: 58.62531566619873
Epoch: 5, Steps: 208 | Train Loss: 2.312 Vali Loss: 6.338 Vali Acc: 0.058 Test Loss: 6.338 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5761567
	speed: 0.6881s/iter; left time: 13529.0919s
	iters: 200, epoch: 6 | loss: 2.3210697
	speed: 0.3022s/iter; left time: 5910.7102s
Epoch: 6 cost time: 64.28275442123413
Epoch: 6, Steps: 208 | Train Loss: 2.061 Vali Loss: 5.807 Vali Acc: 0.061 Test Loss: 5.807 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3846068
	speed: 0.6948s/iter; left time: 13515.2523s
	iters: 200, epoch: 7 | loss: 3.3298757
	speed: 0.2998s/iter; left time: 5801.9050s
Epoch: 7 cost time: 62.37759184837341
Epoch: 7, Steps: 208 | Train Loss: 1.639 Vali Loss: 7.656 Vali Acc: 0.077 Test Loss: 7.656 Test Acc: 0.077
Validation loss decreased (-0.066147 --> -0.076571).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1165156
	speed: 0.6905s/iter; left time: 13289.2959s
	iters: 200, epoch: 8 | loss: 1.3464121
	speed: 0.2836s/iter; left time: 5429.1362s
Epoch: 8 cost time: 58.483415365219116
Epoch: 8, Steps: 208 | Train Loss: 1.400 Vali Loss: 7.508 Vali Acc: 0.086 Test Loss: 7.508 Test Acc: 0.086
Validation loss decreased (-0.076571 --> -0.085520).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5186268
	speed: 0.6942s/iter; left time: 13214.7062s
	iters: 200, epoch: 9 | loss: 2.4038801
	speed: 0.2746s/iter; left time: 5200.1389s
Epoch: 9 cost time: 60.6274037361145
Epoch: 9, Steps: 208 | Train Loss: 1.171 Vali Loss: 8.044 Vali Acc: 0.079 Test Loss: 8.044 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3323576
	speed: 0.6995s/iter; left time: 13170.9306s
	iters: 200, epoch: 10 | loss: 1.0445836
	speed: 0.3028s/iter; left time: 5671.1982s
Epoch: 10 cost time: 61.78992438316345
Epoch: 10, Steps: 208 | Train Loss: 1.027 Vali Loss: 8.861 Vali Acc: 0.070 Test Loss: 8.861 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.7897195
	speed: 0.6877s/iter; left time: 12804.8164s
	iters: 200, epoch: 11 | loss: 0.8171124
	speed: 0.2762s/iter; left time: 5115.8368s
Epoch: 11 cost time: 59.25715517997742
Epoch: 11, Steps: 208 | Train Loss: 0.895 Vali Loss: 8.723 Vali Acc: 0.068 Test Loss: 8.723 Test Acc: 0.068
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8340439
	speed: 0.6952s/iter; left time: 12799.8842s
	iters: 200, epoch: 12 | loss: 1.0753417
	speed: 0.2909s/iter; left time: 5327.4571s
Epoch: 12 cost time: 62.20657014846802
Epoch: 12, Steps: 208 | Train Loss: 0.830 Vali Loss: 9.326 Vali Acc: 0.077 Test Loss: 9.326 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.8722206
	speed: 0.7043s/iter; left time: 12820.9818s
	iters: 200, epoch: 13 | loss: 1.1597767
	speed: 0.2978s/iter; left time: 5391.2909s
Epoch: 13 cost time: 61.71267342567444
Epoch: 13, Steps: 208 | Train Loss: 0.711 Vali Loss: 9.660 Vali Acc: 0.068 Test Loss: 9.660 Test Acc: 0.068
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3004510
	speed: 0.6756s/iter; left time: 12158.9729s
	iters: 200, epoch: 14 | loss: 0.5316730
	speed: 0.2772s/iter; left time: 4961.1975s
Epoch: 14 cost time: 59.82183504104614
Epoch: 14, Steps: 208 | Train Loss: 0.668 Vali Loss: 10.043 Vali Acc: 0.075 Test Loss: 10.043 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6444047
	speed: 0.7048s/iter; left time: 12537.3810s
	iters: 200, epoch: 15 | loss: 0.8817989
	speed: 0.2881s/iter; left time: 5095.9407s
Epoch: 15 cost time: 60.262303829193115
Epoch: 15, Steps: 208 | Train Loss: 0.627 Vali Loss: 10.107 Vali Acc: 0.075 Test Loss: 10.107 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1529336
	speed: 0.6958s/iter; left time: 12232.4931s
	iters: 200, epoch: 16 | loss: 0.3852898
	speed: 0.2880s/iter; left time: 5033.6650s
Epoch: 16 cost time: 60.528929233551025
Epoch: 16, Steps: 208 | Train Loss: 0.604 Vali Loss: 10.056 Vali Acc: 0.074 Test Loss: 10.056 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.3754239
	speed: 0.6886s/iter; left time: 11963.0205s
	iters: 200, epoch: 17 | loss: 0.6676235
	speed: 0.2784s/iter; left time: 4808.5477s
Epoch: 17 cost time: 60.07143831253052
Epoch: 17, Steps: 208 | Train Loss: 0.523 Vali Loss: 10.543 Vali Acc: 0.087 Test Loss: 10.543 Test Acc: 0.087
Validation loss decreased (-0.085520 --> -0.087279).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3371554
	speed: 0.6981s/iter; left time: 11982.3750s
	iters: 200, epoch: 18 | loss: 0.5207114
	speed: 0.3047s/iter; left time: 5199.9547s
Epoch: 18 cost time: 61.48747539520264
Epoch: 18, Steps: 208 | Train Loss: 0.527 Vali Loss: 10.738 Vali Acc: 0.081 Test Loss: 10.738 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1313232
	speed: 0.7072s/iter; left time: 11991.9883s
	iters: 200, epoch: 19 | loss: 0.8256042
	speed: 0.2777s/iter; left time: 4682.0090s
Epoch: 19 cost time: 60.76142883300781
Epoch: 19, Steps: 208 | Train Loss: 0.488 Vali Loss: 10.850 Vali Acc: 0.086 Test Loss: 10.850 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1483851
	speed: 0.6751s/iter; left time: 11306.9102s
	iters: 200, epoch: 20 | loss: 0.4906265
	speed: 0.2898s/iter; left time: 4824.6381s
Epoch: 20 cost time: 59.43611001968384
Epoch: 20, Steps: 208 | Train Loss: 0.481 Vali Loss: 11.075 Vali Acc: 0.078 Test Loss: 11.075 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1136318
	speed: 0.7029s/iter; left time: 11627.2061s
	iters: 200, epoch: 21 | loss: 0.7793223
	speed: 0.2888s/iter; left time: 4747.6319s
Epoch: 21 cost time: 62.54808282852173
Epoch: 21, Steps: 208 | Train Loss: 0.488 Vali Loss: 10.718 Vali Acc: 0.087 Test Loss: 10.718 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1535470
	speed: 0.7112s/iter; left time: 11615.3683s
	iters: 200, epoch: 22 | loss: 0.0882207
	speed: 0.3072s/iter; left time: 4986.1769s
Epoch: 22 cost time: 62.5425500869751
Epoch: 22, Steps: 208 | Train Loss: 0.417 Vali Loss: 11.368 Vali Acc: 0.082 Test Loss: 11.368 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1728539
	speed: 0.6806s/iter; left time: 10974.4274s
	iters: 200, epoch: 23 | loss: 0.2865868
	speed: 0.2868s/iter; left time: 4595.2795s
Epoch: 23 cost time: 62.409817695617676
Epoch: 23, Steps: 208 | Train Loss: 0.418 Vali Loss: 11.011 Vali Acc: 0.084 Test Loss: 11.011 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0493697
	speed: 0.6898s/iter; left time: 10980.0065s
	iters: 200, epoch: 24 | loss: 0.6190463
	speed: 0.2955s/iter; left time: 4674.2366s
Epoch: 24 cost time: 61.56260418891907
Epoch: 24, Steps: 208 | Train Loss: 0.388 Vali Loss: 11.198 Vali Acc: 0.077 Test Loss: 11.198 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.7613760
	speed: 0.6952s/iter; left time: 10920.4820s
	iters: 200, epoch: 25 | loss: 0.2398890
	speed: 0.2930s/iter; left time: 4573.5169s
Epoch: 25 cost time: 61.869346141815186
Epoch: 25, Steps: 208 | Train Loss: 0.420 Vali Loss: 11.067 Vali Acc: 0.074 Test Loss: 11.067 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1851696
	speed: 0.7008s/iter; left time: 10862.8439s
	iters: 200, epoch: 26 | loss: 0.8409390
	speed: 0.2943s/iter; left time: 4532.6640s
Epoch: 26 cost time: 62.67078232765198
Epoch: 26, Steps: 208 | Train Loss: 0.399 Vali Loss: 11.127 Vali Acc: 0.084 Test Loss: 11.127 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1944463
	speed: 0.6914s/iter; left time: 10572.9501s
	iters: 200, epoch: 27 | loss: 0.4229820
	speed: 0.2875s/iter; left time: 4367.6170s
Epoch: 27 cost time: 59.70922636985779
Epoch: 27, Steps: 208 | Train Loss: 0.347 Vali Loss: 11.630 Vali Acc: 0.083 Test Loss: 11.630 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08738443185207277
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.2393990
	speed: 0.2670s/iter; left time: 5526.2821s
	iters: 200, epoch: 1 | loss: 5.8190770
	speed: 0.2535s/iter; left time: 5223.1319s
Epoch: 1 cost time: 54.46333837509155
Epoch: 1, Steps: 208 | Train Loss: 5.279 Vali Loss: 5.556 Vali Acc: 0.065 Test Loss: 5.556 Test Acc: 0.065
Validation loss decreased (inf --> -0.064961).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.9234900
	speed: 0.6145s/iter; left time: 12592.8277s
	iters: 200, epoch: 2 | loss: 4.1213059
	speed: 0.2734s/iter; left time: 5575.1510s
Epoch: 2 cost time: 55.725313663482666
Epoch: 2, Steps: 208 | Train Loss: 4.548 Vali Loss: 5.371 Vali Acc: 0.062 Test Loss: 5.371 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.5584369
	speed: 0.6479s/iter; left time: 13142.7668s
	iters: 200, epoch: 3 | loss: 3.1977098
	speed: 0.2715s/iter; left time: 5480.6766s
Epoch: 3 cost time: 57.09553813934326
Epoch: 3, Steps: 208 | Train Loss: 3.528 Vali Loss: 5.497 Vali Acc: 0.072 Test Loss: 5.497 Test Acc: 0.072
Validation loss decreased (-0.064961 --> -0.072119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5331748
	speed: 0.6648s/iter; left time: 13347.1012s
	iters: 200, epoch: 4 | loss: 2.3943033
	speed: 0.2620s/iter; left time: 5233.2523s
Epoch: 4 cost time: 55.54328727722168
Epoch: 4, Steps: 208 | Train Loss: 2.755 Vali Loss: 6.614 Vali Acc: 0.077 Test Loss: 6.614 Test Acc: 0.077
Validation loss decreased (-0.072119 --> -0.077178).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0945091
	speed: 0.6344s/iter; left time: 12604.2460s
	iters: 200, epoch: 5 | loss: 4.8352180
	speed: 0.2560s/iter; left time: 5061.2784s
Epoch: 5 cost time: 54.26669526100159
Epoch: 5, Steps: 208 | Train Loss: 2.362 Vali Loss: 6.026 Vali Acc: 0.064 Test Loss: 6.026 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9443057
	speed: 0.6903s/iter; left time: 13571.3406s
	iters: 200, epoch: 6 | loss: 2.3905439
	speed: 0.2920s/iter; left time: 5711.3762s
Epoch: 6 cost time: 62.4419641494751
Epoch: 6, Steps: 208 | Train Loss: 2.008 Vali Loss: 6.216 Vali Acc: 0.073 Test Loss: 6.216 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2099069
	speed: 0.7007s/iter; left time: 13631.0001s
	iters: 200, epoch: 7 | loss: 2.5117590
	speed: 0.2925s/iter; left time: 5660.9628s
Epoch: 7 cost time: 60.42505741119385
Epoch: 7, Steps: 208 | Train Loss: 1.749 Vali Loss: 7.247 Vali Acc: 0.069 Test Loss: 7.247 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4440558
	speed: 0.6701s/iter; left time: 12896.0544s
	iters: 200, epoch: 8 | loss: 1.3148820
	speed: 0.2714s/iter; left time: 5196.1746s
Epoch: 8 cost time: 59.05918502807617
Epoch: 8, Steps: 208 | Train Loss: 1.423 Vali Loss: 7.594 Vali Acc: 0.075 Test Loss: 7.594 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4598374
	speed: 0.6930s/iter; left time: 13192.3051s
	iters: 200, epoch: 9 | loss: 1.2743453
	speed: 0.2980s/iter; left time: 5642.3772s
Epoch: 9 cost time: 61.3545880317688
Epoch: 9, Steps: 208 | Train Loss: 1.237 Vali Loss: 7.948 Vali Acc: 0.077 Test Loss: 7.948 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.9233657
	speed: 0.7159s/iter; left time: 13478.8200s
	iters: 200, epoch: 10 | loss: 1.0673225
	speed: 0.2951s/iter; left time: 5526.1141s
Epoch: 10 cost time: 61.660465717315674
Epoch: 10, Steps: 208 | Train Loss: 1.056 Vali Loss: 8.192 Vali Acc: 0.071 Test Loss: 8.192 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.2993795
	speed: 0.6795s/iter; left time: 12652.3672s
	iters: 200, epoch: 11 | loss: 1.2590785
	speed: 0.2712s/iter; left time: 5023.1473s
Epoch: 11 cost time: 58.81026482582092
Epoch: 11, Steps: 208 | Train Loss: 0.984 Vali Loss: 8.416 Vali Acc: 0.078 Test Loss: 8.416 Test Acc: 0.078
Validation loss decreased (-0.077178 --> -0.077458).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6125690
	speed: 0.7282s/iter; left time: 13407.8146s
	iters: 200, epoch: 12 | loss: 0.8193413
	speed: 0.3007s/iter; left time: 5505.8844s
Epoch: 12 cost time: 63.641974687576294
Epoch: 12, Steps: 208 | Train Loss: 0.834 Vali Loss: 9.298 Vali Acc: 0.079 Test Loss: 9.298 Test Acc: 0.079
Validation loss decreased (-0.077458 --> -0.078642).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5635641
	speed: 0.7083s/iter; left time: 12894.0978s
	iters: 200, epoch: 13 | loss: 1.5363715
	speed: 0.2762s/iter; left time: 4999.9500s
Epoch: 13 cost time: 59.18200087547302
Epoch: 13, Steps: 208 | Train Loss: 0.762 Vali Loss: 9.441 Vali Acc: 0.082 Test Loss: 9.441 Test Acc: 0.082
Validation loss decreased (-0.078642 --> -0.081922).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6218665
	speed: 0.6773s/iter; left time: 12189.9535s
	iters: 200, epoch: 14 | loss: 0.4161768
	speed: 0.2814s/iter; left time: 5036.7596s
Epoch: 14 cost time: 58.91564226150513
Epoch: 14, Steps: 208 | Train Loss: 0.758 Vali Loss: 9.188 Vali Acc: 0.075 Test Loss: 9.188 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3814876
	speed: 0.7030s/iter; left time: 12504.8426s
	iters: 200, epoch: 15 | loss: 1.0323987
	speed: 0.3047s/iter; left time: 5390.4362s
Epoch: 15 cost time: 62.15895867347717
Epoch: 15, Steps: 208 | Train Loss: 0.695 Vali Loss: 9.441 Vali Acc: 0.081 Test Loss: 9.441 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0385513
	speed: 0.6657s/iter; left time: 11702.7990s
	iters: 200, epoch: 16 | loss: 0.5143677
	speed: 0.2987s/iter; left time: 5221.7958s
Epoch: 16 cost time: 61.05605626106262
Epoch: 16, Steps: 208 | Train Loss: 0.639 Vali Loss: 9.681 Vali Acc: 0.074 Test Loss: 9.681 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0509828
	speed: 0.6901s/iter; left time: 11989.1150s
	iters: 200, epoch: 17 | loss: 0.9245934
	speed: 0.2845s/iter; left time: 4914.8620s
Epoch: 17 cost time: 61.58976888656616
Epoch: 17, Steps: 208 | Train Loss: 0.620 Vali Loss: 9.600 Vali Acc: 0.077 Test Loss: 9.600 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.1567478
	speed: 0.7121s/iter; left time: 12223.5568s
	iters: 200, epoch: 18 | loss: 0.6531620
	speed: 0.2892s/iter; left time: 4935.5285s
Epoch: 18 cost time: 61.64493536949158
Epoch: 18, Steps: 208 | Train Loss: 0.572 Vali Loss: 10.344 Vali Acc: 0.080 Test Loss: 10.344 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1784545
	speed: 0.6688s/iter; left time: 11341.1610s
	iters: 200, epoch: 19 | loss: 0.2461410
	speed: 0.2681s/iter; left time: 4520.1068s
Epoch: 19 cost time: 56.00709366798401
Epoch: 19, Steps: 208 | Train Loss: 0.534 Vali Loss: 10.381 Vali Acc: 0.082 Test Loss: 10.381 Test Acc: 0.082
Validation loss decreased (-0.081922 --> -0.082211).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4211210
	speed: 0.6675s/iter; left time: 11180.2633s
	iters: 200, epoch: 20 | loss: 0.1832868
	speed: 0.2852s/iter; left time: 4748.3918s
Epoch: 20 cost time: 60.32597756385803
Epoch: 20, Steps: 208 | Train Loss: 0.548 Vali Loss: 10.690 Vali Acc: 0.080 Test Loss: 10.690 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0419297
	speed: 0.7091s/iter; left time: 11729.0550s
	iters: 200, epoch: 21 | loss: 0.0788743
	speed: 0.3013s/iter; left time: 4954.2166s
Epoch: 21 cost time: 63.34858298301697
Epoch: 21, Steps: 208 | Train Loss: 0.479 Vali Loss: 10.746 Vali Acc: 0.078 Test Loss: 10.746 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.5011214
	speed: 0.6584s/iter; left time: 10753.3022s
	iters: 200, epoch: 22 | loss: 0.0939184
	speed: 0.2791s/iter; left time: 4531.0967s
Epoch: 22 cost time: 57.02608871459961
Epoch: 22, Steps: 208 | Train Loss: 0.538 Vali Loss: 11.307 Vali Acc: 0.077 Test Loss: 11.307 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0690809
	speed: 0.6843s/iter; left time: 11035.1427s
	iters: 200, epoch: 23 | loss: 0.6122797
	speed: 0.2906s/iter; left time: 4656.4313s
Epoch: 23 cost time: 62.386218547821045
Epoch: 23, Steps: 208 | Train Loss: 0.520 Vali Loss: 11.116 Vali Acc: 0.078 Test Loss: 11.116 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0018962
	speed: 0.7216s/iter; left time: 11486.0042s
	iters: 200, epoch: 24 | loss: 0.0155640
	speed: 0.2944s/iter; left time: 4656.5937s
Epoch: 24 cost time: 62.67055654525757
Epoch: 24, Steps: 208 | Train Loss: 0.479 Vali Loss: 11.360 Vali Acc: 0.076 Test Loss: 11.360 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0429680
	speed: 0.6790s/iter; left time: 10665.7531s
	iters: 200, epoch: 25 | loss: 0.3904192
	speed: 0.2636s/iter; left time: 4114.4048s
Epoch: 25 cost time: 56.937612771987915
Epoch: 25, Steps: 208 | Train Loss: 0.420 Vali Loss: 10.843 Vali Acc: 0.085 Test Loss: 10.843 Test Acc: 0.085
Validation loss decreased (-0.082211 --> -0.084890).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.3428212
	speed: 0.7110s/iter; left time: 11020.5961s
	iters: 200, epoch: 26 | loss: 1.3922701
	speed: 0.2949s/iter; left time: 4540.9966s
Epoch: 26 cost time: 63.67202830314636
Epoch: 26, Steps: 208 | Train Loss: 0.424 Vali Loss: 11.629 Vali Acc: 0.080 Test Loss: 11.629 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.4652286
	speed: 0.6998s/iter; left time: 10702.4952s
	iters: 200, epoch: 27 | loss: 0.3774003
	speed: 0.2983s/iter; left time: 4532.6061s
Epoch: 27 cost time: 61.392289876937866
Epoch: 27, Steps: 208 | Train Loss: 0.435 Vali Loss: 11.218 Vali Acc: 0.079 Test Loss: 11.218 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.8854693
	speed: 0.6571s/iter; left time: 9912.0635s
	iters: 200, epoch: 28 | loss: 0.3049390
	speed: 0.2884s/iter; left time: 4321.1106s
Epoch: 28 cost time: 59.01193404197693
Epoch: 28, Steps: 208 | Train Loss: 0.402 Vali Loss: 11.058 Vali Acc: 0.080 Test Loss: 11.058 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.1071653
	speed: 0.6918s/iter; left time: 10292.4311s
	iters: 200, epoch: 29 | loss: 0.0379451
	speed: 0.3047s/iter; left time: 4501.8780s
Epoch: 29 cost time: 63.27666759490967
Epoch: 29, Steps: 208 | Train Loss: 0.402 Vali Loss: 11.347 Vali Acc: 0.075 Test Loss: 11.347 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1474461
	speed: 0.7084s/iter; left time: 10391.1293s
	iters: 200, epoch: 30 | loss: 0.3720778
	speed: 0.2838s/iter; left time: 4134.4780s
Epoch: 30 cost time: 61.09972357749939
Epoch: 30, Steps: 208 | Train Loss: 0.401 Vali Loss: 11.457 Vali Acc: 0.080 Test Loss: 11.457 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.5647706
	speed: 0.6687s/iter; left time: 9669.5424s
	iters: 200, epoch: 31 | loss: 0.3520481
	speed: 0.2851s/iter; left time: 4094.4111s
Epoch: 31 cost time: 58.90625500679016
Epoch: 31, Steps: 208 | Train Loss: 0.449 Vali Loss: 11.026 Vali Acc: 0.074 Test Loss: 11.026 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0924656
	speed: 0.6981s/iter; left time: 9950.4957s
	iters: 200, epoch: 32 | loss: 0.0552453
	speed: 0.2887s/iter; left time: 4086.2090s
Epoch: 32 cost time: 61.59019327163696
Epoch: 32, Steps: 208 | Train Loss: 0.397 Vali Loss: 11.489 Vali Acc: 0.082 Test Loss: 11.489 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.4007003
	speed: 0.7194s/iter; left time: 10104.5187s
	iters: 200, epoch: 33 | loss: 1.6256813
	speed: 0.2823s/iter; left time: 3937.1910s
Epoch: 33 cost time: 61.183520555496216
Epoch: 33, Steps: 208 | Train Loss: 0.339 Vali Loss: 11.563 Vali Acc: 0.078 Test Loss: 11.563 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0578116
	speed: 0.6903s/iter; left time: 9552.2604s
	iters: 200, epoch: 34 | loss: 0.8936836
	speed: 0.2990s/iter; left time: 4107.1458s
Epoch: 34 cost time: 61.71419405937195
Epoch: 34, Steps: 208 | Train Loss: 0.353 Vali Loss: 11.339 Vali Acc: 0.081 Test Loss: 11.339 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.3341779
	speed: 0.6890s/iter; left time: 9389.8400s
	iters: 200, epoch: 35 | loss: 0.8525619
	speed: 0.2683s/iter; left time: 3629.1813s
Epoch: 35 cost time: 59.88246417045593
Epoch: 35, Steps: 208 | Train Loss: 0.335 Vali Loss: 11.570 Vali Acc: 0.080 Test Loss: 11.570 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08499850879809126
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9502273
	speed: 0.3030s/iter; left time: 6271.5323s
	iters: 200, epoch: 1 | loss: 4.9427619
	speed: 0.2757s/iter; left time: 5679.8588s
Epoch: 1 cost time: 60.24537634849548
Epoch: 1, Steps: 208 | Train Loss: 5.228 Vali Loss: 5.280 Vali Acc: 0.069 Test Loss: 5.280 Test Acc: 0.069
Validation loss decreased (inf --> -0.069139).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.6242695
	speed: 0.6750s/iter; left time: 13833.1119s
	iters: 200, epoch: 2 | loss: 4.8554540
	speed: 0.3056s/iter; left time: 6232.6682s
Epoch: 2 cost time: 60.905529737472534
Epoch: 2, Steps: 208 | Train Loss: 4.467 Vali Loss: 5.280 Vali Acc: 0.062 Test Loss: 5.280 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.7603965
	speed: 0.6839s/iter; left time: 13872.2365s
	iters: 200, epoch: 3 | loss: 4.8254328
	speed: 0.2696s/iter; left time: 5442.0559s
Epoch: 3 cost time: 58.486958742141724
Epoch: 3, Steps: 208 | Train Loss: 3.495 Vali Loss: 5.584 Vali Acc: 0.071 Test Loss: 5.584 Test Acc: 0.071
Validation loss decreased (-0.069139 --> -0.070925).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6029112
	speed: 0.6682s/iter; left time: 13414.7535s
	iters: 200, epoch: 4 | loss: 2.5182745
	speed: 0.2792s/iter; left time: 5576.7132s
Epoch: 4 cost time: 59.31417894363403
Epoch: 4, Steps: 208 | Train Loss: 2.761 Vali Loss: 6.820 Vali Acc: 0.071 Test Loss: 6.820 Test Acc: 0.071
Validation loss decreased (-0.070925 --> -0.071211).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6777625
	speed: 0.7071s/iter; left time: 14048.5017s
	iters: 200, epoch: 5 | loss: 3.0987859
	speed: 0.2900s/iter; left time: 5733.6619s
Epoch: 5 cost time: 60.69427824020386
Epoch: 5, Steps: 208 | Train Loss: 2.357 Vali Loss: 6.210 Vali Acc: 0.073 Test Loss: 6.210 Test Acc: 0.073
Validation loss decreased (-0.071211 --> -0.073305).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6087749
	speed: 0.7102s/iter; left time: 13963.5997s
	iters: 200, epoch: 6 | loss: 2.5081832
	speed: 0.2777s/iter; left time: 5431.7821s
Epoch: 6 cost time: 59.36113214492798
Epoch: 6, Steps: 208 | Train Loss: 2.131 Vali Loss: 5.799 Vali Acc: 0.066 Test Loss: 5.799 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6118875
	speed: 0.6800s/iter; left time: 13227.1878s
	iters: 200, epoch: 7 | loss: 2.8619297
	speed: 0.2896s/iter; left time: 5604.8506s
Epoch: 7 cost time: 60.629079818725586
Epoch: 7, Steps: 208 | Train Loss: 1.711 Vali Loss: 6.601 Vali Acc: 0.067 Test Loss: 6.601 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7971095
	speed: 0.6694s/iter; left time: 12882.7225s
	iters: 200, epoch: 8 | loss: 1.5454737
	speed: 0.2884s/iter; left time: 5520.8655s
Epoch: 8 cost time: 59.170114278793335
Epoch: 8, Steps: 208 | Train Loss: 1.483 Vali Loss: 7.779 Vali Acc: 0.073 Test Loss: 7.779 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4143732
	speed: 0.6573s/iter; left time: 12512.7418s
	iters: 200, epoch: 9 | loss: 1.5902545
	speed: 0.2527s/iter; left time: 4784.4678s
Epoch: 9 cost time: 55.05910587310791
Epoch: 9, Steps: 208 | Train Loss: 1.231 Vali Loss: 7.491 Vali Acc: 0.077 Test Loss: 7.491 Test Acc: 0.077
Validation loss decreased (-0.073305 --> -0.076573).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9766285
	speed: 0.6340s/iter; left time: 11937.3463s
	iters: 200, epoch: 10 | loss: 1.4922509
	speed: 0.2502s/iter; left time: 4686.6134s
Epoch: 10 cost time: 52.60269784927368
Epoch: 10, Steps: 208 | Train Loss: 1.042 Vali Loss: 8.181 Vali Acc: 0.072 Test Loss: 8.181 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0315857
	speed: 0.6294s/iter; left time: 11720.1504s
	iters: 200, epoch: 11 | loss: 1.0169613
	speed: 0.2745s/iter; left time: 5084.7552s
Epoch: 11 cost time: 56.20957708358765
Epoch: 11, Steps: 208 | Train Loss: 0.931 Vali Loss: 8.810 Vali Acc: 0.085 Test Loss: 8.810 Test Acc: 0.085
Validation loss decreased (-0.076573 --> -0.085209).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3862020
	speed: 0.6564s/iter; left time: 12086.1800s
	iters: 200, epoch: 12 | loss: 0.8296716
	speed: 0.2622s/iter; left time: 4801.9406s
Epoch: 12 cost time: 55.549004793167114
Epoch: 12, Steps: 208 | Train Loss: 0.892 Vali Loss: 9.089 Vali Acc: 0.075 Test Loss: 9.089 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9524572
	speed: 0.6245s/iter; left time: 11369.0405s
	iters: 200, epoch: 13 | loss: 2.1761339
	speed: 0.2705s/iter; left time: 4896.6240s
Epoch: 13 cost time: 53.78175735473633
Epoch: 13, Steps: 208 | Train Loss: 0.814 Vali Loss: 9.293 Vali Acc: 0.074 Test Loss: 9.293 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.9869379
	speed: 0.6329s/iter; left time: 11390.6315s
	iters: 200, epoch: 14 | loss: 0.2869726
	speed: 0.2594s/iter; left time: 4641.8859s
Epoch: 14 cost time: 55.87643074989319
Epoch: 14, Steps: 208 | Train Loss: 0.734 Vali Loss: 9.426 Vali Acc: 0.088 Test Loss: 9.426 Test Acc: 0.088
Validation loss decreased (-0.085209 --> -0.088185).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2854563
	speed: 0.6908s/iter; left time: 12288.9549s
	iters: 200, epoch: 15 | loss: 0.8640131
	speed: 0.2958s/iter; left time: 5233.0855s
Epoch: 15 cost time: 61.129913330078125
Epoch: 15, Steps: 208 | Train Loss: 0.711 Vali Loss: 9.606 Vali Acc: 0.078 Test Loss: 9.606 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2659358
	speed: 0.6549s/iter; left time: 11514.4716s
	iters: 200, epoch: 16 | loss: 0.6196797
	speed: 0.2622s/iter; left time: 4582.9029s
Epoch: 16 cost time: 56.26060962677002
Epoch: 16, Steps: 208 | Train Loss: 0.662 Vali Loss: 10.004 Vali Acc: 0.076 Test Loss: 10.004 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.0338612
	speed: 0.6918s/iter; left time: 12019.4864s
	iters: 200, epoch: 17 | loss: 0.5290518
	speed: 0.2942s/iter; left time: 5081.9256s
Epoch: 17 cost time: 61.334750175476074
Epoch: 17, Steps: 208 | Train Loss: 0.629 Vali Loss: 9.788 Vali Acc: 0.088 Test Loss: 9.788 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6207944
	speed: 0.6868s/iter; left time: 11789.3127s
	iters: 200, epoch: 18 | loss: 0.8275239
	speed: 0.2939s/iter; left time: 5015.7341s
Epoch: 18 cost time: 61.11120343208313
Epoch: 18, Steps: 208 | Train Loss: 0.600 Vali Loss: 10.657 Vali Acc: 0.075 Test Loss: 10.657 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.4628648
	speed: 0.6402s/iter; left time: 10855.7506s
	iters: 200, epoch: 19 | loss: 0.4621119
	speed: 0.2639s/iter; left time: 4447.7573s
Epoch: 19 cost time: 54.34081292152405
Epoch: 19, Steps: 208 | Train Loss: 0.579 Vali Loss: 10.479 Vali Acc: 0.079 Test Loss: 10.479 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2568818
	speed: 0.6525s/iter; left time: 10929.4135s
	iters: 200, epoch: 20 | loss: 0.1484345
	speed: 0.2794s/iter; left time: 4651.1812s
Epoch: 20 cost time: 59.14505195617676
Epoch: 20, Steps: 208 | Train Loss: 0.534 Vali Loss: 10.655 Vali Acc: 0.084 Test Loss: 10.655 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2672133
	speed: 0.6947s/iter; left time: 11491.0947s
	iters: 200, epoch: 21 | loss: 0.0940925
	speed: 0.2757s/iter; left time: 4533.4341s
Epoch: 21 cost time: 59.55509376525879
Epoch: 21, Steps: 208 | Train Loss: 0.517 Vali Loss: 11.010 Vali Acc: 0.078 Test Loss: 11.010 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3056095
	speed: 0.6548s/iter; left time: 10695.3486s
	iters: 200, epoch: 22 | loss: 0.0531322
	speed: 0.2846s/iter; left time: 4619.1272s
Epoch: 22 cost time: 57.27182865142822
Epoch: 22, Steps: 208 | Train Loss: 0.520 Vali Loss: 10.485 Vali Acc: 0.078 Test Loss: 10.485 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3777365
	speed: 0.7278s/iter; left time: 11735.7892s
	iters: 200, epoch: 23 | loss: 0.5016102
	speed: 0.3135s/iter; left time: 5024.2962s
Epoch: 23 cost time: 66.73045945167542
Epoch: 23, Steps: 208 | Train Loss: 0.461 Vali Loss: 11.360 Vali Acc: 0.084 Test Loss: 11.360 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4798057
	speed: 0.7986s/iter; left time: 12712.0506s
	iters: 200, epoch: 24 | loss: 0.0763064
	speed: 0.3294s/iter; left time: 5210.4089s
Epoch: 24 cost time: 69.71563172340393
Epoch: 24, Steps: 208 | Train Loss: 0.506 Vali Loss: 11.157 Vali Acc: 0.082 Test Loss: 11.157 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08827915299731584
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.5593433
	speed: 0.3361s/iter; left time: 6958.0520s
	iters: 200, epoch: 1 | loss: 6.4682894
	speed: 0.3114s/iter; left time: 6415.5082s
Epoch: 1 cost time: 67.64547657966614
Epoch: 1, Steps: 208 | Train Loss: 5.188 Vali Loss: 6.487 Vali Acc: 0.063 Test Loss: 6.487 Test Acc: 0.063
Validation loss decreased (inf --> -0.062566).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.8238273
	speed: 0.7842s/iter; left time: 16069.8431s
	iters: 200, epoch: 2 | loss: 4.9947648
	speed: 0.3117s/iter; left time: 6356.8629s
Epoch: 2 cost time: 66.11142230033875
Epoch: 2, Steps: 208 | Train Loss: 4.602 Vali Loss: 6.264 Vali Acc: 0.061 Test Loss: 6.264 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.5038581
	speed: 0.7674s/iter; left time: 15566.0160s
	iters: 200, epoch: 3 | loss: 3.2744935
	speed: 0.2763s/iter; left time: 5576.7297s
Epoch: 3 cost time: 61.945595026016235
Epoch: 3, Steps: 208 | Train Loss: 3.695 Vali Loss: 6.276 Vali Acc: 0.058 Test Loss: 6.276 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.8552096
	speed: 0.6372s/iter; left time: 12793.3386s
	iters: 200, epoch: 4 | loss: 3.2426398
	speed: 0.2746s/iter; left time: 5486.0380s
Epoch: 4 cost time: 55.89104104042053
Epoch: 4, Steps: 208 | Train Loss: 2.892 Vali Loss: 6.718 Vali Acc: 0.063 Test Loss: 6.718 Test Acc: 0.063
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.0250864
	speed: 0.6537s/iter; left time: 12987.9455s
	iters: 200, epoch: 5 | loss: 3.6365547
	speed: 0.2569s/iter; left time: 5078.6278s
Epoch: 5 cost time: 56.07183861732483
Epoch: 5, Steps: 208 | Train Loss: 2.536 Vali Loss: 6.152 Vali Acc: 0.070 Test Loss: 6.152 Test Acc: 0.070
Validation loss decreased (-0.062566 --> -0.069727).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7867712
	speed: 0.6488s/iter; left time: 12755.7819s
	iters: 200, epoch: 6 | loss: 2.1181140
	speed: 0.2657s/iter; left time: 5196.8245s
Epoch: 6 cost time: 55.241520166397095
Epoch: 6, Steps: 208 | Train Loss: 2.198 Vali Loss: 6.068 Vali Acc: 0.072 Test Loss: 6.068 Test Acc: 0.072
Validation loss decreased (-0.069727 --> -0.072412).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2588190
	speed: 0.6582s/iter; left time: 12804.6908s
	iters: 200, epoch: 7 | loss: 3.3549318
	speed: 0.2841s/iter; left time: 5497.2587s
Epoch: 7 cost time: 59.57253384590149
Epoch: 7, Steps: 208 | Train Loss: 1.936 Vali Loss: 6.160 Vali Acc: 0.080 Test Loss: 6.160 Test Acc: 0.080
Validation loss decreased (-0.072412 --> -0.079867).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9372222
	speed: 0.6946s/iter; left time: 13367.6748s
	iters: 200, epoch: 8 | loss: 2.3628430
	speed: 0.2975s/iter; left time: 5696.0191s
Epoch: 8 cost time: 61.581676959991455
Epoch: 8, Steps: 208 | Train Loss: 1.587 Vali Loss: 6.658 Vali Acc: 0.071 Test Loss: 6.658 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7573129
	speed: 0.6844s/iter; left time: 13029.1238s
	iters: 200, epoch: 9 | loss: 1.8311461
	speed: 0.2704s/iter; left time: 5119.6807s
Epoch: 9 cost time: 59.84437656402588
Epoch: 9, Steps: 208 | Train Loss: 1.374 Vali Loss: 6.774 Vali Acc: 0.082 Test Loss: 6.774 Test Acc: 0.082
Validation loss decreased (-0.079867 --> -0.082247).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9058548
	speed: 0.6877s/iter; left time: 12947.8695s
	iters: 200, epoch: 10 | loss: 1.2416434
	speed: 0.2789s/iter; left time: 5223.6456s
Epoch: 10 cost time: 58.46557903289795
Epoch: 10, Steps: 208 | Train Loss: 1.159 Vali Loss: 7.462 Vali Acc: 0.076 Test Loss: 7.462 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9669701
	speed: 0.6743s/iter; left time: 12555.7810s
	iters: 200, epoch: 11 | loss: 0.6314092
	speed: 0.3039s/iter; left time: 5627.8377s
Epoch: 11 cost time: 60.768911600112915
Epoch: 11, Steps: 208 | Train Loss: 1.048 Vali Loss: 7.331 Vali Acc: 0.078 Test Loss: 7.331 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1767757
	speed: 0.6826s/iter; left time: 12568.5307s
	iters: 200, epoch: 12 | loss: 1.2757901
	speed: 0.2831s/iter; left time: 5184.7106s
Epoch: 12 cost time: 61.38528037071228
Epoch: 12, Steps: 208 | Train Loss: 0.967 Vali Loss: 8.181 Vali Acc: 0.081 Test Loss: 8.181 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0486250
	speed: 0.7021s/iter; left time: 12781.1383s
	iters: 200, epoch: 13 | loss: 1.0492743
	speed: 0.2987s/iter; left time: 5408.5385s
Epoch: 13 cost time: 62.00936841964722
Epoch: 13, Steps: 208 | Train Loss: 0.842 Vali Loss: 8.500 Vali Acc: 0.086 Test Loss: 8.500 Test Acc: 0.086
Validation loss decreased (-0.082247 --> -0.086106).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6717938
	speed: 0.6638s/iter; left time: 11947.0550s
	iters: 200, epoch: 14 | loss: 0.3767171
	speed: 0.2929s/iter; left time: 5241.7047s
Epoch: 14 cost time: 61.23649740219116
Epoch: 14, Steps: 208 | Train Loss: 0.815 Vali Loss: 8.462 Vali Acc: 0.087 Test Loss: 8.462 Test Acc: 0.087
Validation loss decreased (-0.086106 --> -0.086703).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2813244
	speed: 0.6967s/iter; left time: 12393.5893s
	iters: 200, epoch: 15 | loss: 1.1043689
	speed: 0.2857s/iter; left time: 5054.1359s
Epoch: 15 cost time: 60.40667462348938
Epoch: 15, Steps: 208 | Train Loss: 0.766 Vali Loss: 8.677 Vali Acc: 0.078 Test Loss: 8.677 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7451653
	speed: 0.6758s/iter; left time: 11881.2927s
	iters: 200, epoch: 16 | loss: 0.5497165
	speed: 0.2764s/iter; left time: 4831.8023s
Epoch: 16 cost time: 60.47098183631897
Epoch: 16, Steps: 208 | Train Loss: 0.676 Vali Loss: 9.195 Vali Acc: 0.091 Test Loss: 9.195 Test Acc: 0.091
Validation loss decreased (-0.086703 --> -0.090573).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4676903
	speed: 0.6988s/iter; left time: 12140.6116s
	iters: 200, epoch: 17 | loss: 0.4577454
	speed: 0.3041s/iter; left time: 5251.9218s
Epoch: 17 cost time: 61.95866870880127
Epoch: 17, Steps: 208 | Train Loss: 0.670 Vali Loss: 8.509 Vali Acc: 0.071 Test Loss: 8.509 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5811394
	speed: 0.6830s/iter; left time: 11724.2170s
	iters: 200, epoch: 18 | loss: 1.5505253
	speed: 0.2872s/iter; left time: 4900.5783s
Epoch: 18 cost time: 61.526968002319336
Epoch: 18, Steps: 208 | Train Loss: 0.653 Vali Loss: 9.256 Vali Acc: 0.080 Test Loss: 9.256 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1616407
	speed: 0.6982s/iter; left time: 11839.2292s
	iters: 200, epoch: 19 | loss: 0.3270229
	speed: 0.2970s/iter; left time: 5006.9829s
Epoch: 19 cost time: 61.483506202697754
Epoch: 19, Steps: 208 | Train Loss: 0.613 Vali Loss: 9.401 Vali Acc: 0.076 Test Loss: 9.401 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.5064178
	speed: 0.6297s/iter; left time: 10547.0852s
	iters: 200, epoch: 20 | loss: 0.4021711
	speed: 0.2593s/iter; left time: 4317.6691s
Epoch: 20 cost time: 55.24057674407959
Epoch: 20, Steps: 208 | Train Loss: 0.528 Vali Loss: 9.903 Vali Acc: 0.083 Test Loss: 9.903 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3397041
	speed: 0.6944s/iter; left time: 11485.4350s
	iters: 200, epoch: 21 | loss: 0.4968502
	speed: 0.3011s/iter; left time: 4949.5886s
Epoch: 21 cost time: 61.1925733089447
Epoch: 21, Steps: 208 | Train Loss: 0.610 Vali Loss: 9.130 Vali Acc: 0.082 Test Loss: 9.130 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0469801
	speed: 0.6683s/iter; left time: 10916.0510s
	iters: 200, epoch: 22 | loss: 0.6533099
	speed: 0.2577s/iter; left time: 4182.9209s
Epoch: 22 cost time: 57.14288115501404
Epoch: 22, Steps: 208 | Train Loss: 0.550 Vali Loss: 10.074 Vali Acc: 0.082 Test Loss: 10.074 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.3163696
	speed: 0.6321s/iter; left time: 10191.9814s
	iters: 200, epoch: 23 | loss: 1.4031386
	speed: 0.2958s/iter; left time: 4739.8983s
Epoch: 23 cost time: 56.71515393257141
Epoch: 23, Steps: 208 | Train Loss: 0.550 Vali Loss: 9.923 Vali Acc: 0.081 Test Loss: 9.923 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4323903
	speed: 0.6929s/iter; left time: 11029.5442s
	iters: 200, epoch: 24 | loss: 0.2580167
	speed: 0.2834s/iter; left time: 4481.9783s
Epoch: 24 cost time: 61.004676818847656
Epoch: 24, Steps: 208 | Train Loss: 0.504 Vali Loss: 10.075 Vali Acc: 0.084 Test Loss: 10.075 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.3748484
	speed: 0.6712s/iter; left time: 10544.1752s
	iters: 200, epoch: 25 | loss: 0.6610388
	speed: 0.2829s/iter; left time: 4415.4454s
Epoch: 25 cost time: 59.164573431015015
Epoch: 25, Steps: 208 | Train Loss: 0.509 Vali Loss: 10.187 Vali Acc: 0.084 Test Loss: 10.187 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4682789
	speed: 0.6718s/iter; left time: 10413.8475s
	iters: 200, epoch: 26 | loss: 0.5945247
	speed: 0.2877s/iter; left time: 4430.8701s
Epoch: 26 cost time: 60.85465621948242
Epoch: 26, Steps: 208 | Train Loss: 0.459 Vali Loss: 9.705 Vali Acc: 0.092 Test Loss: 9.705 Test Acc: 0.092
Validation loss decreased (-0.090573 --> -0.092357).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.2512927
	speed: 0.6937s/iter; left time: 10608.9931s
	iters: 200, epoch: 27 | loss: 0.3660498
	speed: 0.2950s/iter; left time: 4482.0938s
Epoch: 27 cost time: 61.40897583961487
Epoch: 27, Steps: 208 | Train Loss: 0.416 Vali Loss: 9.910 Vali Acc: 0.074 Test Loss: 9.910 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.5774630
	speed: 0.6650s/iter; left time: 10031.9082s
	iters: 200, epoch: 28 | loss: 0.6928265
	speed: 0.2921s/iter; left time: 4377.1234s
Epoch: 28 cost time: 59.6839075088501
Epoch: 28, Steps: 208 | Train Loss: 0.450 Vali Loss: 10.152 Vali Acc: 0.085 Test Loss: 10.152 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0078671
	speed: 0.6898s/iter; left time: 10262.1887s
	iters: 200, epoch: 29 | loss: 0.0580940
	speed: 0.2662s/iter; left time: 3933.4760s
Epoch: 29 cost time: 59.0854172706604
Epoch: 29, Steps: 208 | Train Loss: 0.411 Vali Loss: 10.684 Vali Acc: 0.083 Test Loss: 10.684 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.3401336
	speed: 0.6879s/iter; left time: 10090.3466s
	iters: 200, epoch: 30 | loss: 0.9797574
	speed: 0.2989s/iter; left time: 4355.3223s
Epoch: 30 cost time: 61.20628309249878
Epoch: 30, Steps: 208 | Train Loss: 0.429 Vali Loss: 10.508 Vali Acc: 0.083 Test Loss: 10.508 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.3621403
	speed: 0.6816s/iter; left time: 9856.1745s
	iters: 200, epoch: 31 | loss: 0.7070123
	speed: 0.2870s/iter; left time: 4121.5787s
Epoch: 31 cost time: 60.88256359100342
Epoch: 31, Steps: 208 | Train Loss: 0.418 Vali Loss: 9.893 Vali Acc: 0.079 Test Loss: 9.893 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.1820309
	speed: 0.6595s/iter; left time: 9399.2649s
	iters: 200, epoch: 32 | loss: 0.0655303
	speed: 0.2894s/iter; left time: 4095.4314s
Epoch: 32 cost time: 59.298181772232056
Epoch: 32, Steps: 208 | Train Loss: 0.453 Vali Loss: 10.644 Vali Acc: 0.085 Test Loss: 10.644 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.7492127
	speed: 0.6980s/iter; left time: 9802.7710s
	iters: 200, epoch: 33 | loss: 0.4304462
	speed: 0.2950s/iter; left time: 4113.1567s
Epoch: 33 cost time: 63.356669187545776
Epoch: 33, Steps: 208 | Train Loss: 0.402 Vali Loss: 10.058 Vali Acc: 0.085 Test Loss: 10.058 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.1877299
	speed: 0.6551s/iter; left time: 9064.9607s
	iters: 200, epoch: 34 | loss: 1.1055620
	speed: 0.2850s/iter; left time: 3915.3997s
Epoch: 34 cost time: 57.842304706573486
Epoch: 34, Steps: 208 | Train Loss: 0.401 Vali Loss: 10.123 Vali Acc: 0.087 Test Loss: 10.123 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.6224565
	speed: 0.6591s/iter; left time: 8982.2395s
	iters: 200, epoch: 35 | loss: 0.4350705
	speed: 0.2794s/iter; left time: 3780.4296s
Epoch: 35 cost time: 59.47115421295166
Epoch: 35, Steps: 208 | Train Loss: 0.358 Vali Loss: 10.155 Vali Acc: 0.079 Test Loss: 10.155 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.1449183
	speed: 0.7034s/iter; left time: 9440.1323s
	iters: 200, epoch: 36 | loss: 0.1482952
	speed: 0.2900s/iter; left time: 3863.4670s
Epoch: 36 cost time: 60.579259395599365
Epoch: 36, Steps: 208 | Train Loss: 0.427 Vali Loss: 10.122 Vali Acc: 0.075 Test Loss: 10.122 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09245451834178348
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8875751
	speed: 0.2827s/iter; left time: 5851.3483s
	iters: 200, epoch: 1 | loss: 5.1889725
	speed: 0.2898s/iter; left time: 5969.7017s
Epoch: 1 cost time: 59.45303964614868
Epoch: 1, Steps: 208 | Train Loss: 4.851 Vali Loss: 6.744 Vali Acc: 0.062 Test Loss: 6.744 Test Acc: 0.062
Validation loss decreased (inf --> -0.062265).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.0878057
	speed: 0.6827s/iter; left time: 13990.5727s
	iters: 200, epoch: 2 | loss: 5.3884168
	speed: 0.2827s/iter; left time: 5765.1759s
Epoch: 2 cost time: 59.4675498008728
Epoch: 2, Steps: 208 | Train Loss: 4.713 Vali Loss: 6.905 Vali Acc: 0.071 Test Loss: 6.905 Test Acc: 0.071
Validation loss decreased (-0.062265 --> -0.070614).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.4863071
	speed: 0.6925s/iter; left time: 14047.4358s
	iters: 200, epoch: 3 | loss: 4.4836993
	speed: 0.2790s/iter; left time: 5631.4800s
Epoch: 3 cost time: 60.533846616744995
Epoch: 3, Steps: 208 | Train Loss: 3.955 Vali Loss: 6.262 Vali Acc: 0.054 Test Loss: 6.262 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.0664997
	speed: 0.6948s/iter; left time: 13950.2833s
	iters: 200, epoch: 4 | loss: 3.0477719
	speed: 0.2733s/iter; left time: 5459.3052s
Epoch: 4 cost time: 58.036102056503296
Epoch: 4, Steps: 208 | Train Loss: 3.327 Vali Loss: 5.395 Vali Acc: 0.059 Test Loss: 5.395 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4477429
	speed: 0.6622s/iter; left time: 13157.9222s
	iters: 200, epoch: 5 | loss: 3.8677099
	speed: 0.2954s/iter; left time: 5839.4703s
Epoch: 5 cost time: 59.82151246070862
Epoch: 5, Steps: 208 | Train Loss: 3.075 Vali Loss: 4.880 Vali Acc: 0.060 Test Loss: 4.880 Test Acc: 0.060
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.5437813
	speed: 0.6817s/iter; left time: 13402.7330s
	iters: 200, epoch: 6 | loss: 3.4683325
	speed: 0.2861s/iter; left time: 5596.1195s
Epoch: 6 cost time: 60.84354901313782
Epoch: 6, Steps: 208 | Train Loss: 3.267 Vali Loss: 4.264 Vali Acc: 0.049 Test Loss: 4.264 Test Acc: 0.049
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.7242754
	speed: 0.6698s/iter; left time: 13029.9218s
	iters: 200, epoch: 7 | loss: 3.6773341
	speed: 0.2685s/iter; left time: 5197.1534s
Epoch: 7 cost time: 58.29610872268677
Epoch: 7, Steps: 208 | Train Loss: 3.426 Vali Loss: 4.134 Vali Acc: 0.061 Test Loss: 4.134 Test Acc: 0.061
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.5489950
	speed: 0.6687s/iter; left time: 12869.1085s
	iters: 200, epoch: 8 | loss: 2.7778997
	speed: 0.3042s/iter; left time: 5824.0463s
Epoch: 8 cost time: 61.565622329711914
Epoch: 8, Steps: 208 | Train Loss: 3.036 Vali Loss: 4.082 Vali Acc: 0.075 Test Loss: 4.082 Test Acc: 0.075
Validation loss decreased (-0.070614 --> -0.074818).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0529211
	speed: 0.7069s/iter; left time: 13457.6321s
	iters: 200, epoch: 9 | loss: 2.5874085
	speed: 0.2584s/iter; left time: 4894.1668s
Epoch: 9 cost time: 58.84135842323303
Epoch: 9, Steps: 208 | Train Loss: 2.693 Vali Loss: 4.219 Vali Acc: 0.070 Test Loss: 4.219 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6323099
	speed: 0.6659s/iter; left time: 12537.3817s
	iters: 200, epoch: 10 | loss: 1.9631138
	speed: 0.2890s/iter; left time: 5412.6171s
Epoch: 10 cost time: 60.22833251953125
Epoch: 10, Steps: 208 | Train Loss: 2.344 Vali Loss: 4.334 Vali Acc: 0.073 Test Loss: 4.334 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.2326024
	speed: 0.6796s/iter; left time: 12655.7224s
	iters: 200, epoch: 11 | loss: 2.1887007
	speed: 0.2919s/iter; left time: 5406.3703s
Epoch: 11 cost time: 60.54896855354309
Epoch: 11, Steps: 208 | Train Loss: 2.027 Vali Loss: 4.624 Vali Acc: 0.079 Test Loss: 4.624 Test Acc: 0.079
Validation loss decreased (-0.074818 --> -0.079286).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1198487
	speed: 0.6801s/iter; left time: 12522.0579s
	iters: 200, epoch: 12 | loss: 2.2735293
	speed: 0.2728s/iter; left time: 4995.0416s
Epoch: 12 cost time: 57.794045209884644
Epoch: 12, Steps: 208 | Train Loss: 1.787 Vali Loss: 5.017 Vali Acc: 0.082 Test Loss: 5.017 Test Acc: 0.082
Validation loss decreased (-0.079286 --> -0.082264).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3514827
	speed: 0.6657s/iter; left time: 12119.1785s
	iters: 200, epoch: 13 | loss: 1.9233148
	speed: 0.2761s/iter; left time: 4999.6894s
Epoch: 13 cost time: 58.422590017318726
Epoch: 13, Steps: 208 | Train Loss: 1.610 Vali Loss: 5.417 Vali Acc: 0.081 Test Loss: 5.417 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5122992
	speed: 0.6573s/iter; left time: 11829.6685s
	iters: 200, epoch: 14 | loss: 1.4905007
	speed: 0.2860s/iter; left time: 5118.6007s
Epoch: 14 cost time: 58.79548501968384
Epoch: 14, Steps: 208 | Train Loss: 1.380 Vali Loss: 5.750 Vali Acc: 0.081 Test Loss: 5.750 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2031574
	speed: 0.6869s/iter; left time: 12219.6980s
	iters: 200, epoch: 15 | loss: 0.7435462
	speed: 0.2741s/iter; left time: 4849.3559s
Epoch: 15 cost time: 58.10953760147095
Epoch: 15, Steps: 208 | Train Loss: 1.250 Vali Loss: 5.701 Vali Acc: 0.082 Test Loss: 5.701 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.7565888
	speed: 0.6542s/iter; left time: 11501.8824s
	iters: 200, epoch: 16 | loss: 0.6928161
	speed: 0.2658s/iter; left time: 4646.2900s
Epoch: 16 cost time: 56.01501107215881
Epoch: 16, Steps: 208 | Train Loss: 1.086 Vali Loss: 6.508 Vali Acc: 0.085 Test Loss: 6.508 Test Acc: 0.085
Validation loss decreased (-0.082264 --> -0.084933).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6302321
	speed: 0.6762s/iter; left time: 11748.3736s
	iters: 200, epoch: 17 | loss: 0.5998701
	speed: 0.2733s/iter; left time: 4720.7430s
Epoch: 17 cost time: 58.14266514778137
Epoch: 17, Steps: 208 | Train Loss: 1.069 Vali Loss: 6.488 Vali Acc: 0.091 Test Loss: 6.488 Test Acc: 0.091
Validation loss decreased (-0.084933 --> -0.090898).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4395252
	speed: 0.6842s/iter; left time: 11745.1271s
	iters: 200, epoch: 18 | loss: 1.2288685
	speed: 0.2835s/iter; left time: 4838.0612s
Epoch: 18 cost time: 59.002891540527344
Epoch: 18, Steps: 208 | Train Loss: 0.975 Vali Loss: 7.205 Vali Acc: 0.086 Test Loss: 7.205 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8509434
	speed: 0.6587s/iter; left time: 11168.7792s
	iters: 200, epoch: 19 | loss: 1.1840484
	speed: 0.2684s/iter; left time: 4524.9766s
Epoch: 19 cost time: 56.465057611465454
Epoch: 19, Steps: 208 | Train Loss: 0.877 Vali Loss: 6.941 Vali Acc: 0.075 Test Loss: 6.941 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6142462
	speed: 0.6740s/iter; left time: 11289.0014s
	iters: 200, epoch: 20 | loss: 1.0751972
	speed: 0.2858s/iter; left time: 4758.5660s
Epoch: 20 cost time: 59.86088180541992
Epoch: 20, Steps: 208 | Train Loss: 0.815 Vali Loss: 7.196 Vali Acc: 0.089 Test Loss: 7.196 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6870706
	speed: 0.6994s/iter; left time: 11569.0939s
	iters: 200, epoch: 21 | loss: 0.6127213
	speed: 0.2742s/iter; left time: 4508.7754s
Epoch: 21 cost time: 58.72856640815735
Epoch: 21, Steps: 208 | Train Loss: 0.736 Vali Loss: 7.528 Vali Acc: 0.080 Test Loss: 7.528 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3235237
	speed: 0.7041s/iter; left time: 11499.7678s
	iters: 200, epoch: 22 | loss: 0.2497589
	speed: 0.2876s/iter; left time: 4669.3311s
Epoch: 22 cost time: 60.24979043006897
Epoch: 22, Steps: 208 | Train Loss: 0.656 Vali Loss: 8.246 Vali Acc: 0.088 Test Loss: 8.246 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.5604258
	speed: 0.7232s/iter; left time: 11661.6219s
	iters: 200, epoch: 23 | loss: 0.7971917
	speed: 0.3016s/iter; left time: 4832.9117s
Epoch: 23 cost time: 63.50959038734436
Epoch: 23, Steps: 208 | Train Loss: 0.633 Vali Loss: 8.466 Vali Acc: 0.092 Test Loss: 8.466 Test Acc: 0.092
Validation loss decreased (-0.090898 --> -0.091773).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2106764
	speed: 0.7421s/iter; left time: 11811.4162s
	iters: 200, epoch: 24 | loss: 0.5524955
	speed: 0.2992s/iter; left time: 4732.8653s
Epoch: 24 cost time: 63.717822551727295
Epoch: 24, Steps: 208 | Train Loss: 0.575 Vali Loss: 7.507 Vali Acc: 0.090 Test Loss: 7.507 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4508851
	speed: 0.7795s/iter; left time: 12244.4645s
	iters: 200, epoch: 25 | loss: 0.9385186
	speed: 0.3109s/iter; left time: 4852.9094s
Epoch: 25 cost time: 65.72872567176819
Epoch: 25, Steps: 208 | Train Loss: 0.568 Vali Loss: 8.546 Vali Acc: 0.086 Test Loss: 8.546 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0692836
	speed: 0.7471s/iter; left time: 11581.2679s
	iters: 200, epoch: 26 | loss: 0.4330134
	speed: 0.3058s/iter; left time: 4709.9501s
Epoch: 26 cost time: 63.55788469314575
Epoch: 26, Steps: 208 | Train Loss: 0.512 Vali Loss: 8.896 Vali Acc: 0.081 Test Loss: 8.896 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3317729
	speed: 0.7306s/iter; left time: 11173.3840s
	iters: 200, epoch: 27 | loss: 0.7511391
	speed: 0.3073s/iter; left time: 4669.2134s
Epoch: 27 cost time: 64.60884237289429
Epoch: 27, Steps: 208 | Train Loss: 0.522 Vali Loss: 8.693 Vali Acc: 0.084 Test Loss: 8.693 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.7129368
	speed: 0.7299s/iter; left time: 11010.3523s
	iters: 200, epoch: 28 | loss: 0.2448505
	speed: 0.2992s/iter; left time: 4483.9046s
Epoch: 28 cost time: 62.94061732292175
Epoch: 28, Steps: 208 | Train Loss: 0.479 Vali Loss: 9.407 Vali Acc: 0.089 Test Loss: 9.407 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2132851
	speed: 0.6972s/iter; left time: 10372.9706s
	iters: 200, epoch: 29 | loss: 0.5463039
	speed: 0.3071s/iter; left time: 4538.2044s
Epoch: 29 cost time: 62.21538162231445
Epoch: 29, Steps: 208 | Train Loss: 0.478 Vali Loss: 8.728 Vali Acc: 0.077 Test Loss: 8.728 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1196173
	speed: 0.7540s/iter; left time: 11060.0353s
	iters: 200, epoch: 30 | loss: 0.8430063
	speed: 0.3093s/iter; left time: 4505.5111s
Epoch: 30 cost time: 65.48015856742859
Epoch: 30, Steps: 208 | Train Loss: 0.427 Vali Loss: 9.441 Vali Acc: 0.092 Test Loss: 9.441 Test Acc: 0.092
Validation loss decreased (-0.091773 --> -0.092062).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.2499592
	speed: 0.7767s/iter; left time: 11231.8985s
	iters: 200, epoch: 31 | loss: 0.5129266
	speed: 0.2891s/iter; left time: 4152.3455s
Epoch: 31 cost time: 62.83402752876282
Epoch: 31, Steps: 208 | Train Loss: 0.429 Vali Loss: 8.886 Vali Acc: 0.095 Test Loss: 8.886 Test Acc: 0.095
Validation loss decreased (-0.092062 --> -0.095348).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.2747377
	speed: 0.7671s/iter; left time: 10933.2581s
	iters: 200, epoch: 32 | loss: 0.5090940
	speed: 0.3099s/iter; left time: 4386.2527s
Epoch: 32 cost time: 65.74602746963501
Epoch: 32, Steps: 208 | Train Loss: 0.419 Vali Loss: 9.471 Vali Acc: 0.091 Test Loss: 9.471 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.9820108
	speed: 0.7110s/iter; left time: 9985.9000s
	iters: 200, epoch: 33 | loss: 0.7248052
	speed: 0.3063s/iter; left time: 4271.7186s
Epoch: 33 cost time: 63.341670989990234
Epoch: 33, Steps: 208 | Train Loss: 0.384 Vali Loss: 9.438 Vali Acc: 0.090 Test Loss: 9.438 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.3904756
	speed: 0.7201s/iter; left time: 9963.5875s
	iters: 200, epoch: 34 | loss: 1.0046924
	speed: 0.3021s/iter; left time: 4149.3395s
Epoch: 34 cost time: 62.772085428237915
Epoch: 34, Steps: 208 | Train Loss: 0.400 Vali Loss: 9.292 Vali Acc: 0.090 Test Loss: 9.292 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.4739094
	speed: 0.7344s/iter; left time: 10008.5355s
	iters: 200, epoch: 35 | loss: 0.4209180
	speed: 0.2944s/iter; left time: 3982.5584s
Epoch: 35 cost time: 62.97232985496521
Epoch: 35, Steps: 208 | Train Loss: 0.358 Vali Loss: 9.787 Vali Acc: 0.084 Test Loss: 9.787 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0822296
	speed: 0.7176s/iter; left time: 9631.5574s
	iters: 200, epoch: 36 | loss: 0.4073468
	speed: 0.3292s/iter; left time: 4385.3403s
Epoch: 36 cost time: 66.8741090297699
Epoch: 36, Steps: 208 | Train Loss: 0.368 Vali Loss: 10.014 Vali Acc: 0.086 Test Loss: 10.014 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0874763
	speed: 0.7973s/iter; left time: 10534.7723s
	iters: 200, epoch: 37 | loss: 0.7325719
	speed: 0.3025s/iter; left time: 3966.9001s
Epoch: 37 cost time: 66.08520603179932
Epoch: 37, Steps: 208 | Train Loss: 0.317 Vali Loss: 10.268 Vali Acc: 0.083 Test Loss: 10.268 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.1258062
	speed: 0.7801s/iter; left time: 10145.7870s
	iters: 200, epoch: 38 | loss: 0.0101415
	speed: 0.3302s/iter; left time: 4261.7760s
Epoch: 38 cost time: 67.72461009025574
Epoch: 38, Steps: 208 | Train Loss: 0.296 Vali Loss: 10.611 Vali Acc: 0.081 Test Loss: 10.611 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.4326029
	speed: 0.7513s/iter; left time: 9614.5518s
	iters: 200, epoch: 39 | loss: 0.2219297
	speed: 0.3223s/iter; left time: 4092.7297s
Epoch: 39 cost time: 66.65598154067993
Epoch: 39, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.300 Vali Acc: 0.089 Test Loss: 10.300 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.3572745
	speed: 0.8014s/iter; left time: 10088.8093s
	iters: 200, epoch: 40 | loss: 0.4741448
	speed: 0.3244s/iter; left time: 4051.3195s
Epoch: 40 cost time: 68.32956051826477
Epoch: 40, Steps: 208 | Train Loss: 0.290 Vali Loss: 10.291 Vali Acc: 0.086 Test Loss: 10.291 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0086842
	speed: 0.6888s/iter; left time: 8528.1027s
	iters: 200, epoch: 41 | loss: 0.0697344
	speed: 0.2846s/iter; left time: 3494.7474s
Epoch: 41 cost time: 60.569650411605835
Epoch: 41, Steps: 208 | Train Loss: 0.284 Vali Loss: 10.131 Vali Acc: 0.086 Test Loss: 10.131 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09543692215926036
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4137197
	speed: 0.3013s/iter; left time: 6236.5614s
	iters: 200, epoch: 1 | loss: 4.8123322
	speed: 0.2912s/iter; left time: 5999.7241s
Epoch: 1 cost time: 61.97046995162964
Epoch: 1, Steps: 208 | Train Loss: 4.730 Vali Loss: 7.153 Vali Acc: 0.071 Test Loss: 7.153 Test Acc: 0.071
Validation loss decreased (inf --> -0.071208).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.7643332
	speed: 0.7461s/iter; left time: 15289.6548s
	iters: 200, epoch: 2 | loss: 6.3103161
	speed: 0.3184s/iter; left time: 6492.8493s
Epoch: 2 cost time: 67.33051323890686
Epoch: 2, Steps: 208 | Train Loss: 4.843 Vali Loss: 7.122 Vali Acc: 0.064 Test Loss: 7.122 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.6842155
	speed: 0.7533s/iter; left time: 15280.2931s
	iters: 200, epoch: 3 | loss: 4.5616231
	speed: 0.3193s/iter; left time: 6444.3877s
Epoch: 3 cost time: 66.22807121276855
Epoch: 3, Steps: 208 | Train Loss: 4.146 Vali Loss: 6.699 Vali Acc: 0.056 Test Loss: 6.699 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3443439
	speed: 0.7913s/iter; left time: 15887.2314s
	iters: 200, epoch: 4 | loss: 3.7722178
	speed: 0.3355s/iter; left time: 6702.2536s
Epoch: 4 cost time: 69.98563051223755
Epoch: 4, Steps: 208 | Train Loss: 3.531 Vali Loss: 5.546 Vali Acc: 0.062 Test Loss: 5.546 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.2174582
	speed: 0.7924s/iter; left time: 15744.0794s
	iters: 200, epoch: 5 | loss: 4.0940375
	speed: 0.3455s/iter; left time: 6830.9876s
Epoch: 5 cost time: 72.17962646484375
Epoch: 5, Steps: 208 | Train Loss: 3.363 Vali Loss: 4.801 Vali Acc: 0.059 Test Loss: 4.801 Test Acc: 0.059
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.9867246
	speed: 0.7840s/iter; left time: 15413.3099s
	iters: 200, epoch: 6 | loss: 4.2012553
	speed: 0.3335s/iter; left time: 6524.0049s
Epoch: 6 cost time: 68.81213116645813
Epoch: 6, Steps: 208 | Train Loss: 3.742 Vali Loss: 4.316 Vali Acc: 0.041 Test Loss: 4.316 Test Acc: 0.041
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 4.1878257
	speed: 0.8570s/iter; left time: 16670.6135s
	iters: 200, epoch: 7 | loss: 4.1672735
	speed: 0.3433s/iter; left time: 6643.1373s
Epoch: 7 cost time: 72.83129477500916
Epoch: 7, Steps: 208 | Train Loss: 4.020 Vali Loss: 4.040 Vali Acc: 0.033 Test Loss: 4.040 Test Acc: 0.033
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 4.2099652
	speed: 0.8449s/iter; left time: 16260.7469s
	iters: 200, epoch: 8 | loss: 3.9376726
	speed: 0.3487s/iter; left time: 6675.7679s
Epoch: 8 cost time: 73.7312228679657
Epoch: 8, Steps: 208 | Train Loss: 3.895 Vali Loss: 3.830 Vali Acc: 0.034 Test Loss: 3.830 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 3.7489898
	speed: 0.8832s/iter; left time: 16814.1470s
	iters: 200, epoch: 9 | loss: 3.5649068
	speed: 0.3525s/iter; left time: 6674.7994s
Epoch: 9 cost time: 75.2005467414856
Epoch: 9, Steps: 208 | Train Loss: 3.863 Vali Loss: 3.763 Vali Acc: 0.033 Test Loss: 3.763 Test Acc: 0.033
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 3.7934628
	speed: 0.8620s/iter; left time: 16231.3610s
	iters: 200, epoch: 10 | loss: 3.5097160
	speed: 0.3506s/iter; left time: 6566.6923s
Epoch: 10 cost time: 74.47253704071045
Epoch: 10, Steps: 208 | Train Loss: 3.786 Vali Loss: 3.806 Vali Acc: 0.035 Test Loss: 3.806 Test Acc: 0.035
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 3.7086289
	speed: 0.8721s/iter; left time: 16239.5277s
	iters: 200, epoch: 11 | loss: 3.6591649
	speed: 0.3500s/iter; left time: 6483.1878s
Epoch: 11 cost time: 74.67851233482361
Epoch: 11, Steps: 208 | Train Loss: 3.748 Vali Loss: 3.733 Vali Acc: 0.040 Test Loss: 3.733 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07127945123769758
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8838537
	speed: 0.3857s/iter; left time: 7983.8647s
	iters: 200, epoch: 1 | loss: 4.9135318
	speed: 0.3393s/iter; left time: 6990.4981s
Epoch: 1 cost time: 75.61879372596741
Epoch: 1, Steps: 208 | Train Loss: 4.643 Vali Loss: 7.583 Vali Acc: 0.040 Test Loss: 7.583 Test Acc: 0.040
Validation loss decreased (inf --> -0.040187).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.3393931
	speed: 0.8498s/iter; left time: 17414.8247s
	iters: 200, epoch: 2 | loss: 4.3944416
	speed: 0.3617s/iter; left time: 7376.3189s
Epoch: 2 cost time: 75.25851082801819
Epoch: 2, Steps: 208 | Train Loss: 4.902 Vali Loss: 7.256 Vali Acc: 0.039 Test Loss: 7.256 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 7.1006236
	speed: 0.8152s/iter; left time: 16537.2866s
	iters: 200, epoch: 3 | loss: 5.5774379
	speed: 0.3258s/iter; left time: 6575.3381s
Epoch: 3 cost time: 69.29178237915039
Epoch: 3, Steps: 208 | Train Loss: 4.567 Vali Loss: 6.577 Vali Acc: 0.048 Test Loss: 6.577 Test Acc: 0.048
Validation loss decreased (-0.040187 --> -0.048249).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.4858332
	speed: 0.8187s/iter; left time: 16436.8500s
	iters: 200, epoch: 4 | loss: 3.6941075
	speed: 0.3247s/iter; left time: 6486.1944s
Epoch: 4 cost time: 70.1131010055542
Epoch: 4, Steps: 208 | Train Loss: 3.942 Vali Loss: 5.863 Vali Acc: 0.052 Test Loss: 5.863 Test Acc: 0.052
Validation loss decreased (-0.048249 --> -0.052432).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4823456
	speed: 0.8320s/iter; left time: 16531.5181s
	iters: 200, epoch: 5 | loss: 4.0418606
	speed: 0.3447s/iter; left time: 6814.8208s
Epoch: 5 cost time: 71.9893126487732
Epoch: 5, Steps: 208 | Train Loss: 3.875 Vali Loss: 4.478 Vali Acc: 0.052 Test Loss: 4.478 Test Acc: 0.052
Validation loss decreased (-0.052432 --> -0.052446).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2310045
	speed: 0.8848s/iter; left time: 17396.1099s
	iters: 200, epoch: 6 | loss: 3.3171215
	speed: 0.3554s/iter; left time: 6951.7998s
Epoch: 6 cost time: 76.16607713699341
Epoch: 6, Steps: 208 | Train Loss: 4.049 Vali Loss: 4.168 Vali Acc: 0.035 Test Loss: 4.168 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7678146
	speed: 0.8370s/iter; left time: 16282.8720s
	iters: 200, epoch: 7 | loss: 3.7462547
	speed: 0.3624s/iter; left time: 7013.9501s
Epoch: 7 cost time: 74.74848651885986
Epoch: 7, Steps: 208 | Train Loss: 4.071 Vali Loss: 3.921 Vali Acc: 0.039 Test Loss: 3.921 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.5918016
	speed: 0.8285s/iter; left time: 15944.4985s
	iters: 200, epoch: 8 | loss: 3.6584923
	speed: 0.3499s/iter; left time: 6698.2869s
Epoch: 8 cost time: 72.84857630729675
Epoch: 8, Steps: 208 | Train Loss: 3.969 Vali Loss: 3.938 Vali Acc: 0.040 Test Loss: 3.938 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.8852534
	speed: 0.8634s/iter; left time: 16437.4733s
	iters: 200, epoch: 9 | loss: 3.4881897
	speed: 0.3669s/iter; left time: 6948.6144s
Epoch: 9 cost time: 75.3676700592041
Epoch: 9, Steps: 208 | Train Loss: 3.883 Vali Loss: 3.914 Vali Acc: 0.038 Test Loss: 3.914 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.8114929
	speed: 0.8324s/iter; left time: 15672.9609s
	iters: 200, epoch: 10 | loss: 3.8864808
	speed: 0.3187s/iter; left time: 5968.5355s
Epoch: 10 cost time: 69.45158553123474
Epoch: 10, Steps: 208 | Train Loss: 3.790 Vali Loss: 3.759 Vali Acc: 0.032 Test Loss: 3.759 Test Acc: 0.032
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.8639243
	speed: 0.8173s/iter; left time: 15218.7632s
	iters: 200, epoch: 11 | loss: 3.6961436
	speed: 0.3525s/iter; left time: 6528.5710s
Epoch: 11 cost time: 72.7911901473999
Epoch: 11, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.676 Vali Acc: 0.048 Test Loss: 3.676 Test Acc: 0.048
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6765203
	speed: 0.8505s/iter; left time: 15660.4940s
	iters: 200, epoch: 12 | loss: 3.7273583
	speed: 0.3698s/iter; left time: 6771.6649s
Epoch: 12 cost time: 75.76293635368347
Epoch: 12, Steps: 208 | Train Loss: 3.611 Vali Loss: 3.654 Vali Acc: 0.046 Test Loss: 3.654 Test Acc: 0.046
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7006943
	speed: 0.8324s/iter; left time: 15154.3862s
	iters: 200, epoch: 13 | loss: 3.3023267
	speed: 0.3356s/iter; left time: 6076.7584s
Epoch: 13 cost time: 71.01532411575317
Epoch: 13, Steps: 208 | Train Loss: 3.565 Vali Loss: 3.632 Vali Acc: 0.056 Test Loss: 3.632 Test Acc: 0.056
Validation loss decreased (-0.052446 --> -0.055735).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.4324980
	speed: 0.8218s/iter; left time: 14789.8319s
	iters: 200, epoch: 14 | loss: 3.6873450
	speed: 0.3412s/iter; left time: 6106.6096s
Epoch: 14 cost time: 71.4404993057251
Epoch: 14, Steps: 208 | Train Loss: 3.532 Vali Loss: 3.610 Vali Acc: 0.063 Test Loss: 3.610 Test Acc: 0.063
Validation loss decreased (-0.055735 --> -0.063191).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.5709989
	speed: 0.8262s/iter; left time: 14697.5739s
	iters: 200, epoch: 15 | loss: 3.5658226
	speed: 0.3234s/iter; left time: 5719.9326s
Epoch: 15 cost time: 68.31806540489197
Epoch: 15, Steps: 208 | Train Loss: 3.502 Vali Loss: 3.599 Vali Acc: 0.064 Test Loss: 3.599 Test Acc: 0.064
Validation loss decreased (-0.063191 --> -0.063787).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.3930900
	speed: 0.8414s/iter; left time: 14791.9223s
	iters: 200, epoch: 16 | loss: 3.5342772
	speed: 0.3382s/iter; left time: 5912.7474s
Epoch: 16 cost time: 72.26604461669922
Epoch: 16, Steps: 208 | Train Loss: 3.463 Vali Loss: 3.578 Vali Acc: 0.058 Test Loss: 3.578 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 3.5572572
	speed: 0.7926s/iter; left time: 13770.5840s
	iters: 200, epoch: 17 | loss: 3.7100613
	speed: 0.3412s/iter; left time: 5893.5646s
Epoch: 17 cost time: 70.95187258720398
Epoch: 17, Steps: 208 | Train Loss: 3.440 Vali Loss: 3.588 Vali Acc: 0.061 Test Loss: 3.588 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 3.2018390
	speed: 0.8368s/iter; left time: 14364.2460s
	iters: 200, epoch: 18 | loss: 3.2206657
	speed: 0.3434s/iter; left time: 5859.3294s
Epoch: 18 cost time: 72.36196732521057
Epoch: 18, Steps: 208 | Train Loss: 3.385 Vali Loss: 3.627 Vali Acc: 0.063 Test Loss: 3.627 Test Acc: 0.063
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 3.3907475
	speed: 0.8496s/iter; left time: 14406.3705s
	iters: 200, epoch: 19 | loss: 3.5224361
	speed: 0.3515s/iter; left time: 5925.7434s
Epoch: 19 cost time: 75.11298060417175
Epoch: 19, Steps: 208 | Train Loss: 3.371 Vali Loss: 3.571 Vali Acc: 0.058 Test Loss: 3.571 Test Acc: 0.058
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 3.1572456
	speed: 0.8408s/iter; left time: 14082.4656s
	iters: 200, epoch: 20 | loss: 3.3190966
	speed: 0.3382s/iter; left time: 5630.2520s
Epoch: 20 cost time: 70.86805558204651
Epoch: 20, Steps: 208 | Train Loss: 3.291 Vali Loss: 3.653 Vali Acc: 0.067 Test Loss: 3.653 Test Acc: 0.067
Validation loss decreased (-0.063787 --> -0.067068).  Saving model ...
	iters: 100, epoch: 21 | loss: 3.2470953
	speed: 0.8491s/iter; left time: 14044.3525s
	iters: 200, epoch: 21 | loss: 3.4001672
	speed: 0.3618s/iter; left time: 5949.1090s
Epoch: 21 cost time: 76.12647271156311
Epoch: 21, Steps: 208 | Train Loss: 3.205 Vali Loss: 3.639 Vali Acc: 0.069 Test Loss: 3.639 Test Acc: 0.069
Validation loss decreased (-0.067068 --> -0.068857).  Saving model ...
	iters: 100, epoch: 22 | loss: 3.0240395
	speed: 0.8724s/iter; left time: 14248.8462s
	iters: 200, epoch: 22 | loss: 3.1227119
	speed: 0.3505s/iter; left time: 5690.1474s
Epoch: 22 cost time: 74.67145466804504
Epoch: 22, Steps: 208 | Train Loss: 3.113 Vali Loss: 3.659 Vali Acc: 0.068 Test Loss: 3.659 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 3.0315685
	speed: 0.8325s/iter; left time: 13423.2760s
	iters: 200, epoch: 23 | loss: 2.6083989
	speed: 0.3401s/iter; left time: 5449.8216s
Epoch: 23 cost time: 71.86327385902405
Epoch: 23, Steps: 208 | Train Loss: 2.979 Vali Loss: 3.822 Vali Acc: 0.067 Test Loss: 3.822 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.3393264
	speed: 0.8341s/iter; left time: 13275.9074s
	iters: 200, epoch: 24 | loss: 2.8599536
	speed: 0.3618s/iter; left time: 5723.3372s
Epoch: 24 cost time: 75.04105615615845
Epoch: 24, Steps: 208 | Train Loss: 2.869 Vali Loss: 3.862 Vali Acc: 0.062 Test Loss: 3.862 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 2.2019770
	speed: 0.8656s/iter; left time: 13598.4101s
	iters: 200, epoch: 25 | loss: 2.2795177
	speed: 0.3352s/iter; left time: 5231.7010s
Epoch: 25 cost time: 72.42095351219177
Epoch: 25, Steps: 208 | Train Loss: 2.673 Vali Loss: 4.077 Vali Acc: 0.073 Test Loss: 4.077 Test Acc: 0.073
Validation loss decreased (-0.068857 --> -0.073028).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.9697626
	speed: 0.8180s/iter; left time: 12680.0380s
	iters: 200, epoch: 26 | loss: 2.4045150
	speed: 0.3390s/iter; left time: 5221.5428s
Epoch: 26 cost time: 71.99822068214417
Epoch: 26, Steps: 208 | Train Loss: 2.523 Vali Loss: 4.196 Vali Acc: 0.072 Test Loss: 4.196 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.9800975
	speed: 0.8047s/iter; left time: 12306.1467s
	iters: 200, epoch: 27 | loss: 2.6680655
	speed: 0.3409s/iter; left time: 5178.7143s
Epoch: 27 cost time: 70.72467541694641
Epoch: 27, Steps: 208 | Train Loss: 2.243 Vali Loss: 4.399 Vali Acc: 0.069 Test Loss: 4.399 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 2.4423337
	speed: 0.8445s/iter; left time: 12739.4670s
	iters: 200, epoch: 28 | loss: 2.2263305
	speed: 0.3416s/iter; left time: 5118.3738s
Epoch: 28 cost time: 72.21218729019165
Epoch: 28, Steps: 208 | Train Loss: 2.039 Vali Loss: 4.957 Vali Acc: 0.067 Test Loss: 4.957 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.7715408
	speed: 0.8210s/iter; left time: 12213.3297s
	iters: 200, epoch: 29 | loss: 2.2551968
	speed: 0.3566s/iter; left time: 5270.1801s
Epoch: 29 cost time: 73.40500569343567
Epoch: 29, Steps: 208 | Train Loss: 1.739 Vali Loss: 5.509 Vali Acc: 0.069 Test Loss: 5.509 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.6156549
	speed: 0.8636s/iter; left time: 12668.3938s
	iters: 200, epoch: 30 | loss: 1.5001842
	speed: 0.3556s/iter; left time: 5180.3408s
Epoch: 30 cost time: 75.04745078086853
Epoch: 30, Steps: 208 | Train Loss: 1.431 Vali Loss: 5.920 Vali Acc: 0.072 Test Loss: 5.920 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.7654129
	speed: 0.8670s/iter; left time: 12538.0685s
	iters: 200, epoch: 31 | loss: 1.3653287
	speed: 0.3544s/iter; left time: 5089.0251s
Epoch: 31 cost time: 74.89351844787598
Epoch: 31, Steps: 208 | Train Loss: 1.161 Vali Loss: 6.450 Vali Acc: 0.068 Test Loss: 6.450 Test Acc: 0.068
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.7441761
	speed: 0.8425s/iter; left time: 12008.7663s
	iters: 200, epoch: 32 | loss: 1.5371701
	speed: 0.3403s/iter; left time: 4815.7257s
Epoch: 32 cost time: 72.63006114959717
Epoch: 32, Steps: 208 | Train Loss: 0.916 Vali Loss: 7.297 Vali Acc: 0.066 Test Loss: 7.297 Test Acc: 0.066
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.5707988
	speed: 0.8914s/iter; left time: 12519.2753s
	iters: 200, epoch: 33 | loss: 1.1235365
	speed: 0.3503s/iter; left time: 4884.3035s
Epoch: 33 cost time: 75.86418461799622
Epoch: 33, Steps: 208 | Train Loss: 0.788 Vali Loss: 7.670 Vali Acc: 0.066 Test Loss: 7.670 Test Acc: 0.066
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 1.0191840
	speed: 0.8639s/iter; left time: 11953.9160s
	iters: 200, epoch: 34 | loss: 0.6933839
	speed: 0.3490s/iter; left time: 4794.4429s
Epoch: 34 cost time: 74.65127110481262
Epoch: 34, Steps: 208 | Train Loss: 0.648 Vali Loss: 8.467 Vali Acc: 0.063 Test Loss: 8.467 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.2871793
	speed: 0.8507s/iter; left time: 11594.2968s
	iters: 200, epoch: 35 | loss: 0.9499515
	speed: 0.3605s/iter; left time: 4877.2516s
Epoch: 35 cost time: 74.6985354423523
Epoch: 35, Steps: 208 | Train Loss: 0.531 Vali Loss: 8.873 Vali Acc: 0.061 Test Loss: 8.873 Test Acc: 0.061
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07306889352818371
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8309283
	speed: 0.3810s/iter; left time: 7887.8021s
	iters: 200, epoch: 1 | loss: 4.8344221
	speed: 0.3374s/iter; left time: 6950.0044s
Epoch: 1 cost time: 74.83725023269653
Epoch: 1, Steps: 208 | Train Loss: 4.469 Vali Loss: 9.268 Vali Acc: 0.033 Test Loss: 9.268 Test Acc: 0.033
Validation loss decreased (inf --> -0.033310).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.0035224
	speed: 0.8012s/iter; left time: 16418.8528s
	iters: 200, epoch: 2 | loss: 5.6828766
	speed: 0.3497s/iter; left time: 7131.0999s
Epoch: 2 cost time: 71.89855790138245
Epoch: 2, Steps: 208 | Train Loss: 5.096 Vali Loss: 8.932 Vali Acc: 0.052 Test Loss: 8.932 Test Acc: 0.052
Validation loss decreased (-0.033310 --> -0.051805).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.9747782
	speed: 0.8301s/iter; left time: 16838.0922s
	iters: 200, epoch: 3 | loss: 6.2371221
	speed: 0.3583s/iter; left time: 7232.9641s
Epoch: 3 cost time: 73.03096389770508
Epoch: 3, Steps: 208 | Train Loss: 5.315 Vali Loss: 7.047 Vali Acc: 0.046 Test Loss: 7.047 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.3695426
	speed: 0.8693s/iter; left time: 17452.5101s
	iters: 200, epoch: 4 | loss: 3.9208748
	speed: 0.3611s/iter; left time: 7212.7093s
Epoch: 4 cost time: 75.0451009273529
Epoch: 4, Steps: 208 | Train Loss: 4.566 Vali Loss: 4.998 Vali Acc: 0.048 Test Loss: 4.998 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.2388644
	speed: 0.8485s/iter; left time: 16858.9736s
	iters: 200, epoch: 5 | loss: 3.6602864
	speed: 0.3579s/iter; left time: 7075.6342s
Epoch: 5 cost time: 73.99325156211853
Epoch: 5, Steps: 208 | Train Loss: 4.345 Vali Loss: 4.667 Vali Acc: 0.033 Test Loss: 4.667 Test Acc: 0.033
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.2678781
	speed: 0.8696s/iter; left time: 17098.0398s
	iters: 200, epoch: 6 | loss: 3.8019385
	speed: 0.3580s/iter; left time: 7003.0556s
Epoch: 6 cost time: 74.35053610801697
Epoch: 6, Steps: 208 | Train Loss: 4.318 Vali Loss: 4.175 Vali Acc: 0.038 Test Loss: 4.175 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.6969814
	speed: 0.9095s/iter; left time: 17692.6648s
	iters: 200, epoch: 7 | loss: 3.5855157
	speed: 0.3545s/iter; left time: 6860.1407s
Epoch: 7 cost time: 75.4444682598114
Epoch: 7, Steps: 208 | Train Loss: 4.081 Vali Loss: 3.901 Vali Acc: 0.036 Test Loss: 3.901 Test Acc: 0.036
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.6032972
	speed: 0.8638s/iter; left time: 16623.1908s
	iters: 200, epoch: 8 | loss: 3.7221885
	speed: 0.3205s/iter; left time: 6135.7289s
Epoch: 8 cost time: 69.95046639442444
Epoch: 8, Steps: 208 | Train Loss: 3.943 Vali Loss: 3.851 Vali Acc: 0.040 Test Loss: 3.851 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.7655632
	speed: 0.8701s/iter; left time: 16564.8205s
	iters: 200, epoch: 9 | loss: 3.3854229
	speed: 0.3527s/iter; left time: 6679.9265s
Epoch: 9 cost time: 75.45236825942993
Epoch: 9, Steps: 208 | Train Loss: 3.860 Vali Loss: 3.798 Vali Acc: 0.035 Test Loss: 3.798 Test Acc: 0.035
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.8174772
	speed: 0.8755s/iter; left time: 16484.7095s
	iters: 200, epoch: 10 | loss: 3.6623368
	speed: 0.3635s/iter; left time: 6807.2905s
Epoch: 10 cost time: 75.73145318031311
Epoch: 10, Steps: 208 | Train Loss: 3.753 Vali Loss: 3.732 Vali Acc: 0.034 Test Loss: 3.732 Test Acc: 0.034
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.7855339
	speed: 0.8260s/iter; left time: 15380.4332s
	iters: 200, epoch: 11 | loss: 3.6272404
	speed: 0.3450s/iter; left time: 6390.1187s
Epoch: 11 cost time: 71.21246910095215
Epoch: 11, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.707 Vali Acc: 0.040 Test Loss: 3.707 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.7956357
	speed: 0.8538s/iter; left time: 15721.8652s
	iters: 200, epoch: 12 | loss: 3.6011295
	speed: 0.3330s/iter; left time: 6099.0800s
Epoch: 12 cost time: 71.6040587425232
Epoch: 12, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.709 Vali Acc: 0.037 Test Loss: 3.709 Test Acc: 0.037
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05189382642409782
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9231043
	speed: 0.3546s/iter; left time: 7340.8447s
	iters: 200, epoch: 1 | loss: 4.5893545
	speed: 0.3504s/iter; left time: 7217.7560s
Epoch: 1 cost time: 73.77623677253723
Epoch: 1, Steps: 208 | Train Loss: 4.430 Vali Loss: 7.168 Vali Acc: 0.037 Test Loss: 7.168 Test Acc: 0.037
Validation loss decreased (inf --> -0.037208).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.7194347
	speed: 0.8329s/iter; left time: 17067.8255s
	iters: 200, epoch: 2 | loss: 6.0097718
	speed: 0.3441s/iter; left time: 7016.9732s
Epoch: 2 cost time: 71.6478681564331
Epoch: 2, Steps: 208 | Train Loss: 4.845 Vali Loss: 9.419 Vali Acc: 0.049 Test Loss: 9.419 Test Acc: 0.049
Validation loss decreased (-0.037208 --> -0.048519).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.7643342
	speed: 0.8811s/iter; left time: 17872.1696s
	iters: 200, epoch: 3 | loss: 7.8526249
	speed: 0.3625s/iter; left time: 7316.8276s
Epoch: 3 cost time: 76.0276312828064
Epoch: 3, Steps: 208 | Train Loss: 5.272 Vali Loss: 10.852 Vali Acc: 0.050 Test Loss: 10.852 Test Acc: 0.050
Validation loss decreased (-0.048519 --> -0.049399).  Saving model ...
	iters: 100, epoch: 4 | loss: 5.4788723
	speed: 0.8702s/iter; left time: 17470.3448s
	iters: 200, epoch: 4 | loss: 3.7960782
	speed: 0.3497s/iter; left time: 6986.9432s
Epoch: 4 cost time: 73.96471118927002
Epoch: 4, Steps: 208 | Train Loss: 5.060 Vali Loss: 9.876 Vali Acc: 0.055 Test Loss: 9.876 Test Acc: 0.055
Validation loss decreased (-0.049399 --> -0.054777).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.8806720
	speed: 0.8399s/iter; left time: 16687.6614s
	iters: 200, epoch: 5 | loss: 4.1382685
	speed: 0.3749s/iter; left time: 7411.2135s
Epoch: 5 cost time: 75.80130863189697
Epoch: 5, Steps: 208 | Train Loss: 4.247 Vali Loss: 4.912 Vali Acc: 0.052 Test Loss: 4.912 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3229117
	speed: 0.8728s/iter; left time: 17159.2545s
	iters: 200, epoch: 6 | loss: 4.2125154
	speed: 0.3688s/iter; left time: 7213.7817s
Epoch: 6 cost time: 76.14331221580505
Epoch: 6, Steps: 208 | Train Loss: 4.171 Vali Loss: 4.132 Vali Acc: 0.026 Test Loss: 4.132 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.8506951
	speed: 0.8519s/iter; left time: 16572.4148s
	iters: 200, epoch: 7 | loss: 4.0055943
	speed: 0.3725s/iter; left time: 7209.4232s
Epoch: 7 cost time: 75.73890447616577
Epoch: 7, Steps: 208 | Train Loss: 4.234 Vali Loss: 4.012 Vali Acc: 0.025 Test Loss: 4.012 Test Acc: 0.025
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.5341475
	speed: 0.8504s/iter; left time: 16365.1424s
	iters: 200, epoch: 8 | loss: 4.0249820
	speed: 0.3798s/iter; left time: 7270.9130s
Epoch: 8 cost time: 76.13449335098267
Epoch: 8, Steps: 208 | Train Loss: 3.990 Vali Loss: 3.840 Vali Acc: 0.029 Test Loss: 3.840 Test Acc: 0.029
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.8594425
	speed: 0.8765s/iter; left time: 16686.7015s
	iters: 200, epoch: 9 | loss: 3.7731402
	speed: 0.3526s/iter; left time: 6677.0773s
Epoch: 9 cost time: 74.24016880989075
Epoch: 9, Steps: 208 | Train Loss: 3.877 Vali Loss: 3.854 Vali Acc: 0.032 Test Loss: 3.854 Test Acc: 0.032
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7603869
	speed: 0.8664s/iter; left time: 16312.8604s
	iters: 200, epoch: 10 | loss: 3.8135297
	speed: 0.3455s/iter; left time: 6470.4309s
Epoch: 10 cost time: 73.43296098709106
Epoch: 10, Steps: 208 | Train Loss: 3.833 Vali Loss: 3.789 Vali Acc: 0.026 Test Loss: 3.789 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7535100
	speed: 0.8488s/iter; left time: 15805.9740s
	iters: 200, epoch: 11 | loss: 3.7906170
	speed: 0.3519s/iter; left time: 6516.9266s
Epoch: 11 cost time: 74.2615110874176
Epoch: 11, Steps: 208 | Train Loss: 3.798 Vali Loss: 3.765 Vali Acc: 0.022 Test Loss: 3.765 Test Acc: 0.022
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.8919411
	speed: 0.8639s/iter; left time: 15907.6661s
	iters: 200, epoch: 12 | loss: 3.6875217
	speed: 0.3490s/iter; left time: 6391.8767s
Epoch: 12 cost time: 74.04131960868835
Epoch: 12, Steps: 208 | Train Loss: 3.771 Vali Loss: 3.751 Vali Acc: 0.030 Test Loss: 3.751 Test Acc: 0.030
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7789755
	speed: 0.8609s/iter; left time: 15671.9220s
	iters: 200, epoch: 13 | loss: 3.7029366
	speed: 0.3501s/iter; left time: 6337.9330s
Epoch: 13 cost time: 74.01327919960022
Epoch: 13, Steps: 208 | Train Loss: 3.738 Vali Loss: 3.718 Vali Acc: 0.034 Test Loss: 3.718 Test Acc: 0.034
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.9070649
	speed: 0.8649s/iter; left time: 15566.1716s
	iters: 200, epoch: 14 | loss: 3.6620088
	speed: 0.3694s/iter; left time: 6610.2933s
Epoch: 14 cost time: 77.6586422920227
Epoch: 14, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.696 Vali Acc: 0.030 Test Loss: 3.696 Test Acc: 0.030
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05487623024157471
model parameter : 15647271
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.5555882
	speed: 0.3370s/iter; left time: 6977.2423s
	iters: 200, epoch: 1 | loss: 5.0952511
	speed: 0.3286s/iter; left time: 6769.5540s
Epoch: 1 cost time: 69.53569889068604
Epoch: 1, Steps: 208 | Train Loss: 5.455 Vali Loss: 6.208 Vali Acc: 0.068 Test Loss: 6.208 Test Acc: 0.068
Validation loss decreased (inf --> -0.068235).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.3432703
	speed: 0.8740s/iter; left time: 17911.4102s
	iters: 200, epoch: 2 | loss: 4.9082823
	speed: 0.3403s/iter; left time: 6938.9256s
Epoch: 2 cost time: 72.97559237480164
Epoch: 2, Steps: 208 | Train Loss: 5.050 Vali Loss: 6.688 Vali Acc: 0.055 Test Loss: 6.688 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3345032
	speed: 0.9030s/iter; left time: 18318.1776s
	iters: 200, epoch: 3 | loss: 3.4233375
	speed: 0.3578s/iter; left time: 7221.4712s
Epoch: 3 cost time: 76.74239325523376
Epoch: 3, Steps: 208 | Train Loss: 3.817 Vali Loss: 6.251 Vali Acc: 0.073 Test Loss: 6.251 Test Acc: 0.073
Validation loss decreased (-0.068235 --> -0.073305).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6374326
	speed: 0.9043s/iter; left time: 18156.1569s
	iters: 200, epoch: 4 | loss: 3.5626388
	speed: 0.3553s/iter; left time: 7096.8365s
Epoch: 4 cost time: 76.956946849823
Epoch: 4, Steps: 208 | Train Loss: 2.963 Vali Loss: 6.345 Vali Acc: 0.077 Test Loss: 6.345 Test Acc: 0.077
Validation loss decreased (-0.073305 --> -0.077181).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8474116
	speed: 0.8473s/iter; left time: 16834.1191s
	iters: 200, epoch: 5 | loss: 2.8957293
	speed: 0.3740s/iter; left time: 7392.8359s
Epoch: 5 cost time: 76.46925163269043
Epoch: 5, Steps: 208 | Train Loss: 2.311 Vali Loss: 6.384 Vali Acc: 0.074 Test Loss: 6.384 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.7414377
	speed: 0.8818s/iter; left time: 17337.2885s
	iters: 200, epoch: 6 | loss: 2.6286123
	speed: 0.3715s/iter; left time: 7266.8653s
Epoch: 6 cost time: 77.16745114326477
Epoch: 6, Steps: 208 | Train Loss: 1.905 Vali Loss: 6.739 Vali Acc: 0.076 Test Loss: 6.739 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.6256850
	speed: 0.8521s/iter; left time: 16576.7727s
	iters: 200, epoch: 7 | loss: 2.5484376
	speed: 0.3498s/iter; left time: 6769.7403s
Epoch: 7 cost time: 72.87938404083252
Epoch: 7, Steps: 208 | Train Loss: 1.644 Vali Loss: 6.649 Vali Acc: 0.071 Test Loss: 6.649 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0912502
	speed: 0.8581s/iter; left time: 16513.8573s
	iters: 200, epoch: 8 | loss: 0.9837092
	speed: 0.3508s/iter; left time: 6716.7948s
Epoch: 8 cost time: 73.67132472991943
Epoch: 8, Steps: 208 | Train Loss: 1.303 Vali Loss: 7.412 Vali Acc: 0.075 Test Loss: 7.412 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7187235
	speed: 0.8586s/iter; left time: 16345.4882s
	iters: 200, epoch: 9 | loss: 0.9279318
	speed: 0.3672s/iter; left time: 6954.3375s
Epoch: 9 cost time: 75.10193872451782
Epoch: 9, Steps: 208 | Train Loss: 1.153 Vali Loss: 7.899 Vali Acc: 0.075 Test Loss: 7.899 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.8293111
	speed: 0.8607s/iter; left time: 16205.2573s
	iters: 200, epoch: 10 | loss: 1.3472224
	speed: 0.3506s/iter; left time: 6566.2062s
Epoch: 10 cost time: 74.23901653289795
Epoch: 10, Steps: 208 | Train Loss: 0.959 Vali Loss: 8.191 Vali Acc: 0.076 Test Loss: 8.191 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.8317237
	speed: 0.8776s/iter; left time: 16341.5884s
	iters: 200, epoch: 11 | loss: 0.5955281
	speed: 0.3663s/iter; left time: 6784.1332s
Epoch: 11 cost time: 76.66684103012085
Epoch: 11, Steps: 208 | Train Loss: 0.882 Vali Loss: 8.990 Vali Acc: 0.075 Test Loss: 8.990 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.1167550
	speed: 0.8933s/iter; left time: 16447.9600s
	iters: 200, epoch: 12 | loss: 0.7959376
	speed: 0.3438s/iter; left time: 6295.8098s
Epoch: 12 cost time: 73.07704019546509
Epoch: 12, Steps: 208 | Train Loss: 0.808 Vali Loss: 9.310 Vali Acc: 0.068 Test Loss: 9.310 Test Acc: 0.068
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5015662
	speed: 0.8670s/iter; left time: 15784.3863s
	iters: 200, epoch: 13 | loss: 0.2042721
	speed: 0.3481s/iter; left time: 6302.3409s
Epoch: 13 cost time: 72.63404631614685
Epoch: 13, Steps: 208 | Train Loss: 0.748 Vali Loss: 9.443 Vali Acc: 0.075 Test Loss: 9.443 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.3321728
	speed: 0.8534s/iter; left time: 15358.4902s
	iters: 200, epoch: 14 | loss: 0.4489024
	speed: 0.3372s/iter; left time: 6034.3895s
Epoch: 14 cost time: 71.91025757789612
Epoch: 14, Steps: 208 | Train Loss: 0.666 Vali Loss: 9.699 Vali Acc: 0.076 Test Loss: 9.699 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07724425887265135
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.9973450
	speed: 0.3581s/iter; left time: 7413.2776s
	iters: 200, epoch: 1 | loss: 5.8688455
	speed: 0.3423s/iter; left time: 7052.4393s
Epoch: 1 cost time: 72.95639133453369
Epoch: 1, Steps: 208 | Train Loss: 5.495 Vali Loss: 6.348 Vali Acc: 0.065 Test Loss: 6.348 Test Acc: 0.065
Validation loss decreased (inf --> -0.065251).  Saving model ...
	iters: 100, epoch: 2 | loss: 7.0948334
	speed: 0.8220s/iter; left time: 16844.4352s
	iters: 200, epoch: 2 | loss: 4.5817838
	speed: 0.3419s/iter; left time: 6972.3467s
Epoch: 2 cost time: 70.77762818336487
Epoch: 2, Steps: 208 | Train Loss: 5.065 Vali Loss: 6.733 Vali Acc: 0.047 Test Loss: 6.733 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2949667
	speed: 0.8013s/iter; left time: 16253.4641s
	iters: 200, epoch: 3 | loss: 4.9954710
	speed: 0.3280s/iter; left time: 6621.2183s
Epoch: 3 cost time: 68.11760115623474
Epoch: 3, Steps: 208 | Train Loss: 3.907 Vali Loss: 6.185 Vali Acc: 0.068 Test Loss: 6.185 Test Acc: 0.068
Validation loss decreased (-0.065251 --> -0.067639).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5844699
	speed: 0.8252s/iter; left time: 16568.3106s
	iters: 200, epoch: 4 | loss: 2.5823419
	speed: 0.3525s/iter; left time: 7041.6529s
Epoch: 4 cost time: 72.61599707603455
Epoch: 4, Steps: 208 | Train Loss: 3.020 Vali Loss: 6.444 Vali Acc: 0.079 Test Loss: 6.444 Test Acc: 0.079
Validation loss decreased (-0.067639 --> -0.078671).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2022605
	speed: 0.8516s/iter; left time: 16920.5867s
	iters: 200, epoch: 5 | loss: 3.5501373
	speed: 0.3505s/iter; left time: 6928.6994s
Epoch: 5 cost time: 72.42605209350586
Epoch: 5, Steps: 208 | Train Loss: 2.307 Vali Loss: 6.359 Vali Acc: 0.065 Test Loss: 6.359 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.0650058
	speed: 0.8655s/iter; left time: 17016.4572s
	iters: 200, epoch: 6 | loss: 2.0729110
	speed: 0.3426s/iter; left time: 6701.1244s
Epoch: 6 cost time: 73.05614590644836
Epoch: 6, Steps: 208 | Train Loss: 1.946 Vali Loss: 6.513 Vali Acc: 0.071 Test Loss: 6.513 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.5425460
	speed: 0.8383s/iter; left time: 16307.8240s
	iters: 200, epoch: 7 | loss: 3.1561844
	speed: 0.3434s/iter; left time: 6645.6560s
Epoch: 7 cost time: 71.87475323677063
Epoch: 7, Steps: 208 | Train Loss: 1.669 Vali Loss: 6.724 Vali Acc: 0.077 Test Loss: 6.724 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6818681
	speed: 0.8409s/iter; left time: 16183.4191s
	iters: 200, epoch: 8 | loss: 1.0208184
	speed: 0.3502s/iter; left time: 6704.4992s
Epoch: 8 cost time: 72.97909927368164
Epoch: 8, Steps: 208 | Train Loss: 1.355 Vali Loss: 7.651 Vali Acc: 0.078 Test Loss: 7.651 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9576498
	speed: 0.8505s/iter; left time: 16191.6676s
	iters: 200, epoch: 9 | loss: 1.3057325
	speed: 0.3409s/iter; left time: 6455.6165s
Epoch: 9 cost time: 71.29148864746094
Epoch: 9, Steps: 208 | Train Loss: 1.154 Vali Loss: 7.548 Vali Acc: 0.074 Test Loss: 7.548 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6281038
	speed: 0.8530s/iter; left time: 16060.6796s
	iters: 200, epoch: 10 | loss: 1.5668687
	speed: 0.3409s/iter; left time: 6383.8787s
Epoch: 10 cost time: 71.75796747207642
Epoch: 10, Steps: 208 | Train Loss: 1.028 Vali Loss: 8.313 Vali Acc: 0.080 Test Loss: 8.313 Test Acc: 0.080
Validation loss decreased (-0.078671 --> -0.079845).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2757572
	speed: 0.8465s/iter; left time: 15763.0972s
	iters: 200, epoch: 11 | loss: 1.4731151
	speed: 0.3528s/iter; left time: 6533.6950s
Epoch: 11 cost time: 73.52190852165222
Epoch: 11, Steps: 208 | Train Loss: 0.906 Vali Loss: 8.530 Vali Acc: 0.081 Test Loss: 8.530 Test Acc: 0.081
Validation loss decreased (-0.079845 --> -0.080738).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6068425
	speed: 0.8527s/iter; left time: 15701.6569s
	iters: 200, epoch: 12 | loss: 0.8905382
	speed: 0.3402s/iter; left time: 6229.9969s
Epoch: 12 cost time: 71.09285044670105
Epoch: 12, Steps: 208 | Train Loss: 0.849 Vali Loss: 9.016 Vali Acc: 0.073 Test Loss: 9.016 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2539217
	speed: 0.8473s/iter; left time: 15425.7348s
	iters: 200, epoch: 13 | loss: 0.8452939
	speed: 0.3394s/iter; left time: 6144.3245s
Epoch: 13 cost time: 71.79321050643921
Epoch: 13, Steps: 208 | Train Loss: 0.775 Vali Loss: 9.154 Vali Acc: 0.074 Test Loss: 9.154 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8336135
	speed: 0.8542s/iter; left time: 15373.5855s
	iters: 200, epoch: 14 | loss: 0.4074734
	speed: 0.3454s/iter; left time: 6182.3801s
Epoch: 14 cost time: 73.66540694236755
Epoch: 14, Steps: 208 | Train Loss: 0.686 Vali Loss: 9.836 Vali Acc: 0.078 Test Loss: 9.836 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2104101
	speed: 0.8391s/iter; left time: 14926.1098s
	iters: 200, epoch: 15 | loss: 0.4890160
	speed: 0.3379s/iter; left time: 5977.4291s
Epoch: 15 cost time: 71.30706238746643
Epoch: 15, Steps: 208 | Train Loss: 0.729 Vali Loss: 9.455 Vali Acc: 0.082 Test Loss: 9.455 Test Acc: 0.082
Validation loss decreased (-0.080738 --> -0.081623).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2626323
	speed: 0.8418s/iter; left time: 14799.3170s
	iters: 200, epoch: 16 | loss: 0.3777942
	speed: 0.3318s/iter; left time: 5799.9940s
Epoch: 16 cost time: 70.89312887191772
Epoch: 16, Steps: 208 | Train Loss: 0.634 Vali Loss: 9.941 Vali Acc: 0.078 Test Loss: 9.941 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6199320
	speed: 0.8648s/iter; left time: 15023.4566s
	iters: 200, epoch: 17 | loss: 1.0270857
	speed: 0.3385s/iter; left time: 5846.6849s
Epoch: 17 cost time: 73.10428714752197
Epoch: 17, Steps: 208 | Train Loss: 0.583 Vali Loss: 10.008 Vali Acc: 0.078 Test Loss: 10.008 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5483135
	speed: 0.8407s/iter; left time: 14429.8691s
	iters: 200, epoch: 18 | loss: 0.1834579
	speed: 0.3409s/iter; left time: 5816.7132s
Epoch: 18 cost time: 71.64247226715088
Epoch: 18, Steps: 208 | Train Loss: 0.594 Vali Loss: 10.624 Vali Acc: 0.084 Test Loss: 10.624 Test Acc: 0.084
Validation loss decreased (-0.081623 --> -0.084296).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4139636
	speed: 0.8182s/iter; left time: 13874.9124s
	iters: 200, epoch: 19 | loss: 0.5130563
	speed: 0.3487s/iter; left time: 5878.5096s
Epoch: 19 cost time: 70.77768349647522
Epoch: 19, Steps: 208 | Train Loss: 0.575 Vali Loss: 10.092 Vali Acc: 0.079 Test Loss: 10.092 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0135149
	speed: 0.8641s/iter; left time: 14473.6325s
	iters: 200, epoch: 20 | loss: 1.4998217
	speed: 0.3449s/iter; left time: 5742.1159s
Epoch: 20 cost time: 73.4418580532074
Epoch: 20, Steps: 208 | Train Loss: 0.523 Vali Loss: 10.161 Vali Acc: 0.074 Test Loss: 10.161 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0414046
	speed: 0.8258s/iter; left time: 13659.0843s
	iters: 200, epoch: 21 | loss: 0.1870302
	speed: 0.3276s/iter; left time: 5385.4501s
Epoch: 21 cost time: 69.80449628829956
Epoch: 21, Steps: 208 | Train Loss: 0.570 Vali Loss: 10.604 Vali Acc: 0.072 Test Loss: 10.604 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.2076203
	speed: 0.7896s/iter; left time: 12896.7445s
	iters: 200, epoch: 22 | loss: 1.3158797
	speed: 0.3334s/iter; left time: 5412.7695s
Epoch: 22 cost time: 69.72213387489319
Epoch: 22, Steps: 208 | Train Loss: 0.523 Vali Loss: 10.709 Vali Acc: 0.083 Test Loss: 10.709 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.8252008
	speed: 0.8247s/iter; left time: 13297.6164s
	iters: 200, epoch: 23 | loss: 0.1845689
	speed: 0.3345s/iter; left time: 5361.1523s
Epoch: 23 cost time: 70.60566759109497
Epoch: 23, Steps: 208 | Train Loss: 0.560 Vali Loss: 10.429 Vali Acc: 0.088 Test Loss: 10.429 Test Acc: 0.088
Validation loss decreased (-0.084296 --> -0.087578).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.1231129
	speed: 0.8034s/iter; left time: 12787.3591s
	iters: 200, epoch: 24 | loss: 0.3338300
	speed: 0.3490s/iter; left time: 5520.2167s
Epoch: 24 cost time: 72.54280757904053
Epoch: 24, Steps: 208 | Train Loss: 0.514 Vali Loss: 10.693 Vali Acc: 0.084 Test Loss: 10.693 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.8851316
	speed: 0.8153s/iter; left time: 12807.4370s
	iters: 200, epoch: 25 | loss: 0.2585170
	speed: 0.3529s/iter; left time: 5508.8455s
Epoch: 25 cost time: 73.10497307777405
Epoch: 25, Steps: 208 | Train Loss: 0.459 Vali Loss: 10.744 Vali Acc: 0.079 Test Loss: 10.744 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3489035
	speed: 0.8618s/iter; left time: 13358.0840s
	iters: 200, epoch: 26 | loss: 1.0387121
	speed: 0.3440s/iter; left time: 5298.3592s
Epoch: 26 cost time: 73.50543642044067
Epoch: 26, Steps: 208 | Train Loss: 0.433 Vali Loss: 11.002 Vali Acc: 0.076 Test Loss: 11.002 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.6508209
	speed: 0.8477s/iter; left time: 12963.8559s
	iters: 200, epoch: 27 | loss: 0.2941450
	speed: 0.3589s/iter; left time: 5452.9600s
Epoch: 27 cost time: 75.76226758956909
Epoch: 27, Steps: 208 | Train Loss: 0.448 Vali Loss: 11.061 Vali Acc: 0.085 Test Loss: 11.061 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3768977
	speed: 0.8609s/iter; left time: 12986.4039s
	iters: 200, epoch: 28 | loss: 0.9877393
	speed: 0.3572s/iter; left time: 5352.6977s
Epoch: 28 cost time: 75.22308850288391
Epoch: 28, Steps: 208 | Train Loss: 0.411 Vali Loss: 11.432 Vali Acc: 0.086 Test Loss: 11.432 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2112748
	speed: 0.8461s/iter; left time: 12588.1011s
	iters: 200, epoch: 29 | loss: 0.6719293
	speed: 0.3610s/iter; left time: 5335.0302s
Epoch: 29 cost time: 75.38489508628845
Epoch: 29, Steps: 208 | Train Loss: 0.449 Vali Loss: 11.380 Vali Acc: 0.087 Test Loss: 11.380 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.3824540
	speed: 0.8348s/iter; left time: 12246.3800s
	iters: 200, epoch: 30 | loss: 0.5784477
	speed: 0.3607s/iter; left time: 5255.6486s
Epoch: 30 cost time: 74.91779637336731
Epoch: 30, Steps: 208 | Train Loss: 0.456 Vali Loss: 11.305 Vali Acc: 0.085 Test Loss: 11.305 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.1600284
	speed: 0.8445s/iter; left time: 12212.0191s
	iters: 200, epoch: 31 | loss: 0.0147053
	speed: 0.3550s/iter; left time: 5098.1923s
Epoch: 31 cost time: 73.30361652374268
Epoch: 31, Steps: 208 | Train Loss: 0.394 Vali Loss: 11.713 Vali Acc: 0.081 Test Loss: 11.713 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.7454621
	speed: 0.8320s/iter; left time: 11858.6748s
	iters: 200, epoch: 32 | loss: 0.4597311
	speed: 0.3545s/iter; left time: 5017.4125s
Epoch: 32 cost time: 73.28577280044556
Epoch: 32, Steps: 208 | Train Loss: 0.418 Vali Loss: 11.450 Vali Acc: 0.083 Test Loss: 11.450 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0504534
	speed: 0.8346s/iter; left time: 11722.6422s
	iters: 200, epoch: 33 | loss: 0.5478349
	speed: 0.3426s/iter; left time: 4776.9802s
Epoch: 33 cost time: 71.47482991218567
Epoch: 33, Steps: 208 | Train Loss: 0.354 Vali Loss: 11.413 Vali Acc: 0.085 Test Loss: 11.413 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08768267223382047
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3305354
	speed: 0.3571s/iter; left time: 7392.8327s
	iters: 200, epoch: 1 | loss: 5.7241268
	speed: 0.3278s/iter; left time: 6752.1082s
Epoch: 1 cost time: 71.34086632728577
Epoch: 1, Steps: 208 | Train Loss: 5.430 Vali Loss: 6.325 Vali Acc: 0.065 Test Loss: 6.325 Test Acc: 0.065
Validation loss decreased (inf --> -0.064953).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.8785572
	speed: 0.7982s/iter; left time: 16358.2505s
	iters: 200, epoch: 2 | loss: 4.5216799
	speed: 0.3321s/iter; left time: 6771.5260s
Epoch: 2 cost time: 69.93423771858215
Epoch: 2, Steps: 208 | Train Loss: 5.032 Vali Loss: 6.634 Vali Acc: 0.063 Test Loss: 6.634 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.0758877
	speed: 0.7988s/iter; left time: 16204.4198s
	iters: 200, epoch: 3 | loss: 4.0555687
	speed: 0.3389s/iter; left time: 6840.2778s
Epoch: 3 cost time: 70.51782631874084
Epoch: 3, Steps: 208 | Train Loss: 3.925 Vali Loss: 6.277 Vali Acc: 0.060 Test Loss: 6.277 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.1931179
	speed: 0.8315s/iter; left time: 16693.5470s
	iters: 200, epoch: 4 | loss: 4.1624813
	speed: 0.3536s/iter; left time: 7063.5815s
Epoch: 4 cost time: 73.57853150367737
Epoch: 4, Steps: 208 | Train Loss: 3.099 Vali Loss: 7.019 Vali Acc: 0.062 Test Loss: 7.019 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.5009913
	speed: 0.8261s/iter; left time: 16413.7823s
	iters: 200, epoch: 5 | loss: 4.6013269
	speed: 0.3414s/iter; left time: 6749.5814s
Epoch: 5 cost time: 70.51000785827637
Epoch: 5, Steps: 208 | Train Loss: 2.552 Vali Loss: 6.174 Vali Acc: 0.067 Test Loss: 6.174 Test Acc: 0.067
Validation loss decreased (-0.064953 --> -0.067341).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4097891
	speed: 0.8226s/iter; left time: 16173.0016s
	iters: 200, epoch: 6 | loss: 2.4503424
	speed: 0.3150s/iter; left time: 6162.2135s
Epoch: 6 cost time: 66.88473057746887
Epoch: 6, Steps: 208 | Train Loss: 2.012 Vali Loss: 6.779 Vali Acc: 0.078 Test Loss: 6.779 Test Acc: 0.078
Validation loss decreased (-0.067341 --> -0.077773).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6425624
	speed: 0.8024s/iter; left time: 15609.4161s
	iters: 200, epoch: 7 | loss: 2.4820807
	speed: 0.3221s/iter; left time: 6233.3033s
Epoch: 7 cost time: 67.70017170906067
Epoch: 7, Steps: 208 | Train Loss: 1.674 Vali Loss: 7.293 Vali Acc: 0.069 Test Loss: 7.293 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9231585
	speed: 0.7804s/iter; left time: 15019.5388s
	iters: 200, epoch: 8 | loss: 1.2103282
	speed: 0.3022s/iter; left time: 5784.7797s
Epoch: 8 cost time: 64.34940719604492
Epoch: 8, Steps: 208 | Train Loss: 1.381 Vali Loss: 7.428 Vali Acc: 0.076 Test Loss: 7.428 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0807695
	speed: 0.7652s/iter; left time: 14567.8428s
	iters: 200, epoch: 9 | loss: 1.2848815
	speed: 0.3132s/iter; left time: 5930.4108s
Epoch: 9 cost time: 66.0919759273529
Epoch: 9, Steps: 208 | Train Loss: 1.167 Vali Loss: 7.837 Vali Acc: 0.068 Test Loss: 7.837 Test Acc: 0.068
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4737884
	speed: 0.8132s/iter; left time: 15311.3277s
	iters: 200, epoch: 10 | loss: 1.7078804
	speed: 0.3224s/iter; left time: 6038.4711s
Epoch: 10 cost time: 68.7770574092865
Epoch: 10, Steps: 208 | Train Loss: 0.979 Vali Loss: 8.423 Vali Acc: 0.077 Test Loss: 8.423 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2102063
	speed: 0.8137s/iter; left time: 15152.6582s
	iters: 200, epoch: 11 | loss: 0.5410882
	speed: 0.3177s/iter; left time: 5883.5954s
Epoch: 11 cost time: 68.45830178260803
Epoch: 11, Steps: 208 | Train Loss: 0.899 Vali Loss: 8.958 Vali Acc: 0.075 Test Loss: 8.958 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.2526171
	speed: 0.7799s/iter; left time: 14360.7826s
	iters: 200, epoch: 12 | loss: 1.0388234
	speed: 0.3306s/iter; left time: 6055.0048s
Epoch: 12 cost time: 68.94099354743958
Epoch: 12, Steps: 208 | Train Loss: 0.835 Vali Loss: 10.400 Vali Acc: 0.068 Test Loss: 10.400 Test Acc: 0.068
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.7034554
	speed: 0.8178s/iter; left time: 14887.2432s
	iters: 200, epoch: 13 | loss: 0.3232066
	speed: 0.3482s/iter; left time: 6304.1135s
Epoch: 13 cost time: 72.51382327079773
Epoch: 13, Steps: 208 | Train Loss: 0.795 Vali Loss: 9.971 Vali Acc: 0.075 Test Loss: 9.971 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1090854
	speed: 0.7981s/iter; left time: 14363.9541s
	iters: 200, epoch: 14 | loss: 1.5924335
	speed: 0.3112s/iter; left time: 5568.8792s
Epoch: 14 cost time: 67.02745866775513
Epoch: 14, Steps: 208 | Train Loss: 0.795 Vali Loss: 9.055 Vali Acc: 0.081 Test Loss: 9.055 Test Acc: 0.081
Validation loss decreased (-0.077773 --> -0.080733).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3473498
	speed: 0.7730s/iter; left time: 13750.0880s
	iters: 200, epoch: 15 | loss: 0.6821064
	speed: 0.3331s/iter; left time: 5891.9550s
Epoch: 15 cost time: 67.93948221206665
Epoch: 15, Steps: 208 | Train Loss: 0.697 Vali Loss: 9.579 Vali Acc: 0.077 Test Loss: 9.579 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4116233
	speed: 0.8502s/iter; left time: 14946.5327s
	iters: 200, epoch: 16 | loss: 1.4549317
	speed: 0.3269s/iter; left time: 5715.1371s
Epoch: 16 cost time: 70.60665369033813
Epoch: 16, Steps: 208 | Train Loss: 0.669 Vali Loss: 10.062 Vali Acc: 0.071 Test Loss: 10.062 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8882874
	speed: 0.7986s/iter; left time: 13873.8923s
	iters: 200, epoch: 17 | loss: 0.5312591
	speed: 0.3230s/iter; left time: 5578.5675s
Epoch: 17 cost time: 67.069340467453
Epoch: 17, Steps: 208 | Train Loss: 0.627 Vali Loss: 10.370 Vali Acc: 0.072 Test Loss: 10.370 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2973979
	speed: 0.7902s/iter; left time: 13564.5419s
	iters: 200, epoch: 18 | loss: 0.7876375
	speed: 0.3231s/iter; left time: 5513.6056s
Epoch: 18 cost time: 67.40597462654114
Epoch: 18, Steps: 208 | Train Loss: 0.584 Vali Loss: 10.622 Vali Acc: 0.076 Test Loss: 10.622 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3818311
	speed: 0.8350s/iter; left time: 14158.9857s
	iters: 200, epoch: 19 | loss: 0.4918529
	speed: 0.3169s/iter; left time: 5341.5859s
Epoch: 19 cost time: 68.77094054222107
Epoch: 19, Steps: 208 | Train Loss: 0.574 Vali Loss: 10.596 Vali Acc: 0.074 Test Loss: 10.596 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2503420
	speed: 0.8012s/iter; left time: 13418.8223s
	iters: 200, epoch: 20 | loss: 2.0163894
	speed: 0.3033s/iter; left time: 5049.6238s
Epoch: 20 cost time: 66.19978642463684
Epoch: 20, Steps: 208 | Train Loss: 0.572 Vali Loss: 10.432 Vali Acc: 0.070 Test Loss: 10.432 Test Acc: 0.070
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2972948
	speed: 0.7727s/iter; left time: 12780.9319s
	iters: 200, epoch: 21 | loss: 0.7924408
	speed: 0.3219s/iter; left time: 5292.9161s
Epoch: 21 cost time: 68.15887546539307
Epoch: 21, Steps: 208 | Train Loss: 0.577 Vali Loss: 10.657 Vali Acc: 0.077 Test Loss: 10.657 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.7150161
	speed: 0.8145s/iter; left time: 13303.7212s
	iters: 200, epoch: 22 | loss: 0.7932171
	speed: 0.3444s/iter; left time: 5589.9864s
Epoch: 22 cost time: 71.82451105117798
Epoch: 22, Steps: 208 | Train Loss: 0.536 Vali Loss: 10.639 Vali Acc: 0.075 Test Loss: 10.639 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7642131
	speed: 0.8092s/iter; left time: 13048.1741s
	iters: 200, epoch: 23 | loss: 0.5423298
	speed: 0.3446s/iter; left time: 5522.0560s
Epoch: 23 cost time: 70.7908067703247
Epoch: 23, Steps: 208 | Train Loss: 0.517 Vali Loss: 10.347 Vali Acc: 0.076 Test Loss: 10.347 Test Acc: 0.076
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.7444307
	speed: 0.8140s/iter; left time: 12957.0583s
	iters: 200, epoch: 24 | loss: 0.2132129
	speed: 0.3559s/iter; left time: 5628.5234s
Epoch: 24 cost time: 71.52717065811157
Epoch: 24, Steps: 208 | Train Loss: 0.519 Vali Loss: 11.113 Vali Acc: 0.077 Test Loss: 11.113 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08082314345362362
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.7466269
	speed: 0.3495s/iter; left time: 7235.0436s
	iters: 200, epoch: 1 | loss: 5.7130017
	speed: 0.3318s/iter; left time: 6836.3286s
Epoch: 1 cost time: 71.25364828109741
Epoch: 1, Steps: 208 | Train Loss: 5.387 Vali Loss: 5.978 Vali Acc: 0.064 Test Loss: 5.978 Test Acc: 0.064
Validation loss decreased (inf --> -0.064360).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.6115885
	speed: 0.8296s/iter; left time: 17000.2865s
	iters: 200, epoch: 2 | loss: 4.1227808
	speed: 0.3439s/iter; left time: 7013.1404s
Epoch: 2 cost time: 71.97237920761108
Epoch: 2, Steps: 208 | Train Loss: 4.831 Vali Loss: 6.278 Vali Acc: 0.058 Test Loss: 6.278 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.3050814
	speed: 0.8145s/iter; left time: 16521.6991s
	iters: 200, epoch: 3 | loss: 3.8251967
	speed: 0.3451s/iter; left time: 6966.1491s
Epoch: 3 cost time: 71.60601735115051
Epoch: 3, Steps: 208 | Train Loss: 3.752 Vali Loss: 6.221 Vali Acc: 0.069 Test Loss: 6.221 Test Acc: 0.069
Validation loss decreased (-0.064360 --> -0.069130).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0134537
	speed: 0.8652s/iter; left time: 17370.0740s
	iters: 200, epoch: 4 | loss: 4.6750231
	speed: 0.3441s/iter; left time: 6873.6222s
Epoch: 4 cost time: 73.44213914871216
Epoch: 4, Steps: 208 | Train Loss: 2.916 Vali Loss: 6.998 Vali Acc: 0.073 Test Loss: 6.998 Test Acc: 0.073
Validation loss decreased (-0.069130 --> -0.072999).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4339807
	speed: 0.8317s/iter; left time: 16524.6586s
	iters: 200, epoch: 5 | loss: 3.5408380
	speed: 0.3162s/iter; left time: 6250.3748s
Epoch: 5 cost time: 67.7002763748169
Epoch: 5, Steps: 208 | Train Loss: 2.421 Vali Loss: 6.887 Vali Acc: 0.076 Test Loss: 6.887 Test Acc: 0.076
Validation loss decreased (-0.072999 --> -0.075982).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9473026
	speed: 0.7873s/iter; left time: 15478.9734s
	iters: 200, epoch: 6 | loss: 2.8751802
	speed: 0.3349s/iter; left time: 6550.2345s
Epoch: 6 cost time: 69.07794690132141
Epoch: 6, Steps: 208 | Train Loss: 1.963 Vali Loss: 6.852 Vali Acc: 0.074 Test Loss: 6.852 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4513559
	speed: 0.8114s/iter; left time: 15784.8912s
	iters: 200, epoch: 7 | loss: 3.6847634
	speed: 0.3298s/iter; left time: 6382.8570s
Epoch: 7 cost time: 70.21355628967285
Epoch: 7, Steps: 208 | Train Loss: 1.655 Vali Loss: 7.237 Vali Acc: 0.070 Test Loss: 7.237 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0563407
	speed: 0.7897s/iter; left time: 15198.6875s
	iters: 200, epoch: 8 | loss: 1.7608255
	speed: 0.3272s/iter; left time: 6264.7821s
Epoch: 8 cost time: 68.84871292114258
Epoch: 8, Steps: 208 | Train Loss: 1.425 Vali Loss: 7.252 Vali Acc: 0.077 Test Loss: 7.252 Test Acc: 0.077
Validation loss decreased (-0.075982 --> -0.076873).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5329996
	speed: 0.7985s/iter; left time: 15200.2521s
	iters: 200, epoch: 9 | loss: 1.1862200
	speed: 0.3357s/iter; left time: 6356.2972s
Epoch: 9 cost time: 71.20818495750427
Epoch: 9, Steps: 208 | Train Loss: 1.192 Vali Loss: 7.662 Vali Acc: 0.073 Test Loss: 7.662 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2641311
	speed: 0.8130s/iter; left time: 15307.0764s
	iters: 200, epoch: 10 | loss: 1.5470083
	speed: 0.3277s/iter; left time: 6136.8584s
Epoch: 10 cost time: 69.47273921966553
Epoch: 10, Steps: 208 | Train Loss: 1.036 Vali Loss: 8.194 Vali Acc: 0.077 Test Loss: 8.194 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.7301206
	speed: 0.7772s/iter; left time: 14472.7285s
	iters: 200, epoch: 11 | loss: 0.6030712
	speed: 0.3296s/iter; left time: 6105.1422s
Epoch: 11 cost time: 68.99753546714783
Epoch: 11, Steps: 208 | Train Loss: 0.903 Vali Loss: 8.916 Vali Acc: 0.074 Test Loss: 8.916 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1162276
	speed: 0.8115s/iter; left time: 14942.6364s
	iters: 200, epoch: 12 | loss: 0.7445278
	speed: 0.3383s/iter; left time: 6195.8926s
Epoch: 12 cost time: 71.09282445907593
Epoch: 12, Steps: 208 | Train Loss: 0.821 Vali Loss: 9.042 Vali Acc: 0.081 Test Loss: 9.042 Test Acc: 0.081
Validation loss decreased (-0.076873 --> -0.081031).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0492418
	speed: 0.7949s/iter; left time: 14471.8283s
	iters: 200, epoch: 13 | loss: 1.1110997
	speed: 0.3319s/iter; left time: 6009.6919s
Epoch: 13 cost time: 68.60580563545227
Epoch: 13, Steps: 208 | Train Loss: 0.787 Vali Loss: 9.348 Vali Acc: 0.079 Test Loss: 9.348 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8324534
	speed: 0.7410s/iter; left time: 13335.4253s
	iters: 200, epoch: 14 | loss: 0.9076594
	speed: 0.3333s/iter; left time: 5965.0584s
Epoch: 14 cost time: 67.25778341293335
Epoch: 14, Steps: 208 | Train Loss: 0.775 Vali Loss: 9.982 Vali Acc: 0.076 Test Loss: 9.982 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1757752
	speed: 0.8054s/iter; left time: 14326.4253s
	iters: 200, epoch: 15 | loss: 1.0611606
	speed: 0.3474s/iter; left time: 6145.0214s
Epoch: 15 cost time: 71.44876170158386
Epoch: 15, Steps: 208 | Train Loss: 0.748 Vali Loss: 9.594 Vali Acc: 0.088 Test Loss: 9.594 Test Acc: 0.088
Validation loss decreased (-0.081031 --> -0.087587).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3838677
	speed: 0.7863s/iter; left time: 13824.5824s
	iters: 200, epoch: 16 | loss: 0.7369657
	speed: 0.3311s/iter; left time: 5788.2204s
Epoch: 16 cost time: 67.13715529441833
Epoch: 16, Steps: 208 | Train Loss: 0.654 Vali Loss: 9.860 Vali Acc: 0.082 Test Loss: 9.860 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8098866
	speed: 0.7691s/iter; left time: 13360.9515s
	iters: 200, epoch: 17 | loss: 1.3181411
	speed: 0.3339s/iter; left time: 5767.7435s
Epoch: 17 cost time: 68.73903322219849
Epoch: 17, Steps: 208 | Train Loss: 0.650 Vali Loss: 10.296 Vali Acc: 0.081 Test Loss: 10.296 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.9366041
	speed: 0.8032s/iter; left time: 13786.8041s
	iters: 200, epoch: 18 | loss: 0.7165310
	speed: 0.3391s/iter; left time: 5787.4711s
Epoch: 18 cost time: 69.593759059906
Epoch: 18, Steps: 208 | Train Loss: 0.633 Vali Loss: 9.712 Vali Acc: 0.082 Test Loss: 9.712 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.0001055
	speed: 0.8002s/iter; left time: 13569.1801s
	iters: 200, epoch: 19 | loss: 0.2153052
	speed: 0.3339s/iter; left time: 5628.5182s
Epoch: 19 cost time: 69.88463377952576
Epoch: 19, Steps: 208 | Train Loss: 0.600 Vali Loss: 10.279 Vali Acc: 0.079 Test Loss: 10.279 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4415101
	speed: 0.8050s/iter; left time: 13483.7387s
	iters: 200, epoch: 20 | loss: 0.9184402
	speed: 0.3361s/iter; left time: 5595.6116s
Epoch: 20 cost time: 69.35926008224487
Epoch: 20, Steps: 208 | Train Loss: 0.604 Vali Loss: 10.143 Vali Acc: 0.073 Test Loss: 10.143 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3809452
	speed: 0.8038s/iter; left time: 13295.5870s
	iters: 200, epoch: 21 | loss: 0.4185245
	speed: 0.3281s/iter; left time: 5394.8805s
Epoch: 21 cost time: 68.63953804969788
Epoch: 21, Steps: 208 | Train Loss: 0.569 Vali Loss: 10.685 Vali Acc: 0.077 Test Loss: 10.685 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.5658402
	speed: 0.7960s/iter; left time: 13000.6115s
	iters: 200, epoch: 22 | loss: 0.2493622
	speed: 0.3171s/iter; left time: 5146.8077s
Epoch: 22 cost time: 68.15312027931213
Epoch: 22, Steps: 208 | Train Loss: 0.589 Vali Loss: 10.161 Vali Acc: 0.075 Test Loss: 10.161 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.5455899
	speed: 0.7996s/iter; left time: 12892.9695s
	iters: 200, epoch: 23 | loss: 0.2206659
	speed: 0.3180s/iter; left time: 5096.6254s
Epoch: 23 cost time: 67.73323106765747
Epoch: 23, Steps: 208 | Train Loss: 0.569 Vali Loss: 11.200 Vali Acc: 0.084 Test Loss: 11.200 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2909293
	speed: 0.8073s/iter; left time: 12849.2078s
	iters: 200, epoch: 24 | loss: 0.7980663
	speed: 0.3499s/iter; left time: 5533.6512s
Epoch: 24 cost time: 72.76746773719788
Epoch: 24, Steps: 208 | Train Loss: 0.557 Vali Loss: 11.414 Vali Acc: 0.080 Test Loss: 11.414 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1518670
	speed: 0.8039s/iter; left time: 12628.9408s
	iters: 200, epoch: 25 | loss: 0.5135772
	speed: 0.3226s/iter; left time: 5035.0687s
Epoch: 25 cost time: 68.84669709205627
Epoch: 25, Steps: 208 | Train Loss: 0.504 Vali Loss: 10.834 Vali Acc: 0.071 Test Loss: 10.834 Test Acc: 0.071
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08768267223382047
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.5794592
	speed: 0.3452s/iter; left time: 7145.2184s
	iters: 200, epoch: 1 | loss: 5.0475693
	speed: 0.3204s/iter; left time: 6600.4265s
Epoch: 1 cost time: 69.47219514846802
Epoch: 1, Steps: 208 | Train Loss: 5.243 Vali Loss: 6.280 Vali Acc: 0.082 Test Loss: 6.280 Test Acc: 0.082
Validation loss decreased (inf --> -0.081953).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3500190
	speed: 0.7966s/iter; left time: 16324.7577s
	iters: 200, epoch: 2 | loss: 4.8679976
	speed: 0.3357s/iter; left time: 6845.6918s
Epoch: 2 cost time: 69.86031532287598
Epoch: 2, Steps: 208 | Train Loss: 4.929 Vali Loss: 8.297 Vali Acc: 0.046 Test Loss: 8.297 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.0042343
	speed: 0.7709s/iter; left time: 15637.4196s
	iters: 200, epoch: 3 | loss: 5.2526078
	speed: 0.3146s/iter; left time: 6349.7107s
Epoch: 3 cost time: 66.1905312538147
Epoch: 3, Steps: 208 | Train Loss: 3.984 Vali Loss: 6.653 Vali Acc: 0.061 Test Loss: 6.653 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3208375
	speed: 0.8036s/iter; left time: 16133.2775s
	iters: 200, epoch: 4 | loss: 3.4354272
	speed: 0.3344s/iter; left time: 6681.2252s
Epoch: 4 cost time: 71.08422112464905
Epoch: 4, Steps: 208 | Train Loss: 3.082 Vali Loss: 6.384 Vali Acc: 0.070 Test Loss: 6.384 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.4596417
	speed: 0.7837s/iter; left time: 15570.6281s
	iters: 200, epoch: 5 | loss: 4.8977695
	speed: 0.3183s/iter; left time: 6291.7460s
Epoch: 5 cost time: 67.8051187992096
Epoch: 5, Steps: 208 | Train Loss: 2.564 Vali Loss: 5.429 Vali Acc: 0.073 Test Loss: 5.429 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.4370360
	speed: 0.7723s/iter; left time: 15184.7522s
	iters: 200, epoch: 6 | loss: 2.8006968
	speed: 0.3120s/iter; left time: 6102.9536s
Epoch: 6 cost time: 66.36661791801453
Epoch: 6, Steps: 208 | Train Loss: 2.318 Vali Loss: 5.638 Vali Acc: 0.073 Test Loss: 5.638 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.4627688
	speed: 0.8204s/iter; left time: 15958.9616s
	iters: 200, epoch: 7 | loss: 2.9779348
	speed: 0.3212s/iter; left time: 6215.3291s
Epoch: 7 cost time: 69.26171326637268
Epoch: 7, Steps: 208 | Train Loss: 1.913 Vali Loss: 6.105 Vali Acc: 0.081 Test Loss: 6.105 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8196335
	speed: 0.8205s/iter; left time: 15791.2574s
	iters: 200, epoch: 8 | loss: 1.9094093
	speed: 0.3523s/iter; left time: 6744.2275s
Epoch: 8 cost time: 73.14105296134949
Epoch: 8, Steps: 208 | Train Loss: 1.613 Vali Loss: 6.734 Vali Acc: 0.078 Test Loss: 6.734 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.8406662
	speed: 0.8073s/iter; left time: 15368.0712s
	iters: 200, epoch: 9 | loss: 1.4981055
	speed: 0.3239s/iter; left time: 6133.3050s
Epoch: 9 cost time: 69.73415350914001
Epoch: 9, Steps: 208 | Train Loss: 1.335 Vali Loss: 7.362 Vali Acc: 0.075 Test Loss: 7.362 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.4677993
	speed: 0.8041s/iter; left time: 15139.7445s
	iters: 200, epoch: 10 | loss: 1.0442605
	speed: 0.3395s/iter; left time: 6358.8675s
Epoch: 10 cost time: 71.61951541900635
Epoch: 10, Steps: 208 | Train Loss: 1.153 Vali Loss: 7.837 Vali Acc: 0.089 Test Loss: 7.837 Test Acc: 0.089
Validation loss decreased (-0.081953 --> -0.089096).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5498996
	speed: 0.8212s/iter; left time: 15291.4503s
	iters: 200, epoch: 11 | loss: 1.6040889
	speed: 0.3261s/iter; left time: 6040.1116s
Epoch: 11 cost time: 69.32152962684631
Epoch: 11, Steps: 208 | Train Loss: 1.007 Vali Loss: 7.729 Vali Acc: 0.085 Test Loss: 7.729 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2754412
	speed: 0.7511s/iter; left time: 13829.1006s
	iters: 200, epoch: 12 | loss: 0.5876042
	speed: 0.3385s/iter; left time: 6198.6393s
Epoch: 12 cost time: 68.92490267753601
Epoch: 12, Steps: 208 | Train Loss: 0.943 Vali Loss: 8.314 Vali Acc: 0.085 Test Loss: 8.314 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4304184
	speed: 0.7920s/iter; left time: 14418.3020s
	iters: 200, epoch: 13 | loss: 0.9305256
	speed: 0.3309s/iter; left time: 5991.1614s
Epoch: 13 cost time: 69.90300822257996
Epoch: 13, Steps: 208 | Train Loss: 0.865 Vali Loss: 8.524 Vali Acc: 0.080 Test Loss: 8.524 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8660266
	speed: 0.8105s/iter; left time: 14586.6942s
	iters: 200, epoch: 14 | loss: 0.5440022
	speed: 0.3556s/iter; left time: 6364.6138s
Epoch: 14 cost time: 72.65524244308472
Epoch: 14, Steps: 208 | Train Loss: 0.824 Vali Loss: 8.468 Vali Acc: 0.082 Test Loss: 8.468 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2104658
	speed: 0.8301s/iter; left time: 14767.5182s
	iters: 200, epoch: 15 | loss: 1.0621316
	speed: 0.3309s/iter; left time: 5852.5567s
Epoch: 15 cost time: 71.79317116737366
Epoch: 15, Steps: 208 | Train Loss: 0.735 Vali Loss: 8.621 Vali Acc: 0.086 Test Loss: 8.621 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0565825
	speed: 0.8063s/iter; left time: 14175.5981s
	iters: 200, epoch: 16 | loss: 0.5251164
	speed: 0.3452s/iter; left time: 6033.6117s
Epoch: 16 cost time: 71.23280262947083
Epoch: 16, Steps: 208 | Train Loss: 0.659 Vali Loss: 9.035 Vali Acc: 0.084 Test Loss: 9.035 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.9048967
	speed: 0.8390s/iter; left time: 14576.7721s
	iters: 200, epoch: 17 | loss: 0.4685374
	speed: 0.3423s/iter; left time: 5912.9379s
Epoch: 17 cost time: 73.26828408241272
Epoch: 17, Steps: 208 | Train Loss: 0.690 Vali Loss: 9.009 Vali Acc: 0.078 Test Loss: 9.009 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.4098684
	speed: 0.8056s/iter; left time: 13827.8988s
	iters: 200, epoch: 18 | loss: 0.8006870
	speed: 0.3363s/iter; left time: 5739.0283s
Epoch: 18 cost time: 70.18459558486938
Epoch: 18, Steps: 208 | Train Loss: 0.667 Vali Loss: 8.711 Vali Acc: 0.084 Test Loss: 8.711 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1357953
	speed: 0.8440s/iter; left time: 14312.2470s
	iters: 200, epoch: 19 | loss: 0.8795836
	speed: 0.3573s/iter; left time: 6023.6165s
Epoch: 19 cost time: 74.4719135761261
Epoch: 19, Steps: 208 | Train Loss: 0.630 Vali Loss: 9.052 Vali Acc: 0.079 Test Loss: 9.052 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1313529
	speed: 0.8052s/iter; left time: 13486.1982s
	iters: 200, epoch: 20 | loss: 0.7418101
	speed: 0.3277s/iter; left time: 5455.6857s
Epoch: 20 cost time: 69.79215979576111
Epoch: 20, Steps: 208 | Train Loss: 0.603 Vali Loss: 8.666 Vali Acc: 0.083 Test Loss: 8.666 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08917387414255891
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3221536
	speed: 0.3488s/iter; left time: 7221.1795s
	iters: 200, epoch: 1 | loss: 3.9308164
	speed: 0.3310s/iter; left time: 6818.0655s
Epoch: 1 cost time: 71.03891491889954
Epoch: 1, Steps: 208 | Train Loss: 4.906 Vali Loss: 7.548 Vali Acc: 0.069 Test Loss: 7.548 Test Acc: 0.069
Validation loss decreased (inf --> -0.069415).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.7194600
	speed: 0.8314s/iter; left time: 17038.2445s
	iters: 200, epoch: 2 | loss: 5.9758477
	speed: 0.3360s/iter; left time: 6851.7431s
Epoch: 2 cost time: 70.89678359031677
Epoch: 2, Steps: 208 | Train Loss: 5.240 Vali Loss: 9.827 Vali Acc: 0.052 Test Loss: 9.827 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.8752279
	speed: 0.8015s/iter; left time: 16257.6921s
	iters: 200, epoch: 3 | loss: 6.7818766
	speed: 0.3130s/iter; left time: 6318.6550s
Epoch: 3 cost time: 67.50746417045593
Epoch: 3, Steps: 208 | Train Loss: 4.727 Vali Loss: 10.363 Vali Acc: 0.060 Test Loss: 10.363 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.8565527
	speed: 0.8006s/iter; left time: 16073.5587s
	iters: 200, epoch: 4 | loss: 4.3935914
	speed: 0.3131s/iter; left time: 6254.0531s
Epoch: 4 cost time: 67.72476601600647
Epoch: 4, Steps: 208 | Train Loss: 3.897 Vali Loss: 8.383 Vali Acc: 0.065 Test Loss: 8.383 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.3683758
	speed: 0.8353s/iter; left time: 16596.2415s
	iters: 200, epoch: 5 | loss: 5.5998678
	speed: 0.3371s/iter; left time: 6663.7302s
Epoch: 5 cost time: 71.64008378982544
Epoch: 5, Steps: 208 | Train Loss: 3.105 Vali Loss: 6.443 Vali Acc: 0.069 Test Loss: 6.443 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.2770808
	speed: 0.8049s/iter; left time: 15825.2839s
	iters: 200, epoch: 6 | loss: 3.4409742
	speed: 0.3243s/iter; left time: 6343.3865s
Epoch: 6 cost time: 69.03844141960144
Epoch: 6, Steps: 208 | Train Loss: 2.918 Vali Loss: 5.389 Vali Acc: 0.066 Test Loss: 5.389 Test Acc: 0.066
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3438039
	speed: 0.8279s/iter; left time: 16105.2808s
	iters: 200, epoch: 7 | loss: 4.6228538
	speed: 0.3378s/iter; left time: 6537.6232s
Epoch: 7 cost time: 71.2195155620575
Epoch: 7, Steps: 208 | Train Loss: 2.790 Vali Loss: 4.953 Vali Acc: 0.058 Test Loss: 4.953 Test Acc: 0.058
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.5566082
	speed: 0.7984s/iter; left time: 15365.7455s
	iters: 200, epoch: 8 | loss: 3.0744364
	speed: 0.3118s/iter; left time: 5968.7817s
Epoch: 8 cost time: 66.5540144443512
Epoch: 8, Steps: 208 | Train Loss: 2.489 Vali Loss: 5.084 Vali Acc: 0.062 Test Loss: 5.084 Test Acc: 0.062
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.9955683
	speed: 0.7910s/iter; left time: 15058.5243s
	iters: 200, epoch: 9 | loss: 2.7570424
	speed: 0.3188s/iter; left time: 6037.5219s
Epoch: 9 cost time: 68.85044956207275
Epoch: 9, Steps: 208 | Train Loss: 2.337 Vali Loss: 5.273 Vali Acc: 0.071 Test Loss: 5.273 Test Acc: 0.071
Validation loss decreased (-0.069415 --> -0.071227).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2391353
	speed: 0.8200s/iter; left time: 15440.7002s
	iters: 200, epoch: 10 | loss: 1.5970590
	speed: 0.3341s/iter; left time: 6257.7231s
Epoch: 10 cost time: 69.73605394363403
Epoch: 10, Steps: 208 | Train Loss: 1.967 Vali Loss: 5.347 Vali Acc: 0.079 Test Loss: 5.347 Test Acc: 0.079
Validation loss decreased (-0.071227 --> -0.079278).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3586078
	speed: 0.7966s/iter; left time: 14833.5031s
	iters: 200, epoch: 11 | loss: 1.6910233
	speed: 0.3254s/iter; left time: 6026.0347s
Epoch: 11 cost time: 67.63899898529053
Epoch: 11, Steps: 208 | Train Loss: 1.700 Vali Loss: 5.747 Vali Acc: 0.075 Test Loss: 5.747 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6481911
	speed: 0.7875s/iter; left time: 14500.0610s
	iters: 200, epoch: 12 | loss: 2.1795368
	speed: 0.3239s/iter; left time: 5931.0867s
Epoch: 12 cost time: 67.47090005874634
Epoch: 12, Steps: 208 | Train Loss: 1.499 Vali Loss: 6.164 Vali Acc: 0.084 Test Loss: 6.164 Test Acc: 0.084
Validation loss decreased (-0.079278 --> -0.084340).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1226964
	speed: 0.7941s/iter; left time: 14456.6108s
	iters: 200, epoch: 13 | loss: 2.4882483
	speed: 0.3358s/iter; left time: 6078.9251s
Epoch: 13 cost time: 69.09413194656372
Epoch: 13, Steps: 208 | Train Loss: 1.380 Vali Loss: 6.310 Vali Acc: 0.091 Test Loss: 6.310 Test Acc: 0.091
Validation loss decreased (-0.084340 --> -0.090602).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9259445
	speed: 0.8007s/iter; left time: 14410.9797s
	iters: 200, epoch: 14 | loss: 1.3901733
	speed: 0.3175s/iter; left time: 5682.3237s
Epoch: 14 cost time: 66.53477001190186
Epoch: 14, Steps: 208 | Train Loss: 1.265 Vali Loss: 6.630 Vali Acc: 0.085 Test Loss: 6.630 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1992818
	speed: 0.7637s/iter; left time: 13585.9538s
	iters: 200, epoch: 15 | loss: 1.1026000
	speed: 0.3344s/iter; left time: 5915.2808s
Epoch: 15 cost time: 68.80626511573792
Epoch: 15, Steps: 208 | Train Loss: 1.152 Vali Loss: 6.891 Vali Acc: 0.089 Test Loss: 6.891 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9660317
	speed: 0.8018s/iter; left time: 14096.3149s
	iters: 200, epoch: 16 | loss: 0.4170095
	speed: 0.3301s/iter; left time: 5769.9292s
Epoch: 16 cost time: 69.0610945224762
Epoch: 16, Steps: 208 | Train Loss: 1.073 Vali Loss: 6.629 Vali Acc: 0.085 Test Loss: 6.629 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7810189
	speed: 0.7824s/iter; left time: 13592.0887s
	iters: 200, epoch: 17 | loss: 1.0505270
	speed: 0.3277s/iter; left time: 5660.5601s
Epoch: 17 cost time: 68.82544183731079
Epoch: 17, Steps: 208 | Train Loss: 0.964 Vali Loss: 7.220 Vali Acc: 0.078 Test Loss: 7.220 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0689486
	speed: 0.7452s/iter; left time: 12791.0770s
	iters: 200, epoch: 18 | loss: 0.7174688
	speed: 0.3169s/iter; left time: 5408.2138s
Epoch: 18 cost time: 65.2996895313263
Epoch: 18, Steps: 208 | Train Loss: 0.867 Vali Loss: 7.862 Vali Acc: 0.088 Test Loss: 7.862 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6799141
	speed: 0.7782s/iter; left time: 13195.4322s
	iters: 200, epoch: 19 | loss: 0.5319218
	speed: 0.3432s/iter; left time: 5784.5161s
Epoch: 19 cost time: 69.19802021980286
Epoch: 19, Steps: 208 | Train Loss: 0.795 Vali Loss: 7.693 Vali Acc: 0.078 Test Loss: 7.693 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7203646
	speed: 0.7618s/iter; left time: 12758.8940s
	iters: 200, epoch: 20 | loss: 1.5328511
	speed: 0.3252s/iter; left time: 5414.9982s
Epoch: 20 cost time: 68.10314106941223
Epoch: 20, Steps: 208 | Train Loss: 0.731 Vali Loss: 7.708 Vali Acc: 0.083 Test Loss: 7.708 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8889479
	speed: 0.7944s/iter; left time: 13140.1178s
	iters: 200, epoch: 21 | loss: 1.3886900
	speed: 0.3255s/iter; left time: 5351.4228s
Epoch: 21 cost time: 70.10905742645264
Epoch: 21, Steps: 208 | Train Loss: 0.713 Vali Loss: 8.471 Vali Acc: 0.086 Test Loss: 8.471 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1507253
	speed: 0.7533s/iter; left time: 12302.9529s
	iters: 200, epoch: 22 | loss: 0.6340509
	speed: 0.3031s/iter; left time: 4919.9713s
Epoch: 22 cost time: 63.42094922065735
Epoch: 22, Steps: 208 | Train Loss: 0.646 Vali Loss: 8.473 Vali Acc: 0.078 Test Loss: 8.473 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.8050761
	speed: 0.7139s/iter; left time: 11511.1343s
	iters: 200, epoch: 23 | loss: 0.9955158
	speed: 0.2816s/iter; left time: 4513.2486s
Epoch: 23 cost time: 60.42482829093933
Epoch: 23, Steps: 208 | Train Loss: 0.654 Vali Loss: 8.233 Vali Acc: 0.079 Test Loss: 8.233 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09066507605129735
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.2813210
	speed: 0.3552s/iter; left time: 7353.9285s
	iters: 200, epoch: 1 | loss: 5.0942392
	speed: 0.3240s/iter; left time: 6674.0099s
Epoch: 1 cost time: 70.71859860420227
Epoch: 1, Steps: 208 | Train Loss: 4.842 Vali Loss: 7.189 Vali Acc: 0.067 Test Loss: 7.189 Test Acc: 0.067
Validation loss decreased (inf --> -0.067330).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.4867873
	speed: 0.7354s/iter; left time: 15071.3681s
	iters: 200, epoch: 2 | loss: 5.2442050
	speed: 0.3066s/iter; left time: 6251.5508s
Epoch: 2 cost time: 64.2033097743988
Epoch: 2, Steps: 208 | Train Loss: 5.133 Vali Loss: 9.470 Vali Acc: 0.066 Test Loss: 9.470 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.5439935
	speed: 0.7473s/iter; left time: 15158.0293s
	iters: 200, epoch: 3 | loss: 5.9731259
	speed: 0.3122s/iter; left time: 6301.3927s
Epoch: 3 cost time: 66.73264598846436
Epoch: 3, Steps: 208 | Train Loss: 4.816 Vali Loss: 8.652 Vali Acc: 0.071 Test Loss: 8.652 Test Acc: 0.071
Validation loss decreased (-0.067330 --> -0.071193).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0003402
	speed: 0.7589s/iter; left time: 15236.1654s
	iters: 200, epoch: 4 | loss: 4.0325222
	speed: 0.3119s/iter; left time: 6231.2241s
Epoch: 4 cost time: 66.10252594947815
Epoch: 4, Steps: 208 | Train Loss: 4.036 Vali Loss: 6.097 Vali Acc: 0.043 Test Loss: 6.097 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.6969876
	speed: 0.7710s/iter; left time: 15319.0174s
	iters: 200, epoch: 5 | loss: 4.6612983
	speed: 0.3133s/iter; left time: 6193.3599s
Epoch: 5 cost time: 65.87338352203369
Epoch: 5, Steps: 208 | Train Loss: 3.553 Vali Loss: 4.660 Vali Acc: 0.054 Test Loss: 4.660 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.1105011
	speed: 0.7315s/iter; left time: 14381.3573s
	iters: 200, epoch: 6 | loss: 4.2462754
	speed: 0.2992s/iter; left time: 5853.1439s
Epoch: 6 cost time: 63.3032169342041
Epoch: 6, Steps: 208 | Train Loss: 3.533 Vali Loss: 4.156 Vali Acc: 0.064 Test Loss: 4.156 Test Acc: 0.064
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.4198434
	speed: 0.7461s/iter; left time: 14514.2117s
	iters: 200, epoch: 7 | loss: 3.9639103
	speed: 0.3201s/iter; left time: 6195.4223s
Epoch: 7 cost time: 67.48742198944092
Epoch: 7, Steps: 208 | Train Loss: 3.730 Vali Loss: 3.985 Vali Acc: 0.023 Test Loss: 3.985 Test Acc: 0.023
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 4.0462017
	speed: 0.7671s/iter; left time: 14762.5424s
	iters: 200, epoch: 8 | loss: 3.8986311
	speed: 0.3187s/iter; left time: 6100.8030s
Epoch: 8 cost time: 67.00225234031677
Epoch: 8, Steps: 208 | Train Loss: 3.970 Vali Loss: 3.901 Vali Acc: 0.038 Test Loss: 3.901 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.7126453
	speed: 0.7437s/iter; left time: 14157.0981s
	iters: 200, epoch: 9 | loss: 3.8490388
	speed: 0.3090s/iter; left time: 5851.4715s
Epoch: 9 cost time: 65.6650743484497
Epoch: 9, Steps: 208 | Train Loss: 3.870 Vali Loss: 3.793 Vali Acc: 0.033 Test Loss: 3.793 Test Acc: 0.033
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.9817059
	speed: 0.7539s/iter; left time: 14195.1565s
	iters: 200, epoch: 10 | loss: 4.0761237
	speed: 0.2990s/iter; left time: 5599.2174s
Epoch: 10 cost time: 63.67890286445618
Epoch: 10, Steps: 208 | Train Loss: 3.806 Vali Loss: 3.784 Vali Acc: 0.030 Test Loss: 3.784 Test Acc: 0.030
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.4527531
	speed: 0.7185s/iter; left time: 13379.5326s
	iters: 200, epoch: 11 | loss: 3.8707821
	speed: 0.3229s/iter; left time: 5980.1548s
Epoch: 11 cost time: 65.91511845588684
Epoch: 11, Steps: 208 | Train Loss: 3.769 Vali Loss: 3.732 Vali Acc: 0.037 Test Loss: 3.732 Test Acc: 0.037
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.6484303
	speed: 0.7344s/iter; left time: 13522.8466s
	iters: 200, epoch: 12 | loss: 3.9161673
	speed: 0.3071s/iter; left time: 5624.0425s
Epoch: 12 cost time: 63.36107659339905
Epoch: 12, Steps: 208 | Train Loss: 3.754 Vali Loss: 3.727 Vali Acc: 0.034 Test Loss: 3.727 Test Acc: 0.034
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.6697161
	speed: 0.7282s/iter; left time: 13257.6306s
	iters: 200, epoch: 13 | loss: 3.4951124
	speed: 0.3088s/iter; left time: 5591.5065s
Epoch: 13 cost time: 64.84863376617432
Epoch: 13, Steps: 208 | Train Loss: 3.719 Vali Loss: 3.741 Vali Acc: 0.033 Test Loss: 3.741 Test Acc: 0.033
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07127945123769758
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.1576762
	speed: 0.3071s/iter; left time: 6357.0951s
	iters: 200, epoch: 1 | loss: 4.2576003
	speed: 0.2964s/iter; left time: 6106.8228s
Epoch: 1 cost time: 62.97005605697632
Epoch: 1, Steps: 208 | Train Loss: 4.682 Vali Loss: 7.560 Vali Acc: 0.041 Test Loss: 7.560 Test Acc: 0.041
Validation loss decreased (inf --> -0.040485).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.1208205
	speed: 0.7344s/iter; left time: 15050.7428s
	iters: 200, epoch: 2 | loss: 6.3974137
	speed: 0.3083s/iter; left time: 6286.7253s
Epoch: 2 cost time: 65.9866955280304
Epoch: 2, Steps: 208 | Train Loss: 5.202 Vali Loss: 9.345 Vali Acc: 0.037 Test Loss: 9.345 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.2645907
	speed: 0.7285s/iter; left time: 14776.9845s
	iters: 200, epoch: 3 | loss: 5.5647926
	speed: 0.2965s/iter; left time: 5985.8442s
Epoch: 3 cost time: 62.52642846107483
Epoch: 3, Steps: 208 | Train Loss: 4.978 Vali Loss: 8.402 Vali Acc: 0.058 Test Loss: 8.402 Test Acc: 0.058
Validation loss decreased (-0.040485 --> -0.057775).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6097293
	speed: 0.7159s/iter; left time: 14372.9999s
	iters: 200, epoch: 4 | loss: 4.0430374
	speed: 0.2842s/iter; left time: 5677.2400s
Epoch: 4 cost time: 60.106279134750366
Epoch: 4, Steps: 208 | Train Loss: 4.470 Vali Loss: 7.885 Vali Acc: 0.053 Test Loss: 7.885 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4755862
	speed: 0.7217s/iter; left time: 14338.7847s
	iters: 200, epoch: 5 | loss: 4.9308338
	speed: 0.2871s/iter; left time: 5675.9714s
Epoch: 5 cost time: 61.464900970458984
Epoch: 5, Steps: 208 | Train Loss: 3.898 Vali Loss: 5.564 Vali Acc: 0.051 Test Loss: 5.564 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.4291246
	speed: 0.6909s/iter; left time: 13584.1903s
	iters: 200, epoch: 6 | loss: 4.1540966
	speed: 0.2907s/iter; left time: 5686.6864s
Epoch: 6 cost time: 60.565868854522705
Epoch: 6, Steps: 208 | Train Loss: 3.835 Vali Loss: 4.430 Vali Acc: 0.051 Test Loss: 4.430 Test Acc: 0.051
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 4.3423271
	speed: 0.7767s/iter; left time: 15108.8819s
	iters: 200, epoch: 7 | loss: 4.4605298
	speed: 0.3071s/iter; left time: 5942.8975s
Epoch: 7 cost time: 66.87166905403137
Epoch: 7, Steps: 208 | Train Loss: 4.079 Vali Loss: 4.307 Vali Acc: 0.043 Test Loss: 4.307 Test Acc: 0.043
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 4.2900882
	speed: 0.7317s/iter; left time: 14082.2144s
	iters: 200, epoch: 8 | loss: 3.9890103
	speed: 0.2982s/iter; left time: 5709.1139s
Epoch: 8 cost time: 63.08288097381592
Epoch: 8, Steps: 208 | Train Loss: 4.140 Vali Loss: 4.004 Vali Acc: 0.031 Test Loss: 4.004 Test Acc: 0.031
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.6913598
	speed: 0.7158s/iter; left time: 13626.0307s
	iters: 200, epoch: 9 | loss: 3.7559977
	speed: 0.2991s/iter; left time: 5663.8734s
Epoch: 9 cost time: 63.07596755027771
Epoch: 9, Steps: 208 | Train Loss: 3.888 Vali Loss: 3.848 Vali Acc: 0.034 Test Loss: 3.848 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.6501577
	speed: 0.7562s/iter; left time: 14237.6901s
	iters: 200, epoch: 10 | loss: 3.9634278
	speed: 0.3274s/iter; left time: 6132.6264s
Epoch: 10 cost time: 67.53541326522827
Epoch: 10, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.734 Vali Acc: 0.037 Test Loss: 3.734 Test Acc: 0.037
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.7926924
	speed: 0.7588s/iter; left time: 14129.7655s
	iters: 200, epoch: 11 | loss: 3.6741850
	speed: 0.3251s/iter; left time: 6020.7463s
Epoch: 11 cost time: 66.89203524589539
Epoch: 11, Steps: 208 | Train Loss: 3.754 Vali Loss: 3.648 Vali Acc: 0.055 Test Loss: 3.648 Test Acc: 0.055
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.7864933
	speed: 0.7740s/iter; left time: 14252.3744s
	iters: 200, epoch: 12 | loss: 3.7075129
	speed: 0.3202s/iter; left time: 5864.6763s
Epoch: 12 cost time: 67.77432584762573
Epoch: 12, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.633 Vali Acc: 0.055 Test Loss: 3.633 Test Acc: 0.055
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.6888356
	speed: 0.7347s/iter; left time: 13375.1398s
	iters: 200, epoch: 13 | loss: 3.5852337
	speed: 0.3147s/iter; left time: 5697.3452s
Epoch: 13 cost time: 65.8206775188446
Epoch: 13, Steps: 208 | Train Loss: 3.628 Vali Loss: 3.623 Vali Acc: 0.051 Test Loss: 3.623 Test Acc: 0.051
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.057858634059051596
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8027139
	speed: 0.3193s/iter; left time: 6610.3638s
	iters: 200, epoch: 1 | loss: 4.4381423
	speed: 0.3008s/iter; left time: 6197.3130s
Epoch: 1 cost time: 64.72787809371948
Epoch: 1, Steps: 208 | Train Loss: 4.459 Vali Loss: 8.283 Vali Acc: 0.039 Test Loss: 8.283 Test Acc: 0.039
Validation loss decreased (inf --> -0.039285).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.8442140
	speed: 0.7318s/iter; left time: 14997.4275s
	iters: 200, epoch: 2 | loss: 7.0178008
	speed: 0.3115s/iter; left time: 6352.0984s
Epoch: 2 cost time: 64.85987138748169
Epoch: 2, Steps: 208 | Train Loss: 5.241 Vali Loss: 11.068 Vali Acc: 0.043 Test Loss: 11.068 Test Acc: 0.043
Validation loss decreased (-0.039285 --> -0.043134).  Saving model ...
	iters: 100, epoch: 3 | loss: 6.2956963
	speed: 0.7203s/iter; left time: 14610.8988s
	iters: 200, epoch: 3 | loss: 7.4360728
	speed: 0.2864s/iter; left time: 5780.2931s
Epoch: 3 cost time: 61.24498653411865
Epoch: 3, Steps: 208 | Train Loss: 5.969 Vali Loss: 12.117 Vali Acc: 0.043 Test Loss: 12.117 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.3955374
	speed: 0.6904s/iter; left time: 13861.5893s
	iters: 200, epoch: 4 | loss: 6.1520643
	speed: 0.2982s/iter; left time: 5956.6814s
Epoch: 4 cost time: 61.0112361907959
Epoch: 4, Steps: 208 | Train Loss: 6.314 Vali Loss: 12.230 Vali Acc: 0.053 Test Loss: 12.230 Test Acc: 0.053
Validation loss decreased (-0.043134 --> -0.053263).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.9510126
	speed: 0.7306s/iter; left time: 14515.4318s
	iters: 200, epoch: 5 | loss: 7.8068871
	speed: 0.3071s/iter; left time: 6071.1389s
Epoch: 5 cost time: 64.11731696128845
Epoch: 5, Steps: 208 | Train Loss: 5.510 Vali Loss: 5.654 Vali Acc: 0.042 Test Loss: 5.654 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3645971
	speed: 0.6872s/iter; left time: 13510.7325s
	iters: 200, epoch: 6 | loss: 4.2254744
	speed: 0.2814s/iter; left time: 5504.8776s
Epoch: 6 cost time: 59.14856696128845
Epoch: 6, Steps: 208 | Train Loss: 4.412 Vali Loss: 4.294 Vali Acc: 0.030 Test Loss: 4.294 Test Acc: 0.030
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.0707121
	speed: 0.7164s/iter; left time: 13936.9660s
	iters: 200, epoch: 7 | loss: 4.2552485
	speed: 0.3124s/iter; left time: 6045.6831s
Epoch: 7 cost time: 64.75553441047668
Epoch: 7, Steps: 208 | Train Loss: 4.140 Vali Loss: 4.086 Vali Acc: 0.032 Test Loss: 4.086 Test Acc: 0.032
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.8047330
	speed: 0.7409s/iter; left time: 14257.7332s
	iters: 200, epoch: 8 | loss: 3.7195077
	speed: 0.3133s/iter; left time: 5997.7688s
Epoch: 8 cost time: 65.32763886451721
Epoch: 8, Steps: 208 | Train Loss: 3.973 Vali Loss: 3.794 Vali Acc: 0.046 Test Loss: 3.794 Test Acc: 0.046
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.6970358
	speed: 0.7616s/iter; left time: 14498.3536s
	iters: 200, epoch: 9 | loss: 4.0220814
	speed: 0.3035s/iter; left time: 5746.7310s
Epoch: 9 cost time: 65.09889578819275
Epoch: 9, Steps: 208 | Train Loss: 3.846 Vali Loss: 3.806 Vali Acc: 0.032 Test Loss: 3.806 Test Acc: 0.032
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.8111894
	speed: 0.7250s/iter; left time: 13651.1019s
	iters: 200, epoch: 10 | loss: 3.7668483
	speed: 0.2953s/iter; left time: 5529.7849s
Epoch: 10 cost time: 62.71170687675476
Epoch: 10, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.769 Vali Acc: 0.047 Test Loss: 3.769 Test Acc: 0.047
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6599534
	speed: 0.7425s/iter; left time: 13825.4430s
	iters: 200, epoch: 11 | loss: 3.6272867
	speed: 0.3180s/iter; left time: 5889.3946s
Epoch: 11 cost time: 66.43323540687561
Epoch: 11, Steps: 208 | Train Loss: 3.719 Vali Loss: 3.708 Vali Acc: 0.047 Test Loss: 3.708 Test Acc: 0.047
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.3776600
	speed: 0.7403s/iter; left time: 13631.9792s
	iters: 200, epoch: 12 | loss: 3.9231470
	speed: 0.2930s/iter; left time: 5365.4083s
Epoch: 12 cost time: 63.2986524105072
Epoch: 12, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.692 Vali Acc: 0.035 Test Loss: 3.692 Test Acc: 0.035
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6433825
	speed: 0.7272s/iter; left time: 13238.1027s
	iters: 200, epoch: 13 | loss: 3.7934072
	speed: 0.3021s/iter; left time: 5469.6593s
Epoch: 13 cost time: 62.9536349773407
Epoch: 13, Steps: 208 | Train Loss: 3.664 Vali Loss: 3.668 Vali Acc: 0.048 Test Loss: 3.668 Test Acc: 0.048
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.7091160
	speed: 0.7291s/iter; left time: 13122.1831s
	iters: 200, epoch: 14 | loss: 3.6783752
	speed: 0.3137s/iter; left time: 5614.1871s
Epoch: 14 cost time: 65.45664548873901
Epoch: 14, Steps: 208 | Train Loss: 3.640 Vali Loss: 3.658 Vali Acc: 0.042 Test Loss: 3.658 Test Acc: 0.042
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.053385028332836267
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7438059
	speed: 0.3104s/iter; left time: 6425.8579s
	iters: 200, epoch: 1 | loss: 4.2864456
	speed: 0.2919s/iter; left time: 6013.4798s
Epoch: 1 cost time: 62.869091749191284
Epoch: 1, Steps: 208 | Train Loss: 4.399 Vali Loss: 7.565 Vali Acc: 0.041 Test Loss: 7.565 Test Acc: 0.041
Validation loss decreased (inf --> -0.040485).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.1520491
	speed: 0.7312s/iter; left time: 14984.0947s
	iters: 200, epoch: 2 | loss: 5.6152329
	speed: 0.2896s/iter; left time: 5904.9319s
Epoch: 2 cost time: 61.99894380569458
Epoch: 2, Steps: 208 | Train Loss: 4.823 Vali Loss: 10.075 Vali Acc: 0.042 Test Loss: 10.075 Test Acc: 0.042
Validation loss decreased (-0.040485 --> -0.042249).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.7020502
	speed: 0.7441s/iter; left time: 15094.7387s
	iters: 200, epoch: 3 | loss: 5.5843954
	speed: 0.2939s/iter; left time: 5931.7136s
Epoch: 3 cost time: 63.01720452308655
Epoch: 3, Steps: 208 | Train Loss: 5.346 Vali Loss: 11.491 Vali Acc: 0.051 Test Loss: 11.491 Test Acc: 0.051
Validation loss decreased (-0.042249 --> -0.051182).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.5765743
	speed: 0.7185s/iter; left time: 14424.3367s
	iters: 200, epoch: 4 | loss: 4.5800643
	speed: 0.2990s/iter; left time: 5972.2894s
Epoch: 4 cost time: 62.85302996635437
Epoch: 4, Steps: 208 | Train Loss: 5.718 Vali Loss: 13.936 Vali Acc: 0.046 Test Loss: 13.936 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.5576072
	speed: 0.7312s/iter; left time: 14528.9083s
	iters: 200, epoch: 5 | loss: 8.7806759
	speed: 0.2874s/iter; left time: 5681.5922s
Epoch: 5 cost time: 60.462207555770874
Epoch: 5, Steps: 208 | Train Loss: 5.314 Vali Loss: 11.485 Vali Acc: 0.054 Test Loss: 11.485 Test Acc: 0.054
Validation loss decreased (-0.051182 --> -0.053867).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.8218448
	speed: 0.7163s/iter; left time: 14082.8728s
	iters: 200, epoch: 6 | loss: 4.9185739
	speed: 0.3040s/iter; left time: 5946.9501s
Epoch: 6 cost time: 63.29237103462219
Epoch: 6, Steps: 208 | Train Loss: 4.533 Vali Loss: 7.536 Vali Acc: 0.043 Test Loss: 7.536 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.5300102
	speed: 0.7294s/iter; left time: 14188.8379s
	iters: 200, epoch: 7 | loss: 4.5060005
	speed: 0.2885s/iter; left time: 5582.6132s
Epoch: 7 cost time: 61.44650721549988
Epoch: 7, Steps: 208 | Train Loss: 3.823 Vali Loss: 4.973 Vali Acc: 0.049 Test Loss: 4.973 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 4.0888114
	speed: 0.7449s/iter; left time: 14336.3712s
	iters: 200, epoch: 8 | loss: 3.9667461
	speed: 0.3098s/iter; left time: 5931.2679s
Epoch: 8 cost time: 65.78877449035645
Epoch: 8, Steps: 208 | Train Loss: 4.044 Vali Loss: 4.220 Vali Acc: 0.024 Test Loss: 4.220 Test Acc: 0.024
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 4.1446991
	speed: 0.7439s/iter; left time: 14160.8154s
	iters: 200, epoch: 9 | loss: 3.8064392
	speed: 0.3025s/iter; left time: 5727.7328s
Epoch: 9 cost time: 64.46648097038269
Epoch: 9, Steps: 208 | Train Loss: 4.018 Vali Loss: 3.831 Vali Acc: 0.032 Test Loss: 3.831 Test Acc: 0.032
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 4.2846489
	speed: 0.7698s/iter; left time: 14493.9049s
	iters: 200, epoch: 10 | loss: 4.2536774
	speed: 0.3248s/iter; left time: 6082.3429s
Epoch: 10 cost time: 67.99037384986877
Epoch: 10, Steps: 208 | Train Loss: 3.852 Vali Loss: 3.767 Vali Acc: 0.030 Test Loss: 3.767 Test Acc: 0.030
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.6057515
	speed: 0.7315s/iter; left time: 13620.9907s
	iters: 200, epoch: 11 | loss: 3.6733153
	speed: 0.3134s/iter; left time: 5804.3385s
Epoch: 11 cost time: 63.90409302711487
Epoch: 11, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.741 Vali Acc: 0.027 Test Loss: 3.741 Test Acc: 0.027
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6757951
	speed: 0.7509s/iter; left time: 13825.7733s
	iters: 200, epoch: 12 | loss: 3.6088078
	speed: 0.2992s/iter; left time: 5480.0646s
Epoch: 12 cost time: 63.534003257751465
Epoch: 12, Steps: 208 | Train Loss: 3.743 Vali Loss: 3.750 Vali Acc: 0.028 Test Loss: 3.750 Test Acc: 0.028
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7118254
	speed: 0.7637s/iter; left time: 13903.6282s
	iters: 200, epoch: 13 | loss: 3.7489676
	speed: 0.3193s/iter; left time: 5780.6405s
Epoch: 13 cost time: 67.85234475135803
Epoch: 13, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.757 Vali Acc: 0.034 Test Loss: 3.757 Test Acc: 0.034
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.9713953
	speed: 0.7354s/iter; left time: 13235.7715s
	iters: 200, epoch: 14 | loss: 3.6828187
	speed: 0.3180s/iter; left time: 5692.0447s
Epoch: 14 cost time: 64.42745423316956
Epoch: 14, Steps: 208 | Train Loss: 3.716 Vali Loss: 3.693 Vali Acc: 0.031 Test Loss: 3.693 Test Acc: 0.031
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.8015118
	speed: 0.7440s/iter; left time: 13235.5485s
	iters: 200, epoch: 15 | loss: 3.6775482
	speed: 0.2891s/iter; left time: 5113.2208s
Epoch: 15 cost time: 61.62493062019348
Epoch: 15, Steps: 208 | Train Loss: 3.704 Vali Loss: 3.685 Vali Acc: 0.035 Test Loss: 3.685 Test Acc: 0.035
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05398150909633164
model parameter : 15254055
model size : 77.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6422443
	speed: 0.3341s/iter; left time: 6917.1604s
	iters: 200, epoch: 1 | loss: 3.9226224
	speed: 0.3079s/iter; left time: 6342.7244s
Epoch: 1 cost time: 67.093985080719
Epoch: 1, Steps: 208 | Train Loss: 4.014 Vali Loss: 4.009 Vali Acc: 0.065 Test Loss: 4.009 Test Acc: 0.065
Validation loss decreased (inf --> -0.064678).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2972438
	speed: 0.7295s/iter; left time: 14949.6570s
	iters: 200, epoch: 2 | loss: 3.3398888
	speed: 0.3052s/iter; left time: 6224.2840s
Epoch: 2 cost time: 63.728519678115845
Epoch: 2, Steps: 208 | Train Loss: 3.374 Vali Loss: 4.071 Vali Acc: 0.079 Test Loss: 4.071 Test Acc: 0.079
Validation loss decreased (-0.064678 --> -0.079291).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1873300
	speed: 0.7630s/iter; left time: 15476.9381s
	iters: 200, epoch: 3 | loss: 3.9262702
	speed: 0.3040s/iter; left time: 6135.7599s
Epoch: 3 cost time: 64.76484489440918
Epoch: 3, Steps: 208 | Train Loss: 2.732 Vali Loss: 4.205 Vali Acc: 0.081 Test Loss: 4.205 Test Acc: 0.081
Validation loss decreased (-0.079291 --> -0.081378).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9194417
	speed: 0.7439s/iter; left time: 14934.7354s
	iters: 200, epoch: 4 | loss: 2.3152776
	speed: 0.3130s/iter; left time: 6252.7478s
Epoch: 4 cost time: 65.59057807922363
Epoch: 4, Steps: 208 | Train Loss: 2.090 Vali Loss: 5.354 Vali Acc: 0.087 Test Loss: 5.354 Test Acc: 0.087
Validation loss decreased (-0.081378 --> -0.087331).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1646416
	speed: 0.7478s/iter; left time: 14857.5120s
	iters: 200, epoch: 5 | loss: 3.4581933
	speed: 0.2912s/iter; left time: 5757.1999s
Epoch: 5 cost time: 63.04422044754028
Epoch: 5, Steps: 208 | Train Loss: 1.605 Vali Loss: 6.041 Vali Acc: 0.068 Test Loss: 6.041 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6743268
	speed: 0.7284s/iter; left time: 14321.3891s
	iters: 200, epoch: 6 | loss: 1.5011283
	speed: 0.2926s/iter; left time: 5723.4824s
Epoch: 6 cost time: 61.57976746559143
Epoch: 6, Steps: 208 | Train Loss: 1.300 Vali Loss: 6.595 Vali Acc: 0.082 Test Loss: 6.595 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4875873
	speed: 0.7392s/iter; left time: 14380.4995s
	iters: 200, epoch: 7 | loss: 1.1104566
	speed: 0.3104s/iter; left time: 6006.7588s
Epoch: 7 cost time: 65.37040662765503
Epoch: 7, Steps: 208 | Train Loss: 1.097 Vali Loss: 7.544 Vali Acc: 0.075 Test Loss: 7.544 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3202474
	speed: 0.7631s/iter; left time: 14686.6752s
	iters: 200, epoch: 8 | loss: 1.7999324
	speed: 0.3121s/iter; left time: 5974.2370s
Epoch: 8 cost time: 65.42887234687805
Epoch: 8, Steps: 208 | Train Loss: 0.898 Vali Loss: 8.605 Vali Acc: 0.078 Test Loss: 8.605 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.4443105
	speed: 0.7470s/iter; left time: 14221.4629s
	iters: 200, epoch: 9 | loss: 0.6925062
	speed: 0.2926s/iter; left time: 5540.9195s
Epoch: 9 cost time: 62.519015312194824
Epoch: 9, Steps: 208 | Train Loss: 0.851 Vali Loss: 8.757 Vali Acc: 0.079 Test Loss: 8.757 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4061010
	speed: 0.7049s/iter; left time: 13272.3224s
	iters: 200, epoch: 10 | loss: 1.4601599
	speed: 0.3012s/iter; left time: 5641.6691s
Epoch: 10 cost time: 62.29629611968994
Epoch: 10, Steps: 208 | Train Loss: 0.693 Vali Loss: 9.660 Vali Acc: 0.082 Test Loss: 9.660 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4961682
	speed: 0.7375s/iter; left time: 13733.8782s
	iters: 200, epoch: 11 | loss: 0.7297991
	speed: 0.2980s/iter; left time: 5518.7444s
Epoch: 11 cost time: 62.315072774887085
Epoch: 11, Steps: 208 | Train Loss: 0.583 Vali Loss: 10.189 Vali Acc: 0.074 Test Loss: 10.189 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3422823
	speed: 0.7422s/iter; left time: 13666.1639s
	iters: 200, epoch: 12 | loss: 0.2111462
	speed: 0.3041s/iter; left time: 5569.3803s
Epoch: 12 cost time: 64.95622563362122
Epoch: 12, Steps: 208 | Train Loss: 0.575 Vali Loss: 10.780 Vali Acc: 0.076 Test Loss: 10.780 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6452193
	speed: 0.7149s/iter; left time: 13015.1043s
	iters: 200, epoch: 13 | loss: 0.4581068
	speed: 0.2963s/iter; left time: 5363.9377s
Epoch: 13 cost time: 61.63718605041504
Epoch: 13, Steps: 208 | Train Loss: 0.455 Vali Loss: 10.965 Vali Acc: 0.068 Test Loss: 10.965 Test Acc: 0.068
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1674865
	speed: 0.7403s/iter; left time: 13322.5956s
	iters: 200, epoch: 14 | loss: 0.0265229
	speed: 0.3234s/iter; left time: 5787.9573s
Epoch: 14 cost time: 66.22319436073303
Epoch: 14, Steps: 208 | Train Loss: 0.411 Vali Loss: 11.153 Vali Acc: 0.078 Test Loss: 11.153 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08738443185207277
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9432993
	speed: 0.3242s/iter; left time: 6711.5983s
	iters: 200, epoch: 1 | loss: 3.9726710
	speed: 0.3088s/iter; left time: 6361.5424s
Epoch: 1 cost time: 66.27183794975281
Epoch: 1, Steps: 208 | Train Loss: 4.022 Vali Loss: 3.924 Vali Acc: 0.069 Test Loss: 3.924 Test Acc: 0.069
Validation loss decreased (inf --> -0.069153).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9619079
	speed: 0.7304s/iter; left time: 14968.6029s
	iters: 200, epoch: 2 | loss: 3.3712897
	speed: 0.3180s/iter; left time: 6485.2754s
Epoch: 2 cost time: 64.67027163505554
Epoch: 2, Steps: 208 | Train Loss: 3.348 Vali Loss: 4.117 Vali Acc: 0.078 Test Loss: 4.117 Test Acc: 0.078
Validation loss decreased (-0.069153 --> -0.077501).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1658885
	speed: 0.7568s/iter; left time: 15350.7301s
	iters: 200, epoch: 3 | loss: 3.5275767
	speed: 0.3253s/iter; left time: 6565.5997s
Epoch: 3 cost time: 66.97862648963928
Epoch: 3, Steps: 208 | Train Loss: 2.717 Vali Loss: 4.394 Vali Acc: 0.076 Test Loss: 4.394 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8799430
	speed: 0.7555s/iter; left time: 15168.1971s
	iters: 200, epoch: 4 | loss: 2.5051892
	speed: 0.3081s/iter; left time: 6155.2225s
Epoch: 4 cost time: 63.690518379211426
Epoch: 4, Steps: 208 | Train Loss: 2.063 Vali Loss: 5.505 Vali Acc: 0.083 Test Loss: 5.505 Test Acc: 0.083
Validation loss decreased (-0.077501 --> -0.083154).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5416650
	speed: 0.7290s/iter; left time: 14483.5236s
	iters: 200, epoch: 5 | loss: 3.6193058
	speed: 0.3256s/iter; left time: 6436.8809s
Epoch: 5 cost time: 65.8887243270874
Epoch: 5, Steps: 208 | Train Loss: 1.594 Vali Loss: 6.072 Vali Acc: 0.074 Test Loss: 6.072 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1655073
	speed: 0.7880s/iter; left time: 15492.4714s
	iters: 200, epoch: 6 | loss: 1.8496472
	speed: 0.3198s/iter; left time: 6255.3442s
Epoch: 6 cost time: 68.28667163848877
Epoch: 6, Steps: 208 | Train Loss: 1.268 Vali Loss: 6.891 Vali Acc: 0.075 Test Loss: 6.891 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6797205
	speed: 0.7500s/iter; left time: 14589.6155s
	iters: 200, epoch: 7 | loss: 1.2747688
	speed: 0.2809s/iter; left time: 5435.9310s
Epoch: 7 cost time: 60.87711215019226
Epoch: 7, Steps: 208 | Train Loss: 1.084 Vali Loss: 7.487 Vali Acc: 0.075 Test Loss: 7.487 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6271163
	speed: 0.7229s/iter; left time: 13911.5807s
	iters: 200, epoch: 8 | loss: 0.8454627
	speed: 0.2844s/iter; left time: 5444.8715s
Epoch: 8 cost time: 62.11179828643799
Epoch: 8, Steps: 208 | Train Loss: 0.985 Vali Loss: 8.587 Vali Acc: 0.078 Test Loss: 8.587 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4543801
	speed: 0.7366s/iter; left time: 14023.3734s
	iters: 200, epoch: 9 | loss: 1.4936893
	speed: 0.3364s/iter; left time: 6369.8773s
Epoch: 9 cost time: 68.59041142463684
Epoch: 9, Steps: 208 | Train Loss: 0.735 Vali Loss: 8.729 Vali Acc: 0.076 Test Loss: 8.729 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6103947
	speed: 0.7693s/iter; left time: 14485.9083s
	iters: 200, epoch: 10 | loss: 0.8679836
	speed: 0.3114s/iter; left time: 5832.0128s
Epoch: 10 cost time: 66.74815845489502
Epoch: 10, Steps: 208 | Train Loss: 0.651 Vali Loss: 10.345 Vali Acc: 0.075 Test Loss: 10.345 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3295323
	speed: 0.7509s/iter; left time: 13983.2518s
	iters: 200, epoch: 11 | loss: 0.2559055
	speed: 0.3136s/iter; left time: 5808.3725s
Epoch: 11 cost time: 67.41385102272034
Epoch: 11, Steps: 208 | Train Loss: 0.583 Vali Loss: 10.228 Vali Acc: 0.081 Test Loss: 10.228 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0713850
	speed: 0.7447s/iter; left time: 13712.2398s
	iters: 200, epoch: 12 | loss: 0.5168367
	speed: 0.3287s/iter; left time: 6019.1365s
Epoch: 12 cost time: 67.91497039794922
Epoch: 12, Steps: 208 | Train Loss: 0.489 Vali Loss: 9.967 Vali Acc: 0.073 Test Loss: 9.967 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0653490
	speed: 0.7499s/iter; left time: 13651.0372s
	iters: 200, epoch: 13 | loss: 0.4480450
	speed: 0.3272s/iter; left time: 5924.2140s
Epoch: 13 cost time: 68.67161011695862
Epoch: 13, Steps: 208 | Train Loss: 0.448 Vali Loss: 11.300 Vali Acc: 0.079 Test Loss: 11.300 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0246666
	speed: 0.7072s/iter; left time: 12727.8463s
	iters: 200, epoch: 14 | loss: 0.9343712
	speed: 0.2943s/iter; left time: 5266.3610s
Epoch: 14 cost time: 61.620729207992554
Epoch: 14, Steps: 208 | Train Loss: 0.405 Vali Loss: 10.385 Vali Acc: 0.069 Test Loss: 10.385 Test Acc: 0.069
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08320906650760512
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9356685
	speed: 0.3144s/iter; left time: 6508.2445s
	iters: 200, epoch: 1 | loss: 3.9378531
	speed: 0.2968s/iter; left time: 6114.5830s
Epoch: 1 cost time: 63.898783922195435
Epoch: 1, Steps: 208 | Train Loss: 4.022 Vali Loss: 3.918 Vali Acc: 0.069 Test Loss: 3.918 Test Acc: 0.069
Validation loss decreased (inf --> -0.068854).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0159068
	speed: 0.7171s/iter; left time: 14696.0029s
	iters: 200, epoch: 2 | loss: 3.2195568
	speed: 0.2941s/iter; left time: 5998.5084s
Epoch: 2 cost time: 62.18498158454895
Epoch: 2, Steps: 208 | Train Loss: 3.394 Vali Loss: 4.254 Vali Acc: 0.080 Test Loss: 4.254 Test Acc: 0.080
Validation loss decreased (-0.068854 --> -0.079588).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3266826
	speed: 0.7144s/iter; left time: 14490.6877s
	iters: 200, epoch: 3 | loss: 3.5156345
	speed: 0.3191s/iter; left time: 6440.3994s
Epoch: 3 cost time: 64.53714942932129
Epoch: 3, Steps: 208 | Train Loss: 2.756 Vali Loss: 4.430 Vali Acc: 0.092 Test Loss: 4.430 Test Acc: 0.092
Validation loss decreased (-0.079588 --> -0.092112).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9320521
	speed: 0.7099s/iter; left time: 14252.2224s
	iters: 200, epoch: 4 | loss: 2.1976452
	speed: 0.2772s/iter; left time: 5537.4437s
Epoch: 4 cost time: 59.45978236198425
Epoch: 4, Steps: 208 | Train Loss: 2.152 Vali Loss: 5.563 Vali Acc: 0.070 Test Loss: 5.563 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4793462
	speed: 0.7675s/iter; left time: 15249.2687s
	iters: 200, epoch: 5 | loss: 3.1761684
	speed: 0.2905s/iter; left time: 5742.4459s
Epoch: 5 cost time: 62.78684878349304
Epoch: 5, Steps: 208 | Train Loss: 1.627 Vali Loss: 5.834 Vali Acc: 0.074 Test Loss: 5.834 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1511619
	speed: 0.7375s/iter; left time: 14499.0929s
	iters: 200, epoch: 6 | loss: 2.3345008
	speed: 0.3090s/iter; left time: 6044.3291s
Epoch: 6 cost time: 65.80369448661804
Epoch: 6, Steps: 208 | Train Loss: 1.364 Vali Loss: 6.949 Vali Acc: 0.075 Test Loss: 6.949 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3757018
	speed: 0.7497s/iter; left time: 14584.3377s
	iters: 200, epoch: 7 | loss: 1.3583159
	speed: 0.3146s/iter; left time: 6089.3794s
Epoch: 7 cost time: 65.92024660110474
Epoch: 7, Steps: 208 | Train Loss: 1.137 Vali Loss: 7.921 Vali Acc: 0.074 Test Loss: 7.921 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6053690
	speed: 0.7632s/iter; left time: 14687.9938s
	iters: 200, epoch: 8 | loss: 2.6109540
	speed: 0.3352s/iter; left time: 6417.3822s
Epoch: 8 cost time: 69.937091588974
Epoch: 8, Steps: 208 | Train Loss: 0.964 Vali Loss: 7.999 Vali Acc: 0.070 Test Loss: 7.999 Test Acc: 0.070
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.5468554
	speed: 0.7793s/iter; left time: 14836.1139s
	iters: 200, epoch: 9 | loss: 1.1688814
	speed: 0.3143s/iter; left time: 5952.0692s
Epoch: 9 cost time: 67.20073676109314
Epoch: 9, Steps: 208 | Train Loss: 0.800 Vali Loss: 8.534 Vali Acc: 0.085 Test Loss: 8.534 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1724913
	speed: 0.7474s/iter; left time: 14073.0407s
	iters: 200, epoch: 10 | loss: 1.3540986
	speed: 0.3341s/iter; left time: 6258.1262s
Epoch: 10 cost time: 69.06880283355713
Epoch: 10, Steps: 208 | Train Loss: 0.670 Vali Loss: 9.641 Vali Acc: 0.072 Test Loss: 9.641 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4078800
	speed: 0.7554s/iter; left time: 14067.0146s
	iters: 200, epoch: 11 | loss: 0.2523584
	speed: 0.3285s/iter; left time: 6084.5808s
Epoch: 11 cost time: 67.47208333015442
Epoch: 11, Steps: 208 | Train Loss: 0.550 Vali Loss: 10.297 Vali Acc: 0.074 Test Loss: 10.297 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3811616
	speed: 0.7815s/iter; left time: 14389.2862s
	iters: 200, epoch: 12 | loss: 1.1560020
	speed: 0.3214s/iter; left time: 5886.3309s
Epoch: 12 cost time: 66.88011384010315
Epoch: 12, Steps: 208 | Train Loss: 0.531 Vali Loss: 10.010 Vali Acc: 0.069 Test Loss: 10.010 Test Acc: 0.069
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6225035
	speed: 0.7451s/iter; left time: 13564.7323s
	iters: 200, epoch: 13 | loss: 1.6815717
	speed: 0.3313s/iter; left time: 5998.2332s
Epoch: 13 cost time: 66.90978598594666
Epoch: 13, Steps: 208 | Train Loss: 0.494 Vali Loss: 11.127 Vali Acc: 0.072 Test Loss: 11.127 Test Acc: 0.072
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0921562779600358
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4782259
	speed: 0.2915s/iter; left time: 6034.5448s
	iters: 200, epoch: 1 | loss: 3.9489431
	speed: 0.3008s/iter; left time: 6197.1717s
Epoch: 1 cost time: 61.741451263427734
Epoch: 1, Steps: 208 | Train Loss: 4.013 Vali Loss: 3.878 Vali Acc: 0.065 Test Loss: 3.878 Test Acc: 0.065
Validation loss decreased (inf --> -0.064978).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2842181
	speed: 0.7013s/iter; left time: 14372.7314s
	iters: 200, epoch: 2 | loss: 3.6818485
	speed: 0.2848s/iter; left time: 5807.0954s
Epoch: 2 cost time: 59.39380359649658
Epoch: 2, Steps: 208 | Train Loss: 3.340 Vali Loss: 4.079 Vali Acc: 0.084 Test Loss: 4.079 Test Acc: 0.084
Validation loss decreased (-0.064978 --> -0.084063).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1869354
	speed: 0.6868s/iter; left time: 13932.6186s
	iters: 200, epoch: 3 | loss: 4.3187704
	speed: 0.2864s/iter; left time: 5781.6905s
Epoch: 3 cost time: 59.509679317474365
Epoch: 3, Steps: 208 | Train Loss: 2.743 Vali Loss: 4.475 Vali Acc: 0.089 Test Loss: 4.475 Test Acc: 0.089
Validation loss decreased (-0.084063 --> -0.089427).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5302310
	speed: 0.7109s/iter; left time: 14272.5593s
	iters: 200, epoch: 4 | loss: 2.1666005
	speed: 0.3047s/iter; left time: 6086.6074s
Epoch: 4 cost time: 62.65089988708496
Epoch: 4, Steps: 208 | Train Loss: 2.136 Vali Loss: 5.459 Vali Acc: 0.086 Test Loss: 5.459 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1819863
	speed: 0.7608s/iter; left time: 15116.8255s
	iters: 200, epoch: 5 | loss: 3.9037561
	speed: 0.3231s/iter; left time: 6387.8385s
Epoch: 5 cost time: 66.41099953651428
Epoch: 5, Steps: 208 | Train Loss: 1.625 Vali Loss: 6.065 Vali Acc: 0.072 Test Loss: 6.065 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3265760
	speed: 0.7290s/iter; left time: 14332.5950s
	iters: 200, epoch: 6 | loss: 1.6217422
	speed: 0.2971s/iter; left time: 5810.8111s
Epoch: 6 cost time: 62.592897176742554
Epoch: 6, Steps: 208 | Train Loss: 1.288 Vali Loss: 6.685 Vali Acc: 0.085 Test Loss: 6.685 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5940448
	speed: 0.7567s/iter; left time: 14720.0225s
	iters: 200, epoch: 7 | loss: 2.0490172
	speed: 0.3034s/iter; left time: 5871.1305s
Epoch: 7 cost time: 64.56915402412415
Epoch: 7, Steps: 208 | Train Loss: 1.121 Vali Loss: 7.480 Vali Acc: 0.075 Test Loss: 7.480 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6175367
	speed: 0.7428s/iter; left time: 14295.7261s
	iters: 200, epoch: 8 | loss: 1.3010668
	speed: 0.3176s/iter; left time: 6080.8468s
Epoch: 8 cost time: 65.61796927452087
Epoch: 8, Steps: 208 | Train Loss: 0.909 Vali Loss: 8.209 Vali Acc: 0.084 Test Loss: 8.209 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2129239
	speed: 0.7645s/iter; left time: 14553.3457s
	iters: 200, epoch: 9 | loss: 0.6775016
	speed: 0.2967s/iter; left time: 5619.3907s
Epoch: 9 cost time: 64.07353711128235
Epoch: 9, Steps: 208 | Train Loss: 0.766 Vali Loss: 8.325 Vali Acc: 0.084 Test Loss: 8.325 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.8733792
	speed: 0.7407s/iter; left time: 13946.2932s
	iters: 200, epoch: 10 | loss: 1.1959463
	speed: 0.3119s/iter; left time: 5841.1437s
Epoch: 10 cost time: 65.50288701057434
Epoch: 10, Steps: 208 | Train Loss: 0.677 Vali Loss: 8.889 Vali Acc: 0.082 Test Loss: 8.889 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3834660
	speed: 0.7569s/iter; left time: 14094.9538s
	iters: 200, epoch: 11 | loss: 0.4309264
	speed: 0.3138s/iter; left time: 5811.0570s
Epoch: 11 cost time: 65.10179996490479
Epoch: 11, Steps: 208 | Train Loss: 0.609 Vali Loss: 9.611 Vali Acc: 0.081 Test Loss: 9.611 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3510359
	speed: 0.7438s/iter; left time: 13695.2263s
	iters: 200, epoch: 12 | loss: 0.3796986
	speed: 0.2944s/iter; left time: 5391.3771s
Epoch: 12 cost time: 62.749027252197266
Epoch: 12, Steps: 208 | Train Loss: 0.495 Vali Loss: 9.919 Vali Acc: 0.081 Test Loss: 9.919 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.1254776
	speed: 0.7415s/iter; left time: 13499.4945s
	iters: 200, epoch: 13 | loss: 0.5727188
	speed: 0.3014s/iter; left time: 5456.1442s
Epoch: 13 cost time: 64.02678608894348
Epoch: 13, Steps: 208 | Train Loss: 0.461 Vali Loss: 10.972 Vali Acc: 0.084 Test Loss: 10.972 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08947211452430659
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6380806
	speed: 0.2953s/iter; left time: 6113.4194s
	iters: 200, epoch: 1 | loss: 3.8390625
	speed: 0.2873s/iter; left time: 5918.6249s
Epoch: 1 cost time: 60.83325386047363
Epoch: 1, Steps: 208 | Train Loss: 3.988 Vali Loss: 4.263 Vali Acc: 0.072 Test Loss: 4.263 Test Acc: 0.072
Validation loss decreased (inf --> -0.071833).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5904810
	speed: 0.6973s/iter; left time: 14290.0817s
	iters: 200, epoch: 2 | loss: 3.8700609
	speed: 0.2845s/iter; left time: 5801.6505s
Epoch: 2 cost time: 59.22614002227783
Epoch: 2, Steps: 208 | Train Loss: 3.342 Vali Loss: 4.186 Vali Acc: 0.079 Test Loss: 4.186 Test Acc: 0.079
Validation loss decreased (-0.071833 --> -0.079290).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7025192
	speed: 0.7258s/iter; left time: 14722.8169s
	iters: 200, epoch: 3 | loss: 3.3088083
	speed: 0.2886s/iter; left time: 5826.3010s
Epoch: 3 cost time: 61.49355483055115
Epoch: 3, Steps: 208 | Train Loss: 2.789 Vali Loss: 4.684 Vali Acc: 0.082 Test Loss: 4.684 Test Acc: 0.082
Validation loss decreased (-0.079290 --> -0.082268).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2452431
	speed: 0.7146s/iter; left time: 14347.8574s
	iters: 200, epoch: 4 | loss: 2.8869450
	speed: 0.2899s/iter; left time: 5790.6659s
Epoch: 4 cost time: 60.94170522689819
Epoch: 4, Steps: 208 | Train Loss: 2.291 Vali Loss: 5.094 Vali Acc: 0.076 Test Loss: 5.094 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1957011
	speed: 0.7054s/iter; left time: 14014.8646s
	iters: 200, epoch: 5 | loss: 4.1590838
	speed: 0.3054s/iter; left time: 6038.3286s
Epoch: 5 cost time: 63.73658514022827
Epoch: 5, Steps: 208 | Train Loss: 1.801 Vali Loss: 5.572 Vali Acc: 0.073 Test Loss: 5.572 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2771866
	speed: 0.7037s/iter; left time: 13834.5346s
	iters: 200, epoch: 6 | loss: 2.0965817
	speed: 0.2811s/iter; left time: 5498.9174s
Epoch: 6 cost time: 59.14579916000366
Epoch: 6, Steps: 208 | Train Loss: 1.498 Vali Loss: 6.861 Vali Acc: 0.098 Test Loss: 6.861 Test Acc: 0.098
Validation loss decreased (-0.082268 --> -0.097456).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2008836
	speed: 0.7298s/iter; left time: 14197.7296s
	iters: 200, epoch: 7 | loss: 1.6112347
	speed: 0.2973s/iter; left time: 5754.2517s
Epoch: 7 cost time: 63.19567131996155
Epoch: 7, Steps: 208 | Train Loss: 1.271 Vali Loss: 7.421 Vali Acc: 0.080 Test Loss: 7.421 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5806421
	speed: 0.7238s/iter; left time: 13929.1436s
	iters: 200, epoch: 8 | loss: 1.0410587
	speed: 0.2896s/iter; left time: 5543.7164s
Epoch: 8 cost time: 61.31899857521057
Epoch: 8, Steps: 208 | Train Loss: 1.065 Vali Loss: 7.636 Vali Acc: 0.083 Test Loss: 7.636 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4590447
	speed: 0.7203s/iter; left time: 13711.4681s
	iters: 200, epoch: 9 | loss: 0.3126546
	speed: 0.2957s/iter; left time: 5599.8195s
Epoch: 9 cost time: 62.88484787940979
Epoch: 9, Steps: 208 | Train Loss: 0.896 Vali Loss: 8.774 Vali Acc: 0.081 Test Loss: 8.774 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0929930
	speed: 0.6996s/iter; left time: 13172.6723s
	iters: 200, epoch: 10 | loss: 1.4893813
	speed: 0.2922s/iter; left time: 5471.8903s
Epoch: 10 cost time: 60.77862286567688
Epoch: 10, Steps: 208 | Train Loss: 0.853 Vali Loss: 8.937 Vali Acc: 0.079 Test Loss: 8.937 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9758277
	speed: 0.7398s/iter; left time: 13775.2667s
	iters: 200, epoch: 11 | loss: 0.3508663
	speed: 0.2987s/iter; left time: 5532.6454s
Epoch: 11 cost time: 64.11924242973328
Epoch: 11, Steps: 208 | Train Loss: 0.652 Vali Loss: 9.556 Vali Acc: 0.078 Test Loss: 9.556 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.9498294
	speed: 0.6802s/iter; left time: 12525.3759s
	iters: 200, epoch: 12 | loss: 0.6250733
	speed: 0.2751s/iter; left time: 5037.8437s
Epoch: 12 cost time: 58.2144250869751
Epoch: 12, Steps: 208 | Train Loss: 0.701 Vali Loss: 9.661 Vali Acc: 0.083 Test Loss: 9.661 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6804520
	speed: 0.7057s/iter; left time: 12846.3730s
	iters: 200, epoch: 13 | loss: 0.8098432
	speed: 0.2825s/iter; left time: 5114.5991s
Epoch: 13 cost time: 60.45504641532898
Epoch: 13, Steps: 208 | Train Loss: 0.557 Vali Loss: 9.158 Vali Acc: 0.086 Test Loss: 9.158 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4266850
	speed: 0.6644s/iter; left time: 11956.6981s
	iters: 200, epoch: 14 | loss: 0.6033034
	speed: 0.2859s/iter; left time: 5116.1464s
Epoch: 14 cost time: 59.46980547904968
Epoch: 14, Steps: 208 | Train Loss: 0.477 Vali Loss: 10.150 Vali Acc: 0.075 Test Loss: 10.150 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2353262
	speed: 0.7101s/iter; left time: 12631.7788s
	iters: 200, epoch: 15 | loss: 0.3373993
	speed: 0.2789s/iter; left time: 4933.9045s
Epoch: 15 cost time: 60.28353834152222
Epoch: 15, Steps: 208 | Train Loss: 0.490 Vali Loss: 10.177 Vali Acc: 0.090 Test Loss: 10.177 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.4027888
	speed: 0.6477s/iter; left time: 11387.4467s
	iters: 200, epoch: 16 | loss: 0.6824785
	speed: 0.2851s/iter; left time: 4984.0934s
Epoch: 16 cost time: 58.551356077194214
Epoch: 16, Steps: 208 | Train Loss: 0.438 Vali Loss: 10.116 Vali Acc: 0.095 Test Loss: 10.116 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09752460483149418
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3750670
	speed: 0.3007s/iter; left time: 6224.8524s
	iters: 200, epoch: 1 | loss: 4.2631412
	speed: 0.2899s/iter; left time: 5972.4482s
Epoch: 1 cost time: 61.71863579750061
Epoch: 1, Steps: 208 | Train Loss: 3.953 Vali Loss: 4.689 Vali Acc: 0.081 Test Loss: 4.689 Test Acc: 0.081
Validation loss decreased (inf --> -0.081373).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5104015
	speed: 0.6706s/iter; left time: 13743.2415s
	iters: 200, epoch: 2 | loss: 3.9853921
	speed: 0.3010s/iter; left time: 6138.1053s
Epoch: 2 cost time: 61.874887466430664
Epoch: 2, Steps: 208 | Train Loss: 3.374 Vali Loss: 4.474 Vali Acc: 0.095 Test Loss: 4.474 Test Acc: 0.095
Validation loss decreased (-0.081373 --> -0.094796).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7026227
	speed: 0.6744s/iter; left time: 13680.6242s
	iters: 200, epoch: 3 | loss: 4.0349832
	speed: 0.2729s/iter; left time: 5508.9194s
Epoch: 3 cost time: 57.80981469154358
Epoch: 3, Steps: 208 | Train Loss: 2.875 Vali Loss: 4.696 Vali Acc: 0.094 Test Loss: 4.696 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3465500
	speed: 0.6635s/iter; left time: 13321.2350s
	iters: 200, epoch: 4 | loss: 3.3382683
	speed: 0.2929s/iter; left time: 5851.7247s
Epoch: 4 cost time: 61.77090620994568
Epoch: 4, Steps: 208 | Train Loss: 2.480 Vali Loss: 4.907 Vali Acc: 0.088 Test Loss: 4.907 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.8026744
	speed: 0.6877s/iter; left time: 13663.0518s
	iters: 200, epoch: 5 | loss: 3.6896827
	speed: 0.2718s/iter; left time: 5372.7913s
Epoch: 5 cost time: 58.46126747131348
Epoch: 5, Steps: 208 | Train Loss: 2.131 Vali Loss: 5.497 Vali Acc: 0.067 Test Loss: 5.497 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.3485363
	speed: 0.6516s/iter; left time: 12810.2145s
	iters: 200, epoch: 6 | loss: 2.9231532
	speed: 0.2854s/iter; left time: 5582.9652s
Epoch: 6 cost time: 60.219324588775635
Epoch: 6, Steps: 208 | Train Loss: 1.864 Vali Loss: 5.611 Vali Acc: 0.088 Test Loss: 5.611 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.5058695
	speed: 0.6628s/iter; left time: 12892.6705s
	iters: 200, epoch: 7 | loss: 1.5684615
	speed: 0.2718s/iter; left time: 5260.7919s
Epoch: 7 cost time: 57.45320129394531
Epoch: 7, Steps: 208 | Train Loss: 1.664 Vali Loss: 7.011 Vali Acc: 0.081 Test Loss: 7.011 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.1149712
	speed: 0.6571s/iter; left time: 12646.5684s
	iters: 200, epoch: 8 | loss: 1.0366547
	speed: 0.2770s/iter; left time: 5302.4565s
Epoch: 8 cost time: 58.72677969932556
Epoch: 8, Steps: 208 | Train Loss: 1.409 Vali Loss: 6.954 Vali Acc: 0.081 Test Loss: 6.954 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8832873
	speed: 0.6567s/iter; left time: 12502.4842s
	iters: 200, epoch: 9 | loss: 0.5255403
	speed: 0.2744s/iter; left time: 5196.8012s
Epoch: 9 cost time: 57.29364061355591
Epoch: 9, Steps: 208 | Train Loss: 1.256 Vali Loss: 7.140 Vali Acc: 0.083 Test Loss: 7.140 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.7305181
	speed: 0.6504s/iter; left time: 12246.5136s
	iters: 200, epoch: 10 | loss: 1.2892596
	speed: 0.2952s/iter; left time: 5529.3174s
Epoch: 10 cost time: 60.60544729232788
Epoch: 10, Steps: 208 | Train Loss: 1.134 Vali Loss: 7.486 Vali Acc: 0.071 Test Loss: 7.486 Test Acc: 0.071
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8858089
	speed: 0.6688s/iter; left time: 12453.4544s
	iters: 200, epoch: 11 | loss: 1.2444338
	speed: 0.2879s/iter; left time: 5332.2630s
Epoch: 11 cost time: 58.87717032432556
Epoch: 11, Steps: 208 | Train Loss: 0.924 Vali Loss: 7.619 Vali Acc: 0.084 Test Loss: 7.619 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.3093567
	speed: 0.6749s/iter; left time: 12426.0348s
	iters: 200, epoch: 12 | loss: 1.0122043
	speed: 0.2951s/iter; left time: 5403.4912s
Epoch: 12 cost time: 61.52170395851135
Epoch: 12, Steps: 208 | Train Loss: 0.827 Vali Loss: 7.851 Vali Acc: 0.083 Test Loss: 7.851 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09484044139576499
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5489347
	speed: 0.2922s/iter; left time: 6048.3377s
	iters: 200, epoch: 1 | loss: 3.9655900
	speed: 0.2761s/iter; left time: 5687.3663s
Epoch: 1 cost time: 59.19976186752319
Epoch: 1, Steps: 208 | Train Loss: 3.932 Vali Loss: 4.744 Vali Acc: 0.063 Test Loss: 4.744 Test Acc: 0.063
Validation loss decreased (inf --> -0.062583).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9561450
	speed: 0.6788s/iter; left time: 13910.3166s
	iters: 200, epoch: 2 | loss: 4.2343364
	speed: 0.2918s/iter; left time: 5950.8459s
Epoch: 2 cost time: 60.67329239845276
Epoch: 2, Steps: 208 | Train Loss: 3.560 Vali Loss: 4.584 Vali Acc: 0.077 Test Loss: 4.584 Test Acc: 0.077
Validation loss decreased (-0.062583 --> -0.076900).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1937649
	speed: 0.6777s/iter; left time: 13747.4519s
	iters: 200, epoch: 3 | loss: 3.6406438
	speed: 0.2947s/iter; left time: 5948.0804s
Epoch: 3 cost time: 61.036264181137085
Epoch: 3, Steps: 208 | Train Loss: 3.209 Vali Loss: 4.575 Vali Acc: 0.074 Test Loss: 4.575 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3545234
	speed: 0.6821s/iter; left time: 13695.1705s
	iters: 200, epoch: 4 | loss: 3.9841642
	speed: 0.2820s/iter; left time: 5634.0797s
Epoch: 4 cost time: 60.63142943382263
Epoch: 4, Steps: 208 | Train Loss: 2.812 Vali Loss: 4.872 Vali Acc: 0.067 Test Loss: 4.872 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3149550
	speed: 0.6798s/iter; left time: 13507.3677s
	iters: 200, epoch: 5 | loss: 3.8122284
	speed: 0.2793s/iter; left time: 5521.0441s
Epoch: 5 cost time: 59.35953903198242
Epoch: 5, Steps: 208 | Train Loss: 2.432 Vali Loss: 5.040 Vali Acc: 0.072 Test Loss: 5.040 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.9452642
	speed: 0.6832s/iter; left time: 13431.8170s
	iters: 200, epoch: 6 | loss: 2.8630929
	speed: 0.2696s/iter; left time: 5273.6342s
Epoch: 6 cost time: 57.72485852241516
Epoch: 6, Steps: 208 | Train Loss: 2.110 Vali Loss: 5.158 Vali Acc: 0.067 Test Loss: 5.158 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.6788770
	speed: 0.6503s/iter; left time: 12650.3458s
	iters: 200, epoch: 7 | loss: 1.4466243
	speed: 0.2909s/iter; left time: 5630.6307s
Epoch: 7 cost time: 60.311991453170776
Epoch: 7, Steps: 208 | Train Loss: 1.854 Vali Loss: 5.912 Vali Acc: 0.072 Test Loss: 5.912 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.4490454
	speed: 0.6803s/iter; left time: 13091.9569s
	iters: 200, epoch: 8 | loss: 1.1884636
	speed: 0.2693s/iter; left time: 5155.3426s
Epoch: 8 cost time: 56.72216773033142
Epoch: 8, Steps: 208 | Train Loss: 1.626 Vali Loss: 6.081 Vali Acc: 0.081 Test Loss: 6.081 Test Acc: 0.081
Validation loss decreased (-0.076900 --> -0.080762).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0741348
	speed: 0.6759s/iter; left time: 12866.2193s
	iters: 200, epoch: 9 | loss: 1.2658349
	speed: 0.2876s/iter; left time: 5445.8497s
Epoch: 9 cost time: 61.38045573234558
Epoch: 9, Steps: 208 | Train Loss: 1.433 Vali Loss: 6.505 Vali Acc: 0.087 Test Loss: 6.505 Test Acc: 0.087
Validation loss decreased (-0.080762 --> -0.086723).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1190557
	speed: 0.6532s/iter; left time: 12298.8044s
	iters: 200, epoch: 10 | loss: 1.4853079
	speed: 0.2867s/iter; left time: 5370.0196s
Epoch: 10 cost time: 59.155922651290894
Epoch: 10, Steps: 208 | Train Loss: 1.177 Vali Loss: 6.595 Vali Acc: 0.083 Test Loss: 6.595 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0887520
	speed: 0.6985s/iter; left time: 13007.5621s
	iters: 200, epoch: 11 | loss: 1.2082269
	speed: 0.2728s/iter; left time: 5053.1198s
Epoch: 11 cost time: 59.791247606277466
Epoch: 11, Steps: 208 | Train Loss: 1.041 Vali Loss: 6.935 Vali Acc: 0.074 Test Loss: 6.935 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5132253
	speed: 0.6831s/iter; left time: 12578.1585s
	iters: 200, epoch: 12 | loss: 0.9372160
	speed: 0.2812s/iter; left time: 5149.9336s
Epoch: 12 cost time: 59.64690446853638
Epoch: 12, Steps: 208 | Train Loss: 0.946 Vali Loss: 7.094 Vali Acc: 0.079 Test Loss: 7.094 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5504569
	speed: 0.6656s/iter; left time: 12116.7895s
	iters: 200, epoch: 13 | loss: 0.3924533
	speed: 0.2927s/iter; left time: 5299.6063s
Epoch: 13 cost time: 59.91206908226013
Epoch: 13, Steps: 208 | Train Loss: 0.849 Vali Loss: 7.175 Vali Acc: 0.080 Test Loss: 7.175 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3739795
	speed: 0.7042s/iter; left time: 12673.3536s
	iters: 200, epoch: 14 | loss: 0.7987824
	speed: 0.2766s/iter; left time: 4950.5469s
Epoch: 14 cost time: 59.60912847518921
Epoch: 14, Steps: 208 | Train Loss: 0.700 Vali Loss: 7.678 Vali Acc: 0.072 Test Loss: 7.678 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.9591912
	speed: 0.6655s/iter; left time: 11838.5848s
	iters: 200, epoch: 15 | loss: 1.2767456
	speed: 0.2920s/iter; left time: 5164.6125s
Epoch: 15 cost time: 60.56900095939636
Epoch: 15, Steps: 208 | Train Loss: 0.639 Vali Loss: 8.047 Vali Acc: 0.078 Test Loss: 8.047 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.9479997
	speed: 0.6993s/iter; left time: 12294.7721s
	iters: 200, epoch: 16 | loss: 0.1408780
	speed: 0.2814s/iter; left time: 4918.7534s
Epoch: 16 cost time: 60.01551151275635
Epoch: 16, Steps: 208 | Train Loss: 0.568 Vali Loss: 7.857 Vali Acc: 0.077 Test Loss: 7.857 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2358744
	speed: 0.6879s/iter; left time: 11950.5225s
	iters: 200, epoch: 17 | loss: 0.7102066
	speed: 0.3156s/iter; left time: 5451.0380s
Epoch: 17 cost time: 63.98114490509033
Epoch: 17, Steps: 208 | Train Loss: 0.571 Vali Loss: 8.575 Vali Acc: 0.076 Test Loss: 8.575 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.4193009
	speed: 0.6807s/iter; left time: 11684.4526s
	iters: 200, epoch: 18 | loss: 1.0443919
	speed: 0.2884s/iter; left time: 4922.3145s
Epoch: 18 cost time: 59.91822934150696
Epoch: 18, Steps: 208 | Train Loss: 0.531 Vali Loss: 8.752 Vali Acc: 0.071 Test Loss: 8.752 Test Acc: 0.071
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.4507883
	speed: 0.7002s/iter; left time: 11873.1551s
	iters: 200, epoch: 19 | loss: 0.5594869
	speed: 0.2815s/iter; left time: 4746.0164s
Epoch: 19 cost time: 60.10457801818848
Epoch: 19, Steps: 208 | Train Loss: 0.496 Vali Loss: 9.107 Vali Acc: 0.078 Test Loss: 9.107 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0867879510885774
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6258693
	speed: 0.3086s/iter; left time: 6388.9476s
	iters: 200, epoch: 1 | loss: 3.6131001
	speed: 0.2949s/iter; left time: 6074.5878s
Epoch: 1 cost time: 62.83096408843994
Epoch: 1, Steps: 208 | Train Loss: 3.913 Vali Loss: 5.057 Vali Acc: 0.034 Test Loss: 5.057 Test Acc: 0.034
Validation loss decreased (inf --> -0.033949).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8947754
	speed: 0.6749s/iter; left time: 13830.0616s
	iters: 200, epoch: 2 | loss: 4.4023705
	speed: 0.2882s/iter; left time: 5876.7912s
Epoch: 2 cost time: 59.83439826965332
Epoch: 2, Steps: 208 | Train Loss: 3.622 Vali Loss: 4.915 Vali Acc: 0.041 Test Loss: 4.915 Test Acc: 0.041
Validation loss decreased (-0.033949 --> -0.041406).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4609070
	speed: 0.6934s/iter; left time: 14064.7748s
	iters: 200, epoch: 3 | loss: 4.3220582
	speed: 0.2819s/iter; left time: 5689.4403s
Epoch: 3 cost time: 59.834223985672
Epoch: 3, Steps: 208 | Train Loss: 3.342 Vali Loss: 4.645 Vali Acc: 0.049 Test Loss: 4.645 Test Acc: 0.049
Validation loss decreased (-0.041406 --> -0.049163).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3914914
	speed: 0.6791s/iter; left time: 13633.3955s
	iters: 200, epoch: 4 | loss: 3.5658712
	speed: 0.3004s/iter; left time: 6001.1573s
Epoch: 4 cost time: 62.18420219421387
Epoch: 4, Steps: 208 | Train Loss: 3.080 Vali Loss: 4.801 Vali Acc: 0.059 Test Loss: 4.801 Test Acc: 0.059
Validation loss decreased (-0.049163 --> -0.059302).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6833439
	speed: 0.6772s/iter; left time: 13454.7175s
	iters: 200, epoch: 5 | loss: 3.4938087
	speed: 0.3026s/iter; left time: 5981.9149s
Epoch: 5 cost time: 61.80503058433533
Epoch: 5, Steps: 208 | Train Loss: 2.712 Vali Loss: 4.892 Vali Acc: 0.052 Test Loss: 4.892 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8934577
	speed: 0.6762s/iter; left time: 13295.5923s
	iters: 200, epoch: 6 | loss: 3.5610728
	speed: 0.2977s/iter; left time: 5822.4514s
Epoch: 6 cost time: 61.138479709625244
Epoch: 6, Steps: 208 | Train Loss: 2.409 Vali Loss: 4.950 Vali Acc: 0.062 Test Loss: 4.950 Test Acc: 0.062
Validation loss decreased (-0.059302 --> -0.061985).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1490715
	speed: 0.6923s/iter; left time: 13468.0247s
	iters: 200, epoch: 7 | loss: 3.0506523
	speed: 0.2985s/iter; left time: 5777.2063s
Epoch: 7 cost time: 62.00499176979065
Epoch: 7, Steps: 208 | Train Loss: 2.151 Vali Loss: 5.458 Vali Acc: 0.071 Test Loss: 5.458 Test Acc: 0.071
Validation loss decreased (-0.061985 --> -0.070628).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6096588
	speed: 0.6858s/iter; left time: 13197.2864s
	iters: 200, epoch: 8 | loss: 3.1454518
	speed: 0.2834s/iter; left time: 5426.0240s
Epoch: 8 cost time: 60.675108909606934
Epoch: 8, Steps: 208 | Train Loss: 1.913 Vali Loss: 5.786 Vali Acc: 0.062 Test Loss: 5.786 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3644471
	speed: 0.6835s/iter; left time: 13011.0128s
	iters: 200, epoch: 9 | loss: 1.7406840
	speed: 0.2786s/iter; left time: 5275.1193s
Epoch: 9 cost time: 59.152209520339966
Epoch: 9, Steps: 208 | Train Loss: 1.719 Vali Loss: 5.929 Vali Acc: 0.065 Test Loss: 5.929 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0451019
	speed: 0.6485s/iter; left time: 12210.5430s
	iters: 200, epoch: 10 | loss: 2.2238951
	speed: 0.2980s/iter; left time: 5581.8293s
Epoch: 10 cost time: 60.79820418357849
Epoch: 10, Steps: 208 | Train Loss: 1.441 Vali Loss: 6.214 Vali Acc: 0.071 Test Loss: 6.214 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3125724
	speed: 0.6955s/iter; left time: 12951.6200s
	iters: 200, epoch: 11 | loss: 0.6159524
	speed: 0.2857s/iter; left time: 5291.6455s
Epoch: 11 cost time: 60.052462100982666
Epoch: 11, Steps: 208 | Train Loss: 1.214 Vali Loss: 6.543 Vali Acc: 0.073 Test Loss: 6.543 Test Acc: 0.073
Validation loss decreased (-0.070628 --> -0.072705).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2279826
	speed: 0.6971s/iter; left time: 12835.5858s
	iters: 200, epoch: 12 | loss: 1.5830665
	speed: 0.2633s/iter; left time: 4821.4778s
Epoch: 12 cost time: 56.94090700149536
Epoch: 12, Steps: 208 | Train Loss: 1.117 Vali Loss: 6.953 Vali Acc: 0.072 Test Loss: 6.953 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2955666
	speed: 0.6727s/iter; left time: 12245.7674s
	iters: 200, epoch: 13 | loss: 0.8871918
	speed: 0.2907s/iter; left time: 5263.5437s
Epoch: 13 cost time: 61.82368350028992
Epoch: 13, Steps: 208 | Train Loss: 0.991 Vali Loss: 6.951 Vali Acc: 0.072 Test Loss: 6.951 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3197873
	speed: 0.6845s/iter; left time: 12319.0075s
	iters: 200, epoch: 14 | loss: 0.8933621
	speed: 0.2878s/iter; left time: 5151.1178s
Epoch: 14 cost time: 60.44902539253235
Epoch: 14, Steps: 208 | Train Loss: 0.857 Vali Loss: 6.898 Vali Acc: 0.069 Test Loss: 6.898 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4818940
	speed: 0.6583s/iter; left time: 11710.4333s
	iters: 200, epoch: 15 | loss: 1.2400348
	speed: 0.2910s/iter; left time: 5148.0548s
Epoch: 15 cost time: 61.72254991531372
Epoch: 15, Steps: 208 | Train Loss: 0.721 Vali Loss: 7.496 Vali Acc: 0.071 Test Loss: 7.496 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3290710
	speed: 0.6560s/iter; left time: 11533.1330s
	iters: 200, epoch: 16 | loss: 0.6479352
	speed: 0.2828s/iter; left time: 4943.2504s
Epoch: 16 cost time: 58.14260745048523
Epoch: 16, Steps: 208 | Train Loss: 0.679 Vali Loss: 7.971 Vali Acc: 0.067 Test Loss: 7.971 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4315426
	speed: 0.7102s/iter; left time: 12338.0202s
	iters: 200, epoch: 17 | loss: 0.5848272
	speed: 0.3047s/iter; left time: 5262.6156s
Epoch: 17 cost time: 64.0531165599823
Epoch: 17, Steps: 208 | Train Loss: 0.649 Vali Loss: 7.656 Vali Acc: 0.069 Test Loss: 7.656 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.6830172
	speed: 0.6697s/iter; left time: 11494.8136s
	iters: 200, epoch: 18 | loss: 1.1810442
	speed: 0.2749s/iter; left time: 4691.2824s
Epoch: 18 cost time: 57.86398696899414
Epoch: 18, Steps: 208 | Train Loss: 0.561 Vali Loss: 7.907 Vali Acc: 0.072 Test Loss: 7.907 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.3916698
	speed: 0.6889s/iter; left time: 11682.4081s
	iters: 200, epoch: 19 | loss: 0.6903675
	speed: 0.2872s/iter; left time: 4841.6674s
Epoch: 19 cost time: 60.66229009628296
Epoch: 19, Steps: 208 | Train Loss: 0.489 Vali Loss: 8.456 Vali Acc: 0.082 Test Loss: 8.456 Test Acc: 0.082
Validation loss decreased (-0.072705 --> -0.082230).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3029702
	speed: 0.6796s/iter; left time: 11382.9243s
	iters: 200, epoch: 20 | loss: 0.0211980
	speed: 0.3077s/iter; left time: 5123.5640s
Epoch: 20 cost time: 63.053603172302246
Epoch: 20, Steps: 208 | Train Loss: 0.426 Vali Loss: 8.466 Vali Acc: 0.081 Test Loss: 8.466 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2990208
	speed: 0.6921s/iter; left time: 11447.7609s
	iters: 200, epoch: 21 | loss: 0.1015295
	speed: 0.2856s/iter; left time: 4695.7205s
Epoch: 21 cost time: 60.05591058731079
Epoch: 21, Steps: 208 | Train Loss: 0.424 Vali Loss: 8.620 Vali Acc: 0.078 Test Loss: 8.620 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2769360
	speed: 0.6785s/iter; left time: 11081.8044s
	iters: 200, epoch: 22 | loss: 0.3711448
	speed: 0.2989s/iter; left time: 4852.4132s
Epoch: 22 cost time: 61.969934940338135
Epoch: 22, Steps: 208 | Train Loss: 0.371 Vali Loss: 8.791 Vali Acc: 0.072 Test Loss: 8.791 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3671050
	speed: 0.6652s/iter; left time: 10725.8301s
	iters: 200, epoch: 23 | loss: 0.5447578
	speed: 0.2971s/iter; left time: 4760.2417s
Epoch: 23 cost time: 60.21003007888794
Epoch: 23, Steps: 208 | Train Loss: 0.351 Vali Loss: 9.376 Vali Acc: 0.069 Test Loss: 9.376 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1024536
	speed: 0.6889s/iter; left time: 10964.6096s
	iters: 200, epoch: 24 | loss: 0.9314143
	speed: 0.2747s/iter; left time: 4344.7624s
Epoch: 24 cost time: 58.27587842941284
Epoch: 24, Steps: 208 | Train Loss: 0.339 Vali Loss: 9.119 Vali Acc: 0.078 Test Loss: 9.119 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1726574
	speed: 0.6875s/iter; left time: 10800.0087s
	iters: 200, epoch: 25 | loss: 0.0815353
	speed: 0.2984s/iter; left time: 4657.7434s
Epoch: 25 cost time: 60.863749265670776
Epoch: 25, Steps: 208 | Train Loss: 0.319 Vali Loss: 9.783 Vali Acc: 0.071 Test Loss: 9.783 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.3467887
	speed: 0.6880s/iter; left time: 10665.1542s
	iters: 200, epoch: 26 | loss: 0.0342892
	speed: 0.2811s/iter; left time: 4329.1369s
Epoch: 26 cost time: 60.787522077560425
Epoch: 26, Steps: 208 | Train Loss: 0.264 Vali Loss: 9.797 Vali Acc: 0.080 Test Loss: 9.797 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1807585
	speed: 0.6934s/iter; left time: 10604.6110s
	iters: 200, epoch: 27 | loss: 0.5908479
	speed: 0.2954s/iter; left time: 4488.4819s
Epoch: 27 cost time: 62.81816029548645
Epoch: 27, Steps: 208 | Train Loss: 0.267 Vali Loss: 10.284 Vali Acc: 0.061 Test Loss: 10.284 Test Acc: 0.061
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0575951
	speed: 0.6529s/iter; left time: 9848.8070s
	iters: 200, epoch: 28 | loss: 0.6078478
	speed: 0.2961s/iter; left time: 4437.7352s
Epoch: 28 cost time: 61.29290556907654
Epoch: 28, Steps: 208 | Train Loss: 0.297 Vali Loss: 9.785 Vali Acc: 0.072 Test Loss: 9.785 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1865517
	speed: 0.6777s/iter; left time: 10081.6667s
	iters: 200, epoch: 29 | loss: 0.0820484
	speed: 0.2884s/iter; left time: 4261.8758s
Epoch: 29 cost time: 60.146700620651245
Epoch: 29, Steps: 208 | Train Loss: 0.254 Vali Loss: 9.913 Vali Acc: 0.074 Test Loss: 9.913 Test Acc: 0.074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08231434536236207
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5751941
	speed: 0.3107s/iter; left time: 6431.5038s
	iters: 200, epoch: 1 | loss: 3.5645452
	speed: 0.3035s/iter; left time: 6252.7700s
Epoch: 1 cost time: 64.05115818977356
Epoch: 1, Steps: 208 | Train Loss: 3.927 Vali Loss: 5.714 Vali Acc: 0.040 Test Loss: 5.714 Test Acc: 0.040
Validation loss decreased (inf --> -0.039609).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8994536
	speed: 0.6841s/iter; left time: 14018.3198s
	iters: 200, epoch: 2 | loss: 4.6893735
	speed: 0.2927s/iter; left time: 5969.0683s
Epoch: 2 cost time: 61.59788751602173
Epoch: 2, Steps: 208 | Train Loss: 3.933 Vali Loss: 5.930 Vali Acc: 0.039 Test Loss: 5.930 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.3960981
	speed: 0.6919s/iter; left time: 14035.7225s
	iters: 200, epoch: 3 | loss: 4.1096597
	speed: 0.2862s/iter; left time: 5776.8562s
Epoch: 3 cost time: 59.97482919692993
Epoch: 3, Steps: 208 | Train Loss: 3.817 Vali Loss: 4.377 Vali Acc: 0.045 Test Loss: 4.377 Test Acc: 0.045
Validation loss decreased (-0.039609 --> -0.044692).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.2882257
	speed: 0.7088s/iter; left time: 14230.2456s
	iters: 200, epoch: 4 | loss: 3.6690872
	speed: 0.3133s/iter; left time: 6259.2855s
Epoch: 4 cost time: 64.29173970222473
Epoch: 4, Steps: 208 | Train Loss: 3.558 Vali Loss: 4.472 Vali Acc: 0.053 Test Loss: 4.472 Test Acc: 0.053
Validation loss decreased (-0.044692 --> -0.053042).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4412053
	speed: 0.7054s/iter; left time: 14015.3551s
	iters: 200, epoch: 5 | loss: 4.6218781
	speed: 0.2882s/iter; left time: 5697.6419s
Epoch: 5 cost time: 61.402756690979004
Epoch: 5, Steps: 208 | Train Loss: 3.328 Vali Loss: 4.286 Vali Acc: 0.043 Test Loss: 4.286 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.9118261
	speed: 0.6769s/iter; left time: 13307.6219s
	iters: 200, epoch: 6 | loss: 4.2262387
	speed: 0.3071s/iter; left time: 6007.7821s
Epoch: 6 cost time: 63.08211970329285
Epoch: 6, Steps: 208 | Train Loss: 3.261 Vali Loss: 4.077 Vali Acc: 0.058 Test Loss: 4.077 Test Acc: 0.058
Validation loss decreased (-0.053042 --> -0.057818).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9248855
	speed: 0.6906s/iter; left time: 13434.5319s
	iters: 200, epoch: 7 | loss: 3.1828802
	speed: 0.3058s/iter; left time: 5917.9226s
Epoch: 7 cost time: 63.67836332321167
Epoch: 7, Steps: 208 | Train Loss: 3.163 Vali Loss: 4.134 Vali Acc: 0.056 Test Loss: 4.134 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.2959063
	speed: 0.7073s/iter; left time: 13611.7760s
	iters: 200, epoch: 8 | loss: 3.3229406
	speed: 0.2812s/iter; left time: 5383.5177s
Epoch: 8 cost time: 61.29634094238281
Epoch: 8, Steps: 208 | Train Loss: 2.999 Vali Loss: 4.282 Vali Acc: 0.066 Test Loss: 4.282 Test Acc: 0.066
Validation loss decreased (-0.057818 --> -0.066167).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.5831707
	speed: 0.7020s/iter; left time: 13364.4701s
	iters: 200, epoch: 9 | loss: 2.5738051
	speed: 0.3137s/iter; left time: 5940.9410s
Epoch: 9 cost time: 64.26750016212463
Epoch: 9, Steps: 208 | Train Loss: 2.850 Vali Loss: 4.144 Vali Acc: 0.067 Test Loss: 4.144 Test Acc: 0.067
Validation loss decreased (-0.066167 --> -0.067361).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5741014
	speed: 0.7062s/iter; left time: 13297.5643s
	iters: 200, epoch: 10 | loss: 3.1316304
	speed: 0.3047s/iter; left time: 5706.9088s
Epoch: 10 cost time: 63.858720779418945
Epoch: 10, Steps: 208 | Train Loss: 2.639 Vali Loss: 4.386 Vali Acc: 0.073 Test Loss: 4.386 Test Acc: 0.073
Validation loss decreased (-0.067361 --> -0.072727).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8993131
	speed: 0.7198s/iter; left time: 13402.4894s
	iters: 200, epoch: 11 | loss: 2.2222931
	speed: 0.3056s/iter; left time: 5659.5024s
Epoch: 11 cost time: 64.47287726402283
Epoch: 11, Steps: 208 | Train Loss: 2.362 Vali Loss: 4.511 Vali Acc: 0.067 Test Loss: 4.511 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8642658
	speed: 0.6779s/iter; left time: 12482.6461s
	iters: 200, epoch: 12 | loss: 2.7856889
	speed: 0.2946s/iter; left time: 5394.9509s
Epoch: 12 cost time: 61.42112898826599
Epoch: 12, Steps: 208 | Train Loss: 2.002 Vali Loss: 4.968 Vali Acc: 0.075 Test Loss: 4.968 Test Acc: 0.075
Validation loss decreased (-0.072727 --> -0.075405).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9357253
	speed: 0.7074s/iter; left time: 12877.3527s
	iters: 200, epoch: 13 | loss: 1.8524070
	speed: 0.3012s/iter; left time: 5452.9625s
Epoch: 13 cost time: 62.816367864608765
Epoch: 13, Steps: 208 | Train Loss: 1.662 Vali Loss: 5.153 Vali Acc: 0.092 Test Loss: 5.153 Test Acc: 0.092
Validation loss decreased (-0.075405 --> -0.091508).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9119269
	speed: 0.7109s/iter; left time: 12794.5753s
	iters: 200, epoch: 14 | loss: 1.8922244
	speed: 0.2985s/iter; left time: 5343.0074s
Epoch: 14 cost time: 62.99258041381836
Epoch: 14, Steps: 208 | Train Loss: 1.292 Vali Loss: 5.411 Vali Acc: 0.082 Test Loss: 5.411 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8772137
	speed: 0.6747s/iter; left time: 12002.0720s
	iters: 200, epoch: 15 | loss: 0.8063298
	speed: 0.3084s/iter; left time: 5455.4427s
Epoch: 15 cost time: 63.33254098892212
Epoch: 15, Steps: 208 | Train Loss: 1.053 Vali Loss: 6.148 Vali Acc: 0.085 Test Loss: 6.148 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7062692
	speed: 0.6909s/iter; left time: 12145.9153s
	iters: 200, epoch: 16 | loss: 1.8709347
	speed: 0.2904s/iter; left time: 5075.7590s
Epoch: 16 cost time: 61.57593250274658
Epoch: 16, Steps: 208 | Train Loss: 0.887 Vali Loss: 6.428 Vali Acc: 0.089 Test Loss: 6.428 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3539812
	speed: 0.7106s/iter; left time: 12346.0522s
	iters: 200, epoch: 17 | loss: 0.6542844
	speed: 0.2898s/iter; left time: 5006.5716s
Epoch: 17 cost time: 62.72063136100769
Epoch: 17, Steps: 208 | Train Loss: 0.751 Vali Loss: 6.872 Vali Acc: 0.085 Test Loss: 6.872 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7518821
	speed: 0.6633s/iter; left time: 11386.3005s
	iters: 200, epoch: 18 | loss: 0.6465239
	speed: 0.2937s/iter; left time: 5012.5656s
Epoch: 18 cost time: 59.45883107185364
Epoch: 18, Steps: 208 | Train Loss: 0.680 Vali Loss: 6.850 Vali Acc: 0.081 Test Loss: 6.850 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6489509
	speed: 0.6965s/iter; left time: 11810.1406s
	iters: 200, epoch: 19 | loss: 0.7998558
	speed: 0.3064s/iter; left time: 5164.3488s
Epoch: 19 cost time: 64.37431597709656
Epoch: 19, Steps: 208 | Train Loss: 0.582 Vali Loss: 7.252 Vali Acc: 0.088 Test Loss: 7.252 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3438288
	speed: 0.6926s/iter; left time: 11600.5714s
	iters: 200, epoch: 20 | loss: 0.2493425
	speed: 0.3064s/iter; left time: 5101.7145s
Epoch: 20 cost time: 64.0595006942749
Epoch: 20, Steps: 208 | Train Loss: 0.526 Vali Loss: 7.611 Vali Acc: 0.085 Test Loss: 7.611 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.5501208
	speed: 0.6905s/iter; left time: 11421.9364s
	iters: 200, epoch: 21 | loss: 0.2710190
	speed: 0.3016s/iter; left time: 4958.6871s
Epoch: 21 cost time: 62.5630989074707
Epoch: 21, Steps: 208 | Train Loss: 0.484 Vali Loss: 7.762 Vali Acc: 0.085 Test Loss: 7.762 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6206421
	speed: 0.6932s/iter; left time: 11322.7428s
	iters: 200, epoch: 22 | loss: 0.6691940
	speed: 0.3035s/iter; left time: 4926.5582s
Epoch: 22 cost time: 62.40669536590576
Epoch: 22, Steps: 208 | Train Loss: 0.486 Vali Loss: 7.885 Vali Acc: 0.081 Test Loss: 7.885 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3222675
	speed: 0.6898s/iter; left time: 11122.5529s
	iters: 200, epoch: 23 | loss: 0.3199807
	speed: 0.3081s/iter; left time: 4937.0405s
Epoch: 23 cost time: 64.1292622089386
Epoch: 23, Steps: 208 | Train Loss: 0.414 Vali Loss: 8.349 Vali Acc: 0.083 Test Loss: 8.349 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09155979719654041
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5317395
	speed: 0.2746s/iter; left time: 5685.1858s
	iters: 200, epoch: 1 | loss: 3.6537056
	speed: 0.2790s/iter; left time: 5747.5443s
Epoch: 1 cost time: 57.80807948112488
Epoch: 1, Steps: 208 | Train Loss: 3.889 Vali Loss: 5.500 Vali Acc: 0.041 Test Loss: 5.500 Test Acc: 0.041
Validation loss decreased (inf --> -0.041102).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5007398
	speed: 0.6526s/iter; left time: 13373.3266s
	iters: 200, epoch: 2 | loss: 4.0834455
	speed: 0.2763s/iter; left time: 5635.4046s
Epoch: 2 cost time: 57.258965492248535
Epoch: 2, Steps: 208 | Train Loss: 3.767 Vali Loss: 6.568 Vali Acc: 0.036 Test Loss: 6.568 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0245652
	speed: 0.6492s/iter; left time: 13169.9652s
	iters: 200, epoch: 3 | loss: 4.3167357
	speed: 0.2881s/iter; left time: 5815.9346s
Epoch: 3 cost time: 59.13835287094116
Epoch: 3, Steps: 208 | Train Loss: 3.711 Vali Loss: 4.759 Vali Acc: 0.041 Test Loss: 4.759 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.8023210
	speed: 0.6489s/iter; left time: 13027.3661s
	iters: 200, epoch: 4 | loss: 4.0539279
	speed: 0.2668s/iter; left time: 5330.7217s
Epoch: 4 cost time: 56.34589624404907
Epoch: 4, Steps: 208 | Train Loss: 3.313 Vali Loss: 4.830 Vali Acc: 0.058 Test Loss: 4.830 Test Acc: 0.058
Validation loss decreased (-0.041102 --> -0.057810).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6493824
	speed: 0.6445s/iter; left time: 12805.8669s
	iters: 200, epoch: 5 | loss: 4.4534779
	speed: 0.2770s/iter; left time: 5476.8848s
Epoch: 5 cost time: 58.73487663269043
Epoch: 5, Steps: 208 | Train Loss: 2.891 Vali Loss: 4.694 Vali Acc: 0.053 Test Loss: 4.694 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8246353
	speed: 0.6455s/iter; left time: 12691.2867s
	iters: 200, epoch: 6 | loss: 4.2502494
	speed: 0.2763s/iter; left time: 5404.6519s
Epoch: 6 cost time: 57.508747816085815
Epoch: 6, Steps: 208 | Train Loss: 2.655 Vali Loss: 4.787 Vali Acc: 0.058 Test Loss: 4.787 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9871607
	speed: 0.6871s/iter; left time: 13366.5657s
	iters: 200, epoch: 7 | loss: 2.1631227
	speed: 0.2840s/iter; left time: 5496.0343s
Epoch: 7 cost time: 60.1570086479187
Epoch: 7, Steps: 208 | Train Loss: 2.369 Vali Loss: 5.145 Vali Acc: 0.060 Test Loss: 5.145 Test Acc: 0.060
Validation loss decreased (-0.057810 --> -0.059597).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4467583
	speed: 0.6256s/iter; left time: 12039.0522s
	iters: 200, epoch: 8 | loss: 2.5283954
	speed: 0.2766s/iter; left time: 5295.0751s
Epoch: 8 cost time: 57.09395885467529
Epoch: 8, Steps: 208 | Train Loss: 1.994 Vali Loss: 5.697 Vali Acc: 0.057 Test Loss: 5.697 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6132268
	speed: 0.6501s/iter; left time: 12376.1891s
	iters: 200, epoch: 9 | loss: 1.1779702
	speed: 0.2745s/iter; left time: 5197.5718s
Epoch: 9 cost time: 57.453330278396606
Epoch: 9, Steps: 208 | Train Loss: 1.624 Vali Loss: 6.021 Vali Acc: 0.081 Test Loss: 6.021 Test Acc: 0.081
Validation loss decreased (-0.059597 --> -0.080763).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8764652
	speed: 0.7062s/iter; left time: 13297.3136s
	iters: 200, epoch: 10 | loss: 0.9178676
	speed: 0.2823s/iter; left time: 5286.9954s
Epoch: 10 cost time: 61.01105499267578
Epoch: 10, Steps: 208 | Train Loss: 1.351 Vali Loss: 6.502 Vali Acc: 0.074 Test Loss: 6.502 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3633038
	speed: 0.6652s/iter; left time: 12386.4285s
	iters: 200, epoch: 11 | loss: 0.6231020
	speed: 0.2749s/iter; left time: 5091.0012s
Epoch: 11 cost time: 58.085885763168335
Epoch: 11, Steps: 208 | Train Loss: 1.082 Vali Loss: 6.874 Vali Acc: 0.063 Test Loss: 6.874 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6843890
	speed: 0.6546s/iter; left time: 12052.5087s
	iters: 200, epoch: 12 | loss: 2.0292277
	speed: 0.3010s/iter; left time: 5513.1203s
Epoch: 12 cost time: 61.202436208724976
Epoch: 12, Steps: 208 | Train Loss: 0.970 Vali Loss: 6.873 Vali Acc: 0.073 Test Loss: 6.873 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0487511
	speed: 0.7022s/iter; left time: 12782.8209s
	iters: 200, epoch: 13 | loss: 0.8158264
	speed: 0.2687s/iter; left time: 4864.3895s
Epoch: 13 cost time: 58.649192333221436
Epoch: 13, Steps: 208 | Train Loss: 0.803 Vali Loss: 7.414 Vali Acc: 0.063 Test Loss: 7.414 Test Acc: 0.063
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.7406369
	speed: 0.7128s/iter; left time: 12827.9322s
	iters: 200, epoch: 14 | loss: 0.5205815
	speed: 0.2935s/iter; left time: 5251.9079s
Epoch: 14 cost time: 63.75319695472717
Epoch: 14, Steps: 208 | Train Loss: 0.748 Vali Loss: 7.848 Vali Acc: 0.071 Test Loss: 7.848 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3006488
	speed: 0.6786s/iter; left time: 12071.9982s
	iters: 200, epoch: 15 | loss: 0.4672829
	speed: 0.2902s/iter; left time: 5132.7475s
Epoch: 15 cost time: 60.120397090911865
Epoch: 15, Steps: 208 | Train Loss: 0.654 Vali Loss: 7.998 Vali Acc: 0.069 Test Loss: 7.998 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.0324223
	speed: 0.7118s/iter; left time: 12513.5733s
	iters: 200, epoch: 16 | loss: 1.0252329
	speed: 0.2831s/iter; left time: 4949.5192s
Epoch: 16 cost time: 61.153464555740356
Epoch: 16, Steps: 208 | Train Loss: 0.633 Vali Loss: 7.983 Vali Acc: 0.072 Test Loss: 7.983 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2551432
	speed: 0.6797s/iter; left time: 11807.7810s
	iters: 200, epoch: 17 | loss: 0.4283916
	speed: 0.2985s/iter; left time: 5156.7720s
Epoch: 17 cost time: 62.43942713737488
Epoch: 17, Steps: 208 | Train Loss: 0.582 Vali Loss: 8.077 Vali Acc: 0.078 Test Loss: 8.077 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.3335553
	speed: 0.6812s/iter; left time: 11692.8473s
	iters: 200, epoch: 18 | loss: 0.8493214
	speed: 0.2535s/iter; left time: 4326.1044s
Epoch: 18 cost time: 57.60040855407715
Epoch: 18, Steps: 208 | Train Loss: 0.502 Vali Loss: 8.525 Vali Acc: 0.076 Test Loss: 8.525 Test Acc: 0.076
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3436281
	speed: 0.6238s/iter; left time: 10577.2334s
	iters: 200, epoch: 19 | loss: 0.8511510
	speed: 0.2619s/iter; left time: 4415.1308s
Epoch: 19 cost time: 55.168755292892456
Epoch: 19, Steps: 208 | Train Loss: 0.491 Vali Loss: 8.928 Vali Acc: 0.070 Test Loss: 8.928 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08082314345362362
model parameter : 7954727
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3159840
	speed: 0.3090s/iter; left time: 6396.5545s
	iters: 200, epoch: 1 | loss: 3.6603887
	speed: 0.2862s/iter; left time: 5896.4283s
Epoch: 1 cost time: 62.097326040267944
Epoch: 1, Steps: 208 | Train Loss: 4.085 Vali Loss: 4.330 Vali Acc: 0.067 Test Loss: 4.330 Test Acc: 0.067
Validation loss decreased (inf --> -0.066464).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3819299
	speed: 0.6495s/iter; left time: 13311.1014s
	iters: 200, epoch: 2 | loss: 4.2208977
	speed: 0.2848s/iter; left time: 5808.1904s
Epoch: 2 cost time: 58.3254554271698
Epoch: 2, Steps: 208 | Train Loss: 3.423 Vali Loss: 4.002 Vali Acc: 0.077 Test Loss: 4.002 Test Acc: 0.077
Validation loss decreased (-0.066464 --> -0.077204).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2208345
	speed: 0.6661s/iter; left time: 13510.9910s
	iters: 200, epoch: 3 | loss: 3.4751842
	speed: 0.2775s/iter; left time: 5602.0437s
Epoch: 3 cost time: 58.67545032501221
Epoch: 3, Steps: 208 | Train Loss: 2.688 Vali Loss: 4.732 Vali Acc: 0.084 Test Loss: 4.732 Test Acc: 0.084
Validation loss decreased (-0.077204 --> -0.084355).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3335567
	speed: 0.6768s/iter; left time: 13589.0322s
	iters: 200, epoch: 4 | loss: 2.4753456
	speed: 0.2814s/iter; left time: 5620.8446s
Epoch: 4 cost time: 60.33622336387634
Epoch: 4, Steps: 208 | Train Loss: 2.086 Vali Loss: 5.412 Vali Acc: 0.082 Test Loss: 5.412 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3906533
	speed: 0.6625s/iter; left time: 13162.9231s
	iters: 200, epoch: 5 | loss: 1.6160899
	speed: 0.2632s/iter; left time: 5202.4240s
Epoch: 5 cost time: 56.670275926589966
Epoch: 5, Steps: 208 | Train Loss: 1.574 Vali Loss: 6.109 Vali Acc: 0.079 Test Loss: 6.109 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3523291
	speed: 0.6616s/iter; left time: 13008.1264s
	iters: 200, epoch: 6 | loss: 1.9563018
	speed: 0.2907s/iter; left time: 5685.9888s
Epoch: 6 cost time: 60.11230969429016
Epoch: 6, Steps: 208 | Train Loss: 1.237 Vali Loss: 6.900 Vali Acc: 0.088 Test Loss: 6.900 Test Acc: 0.088
Validation loss decreased (-0.084355 --> -0.087912).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0417874
	speed: 0.6686s/iter; left time: 13006.3195s
	iters: 200, epoch: 7 | loss: 1.0622008
	speed: 0.2863s/iter; left time: 5541.4553s
Epoch: 7 cost time: 60.79556894302368
Epoch: 7, Steps: 208 | Train Loss: 1.024 Vali Loss: 7.588 Vali Acc: 0.081 Test Loss: 7.588 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6003665
	speed: 0.6821s/iter; left time: 13126.0771s
	iters: 200, epoch: 8 | loss: 1.8525031
	speed: 0.2726s/iter; left time: 5218.0768s
Epoch: 8 cost time: 58.772345304489136
Epoch: 8, Steps: 208 | Train Loss: 0.882 Vali Loss: 8.433 Vali Acc: 0.079 Test Loss: 8.433 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6135209
	speed: 0.6482s/iter; left time: 12339.9546s
	iters: 200, epoch: 9 | loss: 0.7823520
	speed: 0.2699s/iter; left time: 5110.9717s
Epoch: 9 cost time: 56.401567459106445
Epoch: 9, Steps: 208 | Train Loss: 0.757 Vali Loss: 9.641 Vali Acc: 0.078 Test Loss: 9.641 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0123883
	speed: 0.6400s/iter; left time: 12050.5203s
	iters: 200, epoch: 10 | loss: 0.8839745
	speed: 0.2831s/iter; left time: 5302.9646s
Epoch: 10 cost time: 58.94559383392334
Epoch: 10, Steps: 208 | Train Loss: 0.698 Vali Loss: 9.696 Vali Acc: 0.077 Test Loss: 9.696 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3287196
	speed: 0.6326s/iter; left time: 11780.0239s
	iters: 200, epoch: 11 | loss: 0.7654033
	speed: 0.2726s/iter; left time: 5049.4171s
Epoch: 11 cost time: 56.74972486495972
Epoch: 11, Steps: 208 | Train Loss: 0.533 Vali Loss: 9.838 Vali Acc: 0.081 Test Loss: 9.838 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.8469795
	speed: 0.6512s/iter; left time: 11990.5526s
	iters: 200, epoch: 12 | loss: 0.7338516
	speed: 0.2648s/iter; left time: 4848.9366s
Epoch: 12 cost time: 55.51308250427246
Epoch: 12, Steps: 208 | Train Loss: 0.506 Vali Loss: 10.702 Vali Acc: 0.078 Test Loss: 10.702 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0678272
	speed: 0.6142s/iter; left time: 11181.2048s
	iters: 200, epoch: 13 | loss: 0.5753199
	speed: 0.2796s/iter; left time: 5062.5639s
Epoch: 13 cost time: 59.35355520248413
Epoch: 13, Steps: 208 | Train Loss: 0.491 Vali Loss: 10.806 Vali Acc: 0.072 Test Loss: 10.806 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.5820867
	speed: 0.6609s/iter; left time: 11893.7873s
	iters: 200, epoch: 14 | loss: 0.3664823
	speed: 0.2814s/iter; left time: 5036.1733s
Epoch: 14 cost time: 58.0697979927063
Epoch: 14, Steps: 208 | Train Loss: 0.395 Vali Loss: 11.504 Vali Acc: 0.075 Test Loss: 11.504 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1331677
	speed: 0.6059s/iter; left time: 10777.9479s
	iters: 200, epoch: 15 | loss: 0.4038758
	speed: 0.2868s/iter; left time: 5073.0323s
Epoch: 15 cost time: 58.67667746543884
Epoch: 15, Steps: 208 | Train Loss: 0.385 Vali Loss: 11.691 Vali Acc: 0.081 Test Loss: 11.691 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2852369
	speed: 0.6300s/iter; left time: 11076.1410s
	iters: 200, epoch: 16 | loss: 0.0669926
	speed: 0.2817s/iter; left time: 4924.9374s
Epoch: 16 cost time: 56.9613139629364
Epoch: 16, Steps: 208 | Train Loss: 0.365 Vali Loss: 12.152 Vali Acc: 0.080 Test Loss: 12.152 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08798091261556815
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4275415
	speed: 0.3019s/iter; left time: 6249.2971s
	iters: 200, epoch: 1 | loss: 3.5666058
	speed: 0.2758s/iter; left time: 5681.0720s
Epoch: 1 cost time: 60.16191506385803
Epoch: 1, Steps: 208 | Train Loss: 4.078 Vali Loss: 4.373 Vali Acc: 0.060 Test Loss: 4.373 Test Acc: 0.060
Validation loss decreased (inf --> -0.060201).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1870441
	speed: 0.5849s/iter; left time: 11987.2925s
	iters: 200, epoch: 2 | loss: 4.3259540
	speed: 0.2545s/iter; left time: 5189.4587s
Epoch: 2 cost time: 51.71954536437988
Epoch: 2, Steps: 208 | Train Loss: 3.425 Vali Loss: 4.151 Vali Acc: 0.078 Test Loss: 4.151 Test Acc: 0.078
Validation loss decreased (-0.060201 --> -0.077501).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9218450
	speed: 0.6728s/iter; left time: 13648.0426s
	iters: 200, epoch: 3 | loss: 3.1290061
	speed: 0.2719s/iter; left time: 5487.3430s
Epoch: 3 cost time: 56.84232997894287
Epoch: 3, Steps: 208 | Train Loss: 2.682 Vali Loss: 4.733 Vali Acc: 0.092 Test Loss: 4.733 Test Acc: 0.092
Validation loss decreased (-0.077501 --> -0.091811).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3988659
	speed: 0.6554s/iter; left time: 13157.6884s
	iters: 200, epoch: 4 | loss: 2.5689137
	speed: 0.2887s/iter; left time: 5768.1798s
Epoch: 4 cost time: 60.612122535705566
Epoch: 4, Steps: 208 | Train Loss: 2.089 Vali Loss: 5.449 Vali Acc: 0.084 Test Loss: 5.449 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0968126
	speed: 0.5867s/iter; left time: 11657.1314s
	iters: 200, epoch: 5 | loss: 1.7234638
	speed: 0.2319s/iter; left time: 4585.0344s
Epoch: 5 cost time: 49.45423936843872
Epoch: 5, Steps: 208 | Train Loss: 1.586 Vali Loss: 5.880 Vali Acc: 0.083 Test Loss: 5.880 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9683149
	speed: 0.6547s/iter; left time: 12872.5551s
	iters: 200, epoch: 6 | loss: 1.9930731
	speed: 0.2869s/iter; left time: 5612.8705s
Epoch: 6 cost time: 59.59155344963074
Epoch: 6, Steps: 208 | Train Loss: 1.291 Vali Loss: 6.806 Vali Acc: 0.078 Test Loss: 6.806 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8831937
	speed: 0.6756s/iter; left time: 13142.1948s
	iters: 200, epoch: 7 | loss: 2.0907512
	speed: 0.2797s/iter; left time: 5413.9631s
Epoch: 7 cost time: 60.11274576187134
Epoch: 7, Steps: 208 | Train Loss: 1.082 Vali Loss: 7.628 Vali Acc: 0.077 Test Loss: 7.628 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.6825372
	speed: 0.6254s/iter; left time: 12036.3887s
	iters: 200, epoch: 8 | loss: 1.1948417
	speed: 0.2648s/iter; left time: 5070.2280s
Epoch: 8 cost time: 55.69499897956848
Epoch: 8, Steps: 208 | Train Loss: 0.894 Vali Loss: 8.322 Vali Acc: 0.078 Test Loss: 8.322 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5036912
	speed: 0.6545s/iter; left time: 12460.0580s
	iters: 200, epoch: 9 | loss: 1.5957069
	speed: 0.2552s/iter; left time: 4832.0463s
Epoch: 9 cost time: 55.844605445861816
Epoch: 9, Steps: 208 | Train Loss: 0.763 Vali Loss: 9.299 Vali Acc: 0.078 Test Loss: 9.299 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2882465
	speed: 0.6614s/iter; left time: 12453.7890s
	iters: 200, epoch: 10 | loss: 1.3086686
	speed: 0.2778s/iter; left time: 5203.0915s
Epoch: 10 cost time: 59.340126037597656
Epoch: 10, Steps: 208 | Train Loss: 0.652 Vali Loss: 9.534 Vali Acc: 0.065 Test Loss: 9.534 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0726784
	speed: 0.6320s/iter; left time: 11769.2561s
	iters: 200, epoch: 11 | loss: 0.5120007
	speed: 0.2885s/iter; left time: 5342.4563s
Epoch: 11 cost time: 58.377864837646484
Epoch: 11, Steps: 208 | Train Loss: 0.577 Vali Loss: 9.585 Vali Acc: 0.074 Test Loss: 9.585 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.3229020
	speed: 0.6576s/iter; left time: 12107.5434s
	iters: 200, epoch: 12 | loss: 0.7329816
	speed: 0.2564s/iter; left time: 4694.5379s
Epoch: 12 cost time: 56.229976415634155
Epoch: 12, Steps: 208 | Train Loss: 0.556 Vali Loss: 9.685 Vali Acc: 0.082 Test Loss: 9.685 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1825539
	speed: 0.6649s/iter; left time: 12104.5585s
	iters: 200, epoch: 13 | loss: 0.1215820
	speed: 0.2838s/iter; left time: 5138.3850s
Epoch: 13 cost time: 59.394108295440674
Epoch: 13, Steps: 208 | Train Loss: 0.467 Vali Loss: 10.835 Vali Acc: 0.079 Test Loss: 10.835 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0918580375782881
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2481148
	speed: 0.2793s/iter; left time: 5782.0028s
	iters: 200, epoch: 1 | loss: 3.5635805
	speed: 0.2980s/iter; left time: 6138.9168s
Epoch: 1 cost time: 60.152443170547485
Epoch: 1, Steps: 208 | Train Loss: 4.061 Vali Loss: 4.493 Vali Acc: 0.058 Test Loss: 4.493 Test Acc: 0.058
Validation loss decreased (inf --> -0.057814).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1437464
	speed: 0.6093s/iter; left time: 12485.6376s
	iters: 200, epoch: 2 | loss: 4.6781769
	speed: 0.2744s/iter; left time: 5595.4911s
Epoch: 2 cost time: 55.54175305366516
Epoch: 2, Steps: 208 | Train Loss: 3.455 Vali Loss: 4.097 Vali Acc: 0.075 Test Loss: 4.097 Test Acc: 0.075
Validation loss decreased (-0.057814 --> -0.075414).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0213585
	speed: 0.6956s/iter; left time: 14109.7494s
	iters: 200, epoch: 3 | loss: 3.2578335
	speed: 0.2801s/iter; left time: 5654.7590s
Epoch: 3 cost time: 60.60011434555054
Epoch: 3, Steps: 208 | Train Loss: 2.743 Vali Loss: 4.601 Vali Acc: 0.089 Test Loss: 4.601 Test Acc: 0.089
Validation loss decreased (-0.075414 --> -0.089426).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2323472
	speed: 0.6107s/iter; left time: 12260.1740s
	iters: 200, epoch: 4 | loss: 3.0769880
	speed: 0.2814s/iter; left time: 5620.7450s
Epoch: 4 cost time: 57.50887894630432
Epoch: 4, Steps: 208 | Train Loss: 2.172 Vali Loss: 5.461 Vali Acc: 0.084 Test Loss: 5.461 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3306118
	speed: 0.6753s/iter; left time: 13416.5693s
	iters: 200, epoch: 5 | loss: 2.2048204
	speed: 0.2483s/iter; left time: 4908.4971s
Epoch: 5 cost time: 54.67025375366211
Epoch: 5, Steps: 208 | Train Loss: 1.624 Vali Loss: 6.170 Vali Acc: 0.083 Test Loss: 6.170 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8328105
	speed: 0.6585s/iter; left time: 12947.4054s
	iters: 200, epoch: 6 | loss: 1.5523237
	speed: 0.3101s/iter; left time: 6066.3825s
Epoch: 6 cost time: 63.021411418914795
Epoch: 6, Steps: 208 | Train Loss: 1.326 Vali Loss: 7.112 Vali Acc: 0.067 Test Loss: 7.112 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0698961
	speed: 0.5744s/iter; left time: 11174.7634s
	iters: 200, epoch: 7 | loss: 2.1935267
	speed: 0.2570s/iter; left time: 4974.2947s
Epoch: 7 cost time: 51.39285969734192
Epoch: 7, Steps: 208 | Train Loss: 1.101 Vali Loss: 7.703 Vali Acc: 0.079 Test Loss: 7.703 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1869092
	speed: 0.6725s/iter; left time: 12942.3949s
	iters: 200, epoch: 8 | loss: 1.0158426
	speed: 0.2374s/iter; left time: 4544.7878s
Epoch: 8 cost time: 54.40340328216553
Epoch: 8, Steps: 208 | Train Loss: 0.882 Vali Loss: 8.796 Vali Acc: 0.082 Test Loss: 8.796 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.3428192
	speed: 0.6089s/iter; left time: 11591.7969s
	iters: 200, epoch: 9 | loss: 1.1654621
	speed: 0.2978s/iter; left time: 5639.5046s
Epoch: 9 cost time: 59.76800465583801
Epoch: 9, Steps: 208 | Train Loss: 0.734 Vali Loss: 9.824 Vali Acc: 0.075 Test Loss: 9.824 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.4003235
	speed: 0.6554s/iter; left time: 12340.6118s
	iters: 200, epoch: 10 | loss: 0.6497203
	speed: 0.2476s/iter; left time: 4636.9369s
Epoch: 10 cost time: 53.734328508377075
Epoch: 10, Steps: 208 | Train Loss: 0.687 Vali Loss: 9.569 Vali Acc: 0.077 Test Loss: 9.569 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4176508
	speed: 0.6767s/iter; left time: 12600.9598s
	iters: 200, epoch: 11 | loss: 0.7573049
	speed: 0.2507s/iter; left time: 4644.0086s
Epoch: 11 cost time: 56.89609479904175
Epoch: 11, Steps: 208 | Train Loss: 0.580 Vali Loss: 9.791 Vali Acc: 0.075 Test Loss: 9.791 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.9712632
	speed: 0.6139s/iter; left time: 11302.8307s
	iters: 200, epoch: 12 | loss: 0.1224288
	speed: 0.3053s/iter; left time: 5591.0236s
Epoch: 12 cost time: 59.61115384101868
Epoch: 12, Steps: 208 | Train Loss: 0.541 Vali Loss: 10.583 Vali Acc: 0.074 Test Loss: 10.583 Test Acc: 0.074
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1548105
	speed: 0.6728s/iter; left time: 12248.4009s
	iters: 200, epoch: 13 | loss: 0.5099301
	speed: 0.2778s/iter; left time: 5030.3670s
Epoch: 13 cost time: 58.46406006813049
Epoch: 13, Steps: 208 | Train Loss: 0.463 Vali Loss: 11.459 Vali Acc: 0.068 Test Loss: 11.459 Test Acc: 0.068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08947211452430659
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.1364884
	speed: 0.2778s/iter; left time: 5749.7415s
	iters: 200, epoch: 1 | loss: 4.0321426
	speed: 0.2554s/iter; left time: 5262.4071s
Epoch: 1 cost time: 55.978113412857056
Epoch: 1, Steps: 208 | Train Loss: 4.052 Vali Loss: 4.340 Vali Acc: 0.067 Test Loss: 4.340 Test Acc: 0.067
Validation loss decreased (inf --> -0.067359).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5084682
	speed: 0.6776s/iter; left time: 13885.3606s
	iters: 200, epoch: 2 | loss: 4.2841926
	speed: 0.2829s/iter; left time: 5768.9538s
Epoch: 2 cost time: 60.651575803756714
Epoch: 2, Steps: 208 | Train Loss: 3.426 Vali Loss: 4.181 Vali Acc: 0.068 Test Loss: 4.181 Test Acc: 0.068
Validation loss decreased (-0.067359 --> -0.067957).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9665992
	speed: 0.6496s/iter; left time: 13176.8847s
	iters: 200, epoch: 3 | loss: 3.4867799
	speed: 0.2796s/iter; left time: 5644.0813s
Epoch: 3 cost time: 59.637282848358154
Epoch: 3, Steps: 208 | Train Loss: 2.703 Vali Loss: 4.660 Vali Acc: 0.091 Test Loss: 4.660 Test Acc: 0.091
Validation loss decreased (-0.067957 --> -0.090618).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2754858
	speed: 0.6446s/iter; left time: 12940.6610s
	iters: 200, epoch: 4 | loss: 2.3991783
	speed: 0.2693s/iter; left time: 5380.3028s
Epoch: 4 cost time: 57.554344177246094
Epoch: 4, Steps: 208 | Train Loss: 2.108 Vali Loss: 5.423 Vali Acc: 0.087 Test Loss: 5.423 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6807369
	speed: 0.6392s/iter; left time: 12701.1905s
	iters: 200, epoch: 5 | loss: 2.2457664
	speed: 0.2961s/iter; left time: 5854.0095s
Epoch: 5 cost time: 61.496198654174805
Epoch: 5, Steps: 208 | Train Loss: 1.633 Vali Loss: 5.879 Vali Acc: 0.085 Test Loss: 5.879 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1903509
	speed: 0.6133s/iter; left time: 12057.7709s
	iters: 200, epoch: 6 | loss: 1.7357602
	speed: 0.3008s/iter; left time: 5884.8545s
Epoch: 6 cost time: 59.33334517478943
Epoch: 6, Steps: 208 | Train Loss: 1.336 Vali Loss: 6.763 Vali Acc: 0.083 Test Loss: 6.763 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4507608
	speed: 0.6238s/iter; left time: 12135.5297s
	iters: 200, epoch: 7 | loss: 1.2061148
	speed: 0.2738s/iter; left time: 5299.5219s
Epoch: 7 cost time: 55.70250391960144
Epoch: 7, Steps: 208 | Train Loss: 1.107 Vali Loss: 7.081 Vali Acc: 0.086 Test Loss: 7.081 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.5718499
	speed: 0.6342s/iter; left time: 12205.3548s
	iters: 200, epoch: 8 | loss: 0.5136901
	speed: 0.2718s/iter; left time: 5203.1486s
Epoch: 8 cost time: 56.263813734054565
Epoch: 8, Steps: 208 | Train Loss: 0.906 Vali Loss: 8.529 Vali Acc: 0.086 Test Loss: 8.529 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.7551484
	speed: 0.6841s/iter; left time: 13023.0760s
	iters: 200, epoch: 9 | loss: 0.7188674
	speed: 0.2909s/iter; left time: 5508.8442s
Epoch: 9 cost time: 59.832170486450195
Epoch: 9, Steps: 208 | Train Loss: 0.786 Vali Loss: 9.033 Vali Acc: 0.081 Test Loss: 9.033 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.1825821
	speed: 0.6328s/iter; left time: 11914.6695s
	iters: 200, epoch: 10 | loss: 0.7657804
	speed: 0.2883s/iter; left time: 5398.7974s
Epoch: 10 cost time: 56.95872616767883
Epoch: 10, Steps: 208 | Train Loss: 0.739 Vali Loss: 9.309 Vali Acc: 0.078 Test Loss: 9.309 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2458408
	speed: 0.6505s/iter; left time: 12112.6479s
	iters: 200, epoch: 11 | loss: 0.3339961
	speed: 0.2367s/iter; left time: 4384.7933s
Epoch: 11 cost time: 52.164363384246826
Epoch: 11, Steps: 208 | Train Loss: 0.583 Vali Loss: 9.765 Vali Acc: 0.088 Test Loss: 9.765 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.6517876
	speed: 0.6430s/iter; left time: 11839.4442s
	iters: 200, epoch: 12 | loss: 0.5180818
	speed: 0.2810s/iter; left time: 5146.3046s
Epoch: 12 cost time: 60.917718172073364
Epoch: 12, Steps: 208 | Train Loss: 0.540 Vali Loss: 10.043 Vali Acc: 0.085 Test Loss: 10.043 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1065348
	speed: 0.6579s/iter; left time: 11977.4064s
	iters: 200, epoch: 13 | loss: 0.2649172
	speed: 0.2661s/iter; left time: 4818.1581s
Epoch: 13 cost time: 57.56765031814575
Epoch: 13, Steps: 208 | Train Loss: 0.443 Vali Loss: 10.455 Vali Acc: 0.085 Test Loss: 10.455 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09066507605129735
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.1595788
	speed: 0.3003s/iter; left time: 6215.9679s
	iters: 200, epoch: 1 | loss: 3.6915245
	speed: 0.2346s/iter; left time: 4832.9956s
Epoch: 1 cost time: 55.39151978492737
Epoch: 1, Steps: 208 | Train Loss: 4.016 Vali Loss: 4.535 Vali Acc: 0.066 Test Loss: 4.535 Test Acc: 0.066
Validation loss decreased (inf --> -0.065568).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.8890934
	speed: 0.6370s/iter; left time: 13054.5949s
	iters: 200, epoch: 2 | loss: 4.5010180
	speed: 0.2904s/iter; left time: 5922.5732s
Epoch: 2 cost time: 62.439839124679565
Epoch: 2, Steps: 208 | Train Loss: 3.464 Vali Loss: 4.942 Vali Acc: 0.065 Test Loss: 4.942 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1423781
	speed: 0.6396s/iter; left time: 12974.0324s
	iters: 200, epoch: 3 | loss: 3.8909874
	speed: 0.2866s/iter; left time: 5785.2121s
Epoch: 3 cost time: 58.32129907608032
Epoch: 3, Steps: 208 | Train Loss: 2.772 Vali Loss: 5.445 Vali Acc: 0.060 Test Loss: 5.445 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.5047939
	speed: 0.6441s/iter; left time: 12932.5234s
	iters: 200, epoch: 4 | loss: 3.2351391
	speed: 0.2883s/iter; left time: 5758.4601s
Epoch: 4 cost time: 57.70999240875244
Epoch: 4, Steps: 208 | Train Loss: 2.247 Vali Loss: 5.369 Vali Acc: 0.082 Test Loss: 5.369 Test Acc: 0.082
Validation loss decreased (-0.065568 --> -0.081962).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5509557
	speed: 0.6347s/iter; left time: 12609.9912s
	iters: 200, epoch: 5 | loss: 2.5923424
	speed: 0.2935s/iter; left time: 5802.6081s
Epoch: 5 cost time: 58.97754955291748
Epoch: 5, Steps: 208 | Train Loss: 1.712 Vali Loss: 5.983 Vali Acc: 0.079 Test Loss: 5.983 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3798459
	speed: 0.6526s/iter; left time: 12829.9115s
	iters: 200, epoch: 6 | loss: 1.2503704
	speed: 0.2776s/iter; left time: 5429.8495s
Epoch: 6 cost time: 55.97221803665161
Epoch: 6, Steps: 208 | Train Loss: 1.425 Vali Loss: 6.676 Vali Acc: 0.081 Test Loss: 6.676 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9231001
	speed: 0.6459s/iter; left time: 12565.5654s
	iters: 200, epoch: 7 | loss: 1.2753487
	speed: 0.2560s/iter; left time: 4954.4811s
Epoch: 7 cost time: 56.61666297912598
Epoch: 7, Steps: 208 | Train Loss: 1.209 Vali Loss: 6.996 Vali Acc: 0.072 Test Loss: 6.996 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2501018
	speed: 0.6260s/iter; left time: 12047.2482s
	iters: 200, epoch: 8 | loss: 1.0641816
	speed: 0.2838s/iter; left time: 5432.4343s
Epoch: 8 cost time: 59.59232044219971
Epoch: 8, Steps: 208 | Train Loss: 1.041 Vali Loss: 7.662 Vali Acc: 0.080 Test Loss: 7.662 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0216942
	speed: 0.6475s/iter; left time: 12325.8491s
	iters: 200, epoch: 9 | loss: 0.9850017
	speed: 0.3053s/iter; left time: 5781.5944s
Epoch: 9 cost time: 60.339290142059326
Epoch: 9, Steps: 208 | Train Loss: 0.827 Vali Loss: 8.951 Vali Acc: 0.079 Test Loss: 8.951 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1362510
	speed: 0.6618s/iter; left time: 12460.5933s
	iters: 200, epoch: 10 | loss: 0.9297976
	speed: 0.2549s/iter; left time: 4773.9014s
Epoch: 10 cost time: 56.82575845718384
Epoch: 10, Steps: 208 | Train Loss: 0.750 Vali Loss: 8.880 Vali Acc: 0.082 Test Loss: 8.880 Test Acc: 0.082
Validation loss decreased (-0.081962 --> -0.082226).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4295294
	speed: 0.6305s/iter; left time: 11740.0991s
	iters: 200, epoch: 11 | loss: 0.4557837
	speed: 0.2740s/iter; left time: 5074.1122s
Epoch: 11 cost time: 58.42609739303589
Epoch: 11, Steps: 208 | Train Loss: 0.622 Vali Loss: 8.773 Vali Acc: 0.079 Test Loss: 8.773 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3577933
	speed: 0.6536s/iter; left time: 12034.0461s
	iters: 200, epoch: 12 | loss: 0.3752765
	speed: 0.2842s/iter; left time: 5205.3819s
Epoch: 12 cost time: 57.768059492111206
Epoch: 12, Steps: 208 | Train Loss: 0.584 Vali Loss: 9.383 Vali Acc: 0.084 Test Loss: 9.383 Test Acc: 0.084
Validation loss decreased (-0.082226 --> -0.083413).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0665329
	speed: 0.6569s/iter; left time: 11959.5606s
	iters: 200, epoch: 13 | loss: 0.8519746
	speed: 0.2900s/iter; left time: 5250.1639s
Epoch: 13 cost time: 59.73260474205017
Epoch: 13, Steps: 208 | Train Loss: 0.531 Vali Loss: 10.072 Vali Acc: 0.082 Test Loss: 10.072 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1536862
	speed: 0.6307s/iter; left time: 11350.7768s
	iters: 200, epoch: 14 | loss: 0.1012274
	speed: 0.2686s/iter; left time: 4806.6937s
Epoch: 14 cost time: 58.44918394088745
Epoch: 14, Steps: 208 | Train Loss: 0.462 Vali Loss: 10.274 Vali Acc: 0.080 Test Loss: 10.274 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4130144
	speed: 0.6493s/iter; left time: 11550.4264s
	iters: 200, epoch: 15 | loss: 1.3325955
	speed: 0.2486s/iter; left time: 4397.4133s
Epoch: 15 cost time: 55.14121437072754
Epoch: 15, Steps: 208 | Train Loss: 0.449 Vali Loss: 10.293 Vali Acc: 0.079 Test Loss: 10.293 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.7033572
	speed: 0.6598s/iter; left time: 11599.8537s
	iters: 200, epoch: 16 | loss: 0.2974576
	speed: 0.3099s/iter; left time: 5416.6307s
Epoch: 16 cost time: 61.60220170021057
Epoch: 16, Steps: 208 | Train Loss: 0.413 Vali Loss: 9.794 Vali Acc: 0.081 Test Loss: 9.794 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.8203382
	speed: 0.6449s/iter; left time: 11203.4947s
	iters: 200, epoch: 17 | loss: 0.7369731
	speed: 0.2686s/iter; left time: 4639.6580s
Epoch: 17 cost time: 57.49193549156189
Epoch: 17, Steps: 208 | Train Loss: 0.351 Vali Loss: 11.257 Vali Acc: 0.084 Test Loss: 11.257 Test Acc: 0.084
Validation loss decreased (-0.083413 --> -0.084289).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3072524
	speed: 0.6490s/iter; left time: 11139.5807s
	iters: 200, epoch: 18 | loss: 0.3743489
	speed: 0.2721s/iter; left time: 4643.6059s
Epoch: 18 cost time: 57.35388469696045
Epoch: 18, Steps: 208 | Train Loss: 0.333 Vali Loss: 11.103 Vali Acc: 0.081 Test Loss: 11.103 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1073085
	speed: 0.6804s/iter; left time: 11538.2585s
	iters: 200, epoch: 19 | loss: 0.3113154
	speed: 0.2783s/iter; left time: 4692.0099s
Epoch: 19 cost time: 59.950507402420044
Epoch: 19, Steps: 208 | Train Loss: 0.360 Vali Loss: 10.998 Vali Acc: 0.082 Test Loss: 10.998 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1514845
	speed: 0.6501s/iter; left time: 10887.9076s
	iters: 200, epoch: 20 | loss: 1.2621833
	speed: 0.2793s/iter; left time: 4649.5912s
Epoch: 20 cost time: 58.14298415184021
Epoch: 20, Steps: 208 | Train Loss: 0.363 Vali Loss: 11.381 Vali Acc: 0.084 Test Loss: 11.381 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4832820
	speed: 0.5922s/iter; left time: 9795.0733s
	iters: 200, epoch: 21 | loss: 0.1372483
	speed: 0.2844s/iter; left time: 4675.8742s
Epoch: 21 cost time: 56.41931915283203
Epoch: 21, Steps: 208 | Train Loss: 0.298 Vali Loss: 11.582 Vali Acc: 0.077 Test Loss: 11.582 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3068126
	speed: 0.6744s/iter; left time: 11014.1939s
	iters: 200, epoch: 22 | loss: 0.8339017
	speed: 0.2542s/iter; left time: 4126.2156s
Epoch: 22 cost time: 56.77014684677124
Epoch: 22, Steps: 208 | Train Loss: 0.301 Vali Loss: 12.560 Vali Acc: 0.083 Test Loss: 12.560 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0357090
	speed: 0.6664s/iter; left time: 10746.0484s
	iters: 200, epoch: 23 | loss: 0.0841607
	speed: 0.2937s/iter; left time: 4707.3029s
Epoch: 23 cost time: 62.28613233566284
Epoch: 23, Steps: 208 | Train Loss: 0.268 Vali Loss: 11.502 Vali Acc: 0.081 Test Loss: 11.502 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.6147127
	speed: 0.5998s/iter; left time: 9547.0358s
	iters: 200, epoch: 24 | loss: 0.1789347
	speed: 0.2773s/iter; left time: 4386.7639s
Epoch: 24 cost time: 55.923789978027344
Epoch: 24, Steps: 208 | Train Loss: 0.280 Vali Loss: 11.911 Vali Acc: 0.082 Test Loss: 11.911 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.7450868
	speed: 0.6568s/iter; left time: 10317.7775s
	iters: 200, epoch: 25 | loss: 0.1687087
	speed: 0.2720s/iter; left time: 4245.6106s
Epoch: 25 cost time: 58.47591042518616
Epoch: 25, Steps: 208 | Train Loss: 0.317 Vali Loss: 12.163 Vali Acc: 0.084 Test Loss: 12.163 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.5404548
	speed: 0.6240s/iter; left time: 9672.3121s
	iters: 200, epoch: 26 | loss: 0.1386188
	speed: 0.2915s/iter; left time: 4489.7324s
Epoch: 26 cost time: 59.17417097091675
Epoch: 26, Steps: 208 | Train Loss: 0.296 Vali Loss: 11.875 Vali Acc: 0.080 Test Loss: 11.875 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.2439762
	speed: 0.6653s/iter; left time: 10174.0432s
	iters: 200, epoch: 27 | loss: 0.0590040
	speed: 0.2727s/iter; left time: 4142.6002s
Epoch: 27 cost time: 59.861778020858765
Epoch: 27, Steps: 208 | Train Loss: 0.242 Vali Loss: 11.929 Vali Acc: 0.075 Test Loss: 11.929 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08440202803459589
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3823776
	speed: 0.2981s/iter; left time: 6170.7065s
	iters: 200, epoch: 1 | loss: 3.8950701
	speed: 0.2996s/iter; left time: 6171.4445s
Epoch: 1 cost time: 62.23110294342041
Epoch: 1, Steps: 208 | Train Loss: 3.945 Vali Loss: 5.070 Vali Acc: 0.067 Test Loss: 5.070 Test Acc: 0.067
Validation loss decreased (inf --> -0.067053).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.8977308
	speed: 0.6374s/iter; left time: 13061.8939s
	iters: 200, epoch: 2 | loss: 5.2892675
	speed: 0.2677s/iter; left time: 5459.2000s
Epoch: 2 cost time: 58.124019384384155
Epoch: 2, Steps: 208 | Train Loss: 3.587 Vali Loss: 5.398 Vali Acc: 0.077 Test Loss: 5.398 Test Acc: 0.077
Validation loss decreased (-0.067053 --> -0.076594).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1209996
	speed: 0.6759s/iter; left time: 13710.4562s
	iters: 200, epoch: 3 | loss: 3.8813300
	speed: 0.2702s/iter; left time: 5454.4689s
Epoch: 3 cost time: 58.55633902549744
Epoch: 3, Steps: 208 | Train Loss: 3.021 Vali Loss: 5.519 Vali Acc: 0.076 Test Loss: 5.519 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6100857
	speed: 0.6047s/iter; left time: 12140.4201s
	iters: 200, epoch: 4 | loss: 3.4007406
	speed: 0.3004s/iter; left time: 6001.1180s
Epoch: 4 cost time: 58.736061573028564
Epoch: 4, Steps: 208 | Train Loss: 2.496 Vali Loss: 5.397 Vali Acc: 0.089 Test Loss: 5.397 Test Acc: 0.089
Validation loss decreased (-0.076594 --> -0.088523).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1344619
	speed: 0.6484s/iter; left time: 12882.3474s
	iters: 200, epoch: 5 | loss: 2.9339116
	speed: 0.2763s/iter; left time: 5461.3208s
Epoch: 5 cost time: 57.820196866989136
Epoch: 5, Steps: 208 | Train Loss: 2.041 Vali Loss: 5.601 Vali Acc: 0.084 Test Loss: 5.601 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4652302
	speed: 0.6150s/iter; left time: 12090.7866s
	iters: 200, epoch: 6 | loss: 1.8115227
	speed: 0.2616s/iter; left time: 5116.8117s
Epoch: 6 cost time: 53.95569825172424
Epoch: 6, Steps: 208 | Train Loss: 1.742 Vali Loss: 6.167 Vali Acc: 0.082 Test Loss: 6.167 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4155983
	speed: 0.6105s/iter; left time: 11876.2463s
	iters: 200, epoch: 7 | loss: 2.5047312
	speed: 0.2400s/iter; left time: 4643.8817s
Epoch: 7 cost time: 49.93698024749756
Epoch: 7, Steps: 208 | Train Loss: 1.566 Vali Loss: 6.254 Vali Acc: 0.082 Test Loss: 6.254 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.3905489
	speed: 0.5743s/iter; left time: 11051.4620s
	iters: 200, epoch: 8 | loss: 1.7907969
	speed: 0.2674s/iter; left time: 5119.1978s
Epoch: 8 cost time: 55.15757656097412
Epoch: 8, Steps: 208 | Train Loss: 1.397 Vali Loss: 6.750 Vali Acc: 0.085 Test Loss: 6.750 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.2358931
	speed: 0.6166s/iter; left time: 11738.0867s
	iters: 200, epoch: 9 | loss: 1.7313997
	speed: 0.2592s/iter; left time: 4908.6141s
Epoch: 9 cost time: 54.6151282787323
Epoch: 9, Steps: 208 | Train Loss: 1.155 Vali Loss: 7.842 Vali Acc: 0.084 Test Loss: 7.842 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.2024329
	speed: 0.5716s/iter; left time: 10762.1115s
	iters: 200, epoch: 10 | loss: 2.4889150
	speed: 0.2457s/iter; left time: 4602.5562s
Epoch: 10 cost time: 51.54836583137512
Epoch: 10, Steps: 208 | Train Loss: 1.118 Vali Loss: 7.465 Vali Acc: 0.088 Test Loss: 7.465 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.9058384
	speed: 0.5731s/iter; left time: 10671.2997s
	iters: 200, epoch: 11 | loss: 0.9829422
	speed: 0.2423s/iter; left time: 4487.9420s
Epoch: 11 cost time: 50.18808317184448
Epoch: 11, Steps: 208 | Train Loss: 1.003 Vali Loss: 7.852 Vali Acc: 0.090 Test Loss: 7.852 Test Acc: 0.090
Validation loss decreased (-0.088523 --> -0.089692).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5619197
	speed: 0.6061s/iter; left time: 11160.7810s
	iters: 200, epoch: 12 | loss: 0.3160931
	speed: 0.2645s/iter; left time: 4843.4774s
Epoch: 12 cost time: 54.97050142288208
Epoch: 12, Steps: 208 | Train Loss: 0.813 Vali Loss: 8.467 Vali Acc: 0.091 Test Loss: 8.467 Test Acc: 0.091
Validation loss decreased (-0.089692 --> -0.090879).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5809482
	speed: 0.5930s/iter; left time: 10795.8597s
	iters: 200, epoch: 13 | loss: 0.7777567
	speed: 0.2426s/iter; left time: 4392.3094s
Epoch: 13 cost time: 50.704712867736816
Epoch: 13, Steps: 208 | Train Loss: 0.756 Vali Loss: 8.595 Vali Acc: 0.086 Test Loss: 8.595 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7697478
	speed: 0.5613s/iter; left time: 10101.7808s
	iters: 200, epoch: 14 | loss: 0.1457055
	speed: 0.2472s/iter; left time: 4423.5989s
Epoch: 14 cost time: 51.11378073692322
Epoch: 14, Steps: 208 | Train Loss: 0.650 Vali Loss: 9.072 Vali Acc: 0.086 Test Loss: 9.072 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4180541
	speed: 0.6214s/iter; left time: 11054.1007s
	iters: 200, epoch: 15 | loss: 0.4076131
	speed: 0.2495s/iter; left time: 4413.6333s
Epoch: 15 cost time: 53.97865867614746
Epoch: 15, Steps: 208 | Train Loss: 0.631 Vali Loss: 9.471 Vali Acc: 0.089 Test Loss: 9.471 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.8925378
	speed: 0.5861s/iter; left time: 10303.8569s
	iters: 200, epoch: 16 | loss: 0.8929682
	speed: 0.2414s/iter; left time: 4220.4559s
Epoch: 16 cost time: 52.861366510391235
Epoch: 16, Steps: 208 | Train Loss: 0.594 Vali Loss: 8.995 Vali Acc: 0.090 Test Loss: 8.995 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1536777
	speed: 0.6029s/iter; left time: 10475.0342s
	iters: 200, epoch: 17 | loss: 0.5752678
	speed: 0.2488s/iter; left time: 4296.9128s
Epoch: 17 cost time: 51.694987773895264
Epoch: 17, Steps: 208 | Train Loss: 0.481 Vali Loss: 9.358 Vali Acc: 0.085 Test Loss: 9.358 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6472971
	speed: 0.5580s/iter; left time: 9577.9218s
	iters: 200, epoch: 18 | loss: 0.6819292
	speed: 0.2553s/iter; left time: 4356.4325s
Epoch: 18 cost time: 52.623515367507935
Epoch: 18, Steps: 208 | Train Loss: 0.519 Vali Loss: 9.604 Vali Acc: 0.094 Test Loss: 9.604 Test Acc: 0.094
Validation loss decreased (-0.090879 --> -0.093551).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4277745
	speed: 0.6211s/iter; left time: 10531.5226s
	iters: 200, epoch: 19 | loss: 0.1608505
	speed: 0.2601s/iter; left time: 4384.6127s
Epoch: 19 cost time: 53.70403814315796
Epoch: 19, Steps: 208 | Train Loss: 0.461 Vali Loss: 9.825 Vali Acc: 0.085 Test Loss: 9.825 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1605166
	speed: 0.5684s/iter; left time: 9520.5768s
	iters: 200, epoch: 20 | loss: 1.5744909
	speed: 0.2497s/iter; left time: 4157.6808s
Epoch: 20 cost time: 52.01390981674194
Epoch: 20, Steps: 208 | Train Loss: 0.459 Vali Loss: 9.510 Vali Acc: 0.079 Test Loss: 9.510 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1390187
	speed: 0.6007s/iter; left time: 9935.8613s
	iters: 200, epoch: 21 | loss: 0.2858343
	speed: 0.2318s/iter; left time: 3811.0285s
Epoch: 21 cost time: 50.56097936630249
Epoch: 21, Steps: 208 | Train Loss: 0.418 Vali Loss: 10.269 Vali Acc: 0.076 Test Loss: 10.269 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.7627178
	speed: 0.5545s/iter; left time: 9057.3286s
	iters: 200, epoch: 22 | loss: 0.1538890
	speed: 0.2764s/iter; left time: 4486.8479s
Epoch: 22 cost time: 55.154130697250366
Epoch: 22, Steps: 208 | Train Loss: 0.385 Vali Loss: 10.463 Vali Acc: 0.077 Test Loss: 10.463 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.2626655
	speed: 0.6278s/iter; left time: 10123.3781s
	iters: 200, epoch: 23 | loss: 0.1148088
	speed: 0.2553s/iter; left time: 4090.7249s
Epoch: 23 cost time: 53.40823698043823
Epoch: 23, Steps: 208 | Train Loss: 0.374 Vali Loss: 10.341 Vali Acc: 0.079 Test Loss: 10.341 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.5676359
	speed: 0.5566s/iter; left time: 8859.4805s
	iters: 200, epoch: 24 | loss: 0.9628489
	speed: 0.2521s/iter; left time: 3986.8497s
Epoch: 24 cost time: 52.70417618751526
Epoch: 24, Steps: 208 | Train Loss: 0.354 Vali Loss: 10.328 Vali Acc: 0.082 Test Loss: 10.328 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.2296838
	speed: 0.6258s/iter; left time: 9831.0095s
	iters: 200, epoch: 25 | loss: 0.1670818
	speed: 0.2483s/iter; left time: 3875.7531s
Epoch: 25 cost time: 53.31736397743225
Epoch: 25, Steps: 208 | Train Loss: 0.319 Vali Loss: 10.973 Vali Acc: 0.078 Test Loss: 10.973 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0198232
	speed: 0.5812s/iter; left time: 9008.4920s
	iters: 200, epoch: 26 | loss: 0.6285077
	speed: 0.2715s/iter; left time: 4181.7482s
Epoch: 26 cost time: 55.21134352684021
Epoch: 26, Steps: 208 | Train Loss: 0.314 Vali Loss: 10.976 Vali Acc: 0.084 Test Loss: 10.976 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0528102
	speed: 0.6249s/iter; left time: 9555.8519s
	iters: 200, epoch: 27 | loss: 0.4987967
	speed: 0.2384s/iter; left time: 3622.2199s
Epoch: 27 cost time: 51.94070243835449
Epoch: 27, Steps: 208 | Train Loss: 0.288 Vali Loss: 11.264 Vali Acc: 0.087 Test Loss: 11.264 Test Acc: 0.087
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.2774664
	speed: 0.5509s/iter; left time: 8309.8183s
	iters: 200, epoch: 28 | loss: 0.1261805
	speed: 0.2628s/iter; left time: 3937.8252s
Epoch: 28 cost time: 52.33685803413391
Epoch: 28, Steps: 208 | Train Loss: 0.292 Vali Loss: 11.336 Vali Acc: 0.089 Test Loss: 11.336 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09364747986877424
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.1693881
	speed: 0.2943s/iter; left time: 6091.3369s
	iters: 200, epoch: 1 | loss: 4.0602551
	speed: 0.2748s/iter; left time: 5661.4709s
Epoch: 1 cost time: 59.58098292350769
Epoch: 1, Steps: 208 | Train Loss: 3.920 Vali Loss: 5.106 Vali Acc: 0.066 Test Loss: 5.106 Test Acc: 0.066
Validation loss decreased (inf --> -0.066158).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.3953042
	speed: 0.7011s/iter; left time: 14367.5969s
	iters: 200, epoch: 2 | loss: 4.1256371
	speed: 0.2730s/iter; left time: 5567.8334s
Epoch: 2 cost time: 59.803340435028076
Epoch: 2, Steps: 208 | Train Loss: 3.635 Vali Loss: 5.579 Vali Acc: 0.064 Test Loss: 5.579 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.9498816
	speed: 0.6193s/iter; left time: 12562.7684s
	iters: 200, epoch: 3 | loss: 3.7284939
	speed: 0.2832s/iter; left time: 5717.2172s
Epoch: 3 cost time: 58.93899178504944
Epoch: 3, Steps: 208 | Train Loss: 3.219 Vali Loss: 5.364 Vali Acc: 0.066 Test Loss: 5.364 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.1225228
	speed: 0.6732s/iter; left time: 13515.4860s
	iters: 200, epoch: 4 | loss: 3.8525615
	speed: 0.2922s/iter; left time: 5836.9571s
Epoch: 4 cost time: 61.43812966346741
Epoch: 4, Steps: 208 | Train Loss: 2.756 Vali Loss: 5.487 Vali Acc: 0.064 Test Loss: 5.487 Test Acc: 0.064
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.4286125
	speed: 0.6620s/iter; left time: 13153.4879s
	iters: 200, epoch: 5 | loss: 3.3083513
	speed: 0.2560s/iter; left time: 5060.9555s
Epoch: 5 cost time: 56.63216996192932
Epoch: 5, Steps: 208 | Train Loss: 2.364 Vali Loss: 5.203 Vali Acc: 0.067 Test Loss: 5.203 Test Acc: 0.067
Validation loss decreased (-0.066158 --> -0.066754).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7071238
	speed: 0.6472s/iter; left time: 12724.0965s
	iters: 200, epoch: 6 | loss: 3.8645747
	speed: 0.2793s/iter; left time: 5464.2567s
Epoch: 6 cost time: 58.90080642700195
Epoch: 6, Steps: 208 | Train Loss: 2.009 Vali Loss: 5.653 Vali Acc: 0.082 Test Loss: 5.653 Test Acc: 0.082
Validation loss decreased (-0.066754 --> -0.081960).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2780679
	speed: 0.6344s/iter; left time: 12340.2531s
	iters: 200, epoch: 7 | loss: 2.2500091
	speed: 0.2962s/iter; left time: 5732.2517s
Epoch: 7 cost time: 61.045008182525635
Epoch: 7, Steps: 208 | Train Loss: 1.794 Vali Loss: 5.983 Vali Acc: 0.069 Test Loss: 5.983 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8428910
	speed: 0.6783s/iter; left time: 13054.0876s
	iters: 200, epoch: 8 | loss: 1.8420008
	speed: 0.2884s/iter; left time: 5522.0362s
Epoch: 8 cost time: 60.62618088722229
Epoch: 8, Steps: 208 | Train Loss: 1.552 Vali Loss: 6.339 Vali Acc: 0.071 Test Loss: 6.339 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7676921
	speed: 0.6517s/iter; left time: 12406.6507s
	iters: 200, epoch: 9 | loss: 1.5834808
	speed: 0.2724s/iter; left time: 5158.1196s
Epoch: 9 cost time: 57.57160949707031
Epoch: 9, Steps: 208 | Train Loss: 1.356 Vali Loss: 6.368 Vali Acc: 0.075 Test Loss: 6.368 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.4139357
	speed: 0.6417s/iter; left time: 12082.3511s
	iters: 200, epoch: 10 | loss: 2.6312590
	speed: 0.3016s/iter; left time: 5649.1293s
Epoch: 10 cost time: 61.1967089176178
Epoch: 10, Steps: 208 | Train Loss: 1.265 Vali Loss: 6.457 Vali Acc: 0.075 Test Loss: 6.457 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.7841015
	speed: 0.6415s/iter; left time: 11945.4791s
	iters: 200, epoch: 11 | loss: 0.5231097
	speed: 0.2760s/iter; left time: 5111.9776s
Epoch: 11 cost time: 57.484169721603394
Epoch: 11, Steps: 208 | Train Loss: 1.047 Vali Loss: 7.007 Vali Acc: 0.077 Test Loss: 7.007 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1212935
	speed: 0.6690s/iter; left time: 12318.8872s
	iters: 200, epoch: 12 | loss: 0.5603079
	speed: 0.2454s/iter; left time: 4493.9237s
Epoch: 12 cost time: 55.77357363700867
Epoch: 12, Steps: 208 | Train Loss: 1.000 Vali Loss: 7.450 Vali Acc: 0.080 Test Loss: 7.450 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2369729
	speed: 0.6073s/iter; left time: 11055.3664s
	iters: 200, epoch: 13 | loss: 1.3792990
	speed: 0.2945s/iter; left time: 5331.6082s
Epoch: 13 cost time: 59.460020542144775
Epoch: 13, Steps: 208 | Train Loss: 0.847 Vali Loss: 7.134 Vali Acc: 0.077 Test Loss: 7.134 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.8206931
	speed: 0.6616s/iter; left time: 11906.5307s
	iters: 200, epoch: 14 | loss: 0.2569441
	speed: 0.2529s/iter; left time: 4526.8163s
Epoch: 14 cost time: 54.32056713104248
Epoch: 14, Steps: 208 | Train Loss: 0.794 Vali Loss: 7.284 Vali Acc: 0.078 Test Loss: 7.284 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.9968027
	speed: 0.6823s/iter; left time: 12136.8034s
	iters: 200, epoch: 15 | loss: 0.9813769
	speed: 0.2604s/iter; left time: 4605.7699s
Epoch: 15 cost time: 57.155312299728394
Epoch: 15, Steps: 208 | Train Loss: 0.697 Vali Loss: 7.961 Vali Acc: 0.081 Test Loss: 7.961 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.7070053
	speed: 0.6337s/iter; left time: 11140.4509s
	iters: 200, epoch: 16 | loss: 0.9805685
	speed: 0.2796s/iter; left time: 4886.9389s
Epoch: 16 cost time: 59.51815128326416
Epoch: 16, Steps: 208 | Train Loss: 0.652 Vali Loss: 7.878 Vali Acc: 0.082 Test Loss: 7.878 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08201610498061437
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5809543
	speed: 0.2709s/iter; left time: 5607.8529s
	iters: 200, epoch: 1 | loss: 3.9563928
	speed: 0.2719s/iter; left time: 5600.5800s
Epoch: 1 cost time: 56.83943843841553
Epoch: 1, Steps: 208 | Train Loss: 3.902 Vali Loss: 5.105 Vali Acc: 0.037 Test Loss: 5.105 Test Acc: 0.037
Validation loss decreased (inf --> -0.037229).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3691168
	speed: 0.6477s/iter; left time: 13274.1784s
	iters: 200, epoch: 2 | loss: 4.9577079
	speed: 0.2703s/iter; left time: 5512.5719s
Epoch: 2 cost time: 56.64943194389343
Epoch: 2, Steps: 208 | Train Loss: 3.728 Vali Loss: 5.115 Vali Acc: 0.041 Test Loss: 5.115 Test Acc: 0.041
Validation loss decreased (-0.037229 --> -0.040808).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6519725
	speed: 0.6531s/iter; left time: 13248.5792s
	iters: 200, epoch: 3 | loss: 4.4911423
	speed: 0.2427s/iter; left time: 4898.1965s
Epoch: 3 cost time: 54.20651626586914
Epoch: 3, Steps: 208 | Train Loss: 3.402 Vali Loss: 5.089 Vali Acc: 0.050 Test Loss: 5.089 Test Acc: 0.050
Validation loss decreased (-0.040808 --> -0.049457).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4540641
	speed: 0.6400s/iter; left time: 12850.2193s
	iters: 200, epoch: 4 | loss: 3.7909341
	speed: 0.2751s/iter; left time: 5496.1489s
Epoch: 4 cost time: 59.06702160835266
Epoch: 4, Steps: 208 | Train Loss: 3.056 Vali Loss: 5.119 Vali Acc: 0.051 Test Loss: 5.119 Test Acc: 0.051
Validation loss decreased (-0.049457 --> -0.050650).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6687367
	speed: 0.6084s/iter; left time: 12089.1919s
	iters: 200, epoch: 5 | loss: 2.7501554
	speed: 0.2816s/iter; left time: 5567.6388s
Epoch: 5 cost time: 56.74378776550293
Epoch: 5, Steps: 208 | Train Loss: 2.650 Vali Loss: 5.134 Vali Acc: 0.060 Test Loss: 5.134 Test Acc: 0.060
Validation loss decreased (-0.050650 --> -0.059597).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1608574
	speed: 0.6791s/iter; left time: 13352.5099s
	iters: 200, epoch: 6 | loss: 3.5116274
	speed: 0.2535s/iter; left time: 4959.0860s
Epoch: 6 cost time: 57.19211268424988
Epoch: 6, Steps: 208 | Train Loss: 2.382 Vali Loss: 5.095 Vali Acc: 0.055 Test Loss: 5.095 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5321791
	speed: 0.5966s/iter; left time: 11605.8562s
	iters: 200, epoch: 7 | loss: 3.3612647
	speed: 0.2877s/iter; left time: 5567.5573s
Epoch: 7 cost time: 58.29095005989075
Epoch: 7, Steps: 208 | Train Loss: 2.119 Vali Loss: 5.481 Vali Acc: 0.059 Test Loss: 5.481 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7422885
	speed: 0.6720s/iter; left time: 12932.6243s
	iters: 200, epoch: 8 | loss: 2.4135056
	speed: 0.2590s/iter; left time: 4957.8735s
Epoch: 8 cost time: 57.79076957702637
Epoch: 8, Steps: 208 | Train Loss: 1.878 Vali Loss: 5.558 Vali Acc: 0.076 Test Loss: 5.558 Test Acc: 0.076
Validation loss decreased (-0.059597 --> -0.075996).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5181093
	speed: 0.6813s/iter; left time: 12970.5858s
	iters: 200, epoch: 9 | loss: 2.6164036
	speed: 0.2750s/iter; left time: 5207.0287s
Epoch: 9 cost time: 58.24707293510437
Epoch: 9, Steps: 208 | Train Loss: 1.577 Vali Loss: 5.950 Vali Acc: 0.072 Test Loss: 5.950 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4067349
	speed: 0.5749s/iter; left time: 10825.0458s
	iters: 200, epoch: 10 | loss: 1.5621501
	speed: 0.2698s/iter; left time: 5053.9673s
Epoch: 10 cost time: 54.351717710494995
Epoch: 10, Steps: 208 | Train Loss: 1.396 Vali Loss: 6.112 Vali Acc: 0.068 Test Loss: 6.112 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4027493
	speed: 0.6730s/iter; left time: 12532.7700s
	iters: 200, epoch: 11 | loss: 1.1722407
	speed: 0.2756s/iter; left time: 5104.1286s
Epoch: 11 cost time: 58.59627175331116
Epoch: 11, Steps: 208 | Train Loss: 1.267 Vali Loss: 6.607 Vali Acc: 0.074 Test Loss: 6.607 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4591544
	speed: 0.6632s/iter; left time: 12211.6886s
	iters: 200, epoch: 12 | loss: 0.8738059
	speed: 0.2670s/iter; left time: 4890.0861s
Epoch: 12 cost time: 58.38654279708862
Epoch: 12, Steps: 208 | Train Loss: 1.119 Vali Loss: 7.071 Vali Acc: 0.074 Test Loss: 7.071 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7849299
	speed: 0.6418s/iter; left time: 11684.7756s
	iters: 200, epoch: 13 | loss: 0.7442065
	speed: 0.2488s/iter; left time: 4505.3105s
Epoch: 13 cost time: 52.954922914505005
Epoch: 13, Steps: 208 | Train Loss: 1.029 Vali Loss: 7.059 Vali Acc: 0.076 Test Loss: 7.059 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.9555970
	speed: 0.6631s/iter; left time: 11933.5117s
	iters: 200, epoch: 14 | loss: 1.6672803
	speed: 0.2862s/iter; left time: 5121.2581s
Epoch: 14 cost time: 60.722660779953
Epoch: 14, Steps: 208 | Train Loss: 0.875 Vali Loss: 7.413 Vali Acc: 0.070 Test Loss: 7.413 Test Acc: 0.070
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.9141173
	speed: 0.6180s/iter; left time: 10993.5784s
	iters: 200, epoch: 15 | loss: 0.8257804
	speed: 0.2751s/iter; left time: 4866.6362s
Epoch: 15 cost time: 57.13913345336914
Epoch: 15, Steps: 208 | Train Loss: 0.853 Vali Loss: 7.597 Vali Acc: 0.076 Test Loss: 7.597 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1354336
	speed: 0.6475s/iter; left time: 11383.9539s
	iters: 200, epoch: 16 | loss: 1.6536748
	speed: 0.2736s/iter; left time: 4782.1244s
Epoch: 16 cost time: 58.99848818778992
Epoch: 16, Steps: 208 | Train Loss: 0.732 Vali Loss: 7.939 Vali Acc: 0.072 Test Loss: 7.939 Test Acc: 0.072
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.3513825
	speed: 0.6060s/iter; left time: 10527.9621s
	iters: 200, epoch: 17 | loss: 1.1026679
	speed: 0.3010s/iter; left time: 5199.3261s
Epoch: 17 cost time: 60.722142696380615
Epoch: 17, Steps: 208 | Train Loss: 0.703 Vali Loss: 8.290 Vali Acc: 0.068 Test Loss: 8.290 Test Acc: 0.068
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1865012
	speed: 0.6022s/iter; left time: 10336.7957s
	iters: 200, epoch: 18 | loss: 0.7408367
	speed: 0.2951s/iter; left time: 5036.5052s
Epoch: 18 cost time: 58.65867567062378
Epoch: 18, Steps: 208 | Train Loss: 0.673 Vali Loss: 7.838 Vali Acc: 0.075 Test Loss: 7.838 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0760512973456606
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6063046
	speed: 0.2816s/iter; left time: 5828.5729s
	iters: 200, epoch: 1 | loss: 4.2544279
	speed: 0.2807s/iter; left time: 5781.7631s
Epoch: 1 cost time: 58.438244104385376
Epoch: 1, Steps: 208 | Train Loss: 3.859 Vali Loss: 5.731 Vali Acc: 0.033 Test Loss: 5.731 Test Acc: 0.033
Validation loss decreased (inf --> -0.033346).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.2105303
	speed: 0.6526s/iter; left time: 13374.5197s
	iters: 200, epoch: 2 | loss: 4.8747826
	speed: 0.2870s/iter; left time: 5852.5290s
Epoch: 2 cost time: 59.551289081573486
Epoch: 2, Steps: 208 | Train Loss: 3.875 Vali Loss: 6.039 Vali Acc: 0.036 Test Loss: 6.039 Test Acc: 0.036
Validation loss decreased (-0.033346 --> -0.036027).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4485393
	speed: 0.5924s/iter; left time: 12017.1072s
	iters: 200, epoch: 3 | loss: 4.8211088
	speed: 0.2758s/iter; left time: 5566.3670s
Epoch: 3 cost time: 54.21541118621826
Epoch: 3, Steps: 208 | Train Loss: 3.768 Vali Loss: 5.436 Vali Acc: 0.055 Test Loss: 5.436 Test Acc: 0.055
Validation loss decreased (-0.036027 --> -0.054524).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5130351
	speed: 0.6201s/iter; left time: 12449.0493s
	iters: 200, epoch: 4 | loss: 4.5143933
	speed: 0.2555s/iter; left time: 5103.1672s
Epoch: 4 cost time: 52.69589924812317
Epoch: 4, Steps: 208 | Train Loss: 3.487 Vali Loss: 4.820 Vali Acc: 0.047 Test Loss: 4.820 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8467844
	speed: 0.6373s/iter; left time: 12662.4420s
	iters: 200, epoch: 5 | loss: 4.2054148
	speed: 0.2737s/iter; left time: 5409.8612s
Epoch: 5 cost time: 56.91885232925415
Epoch: 5, Steps: 208 | Train Loss: 3.200 Vali Loss: 4.513 Vali Acc: 0.057 Test Loss: 4.513 Test Acc: 0.057
Validation loss decreased (-0.054524 --> -0.057217).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0738325
	speed: 0.6322s/iter; left time: 12430.3448s
	iters: 200, epoch: 6 | loss: 3.9860818
	speed: 0.2605s/iter; left time: 5094.7742s
Epoch: 6 cost time: 54.08690333366394
Epoch: 6, Steps: 208 | Train Loss: 3.082 Vali Loss: 4.322 Vali Acc: 0.057 Test Loss: 4.322 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7145123
	speed: 0.6395s/iter; left time: 12440.3358s
	iters: 200, epoch: 7 | loss: 3.5528226
	speed: 0.2438s/iter; left time: 4717.4026s
Epoch: 7 cost time: 53.794249534606934
Epoch: 7, Steps: 208 | Train Loss: 3.030 Vali Loss: 4.266 Vali Acc: 0.059 Test Loss: 4.266 Test Acc: 0.059
Validation loss decreased (-0.057217 --> -0.059009).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4567869
	speed: 0.6112s/iter; left time: 11762.5688s
	iters: 200, epoch: 8 | loss: 3.6105015
	speed: 0.2741s/iter; left time: 5247.8329s
Epoch: 8 cost time: 57.94372606277466
Epoch: 8, Steps: 208 | Train Loss: 2.956 Vali Loss: 4.257 Vali Acc: 0.065 Test Loss: 4.257 Test Acc: 0.065
Validation loss decreased (-0.059009 --> -0.064974).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6446729
	speed: 0.6384s/iter; left time: 12152.4519s
	iters: 200, epoch: 9 | loss: 3.2614493
	speed: 0.2723s/iter; left time: 5156.3041s
Epoch: 9 cost time: 57.84618067741394
Epoch: 9, Steps: 208 | Train Loss: 2.790 Vali Loss: 4.368 Vali Acc: 0.064 Test Loss: 4.368 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.8426216
	speed: 0.6083s/iter; left time: 11454.0578s
	iters: 200, epoch: 10 | loss: 2.8044119
	speed: 0.2750s/iter; left time: 5150.7110s
Epoch: 10 cost time: 56.44008255004883
Epoch: 10, Steps: 208 | Train Loss: 2.553 Vali Loss: 4.357 Vali Acc: 0.067 Test Loss: 4.357 Test Acc: 0.067
Validation loss decreased (-0.064974 --> -0.066762).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6555041
	speed: 0.5889s/iter; left time: 10966.7523s
	iters: 200, epoch: 11 | loss: 2.2959664
	speed: 0.2751s/iter; left time: 5094.8398s
Epoch: 11 cost time: 54.956124782562256
Epoch: 11, Steps: 208 | Train Loss: 2.275 Vali Loss: 4.668 Vali Acc: 0.063 Test Loss: 4.668 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9908619
	speed: 0.6553s/iter; left time: 12066.4490s
	iters: 200, epoch: 12 | loss: 1.8501077
	speed: 0.2646s/iter; left time: 4844.7558s
Epoch: 12 cost time: 56.513593435287476
Epoch: 12, Steps: 208 | Train Loss: 2.074 Vali Loss: 4.923 Vali Acc: 0.067 Test Loss: 4.923 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6198156
	speed: 0.6507s/iter; left time: 11846.4884s
	iters: 200, epoch: 13 | loss: 2.4272988
	speed: 0.2412s/iter; left time: 4367.3870s
Epoch: 13 cost time: 53.241843700408936
Epoch: 13, Steps: 208 | Train Loss: 1.758 Vali Loss: 5.292 Vali Acc: 0.066 Test Loss: 5.292 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4587409
	speed: 0.6365s/iter; left time: 11454.9396s
	iters: 200, epoch: 14 | loss: 1.1142690
	speed: 0.2468s/iter; left time: 4416.3346s
Epoch: 14 cost time: 55.090094327926636
Epoch: 14, Steps: 208 | Train Loss: 1.412 Vali Loss: 5.408 Vali Acc: 0.079 Test Loss: 5.408 Test Acc: 0.079
Validation loss decreased (-0.066762 --> -0.078681).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7652559
	speed: 0.6414s/iter; left time: 11410.2039s
	iters: 200, epoch: 15 | loss: 0.9774373
	speed: 0.2579s/iter; left time: 4561.1549s
Epoch: 15 cost time: 54.236611127853394
Epoch: 15, Steps: 208 | Train Loss: 1.133 Vali Loss: 5.820 Vali Acc: 0.078 Test Loss: 5.820 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.9416242
	speed: 0.6238s/iter; left time: 10967.8881s
	iters: 200, epoch: 16 | loss: 1.4938053
	speed: 0.2767s/iter; left time: 4837.3414s
Epoch: 16 cost time: 55.25960063934326
Epoch: 16, Steps: 208 | Train Loss: 0.940 Vali Loss: 6.127 Vali Acc: 0.076 Test Loss: 6.127 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3082584
	speed: 0.5853s/iter; left time: 10168.4915s
	iters: 200, epoch: 17 | loss: 1.0857095
	speed: 0.2683s/iter; left time: 4633.5285s
Epoch: 17 cost time: 55.12048149108887
Epoch: 17, Steps: 208 | Train Loss: 0.818 Vali Loss: 6.825 Vali Acc: 0.069 Test Loss: 6.825 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6094765
	speed: 0.6240s/iter; left time: 10710.7847s
	iters: 200, epoch: 18 | loss: 1.1505336
	speed: 0.2599s/iter; left time: 4434.8281s
Epoch: 18 cost time: 56.25259280204773
Epoch: 18, Steps: 208 | Train Loss: 0.736 Vali Loss: 6.944 Vali Acc: 0.076 Test Loss: 6.944 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5469832
	speed: 0.6198s/iter; left time: 10509.5907s
	iters: 200, epoch: 19 | loss: 0.2557493
	speed: 0.2595s/iter; left time: 4374.1205s
Epoch: 19 cost time: 54.74702525138855
Epoch: 19, Steps: 208 | Train Loss: 0.632 Vali Loss: 7.304 Vali Acc: 0.078 Test Loss: 7.304 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2210319
	speed: 0.6020s/iter; left time: 10083.7094s
	iters: 200, epoch: 20 | loss: 1.7276576
	speed: 0.2568s/iter; left time: 4275.8604s
Epoch: 20 cost time: 51.16395688056946
Epoch: 20, Steps: 208 | Train Loss: 0.598 Vali Loss: 7.507 Vali Acc: 0.072 Test Loss: 7.507 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.7459817
	speed: 0.6406s/iter; left time: 10595.5169s
	iters: 200, epoch: 21 | loss: 0.1789508
	speed: 0.2926s/iter; left time: 4811.0714s
Epoch: 21 cost time: 58.999253273010254
Epoch: 21, Steps: 208 | Train Loss: 0.560 Vali Loss: 7.677 Vali Acc: 0.071 Test Loss: 7.677 Test Acc: 0.071
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3778367
	speed: 0.6260s/iter; left time: 10224.3443s
	iters: 200, epoch: 22 | loss: 0.4026610
	speed: 0.2668s/iter; left time: 4331.0563s
Epoch: 22 cost time: 56.32083296775818
Epoch: 22, Steps: 208 | Train Loss: 0.502 Vali Loss: 7.986 Vali Acc: 0.072 Test Loss: 7.986 Test Acc: 0.072
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3696094
	speed: 0.6464s/iter; left time: 10423.6969s
	iters: 200, epoch: 23 | loss: 0.1825420
	speed: 0.2572s/iter; left time: 4122.3472s
Epoch: 23 cost time: 55.69668650627136
Epoch: 23, Steps: 208 | Train Loss: 0.461 Vali Loss: 8.294 Vali Acc: 0.070 Test Loss: 8.294 Test Acc: 0.070
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4141152
	speed: 0.6628s/iter; left time: 10550.1635s
	iters: 200, epoch: 24 | loss: 0.7458849
	speed: 0.2927s/iter; left time: 4630.2495s
Epoch: 24 cost time: 60.13042640686035
Epoch: 24, Steps: 208 | Train Loss: 0.440 Vali Loss: 8.238 Vali Acc: 0.076 Test Loss: 8.238 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0787354607813898
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5621717
	speed: 0.3129s/iter; left time: 6477.8619s
	iters: 200, epoch: 1 | loss: 4.0072865
	speed: 0.2501s/iter; left time: 5153.2363s
Epoch: 1 cost time: 58.811851024627686
Epoch: 1, Steps: 208 | Train Loss: 3.847 Vali Loss: 5.555 Vali Acc: 0.036 Test Loss: 5.555 Test Acc: 0.036
Validation loss decreased (inf --> -0.036330).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4162769
	speed: 0.6323s/iter; left time: 12958.2820s
	iters: 200, epoch: 2 | loss: 4.8273344
	speed: 0.2793s/iter; left time: 5694.8112s
Epoch: 2 cost time: 56.12671208381653
Epoch: 2, Steps: 208 | Train Loss: 3.750 Vali Loss: 6.536 Vali Acc: 0.041 Test Loss: 6.536 Test Acc: 0.041
Validation loss decreased (-0.036330 --> -0.040495).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9582965
	speed: 0.6457s/iter; left time: 13098.9360s
	iters: 200, epoch: 3 | loss: 4.6324625
	speed: 0.2853s/iter; left time: 5757.9803s
Epoch: 3 cost time: 58.81797742843628
Epoch: 3, Steps: 208 | Train Loss: 3.657 Vali Loss: 6.735 Vali Acc: 0.055 Test Loss: 6.735 Test Acc: 0.055
Validation loss decreased (-0.040495 --> -0.055107).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7779009
	speed: 0.6218s/iter; left time: 12483.7635s
	iters: 200, epoch: 4 | loss: 4.0812573
	speed: 0.2627s/iter; left time: 5248.0405s
Epoch: 4 cost time: 55.77935481071472
Epoch: 4, Steps: 208 | Train Loss: 3.504 Vali Loss: 5.796 Vali Acc: 0.052 Test Loss: 5.796 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1882722
	speed: 0.6277s/iter; left time: 12471.9030s
	iters: 200, epoch: 5 | loss: 3.8750443
	speed: 0.2767s/iter; left time: 5470.1394s
Epoch: 5 cost time: 58.06678533554077
Epoch: 5, Steps: 208 | Train Loss: 2.910 Vali Loss: 5.216 Vali Acc: 0.058 Test Loss: 5.216 Test Acc: 0.058
Validation loss decreased (-0.055107 --> -0.058403).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0956359
	speed: 0.5900s/iter; left time: 11599.2521s
	iters: 200, epoch: 6 | loss: 3.3034182
	speed: 0.2546s/iter; left time: 4979.4163s
Epoch: 6 cost time: 52.27839517593384
Epoch: 6, Steps: 208 | Train Loss: 2.622 Vali Loss: 5.055 Vali Acc: 0.062 Test Loss: 5.055 Test Acc: 0.062
Validation loss decreased (-0.058403 --> -0.062282).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8880811
	speed: 0.6241s/iter; left time: 12140.7294s
	iters: 200, epoch: 7 | loss: 2.3882039
	speed: 0.2810s/iter; left time: 5439.0174s
Epoch: 7 cost time: 58.17791938781738
Epoch: 7, Steps: 208 | Train Loss: 2.274 Vali Loss: 5.175 Vali Acc: 0.072 Test Loss: 5.175 Test Acc: 0.072
Validation loss decreased (-0.062282 --> -0.072421).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7245593
	speed: 0.5752s/iter; left time: 11069.4475s
	iters: 200, epoch: 8 | loss: 2.3162293
	speed: 0.2349s/iter; left time: 4497.8347s
Epoch: 8 cost time: 49.15022921562195
Epoch: 8, Steps: 208 | Train Loss: 1.817 Vali Loss: 5.424 Vali Acc: 0.068 Test Loss: 5.424 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5924100
	speed: 0.6142s/iter; left time: 11691.9025s
	iters: 200, epoch: 9 | loss: 1.3742019
	speed: 0.2629s/iter; left time: 4978.4799s
Epoch: 9 cost time: 57.24755620956421
Epoch: 9, Steps: 208 | Train Loss: 1.438 Vali Loss: 5.893 Vali Acc: 0.068 Test Loss: 5.893 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3606235
	speed: 0.6126s/iter; left time: 11534.2942s
	iters: 200, epoch: 10 | loss: 1.3520100
	speed: 0.2721s/iter; left time: 5095.9762s
Epoch: 10 cost time: 54.6557731628418
Epoch: 10, Steps: 208 | Train Loss: 1.220 Vali Loss: 6.463 Vali Acc: 0.070 Test Loss: 6.463 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5365967
	speed: 0.6221s/iter; left time: 11584.1813s
	iters: 200, epoch: 11 | loss: 1.0857627
	speed: 0.2638s/iter; left time: 4885.6929s
Epoch: 11 cost time: 54.41823482513428
Epoch: 11, Steps: 208 | Train Loss: 1.045 Vali Loss: 6.699 Vali Acc: 0.073 Test Loss: 6.699 Test Acc: 0.073
Validation loss decreased (-0.072421 --> -0.073300).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0869873
	speed: 0.5754s/iter; left time: 10594.1117s
	iters: 200, epoch: 12 | loss: 1.2349175
	speed: 0.2524s/iter; left time: 4622.5332s
Epoch: 12 cost time: 52.3407084941864
Epoch: 12, Steps: 208 | Train Loss: 0.960 Vali Loss: 7.199 Vali Acc: 0.081 Test Loss: 7.199 Test Acc: 0.081
Validation loss decreased (-0.073300 --> -0.080751).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6827471
	speed: 0.6444s/iter; left time: 11731.5303s
	iters: 200, epoch: 13 | loss: 0.9727740
	speed: 0.2838s/iter; left time: 5137.5109s
Epoch: 13 cost time: 59.28484010696411
Epoch: 13, Steps: 208 | Train Loss: 0.827 Vali Loss: 7.601 Vali Acc: 0.076 Test Loss: 7.601 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6578178
	speed: 0.6195s/iter; left time: 11148.9906s
	iters: 200, epoch: 14 | loss: 0.8622803
	speed: 0.2695s/iter; left time: 4823.8232s
Epoch: 14 cost time: 55.37225079536438
Epoch: 14, Steps: 208 | Train Loss: 0.743 Vali Loss: 7.914 Vali Acc: 0.069 Test Loss: 7.914 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9434952
	speed: 0.5927s/iter; left time: 10543.0975s
	iters: 200, epoch: 15 | loss: 0.5026530
	speed: 0.2631s/iter; left time: 4654.1375s
Epoch: 15 cost time: 53.6526894569397
Epoch: 15, Steps: 208 | Train Loss: 0.709 Vali Loss: 7.981 Vali Acc: 0.070 Test Loss: 7.981 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1824768
	speed: 0.5994s/iter; left time: 10538.2088s
	iters: 200, epoch: 16 | loss: 1.1026889
	speed: 0.2716s/iter; left time: 4747.0946s
Epoch: 16 cost time: 55.685734272003174
Epoch: 16, Steps: 208 | Train Loss: 0.626 Vali Loss: 8.252 Vali Acc: 0.082 Test Loss: 8.252 Test Acc: 0.082
Validation loss decreased (-0.080751 --> -0.082232).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3695488
	speed: 0.6435s/iter; left time: 11179.9714s
	iters: 200, epoch: 17 | loss: 0.5214868
	speed: 0.2743s/iter; left time: 4737.2786s
Epoch: 17 cost time: 58.25665211677551
Epoch: 17, Steps: 208 | Train Loss: 0.544 Vali Loss: 9.006 Vali Acc: 0.073 Test Loss: 9.006 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5356753
	speed: 0.6059s/iter; left time: 10399.9367s
	iters: 200, epoch: 18 | loss: 0.7142377
	speed: 0.2789s/iter; left time: 4760.0214s
Epoch: 18 cost time: 56.69879984855652
Epoch: 18, Steps: 208 | Train Loss: 0.542 Vali Loss: 8.733 Vali Acc: 0.070 Test Loss: 8.733 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2816903
	speed: 0.6406s/iter; left time: 10863.0856s
	iters: 200, epoch: 19 | loss: 0.4858210
	speed: 0.2664s/iter; left time: 4489.9151s
Epoch: 19 cost time: 56.73336958885193
Epoch: 19, Steps: 208 | Train Loss: 0.519 Vali Loss: 9.108 Vali Acc: 0.067 Test Loss: 9.108 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1725838
	speed: 0.6287s/iter; left time: 10530.4512s
	iters: 200, epoch: 20 | loss: 0.9100093
	speed: 0.2780s/iter; left time: 4629.1172s
Epoch: 20 cost time: 58.830326080322266
Epoch: 20, Steps: 208 | Train Loss: 0.441 Vali Loss: 9.628 Vali Acc: 0.073 Test Loss: 9.628 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3972837
	speed: 0.6257s/iter; left time: 10349.9919s
	iters: 200, epoch: 21 | loss: 0.1103695
	speed: 0.2631s/iter; left time: 4326.1828s
Epoch: 21 cost time: 54.88717293739319
Epoch: 21, Steps: 208 | Train Loss: 0.421 Vali Loss: 9.669 Vali Acc: 0.073 Test Loss: 9.669 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.5629855
	speed: 0.5773s/iter; left time: 9428.5936s
	iters: 200, epoch: 22 | loss: 0.4381835
	speed: 0.2406s/iter; left time: 3905.0063s
Epoch: 22 cost time: 51.241657733917236
Epoch: 22, Steps: 208 | Train Loss: 0.402 Vali Loss: 9.624 Vali Acc: 0.078 Test Loss: 9.624 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.8434945
	speed: 0.6510s/iter; left time: 10496.8000s
	iters: 200, epoch: 23 | loss: 0.0790029
	speed: 0.2553s/iter; left time: 4091.2140s
Epoch: 23 cost time: 56.75544309616089
Epoch: 23, Steps: 208 | Train Loss: 0.406 Vali Loss: 10.076 Vali Acc: 0.077 Test Loss: 10.076 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.5699817
	speed: 0.6145s/iter; left time: 9780.2704s
	iters: 200, epoch: 24 | loss: 0.0311320
	speed: 0.2624s/iter; left time: 4150.5016s
Epoch: 24 cost time: 54.4206383228302
Epoch: 24, Steps: 208 | Train Loss: 0.348 Vali Loss: 10.062 Vali Acc: 0.079 Test Loss: 10.062 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1119036
	speed: 0.6151s/iter; left time: 9662.5429s
	iters: 200, epoch: 25 | loss: 0.0317108
	speed: 0.2212s/iter; left time: 3452.9922s
Epoch: 25 cost time: 49.28190612792969
Epoch: 25, Steps: 208 | Train Loss: 0.333 Vali Loss: 10.248 Vali Acc: 0.078 Test Loss: 10.248 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0724069
	speed: 0.6348s/iter; left time: 9840.4407s
	iters: 200, epoch: 26 | loss: 0.8516924
	speed: 0.2808s/iter; left time: 4324.9588s
Epoch: 26 cost time: 58.68316960334778
Epoch: 26, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.748 Vali Acc: 0.077 Test Loss: 10.748 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08231434536236207
model parameter : 6381863
model size : 34.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6475575
	speed: 0.2494s/iter; left time: 5163.5543s
	iters: 200, epoch: 1 | loss: 4.8399677
	speed: 0.2559s/iter; left time: 5272.6201s
Epoch: 1 cost time: 52.90706157684326
Epoch: 1, Steps: 208 | Train Loss: 4.204 Vali Loss: 4.323 Vali Acc: 0.071 Test Loss: 4.323 Test Acc: 0.071
Validation loss decreased (inf --> -0.070938).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6154675
	speed: 0.6418s/iter; left time: 13152.8884s
	iters: 200, epoch: 2 | loss: 3.2922866
	speed: 0.2672s/iter; left time: 5449.7616s
Epoch: 2 cost time: 55.97013187408447
Epoch: 2, Steps: 208 | Train Loss: 3.444 Vali Loss: 4.179 Vali Acc: 0.087 Test Loss: 4.179 Test Acc: 0.087
Validation loss decreased (-0.070938 --> -0.087044).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1544733
	speed: 0.6331s/iter; left time: 12843.1185s
	iters: 200, epoch: 3 | loss: 3.0880809
	speed: 0.2547s/iter; left time: 5141.7666s
Epoch: 3 cost time: 55.296018838882446
Epoch: 3, Steps: 208 | Train Loss: 2.748 Vali Loss: 4.656 Vali Acc: 0.078 Test Loss: 4.656 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.7282581
	speed: 0.6589s/iter; left time: 13229.1292s
	iters: 200, epoch: 4 | loss: 3.3494115
	speed: 0.2837s/iter; left time: 5668.0921s
Epoch: 4 cost time: 59.717843770980835
Epoch: 4, Steps: 208 | Train Loss: 2.060 Vali Loss: 5.501 Vali Acc: 0.082 Test Loss: 5.501 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6171653
	speed: 0.6155s/iter; left time: 12230.2980s
	iters: 200, epoch: 5 | loss: 1.7827723
	speed: 0.2563s/iter; left time: 5066.3709s
Epoch: 5 cost time: 53.00852632522583
Epoch: 5, Steps: 208 | Train Loss: 1.559 Vali Loss: 6.424 Vali Acc: 0.078 Test Loss: 6.424 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9032407
	speed: 0.6604s/iter; left time: 12984.3836s
	iters: 200, epoch: 6 | loss: 1.8084543
	speed: 0.2673s/iter; left time: 5229.1306s
Epoch: 6 cost time: 57.562411308288574
Epoch: 6, Steps: 208 | Train Loss: 1.356 Vali Loss: 7.174 Vali Acc: 0.081 Test Loss: 7.174 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.8151249
	speed: 0.6035s/iter; left time: 11739.6976s
	iters: 200, epoch: 7 | loss: 2.5890517
	speed: 0.2777s/iter; left time: 5374.6880s
Epoch: 7 cost time: 56.11074185371399
Epoch: 7, Steps: 208 | Train Loss: 1.042 Vali Loss: 7.275 Vali Acc: 0.086 Test Loss: 7.275 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.9536107
	speed: 0.6687s/iter; left time: 12869.9762s
	iters: 200, epoch: 8 | loss: 1.8662294
	speed: 0.2501s/iter; left time: 4787.8270s
Epoch: 8 cost time: 54.63379192352295
Epoch: 8, Steps: 208 | Train Loss: 0.864 Vali Loss: 8.777 Vali Acc: 0.078 Test Loss: 8.777 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.5145473
	speed: 0.5746s/iter; left time: 10938.3505s
	iters: 200, epoch: 9 | loss: 0.8007394
	speed: 0.2724s/iter; left time: 5158.3867s
Epoch: 9 cost time: 55.03637337684631
Epoch: 9, Steps: 208 | Train Loss: 0.758 Vali Loss: 9.787 Vali Acc: 0.070 Test Loss: 9.787 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5767123
	speed: 0.6413s/iter; left time: 12075.7260s
	iters: 200, epoch: 10 | loss: 0.5567028
	speed: 0.2531s/iter; left time: 4740.4194s
Epoch: 10 cost time: 54.528348207473755
Epoch: 10, Steps: 208 | Train Loss: 0.658 Vali Loss: 9.676 Vali Acc: 0.084 Test Loss: 9.676 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.9511687
	speed: 0.6195s/iter; left time: 11536.1270s
	iters: 200, epoch: 11 | loss: 0.6069042
	speed: 0.2558s/iter; left time: 4738.2484s
Epoch: 11 cost time: 54.90424346923828
Epoch: 11, Steps: 208 | Train Loss: 0.609 Vali Loss: 9.862 Vali Acc: 0.074 Test Loss: 9.862 Test Acc: 0.074
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6475201
	speed: 0.6505s/iter; left time: 11976.8026s
	iters: 200, epoch: 12 | loss: 0.7079006
	speed: 0.2324s/iter; left time: 4256.3710s
Epoch: 12 cost time: 51.75835132598877
Epoch: 12, Steps: 208 | Train Loss: 0.489 Vali Loss: 10.890 Vali Acc: 0.078 Test Loss: 10.890 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08708619147032508
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8638177
	speed: 0.3121s/iter; left time: 6460.2817s
	iters: 200, epoch: 1 | loss: 5.1746106
	speed: 0.2796s/iter; left time: 5760.1938s
Epoch: 1 cost time: 61.58245062828064
Epoch: 1, Steps: 208 | Train Loss: 4.198 Vali Loss: 4.372 Vali Acc: 0.070 Test Loss: 4.372 Test Acc: 0.070
Validation loss decreased (inf --> -0.070043).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5387981
	speed: 0.6181s/iter; left time: 12666.1367s
	iters: 200, epoch: 2 | loss: 3.3837047
	speed: 0.2984s/iter; left time: 6085.0274s
Epoch: 2 cost time: 60.01684331893921
Epoch: 2, Steps: 208 | Train Loss: 3.429 Vali Loss: 4.198 Vali Acc: 0.074 Test Loss: 4.198 Test Acc: 0.074
Validation loss decreased (-0.070043 --> -0.073623).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6753266
	speed: 0.6703s/iter; left time: 13596.1158s
	iters: 200, epoch: 3 | loss: 2.5352495
	speed: 0.2799s/iter; left time: 5648.7994s
Epoch: 3 cost time: 60.28557562828064
Epoch: 3, Steps: 208 | Train Loss: 2.722 Vali Loss: 4.681 Vali Acc: 0.072 Test Loss: 4.681 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2313523
	speed: 0.6788s/iter; left time: 13628.7072s
	iters: 200, epoch: 4 | loss: 2.7649124
	speed: 0.2905s/iter; left time: 5803.4134s
Epoch: 4 cost time: 60.895745277404785
Epoch: 4, Steps: 208 | Train Loss: 2.045 Vali Loss: 5.450 Vali Acc: 0.086 Test Loss: 5.450 Test Acc: 0.086
Validation loss decreased (-0.073623 --> -0.085839).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0133494
	speed: 0.6469s/iter; left time: 12853.3762s
	iters: 200, epoch: 5 | loss: 2.7186289
	speed: 0.2823s/iter; left time: 5580.7880s
Epoch: 5 cost time: 58.653470039367676
Epoch: 5, Steps: 208 | Train Loss: 1.548 Vali Loss: 6.259 Vali Acc: 0.075 Test Loss: 6.259 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8732190
	speed: 0.6376s/iter; left time: 12535.6937s
	iters: 200, epoch: 6 | loss: 2.3412511
	speed: 0.2809s/iter; left time: 5494.0332s
Epoch: 6 cost time: 57.81777763366699
Epoch: 6, Steps: 208 | Train Loss: 1.274 Vali Loss: 7.407 Vali Acc: 0.081 Test Loss: 7.407 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5451564
	speed: 0.6580s/iter; left time: 12800.7595s
	iters: 200, epoch: 7 | loss: 2.0266852
	speed: 0.2844s/iter; left time: 5503.0989s
Epoch: 7 cost time: 58.78685426712036
Epoch: 7, Steps: 208 | Train Loss: 1.036 Vali Loss: 7.534 Vali Acc: 0.090 Test Loss: 7.534 Test Acc: 0.090
Validation loss decreased (-0.085839 --> -0.089695).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3864485
	speed: 0.6837s/iter; left time: 13158.6991s
	iters: 200, epoch: 8 | loss: 1.4008985
	speed: 0.2915s/iter; left time: 5580.9465s
Epoch: 8 cost time: 60.919962644577026
Epoch: 8, Steps: 208 | Train Loss: 0.881 Vali Loss: 8.276 Vali Acc: 0.069 Test Loss: 8.276 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2900323
	speed: 0.6376s/iter; left time: 12138.9157s
	iters: 200, epoch: 9 | loss: 0.3146785
	speed: 0.2825s/iter; left time: 5350.5947s
Epoch: 9 cost time: 58.11360740661621
Epoch: 9, Steps: 208 | Train Loss: 0.740 Vali Loss: 9.154 Vali Acc: 0.070 Test Loss: 9.154 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1277405
	speed: 0.5994s/iter; left time: 11285.4673s
	iters: 200, epoch: 10 | loss: 1.3727969
	speed: 0.2760s/iter; left time: 5168.6133s
Epoch: 10 cost time: 55.218719244003296
Epoch: 10, Steps: 208 | Train Loss: 0.670 Vali Loss: 9.359 Vali Acc: 0.081 Test Loss: 9.359 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1758216
	speed: 0.6974s/iter; left time: 12985.3604s
	iters: 200, epoch: 11 | loss: 0.3281990
	speed: 0.2882s/iter; left time: 5338.1042s
Epoch: 11 cost time: 61.81222414970398
Epoch: 11, Steps: 208 | Train Loss: 0.575 Vali Loss: 10.107 Vali Acc: 0.083 Test Loss: 10.107 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.8195010
	speed: 0.6354s/iter; left time: 11698.9185s
	iters: 200, epoch: 12 | loss: 1.3955917
	speed: 0.2923s/iter; left time: 5353.7591s
Epoch: 12 cost time: 59.89176654815674
Epoch: 12, Steps: 208 | Train Loss: 0.476 Vali Loss: 10.726 Vali Acc: 0.086 Test Loss: 10.726 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0490552
	speed: 0.6598s/iter; left time: 12011.1367s
	iters: 200, epoch: 13 | loss: 0.3479424
	speed: 0.2942s/iter; left time: 5325.8383s
Epoch: 13 cost time: 60.84622526168823
Epoch: 13, Steps: 208 | Train Loss: 0.442 Vali Loss: 10.101 Vali Acc: 0.076 Test Loss: 10.101 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2163249
	speed: 0.6559s/iter; left time: 11804.7362s
	iters: 200, epoch: 14 | loss: 1.5419521
	speed: 0.2822s/iter; left time: 5051.3628s
Epoch: 14 cost time: 58.18293237686157
Epoch: 14, Steps: 208 | Train Loss: 0.477 Vali Loss: 10.494 Vali Acc: 0.083 Test Loss: 10.494 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.4208089
	speed: 0.6813s/iter; left time: 12119.9720s
	iters: 200, epoch: 15 | loss: 1.9674429
	speed: 0.2796s/iter; left time: 4945.5853s
Epoch: 15 cost time: 59.49687218666077
Epoch: 15, Steps: 208 | Train Loss: 0.432 Vali Loss: 10.970 Vali Acc: 0.086 Test Loss: 10.970 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0678275
	speed: 0.6215s/iter; left time: 10926.0833s
	iters: 200, epoch: 16 | loss: 1.3563904
	speed: 0.2889s/iter; left time: 5050.7296s
Epoch: 16 cost time: 57.940189361572266
Epoch: 16, Steps: 208 | Train Loss: 0.399 Vali Loss: 11.226 Vali Acc: 0.084 Test Loss: 11.226 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.2643964
	speed: 0.6823s/iter; left time: 11853.2011s
	iters: 200, epoch: 17 | loss: 0.7415240
	speed: 0.2797s/iter; left time: 4831.6171s
Epoch: 17 cost time: 60.07643961906433
Epoch: 17, Steps: 208 | Train Loss: 0.365 Vali Loss: 12.151 Vali Acc: 0.083 Test Loss: 12.151 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08977035490605428
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8091302
	speed: 0.2684s/iter; left time: 5555.4330s
	iters: 200, epoch: 1 | loss: 4.8278708
	speed: 0.2562s/iter; left time: 5277.6650s
Epoch: 1 cost time: 54.42378616333008
Epoch: 1, Steps: 208 | Train Loss: 4.176 Vali Loss: 4.351 Vali Acc: 0.071 Test Loss: 4.351 Test Acc: 0.071
Validation loss decreased (inf --> -0.070938).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9090364
	speed: 0.6464s/iter; left time: 13246.3406s
	iters: 200, epoch: 2 | loss: 3.6487739
	speed: 0.2665s/iter; left time: 5435.1091s
Epoch: 2 cost time: 58.034969091415405
Epoch: 2, Steps: 208 | Train Loss: 3.488 Vali Loss: 4.358 Vali Acc: 0.083 Test Loss: 4.358 Test Acc: 0.083
Validation loss decreased (-0.070938 --> -0.082867).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0948906
	speed: 0.6281s/iter; left time: 12741.2723s
	iters: 200, epoch: 3 | loss: 2.4908676
	speed: 0.2895s/iter; left time: 5843.9337s
Epoch: 3 cost time: 59.389243841171265
Epoch: 3, Steps: 208 | Train Loss: 2.795 Vali Loss: 4.732 Vali Acc: 0.082 Test Loss: 4.732 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3901548
	speed: 0.6789s/iter; left time: 13631.2424s
	iters: 200, epoch: 4 | loss: 2.7611365
	speed: 0.2526s/iter; left time: 5046.6742s
Epoch: 4 cost time: 55.963836431503296
Epoch: 4, Steps: 208 | Train Loss: 2.110 Vali Loss: 5.694 Vali Acc: 0.086 Test Loss: 5.694 Test Acc: 0.086
Validation loss decreased (-0.082867 --> -0.085836).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9932864
	speed: 0.6272s/iter; left time: 12460.9085s
	iters: 200, epoch: 5 | loss: 2.6789713
	speed: 0.2622s/iter; left time: 5182.6962s
Epoch: 5 cost time: 55.8066086769104
Epoch: 5, Steps: 208 | Train Loss: 1.596 Vali Loss: 6.387 Vali Acc: 0.075 Test Loss: 6.387 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1788361
	speed: 0.6085s/iter; left time: 11963.7967s
	iters: 200, epoch: 6 | loss: 1.8061759
	speed: 0.2937s/iter; left time: 5745.3324s
Epoch: 6 cost time: 58.235716581344604
Epoch: 6, Steps: 208 | Train Loss: 1.313 Vali Loss: 7.212 Vali Acc: 0.073 Test Loss: 7.212 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0176716
	speed: 0.6502s/iter; left time: 12647.6825s
	iters: 200, epoch: 7 | loss: 3.2140973
	speed: 0.2754s/iter; left time: 5329.1667s
Epoch: 7 cost time: 56.82004404067993
Epoch: 7, Steps: 208 | Train Loss: 1.115 Vali Loss: 7.116 Vali Acc: 0.069 Test Loss: 7.116 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.7996753
	speed: 0.6621s/iter; left time: 12742.6110s
	iters: 200, epoch: 8 | loss: 1.1186348
	speed: 0.2466s/iter; left time: 4720.9904s
Epoch: 8 cost time: 55.46602964401245
Epoch: 8, Steps: 208 | Train Loss: 0.896 Vali Loss: 8.460 Vali Acc: 0.064 Test Loss: 8.460 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4679115
	speed: 0.6146s/iter; left time: 11700.6479s
	iters: 200, epoch: 9 | loss: 0.5627241
	speed: 0.2685s/iter; left time: 5084.9910s
Epoch: 9 cost time: 57.011712074279785
Epoch: 9, Steps: 208 | Train Loss: 0.748 Vali Loss: 9.209 Vali Acc: 0.064 Test Loss: 9.209 Test Acc: 0.064
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2930796
	speed: 0.6507s/iter; left time: 12251.9881s
	iters: 200, epoch: 10 | loss: 0.7444891
	speed: 0.2757s/iter; left time: 5162.7842s
Epoch: 10 cost time: 56.49499273300171
Epoch: 10, Steps: 208 | Train Loss: 0.681 Vali Loss: 9.766 Vali Acc: 0.075 Test Loss: 9.766 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.2658931
	speed: 0.6558s/iter; left time: 12212.5776s
	iters: 200, epoch: 11 | loss: 0.6603568
	speed: 0.2774s/iter; left time: 5137.2064s
Epoch: 11 cost time: 59.10018754005432
Epoch: 11, Steps: 208 | Train Loss: 0.560 Vali Loss: 9.890 Vali Acc: 0.070 Test Loss: 9.890 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2420099
	speed: 0.6358s/iter; left time: 11706.9665s
	iters: 200, epoch: 12 | loss: 0.5085628
	speed: 0.2727s/iter; left time: 4993.1854s
Epoch: 12 cost time: 56.24933338165283
Epoch: 12, Steps: 208 | Train Loss: 0.551 Vali Loss: 10.667 Vali Acc: 0.069 Test Loss: 10.667 Test Acc: 0.069
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0745682
	speed: 0.6701s/iter; left time: 12199.7811s
	iters: 200, epoch: 13 | loss: 0.9671100
	speed: 0.2737s/iter; left time: 4955.8595s
Epoch: 13 cost time: 59.79697108268738
Epoch: 13, Steps: 208 | Train Loss: 0.519 Vali Loss: 11.258 Vali Acc: 0.071 Test Loss: 11.258 Test Acc: 0.071
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.3058745
	speed: 0.6801s/iter; left time: 12239.9446s
	iters: 200, epoch: 14 | loss: 1.1283140
	speed: 0.2708s/iter; left time: 4845.8920s
Epoch: 14 cost time: 59.06272339820862
Epoch: 14, Steps: 208 | Train Loss: 0.488 Vali Loss: 10.997 Vali Acc: 0.073 Test Loss: 10.997 Test Acc: 0.073
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08589322994333433
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7764392
	speed: 0.2970s/iter; left time: 6148.8676s
	iters: 200, epoch: 1 | loss: 4.7796097
	speed: 0.2828s/iter; left time: 5826.6763s
Epoch: 1 cost time: 60.33589816093445
Epoch: 1, Steps: 208 | Train Loss: 4.160 Vali Loss: 4.279 Vali Acc: 0.069 Test Loss: 4.279 Test Acc: 0.069
Validation loss decreased (inf --> -0.068553).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4982705
	speed: 0.6601s/iter; left time: 13527.2891s
	iters: 200, epoch: 2 | loss: 3.8450351
	speed: 0.2922s/iter; left time: 5958.8957s
Epoch: 2 cost time: 61.111170530319214
Epoch: 2, Steps: 208 | Train Loss: 3.458 Vali Loss: 4.272 Vali Acc: 0.084 Test Loss: 4.272 Test Acc: 0.084
Validation loss decreased (-0.068553 --> -0.083465).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8347864
	speed: 0.6703s/iter; left time: 13596.9010s
	iters: 200, epoch: 3 | loss: 2.7341144
	speed: 0.2934s/iter; left time: 5922.0695s
Epoch: 3 cost time: 61.883360147476196
Epoch: 3, Steps: 208 | Train Loss: 2.720 Vali Loss: 4.616 Vali Acc: 0.078 Test Loss: 4.616 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1548073
	speed: 0.6744s/iter; left time: 13540.4570s
	iters: 200, epoch: 4 | loss: 2.2732215
	speed: 0.2989s/iter; left time: 5972.0481s
Epoch: 4 cost time: 62.60795307159424
Epoch: 4, Steps: 208 | Train Loss: 2.064 Vali Loss: 5.340 Vali Acc: 0.087 Test Loss: 5.340 Test Acc: 0.087
Validation loss decreased (-0.083465 --> -0.086735).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8344662
	speed: 0.6772s/iter; left time: 13454.3963s
	iters: 200, epoch: 5 | loss: 2.3587706
	speed: 0.3029s/iter; left time: 5988.2511s
Epoch: 5 cost time: 62.60459327697754
Epoch: 5, Steps: 208 | Train Loss: 1.639 Vali Loss: 5.975 Vali Acc: 0.082 Test Loss: 5.975 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8039018
	speed: 0.6699s/iter; left time: 13171.7515s
	iters: 200, epoch: 6 | loss: 2.2079635
	speed: 0.2913s/iter; left time: 5698.8331s
Epoch: 6 cost time: 61.31172585487366
Epoch: 6, Steps: 208 | Train Loss: 1.304 Vali Loss: 7.621 Vali Acc: 0.079 Test Loss: 7.621 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8890667
	speed: 0.6438s/iter; left time: 12523.8148s
	iters: 200, epoch: 7 | loss: 2.8676863
	speed: 0.2896s/iter; left time: 5604.9539s
Epoch: 7 cost time: 60.42595458030701
Epoch: 7, Steps: 208 | Train Loss: 1.105 Vali Loss: 7.612 Vali Acc: 0.075 Test Loss: 7.612 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0570326
	speed: 0.6548s/iter; left time: 12601.5573s
	iters: 200, epoch: 8 | loss: 1.2787979
	speed: 0.2913s/iter; left time: 5577.6379s
Epoch: 8 cost time: 59.84682583808899
Epoch: 8, Steps: 208 | Train Loss: 0.944 Vali Loss: 7.784 Vali Acc: 0.070 Test Loss: 7.784 Test Acc: 0.070
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9635822
	speed: 0.6738s/iter; left time: 12826.5946s
	iters: 200, epoch: 9 | loss: 0.6244987
	speed: 0.2948s/iter; left time: 5581.9094s
Epoch: 9 cost time: 61.22518706321716
Epoch: 9, Steps: 208 | Train Loss: 0.803 Vali Loss: 8.922 Vali Acc: 0.083 Test Loss: 8.922 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3148800
	speed: 0.6384s/iter; left time: 12020.7263s
	iters: 200, epoch: 10 | loss: 1.1707493
	speed: 0.2892s/iter; left time: 5416.8212s
Epoch: 10 cost time: 58.54613757133484
Epoch: 10, Steps: 208 | Train Loss: 0.699 Vali Loss: 9.838 Vali Acc: 0.075 Test Loss: 9.838 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7415607
	speed: 0.6584s/iter; left time: 12259.6248s
	iters: 200, epoch: 11 | loss: 0.4955928
	speed: 0.2880s/iter; left time: 5333.6686s
Epoch: 11 cost time: 59.53493356704712
Epoch: 11, Steps: 208 | Train Loss: 0.606 Vali Loss: 9.134 Vali Acc: 0.082 Test Loss: 9.134 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0682390
	speed: 0.6675s/iter; left time: 12290.7821s
	iters: 200, epoch: 12 | loss: 0.8011146
	speed: 0.2717s/iter; left time: 4974.8409s
Epoch: 12 cost time: 57.28829050064087
Epoch: 12, Steps: 208 | Train Loss: 0.558 Vali Loss: 10.162 Vali Acc: 0.085 Test Loss: 10.162 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5199906
	speed: 0.6620s/iter; left time: 12051.9290s
	iters: 200, epoch: 13 | loss: 0.2543500
	speed: 0.2786s/iter; left time: 5043.3922s
Epoch: 13 cost time: 58.10852575302124
Epoch: 13, Steps: 208 | Train Loss: 0.467 Vali Loss: 10.581 Vali Acc: 0.077 Test Loss: 10.581 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0263654
	speed: 0.6641s/iter; left time: 11951.5483s
	iters: 200, epoch: 14 | loss: 0.6776935
	speed: 0.2654s/iter; left time: 4750.0890s
Epoch: 14 cost time: 57.11106634140015
Epoch: 14, Steps: 208 | Train Loss: 0.472 Vali Loss: 10.749 Vali Acc: 0.084 Test Loss: 10.749 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0867879510885774
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9254000
	speed: 0.3125s/iter; left time: 6468.6034s
	iters: 200, epoch: 1 | loss: 4.9071779
	speed: 0.2836s/iter; left time: 5842.9313s
Epoch: 1 cost time: 62.24705171585083
Epoch: 1, Steps: 208 | Train Loss: 4.102 Vali Loss: 4.997 Vali Acc: 0.055 Test Loss: 4.997 Test Acc: 0.055
Validation loss decreased (inf --> -0.054528).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1574833
	speed: 0.6499s/iter; left time: 13319.2709s
	iters: 200, epoch: 2 | loss: 3.5089474
	speed: 0.2652s/iter; left time: 5408.0989s
Epoch: 2 cost time: 55.20654559135437
Epoch: 2, Steps: 208 | Train Loss: 3.399 Vali Loss: 4.648 Vali Acc: 0.074 Test Loss: 4.648 Test Acc: 0.074
Validation loss decreased (-0.054528 --> -0.074215).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6654372
	speed: 0.6824s/iter; left time: 13842.0339s
	iters: 200, epoch: 3 | loss: 2.7154741
	speed: 0.2824s/iter; left time: 5700.1428s
Epoch: 3 cost time: 59.38518953323364
Epoch: 3, Steps: 208 | Train Loss: 2.737 Vali Loss: 5.104 Vali Acc: 0.074 Test Loss: 5.104 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6463327
	speed: 0.6725s/iter; left time: 13501.5376s
	iters: 200, epoch: 4 | loss: 2.8028376
	speed: 0.2853s/iter; left time: 5698.8172s
Epoch: 4 cost time: 58.24184250831604
Epoch: 4, Steps: 208 | Train Loss: 2.155 Vali Loss: 5.755 Vali Acc: 0.081 Test Loss: 5.755 Test Acc: 0.081
Validation loss decreased (-0.074215 --> -0.081064).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4999268
	speed: 0.6849s/iter; left time: 13607.5680s
	iters: 200, epoch: 5 | loss: 2.9649625
	speed: 0.2586s/iter; left time: 5112.9503s
Epoch: 5 cost time: 56.617554903030396
Epoch: 5, Steps: 208 | Train Loss: 1.701 Vali Loss: 6.599 Vali Acc: 0.070 Test Loss: 6.599 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2310348
	speed: 0.6643s/iter; left time: 13060.9896s
	iters: 200, epoch: 6 | loss: 1.3275805
	speed: 0.2800s/iter; left time: 5477.3116s
Epoch: 6 cost time: 58.48054552078247
Epoch: 6, Steps: 208 | Train Loss: 1.430 Vali Loss: 6.928 Vali Acc: 0.078 Test Loss: 6.928 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1852932
	speed: 0.6756s/iter; left time: 13141.7219s
	iters: 200, epoch: 7 | loss: 2.6381547
	speed: 0.2678s/iter; left time: 5182.6229s
Epoch: 7 cost time: 56.98578095436096
Epoch: 7, Steps: 208 | Train Loss: 1.259 Vali Loss: 7.248 Vali Acc: 0.078 Test Loss: 7.248 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3783183
	speed: 0.6662s/iter; left time: 12821.6599s
	iters: 200, epoch: 8 | loss: 1.0929387
	speed: 0.2627s/iter; left time: 5029.7216s
Epoch: 8 cost time: 58.17210006713867
Epoch: 8, Steps: 208 | Train Loss: 1.048 Vali Loss: 8.098 Vali Acc: 0.072 Test Loss: 8.098 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5687578
	speed: 0.6685s/iter; left time: 12726.2248s
	iters: 200, epoch: 9 | loss: 0.8663549
	speed: 0.2584s/iter; left time: 4893.0932s
Epoch: 9 cost time: 57.376718044281006
Epoch: 9, Steps: 208 | Train Loss: 0.951 Vali Loss: 8.601 Vali Acc: 0.078 Test Loss: 8.601 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6354012
	speed: 0.6529s/iter; left time: 12292.8077s
	iters: 200, epoch: 10 | loss: 1.2201440
	speed: 0.2870s/iter; left time: 5375.3037s
Epoch: 10 cost time: 60.04996633529663
Epoch: 10, Steps: 208 | Train Loss: 0.841 Vali Loss: 8.566 Vali Acc: 0.086 Test Loss: 8.566 Test Acc: 0.086
Validation loss decreased (-0.081064 --> -0.086404).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9485554
	speed: 0.6572s/iter; left time: 12238.2195s
	iters: 200, epoch: 11 | loss: 0.5631990
	speed: 0.2701s/iter; left time: 5001.9294s
Epoch: 11 cost time: 58.537068605422974
Epoch: 11, Steps: 208 | Train Loss: 0.733 Vali Loss: 9.022 Vali Acc: 0.079 Test Loss: 9.022 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7036276
	speed: 0.5923s/iter; left time: 10906.2643s
	iters: 200, epoch: 12 | loss: 0.4139071
	speed: 0.2640s/iter; left time: 4835.0234s
Epoch: 12 cost time: 54.23873996734619
Epoch: 12, Steps: 208 | Train Loss: 0.652 Vali Loss: 9.233 Vali Acc: 0.080 Test Loss: 9.233 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4368726
	speed: 0.6328s/iter; left time: 11519.6443s
	iters: 200, epoch: 13 | loss: 0.4167778
	speed: 0.2788s/iter; left time: 5047.3903s
Epoch: 13 cost time: 57.07324004173279
Epoch: 13, Steps: 208 | Train Loss: 0.562 Vali Loss: 9.792 Vali Acc: 0.078 Test Loss: 9.792 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4611790
	speed: 0.6244s/iter; left time: 11237.2900s
	iters: 200, epoch: 14 | loss: 1.7421050
	speed: 0.2561s/iter; left time: 4582.7384s
Epoch: 14 cost time: 53.89712142944336
Epoch: 14, Steps: 208 | Train Loss: 0.552 Vali Loss: 10.158 Vali Acc: 0.075 Test Loss: 10.158 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.4308824
	speed: 0.6318s/iter; left time: 11239.0110s
	iters: 200, epoch: 15 | loss: 2.3793063
	speed: 0.2563s/iter; left time: 4533.7844s
Epoch: 15 cost time: 52.7445125579834
Epoch: 15, Steps: 208 | Train Loss: 0.466 Vali Loss: 9.721 Vali Acc: 0.081 Test Loss: 9.721 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4090352
	speed: 0.6092s/iter; left time: 10710.4612s
	iters: 200, epoch: 16 | loss: 0.6016976
	speed: 0.2602s/iter; left time: 4548.0736s
Epoch: 16 cost time: 54.26124548912048
Epoch: 16, Steps: 208 | Train Loss: 0.401 Vali Loss: 10.301 Vali Acc: 0.081 Test Loss: 10.301 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2817142
	speed: 0.6251s/iter; left time: 10860.1284s
	iters: 200, epoch: 17 | loss: 1.1786841
	speed: 0.2747s/iter; left time: 4744.8786s
Epoch: 17 cost time: 57.09911346435547
Epoch: 17, Steps: 208 | Train Loss: 0.427 Vali Loss: 10.683 Vali Acc: 0.087 Test Loss: 10.683 Test Acc: 0.087
Validation loss decreased (-0.086404 --> -0.086681).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0292394
	speed: 0.6310s/iter; left time: 10831.4495s
	iters: 200, epoch: 18 | loss: 0.2093763
	speed: 0.2483s/iter; left time: 4237.1145s
Epoch: 18 cost time: 54.2349488735199
Epoch: 18, Steps: 208 | Train Loss: 0.430 Vali Loss: 10.532 Vali Acc: 0.085 Test Loss: 10.532 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0412288
	speed: 0.6363s/iter; left time: 10790.3145s
	iters: 200, epoch: 19 | loss: 0.4102372
	speed: 0.2532s/iter; left time: 4268.8592s
Epoch: 19 cost time: 54.69600248336792
Epoch: 19, Steps: 208 | Train Loss: 0.370 Vali Loss: 10.869 Vali Acc: 0.085 Test Loss: 10.869 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.8937151
	speed: 0.6100s/iter; left time: 10216.4089s
	iters: 200, epoch: 20 | loss: 0.5625339
	speed: 0.2694s/iter; left time: 4485.1921s
Epoch: 20 cost time: 53.84713888168335
Epoch: 20, Steps: 208 | Train Loss: 0.359 Vali Loss: 10.972 Vali Acc: 0.089 Test Loss: 10.972 Test Acc: 0.089
Validation loss decreased (-0.086681 --> -0.088766).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3009911
	speed: 0.6348s/iter; left time: 10499.8076s
	iters: 200, epoch: 21 | loss: 0.3474383
	speed: 0.2711s/iter; left time: 4457.2742s
Epoch: 21 cost time: 57.380250692367554
Epoch: 21, Steps: 208 | Train Loss: 0.326 Vali Loss: 11.480 Vali Acc: 0.091 Test Loss: 11.480 Test Acc: 0.091
Validation loss decreased (-0.088766 --> -0.090849).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5982141
	speed: 0.6557s/iter; left time: 10709.2810s
	iters: 200, epoch: 22 | loss: 0.4019130
	speed: 0.2703s/iter; left time: 4387.4640s
Epoch: 22 cost time: 57.62756872177124
Epoch: 22, Steps: 208 | Train Loss: 0.335 Vali Loss: 11.446 Vali Acc: 0.085 Test Loss: 11.446 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0082223
	speed: 0.6630s/iter; left time: 10691.3128s
	iters: 200, epoch: 23 | loss: 0.2954127
	speed: 0.2964s/iter; left time: 4749.1608s
Epoch: 23 cost time: 59.29690432548523
Epoch: 23, Steps: 208 | Train Loss: 0.332 Vali Loss: 11.403 Vali Acc: 0.078 Test Loss: 11.403 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.3992417
	speed: 0.6576s/iter; left time: 10467.2152s
	iters: 200, epoch: 24 | loss: 0.0550581
	speed: 0.2867s/iter; left time: 4535.5081s
Epoch: 24 cost time: 61.79327845573425
Epoch: 24, Steps: 208 | Train Loss: 0.287 Vali Loss: 11.840 Vali Acc: 0.081 Test Loss: 11.840 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0108559
	speed: 0.6754s/iter; left time: 10609.2963s
	iters: 200, epoch: 25 | loss: 0.2888088
	speed: 0.2762s/iter; left time: 4310.4539s
Epoch: 25 cost time: 60.13204026222229
Epoch: 25, Steps: 208 | Train Loss: 0.286 Vali Loss: 11.255 Vali Acc: 0.088 Test Loss: 11.255 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.7003677
	speed: 0.6661s/iter; left time: 10324.7060s
	iters: 200, epoch: 26 | loss: 0.4420260
	speed: 0.2825s/iter; left time: 4350.0626s
Epoch: 26 cost time: 59.20272922515869
Epoch: 26, Steps: 208 | Train Loss: 0.285 Vali Loss: 11.188 Vali Acc: 0.090 Test Loss: 11.188 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.4553922
	speed: 0.6469s/iter; left time: 9892.5847s
	iters: 200, epoch: 27 | loss: 0.6017378
	speed: 0.2861s/iter; left time: 4346.7204s
Epoch: 27 cost time: 60.21299767494202
Epoch: 27, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.739 Vali Acc: 0.081 Test Loss: 11.739 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0080037
	speed: 0.6609s/iter; left time: 9969.6191s
	iters: 200, epoch: 28 | loss: 0.2729019
	speed: 0.2638s/iter; left time: 3952.8503s
Epoch: 28 cost time: 57.58765983581543
Epoch: 28, Steps: 208 | Train Loss: 0.276 Vali Loss: 11.172 Vali Acc: 0.084 Test Loss: 11.172 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1182820
	speed: 0.6738s/iter; left time: 10023.9019s
	iters: 200, epoch: 29 | loss: 0.0117705
	speed: 0.2993s/iter; left time: 4422.4989s
Epoch: 29 cost time: 59.81125593185425
Epoch: 29, Steps: 208 | Train Loss: 0.261 Vali Loss: 11.544 Vali Acc: 0.082 Test Loss: 11.544 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0137406
	speed: 0.6310s/iter; left time: 9255.8310s
	iters: 200, epoch: 30 | loss: 0.3607245
	speed: 0.2827s/iter; left time: 4118.1297s
Epoch: 30 cost time: 58.40605306625366
Epoch: 30, Steps: 208 | Train Loss: 0.247 Vali Loss: 11.898 Vali Acc: 0.079 Test Loss: 11.898 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0041641
	speed: 0.6842s/iter; left time: 9893.6792s
	iters: 200, epoch: 31 | loss: 0.0402767
	speed: 0.2897s/iter; left time: 4159.9682s
Epoch: 31 cost time: 61.90098214149475
Epoch: 31, Steps: 208 | Train Loss: 0.219 Vali Loss: 11.887 Vali Acc: 0.088 Test Loss: 11.887 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09096331643304503
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8856034
	speed: 0.2785s/iter; left time: 5765.5351s
	iters: 200, epoch: 1 | loss: 5.6500912
	speed: 0.2659s/iter; left time: 5477.4031s
Epoch: 1 cost time: 56.825567960739136
Epoch: 1, Steps: 208 | Train Loss: 4.037 Vali Loss: 5.917 Vali Acc: 0.048 Test Loss: 5.917 Test Acc: 0.048
Validation loss decreased (inf --> -0.047958).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9413991
	speed: 0.6455s/iter; left time: 13227.3426s
	iters: 200, epoch: 2 | loss: 4.5994539
	speed: 0.2660s/iter; left time: 5424.9441s
Epoch: 2 cost time: 57.109636545181274
Epoch: 2, Steps: 208 | Train Loss: 3.533 Vali Loss: 5.681 Vali Acc: 0.076 Test Loss: 5.681 Test Acc: 0.076
Validation loss decreased (-0.047958 --> -0.076293).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4819784
	speed: 0.7024s/iter; left time: 14248.5542s
	iters: 200, epoch: 3 | loss: 3.1253290
	speed: 0.2725s/iter; left time: 5500.5499s
Epoch: 3 cost time: 60.36989998817444
Epoch: 3, Steps: 208 | Train Loss: 2.928 Vali Loss: 5.718 Vali Acc: 0.080 Test Loss: 5.718 Test Acc: 0.080
Validation loss decreased (-0.076293 --> -0.080169).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4111402
	speed: 0.6483s/iter; left time: 13016.0215s
	iters: 200, epoch: 4 | loss: 2.4051919
	speed: 0.2571s/iter; left time: 5135.6721s
Epoch: 4 cost time: 54.756073236465454
Epoch: 4, Steps: 208 | Train Loss: 2.386 Vali Loss: 5.925 Vali Acc: 0.083 Test Loss: 5.925 Test Acc: 0.083
Validation loss decreased (-0.080169 --> -0.083150).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9722849
	speed: 0.6653s/iter; left time: 13219.8115s
	iters: 200, epoch: 5 | loss: 2.2081375
	speed: 0.2569s/iter; left time: 5078.5629s
Epoch: 5 cost time: 55.876304388046265
Epoch: 5, Steps: 208 | Train Loss: 2.035 Vali Loss: 6.836 Vali Acc: 0.079 Test Loss: 6.836 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1925669
	speed: 0.6568s/iter; left time: 12913.3942s
	iters: 200, epoch: 6 | loss: 1.8610945
	speed: 0.2766s/iter; left time: 5410.6638s
Epoch: 6 cost time: 58.82681846618652
Epoch: 6, Steps: 208 | Train Loss: 1.765 Vali Loss: 6.328 Vali Acc: 0.078 Test Loss: 6.328 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3262353
	speed: 0.6538s/iter; left time: 12719.0876s
	iters: 200, epoch: 7 | loss: 2.3526688
	speed: 0.2728s/iter; left time: 5280.3627s
Epoch: 7 cost time: 57.29608702659607
Epoch: 7, Steps: 208 | Train Loss: 1.487 Vali Loss: 6.650 Vali Acc: 0.078 Test Loss: 6.650 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6050053
	speed: 0.6658s/iter; left time: 12814.2134s
	iters: 200, epoch: 8 | loss: 1.5899767
	speed: 0.2666s/iter; left time: 5103.1448s
Epoch: 8 cost time: 56.51411032676697
Epoch: 8, Steps: 208 | Train Loss: 1.318 Vali Loss: 7.251 Vali Acc: 0.085 Test Loss: 7.251 Test Acc: 0.085
Validation loss decreased (-0.083150 --> -0.084926).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9885664
	speed: 0.6371s/iter; left time: 12128.8605s
	iters: 200, epoch: 9 | loss: 1.6030461
	speed: 0.2664s/iter; left time: 5044.9783s
Epoch: 9 cost time: 56.132683992385864
Epoch: 9, Steps: 208 | Train Loss: 1.189 Vali Loss: 8.435 Vali Acc: 0.074 Test Loss: 8.435 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.7801375
	speed: 0.6517s/iter; left time: 12270.4122s
	iters: 200, epoch: 10 | loss: 1.6302323
	speed: 0.2748s/iter; left time: 5147.4019s
Epoch: 10 cost time: 58.22879219055176
Epoch: 10, Steps: 208 | Train Loss: 1.133 Vali Loss: 7.893 Vali Acc: 0.080 Test Loss: 7.893 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3707039
	speed: 0.6391s/iter; left time: 11901.4426s
	iters: 200, epoch: 11 | loss: 0.9210426
	speed: 0.2682s/iter; left time: 4967.2232s
Epoch: 11 cost time: 55.43315649032593
Epoch: 11, Steps: 208 | Train Loss: 0.953 Vali Loss: 7.928 Vali Acc: 0.086 Test Loss: 7.928 Test Acc: 0.086
Validation loss decreased (-0.084926 --> -0.085516).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1065241
	speed: 0.6579s/iter; left time: 12114.5450s
	iters: 200, epoch: 12 | loss: 0.6873130
	speed: 0.2764s/iter; left time: 5062.4891s
Epoch: 12 cost time: 58.42193055152893
Epoch: 12, Steps: 208 | Train Loss: 0.869 Vali Loss: 8.563 Vali Acc: 0.079 Test Loss: 8.563 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0089636
	speed: 0.6681s/iter; left time: 12162.6910s
	iters: 200, epoch: 13 | loss: 0.7148827
	speed: 0.2750s/iter; left time: 4979.3512s
Epoch: 13 cost time: 58.76259732246399
Epoch: 13, Steps: 208 | Train Loss: 0.785 Vali Loss: 8.112 Vali Acc: 0.074 Test Loss: 8.112 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7892160
	speed: 0.6702s/iter; left time: 12061.3676s
	iters: 200, epoch: 14 | loss: 1.5818428
	speed: 0.2690s/iter; left time: 4815.1319s
Epoch: 14 cost time: 57.313857316970825
Epoch: 14, Steps: 208 | Train Loss: 0.688 Vali Loss: 8.612 Vali Acc: 0.095 Test Loss: 8.612 Test Acc: 0.095
Validation loss decreased (-0.085516 --> -0.095351).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7652289
	speed: 0.6620s/iter; left time: 11775.9262s
	iters: 200, epoch: 15 | loss: 2.0372388
	speed: 0.2923s/iter; left time: 5170.2268s
Epoch: 15 cost time: 60.31037259101868
Epoch: 15, Steps: 208 | Train Loss: 0.653 Vali Loss: 8.487 Vali Acc: 0.081 Test Loss: 8.487 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6105220
	speed: 0.7032s/iter; left time: 12363.3999s
	iters: 200, epoch: 16 | loss: 1.2359115
	speed: 0.2915s/iter; left time: 5095.7246s
Epoch: 16 cost time: 62.122190713882446
Epoch: 16, Steps: 208 | Train Loss: 0.625 Vali Loss: 8.781 Vali Acc: 0.086 Test Loss: 8.781 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6181218
	speed: 0.6846s/iter; left time: 11892.7558s
	iters: 200, epoch: 17 | loss: 0.5608681
	speed: 0.2748s/iter; left time: 4746.5322s
Epoch: 17 cost time: 59.471580028533936
Epoch: 17, Steps: 208 | Train Loss: 0.504 Vali Loss: 8.747 Vali Acc: 0.080 Test Loss: 8.747 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0909174
	speed: 0.6416s/iter; left time: 11013.1569s
	iters: 200, epoch: 18 | loss: 0.3102075
	speed: 0.2629s/iter; left time: 4486.7917s
Epoch: 18 cost time: 55.39034175872803
Epoch: 18, Steps: 208 | Train Loss: 0.515 Vali Loss: 8.796 Vali Acc: 0.077 Test Loss: 8.796 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2153265
	speed: 0.6346s/iter; left time: 10761.2880s
	iters: 200, epoch: 19 | loss: 0.4905255
	speed: 0.2829s/iter; left time: 4769.6238s
Epoch: 19 cost time: 57.624486207962036
Epoch: 19, Steps: 208 | Train Loss: 0.427 Vali Loss: 9.170 Vali Acc: 0.088 Test Loss: 9.170 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2973166
	speed: 0.6536s/iter; left time: 10947.7595s
	iters: 200, epoch: 20 | loss: 0.4746167
	speed: 0.2627s/iter; left time: 4373.0055s
Epoch: 20 cost time: 55.823249101638794
Epoch: 20, Steps: 208 | Train Loss: 0.458 Vali Loss: 9.859 Vali Acc: 0.088 Test Loss: 9.859 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.7480925
	speed: 0.6522s/iter; left time: 10788.6509s
	iters: 200, epoch: 21 | loss: 0.5979527
	speed: 0.2775s/iter; left time: 4561.7434s
Epoch: 21 cost time: 58.67983961105347
Epoch: 21, Steps: 208 | Train Loss: 0.428 Vali Loss: 9.666 Vali Acc: 0.083 Test Loss: 9.666 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2368746
	speed: 0.6393s/iter; left time: 10441.9042s
	iters: 200, epoch: 22 | loss: 0.1106244
	speed: 0.2624s/iter; left time: 4259.5682s
Epoch: 22 cost time: 54.95388412475586
Epoch: 22, Steps: 208 | Train Loss: 0.397 Vali Loss: 10.074 Vali Acc: 0.078 Test Loss: 10.074 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2930278
	speed: 0.6571s/iter; left time: 10596.1000s
	iters: 200, epoch: 23 | loss: 0.1317470
	speed: 0.2864s/iter; left time: 4588.7735s
Epoch: 23 cost time: 59.650574922561646
Epoch: 23, Steps: 208 | Train Loss: 0.381 Vali Loss: 10.730 Vali Acc: 0.081 Test Loss: 10.730 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.5039812
	speed: 0.6520s/iter; left time: 10377.7176s
	iters: 200, epoch: 24 | loss: 0.1111359
	speed: 0.2758s/iter; left time: 4361.6894s
Epoch: 24 cost time: 57.906625509262085
Epoch: 24, Steps: 208 | Train Loss: 0.368 Vali Loss: 10.421 Vali Acc: 0.083 Test Loss: 10.421 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09543692215926036
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1475296
	speed: 0.3024s/iter; left time: 6261.0132s
	iters: 200, epoch: 1 | loss: 5.6631784
	speed: 0.2887s/iter; left time: 5946.9619s
Epoch: 1 cost time: 61.58874320983887
Epoch: 1, Steps: 208 | Train Loss: 4.004 Vali Loss: 5.285 Vali Acc: 0.053 Test Loss: 5.285 Test Acc: 0.053
Validation loss decreased (inf --> -0.053034).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0334520
	speed: 0.6998s/iter; left time: 14340.0599s
	iters: 200, epoch: 2 | loss: 4.5897584
	speed: 0.2899s/iter; left time: 5911.7736s
Epoch: 2 cost time: 61.93003273010254
Epoch: 2, Steps: 208 | Train Loss: 3.654 Vali Loss: 5.706 Vali Acc: 0.060 Test Loss: 5.706 Test Acc: 0.060
Validation loss decreased (-0.053034 --> -0.060187).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9376106
	speed: 0.7111s/iter; left time: 14425.5394s
	iters: 200, epoch: 3 | loss: 3.4970703
	speed: 0.2858s/iter; left time: 5768.8817s
Epoch: 3 cost time: 60.92030048370361
Epoch: 3, Steps: 208 | Train Loss: 3.238 Vali Loss: 5.470 Vali Acc: 0.075 Test Loss: 5.470 Test Acc: 0.075
Validation loss decreased (-0.060187 --> -0.074505).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8848996
	speed: 0.6565s/iter; left time: 13180.1057s
	iters: 200, epoch: 4 | loss: 3.3664274
	speed: 0.2696s/iter; left time: 5385.1528s
Epoch: 4 cost time: 57.07517075538635
Epoch: 4, Steps: 208 | Train Loss: 2.776 Vali Loss: 5.741 Vali Acc: 0.077 Test Loss: 5.741 Test Acc: 0.077
Validation loss decreased (-0.074505 --> -0.076889).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4048615
	speed: 0.6899s/iter; left time: 13707.8354s
	iters: 200, epoch: 5 | loss: 3.3826630
	speed: 0.2797s/iter; left time: 5528.7459s
Epoch: 5 cost time: 58.94605326652527
Epoch: 5, Steps: 208 | Train Loss: 2.326 Vali Loss: 6.364 Vali Acc: 0.061 Test Loss: 6.364 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9685993
	speed: 0.6828s/iter; left time: 13425.0493s
	iters: 200, epoch: 6 | loss: 2.8770993
	speed: 0.2778s/iter; left time: 5434.9490s
Epoch: 6 cost time: 59.374815225601196
Epoch: 6, Steps: 208 | Train Loss: 1.939 Vali Loss: 5.827 Vali Acc: 0.069 Test Loss: 5.827 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1455050
	speed: 0.6664s/iter; left time: 12964.4059s
	iters: 200, epoch: 7 | loss: 3.8331304
	speed: 0.2753s/iter; left time: 5328.6845s
Epoch: 7 cost time: 58.50299668312073
Epoch: 7, Steps: 208 | Train Loss: 1.682 Vali Loss: 5.975 Vali Acc: 0.071 Test Loss: 5.975 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5107650
	speed: 0.6841s/iter; left time: 13165.9723s
	iters: 200, epoch: 8 | loss: 1.3629633
	speed: 0.2749s/iter; left time: 5263.3359s
Epoch: 8 cost time: 59.41485810279846
Epoch: 8, Steps: 208 | Train Loss: 1.454 Vali Loss: 6.480 Vali Acc: 0.076 Test Loss: 6.480 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.8689091
	speed: 0.7070s/iter; left time: 13458.7955s
	iters: 200, epoch: 9 | loss: 0.8763361
	speed: 0.2906s/iter; left time: 5503.4022s
Epoch: 9 cost time: 61.822083473205566
Epoch: 9, Steps: 208 | Train Loss: 1.234 Vali Loss: 7.192 Vali Acc: 0.079 Test Loss: 7.192 Test Acc: 0.079
Validation loss decreased (-0.076889 --> -0.078664).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3321365
	speed: 0.6665s/iter; left time: 12549.8877s
	iters: 200, epoch: 10 | loss: 1.9321904
	speed: 0.2964s/iter; left time: 5551.4585s
Epoch: 10 cost time: 60.593390464782715
Epoch: 10, Steps: 208 | Train Loss: 1.137 Vali Loss: 7.029 Vali Acc: 0.083 Test Loss: 7.029 Test Acc: 0.083
Validation loss decreased (-0.078664 --> -0.083139).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0736161
	speed: 0.6904s/iter; left time: 12855.9054s
	iters: 200, epoch: 11 | loss: 1.6536976
	speed: 0.2872s/iter; left time: 5319.0493s
Epoch: 11 cost time: 60.524463415145874
Epoch: 11, Steps: 208 | Train Loss: 1.020 Vali Loss: 7.026 Vali Acc: 0.079 Test Loss: 7.026 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8164033
	speed: 0.7038s/iter; left time: 12958.4679s
	iters: 200, epoch: 12 | loss: 1.0586677
	speed: 0.2894s/iter; left time: 5300.6184s
Epoch: 12 cost time: 61.91051197052002
Epoch: 12, Steps: 208 | Train Loss: 0.889 Vali Loss: 7.441 Vali Acc: 0.079 Test Loss: 7.441 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8233539
	speed: 0.6612s/iter; left time: 12036.5633s
	iters: 200, epoch: 13 | loss: 0.7353155
	speed: 0.2721s/iter; left time: 4927.1952s
Epoch: 13 cost time: 57.28445315361023
Epoch: 13, Steps: 208 | Train Loss: 0.781 Vali Loss: 7.697 Vali Acc: 0.071 Test Loss: 7.697 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6459950
	speed: 0.6996s/iter; left time: 12591.4017s
	iters: 200, epoch: 14 | loss: 0.8398799
	speed: 0.2908s/iter; left time: 5205.2817s
Epoch: 14 cost time: 62.067580223083496
Epoch: 14, Steps: 208 | Train Loss: 0.746 Vali Loss: 7.886 Vali Acc: 0.089 Test Loss: 7.886 Test Acc: 0.089
Validation loss decreased (-0.083139 --> -0.088499).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6204327
	speed: 0.6879s/iter; left time: 12237.7330s
	iters: 200, epoch: 15 | loss: 1.6168383
	speed: 0.3099s/iter; left time: 5482.1369s
Epoch: 15 cost time: 63.25247287750244
Epoch: 15, Steps: 208 | Train Loss: 0.678 Vali Loss: 7.923 Vali Acc: 0.084 Test Loss: 7.923 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4095027
	speed: 0.6806s/iter; left time: 11964.8082s
	iters: 200, epoch: 16 | loss: 0.7052286
	speed: 0.2797s/iter; left time: 4888.8584s
Epoch: 16 cost time: 57.73620009422302
Epoch: 16, Steps: 208 | Train Loss: 0.636 Vali Loss: 8.500 Vali Acc: 0.080 Test Loss: 8.500 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0988306
	speed: 0.6566s/iter; left time: 11407.2015s
	iters: 200, epoch: 17 | loss: 1.8606286
	speed: 0.3040s/iter; left time: 5250.9579s
Epoch: 17 cost time: 61.195186376571655
Epoch: 17, Steps: 208 | Train Loss: 0.561 Vali Loss: 7.882 Vali Acc: 0.079 Test Loss: 7.882 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3071628
	speed: 0.6897s/iter; left time: 11839.2635s
	iters: 200, epoch: 18 | loss: 0.1248412
	speed: 0.2992s/iter; left time: 5106.6857s
Epoch: 18 cost time: 61.00117063522339
Epoch: 18, Steps: 208 | Train Loss: 0.560 Vali Loss: 8.533 Vali Acc: 0.080 Test Loss: 8.533 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3387184
	speed: 0.6759s/iter; left time: 11460.4476s
	iters: 200, epoch: 19 | loss: 0.6917029
	speed: 0.2809s/iter; left time: 4734.4295s
Epoch: 19 cost time: 59.583548069000244
Epoch: 19, Steps: 208 | Train Loss: 0.516 Vali Loss: 8.675 Vali Acc: 0.082 Test Loss: 8.675 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1513105
	speed: 0.6772s/iter; left time: 11342.8919s
	iters: 200, epoch: 20 | loss: 0.4553004
	speed: 0.2813s/iter; left time: 4683.0369s
Epoch: 20 cost time: 59.15626239776611
Epoch: 20, Steps: 208 | Train Loss: 0.524 Vali Loss: 8.841 Vali Acc: 0.073 Test Loss: 8.841 Test Acc: 0.073
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6684670
	speed: 0.6763s/iter; left time: 11186.8580s
	iters: 200, epoch: 21 | loss: 0.5013348
	speed: 0.2829s/iter; left time: 4651.1995s
Epoch: 21 cost time: 59.19691467285156
Epoch: 21, Steps: 208 | Train Loss: 0.453 Vali Loss: 9.780 Vali Acc: 0.081 Test Loss: 9.780 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3412107
	speed: 0.6818s/iter; left time: 11136.4057s
	iters: 200, epoch: 22 | loss: 0.0519344
	speed: 0.2715s/iter; left time: 4407.5309s
Epoch: 22 cost time: 58.092623233795166
Epoch: 22, Steps: 208 | Train Loss: 0.455 Vali Loss: 9.496 Vali Acc: 0.078 Test Loss: 9.496 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0294900
	speed: 0.6344s/iter; left time: 10230.2836s
	iters: 200, epoch: 23 | loss: 0.4174196
	speed: 0.2670s/iter; left time: 4278.5882s
Epoch: 23 cost time: 55.92696690559387
Epoch: 23, Steps: 208 | Train Loss: 0.421 Vali Loss: 9.171 Vali Acc: 0.076 Test Loss: 9.171 Test Acc: 0.076
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2343435
	speed: 0.6665s/iter; left time: 10609.4319s
	iters: 200, epoch: 24 | loss: 0.2269925
	speed: 0.2816s/iter; left time: 4454.1421s
Epoch: 24 cost time: 59.58181810379028
Epoch: 24, Steps: 208 | Train Loss: 0.394 Vali Loss: 9.486 Vali Acc: 0.084 Test Loss: 9.486 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08857739337906352
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9195070
	speed: 0.3120s/iter; left time: 6459.5569s
	iters: 200, epoch: 1 | loss: 5.2823830
	speed: 0.2907s/iter; left time: 5988.8327s
Epoch: 1 cost time: 62.85808444023132
Epoch: 1, Steps: 208 | Train Loss: 3.970 Vali Loss: 5.447 Vali Acc: 0.038 Test Loss: 5.447 Test Acc: 0.038
Validation loss decreased (inf --> -0.037524).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7554922
	speed: 0.6616s/iter; left time: 13559.0356s
	iters: 200, epoch: 2 | loss: 4.2672110
	speed: 0.2823s/iter; left time: 5756.4660s
Epoch: 2 cost time: 58.69710946083069
Epoch: 2, Steps: 208 | Train Loss: 3.750 Vali Loss: 6.224 Vali Acc: 0.034 Test Loss: 6.224 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.3207235
	speed: 0.6778s/iter; left time: 13749.7090s
	iters: 200, epoch: 3 | loss: 2.5770009
	speed: 0.2802s/iter; left time: 5656.6714s
Epoch: 3 cost time: 60.327194690704346
Epoch: 3, Steps: 208 | Train Loss: 3.478 Vali Loss: 5.756 Vali Acc: 0.048 Test Loss: 5.756 Test Acc: 0.048
Validation loss decreased (-0.037524 --> -0.047661).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6867397
	speed: 0.7002s/iter; left time: 14058.8021s
	iters: 200, epoch: 4 | loss: 3.8185899
	speed: 0.2948s/iter; left time: 5890.0979s
Epoch: 4 cost time: 62.19045543670654
Epoch: 4, Steps: 208 | Train Loss: 3.082 Vali Loss: 5.260 Vali Acc: 0.059 Test Loss: 5.260 Test Acc: 0.059
Validation loss decreased (-0.047661 --> -0.059297).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0654988
	speed: 0.6568s/iter; left time: 13050.5739s
	iters: 200, epoch: 5 | loss: 4.1314116
	speed: 0.2822s/iter; left time: 5579.1681s
Epoch: 5 cost time: 59.24356484413147
Epoch: 5, Steps: 208 | Train Loss: 2.664 Vali Loss: 5.547 Vali Acc: 0.048 Test Loss: 5.547 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6840267
	speed: 0.6933s/iter; left time: 13630.8063s
	iters: 200, epoch: 6 | loss: 3.1148002
	speed: 0.2941s/iter; left time: 5753.4403s
Epoch: 6 cost time: 60.166123151779175
Epoch: 6, Steps: 208 | Train Loss: 2.304 Vali Loss: 5.340 Vali Acc: 0.052 Test Loss: 5.340 Test Acc: 0.052
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3459699
	speed: 0.6999s/iter; left time: 13614.9075s
	iters: 200, epoch: 7 | loss: 1.8960091
	speed: 0.2937s/iter; left time: 5684.8514s
Epoch: 7 cost time: 62.25554633140564
Epoch: 7, Steps: 208 | Train Loss: 1.969 Vali Loss: 5.797 Vali Acc: 0.064 Test Loss: 5.797 Test Acc: 0.064
Validation loss decreased (-0.059297 --> -0.063765).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9604676
	speed: 0.6687s/iter; left time: 12869.2380s
	iters: 200, epoch: 8 | loss: 2.0566692
	speed: 0.2916s/iter; left time: 5582.7887s
Epoch: 8 cost time: 60.049323081970215
Epoch: 8, Steps: 208 | Train Loss: 1.658 Vali Loss: 6.039 Vali Acc: 0.070 Test Loss: 6.039 Test Acc: 0.070
Validation loss decreased (-0.063765 --> -0.070324).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1742462
	speed: 0.6578s/iter; left time: 12522.0390s
	iters: 200, epoch: 9 | loss: 2.1979816
	speed: 0.2722s/iter; left time: 5154.3354s
Epoch: 9 cost time: 57.187342166900635
Epoch: 9, Steps: 208 | Train Loss: 1.498 Vali Loss: 6.616 Vali Acc: 0.075 Test Loss: 6.616 Test Acc: 0.075
Validation loss decreased (-0.070324 --> -0.075389).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9738491
	speed: 0.6815s/iter; left time: 12832.6171s
	iters: 200, epoch: 10 | loss: 1.7668495
	speed: 0.2739s/iter; left time: 5130.2995s
Epoch: 10 cost time: 58.54789900779724
Epoch: 10, Steps: 208 | Train Loss: 1.294 Vali Loss: 6.680 Vali Acc: 0.069 Test Loss: 6.680 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8483905
	speed: 0.6518s/iter; left time: 12136.4090s
	iters: 200, epoch: 11 | loss: 1.1795430
	speed: 0.2775s/iter; left time: 5140.2999s
Epoch: 11 cost time: 58.41196608543396
Epoch: 11, Steps: 208 | Train Loss: 1.182 Vali Loss: 7.303 Vali Acc: 0.072 Test Loss: 7.303 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9660425
	speed: 0.6359s/iter; left time: 11709.2692s
	iters: 200, epoch: 12 | loss: 0.6152897
	speed: 0.2766s/iter; left time: 5065.8473s
Epoch: 12 cost time: 56.57177138328552
Epoch: 12, Steps: 208 | Train Loss: 1.014 Vali Loss: 7.170 Vali Acc: 0.077 Test Loss: 7.170 Test Acc: 0.077
Validation loss decreased (-0.075389 --> -0.076874).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0024877
	speed: 0.7115s/iter; left time: 12952.1011s
	iters: 200, epoch: 13 | loss: 1.0675775
	speed: 0.2678s/iter; left time: 4847.8138s
Epoch: 13 cost time: 58.868842124938965
Epoch: 13, Steps: 208 | Train Loss: 0.896 Vali Loss: 7.098 Vali Acc: 0.069 Test Loss: 7.098 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4053382
	speed: 0.6593s/iter; left time: 11864.8368s
	iters: 200, epoch: 14 | loss: 0.8953457
	speed: 0.2810s/iter; left time: 5029.8742s
Epoch: 14 cost time: 59.010422468185425
Epoch: 14, Steps: 208 | Train Loss: 0.789 Vali Loss: 7.475 Vali Acc: 0.077 Test Loss: 7.475 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2890160
	speed: 0.6462s/iter; left time: 11494.7615s
	iters: 200, epoch: 15 | loss: 1.4013433
	speed: 0.2593s/iter; left time: 4587.5980s
Epoch: 15 cost time: 55.55694055557251
Epoch: 15, Steps: 208 | Train Loss: 0.718 Vali Loss: 8.031 Vali Acc: 0.065 Test Loss: 8.031 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4447752
	speed: 0.6577s/iter; left time: 11562.2852s
	iters: 200, epoch: 16 | loss: 0.9864091
	speed: 0.2744s/iter; left time: 4796.8101s
Epoch: 16 cost time: 57.67875099182129
Epoch: 16, Steps: 208 | Train Loss: 0.646 Vali Loss: 8.271 Vali Acc: 0.068 Test Loss: 8.271 Test Acc: 0.068
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5743423
	speed: 0.6462s/iter; left time: 11226.4628s
	iters: 200, epoch: 17 | loss: 1.0986139
	speed: 0.2813s/iter; left time: 4858.4908s
Epoch: 17 cost time: 57.758622884750366
Epoch: 17, Steps: 208 | Train Loss: 0.591 Vali Loss: 8.185 Vali Acc: 0.076 Test Loss: 8.185 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4716914
	speed: 0.6915s/iter; left time: 11869.9078s
	iters: 200, epoch: 18 | loss: 0.3262805
	speed: 0.2832s/iter; left time: 4832.3955s
Epoch: 18 cost time: 61.354137659072876
Epoch: 18, Steps: 208 | Train Loss: 0.576 Vali Loss: 8.341 Vali Acc: 0.080 Test Loss: 8.341 Test Acc: 0.080
Validation loss decreased (-0.076874 --> -0.080143).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0775809
	speed: 0.6997s/iter; left time: 11865.5270s
	iters: 200, epoch: 19 | loss: 0.5309524
	speed: 0.3114s/iter; left time: 5248.9814s
Epoch: 19 cost time: 63.59035778045654
Epoch: 19, Steps: 208 | Train Loss: 0.519 Vali Loss: 8.435 Vali Acc: 0.069 Test Loss: 8.435 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0967064
	speed: 0.6806s/iter; left time: 11399.0562s
	iters: 200, epoch: 20 | loss: 0.7671879
	speed: 0.3032s/iter; left time: 5048.2784s
Epoch: 20 cost time: 62.72291088104248
Epoch: 20, Steps: 208 | Train Loss: 0.493 Vali Loss: 8.784 Vali Acc: 0.073 Test Loss: 8.784 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2200028
	speed: 0.7008s/iter; left time: 11592.1127s
	iters: 200, epoch: 21 | loss: 0.2275310
	speed: 0.2858s/iter; left time: 4698.8668s
Epoch: 21 cost time: 60.38512635231018
Epoch: 21, Steps: 208 | Train Loss: 0.466 Vali Loss: 8.719 Vali Acc: 0.076 Test Loss: 8.719 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.2982353
	speed: 0.6851s/iter; left time: 11189.9312s
	iters: 200, epoch: 22 | loss: 0.4921888
	speed: 0.2911s/iter; left time: 4725.6408s
Epoch: 22 cost time: 60.134244203567505
Epoch: 22, Steps: 208 | Train Loss: 0.418 Vali Loss: 8.891 Vali Acc: 0.078 Test Loss: 8.891 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0277393
	speed: 0.6839s/iter; left time: 11027.0919s
	iters: 200, epoch: 23 | loss: 0.1323579
	speed: 0.2947s/iter; left time: 4722.8339s
Epoch: 23 cost time: 61.46418476104736
Epoch: 23, Steps: 208 | Train Loss: 0.430 Vali Loss: 8.684 Vali Acc: 0.073 Test Loss: 8.684 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1554085
	speed: 0.6852s/iter; left time: 10905.8441s
	iters: 200, epoch: 24 | loss: 0.5802101
	speed: 0.2922s/iter; left time: 4622.3641s
Epoch: 24 cost time: 61.46055722236633
Epoch: 24, Steps: 208 | Train Loss: 0.351 Vali Loss: 9.389 Vali Acc: 0.075 Test Loss: 9.389 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1016796
	speed: 0.6554s/iter; left time: 10295.2677s
	iters: 200, epoch: 25 | loss: 0.1514898
	speed: 0.2911s/iter; left time: 4543.1924s
Epoch: 25 cost time: 59.507150650024414
Epoch: 25, Steps: 208 | Train Loss: 0.358 Vali Loss: 9.461 Vali Acc: 0.067 Test Loss: 9.461 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1321656
	speed: 0.6991s/iter; left time: 10837.1292s
	iters: 200, epoch: 26 | loss: 0.2515165
	speed: 0.2830s/iter; left time: 4357.8307s
Epoch: 26 cost time: 60.17377305030823
Epoch: 26, Steps: 208 | Train Loss: 0.338 Vali Loss: 9.548 Vali Acc: 0.074 Test Loss: 9.548 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0429492
	speed: 0.7142s/iter; left time: 10922.4710s
	iters: 200, epoch: 27 | loss: 1.1204333
	speed: 0.2977s/iter; left time: 4522.4655s
Epoch: 27 cost time: 64.0923068523407
Epoch: 27, Steps: 208 | Train Loss: 0.301 Vali Loss: 9.721 Vali Acc: 0.075 Test Loss: 9.721 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0852645
	speed: 0.6654s/iter; left time: 10037.2234s
	iters: 200, epoch: 28 | loss: 0.1574839
	speed: 0.3057s/iter; left time: 4581.3240s
Epoch: 28 cost time: 63.00472140312195
Epoch: 28, Steps: 208 | Train Loss: 0.277 Vali Loss: 9.772 Vali Acc: 0.076 Test Loss: 9.772 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08022666269012824
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0640507
	speed: 0.2986s/iter; left time: 6180.9728s
	iters: 200, epoch: 1 | loss: 5.1157966
	speed: 0.2967s/iter; left time: 6112.1237s
Epoch: 1 cost time: 62.375056982040405
Epoch: 1, Steps: 208 | Train Loss: 3.898 Vali Loss: 6.302 Vali Acc: 0.038 Test Loss: 6.302 Test Acc: 0.038
Validation loss decreased (inf --> -0.037515).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9555342
	speed: 0.7197s/iter; left time: 14748.6186s
	iters: 200, epoch: 2 | loss: 4.5389371
	speed: 0.2797s/iter; left time: 5703.8220s
Epoch: 2 cost time: 60.75307655334473
Epoch: 2, Steps: 208 | Train Loss: 3.881 Vali Loss: 7.748 Vali Acc: 0.035 Test Loss: 7.748 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.2949915
	speed: 0.6875s/iter; left time: 13946.2208s
	iters: 200, epoch: 3 | loss: 3.5224667
	speed: 0.2827s/iter; left time: 5705.5414s
Epoch: 3 cost time: 60.83305644989014
Epoch: 3, Steps: 208 | Train Loss: 3.875 Vali Loss: 6.179 Vali Acc: 0.046 Test Loss: 6.179 Test Acc: 0.046
Validation loss decreased (-0.037515 --> -0.045569).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.6602931
	speed: 0.6621s/iter; left time: 13293.2150s
	iters: 200, epoch: 4 | loss: 3.7500365
	speed: 0.2920s/iter; left time: 5833.3982s
Epoch: 4 cost time: 60.56631422042847
Epoch: 4, Steps: 208 | Train Loss: 3.654 Vali Loss: 4.945 Vali Acc: 0.044 Test Loss: 4.945 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2561603
	speed: 0.6723s/iter; left time: 13357.8707s
	iters: 200, epoch: 5 | loss: 4.4625592
	speed: 0.2840s/iter; left time: 5614.0890s
Epoch: 5 cost time: 58.825881481170654
Epoch: 5, Steps: 208 | Train Loss: 3.264 Vali Loss: 4.984 Vali Acc: 0.049 Test Loss: 4.984 Test Acc: 0.049
Validation loss decreased (-0.045569 --> -0.049160).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3664737
	speed: 0.6840s/iter; left time: 13447.5655s
	iters: 200, epoch: 6 | loss: 3.1911504
	speed: 0.2814s/iter; left time: 5504.0620s
Epoch: 6 cost time: 59.92852163314819
Epoch: 6, Steps: 208 | Train Loss: 2.909 Vali Loss: 4.726 Vali Acc: 0.052 Test Loss: 4.726 Test Acc: 0.052
Validation loss decreased (-0.049160 --> -0.051847).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7552898
	speed: 0.6897s/iter; left time: 13417.0846s
	iters: 200, epoch: 7 | loss: 3.1663811
	speed: 0.2943s/iter; left time: 5695.1575s
Epoch: 7 cost time: 61.199554681777954
Epoch: 7, Steps: 208 | Train Loss: 2.764 Vali Loss: 4.436 Vali Acc: 0.061 Test Loss: 4.436 Test Acc: 0.061
Validation loss decreased (-0.051847 --> -0.061393).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9604440
	speed: 0.6786s/iter; left time: 13059.7148s
	iters: 200, epoch: 8 | loss: 2.7354522
	speed: 0.2752s/iter; left time: 5269.3860s
Epoch: 8 cost time: 58.094948053359985
Epoch: 8, Steps: 208 | Train Loss: 2.515 Vali Loss: 4.618 Vali Acc: 0.059 Test Loss: 4.618 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9682834
	speed: 0.7081s/iter; left time: 13479.3232s
	iters: 200, epoch: 9 | loss: 2.9729433
	speed: 0.2811s/iter; left time: 5323.8944s
Epoch: 9 cost time: 61.15066170692444
Epoch: 9, Steps: 208 | Train Loss: 2.198 Vali Loss: 5.038 Vali Acc: 0.066 Test Loss: 5.038 Test Acc: 0.066
Validation loss decreased (-0.061393 --> -0.066159).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8675450
	speed: 0.6865s/iter; left time: 12925.8506s
	iters: 200, epoch: 10 | loss: 2.4546132
	speed: 0.2918s/iter; left time: 5465.1695s
Epoch: 10 cost time: 61.67164158821106
Epoch: 10, Steps: 208 | Train Loss: 1.832 Vali Loss: 5.189 Vali Acc: 0.081 Test Loss: 5.189 Test Acc: 0.081
Validation loss decreased (-0.066159 --> -0.080473).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0367084
	speed: 0.7407s/iter; left time: 13793.3473s
	iters: 200, epoch: 11 | loss: 1.6399233
	speed: 0.3165s/iter; left time: 5862.5418s
Epoch: 11 cost time: 67.17789506912231
Epoch: 11, Steps: 208 | Train Loss: 1.525 Vali Loss: 5.629 Vali Acc: 0.075 Test Loss: 5.629 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.1635377
	speed: 0.6855s/iter; left time: 12622.9066s
	iters: 200, epoch: 12 | loss: 1.4710643
	speed: 0.2659s/iter; left time: 4869.7827s
Epoch: 12 cost time: 56.37617015838623
Epoch: 12, Steps: 208 | Train Loss: 1.250 Vali Loss: 5.788 Vali Acc: 0.074 Test Loss: 5.788 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1945665
	speed: 0.6714s/iter; left time: 12222.2008s
	iters: 200, epoch: 13 | loss: 0.8876128
	speed: 0.2828s/iter; left time: 5120.1380s
Epoch: 13 cost time: 59.08006286621094
Epoch: 13, Steps: 208 | Train Loss: 1.060 Vali Loss: 6.332 Vali Acc: 0.070 Test Loss: 6.332 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5104054
	speed: 0.6723s/iter; left time: 12099.4368s
	iters: 200, epoch: 14 | loss: 1.4487084
	speed: 0.2846s/iter; left time: 5094.1088s
Epoch: 14 cost time: 59.36970520019531
Epoch: 14, Steps: 208 | Train Loss: 0.955 Vali Loss: 6.378 Vali Acc: 0.078 Test Loss: 6.378 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.9268778
	speed: 0.6921s/iter; left time: 12312.1526s
	iters: 200, epoch: 15 | loss: 1.2495141
	speed: 0.2691s/iter; left time: 4760.5775s
Epoch: 15 cost time: 58.40551424026489
Epoch: 15, Steps: 208 | Train Loss: 0.883 Vali Loss: 6.792 Vali Acc: 0.079 Test Loss: 6.792 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.2953413
	speed: 0.6622s/iter; left time: 11641.7767s
	iters: 200, epoch: 16 | loss: 0.9031871
	speed: 0.2836s/iter; left time: 4957.8835s
Epoch: 16 cost time: 59.80012512207031
Epoch: 16, Steps: 208 | Train Loss: 0.776 Vali Loss: 7.065 Vali Acc: 0.085 Test Loss: 7.065 Test Acc: 0.085
Validation loss decreased (-0.080473 --> -0.084928).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6526889
	speed: 0.6918s/iter; left time: 12018.7881s
	iters: 200, epoch: 17 | loss: 0.9409197
	speed: 0.2836s/iter; left time: 4898.4532s
Epoch: 17 cost time: 60.430720806121826
Epoch: 17, Steps: 208 | Train Loss: 0.731 Vali Loss: 7.064 Vali Acc: 0.067 Test Loss: 7.064 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6396384
	speed: 0.6674s/iter; left time: 11455.7821s
	iters: 200, epoch: 18 | loss: 1.0170341
	speed: 0.2927s/iter; left time: 4995.1949s
Epoch: 18 cost time: 60.487000942230225
Epoch: 18, Steps: 208 | Train Loss: 0.659 Vali Loss: 7.378 Vali Acc: 0.079 Test Loss: 7.378 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3088360
	speed: 0.6530s/iter; left time: 11072.8539s
	iters: 200, epoch: 19 | loss: 0.7621165
	speed: 0.2910s/iter; left time: 4904.6499s
Epoch: 19 cost time: 58.86531662940979
Epoch: 19, Steps: 208 | Train Loss: 0.599 Vali Loss: 7.697 Vali Acc: 0.071 Test Loss: 7.697 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3221102
	speed: 0.6741s/iter; left time: 11290.8651s
	iters: 200, epoch: 20 | loss: 0.7835949
	speed: 0.2950s/iter; left time: 4912.1417s
Epoch: 20 cost time: 60.404972553253174
Epoch: 20, Steps: 208 | Train Loss: 0.539 Vali Loss: 8.067 Vali Acc: 0.081 Test Loss: 8.067 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3163928
	speed: 0.6865s/iter; left time: 11355.6029s
	iters: 200, epoch: 21 | loss: 0.6932462
	speed: 0.2647s/iter; left time: 4352.2121s
Epoch: 21 cost time: 57.4226450920105
Epoch: 21, Steps: 208 | Train Loss: 0.553 Vali Loss: 8.063 Vali Acc: 0.081 Test Loss: 8.063 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.8153756
	speed: 0.6719s/iter; left time: 10974.3996s
	iters: 200, epoch: 22 | loss: 0.8861325
	speed: 0.2835s/iter; left time: 4601.3328s
Epoch: 22 cost time: 59.389766693115234
Epoch: 22, Steps: 208 | Train Loss: 0.536 Vali Loss: 8.238 Vali Acc: 0.083 Test Loss: 8.238 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.5425929
	speed: 0.6927s/iter; left time: 11169.2992s
	iters: 200, epoch: 23 | loss: 1.3034207
	speed: 0.2789s/iter; left time: 4468.5985s
Epoch: 23 cost time: 60.83082461357117
Epoch: 23, Steps: 208 | Train Loss: 0.486 Vali Loss: 8.377 Vali Acc: 0.078 Test Loss: 8.377 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1569112
	speed: 0.6888s/iter; left time: 10963.6574s
	iters: 200, epoch: 24 | loss: 0.2315526
	speed: 0.2702s/iter; left time: 4273.6256s
Epoch: 24 cost time: 58.06773018836975
Epoch: 24, Steps: 208 | Train Loss: 0.429 Vali Loss: 8.636 Vali Acc: 0.070 Test Loss: 8.636 Test Acc: 0.070
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1209088
	speed: 0.6809s/iter; left time: 10695.5583s
	iters: 200, epoch: 25 | loss: 0.4677658
	speed: 0.2840s/iter; left time: 4432.7296s
Epoch: 25 cost time: 59.45687913894653
Epoch: 25, Steps: 208 | Train Loss: 0.418 Vali Loss: 8.796 Vali Acc: 0.075 Test Loss: 8.796 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2811285
	speed: 0.6832s/iter; left time: 10590.1985s
	iters: 200, epoch: 26 | loss: 0.6678784
	speed: 0.2792s/iter; left time: 4300.5897s
Epoch: 26 cost time: 60.03463387489319
Epoch: 26, Steps: 208 | Train Loss: 0.440 Vali Loss: 8.763 Vali Acc: 0.085 Test Loss: 8.763 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08499850879809126
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0089111
	speed: 0.2922s/iter; left time: 6049.4842s
	iters: 200, epoch: 1 | loss: 4.8933396
	speed: 0.2732s/iter; left time: 5628.8937s
Epoch: 1 cost time: 58.99796271324158
Epoch: 1, Steps: 208 | Train Loss: 3.884 Vali Loss: 5.738 Vali Acc: 0.040 Test Loss: 5.738 Test Acc: 0.040
Validation loss decreased (inf --> -0.039907).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3878911
	speed: 0.6696s/iter; left time: 13722.3580s
	iters: 200, epoch: 2 | loss: 4.2536039
	speed: 0.2652s/iter; left time: 5408.8569s
Epoch: 2 cost time: 57.338300943374634
Epoch: 2, Steps: 208 | Train Loss: 3.680 Vali Loss: 7.652 Vali Acc: 0.038 Test Loss: 7.652 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.2530904
	speed: 0.6701s/iter; left time: 13593.1184s
	iters: 200, epoch: 3 | loss: 3.5069883
	speed: 0.2852s/iter; left time: 5757.1970s
Epoch: 3 cost time: 60.32537388801575
Epoch: 3, Steps: 208 | Train Loss: 3.632 Vali Loss: 7.105 Vali Acc: 0.048 Test Loss: 7.105 Test Acc: 0.048
Validation loss decreased (-0.039907 --> -0.047946).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4932275
	speed: 0.7098s/iter; left time: 14250.4370s
	iters: 200, epoch: 4 | loss: 3.7856407
	speed: 0.2939s/iter; left time: 5871.6252s
Epoch: 4 cost time: 62.64730739593506
Epoch: 4, Steps: 208 | Train Loss: 3.458 Vali Loss: 6.608 Vali Acc: 0.052 Test Loss: 6.608 Test Acc: 0.052
Validation loss decreased (-0.047946 --> -0.052126).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9141481
	speed: 0.6814s/iter; left time: 13538.8540s
	iters: 200, epoch: 5 | loss: 3.4411678
	speed: 0.2975s/iter; left time: 5881.4970s
Epoch: 5 cost time: 62.41283655166626
Epoch: 5, Steps: 208 | Train Loss: 3.097 Vali Loss: 6.641 Vali Acc: 0.058 Test Loss: 6.641 Test Acc: 0.058
Validation loss decreased (-0.052126 --> -0.058389).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4440506
	speed: 0.7121s/iter; left time: 14001.3066s
	iters: 200, epoch: 6 | loss: 3.2079811
	speed: 0.3090s/iter; left time: 6043.8339s
Epoch: 6 cost time: 64.56715750694275
Epoch: 6, Steps: 208 | Train Loss: 2.611 Vali Loss: 5.509 Vali Acc: 0.062 Test Loss: 5.509 Test Acc: 0.062
Validation loss decreased (-0.058389 --> -0.061979).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6219501
	speed: 0.7023s/iter; left time: 13661.6614s
	iters: 200, epoch: 7 | loss: 3.9547844
	speed: 0.2930s/iter; left time: 5671.2156s
Epoch: 7 cost time: 61.23826837539673
Epoch: 7, Steps: 208 | Train Loss: 2.154 Vali Loss: 5.711 Vali Acc: 0.058 Test Loss: 5.711 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3057415
	speed: 0.6744s/iter; left time: 12977.9115s
	iters: 200, epoch: 8 | loss: 2.0791886
	speed: 0.2912s/iter; left time: 5575.1410s
Epoch: 8 cost time: 59.58735990524292
Epoch: 8, Steps: 208 | Train Loss: 1.792 Vali Loss: 5.878 Vali Acc: 0.064 Test Loss: 5.878 Test Acc: 0.064
Validation loss decreased (-0.061979 --> -0.063466).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3199781
	speed: 0.6625s/iter; left time: 12612.3189s
	iters: 200, epoch: 9 | loss: 1.6446216
	speed: 0.2923s/iter; left time: 5536.2091s
Epoch: 9 cost time: 59.97670078277588
Epoch: 9, Steps: 208 | Train Loss: 1.422 Vali Loss: 6.733 Vali Acc: 0.072 Test Loss: 6.733 Test Acc: 0.072
Validation loss decreased (-0.063466 --> -0.072405).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4346298
	speed: 0.7090s/iter; left time: 13350.4214s
	iters: 200, epoch: 10 | loss: 1.3634739
	speed: 0.2851s/iter; left time: 5339.4140s
Epoch: 10 cost time: 59.79067277908325
Epoch: 10, Steps: 208 | Train Loss: 1.173 Vali Loss: 6.868 Vali Acc: 0.064 Test Loss: 6.868 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0284408
	speed: 0.6830s/iter; left time: 12718.8794s
	iters: 200, epoch: 11 | loss: 0.9098409
	speed: 0.2867s/iter; left time: 5309.2619s
Epoch: 11 cost time: 60.027870416641235
Epoch: 11, Steps: 208 | Train Loss: 1.028 Vali Loss: 6.921 Vali Acc: 0.062 Test Loss: 6.921 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1757638
	speed: 0.6976s/iter; left time: 12844.9211s
	iters: 200, epoch: 12 | loss: 0.6509610
	speed: 0.2806s/iter; left time: 5139.3770s
Epoch: 12 cost time: 58.541473150253296
Epoch: 12, Steps: 208 | Train Loss: 0.903 Vali Loss: 7.326 Vali Acc: 0.067 Test Loss: 7.326 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6761394
	speed: 0.6753s/iter; left time: 12293.0563s
	iters: 200, epoch: 13 | loss: 0.4248865
	speed: 0.2696s/iter; left time: 4881.6318s
Epoch: 13 cost time: 58.529829025268555
Epoch: 13, Steps: 208 | Train Loss: 0.877 Vali Loss: 7.796 Vali Acc: 0.063 Test Loss: 7.796 Test Acc: 0.063
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9794591
	speed: 0.7204s/iter; left time: 12965.3816s
	iters: 200, epoch: 14 | loss: 0.8791919
	speed: 0.2649s/iter; left time: 4740.9272s
Epoch: 14 cost time: 58.02939963340759
Epoch: 14, Steps: 208 | Train Loss: 0.742 Vali Loss: 7.826 Vali Acc: 0.075 Test Loss: 7.826 Test Acc: 0.075
Validation loss decreased (-0.072405 --> -0.075377).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1720903
	speed: 0.6522s/iter; left time: 11602.6245s
	iters: 200, epoch: 15 | loss: 1.1350394
	speed: 0.2945s/iter; left time: 5209.6891s
Epoch: 15 cost time: 58.91698932647705
Epoch: 15, Steps: 208 | Train Loss: 0.661 Vali Loss: 8.237 Vali Acc: 0.066 Test Loss: 8.237 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1499363
	speed: 0.7029s/iter; left time: 12357.6808s
	iters: 200, epoch: 16 | loss: 1.1127474
	speed: 0.3166s/iter; left time: 5534.6760s
Epoch: 16 cost time: 64.45722460746765
Epoch: 16, Steps: 208 | Train Loss: 0.634 Vali Loss: 8.243 Vali Acc: 0.068 Test Loss: 8.243 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3119541
	speed: 0.7122s/iter; left time: 12372.9839s
	iters: 200, epoch: 17 | loss: 1.7265352
	speed: 0.3004s/iter; left time: 5189.3354s
Epoch: 17 cost time: 64.53880977630615
Epoch: 17, Steps: 208 | Train Loss: 0.546 Vali Loss: 8.567 Vali Acc: 0.071 Test Loss: 8.567 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5134746
	speed: 0.7272s/iter; left time: 12482.0368s
	iters: 200, epoch: 18 | loss: 0.0679310
	speed: 0.2722s/iter; left time: 4645.7729s
Epoch: 18 cost time: 61.108819007873535
Epoch: 18, Steps: 208 | Train Loss: 0.534 Vali Loss: 8.727 Vali Acc: 0.072 Test Loss: 8.727 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7319821
	speed: 0.6851s/iter; left time: 11617.6105s
	iters: 200, epoch: 19 | loss: 0.2923491
	speed: 0.2887s/iter; left time: 4866.8444s
Epoch: 19 cost time: 59.10383939743042
Epoch: 19, Steps: 208 | Train Loss: 0.468 Vali Loss: 9.019 Vali Acc: 0.071 Test Loss: 9.019 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.4792483
	speed: 0.6628s/iter; left time: 11100.5921s
	iters: 200, epoch: 20 | loss: 0.3536204
	speed: 0.2795s/iter; left time: 4653.9823s
Epoch: 20 cost time: 58.60570669174194
Epoch: 20, Steps: 208 | Train Loss: 0.443 Vali Loss: 9.327 Vali Acc: 0.077 Test Loss: 9.327 Test Acc: 0.077
Validation loss decreased (-0.075377 --> -0.077151).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5155667
	speed: 0.6779s/iter; left time: 11212.5796s
	iters: 200, epoch: 21 | loss: 0.5065936
	speed: 0.2800s/iter; left time: 4603.2003s
Epoch: 21 cost time: 59.35781240463257
Epoch: 21, Steps: 208 | Train Loss: 0.395 Vali Loss: 9.497 Vali Acc: 0.069 Test Loss: 9.497 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3268805
	speed: 0.6591s/iter; left time: 10764.5133s
	iters: 200, epoch: 22 | loss: 0.4390935
	speed: 0.2769s/iter; left time: 4494.3273s
Epoch: 22 cost time: 58.071979999542236
Epoch: 22, Steps: 208 | Train Loss: 0.437 Vali Loss: 9.566 Vali Acc: 0.071 Test Loss: 9.566 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.1992814
	speed: 0.6625s/iter; left time: 10682.5451s
	iters: 200, epoch: 23 | loss: 0.8109877
	speed: 0.2865s/iter; left time: 4591.9412s
Epoch: 23 cost time: 59.565990924835205
Epoch: 23, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.682 Vali Acc: 0.071 Test Loss: 9.682 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3114061
	speed: 0.7063s/iter; left time: 11242.1012s
	iters: 200, epoch: 24 | loss: 0.1982672
	speed: 0.3019s/iter; left time: 4775.0223s
Epoch: 24 cost time: 63.405473470687866
Epoch: 24, Steps: 208 | Train Loss: 0.341 Vali Loss: 10.213 Vali Acc: 0.073 Test Loss: 10.213 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2935615
	speed: 0.7097s/iter; left time: 11148.1872s
	iters: 200, epoch: 25 | loss: 0.0692971
	speed: 0.3043s/iter; left time: 4750.1501s
Epoch: 25 cost time: 64.44048428535461
Epoch: 25, Steps: 208 | Train Loss: 0.359 Vali Loss: 9.997 Vali Acc: 0.061 Test Loss: 9.997 Test Acc: 0.061
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.4430665
	speed: 0.7017s/iter; left time: 10876.7787s
	iters: 200, epoch: 26 | loss: 0.3117863
	speed: 0.3160s/iter; left time: 4866.0909s
Epoch: 26 cost time: 63.15756559371948
Epoch: 26, Steps: 208 | Train Loss: 0.329 Vali Loss: 10.001 Vali Acc: 0.076 Test Loss: 10.001 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1809433
	speed: 0.7040s/iter; left time: 10766.1929s
	iters: 200, epoch: 27 | loss: 0.4720671
	speed: 0.3052s/iter; left time: 4636.7460s
Epoch: 27 cost time: 64.34811687469482
Epoch: 27, Steps: 208 | Train Loss: 0.304 Vali Loss: 10.352 Vali Acc: 0.064 Test Loss: 10.352 Test Acc: 0.064
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0737641
	speed: 0.6787s/iter; left time: 10238.1585s
	iters: 200, epoch: 28 | loss: 0.2830769
	speed: 0.2884s/iter; left time: 4321.4333s
Epoch: 28 cost time: 60.866863489151
Epoch: 28, Steps: 208 | Train Loss: 0.298 Vali Loss: 10.360 Vali Acc: 0.081 Test Loss: 10.360 Test Acc: 0.081
Validation loss decreased (-0.077151 --> -0.080421).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1863624
	speed: 0.6812s/iter; left time: 10134.5890s
	iters: 200, epoch: 29 | loss: 0.0942674
	speed: 0.2990s/iter; left time: 4417.5881s
Epoch: 29 cost time: 60.84876227378845
Epoch: 29, Steps: 208 | Train Loss: 0.290 Vali Loss: 10.759 Vali Acc: 0.079 Test Loss: 10.759 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0270509
	speed: 0.7202s/iter; left time: 10564.8354s
	iters: 200, epoch: 30 | loss: 1.0503066
	speed: 0.3084s/iter; left time: 4493.2029s
Epoch: 30 cost time: 64.01214671134949
Epoch: 30, Steps: 208 | Train Loss: 0.271 Vali Loss: 10.926 Vali Acc: 0.071 Test Loss: 10.926 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0463566
	speed: 0.6992s/iter; left time: 10110.7055s
	iters: 200, epoch: 31 | loss: 0.5602136
	speed: 0.2881s/iter; left time: 4137.3544s
Epoch: 31 cost time: 61.72209358215332
Epoch: 31, Steps: 208 | Train Loss: 0.271 Vali Loss: 10.922 Vali Acc: 0.074 Test Loss: 10.922 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.1037401
	speed: 0.7058s/iter; left time: 10059.9316s
	iters: 200, epoch: 32 | loss: 0.4906721
	speed: 0.2970s/iter; left time: 4202.8971s
Epoch: 32 cost time: 61.84882140159607
Epoch: 32, Steps: 208 | Train Loss: 0.229 Vali Loss: 11.604 Vali Acc: 0.087 Test Loss: 11.604 Test Acc: 0.087
Validation loss decreased (-0.080421 --> -0.086970).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.3044430
	speed: 0.7001s/iter; left time: 9833.2954s
	iters: 200, epoch: 33 | loss: 0.4586595
	speed: 0.3064s/iter; left time: 4273.1167s
Epoch: 33 cost time: 63.59850883483887
Epoch: 33, Steps: 208 | Train Loss: 0.246 Vali Loss: 11.385 Vali Acc: 0.071 Test Loss: 11.385 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0687130
	speed: 0.7065s/iter; left time: 9775.3468s
	iters: 200, epoch: 34 | loss: 0.0479828
	speed: 0.2864s/iter; left time: 3934.5749s
Epoch: 34 cost time: 61.812946796417236
Epoch: 34, Steps: 208 | Train Loss: 0.233 Vali Loss: 11.306 Vali Acc: 0.072 Test Loss: 11.306 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.4061201
	speed: 0.6913s/iter; left time: 9421.1473s
	iters: 200, epoch: 35 | loss: 0.4063547
	speed: 0.2865s/iter; left time: 3876.3056s
Epoch: 35 cost time: 60.32439661026001
Epoch: 35, Steps: 208 | Train Loss: 0.210 Vali Loss: 11.183 Vali Acc: 0.071 Test Loss: 11.183 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.4687497
	speed: 0.6819s/iter; left time: 9152.1159s
	iters: 200, epoch: 36 | loss: 0.0023760
	speed: 0.3134s/iter; left time: 4174.8775s
Epoch: 36 cost time: 64.237717628479
Epoch: 36, Steps: 208 | Train Loss: 0.202 Vali Loss: 11.677 Vali Acc: 0.080 Test Loss: 11.677 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0794216
	speed: 0.7240s/iter; left time: 9566.5782s
	iters: 200, epoch: 37 | loss: 0.3284064
	speed: 0.2836s/iter; left time: 3719.0563s
Epoch: 37 cost time: 60.89405632019043
Epoch: 37, Steps: 208 | Train Loss: 0.178 Vali Loss: 11.808 Vali Acc: 0.070 Test Loss: 11.808 Test Acc: 0.070
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.2574011
	speed: 0.6889s/iter; left time: 8959.3393s
	iters: 200, epoch: 38 | loss: 0.0152133
	speed: 0.3010s/iter; left time: 3884.6536s
Epoch: 38 cost time: 63.07034921646118
Epoch: 38, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.837 Vali Acc: 0.069 Test Loss: 11.837 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.1365301
	speed: 0.6853s/iter; left time: 8769.5564s
	iters: 200, epoch: 39 | loss: 0.0917251
	speed: 0.2941s/iter; left time: 3733.9825s
Epoch: 39 cost time: 61.92315363883972
Epoch: 39, Steps: 208 | Train Loss: 0.153 Vali Loss: 12.703 Vali Acc: 0.074 Test Loss: 12.703 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0788763
	speed: 0.7257s/iter; left time: 9135.5216s
	iters: 200, epoch: 40 | loss: 0.1510556
	speed: 0.2939s/iter; left time: 3671.0856s
Epoch: 40 cost time: 63.55861020088196
Epoch: 40, Steps: 208 | Train Loss: 0.193 Vali Loss: 11.984 Vali Acc: 0.069 Test Loss: 11.984 Test Acc: 0.069
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.2430820
	speed: 0.6727s/iter; left time: 8328.2412s
	iters: 200, epoch: 41 | loss: 0.2465449
	speed: 0.3018s/iter; left time: 3705.8053s
Epoch: 41 cost time: 61.77383852005005
Epoch: 41, Steps: 208 | Train Loss: 0.192 Vali Loss: 12.036 Vali Acc: 0.075 Test Loss: 12.036 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.2269850
	speed: 0.6691s/iter; left time: 8145.0163s
	iters: 200, epoch: 42 | loss: 0.5920350
	speed: 0.2907s/iter; left time: 3509.3409s
Epoch: 42 cost time: 58.97992777824402
Epoch: 42, Steps: 208 | Train Loss: 0.197 Vali Loss: 12.184 Vali Acc: 0.071 Test Loss: 12.184 Test Acc: 0.071
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08708619147032508
model parameter : 5595431
model size : 31.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5014868
	speed: 0.3071s/iter; left time: 6356.6094s
	iters: 200, epoch: 1 | loss: 3.6840003
	speed: 0.2742s/iter; left time: 5648.9155s
Epoch: 1 cost time: 60.48040723800659
Epoch: 1, Steps: 208 | Train Loss: 4.267 Vali Loss: 4.267 Vali Acc: 0.074 Test Loss: 4.267 Test Acc: 0.074
Validation loss decreased (inf --> -0.074219).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2458186
	speed: 0.6624s/iter; left time: 13574.4872s
	iters: 200, epoch: 2 | loss: 4.2611270
	speed: 0.2857s/iter; left time: 5825.3461s
Epoch: 2 cost time: 59.615288972854614
Epoch: 2, Steps: 208 | Train Loss: 3.600 Vali Loss: 4.228 Vali Acc: 0.079 Test Loss: 4.228 Test Acc: 0.079
Validation loss decreased (-0.074219 --> -0.079290).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9958777
	speed: 0.6632s/iter; left time: 13452.8189s
	iters: 200, epoch: 3 | loss: 3.3164339
	speed: 0.2802s/iter; left time: 5656.5454s
Epoch: 3 cost time: 58.069420337677
Epoch: 3, Steps: 208 | Train Loss: 2.900 Vali Loss: 4.887 Vali Acc: 0.088 Test Loss: 4.887 Test Acc: 0.088
Validation loss decreased (-0.079290 --> -0.088230).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0547566
	speed: 0.6750s/iter; left time: 13552.3778s
	iters: 200, epoch: 4 | loss: 2.7261212
	speed: 0.2950s/iter; left time: 5893.8147s
Epoch: 4 cost time: 60.33212065696716
Epoch: 4, Steps: 208 | Train Loss: 2.227 Vali Loss: 5.447 Vali Acc: 0.071 Test Loss: 5.447 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3584549
	speed: 0.6776s/iter; left time: 13463.4795s
	iters: 200, epoch: 5 | loss: 2.1059387
	speed: 0.2863s/iter; left time: 5660.8229s
Epoch: 5 cost time: 58.815611839294434
Epoch: 5, Steps: 208 | Train Loss: 1.611 Vali Loss: 6.474 Vali Acc: 0.086 Test Loss: 6.474 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2290945
	speed: 0.6967s/iter; left time: 13697.8183s
	iters: 200, epoch: 6 | loss: 2.5797634
	speed: 0.3024s/iter; left time: 5914.4782s
Epoch: 6 cost time: 62.347976207733154
Epoch: 6, Steps: 208 | Train Loss: 1.268 Vali Loss: 7.143 Vali Acc: 0.082 Test Loss: 7.143 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6612512
	speed: 0.7071s/iter; left time: 13754.8641s
	iters: 200, epoch: 7 | loss: 1.7347784
	speed: 0.3030s/iter; left time: 5864.1308s
Epoch: 7 cost time: 62.894816398620605
Epoch: 7, Steps: 208 | Train Loss: 0.989 Vali Loss: 8.292 Vali Acc: 0.081 Test Loss: 8.292 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8541549
	speed: 0.7170s/iter; left time: 13798.1562s
	iters: 200, epoch: 8 | loss: 0.4764784
	speed: 0.2925s/iter; left time: 5600.3443s
Epoch: 8 cost time: 62.31002449989319
Epoch: 8, Steps: 208 | Train Loss: 0.896 Vali Loss: 8.296 Vali Acc: 0.074 Test Loss: 8.296 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2719673
	speed: 0.6796s/iter; left time: 12937.7960s
	iters: 200, epoch: 9 | loss: 0.9038565
	speed: 0.3104s/iter; left time: 5878.0802s
Epoch: 9 cost time: 64.1129424571991
Epoch: 9, Steps: 208 | Train Loss: 0.752 Vali Loss: 9.059 Vali Acc: 0.078 Test Loss: 9.059 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3588568
	speed: 0.7193s/iter; left time: 13543.4033s
	iters: 200, epoch: 10 | loss: 0.5254401
	speed: 0.3065s/iter; left time: 5740.6048s
Epoch: 10 cost time: 62.63541579246521
Epoch: 10, Steps: 208 | Train Loss: 0.616 Vali Loss: 10.459 Vali Acc: 0.079 Test Loss: 10.459 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1195632
	speed: 0.7376s/iter; left time: 13735.7595s
	iters: 200, epoch: 11 | loss: 0.6185030
	speed: 0.3001s/iter; left time: 5557.5684s
Epoch: 11 cost time: 63.23742127418518
Epoch: 11, Steps: 208 | Train Loss: 0.587 Vali Loss: 10.505 Vali Acc: 0.072 Test Loss: 10.505 Test Acc: 0.072
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7105921
	speed: 0.7003s/iter; left time: 12894.2530s
	iters: 200, epoch: 12 | loss: 0.8544658
	speed: 0.2977s/iter; left time: 5450.9046s
Epoch: 12 cost time: 62.771493434906006
Epoch: 12, Steps: 208 | Train Loss: 0.521 Vali Loss: 10.762 Vali Acc: 0.072 Test Loss: 10.762 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2884979
	speed: 0.7180s/iter; left time: 13071.6911s
	iters: 200, epoch: 13 | loss: 0.7210571
	speed: 0.3178s/iter; left time: 5754.1435s
Epoch: 13 cost time: 66.17191314697266
Epoch: 13, Steps: 208 | Train Loss: 0.524 Vali Loss: 10.482 Vali Acc: 0.073 Test Loss: 10.482 Test Acc: 0.073
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08827915299731584
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5193048
	speed: 0.3120s/iter; left time: 6458.3095s
	iters: 200, epoch: 1 | loss: 3.8933997
	speed: 0.3041s/iter; left time: 6263.9906s
Epoch: 1 cost time: 64.15686464309692
Epoch: 1, Steps: 208 | Train Loss: 4.258 Vali Loss: 4.249 Vali Acc: 0.073 Test Loss: 4.249 Test Acc: 0.073
Validation loss decreased (inf --> -0.073026).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2629037
	speed: 0.6950s/iter; left time: 14243.2616s
	iters: 200, epoch: 2 | loss: 4.2843814
	speed: 0.2852s/iter; left time: 5815.5896s
Epoch: 2 cost time: 60.5319082736969
Epoch: 2, Steps: 208 | Train Loss: 3.598 Vali Loss: 4.243 Vali Acc: 0.079 Test Loss: 4.243 Test Acc: 0.079
Validation loss decreased (-0.073026 --> -0.078991).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0682437
	speed: 0.7165s/iter; left time: 14534.2579s
	iters: 200, epoch: 3 | loss: 2.9590685
	speed: 0.3029s/iter; left time: 6113.4369s
Epoch: 3 cost time: 63.28552722930908
Epoch: 3, Steps: 208 | Train Loss: 2.906 Vali Loss: 5.134 Vali Acc: 0.079 Test Loss: 5.134 Test Acc: 0.079
Validation loss decreased (-0.078991 --> -0.079281).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3634598
	speed: 0.7023s/iter; left time: 14099.2161s
	iters: 200, epoch: 4 | loss: 2.8935614
	speed: 0.2977s/iter; left time: 5946.9117s
Epoch: 4 cost time: 62.34030079841614
Epoch: 4, Steps: 208 | Train Loss: 2.200 Vali Loss: 5.500 Vali Acc: 0.078 Test Loss: 5.500 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0213509
	speed: 0.6971s/iter; left time: 13850.0399s
	iters: 200, epoch: 5 | loss: 2.5380416
	speed: 0.2944s/iter; left time: 5820.8314s
Epoch: 5 cost time: 61.6426043510437
Epoch: 5, Steps: 208 | Train Loss: 1.595 Vali Loss: 6.228 Vali Acc: 0.081 Test Loss: 6.228 Test Acc: 0.081
Validation loss decreased (-0.079281 --> -0.080463).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1169091
	speed: 0.6986s/iter; left time: 13735.6989s
	iters: 200, epoch: 6 | loss: 2.3568909
	speed: 0.3081s/iter; left time: 6026.1497s
Epoch: 6 cost time: 64.04854893684387
Epoch: 6, Steps: 208 | Train Loss: 1.233 Vali Loss: 6.923 Vali Acc: 0.085 Test Loss: 6.923 Test Acc: 0.085
Validation loss decreased (-0.080463 --> -0.084631).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1311355
	speed: 0.7292s/iter; left time: 14186.0182s
	iters: 200, epoch: 7 | loss: 1.6602091
	speed: 0.2927s/iter; left time: 5665.1604s
Epoch: 7 cost time: 63.15191984176636
Epoch: 7, Steps: 208 | Train Loss: 1.043 Vali Loss: 7.924 Vali Acc: 0.081 Test Loss: 7.924 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8402072
	speed: 0.7072s/iter; left time: 13609.5149s
	iters: 200, epoch: 8 | loss: 1.0111370
	speed: 0.2946s/iter; left time: 5640.7491s
Epoch: 8 cost time: 63.548012018203735
Epoch: 8, Steps: 208 | Train Loss: 0.859 Vali Loss: 8.519 Vali Acc: 0.083 Test Loss: 8.519 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3627639
	speed: 0.6779s/iter; left time: 12904.5083s
	iters: 200, epoch: 9 | loss: 0.5407521
	speed: 0.2933s/iter; left time: 5553.3831s
Epoch: 9 cost time: 61.13517785072327
Epoch: 9, Steps: 208 | Train Loss: 0.746 Vali Loss: 9.030 Vali Acc: 0.078 Test Loss: 9.030 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5462389
	speed: 0.6835s/iter; left time: 12869.7455s
	iters: 200, epoch: 10 | loss: 0.0521012
	speed: 0.3058s/iter; left time: 5726.5397s
Epoch: 10 cost time: 62.33264708518982
Epoch: 10, Steps: 208 | Train Loss: 0.651 Vali Loss: 9.857 Vali Acc: 0.074 Test Loss: 9.857 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8007200
	speed: 0.6602s/iter; left time: 12294.5086s
	iters: 200, epoch: 11 | loss: 0.5974564
	speed: 0.2785s/iter; left time: 5157.8288s
Epoch: 11 cost time: 59.234771728515625
Epoch: 11, Steps: 208 | Train Loss: 0.601 Vali Loss: 9.957 Vali Acc: 0.078 Test Loss: 9.957 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6474262
	speed: 0.6570s/iter; left time: 12096.4243s
	iters: 200, epoch: 12 | loss: 0.0588107
	speed: 0.2992s/iter; left time: 5479.0754s
Epoch: 12 cost time: 61.38090133666992
Epoch: 12, Steps: 208 | Train Loss: 0.506 Vali Loss: 10.593 Vali Acc: 0.083 Test Loss: 10.593 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6045491
	speed: 0.6636s/iter; left time: 12081.5208s
	iters: 200, epoch: 13 | loss: 0.4217539
	speed: 0.2961s/iter; left time: 5360.0587s
Epoch: 13 cost time: 60.92364764213562
Epoch: 13, Steps: 208 | Train Loss: 0.490 Vali Loss: 11.113 Vali Acc: 0.086 Test Loss: 11.113 Test Acc: 0.086
Validation loss decreased (-0.084631 --> -0.086379).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0659205
	speed: 0.6836s/iter; left time: 12302.7773s
	iters: 200, epoch: 14 | loss: 1.3539999
	speed: 0.2941s/iter; left time: 5264.2600s
Epoch: 14 cost time: 60.76337385177612
Epoch: 14, Steps: 208 | Train Loss: 0.433 Vali Loss: 11.018 Vali Acc: 0.084 Test Loss: 11.018 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5655592
	speed: 0.6922s/iter; left time: 12313.0894s
	iters: 200, epoch: 15 | loss: 0.2368533
	speed: 0.2864s/iter; left time: 5065.3863s
Epoch: 15 cost time: 61.68336319923401
Epoch: 15, Steps: 208 | Train Loss: 0.381 Vali Loss: 11.675 Vali Acc: 0.082 Test Loss: 11.675 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5146384
	speed: 0.6704s/iter; left time: 11787.1175s
	iters: 200, epoch: 16 | loss: 0.7733248
	speed: 0.3064s/iter; left time: 5356.0490s
Epoch: 16 cost time: 62.28323245048523
Epoch: 16, Steps: 208 | Train Loss: 0.394 Vali Loss: 11.341 Vali Acc: 0.080 Test Loss: 11.341 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1890817
	speed: 0.6863s/iter; left time: 11923.5046s
	iters: 200, epoch: 17 | loss: 0.6107231
	speed: 0.2958s/iter; left time: 5110.0641s
Epoch: 17 cost time: 61.96743869781494
Epoch: 17, Steps: 208 | Train Loss: 0.381 Vali Loss: 12.131 Vali Acc: 0.083 Test Loss: 12.131 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2568291
	speed: 0.6741s/iter; left time: 11571.7666s
	iters: 200, epoch: 18 | loss: 0.0575559
	speed: 0.2820s/iter; left time: 4811.6505s
Epoch: 18 cost time: 58.395543575286865
Epoch: 18, Steps: 208 | Train Loss: 0.373 Vali Loss: 12.180 Vali Acc: 0.083 Test Loss: 12.180 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.0974858
	speed: 0.6697s/iter; left time: 11356.8955s
	iters: 200, epoch: 19 | loss: 0.6002074
	speed: 0.2837s/iter; left time: 4781.6987s
Epoch: 19 cost time: 60.162482500076294
Epoch: 19, Steps: 208 | Train Loss: 0.308 Vali Loss: 12.582 Vali Acc: 0.078 Test Loss: 12.582 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.4448250
	speed: 0.6974s/iter; left time: 11679.9821s
	iters: 200, epoch: 20 | loss: 0.2445535
	speed: 0.3022s/iter; left time: 5031.2805s
Epoch: 20 cost time: 63.796717405319214
Epoch: 20, Steps: 208 | Train Loss: 0.285 Vali Loss: 12.486 Vali Acc: 0.089 Test Loss: 12.486 Test Acc: 0.089
Validation loss decreased (-0.086379 --> -0.089049).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.6414431
	speed: 0.6750s/iter; left time: 11165.9433s
	iters: 200, epoch: 21 | loss: 0.0279359
	speed: 0.2872s/iter; left time: 4721.4168s
Epoch: 21 cost time: 60.34331679344177
Epoch: 21, Steps: 208 | Train Loss: 0.359 Vali Loss: 12.778 Vali Acc: 0.080 Test Loss: 12.778 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0083939
	speed: 0.6813s/iter; left time: 11128.3290s
	iters: 200, epoch: 22 | loss: 0.0022809
	speed: 0.2769s/iter; left time: 4494.4797s
Epoch: 22 cost time: 59.09001851081848
Epoch: 22, Steps: 208 | Train Loss: 0.242 Vali Loss: 13.168 Vali Acc: 0.086 Test Loss: 13.168 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0601730
	speed: 0.6859s/iter; left time: 11059.9060s
	iters: 200, epoch: 23 | loss: 0.6992188
	speed: 0.3022s/iter; left time: 4843.3774s
Epoch: 23 cost time: 62.84317636489868
Epoch: 23, Steps: 208 | Train Loss: 0.300 Vali Loss: 13.416 Vali Acc: 0.081 Test Loss: 13.416 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2484256
	speed: 0.6789s/iter; left time: 10806.4557s
	iters: 200, epoch: 24 | loss: 0.1756555
	speed: 0.3008s/iter; left time: 4757.6358s
Epoch: 24 cost time: 62.81428909301758
Epoch: 24, Steps: 208 | Train Loss: 0.274 Vali Loss: 13.511 Vali Acc: 0.082 Test Loss: 13.511 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0416480
	speed: 0.6890s/iter; left time: 10823.7529s
	iters: 200, epoch: 25 | loss: 0.6330962
	speed: 0.2883s/iter; left time: 4499.8426s
Epoch: 25 cost time: 60.14991092681885
Epoch: 25, Steps: 208 | Train Loss: 0.303 Vali Loss: 13.122 Vali Acc: 0.089 Test Loss: 13.122 Test Acc: 0.089
Validation loss decreased (-0.089049 --> -0.089341).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0426178
	speed: 0.6920s/iter; left time: 10726.1511s
	iters: 200, epoch: 26 | loss: 0.1383139
	speed: 0.2894s/iter; left time: 4456.5620s
Epoch: 26 cost time: 61.3333101272583
Epoch: 26, Steps: 208 | Train Loss: 0.251 Vali Loss: 13.548 Vali Acc: 0.084 Test Loss: 13.548 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.5567700
	speed: 0.6991s/iter; left time: 10691.3870s
	iters: 200, epoch: 27 | loss: 0.1149701
	speed: 0.2955s/iter; left time: 4489.6501s
Epoch: 27 cost time: 62.46380662918091
Epoch: 27, Steps: 208 | Train Loss: 0.268 Vali Loss: 13.450 Vali Acc: 0.085 Test Loss: 13.450 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.2300403
	speed: 0.6569s/iter; left time: 9910.0822s
	iters: 200, epoch: 28 | loss: 0.2049471
	speed: 0.2952s/iter; left time: 4423.0046s
Epoch: 28 cost time: 60.47578525543213
Epoch: 28, Steps: 208 | Train Loss: 0.247 Vali Loss: 13.027 Vali Acc: 0.086 Test Loss: 13.027 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.4378939
	speed: 0.7049s/iter; left time: 10486.4486s
	iters: 200, epoch: 29 | loss: 0.1133671
	speed: 0.2908s/iter; left time: 4296.4484s
Epoch: 29 cost time: 61.47741174697876
Epoch: 29, Steps: 208 | Train Loss: 0.229 Vali Loss: 14.093 Vali Acc: 0.089 Test Loss: 14.093 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0063842
	speed: 0.7083s/iter; left time: 10390.4051s
	iters: 200, epoch: 30 | loss: 0.1183940
	speed: 0.3069s/iter; left time: 4471.8085s
Epoch: 30 cost time: 64.30847835540771
Epoch: 30, Steps: 208 | Train Loss: 0.229 Vali Loss: 13.303 Vali Acc: 0.078 Test Loss: 13.303 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.3650505
	speed: 0.6952s/iter; left time: 10052.8706s
	iters: 200, epoch: 31 | loss: 0.0037535
	speed: 0.2861s/iter; left time: 4108.7137s
Epoch: 31 cost time: 60.1437828540802
Epoch: 31, Steps: 208 | Train Loss: 0.214 Vali Loss: 13.221 Vali Acc: 0.077 Test Loss: 13.221 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0440051
	speed: 0.6433s/iter; left time: 9168.2704s
	iters: 200, epoch: 32 | loss: 0.9824681
	speed: 0.2663s/iter; left time: 3769.5888s
Epoch: 32 cost time: 56.2421395778656
Epoch: 32, Steps: 208 | Train Loss: 0.217 Vali Loss: 13.883 Vali Acc: 0.078 Test Loss: 13.883 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0337607
	speed: 0.7216s/iter; left time: 10135.5256s
	iters: 200, epoch: 33 | loss: 0.0125846
	speed: 0.2887s/iter; left time: 4026.3411s
Epoch: 33 cost time: 62.460811138153076
Epoch: 33, Steps: 208 | Train Loss: 0.229 Vali Loss: 13.566 Vali Acc: 0.076 Test Loss: 13.566 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0523488
	speed: 0.7000s/iter; left time: 9685.6635s
	iters: 200, epoch: 34 | loss: 0.0085833
	speed: 0.2981s/iter; left time: 4094.3150s
Epoch: 34 cost time: 61.332255601882935
Epoch: 34, Steps: 208 | Train Loss: 0.221 Vali Loss: 13.582 Vali Acc: 0.077 Test Loss: 13.582 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.1726770
	speed: 0.6744s/iter; left time: 9191.4135s
	iters: 200, epoch: 35 | loss: 0.6022507
	speed: 0.3107s/iter; left time: 4203.7141s
Epoch: 35 cost time: 62.45397210121155
Epoch: 35, Steps: 208 | Train Loss: 0.178 Vali Loss: 14.162 Vali Acc: 0.081 Test Loss: 14.162 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08947211452430659
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4916577
	speed: 0.3000s/iter; left time: 6209.9658s
	iters: 200, epoch: 1 | loss: 3.8393564
	speed: 0.2918s/iter; left time: 6011.8228s
Epoch: 1 cost time: 61.78312277793884
Epoch: 1, Steps: 208 | Train Loss: 4.270 Vali Loss: 4.266 Vali Acc: 0.075 Test Loss: 4.266 Test Acc: 0.075
Validation loss decreased (inf --> -0.074517).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9648104
	speed: 0.7039s/iter; left time: 14425.7090s
	iters: 200, epoch: 2 | loss: 4.3959608
	speed: 0.2717s/iter; left time: 5541.6350s
Epoch: 2 cost time: 58.800095558166504
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 4.257 Vali Acc: 0.090 Test Loss: 4.257 Test Acc: 0.090
Validation loss decreased (-0.074517 --> -0.090324).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9102225
	speed: 0.6642s/iter; left time: 13473.4936s
	iters: 200, epoch: 3 | loss: 2.4968503
	speed: 0.2771s/iter; left time: 5592.3666s
Epoch: 3 cost time: 58.39202404022217
Epoch: 3, Steps: 208 | Train Loss: 2.901 Vali Loss: 5.237 Vali Acc: 0.083 Test Loss: 5.237 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0604131
	speed: 0.6590s/iter; left time: 13231.3932s
	iters: 200, epoch: 4 | loss: 2.4190807
	speed: 0.3009s/iter; left time: 6012.0520s
Epoch: 4 cost time: 61.712042570114136
Epoch: 4, Steps: 208 | Train Loss: 2.246 Vali Loss: 5.605 Vali Acc: 0.077 Test Loss: 5.605 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4673580
	speed: 0.7008s/iter; left time: 13924.7355s
	iters: 200, epoch: 5 | loss: 2.2534103
	speed: 0.2781s/iter; left time: 5496.8364s
Epoch: 5 cost time: 60.31738471984863
Epoch: 5, Steps: 208 | Train Loss: 1.670 Vali Loss: 6.102 Vali Acc: 0.073 Test Loss: 6.102 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.6686597
	speed: 0.6746s/iter; left time: 13263.9053s
	iters: 200, epoch: 6 | loss: 2.6473501
	speed: 0.2695s/iter; left time: 5272.1154s
Epoch: 6 cost time: 57.81125354766846
Epoch: 6, Steps: 208 | Train Loss: 1.265 Vali Loss: 7.186 Vali Acc: 0.072 Test Loss: 7.186 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.9109999
	speed: 0.6207s/iter; left time: 12074.0266s
	iters: 200, epoch: 7 | loss: 1.9007456
	speed: 0.2802s/iter; left time: 5423.1220s
Epoch: 7 cost time: 57.68146061897278
Epoch: 7, Steps: 208 | Train Loss: 1.053 Vali Loss: 7.685 Vali Acc: 0.080 Test Loss: 7.685 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2832126
	speed: 0.6713s/iter; left time: 12919.9214s
	iters: 200, epoch: 8 | loss: 1.2982525
	speed: 0.2714s/iter; left time: 5196.3527s
Epoch: 8 cost time: 57.3374297618866
Epoch: 8, Steps: 208 | Train Loss: 0.864 Vali Loss: 8.672 Vali Acc: 0.075 Test Loss: 8.672 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.9862829
	speed: 0.6901s/iter; left time: 13137.9073s
	iters: 200, epoch: 9 | loss: 1.0445653
	speed: 0.2954s/iter; left time: 5593.8514s
Epoch: 9 cost time: 62.795530796051025
Epoch: 9, Steps: 208 | Train Loss: 0.770 Vali Loss: 9.229 Vali Acc: 0.076 Test Loss: 9.229 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2803437
	speed: 0.6722s/iter; left time: 12657.4659s
	iters: 200, epoch: 10 | loss: 0.5766101
	speed: 0.3087s/iter; left time: 5782.1788s
Epoch: 10 cost time: 62.25595426559448
Epoch: 10, Steps: 208 | Train Loss: 0.645 Vali Loss: 10.354 Vali Acc: 0.080 Test Loss: 10.354 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0564241
	speed: 0.6749s/iter; left time: 12567.0627s
	iters: 200, epoch: 11 | loss: 0.3120044
	speed: 0.2926s/iter; left time: 5420.0173s
Epoch: 11 cost time: 60.17928409576416
Epoch: 11, Steps: 208 | Train Loss: 0.594 Vali Loss: 10.109 Vali Acc: 0.082 Test Loss: 10.109 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.0058948
	speed: 0.7066s/iter; left time: 13010.8381s
	iters: 200, epoch: 12 | loss: 0.3961295
	speed: 0.2948s/iter; left time: 5397.9659s
Epoch: 12 cost time: 61.9539909362793
Epoch: 12, Steps: 208 | Train Loss: 0.498 Vali Loss: 10.880 Vali Acc: 0.073 Test Loss: 10.880 Test Acc: 0.073
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09036683566954966
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7149067
	speed: 0.3152s/iter; left time: 6524.1956s
	iters: 200, epoch: 1 | loss: 3.8222160
	speed: 0.2994s/iter; left time: 6168.7481s
Epoch: 1 cost time: 64.0199568271637
Epoch: 1, Steps: 208 | Train Loss: 4.248 Vali Loss: 4.259 Vali Acc: 0.072 Test Loss: 4.259 Test Acc: 0.072
Validation loss decreased (inf --> -0.071535).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0132637
	speed: 0.7022s/iter; left time: 14390.9040s
	iters: 200, epoch: 2 | loss: 4.1191254
	speed: 0.3100s/iter; left time: 6321.8525s
Epoch: 2 cost time: 65.18052101135254
Epoch: 2, Steps: 208 | Train Loss: 3.571 Vali Loss: 4.339 Vali Acc: 0.081 Test Loss: 4.339 Test Acc: 0.081
Validation loss decreased (-0.071535 --> -0.081376).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1116877
	speed: 0.7240s/iter; left time: 14687.0777s
	iters: 200, epoch: 3 | loss: 2.9644663
	speed: 0.3139s/iter; left time: 6335.5106s
Epoch: 3 cost time: 65.3843264579773
Epoch: 3, Steps: 208 | Train Loss: 2.857 Vali Loss: 5.218 Vali Acc: 0.080 Test Loss: 5.218 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0015187
	speed: 0.6964s/iter; left time: 13981.4887s
	iters: 200, epoch: 4 | loss: 2.1773350
	speed: 0.3140s/iter; left time: 6273.5198s
Epoch: 4 cost time: 63.98482584953308
Epoch: 4, Steps: 208 | Train Loss: 2.144 Vali Loss: 5.835 Vali Acc: 0.090 Test Loss: 5.835 Test Acc: 0.090
Validation loss decreased (-0.081376 --> -0.090010).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3762926
	speed: 0.7016s/iter; left time: 13940.6059s
	iters: 200, epoch: 5 | loss: 2.4055893
	speed: 0.2950s/iter; left time: 5831.2022s
Epoch: 5 cost time: 62.025190353393555
Epoch: 5, Steps: 208 | Train Loss: 1.653 Vali Loss: 6.415 Vali Acc: 0.085 Test Loss: 6.415 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8915462
	speed: 0.7385s/iter; left time: 14520.5689s
	iters: 200, epoch: 6 | loss: 1.8635587
	speed: 0.2846s/iter; left time: 5566.4087s
Epoch: 6 cost time: 61.34605073928833
Epoch: 6, Steps: 208 | Train Loss: 1.304 Vali Loss: 7.143 Vali Acc: 0.087 Test Loss: 7.143 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8119814
	speed: 0.6939s/iter; left time: 13498.1193s
	iters: 200, epoch: 7 | loss: 1.5223974
	speed: 0.2877s/iter; left time: 5568.0400s
Epoch: 7 cost time: 60.68081021308899
Epoch: 7, Steps: 208 | Train Loss: 1.026 Vali Loss: 7.905 Vali Acc: 0.086 Test Loss: 7.905 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.9333996
	speed: 0.7000s/iter; left time: 13470.8167s
	iters: 200, epoch: 8 | loss: 1.4933357
	speed: 0.2892s/iter; left time: 5537.1033s
Epoch: 8 cost time: 60.2265305519104
Epoch: 8, Steps: 208 | Train Loss: 0.893 Vali Loss: 8.774 Vali Acc: 0.079 Test Loss: 8.774 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.1869088
	speed: 0.7084s/iter; left time: 13485.6266s
	iters: 200, epoch: 9 | loss: 1.3750503
	speed: 0.2975s/iter; left time: 5634.4449s
Epoch: 9 cost time: 62.7593994140625
Epoch: 9, Steps: 208 | Train Loss: 0.764 Vali Loss: 9.045 Vali Acc: 0.080 Test Loss: 9.045 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0452331
	speed: 0.6872s/iter; left time: 12939.4997s
	iters: 200, epoch: 10 | loss: 0.3763291
	speed: 0.2819s/iter; left time: 5280.5554s
Epoch: 10 cost time: 60.02106690406799
Epoch: 10, Steps: 208 | Train Loss: 0.630 Vali Loss: 9.972 Vali Acc: 0.078 Test Loss: 9.972 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1897136
	speed: 0.6656s/iter; left time: 12393.8873s
	iters: 200, epoch: 11 | loss: 1.7164148
	speed: 0.3014s/iter; left time: 5582.2383s
Epoch: 11 cost time: 62.425130128860474
Epoch: 11, Steps: 208 | Train Loss: 0.590 Vali Loss: 10.426 Vali Acc: 0.063 Test Loss: 10.426 Test Acc: 0.063
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2559223
	speed: 0.6977s/iter; left time: 12847.4306s
	iters: 200, epoch: 12 | loss: 0.2530727
	speed: 0.2947s/iter; left time: 5397.7371s
Epoch: 12 cost time: 62.26419115066528
Epoch: 12, Steps: 208 | Train Loss: 0.510 Vali Loss: 11.056 Vali Acc: 0.077 Test Loss: 11.056 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5570433
	speed: 0.6748s/iter; left time: 12283.9917s
	iters: 200, epoch: 13 | loss: 0.4853592
	speed: 0.2925s/iter; left time: 5295.7551s
Epoch: 13 cost time: 62.92954087257385
Epoch: 13, Steps: 208 | Train Loss: 0.484 Vali Loss: 11.432 Vali Acc: 0.076 Test Loss: 11.432 Test Acc: 0.076
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3597734
	speed: 0.6891s/iter; left time: 12402.4736s
	iters: 200, epoch: 14 | loss: 0.7511164
	speed: 0.2990s/iter; left time: 5351.0233s
Epoch: 14 cost time: 62.408379316329956
Epoch: 14, Steps: 208 | Train Loss: 0.429 Vali Loss: 11.014 Vali Acc: 0.077 Test Loss: 11.014 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09006859528780196
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4333997
	speed: 0.3152s/iter; left time: 6525.5655s
	iters: 200, epoch: 1 | loss: 3.6142743
	speed: 0.2956s/iter; left time: 6090.5420s
Epoch: 1 cost time: 63.71577429771423
Epoch: 1, Steps: 208 | Train Loss: 4.166 Vali Loss: 4.728 Vali Acc: 0.063 Test Loss: 4.728 Test Acc: 0.063
Validation loss decreased (inf --> -0.063180).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2192082
	speed: 0.6665s/iter; left time: 13658.9998s
	iters: 200, epoch: 2 | loss: 4.6564603
	speed: 0.2922s/iter; left time: 5959.5966s
Epoch: 2 cost time: 60.8792085647583
Epoch: 2, Steps: 208 | Train Loss: 3.581 Vali Loss: 4.977 Vali Acc: 0.069 Test Loss: 4.977 Test Acc: 0.069
Validation loss decreased (-0.063180 --> -0.069142).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5732067
	speed: 0.7028s/iter; left time: 14256.8660s
	iters: 200, epoch: 3 | loss: 4.0775785
	speed: 0.2963s/iter; left time: 5979.9267s
Epoch: 3 cost time: 63.23369097709656
Epoch: 3, Steps: 208 | Train Loss: 2.892 Vali Loss: 5.812 Vali Acc: 0.071 Test Loss: 5.812 Test Acc: 0.071
Validation loss decreased (-0.069142 --> -0.071221).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2168417
	speed: 0.6840s/iter; left time: 13732.5790s
	iters: 200, epoch: 4 | loss: 1.7036266
	speed: 0.2925s/iter; left time: 5842.7013s
Epoch: 4 cost time: 62.0149941444397
Epoch: 4, Steps: 208 | Train Loss: 2.193 Vali Loss: 6.379 Vali Acc: 0.074 Test Loss: 6.379 Test Acc: 0.074
Validation loss decreased (-0.071221 --> -0.074198).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3770196
	speed: 0.6495s/iter; left time: 12904.2422s
	iters: 200, epoch: 5 | loss: 2.3968580
	speed: 0.2894s/iter; left time: 5721.9129s
Epoch: 5 cost time: 58.6548388004303
Epoch: 5, Steps: 208 | Train Loss: 1.731 Vali Loss: 6.232 Vali Acc: 0.091 Test Loss: 6.232 Test Acc: 0.091
Validation loss decreased (-0.074198 --> -0.090603).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6194800
	speed: 0.6535s/iter; left time: 12848.9131s
	iters: 200, epoch: 6 | loss: 2.3392549
	speed: 0.2935s/iter; left time: 5741.5599s
Epoch: 6 cost time: 59.95935773849487
Epoch: 6, Steps: 208 | Train Loss: 1.379 Vali Loss: 6.986 Vali Acc: 0.072 Test Loss: 6.986 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6864716
	speed: 0.6622s/iter; left time: 12882.4965s
	iters: 200, epoch: 7 | loss: 1.8491611
	speed: 0.2866s/iter; left time: 5547.2318s
Epoch: 7 cost time: 60.05008101463318
Epoch: 7, Steps: 208 | Train Loss: 1.159 Vali Loss: 7.281 Vali Acc: 0.074 Test Loss: 7.281 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9585268
	speed: 0.6873s/iter; left time: 13226.7220s
	iters: 200, epoch: 8 | loss: 1.2899804
	speed: 0.3001s/iter; left time: 5744.9393s
Epoch: 8 cost time: 62.10136890411377
Epoch: 8, Steps: 208 | Train Loss: 0.994 Vali Loss: 8.023 Vali Acc: 0.081 Test Loss: 8.023 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0593759
	speed: 0.7049s/iter; left time: 13420.0978s
	iters: 200, epoch: 9 | loss: 1.1989366
	speed: 0.2829s/iter; left time: 5356.8272s
Epoch: 9 cost time: 59.22442960739136
Epoch: 9, Steps: 208 | Train Loss: 0.927 Vali Loss: 8.570 Vali Acc: 0.080 Test Loss: 8.570 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1040258
	speed: 0.6778s/iter; left time: 12762.5200s
	iters: 200, epoch: 10 | loss: 0.2391793
	speed: 0.2832s/iter; left time: 5303.9472s
Epoch: 10 cost time: 60.229458808898926
Epoch: 10, Steps: 208 | Train Loss: 0.754 Vali Loss: 9.156 Vali Acc: 0.085 Test Loss: 9.156 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.0996124
	speed: 0.6984s/iter; left time: 13005.3424s
	iters: 200, epoch: 11 | loss: 0.8261431
	speed: 0.2903s/iter; left time: 5375.9179s
Epoch: 11 cost time: 61.507951974868774
Epoch: 11, Steps: 208 | Train Loss: 0.689 Vali Loss: 9.448 Vali Acc: 0.087 Test Loss: 9.448 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4247165
	speed: 0.7237s/iter; left time: 13325.7936s
	iters: 200, epoch: 12 | loss: 0.5208777
	speed: 0.2970s/iter; left time: 5438.2293s
Epoch: 12 cost time: 63.848562240600586
Epoch: 12, Steps: 208 | Train Loss: 0.640 Vali Loss: 9.835 Vali Acc: 0.088 Test Loss: 9.835 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6419848
	speed: 0.6948s/iter; left time: 12647.9884s
	iters: 200, epoch: 13 | loss: 0.5590283
	speed: 0.2717s/iter; left time: 4918.7936s
Epoch: 13 cost time: 60.20522093772888
Epoch: 13, Steps: 208 | Train Loss: 0.576 Vali Loss: 9.552 Vali Acc: 0.082 Test Loss: 9.552 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1258422
	speed: 0.6981s/iter; left time: 12562.9349s
	iters: 200, epoch: 14 | loss: 0.1816225
	speed: 0.2889s/iter; left time: 5170.8406s
Epoch: 14 cost time: 62.64569449424744
Epoch: 14, Steps: 208 | Train Loss: 0.523 Vali Loss: 9.834 Vali Acc: 0.088 Test Loss: 9.834 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3662270
	speed: 0.6736s/iter; left time: 11982.7171s
	iters: 200, epoch: 15 | loss: 0.1554331
	speed: 0.3030s/iter; left time: 5360.3737s
Epoch: 15 cost time: 61.76896262168884
Epoch: 15, Steps: 208 | Train Loss: 0.467 Vali Loss: 9.523 Vali Acc: 0.075 Test Loss: 9.523 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09066507605129735
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2211471
	speed: 0.2910s/iter; left time: 6023.1488s
	iters: 200, epoch: 1 | loss: 4.2129736
	speed: 0.2890s/iter; left time: 5953.1120s
Epoch: 1 cost time: 60.73248910903931
Epoch: 1, Steps: 208 | Train Loss: 4.061 Vali Loss: 4.872 Vali Acc: 0.072 Test Loss: 4.872 Test Acc: 0.072
Validation loss decreased (inf --> -0.072125).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5427608
	speed: 0.6816s/iter; left time: 13968.0177s
	iters: 200, epoch: 2 | loss: 3.7322011
	speed: 0.2912s/iter; left time: 5938.5631s
Epoch: 2 cost time: 60.91495704650879
Epoch: 2, Steps: 208 | Train Loss: 3.633 Vali Loss: 5.709 Vali Acc: 0.072 Test Loss: 5.709 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5441322
	speed: 0.6968s/iter; left time: 14134.1098s
	iters: 200, epoch: 3 | loss: 3.4030621
	speed: 0.2958s/iter; left time: 5969.8810s
Epoch: 3 cost time: 63.18911170959473
Epoch: 3, Steps: 208 | Train Loss: 3.135 Vali Loss: 6.346 Vali Acc: 0.085 Test Loss: 6.346 Test Acc: 0.085
Validation loss decreased (-0.072125 --> -0.085233).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9432271
	speed: 0.7115s/iter; left time: 14285.2607s
	iters: 200, epoch: 4 | loss: 2.9969153
	speed: 0.3054s/iter; left time: 6100.4427s
Epoch: 4 cost time: 61.7322564125061
Epoch: 4, Steps: 208 | Train Loss: 2.444 Vali Loss: 6.719 Vali Acc: 0.076 Test Loss: 6.719 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1494186
	speed: 0.7175s/iter; left time: 14256.9590s
	iters: 200, epoch: 5 | loss: 1.8153208
	speed: 0.3129s/iter; left time: 6185.2242s
Epoch: 5 cost time: 64.53803062438965
Epoch: 5, Steps: 208 | Train Loss: 1.982 Vali Loss: 6.454 Vali Acc: 0.079 Test Loss: 6.454 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.8747203
	speed: 0.7084s/iter; left time: 13927.8056s
	iters: 200, epoch: 6 | loss: 1.7046041
	speed: 0.2961s/iter; left time: 5792.4990s
Epoch: 6 cost time: 63.78053116798401
Epoch: 6, Steps: 208 | Train Loss: 1.686 Vali Loss: 6.719 Vali Acc: 0.085 Test Loss: 6.719 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2887615
	speed: 0.7862s/iter; left time: 15294.6104s
	iters: 200, epoch: 7 | loss: 2.2199485
	speed: 0.2985s/iter; left time: 5777.4336s
Epoch: 7 cost time: 66.58318638801575
Epoch: 7, Steps: 208 | Train Loss: 1.400 Vali Loss: 7.336 Vali Acc: 0.077 Test Loss: 7.336 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.2920775
	speed: 0.6817s/iter; left time: 13118.3732s
	iters: 200, epoch: 8 | loss: 1.7828896
	speed: 0.2977s/iter; left time: 5699.3912s
Epoch: 8 cost time: 61.40445017814636
Epoch: 8, Steps: 208 | Train Loss: 1.290 Vali Loss: 7.287 Vali Acc: 0.077 Test Loss: 7.287 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.9373052
	speed: 0.7113s/iter; left time: 13541.5270s
	iters: 200, epoch: 9 | loss: 1.4172993
	speed: 0.2978s/iter; left time: 5638.5052s
Epoch: 9 cost time: 62.81497502326965
Epoch: 9, Steps: 208 | Train Loss: 1.187 Vali Loss: 8.166 Vali Acc: 0.082 Test Loss: 8.166 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.9429392
	speed: 0.7023s/iter; left time: 13222.9394s
	iters: 200, epoch: 10 | loss: 0.3532580
	speed: 0.3058s/iter; left time: 5727.8273s
Epoch: 10 cost time: 62.44550609588623
Epoch: 10, Steps: 208 | Train Loss: 1.014 Vali Loss: 8.558 Vali Acc: 0.078 Test Loss: 8.558 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7166526
	speed: 0.6793s/iter; left time: 12649.7775s
	iters: 200, epoch: 11 | loss: 1.0024803
	speed: 0.2999s/iter; left time: 5555.1368s
Epoch: 11 cost time: 62.80412292480469
Epoch: 11, Steps: 208 | Train Loss: 0.949 Vali Loss: 8.289 Vali Acc: 0.083 Test Loss: 8.289 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7415493
	speed: 0.7027s/iter; left time: 12938.4063s
	iters: 200, epoch: 12 | loss: 1.3648648
	speed: 0.3080s/iter; left time: 5639.5953s
Epoch: 12 cost time: 64.2337441444397
Epoch: 12, Steps: 208 | Train Loss: 0.912 Vali Loss: 8.795 Vali Acc: 0.083 Test Loss: 8.795 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6484892
	speed: 0.7273s/iter; left time: 13239.7449s
	iters: 200, epoch: 13 | loss: 0.5958030
	speed: 0.3077s/iter; left time: 5570.2563s
Epoch: 13 cost time: 65.20711874961853
Epoch: 13, Steps: 208 | Train Loss: 0.805 Vali Loss: 8.066 Vali Acc: 0.076 Test Loss: 8.066 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08529674917983895
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3997574
	speed: 0.3006s/iter; left time: 6222.5710s
	iters: 200, epoch: 1 | loss: 3.9278612
	speed: 0.2752s/iter; left time: 5669.2047s
Epoch: 1 cost time: 60.2538115978241
Epoch: 1, Steps: 208 | Train Loss: 4.026 Vali Loss: 4.954 Vali Acc: 0.068 Test Loss: 4.954 Test Acc: 0.068
Validation loss decreased (inf --> -0.067949).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2089009
	speed: 0.6828s/iter; left time: 13992.3229s
	iters: 200, epoch: 2 | loss: 5.7803063
	speed: 0.2915s/iter; left time: 5943.7628s
Epoch: 2 cost time: 60.721810817718506
Epoch: 2, Steps: 208 | Train Loss: 3.795 Vali Loss: 5.758 Vali Acc: 0.078 Test Loss: 5.758 Test Acc: 0.078
Validation loss decreased (-0.067949 --> -0.077783).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1968777
	speed: 0.6776s/iter; left time: 13744.2890s
	iters: 200, epoch: 3 | loss: 3.9755027
	speed: 0.2868s/iter; left time: 5788.9495s
Epoch: 3 cost time: 59.404885053634644
Epoch: 3, Steps: 208 | Train Loss: 3.527 Vali Loss: 7.158 Vali Acc: 0.080 Test Loss: 7.158 Test Acc: 0.080
Validation loss decreased (-0.077783 --> -0.080155).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5460970
	speed: 0.6865s/iter; left time: 13783.6121s
	iters: 200, epoch: 4 | loss: 2.4084167
	speed: 0.2805s/iter; left time: 5602.7715s
Epoch: 4 cost time: 61.07609820365906
Epoch: 4, Steps: 208 | Train Loss: 3.068 Vali Loss: 7.125 Vali Acc: 0.074 Test Loss: 7.125 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1741452
	speed: 0.6998s/iter; left time: 13903.8371s
	iters: 200, epoch: 5 | loss: 3.0245137
	speed: 0.2981s/iter; left time: 5893.3082s
Epoch: 5 cost time: 61.58630418777466
Epoch: 5, Steps: 208 | Train Loss: 2.615 Vali Loss: 7.413 Vali Acc: 0.076 Test Loss: 7.413 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.9114559
	speed: 0.6845s/iter; left time: 13457.4597s
	iters: 200, epoch: 6 | loss: 2.5775559
	speed: 0.3069s/iter; left time: 6003.5921s
Epoch: 6 cost time: 61.750616788864136
Epoch: 6, Steps: 208 | Train Loss: 2.202 Vali Loss: 7.446 Vali Acc: 0.072 Test Loss: 7.446 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3926528
	speed: 0.7031s/iter; left time: 13676.8215s
	iters: 200, epoch: 7 | loss: 2.3142300
	speed: 0.2907s/iter; left time: 5626.7983s
Epoch: 7 cost time: 62.72730779647827
Epoch: 7, Steps: 208 | Train Loss: 1.734 Vali Loss: 7.387 Vali Acc: 0.072 Test Loss: 7.387 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.9912910
	speed: 0.6950s/iter; left time: 13374.4174s
	iters: 200, epoch: 8 | loss: 2.0041397
	speed: 0.2887s/iter; left time: 5527.1578s
Epoch: 8 cost time: 61.143417835235596
Epoch: 8, Steps: 208 | Train Loss: 1.508 Vali Loss: 7.008 Vali Acc: 0.081 Test Loss: 7.008 Test Acc: 0.081
Validation loss decreased (-0.080155 --> -0.080455).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9069548
	speed: 0.6853s/iter; left time: 13046.6015s
	iters: 200, epoch: 9 | loss: 1.4268425
	speed: 0.3014s/iter; left time: 5707.2162s
Epoch: 9 cost time: 62.06513214111328
Epoch: 9, Steps: 208 | Train Loss: 1.268 Vali Loss: 7.566 Vali Acc: 0.078 Test Loss: 7.566 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4687638
	speed: 0.6870s/iter; left time: 12935.9817s
	iters: 200, epoch: 10 | loss: 0.4913381
	speed: 0.3086s/iter; left time: 5780.1516s
Epoch: 10 cost time: 63.13583564758301
Epoch: 10, Steps: 208 | Train Loss: 1.105 Vali Loss: 7.429 Vali Acc: 0.078 Test Loss: 7.429 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5133771
	speed: 0.7043s/iter; left time: 13114.8679s
	iters: 200, epoch: 11 | loss: 1.2034677
	speed: 0.2939s/iter; left time: 5442.6543s
Epoch: 11 cost time: 61.985636949539185
Epoch: 11, Steps: 208 | Train Loss: 0.970 Vali Loss: 7.691 Vali Acc: 0.076 Test Loss: 7.691 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1103811
	speed: 0.6672s/iter; left time: 12284.7654s
	iters: 200, epoch: 12 | loss: 0.1440469
	speed: 0.2892s/iter; left time: 5295.6146s
Epoch: 12 cost time: 61.02234220504761
Epoch: 12, Steps: 208 | Train Loss: 0.788 Vali Loss: 8.424 Vali Acc: 0.075 Test Loss: 8.424 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2934148
	speed: 0.6861s/iter; left time: 12490.6516s
	iters: 200, epoch: 13 | loss: 1.2830572
	speed: 0.2960s/iter; left time: 5359.8289s
Epoch: 13 cost time: 62.282087087631226
Epoch: 13, Steps: 208 | Train Loss: 0.743 Vali Loss: 8.177 Vali Acc: 0.077 Test Loss: 8.177 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7324888
	speed: 0.7048s/iter; left time: 12684.4060s
	iters: 200, epoch: 14 | loss: 0.3250315
	speed: 0.2904s/iter; left time: 5197.9609s
Epoch: 14 cost time: 61.26266264915466
Epoch: 14, Steps: 208 | Train Loss: 0.654 Vali Loss: 8.673 Vali Acc: 0.081 Test Loss: 8.673 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2436045
	speed: 0.6734s/iter; left time: 11979.7331s
	iters: 200, epoch: 15 | loss: 0.8323355
	speed: 0.2990s/iter; left time: 5288.7707s
Epoch: 15 cost time: 62.011955976486206
Epoch: 15, Steps: 208 | Train Loss: 0.581 Vali Loss: 9.014 Vali Acc: 0.078 Test Loss: 9.014 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.5654168
	speed: 0.6827s/iter; left time: 12003.2696s
	iters: 200, epoch: 16 | loss: 1.0412250
	speed: 0.2823s/iter; left time: 4934.6741s
Epoch: 16 cost time: 59.914618492126465
Epoch: 16, Steps: 208 | Train Loss: 0.553 Vali Loss: 9.229 Vali Acc: 0.071 Test Loss: 9.229 Test Acc: 0.071
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.5661983
	speed: 0.7324s/iter; left time: 12723.7992s
	iters: 200, epoch: 17 | loss: 0.7718587
	speed: 0.2932s/iter; left time: 5063.6394s
Epoch: 17 cost time: 63.388569355010986
Epoch: 17, Steps: 208 | Train Loss: 0.541 Vali Loss: 8.901 Vali Acc: 0.075 Test Loss: 8.901 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3940780
	speed: 0.6671s/iter; left time: 11450.3704s
	iters: 200, epoch: 18 | loss: 0.9168019
	speed: 0.2890s/iter; left time: 4932.1988s
Epoch: 18 cost time: 60.87588167190552
Epoch: 18, Steps: 208 | Train Loss: 0.500 Vali Loss: 9.268 Vali Acc: 0.070 Test Loss: 9.268 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08052490307187593
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2808805
	speed: 0.3077s/iter; left time: 6369.6700s
	iters: 200, epoch: 1 | loss: 3.7025251
	speed: 0.2856s/iter; left time: 5882.8329s
Epoch: 1 cost time: 61.71847200393677
Epoch: 1, Steps: 208 | Train Loss: 4.011 Vali Loss: 5.557 Vali Acc: 0.044 Test Loss: 5.557 Test Acc: 0.044
Validation loss decreased (inf --> -0.044382).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8262496
	speed: 0.6952s/iter; left time: 14246.3134s
	iters: 200, epoch: 2 | loss: 5.2617898
	speed: 0.2973s/iter; left time: 6062.8577s
Epoch: 2 cost time: 62.78928184509277
Epoch: 2, Steps: 208 | Train Loss: 3.861 Vali Loss: 6.128 Vali Acc: 0.043 Test Loss: 6.128 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.2229257
	speed: 0.6868s/iter; left time: 13931.3656s
	iters: 200, epoch: 3 | loss: 3.5340002
	speed: 0.2881s/iter; left time: 5815.8166s
Epoch: 3 cost time: 61.16236615180969
Epoch: 3, Steps: 208 | Train Loss: 3.678 Vali Loss: 6.834 Vali Acc: 0.047 Test Loss: 6.834 Test Acc: 0.047
Validation loss decreased (-0.044382 --> -0.046755).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1954315
	speed: 0.6987s/iter; left time: 14027.7537s
	iters: 200, epoch: 4 | loss: 3.1277556
	speed: 0.2926s/iter; left time: 5844.6274s
Epoch: 4 cost time: 61.20002579689026
Epoch: 4, Steps: 208 | Train Loss: 3.285 Vali Loss: 6.139 Vali Acc: 0.065 Test Loss: 6.139 Test Acc: 0.065
Validation loss decreased (-0.046755 --> -0.065253).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4395590
	speed: 0.6662s/iter; left time: 13237.1894s
	iters: 200, epoch: 5 | loss: 2.7310214
	speed: 0.3031s/iter; left time: 5991.4272s
Epoch: 5 cost time: 62.72320866584778
Epoch: 5, Steps: 208 | Train Loss: 2.792 Vali Loss: 5.819 Vali Acc: 0.055 Test Loss: 5.819 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8146284
	speed: 0.6921s/iter; left time: 13607.9087s
	iters: 200, epoch: 6 | loss: 2.8024607
	speed: 0.2989s/iter; left time: 5846.0266s
Epoch: 6 cost time: 62.12547850608826
Epoch: 6, Steps: 208 | Train Loss: 2.352 Vali Loss: 5.696 Vali Acc: 0.058 Test Loss: 5.696 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4039307
	speed: 0.6974s/iter; left time: 13566.4451s
	iters: 200, epoch: 7 | loss: 2.8707292
	speed: 0.2846s/iter; left time: 5508.1785s
Epoch: 7 cost time: 60.767937660217285
Epoch: 7, Steps: 208 | Train Loss: 1.882 Vali Loss: 6.204 Vali Acc: 0.061 Test Loss: 6.204 Test Acc: 0.061
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6163006
	speed: 0.6690s/iter; left time: 12874.0554s
	iters: 200, epoch: 8 | loss: 2.0979075
	speed: 0.3049s/iter; left time: 5837.1012s
Epoch: 8 cost time: 63.52659630775452
Epoch: 8, Steps: 208 | Train Loss: 1.649 Vali Loss: 6.266 Vali Acc: 0.063 Test Loss: 6.266 Test Acc: 0.063
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6882277
	speed: 0.6992s/iter; left time: 13311.2247s
	iters: 200, epoch: 9 | loss: 1.7230669
	speed: 0.2980s/iter; left time: 5644.0825s
Epoch: 9 cost time: 61.95121216773987
Epoch: 9, Steps: 208 | Train Loss: 1.384 Vali Loss: 6.488 Vali Acc: 0.066 Test Loss: 6.488 Test Acc: 0.066
Validation loss decreased (-0.065253 --> -0.065846).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7947844
	speed: 0.6780s/iter; left time: 12765.8634s
	iters: 200, epoch: 10 | loss: 0.3943469
	speed: 0.2918s/iter; left time: 5464.6111s
Epoch: 10 cost time: 60.46486783027649
Epoch: 10, Steps: 208 | Train Loss: 1.128 Vali Loss: 7.375 Vali Acc: 0.067 Test Loss: 7.375 Test Acc: 0.067
Validation loss decreased (-0.065846 --> -0.067329).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4842622
	speed: 0.6761s/iter; left time: 12589.5415s
	iters: 200, epoch: 11 | loss: 2.4107480
	speed: 0.2863s/iter; left time: 5302.9004s
Epoch: 11 cost time: 60.045875549316406
Epoch: 11, Steps: 208 | Train Loss: 1.019 Vali Loss: 7.217 Vali Acc: 0.065 Test Loss: 7.217 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7279524
	speed: 0.6676s/iter; left time: 12292.2676s
	iters: 200, epoch: 12 | loss: 0.3275899
	speed: 0.2756s/iter; left time: 5046.8355s
Epoch: 12 cost time: 58.79330348968506
Epoch: 12, Steps: 208 | Train Loss: 0.868 Vali Loss: 7.877 Vali Acc: 0.072 Test Loss: 7.877 Test Acc: 0.072
Validation loss decreased (-0.067329 --> -0.072095).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0164704
	speed: 0.6372s/iter; left time: 11600.9201s
	iters: 200, epoch: 13 | loss: 0.5962766
	speed: 0.2802s/iter; left time: 5073.0118s
Epoch: 13 cost time: 57.41403841972351
Epoch: 13, Steps: 208 | Train Loss: 0.813 Vali Loss: 7.761 Vali Acc: 0.068 Test Loss: 7.761 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2889915
	speed: 0.6568s/iter; left time: 11821.2318s
	iters: 200, epoch: 14 | loss: 0.1903719
	speed: 0.2664s/iter; left time: 4767.5979s
Epoch: 14 cost time: 56.97582674026489
Epoch: 14, Steps: 208 | Train Loss: 0.723 Vali Loss: 7.737 Vali Acc: 0.075 Test Loss: 7.737 Test Acc: 0.075
Validation loss decreased (-0.072095 --> -0.075079).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2108204
	speed: 0.6313s/iter; left time: 11230.6064s
	iters: 200, epoch: 15 | loss: 0.4072948
	speed: 0.2688s/iter; left time: 4755.2335s
Epoch: 15 cost time: 56.71150255203247
Epoch: 15, Steps: 208 | Train Loss: 0.663 Vali Loss: 8.079 Vali Acc: 0.065 Test Loss: 8.079 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4325642
	speed: 0.6623s/iter; left time: 11644.6033s
	iters: 200, epoch: 16 | loss: 1.0101417
	speed: 0.2797s/iter; left time: 4890.2043s
Epoch: 16 cost time: 59.524020195007324
Epoch: 16, Steps: 208 | Train Loss: 0.648 Vali Loss: 8.236 Vali Acc: 0.066 Test Loss: 8.236 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0733863
	speed: 0.6637s/iter; left time: 11530.9471s
	iters: 200, epoch: 17 | loss: 1.3260884
	speed: 0.2720s/iter; left time: 4698.3437s
Epoch: 17 cost time: 57.440746545791626
Epoch: 17, Steps: 208 | Train Loss: 0.600 Vali Loss: 8.480 Vali Acc: 0.079 Test Loss: 8.480 Test Acc: 0.079
Validation loss decreased (-0.075079 --> -0.078651).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1946380
	speed: 0.6456s/iter; left time: 11081.0688s
	iters: 200, epoch: 18 | loss: 0.7832358
	speed: 0.2726s/iter; left time: 4651.1886s
Epoch: 18 cost time: 57.68057870864868
Epoch: 18, Steps: 208 | Train Loss: 0.528 Vali Loss: 8.967 Vali Acc: 0.078 Test Loss: 8.967 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.3753304
	speed: 0.7175s/iter; left time: 12167.4257s
	iters: 200, epoch: 19 | loss: 0.3932523
	speed: 0.2860s/iter; left time: 4820.8206s
Epoch: 19 cost time: 61.89153575897217
Epoch: 19, Steps: 208 | Train Loss: 0.492 Vali Loss: 8.662 Vali Acc: 0.081 Test Loss: 8.662 Test Acc: 0.081
Validation loss decreased (-0.078651 --> -0.080438).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3664375
	speed: 0.6746s/iter; left time: 11298.8491s
	iters: 200, epoch: 20 | loss: 0.9530392
	speed: 0.2799s/iter; left time: 4660.1683s
Epoch: 20 cost time: 59.41001105308533
Epoch: 20, Steps: 208 | Train Loss: 0.497 Vali Loss: 8.628 Vali Acc: 0.075 Test Loss: 8.628 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.5753415
	speed: 0.6553s/iter; left time: 10840.0623s
	iters: 200, epoch: 21 | loss: 1.1418149
	speed: 0.2649s/iter; left time: 4355.4057s
Epoch: 21 cost time: 55.67349076271057
Epoch: 21, Steps: 208 | Train Loss: 0.476 Vali Loss: 8.950 Vali Acc: 0.072 Test Loss: 8.950 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2456484
	speed: 0.6611s/iter; left time: 10797.0658s
	iters: 200, epoch: 22 | loss: 1.0406781
	speed: 0.2796s/iter; left time: 4538.5391s
Epoch: 22 cost time: 58.624815940856934
Epoch: 22, Steps: 208 | Train Loss: 0.419 Vali Loss: 9.010 Vali Acc: 0.078 Test Loss: 9.010 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5871196
	speed: 0.6604s/iter; left time: 10648.8310s
	iters: 200, epoch: 23 | loss: 0.7125708
	speed: 0.2792s/iter; left time: 4474.0972s
Epoch: 23 cost time: 59.21704363822937
Epoch: 23, Steps: 208 | Train Loss: 0.438 Vali Loss: 9.544 Vali Acc: 0.071 Test Loss: 9.544 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.5596319
	speed: 0.6926s/iter; left time: 11024.0797s
	iters: 200, epoch: 24 | loss: 1.0193889
	speed: 0.2863s/iter; left time: 4528.3773s
Epoch: 24 cost time: 61.520986795425415
Epoch: 24, Steps: 208 | Train Loss: 0.404 Vali Loss: 9.684 Vali Acc: 0.067 Test Loss: 9.684 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0985954
	speed: 0.6659s/iter; left time: 10461.3639s
	iters: 200, epoch: 25 | loss: 0.3496723
	speed: 0.2976s/iter; left time: 4645.4951s
Epoch: 25 cost time: 61.23006343841553
Epoch: 25, Steps: 208 | Train Loss: 0.369 Vali Loss: 9.636 Vali Acc: 0.075 Test Loss: 9.636 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1712870
	speed: 0.6944s/iter; left time: 10763.3031s
	iters: 200, epoch: 26 | loss: 0.3726489
	speed: 0.2951s/iter; left time: 4544.4548s
Epoch: 26 cost time: 61.43904256820679
Epoch: 26, Steps: 208 | Train Loss: 0.361 Vali Loss: 9.725 Vali Acc: 0.066 Test Loss: 9.725 Test Acc: 0.066
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.1883228
	speed: 0.7006s/iter; left time: 10714.1361s
	iters: 200, epoch: 27 | loss: 0.1886159
	speed: 0.2930s/iter; left time: 4451.6323s
Epoch: 27 cost time: 62.96749401092529
Epoch: 27, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.692 Vali Acc: 0.077 Test Loss: 9.692 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1738313
	speed: 0.6739s/iter; left time: 10165.3985s
	iters: 200, epoch: 28 | loss: 0.2951781
	speed: 0.2976s/iter; left time: 4459.5195s
Epoch: 28 cost time: 60.77386665344238
Epoch: 28, Steps: 208 | Train Loss: 0.358 Vali Loss: 9.846 Vali Acc: 0.074 Test Loss: 9.846 Test Acc: 0.074
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.7823030
	speed: 0.6980s/iter; left time: 10384.2892s
	iters: 200, epoch: 29 | loss: 0.2511248
	speed: 0.2992s/iter; left time: 4421.0609s
Epoch: 29 cost time: 62.33253788948059
Epoch: 29, Steps: 208 | Train Loss: 0.341 Vali Loss: 10.415 Vali Acc: 0.076 Test Loss: 10.415 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08052490307187593
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5264573
	speed: 0.3201s/iter; left time: 6626.5468s
	iters: 200, epoch: 1 | loss: 3.9207573
	speed: 0.2961s/iter; left time: 6098.9680s
Epoch: 1 cost time: 64.2045750617981
Epoch: 1, Steps: 208 | Train Loss: 3.927 Vali Loss: 6.554 Vali Acc: 0.035 Test Loss: 6.554 Test Acc: 0.035
Validation loss decreased (inf --> -0.034530).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7589724
	speed: 0.6664s/iter; left time: 13656.7481s
	iters: 200, epoch: 2 | loss: 4.4262052
	speed: 0.2955s/iter; left time: 6025.1512s
Epoch: 2 cost time: 61.35611915588379
Epoch: 2, Steps: 208 | Train Loss: 3.907 Vali Loss: 6.832 Vali Acc: 0.041 Test Loss: 6.832 Test Acc: 0.041
Validation loss decreased (-0.034530 --> -0.040791).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2095857
	speed: 0.7201s/iter; left time: 14607.6672s
	iters: 200, epoch: 3 | loss: 3.6217449
	speed: 0.2864s/iter; left time: 5781.7350s
Epoch: 3 cost time: 62.13343834877014
Epoch: 3, Steps: 208 | Train Loss: 3.885 Vali Loss: 7.473 Vali Acc: 0.042 Test Loss: 7.473 Test Acc: 0.042
Validation loss decreased (-0.040791 --> -0.041977).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.5532031
	speed: 0.7050s/iter; left time: 14154.5057s
	iters: 200, epoch: 4 | loss: 4.3995976
	speed: 0.2885s/iter; left time: 5763.2619s
Epoch: 4 cost time: 61.757110595703125
Epoch: 4, Steps: 208 | Train Loss: 3.748 Vali Loss: 6.140 Vali Acc: 0.053 Test Loss: 6.140 Test Acc: 0.053
Validation loss decreased (-0.041977 --> -0.053025).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7973359
	speed: 0.6772s/iter; left time: 13454.9718s
	iters: 200, epoch: 5 | loss: 3.4793050
	speed: 0.2836s/iter; left time: 5607.0622s
Epoch: 5 cost time: 60.23616552352905
Epoch: 5, Steps: 208 | Train Loss: 3.322 Vali Loss: 5.329 Vali Acc: 0.053 Test Loss: 5.329 Test Acc: 0.053
Validation loss decreased (-0.053025 --> -0.053332).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2376158
	speed: 0.6803s/iter; left time: 13374.9114s
	iters: 200, epoch: 6 | loss: 3.3238018
	speed: 0.3018s/iter; left time: 5903.2031s
Epoch: 6 cost time: 62.90674948692322
Epoch: 6, Steps: 208 | Train Loss: 2.976 Vali Loss: 4.821 Vali Acc: 0.054 Test Loss: 4.821 Test Acc: 0.054
Validation loss decreased (-0.053332 --> -0.053635).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.6183481
	speed: 0.7003s/iter; left time: 13623.1178s
	iters: 200, epoch: 7 | loss: 3.0048344
	speed: 0.2962s/iter; left time: 5732.2451s
Epoch: 7 cost time: 62.17611622810364
Epoch: 7, Steps: 208 | Train Loss: 2.660 Vali Loss: 5.002 Vali Acc: 0.062 Test Loss: 5.002 Test Acc: 0.062
Validation loss decreased (-0.053635 --> -0.061984).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7265686
	speed: 0.7160s/iter; left time: 13779.8935s
	iters: 200, epoch: 8 | loss: 3.1396720
	speed: 0.2921s/iter; left time: 5591.7543s
Epoch: 8 cost time: 61.86888670921326
Epoch: 8, Steps: 208 | Train Loss: 2.265 Vali Loss: 5.096 Vali Acc: 0.068 Test Loss: 5.096 Test Acc: 0.068
Validation loss decreased (-0.061984 --> -0.067650).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2609372
	speed: 0.6766s/iter; left time: 12880.9043s
	iters: 200, epoch: 9 | loss: 1.5647494
	speed: 0.2923s/iter; left time: 5535.9091s
Epoch: 9 cost time: 61.04528260231018
Epoch: 9, Steps: 208 | Train Loss: 1.922 Vali Loss: 5.409 Vali Acc: 0.065 Test Loss: 5.409 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4132494
	speed: 0.6807s/iter; left time: 12817.1125s
	iters: 200, epoch: 10 | loss: 1.4406399
	speed: 0.3019s/iter; left time: 5654.9700s
Epoch: 10 cost time: 62.40320444107056
Epoch: 10, Steps: 208 | Train Loss: 1.551 Vali Loss: 5.988 Vali Acc: 0.066 Test Loss: 5.988 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6314331
	speed: 0.6849s/iter; left time: 12753.6411s
	iters: 200, epoch: 11 | loss: 1.2056473
	speed: 0.2859s/iter; left time: 5295.1877s
Epoch: 11 cost time: 59.79971408843994
Epoch: 11, Steps: 208 | Train Loss: 1.342 Vali Loss: 6.533 Vali Acc: 0.070 Test Loss: 6.533 Test Acc: 0.070
Validation loss decreased (-0.067650 --> -0.069723).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5093292
	speed: 0.6918s/iter; left time: 12738.6712s
	iters: 200, epoch: 12 | loss: 0.9331930
	speed: 0.2939s/iter; left time: 5381.4538s
Epoch: 12 cost time: 62.56951832771301
Epoch: 12, Steps: 208 | Train Loss: 1.146 Vali Loss: 6.594 Vali Acc: 0.069 Test Loss: 6.594 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7846124
	speed: 0.6880s/iter; left time: 12524.4740s
	iters: 200, epoch: 13 | loss: 0.5892357
	speed: 0.2910s/iter; left time: 5268.9595s
Epoch: 13 cost time: 60.4807391166687
Epoch: 13, Steps: 208 | Train Loss: 0.976 Vali Loss: 6.833 Vali Acc: 0.069 Test Loss: 6.833 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3389378
	speed: 0.6835s/iter; left time: 12301.7657s
	iters: 200, epoch: 14 | loss: 0.2155733
	speed: 0.2907s/iter; left time: 5203.3862s
Epoch: 14 cost time: 61.42837858200073
Epoch: 14, Steps: 208 | Train Loss: 0.889 Vali Loss: 6.939 Vali Acc: 0.082 Test Loss: 6.939 Test Acc: 0.082
Validation loss decreased (-0.069723 --> -0.082245).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0110340
	speed: 0.6867s/iter; left time: 12215.5462s
	iters: 200, epoch: 15 | loss: 0.9599717
	speed: 0.2882s/iter; left time: 5097.2037s
Epoch: 15 cost time: 60.36938166618347
Epoch: 15, Steps: 208 | Train Loss: 0.835 Vali Loss: 7.171 Vali Acc: 0.075 Test Loss: 7.171 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5339195
	speed: 0.6780s/iter; left time: 11919.6003s
	iters: 200, epoch: 16 | loss: 1.0409132
	speed: 0.2909s/iter; left time: 5085.0952s
Epoch: 16 cost time: 61.65203666687012
Epoch: 16, Steps: 208 | Train Loss: 0.723 Vali Loss: 7.186 Vali Acc: 0.074 Test Loss: 7.186 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4780297
	speed: 0.6739s/iter; left time: 11707.3436s
	iters: 200, epoch: 17 | loss: 1.5189192
	speed: 0.2928s/iter; left time: 5057.9315s
Epoch: 17 cost time: 60.54240417480469
Epoch: 17, Steps: 208 | Train Loss: 0.661 Vali Loss: 7.559 Vali Acc: 0.075 Test Loss: 7.559 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1580203
	speed: 0.6739s/iter; left time: 11567.3026s
	iters: 200, epoch: 18 | loss: 0.4113484
	speed: 0.2927s/iter; left time: 4995.0352s
Epoch: 18 cost time: 58.88113522529602
Epoch: 18, Steps: 208 | Train Loss: 0.626 Vali Loss: 7.772 Vali Acc: 0.080 Test Loss: 7.772 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.4423610
	speed: 0.6909s/iter; left time: 11714.8688s
	iters: 200, epoch: 19 | loss: 0.3828018
	speed: 0.2852s/iter; left time: 4808.1777s
Epoch: 19 cost time: 60.1457998752594
Epoch: 19, Steps: 208 | Train Loss: 0.560 Vali Loss: 7.696 Vali Acc: 0.077 Test Loss: 7.696 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6918869
	speed: 0.6856s/iter; left time: 11482.9290s
	iters: 200, epoch: 20 | loss: 0.7951770
	speed: 0.2944s/iter; left time: 4900.9896s
Epoch: 20 cost time: 62.19877076148987
Epoch: 20, Steps: 208 | Train Loss: 0.552 Vali Loss: 8.431 Vali Acc: 0.068 Test Loss: 8.431 Test Acc: 0.068
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4304700
	speed: 0.6673s/iter; left time: 11038.3965s
	iters: 200, epoch: 21 | loss: 0.6727167
	speed: 0.2950s/iter; left time: 4849.6166s
Epoch: 21 cost time: 60.84194278717041
Epoch: 21, Steps: 208 | Train Loss: 0.534 Vali Loss: 8.261 Vali Acc: 0.076 Test Loss: 8.261 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.5766199
	speed: 0.6617s/iter; left time: 10807.6206s
	iters: 200, epoch: 22 | loss: 0.9064803
	speed: 0.2785s/iter; left time: 4521.3930s
Epoch: 22 cost time: 57.66664004325867
Epoch: 22, Steps: 208 | Train Loss: 0.464 Vali Loss: 8.477 Vali Acc: 0.068 Test Loss: 8.477 Test Acc: 0.068
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3803819
	speed: 0.6759s/iter; left time: 10899.5178s
	iters: 200, epoch: 23 | loss: 0.4643624
	speed: 0.2819s/iter; left time: 4517.3354s
Epoch: 23 cost time: 60.39105796813965
Epoch: 23, Steps: 208 | Train Loss: 0.476 Vali Loss: 8.325 Vali Acc: 0.077 Test Loss: 8.325 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1825949
	speed: 0.6628s/iter; left time: 10549.1553s
	iters: 200, epoch: 24 | loss: 0.5722672
	speed: 0.2902s/iter; left time: 4590.1519s
Epoch: 24 cost time: 60.804906606674194
Epoch: 24, Steps: 208 | Train Loss: 0.468 Vali Loss: 8.616 Vali Acc: 0.070 Test Loss: 8.616 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08231434536236207
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2925582
	speed: 0.2906s/iter; left time: 6014.6930s
	iters: 200, epoch: 1 | loss: 3.9982433
	speed: 0.2882s/iter; left time: 5937.1671s
Epoch: 1 cost time: 60.2308714389801
Epoch: 1, Steps: 208 | Train Loss: 3.879 Vali Loss: 5.790 Vali Acc: 0.040 Test Loss: 5.790 Test Acc: 0.040
Validation loss decreased (inf --> -0.039906).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9275150
	speed: 0.6306s/iter; left time: 12922.4968s
	iters: 200, epoch: 2 | loss: 4.3901758
	speed: 0.2669s/iter; left time: 5442.5452s
Epoch: 2 cost time: 55.22372031211853
Epoch: 2, Steps: 208 | Train Loss: 3.689 Vali Loss: 6.558 Vali Acc: 0.048 Test Loss: 6.558 Test Acc: 0.048
Validation loss decreased (-0.039906 --> -0.047653).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1713133
	speed: 0.6493s/iter; left time: 13170.3724s
	iters: 200, epoch: 3 | loss: 3.4368904
	speed: 0.2812s/iter; left time: 5675.4320s
Epoch: 3 cost time: 58.88661003112793
Epoch: 3, Steps: 208 | Train Loss: 3.641 Vali Loss: 8.076 Vali Acc: 0.046 Test Loss: 8.076 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.1013279
	speed: 0.6579s/iter; left time: 13209.5366s
	iters: 200, epoch: 4 | loss: 3.9705527
	speed: 0.2847s/iter; left time: 5687.0454s
Epoch: 4 cost time: 59.63201975822449
Epoch: 4, Steps: 208 | Train Loss: 3.435 Vali Loss: 7.409 Vali Acc: 0.055 Test Loss: 7.409 Test Acc: 0.055
Validation loss decreased (-0.047653 --> -0.054504).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8627365
	speed: 0.6571s/iter; left time: 13056.2148s
	iters: 200, epoch: 5 | loss: 3.1224866
	speed: 0.2678s/iter; left time: 5294.2134s
Epoch: 5 cost time: 56.44746923446655
Epoch: 5, Steps: 208 | Train Loss: 3.115 Vali Loss: 7.049 Vali Acc: 0.063 Test Loss: 7.049 Test Acc: 0.063
Validation loss decreased (-0.054504 --> -0.062560).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8675005
	speed: 0.6521s/iter; left time: 12820.4630s
	iters: 200, epoch: 6 | loss: 1.9320960
	speed: 0.2708s/iter; left time: 5296.3440s
Epoch: 6 cost time: 57.659844398498535
Epoch: 6, Steps: 208 | Train Loss: 2.644 Vali Loss: 6.843 Vali Acc: 0.051 Test Loss: 6.843 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1474988
	speed: 0.6777s/iter; left time: 13183.0970s
	iters: 200, epoch: 7 | loss: 2.6669409
	speed: 0.2852s/iter; left time: 5518.7890s
Epoch: 7 cost time: 60.67540907859802
Epoch: 7, Steps: 208 | Train Loss: 2.210 Vali Loss: 6.277 Vali Acc: 0.062 Test Loss: 6.277 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7679950
	speed: 0.6603s/iter; left time: 12707.7147s
	iters: 200, epoch: 8 | loss: 3.7112913
	speed: 0.2723s/iter; left time: 5214.0551s
Epoch: 8 cost time: 57.66961431503296
Epoch: 8, Steps: 208 | Train Loss: 1.787 Vali Loss: 6.607 Vali Acc: 0.062 Test Loss: 6.607 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0003303
	speed: 0.6365s/iter; left time: 12117.1373s
	iters: 200, epoch: 9 | loss: 2.2380705
	speed: 0.2619s/iter; left time: 4959.3740s
Epoch: 9 cost time: 56.23437452316284
Epoch: 9, Steps: 208 | Train Loss: 1.525 Vali Loss: 6.392 Vali Acc: 0.071 Test Loss: 6.392 Test Acc: 0.071
Validation loss decreased (-0.062560 --> -0.070619).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7955164
	speed: 0.6248s/iter; left time: 11765.0933s
	iters: 200, epoch: 10 | loss: 0.5572240
	speed: 0.2784s/iter; left time: 5213.3889s
Epoch: 10 cost time: 57.386887550354004
Epoch: 10, Steps: 208 | Train Loss: 1.204 Vali Loss: 6.851 Vali Acc: 0.076 Test Loss: 6.851 Test Acc: 0.076
Validation loss decreased (-0.070619 --> -0.075685).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0854820
	speed: 0.6534s/iter; left time: 12166.6245s
	iters: 200, epoch: 11 | loss: 1.7799667
	speed: 0.2762s/iter; left time: 5115.3377s
Epoch: 11 cost time: 57.97922968864441
Epoch: 11, Steps: 208 | Train Loss: 1.118 Vali Loss: 7.272 Vali Acc: 0.065 Test Loss: 7.272 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8423330
	speed: 0.6484s/iter; left time: 11938.5482s
	iters: 200, epoch: 12 | loss: 0.9086021
	speed: 0.2630s/iter; left time: 4815.6487s
Epoch: 12 cost time: 56.09274506568909
Epoch: 12, Steps: 208 | Train Loss: 0.885 Vali Loss: 8.118 Vali Acc: 0.060 Test Loss: 8.118 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7583411
	speed: 0.6587s/iter; left time: 11992.4816s
	iters: 200, epoch: 13 | loss: 1.0375466
	speed: 0.3053s/iter; left time: 5527.0743s
Epoch: 13 cost time: 63.039271116256714
Epoch: 13, Steps: 208 | Train Loss: 0.797 Vali Loss: 8.225 Vali Acc: 0.059 Test Loss: 8.225 Test Acc: 0.059
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.3115233
	speed: 0.6606s/iter; left time: 11888.9391s
	iters: 200, epoch: 14 | loss: 0.4791566
	speed: 0.3110s/iter; left time: 5565.8808s
Epoch: 14 cost time: 62.21017050743103
Epoch: 14, Steps: 208 | Train Loss: 0.709 Vali Loss: 8.550 Vali Acc: 0.078 Test Loss: 8.550 Test Acc: 0.078
Validation loss decreased (-0.075685 --> -0.078053).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2163891
	speed: 0.6924s/iter; left time: 12316.8028s
	iters: 200, epoch: 15 | loss: 0.6561919
	speed: 0.2787s/iter; left time: 4929.9401s
Epoch: 15 cost time: 59.282506227493286
Epoch: 15, Steps: 208 | Train Loss: 0.659 Vali Loss: 8.606 Vali Acc: 0.069 Test Loss: 8.606 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1513464
	speed: 0.6862s/iter; left time: 12064.9294s
	iters: 200, epoch: 16 | loss: 1.5601833
	speed: 0.2935s/iter; left time: 5129.9490s
Epoch: 16 cost time: 61.854867696762085
Epoch: 16, Steps: 208 | Train Loss: 0.609 Vali Loss: 9.425 Vali Acc: 0.069 Test Loss: 9.425 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3239254
	speed: 0.6819s/iter; left time: 11846.1604s
	iters: 200, epoch: 17 | loss: 1.3664566
	speed: 0.2885s/iter; left time: 4982.7395s
Epoch: 17 cost time: 61.92075252532959
Epoch: 17, Steps: 208 | Train Loss: 0.565 Vali Loss: 9.155 Vali Acc: 0.072 Test Loss: 9.155 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3842126
	speed: 0.6755s/iter; left time: 11594.6676s
	iters: 200, epoch: 18 | loss: 1.0767163
	speed: 0.2989s/iter; left time: 5100.9292s
Epoch: 18 cost time: 61.846359729766846
Epoch: 18, Steps: 208 | Train Loss: 0.503 Vali Loss: 9.358 Vali Acc: 0.069 Test Loss: 9.358 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1792786
	speed: 0.6925s/iter; left time: 11742.4162s
	iters: 200, epoch: 19 | loss: 0.5970069
	speed: 0.2937s/iter; left time: 4950.8369s
Epoch: 19 cost time: 61.543519735336304
Epoch: 19, Steps: 208 | Train Loss: 0.472 Vali Loss: 9.363 Vali Acc: 0.070 Test Loss: 9.363 Test Acc: 0.070
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.4755211
	speed: 0.7155s/iter; left time: 11983.2795s
	iters: 200, epoch: 20 | loss: 0.4445194
	speed: 0.2829s/iter; left time: 4710.1310s
Epoch: 20 cost time: 62.449339866638184
Epoch: 20, Steps: 208 | Train Loss: 0.438 Vali Loss: 10.062 Vali Acc: 0.076 Test Loss: 10.062 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1068472
	speed: 0.6687s/iter; left time: 11061.5808s
	iters: 200, epoch: 21 | loss: 0.7486360
	speed: 0.3015s/iter; left time: 4956.1782s
Epoch: 21 cost time: 61.721259355545044
Epoch: 21, Steps: 208 | Train Loss: 0.414 Vali Loss: 10.432 Vali Acc: 0.072 Test Loss: 10.432 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1189638
	speed: 0.6601s/iter; left time: 10781.2188s
	iters: 200, epoch: 22 | loss: 0.3425904
	speed: 0.3009s/iter; left time: 4884.0951s
Epoch: 22 cost time: 61.209927797317505
Epoch: 22, Steps: 208 | Train Loss: 0.433 Vali Loss: 10.400 Vali Acc: 0.068 Test Loss: 10.400 Test Acc: 0.068
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2230172
	speed: 0.6958s/iter; left time: 11219.1060s
	iters: 200, epoch: 23 | loss: 0.2769207
	speed: 0.3013s/iter; left time: 4827.7933s
Epoch: 23 cost time: 61.991678953170776
Epoch: 23, Steps: 208 | Train Loss: 0.437 Vali Loss: 10.109 Vali Acc: 0.072 Test Loss: 10.109 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0740008
	speed: 0.6629s/iter; left time: 10551.5018s
	iters: 200, epoch: 24 | loss: 0.2551268
	speed: 0.2911s/iter; left time: 4604.2302s
Epoch: 24 cost time: 61.21288561820984
Epoch: 24, Steps: 208 | Train Loss: 0.369 Vali Loss: 10.554 Vali Acc: 0.076 Test Loss: 10.554 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07813898001789442
model parameter : 5202215
model size : 29.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8385372
	speed: 0.3132s/iter; left time: 6483.9889s
	iters: 200, epoch: 1 | loss: 5.1858616
	speed: 0.2839s/iter; left time: 5848.6189s
Epoch: 1 cost time: 62.15669918060303
Epoch: 1, Steps: 208 | Train Loss: 4.426 Vali Loss: 4.982 Vali Acc: 0.059 Test Loss: 4.982 Test Acc: 0.059
Validation loss decreased (inf --> -0.059300).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4487062
	speed: 0.6812s/iter; left time: 13960.2913s
	iters: 200, epoch: 2 | loss: 3.7890773
	speed: 0.2967s/iter; left time: 6049.6843s
Epoch: 2 cost time: 62.30619740486145
Epoch: 2, Steps: 208 | Train Loss: 3.872 Vali Loss: 4.772 Vali Acc: 0.064 Test Loss: 4.772 Test Acc: 0.064
Validation loss decreased (-0.059300 --> -0.064074).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1494045
	speed: 0.6434s/iter; left time: 13050.3679s
	iters: 200, epoch: 3 | loss: 2.9294133
	speed: 0.2789s/iter; left time: 5630.2434s
Epoch: 3 cost time: 57.367255449295044
Epoch: 3, Steps: 208 | Train Loss: 3.027 Vali Loss: 5.128 Vali Acc: 0.083 Test Loss: 5.128 Test Acc: 0.083
Validation loss decreased (-0.064074 --> -0.083158).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3199053
	speed: 0.6396s/iter; left time: 12840.9465s
	iters: 200, epoch: 4 | loss: 2.1611376
	speed: 0.2904s/iter; left time: 5801.9807s
Epoch: 4 cost time: 58.5520761013031
Epoch: 4, Steps: 208 | Train Loss: 2.196 Vali Loss: 5.601 Vali Acc: 0.075 Test Loss: 5.601 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4609189
	speed: 0.6563s/iter; left time: 13039.9855s
	iters: 200, epoch: 5 | loss: 1.7720106
	speed: 0.2818s/iter; left time: 5570.6673s
Epoch: 5 cost time: 58.188485860824585
Epoch: 5, Steps: 208 | Train Loss: 1.601 Vali Loss: 6.545 Vali Acc: 0.086 Test Loss: 6.545 Test Acc: 0.086
Validation loss decreased (-0.083158 --> -0.086126).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0522174
	speed: 0.6703s/iter; left time: 13178.4163s
	iters: 200, epoch: 6 | loss: 0.6522079
	speed: 0.2671s/iter; left time: 5224.2873s
Epoch: 6 cost time: 56.611785888671875
Epoch: 6, Steps: 208 | Train Loss: 1.261 Vali Loss: 7.536 Vali Acc: 0.087 Test Loss: 7.536 Test Acc: 0.087
Validation loss decreased (-0.086126 --> -0.086713).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2843949
	speed: 0.6715s/iter; left time: 13063.4721s
	iters: 200, epoch: 7 | loss: 0.5278202
	speed: 0.2824s/iter; left time: 5464.8243s
Epoch: 7 cost time: 59.10369539260864
Epoch: 7, Steps: 208 | Train Loss: 1.009 Vali Loss: 7.966 Vali Acc: 0.090 Test Loss: 7.966 Test Acc: 0.090
Validation loss decreased (-0.086713 --> -0.089691).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1476125
	speed: 0.6960s/iter; left time: 13395.1459s
	iters: 200, epoch: 8 | loss: 0.7420449
	speed: 0.2882s/iter; left time: 5518.3740s
Epoch: 8 cost time: 61.14586901664734
Epoch: 8, Steps: 208 | Train Loss: 0.862 Vali Loss: 8.583 Vali Acc: 0.078 Test Loss: 8.583 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8784977
	speed: 0.6996s/iter; left time: 13318.7124s
	iters: 200, epoch: 9 | loss: 0.3258606
	speed: 0.2695s/iter; left time: 5102.9815s
Epoch: 9 cost time: 59.29558825492859
Epoch: 9, Steps: 208 | Train Loss: 0.732 Vali Loss: 9.399 Vali Acc: 0.080 Test Loss: 9.399 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0621079
	speed: 0.6690s/iter; left time: 12597.2006s
	iters: 200, epoch: 10 | loss: 1.2693350
	speed: 0.2600s/iter; left time: 4869.5559s
Epoch: 10 cost time: 56.84737968444824
Epoch: 10, Steps: 208 | Train Loss: 0.668 Vali Loss: 9.468 Vali Acc: 0.077 Test Loss: 9.468 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2810529
	speed: 0.6684s/iter; left time: 12446.2377s
	iters: 200, epoch: 11 | loss: 0.4277900
	speed: 0.2759s/iter; left time: 5110.8149s
Epoch: 11 cost time: 59.57095122337341
Epoch: 11, Steps: 208 | Train Loss: 0.538 Vali Loss: 10.258 Vali Acc: 0.078 Test Loss: 10.258 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4225526
	speed: 0.6498s/iter; left time: 11965.3792s
	iters: 200, epoch: 12 | loss: 0.9047602
	speed: 0.2890s/iter; left time: 5292.8712s
Epoch: 12 cost time: 60.29130959510803
Epoch: 12, Steps: 208 | Train Loss: 0.529 Vali Loss: 10.783 Vali Acc: 0.082 Test Loss: 10.783 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2991646
	speed: 0.6570s/iter; left time: 11960.7331s
	iters: 200, epoch: 13 | loss: 0.2666598
	speed: 0.3030s/iter; left time: 5485.7677s
Epoch: 13 cost time: 60.95575833320618
Epoch: 13, Steps: 208 | Train Loss: 0.523 Vali Loss: 10.558 Vali Acc: 0.081 Test Loss: 10.558 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1049123
	speed: 0.6514s/iter; left time: 11723.9436s
	iters: 200, epoch: 14 | loss: 0.9561976
	speed: 0.2840s/iter; left time: 5082.6259s
Epoch: 14 cost time: 59.11239743232727
Epoch: 14, Steps: 208 | Train Loss: 0.431 Vali Loss: 11.092 Vali Acc: 0.081 Test Loss: 11.092 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0246440
	speed: 0.6426s/iter; left time: 11432.0359s
	iters: 200, epoch: 15 | loss: 0.5676473
	speed: 0.2811s/iter; left time: 4972.7521s
Epoch: 15 cost time: 57.38511633872986
Epoch: 15, Steps: 208 | Train Loss: 0.420 Vali Loss: 11.523 Vali Acc: 0.077 Test Loss: 11.523 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.5219772
	speed: 0.6538s/iter; left time: 11493.6979s
	iters: 200, epoch: 16 | loss: 0.7994271
	speed: 0.2788s/iter; left time: 4872.8580s
Epoch: 16 cost time: 57.573559522628784
Epoch: 16, Steps: 208 | Train Loss: 0.404 Vali Loss: 11.994 Vali Acc: 0.077 Test Loss: 11.994 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.4319277
	speed: 0.6648s/iter; left time: 11550.2498s
	iters: 200, epoch: 17 | loss: 0.8044574
	speed: 0.2706s/iter; left time: 4674.6246s
Epoch: 17 cost time: 56.88271880149841
Epoch: 17, Steps: 208 | Train Loss: 0.400 Vali Loss: 11.960 Vali Acc: 0.082 Test Loss: 11.960 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08977035490605428
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0001206
	speed: 0.2971s/iter; left time: 6149.5323s
	iters: 200, epoch: 1 | loss: 5.3850102
	speed: 0.3020s/iter; left time: 6221.4664s
Epoch: 1 cost time: 62.3787522315979
Epoch: 1, Steps: 208 | Train Loss: 4.427 Vali Loss: 4.996 Vali Acc: 0.060 Test Loss: 4.996 Test Acc: 0.060
Validation loss decreased (inf --> -0.060195).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9832139
	speed: 0.6735s/iter; left time: 13801.4664s
	iters: 200, epoch: 2 | loss: 4.3550043
	speed: 0.2986s/iter; left time: 6088.9305s
Epoch: 2 cost time: 60.6560480594635
Epoch: 2, Steps: 208 | Train Loss: 3.831 Vali Loss: 4.760 Vali Acc: 0.057 Test Loss: 4.760 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.1390095
	speed: 0.6989s/iter; left time: 14178.1836s
	iters: 200, epoch: 3 | loss: 2.9102464
	speed: 0.2936s/iter; left time: 5927.2663s
Epoch: 3 cost time: 61.99647521972656
Epoch: 3, Steps: 208 | Train Loss: 3.010 Vali Loss: 5.170 Vali Acc: 0.078 Test Loss: 5.170 Test Acc: 0.078
Validation loss decreased (-0.060195 --> -0.078087).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5249782
	speed: 0.6876s/iter; left time: 13804.0615s
	iters: 200, epoch: 4 | loss: 2.6181595
	speed: 0.2853s/iter; left time: 5698.7615s
Epoch: 4 cost time: 59.96683883666992
Epoch: 4, Steps: 208 | Train Loss: 2.253 Vali Loss: 5.500 Vali Acc: 0.084 Test Loss: 5.500 Test Acc: 0.084
Validation loss decreased (-0.078087 --> -0.083452).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4680878
	speed: 0.6934s/iter; left time: 13777.1264s
	iters: 200, epoch: 5 | loss: 1.5527179
	speed: 0.2811s/iter; left time: 5556.3463s
Epoch: 5 cost time: 59.79772758483887
Epoch: 5, Steps: 208 | Train Loss: 1.550 Vali Loss: 6.406 Vali Acc: 0.082 Test Loss: 6.406 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5433649
	speed: 0.6930s/iter; left time: 13624.5867s
	iters: 200, epoch: 6 | loss: 0.6887227
	speed: 0.2847s/iter; left time: 5568.2602s
Epoch: 6 cost time: 61.14653992652893
Epoch: 6, Steps: 208 | Train Loss: 1.249 Vali Loss: 7.616 Vali Acc: 0.078 Test Loss: 7.616 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8166802
	speed: 0.6947s/iter; left time: 13513.1234s
	iters: 200, epoch: 7 | loss: 0.4402616
	speed: 0.2914s/iter; left time: 5640.1358s
Epoch: 7 cost time: 61.635130167007446
Epoch: 7, Steps: 208 | Train Loss: 0.988 Vali Loss: 7.945 Vali Acc: 0.079 Test Loss: 7.945 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3372533
	speed: 0.6812s/iter; left time: 13110.4060s
	iters: 200, epoch: 8 | loss: 0.5978277
	speed: 0.2827s/iter; left time: 5411.8276s
Epoch: 8 cost time: 59.83871245384216
Epoch: 8, Steps: 208 | Train Loss: 0.858 Vali Loss: 8.436 Vali Acc: 0.087 Test Loss: 8.436 Test Acc: 0.087
Validation loss decreased (-0.083452 --> -0.086704).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5629078
	speed: 0.6649s/iter; left time: 12658.1193s
	iters: 200, epoch: 9 | loss: 0.8965364
	speed: 0.2968s/iter; left time: 5621.3272s
Epoch: 9 cost time: 61.69026160240173
Epoch: 9, Steps: 208 | Train Loss: 0.716 Vali Loss: 9.087 Vali Acc: 0.081 Test Loss: 9.087 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3697613
	speed: 0.6862s/iter; left time: 12921.3102s
	iters: 200, epoch: 10 | loss: 0.9180934
	speed: 0.2982s/iter; left time: 5584.2408s
Epoch: 10 cost time: 63.094826221466064
Epoch: 10, Steps: 208 | Train Loss: 0.681 Vali Loss: 9.137 Vali Acc: 0.083 Test Loss: 9.137 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2408883
	speed: 0.6649s/iter; left time: 12380.8542s
	iters: 200, epoch: 11 | loss: 1.1166161
	speed: 0.2888s/iter; left time: 5348.7434s
Epoch: 11 cost time: 60.27980923652649
Epoch: 11, Steps: 208 | Train Loss: 0.536 Vali Loss: 9.792 Vali Acc: 0.071 Test Loss: 9.792 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1113731
	speed: 0.6761s/iter; left time: 12448.7291s
	iters: 200, epoch: 12 | loss: 0.7151271
	speed: 0.3030s/iter; left time: 5549.3388s
Epoch: 12 cost time: 62.74926233291626
Epoch: 12, Steps: 208 | Train Loss: 0.500 Vali Loss: 9.749 Vali Acc: 0.084 Test Loss: 9.749 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4755434
	speed: 0.6840s/iter; left time: 12452.3032s
	iters: 200, epoch: 13 | loss: 0.0938808
	speed: 0.2927s/iter; left time: 5298.8566s
Epoch: 13 cost time: 60.551127910614014
Epoch: 13, Steps: 208 | Train Loss: 0.432 Vali Loss: 10.691 Vali Acc: 0.084 Test Loss: 10.691 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0756538
	speed: 0.6941s/iter; left time: 12492.0946s
	iters: 200, epoch: 14 | loss: 0.2839307
	speed: 0.2999s/iter; left time: 5366.6238s
Epoch: 14 cost time: 61.52496004104614
Epoch: 14, Steps: 208 | Train Loss: 0.411 Vali Loss: 11.078 Vali Acc: 0.078 Test Loss: 11.078 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.7122618
	speed: 0.6967s/iter; left time: 12393.9605s
	iters: 200, epoch: 15 | loss: 0.1774984
	speed: 0.2904s/iter; left time: 5137.4527s
Epoch: 15 cost time: 60.38204550743103
Epoch: 15, Steps: 208 | Train Loss: 0.417 Vali Loss: 10.904 Vali Acc: 0.087 Test Loss: 10.904 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2415358
	speed: 0.6915s/iter; left time: 12156.4021s
	iters: 200, epoch: 16 | loss: 0.4970784
	speed: 0.2958s/iter; left time: 5171.5715s
Epoch: 16 cost time: 60.80482077598572
Epoch: 16, Steps: 208 | Train Loss: 0.383 Vali Loss: 11.250 Vali Acc: 0.082 Test Loss: 11.250 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2915141
	speed: 0.6951s/iter; left time: 12075.5464s
	iters: 200, epoch: 17 | loss: 0.5507011
	speed: 0.3060s/iter; left time: 5285.6029s
Epoch: 17 cost time: 63.11449313163757
Epoch: 17, Steps: 208 | Train Loss: 0.376 Vali Loss: 11.178 Vali Acc: 0.078 Test Loss: 11.178 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0102467
	speed: 0.6837s/iter; left time: 11735.9295s
	iters: 200, epoch: 18 | loss: 0.6617342
	speed: 0.2765s/iter; left time: 4718.4891s
Epoch: 18 cost time: 60.0746796131134
Epoch: 18, Steps: 208 | Train Loss: 0.344 Vali Loss: 11.499 Vali Acc: 0.088 Test Loss: 11.499 Test Acc: 0.088
Validation loss decreased (-0.086704 --> -0.088164).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0681770
	speed: 0.6639s/iter; left time: 11257.8743s
	iters: 200, epoch: 19 | loss: 0.2298592
	speed: 0.2932s/iter; left time: 4943.2370s
Epoch: 19 cost time: 59.69102382659912
Epoch: 19, Steps: 208 | Train Loss: 0.360 Vali Loss: 12.324 Vali Acc: 0.084 Test Loss: 12.324 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3877620
	speed: 0.7063s/iter; left time: 11829.6488s
	iters: 200, epoch: 20 | loss: 0.5935737
	speed: 0.2996s/iter; left time: 4988.1357s
Epoch: 20 cost time: 62.09364891052246
Epoch: 20, Steps: 208 | Train Loss: 0.318 Vali Loss: 12.562 Vali Acc: 0.087 Test Loss: 12.562 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2115515
	speed: 0.6988s/iter; left time: 11558.2896s
	iters: 200, epoch: 21 | loss: 0.0769851
	speed: 0.2802s/iter; left time: 4606.4614s
Epoch: 21 cost time: 61.28620266914368
Epoch: 21, Steps: 208 | Train Loss: 0.319 Vali Loss: 12.545 Vali Acc: 0.090 Test Loss: 12.545 Test Acc: 0.090
Validation loss decreased (-0.088164 --> -0.089645).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0539876
	speed: 0.6718s/iter; left time: 10972.0068s
	iters: 200, epoch: 22 | loss: 0.1988308
	speed: 0.2771s/iter; left time: 4498.3995s
Epoch: 22 cost time: 58.42120289802551
Epoch: 22, Steps: 208 | Train Loss: 0.302 Vali Loss: 12.580 Vali Acc: 0.083 Test Loss: 12.580 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1193747
	speed: 0.6693s/iter; left time: 10791.8674s
	iters: 200, epoch: 23 | loss: 0.6500819
	speed: 0.3130s/iter; left time: 5015.0703s
Epoch: 23 cost time: 62.08041048049927
Epoch: 23, Steps: 208 | Train Loss: 0.316 Vali Loss: 12.975 Vali Acc: 0.076 Test Loss: 12.975 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.9033713
	speed: 0.6994s/iter; left time: 11133.0681s
	iters: 200, epoch: 24 | loss: 0.3145693
	speed: 0.2980s/iter; left time: 4713.7524s
Epoch: 24 cost time: 62.8404860496521
Epoch: 24, Steps: 208 | Train Loss: 0.295 Vali Loss: 12.665 Vali Acc: 0.083 Test Loss: 12.665 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0759514
	speed: 0.6907s/iter; left time: 10850.8430s
	iters: 200, epoch: 25 | loss: 0.1504607
	speed: 0.2670s/iter; left time: 4167.1821s
Epoch: 25 cost time: 59.61119747161865
Epoch: 25, Steps: 208 | Train Loss: 0.280 Vali Loss: 13.256 Vali Acc: 0.084 Test Loss: 13.256 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2478584
	speed: 0.6991s/iter; left time: 10837.3224s
	iters: 200, epoch: 26 | loss: 0.4673100
	speed: 0.2998s/iter; left time: 4617.3493s
Epoch: 26 cost time: 62.12111854553223
Epoch: 26, Steps: 208 | Train Loss: 0.313 Vali Loss: 12.901 Vali Acc: 0.089 Test Loss: 12.901 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.4943490
	speed: 0.7096s/iter; left time: 10852.5770s
	iters: 200, epoch: 27 | loss: 0.0358443
	speed: 0.3048s/iter; left time: 4631.2973s
Epoch: 27 cost time: 63.448912143707275
Epoch: 27, Steps: 208 | Train Loss: 0.286 Vali Loss: 14.016 Vali Acc: 0.085 Test Loss: 14.016 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.1767484
	speed: 0.6874s/iter; left time: 10369.8136s
	iters: 200, epoch: 28 | loss: 0.4839356
	speed: 0.2809s/iter; left time: 4209.2808s
Epoch: 28 cost time: 60.37176156044006
Epoch: 28, Steps: 208 | Train Loss: 0.250 Vali Loss: 13.780 Vali Acc: 0.081 Test Loss: 13.780 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1307768
	speed: 0.6761s/iter; left time: 10058.8912s
	iters: 200, epoch: 29 | loss: 0.0592137
	speed: 0.2871s/iter; left time: 4241.8348s
Epoch: 29 cost time: 59.601511001586914
Epoch: 29, Steps: 208 | Train Loss: 0.260 Vali Loss: 13.760 Vali Acc: 0.089 Test Loss: 13.760 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.3287957
	speed: 0.6918s/iter; left time: 10147.7029s
	iters: 200, epoch: 30 | loss: 0.0031304
	speed: 0.3033s/iter; left time: 4419.3419s
Epoch: 30 cost time: 62.85016322135925
Epoch: 30, Steps: 208 | Train Loss: 0.270 Vali Loss: 14.274 Vali Acc: 0.082 Test Loss: 14.274 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.3726982
	speed: 0.7018s/iter; left time: 10148.2918s
	iters: 200, epoch: 31 | loss: 0.2190443
	speed: 0.2933s/iter; left time: 4212.0900s
Epoch: 31 cost time: 63.496509313583374
Epoch: 31, Steps: 208 | Train Loss: 0.275 Vali Loss: 13.375 Vali Acc: 0.089 Test Loss: 13.375 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08977035490605428
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8641405
	speed: 0.2943s/iter; left time: 6091.3948s
	iters: 200, epoch: 1 | loss: 5.3407998
	speed: 0.2816s/iter; left time: 5801.3463s
Epoch: 1 cost time: 60.24942898750305
Epoch: 1, Steps: 208 | Train Loss: 4.397 Vali Loss: 5.114 Vali Acc: 0.054 Test Loss: 5.114 Test Acc: 0.054
Validation loss decreased (inf --> -0.053930).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3423591
	speed: 0.6680s/iter; left time: 13690.0141s
	iters: 200, epoch: 2 | loss: 4.0176778
	speed: 0.2783s/iter; left time: 5676.0405s
Epoch: 2 cost time: 59.81801915168762
Epoch: 2, Steps: 208 | Train Loss: 3.809 Vali Loss: 4.785 Vali Acc: 0.067 Test Loss: 4.785 Test Acc: 0.067
Validation loss decreased (-0.053930 --> -0.066460).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7499590
	speed: 0.6845s/iter; left time: 13884.8749s
	iters: 200, epoch: 3 | loss: 3.0862236
	speed: 0.2891s/iter; left time: 5835.1958s
Epoch: 3 cost time: 61.360358476638794
Epoch: 3, Steps: 208 | Train Loss: 2.963 Vali Loss: 5.079 Vali Acc: 0.078 Test Loss: 5.079 Test Acc: 0.078
Validation loss decreased (-0.066460 --> -0.078386).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0570433
	speed: 0.6699s/iter; left time: 13448.8323s
	iters: 200, epoch: 4 | loss: 2.4914086
	speed: 0.2802s/iter; left time: 5596.8184s
Epoch: 4 cost time: 57.66711211204529
Epoch: 4, Steps: 208 | Train Loss: 2.237 Vali Loss: 5.626 Vali Acc: 0.075 Test Loss: 5.626 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1950253
	speed: 0.6617s/iter; left time: 13146.3331s
	iters: 200, epoch: 5 | loss: 2.0797234
	speed: 0.2767s/iter; left time: 5470.7497s
Epoch: 5 cost time: 57.93886113166809
Epoch: 5, Steps: 208 | Train Loss: 1.627 Vali Loss: 6.553 Vali Acc: 0.082 Test Loss: 6.553 Test Acc: 0.082
Validation loss decreased (-0.078386 --> -0.081951).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3100187
	speed: 0.6594s/iter; left time: 12965.0874s
	iters: 200, epoch: 6 | loss: 1.5700184
	speed: 0.2758s/iter; left time: 5394.7758s
Epoch: 6 cost time: 59.741018533706665
Epoch: 6, Steps: 208 | Train Loss: 1.347 Vali Loss: 7.103 Vali Acc: 0.082 Test Loss: 7.103 Test Acc: 0.082
Validation loss decreased (-0.081951 --> -0.082243).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9937102
	speed: 0.6858s/iter; left time: 13341.6243s
	iters: 200, epoch: 7 | loss: 1.0241075
	speed: 0.2767s/iter; left time: 5354.0361s
Epoch: 7 cost time: 59.20761513710022
Epoch: 7, Steps: 208 | Train Loss: 1.067 Vali Loss: 8.216 Vali Acc: 0.088 Test Loss: 8.216 Test Acc: 0.088
Validation loss decreased (-0.082243 --> -0.087601).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4998998
	speed: 0.6646s/iter; left time: 12791.0955s
	iters: 200, epoch: 8 | loss: 2.1025689
	speed: 0.2744s/iter; left time: 5254.1437s
Epoch: 8 cost time: 57.92021989822388
Epoch: 8, Steps: 208 | Train Loss: 0.870 Vali Loss: 8.266 Vali Acc: 0.078 Test Loss: 8.266 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6836532
	speed: 0.6791s/iter; left time: 12928.7176s
	iters: 200, epoch: 9 | loss: 0.4008633
	speed: 0.2759s/iter; left time: 5225.0141s
Epoch: 9 cost time: 59.2983021736145
Epoch: 9, Steps: 208 | Train Loss: 0.757 Vali Loss: 8.816 Vali Acc: 0.085 Test Loss: 8.816 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4393961
	speed: 0.6841s/iter; left time: 12880.4142s
	iters: 200, epoch: 10 | loss: 1.0389096
	speed: 0.2968s/iter; left time: 5559.3826s
Epoch: 10 cost time: 62.20534801483154
Epoch: 10, Steps: 208 | Train Loss: 0.655 Vali Loss: 9.702 Vali Acc: 0.069 Test Loss: 9.702 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3792807
	speed: 0.6939s/iter; left time: 12920.3409s
	iters: 200, epoch: 11 | loss: 0.6544477
	speed: 0.2865s/iter; left time: 5306.3633s
Epoch: 11 cost time: 60.287760972976685
Epoch: 11, Steps: 208 | Train Loss: 0.548 Vali Loss: 10.269 Vali Acc: 0.077 Test Loss: 10.269 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0450841
	speed: 0.7006s/iter; left time: 12899.3282s
	iters: 200, epoch: 12 | loss: 1.7406002
	speed: 0.2998s/iter; left time: 5489.5358s
Epoch: 12 cost time: 62.22083783149719
Epoch: 12, Steps: 208 | Train Loss: 0.477 Vali Loss: 9.994 Vali Acc: 0.075 Test Loss: 9.994 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.5297496
	speed: 0.6608s/iter; left time: 12030.7596s
	iters: 200, epoch: 13 | loss: 0.5098888
	speed: 0.2960s/iter; left time: 5359.0236s
Epoch: 13 cost time: 60.2577121257782
Epoch: 13, Steps: 208 | Train Loss: 0.410 Vali Loss: 10.839 Vali Acc: 0.077 Test Loss: 10.839 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0484623
	speed: 0.6969s/iter; left time: 12542.2781s
	iters: 200, epoch: 14 | loss: 0.5986196
	speed: 0.2810s/iter; left time: 5028.2730s
Epoch: 14 cost time: 59.64941334724426
Epoch: 14, Steps: 208 | Train Loss: 0.466 Vali Loss: 10.764 Vali Acc: 0.070 Test Loss: 10.764 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.4151117
	speed: 0.6668s/iter; left time: 11862.1723s
	iters: 200, epoch: 15 | loss: 0.1815159
	speed: 0.3049s/iter; left time: 5392.5969s
Epoch: 15 cost time: 62.06693887710571
Epoch: 15, Steps: 208 | Train Loss: 0.403 Vali Loss: 10.939 Vali Acc: 0.073 Test Loss: 10.939 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.4707894
	speed: 0.6627s/iter; left time: 11651.4316s
	iters: 200, epoch: 16 | loss: 0.3230056
	speed: 0.2900s/iter; left time: 5069.9174s
Epoch: 16 cost time: 59.28011512756348
Epoch: 16, Steps: 208 | Train Loss: 0.395 Vali Loss: 11.435 Vali Acc: 0.080 Test Loss: 11.435 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1976007
	speed: 0.6786s/iter; left time: 11789.8196s
	iters: 200, epoch: 17 | loss: 0.1297737
	speed: 0.2740s/iter; left time: 4732.4888s
Epoch: 17 cost time: 58.28871941566467
Epoch: 17, Steps: 208 | Train Loss: 0.370 Vali Loss: 11.683 Vali Acc: 0.082 Test Loss: 11.683 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08768267223382047
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5098777
	speed: 0.3260s/iter; left time: 6748.0942s
	iters: 200, epoch: 1 | loss: 5.1930361
	speed: 0.3004s/iter; left time: 6189.1276s
Epoch: 1 cost time: 65.19020533561707
Epoch: 1, Steps: 208 | Train Loss: 4.357 Vali Loss: 4.917 Vali Acc: 0.061 Test Loss: 4.917 Test Acc: 0.061
Validation loss decreased (inf --> -0.061090).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0106230
	speed: 0.6689s/iter; left time: 13708.2007s
	iters: 200, epoch: 2 | loss: 3.9686582
	speed: 0.2957s/iter; left time: 6029.5329s
Epoch: 2 cost time: 61.553107261657715
Epoch: 2, Steps: 208 | Train Loss: 3.785 Vali Loss: 4.952 Vali Acc: 0.064 Test Loss: 4.952 Test Acc: 0.064
Validation loss decreased (-0.061090 --> -0.064072).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8226500
	speed: 0.7006s/iter; left time: 14212.1848s
	iters: 200, epoch: 3 | loss: 3.1459360
	speed: 0.2893s/iter; left time: 5840.2038s
Epoch: 3 cost time: 62.01467537879944
Epoch: 3, Steps: 208 | Train Loss: 2.910 Vali Loss: 5.120 Vali Acc: 0.077 Test Loss: 5.120 Test Acc: 0.077
Validation loss decreased (-0.064072 --> -0.076895).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7986462
	speed: 0.6912s/iter; left time: 13876.9971s
	iters: 200, epoch: 4 | loss: 2.2779009
	speed: 0.3064s/iter; left time: 6121.9516s
Epoch: 4 cost time: 62.90047216415405
Epoch: 4, Steps: 208 | Train Loss: 2.192 Vali Loss: 5.753 Vali Acc: 0.077 Test Loss: 5.753 Test Acc: 0.077
Validation loss decreased (-0.076895 --> -0.077187).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0767593
	speed: 0.7081s/iter; left time: 14069.4033s
	iters: 200, epoch: 5 | loss: 2.0785997
	speed: 0.2816s/iter; left time: 5566.0733s
Epoch: 5 cost time: 59.85641670227051
Epoch: 5, Steps: 208 | Train Loss: 1.589 Vali Loss: 6.655 Vali Acc: 0.084 Test Loss: 6.655 Test Acc: 0.084
Validation loss decreased (-0.077187 --> -0.083739).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0587392
	speed: 0.6810s/iter; left time: 13389.1413s
	iters: 200, epoch: 6 | loss: 1.1083719
	speed: 0.3008s/iter; left time: 5883.9262s
Epoch: 6 cost time: 61.960678815841675
Epoch: 6, Steps: 208 | Train Loss: 1.284 Vali Loss: 7.379 Vali Acc: 0.086 Test Loss: 7.379 Test Acc: 0.086
Validation loss decreased (-0.083739 --> -0.085521).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4136496
	speed: 0.6771s/iter; left time: 13171.3996s
	iters: 200, epoch: 7 | loss: 1.5236590
	speed: 0.3074s/iter; left time: 5949.1043s
Epoch: 7 cost time: 63.33134984970093
Epoch: 7, Steps: 208 | Train Loss: 0.978 Vali Loss: 8.076 Vali Acc: 0.093 Test Loss: 8.076 Test Acc: 0.093
Validation loss decreased (-0.085521 --> -0.092970).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2184952
	speed: 0.7414s/iter; left time: 14267.9238s
	iters: 200, epoch: 8 | loss: 0.9291031
	speed: 0.2970s/iter; left time: 5686.6335s
Epoch: 8 cost time: 63.51182508468628
Epoch: 8, Steps: 208 | Train Loss: 0.848 Vali Loss: 8.849 Vali Acc: 0.082 Test Loss: 8.849 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6651229
	speed: 0.6640s/iter; left time: 12639.7918s
	iters: 200, epoch: 9 | loss: 1.2742546
	speed: 0.2944s/iter; left time: 5574.5415s
Epoch: 9 cost time: 60.18255543708801
Epoch: 9, Steps: 208 | Train Loss: 0.760 Vali Loss: 8.903 Vali Acc: 0.088 Test Loss: 8.903 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.8432416
	speed: 0.6929s/iter; left time: 13046.9704s
	iters: 200, epoch: 10 | loss: 1.3168311
	speed: 0.2878s/iter; left time: 5390.7780s
Epoch: 10 cost time: 60.75478982925415
Epoch: 10, Steps: 208 | Train Loss: 0.695 Vali Loss: 9.572 Vali Acc: 0.077 Test Loss: 9.572 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5053657
	speed: 0.7173s/iter; left time: 13357.5835s
	iters: 200, epoch: 11 | loss: 0.9142463
	speed: 0.3119s/iter; left time: 5777.0990s
Epoch: 11 cost time: 65.16819453239441
Epoch: 11, Steps: 208 | Train Loss: 0.592 Vali Loss: 10.212 Vali Acc: 0.081 Test Loss: 10.212 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3354699
	speed: 0.6902s/iter; left time: 12708.5820s
	iters: 200, epoch: 12 | loss: 0.2847790
	speed: 0.3031s/iter; left time: 5551.1594s
Epoch: 12 cost time: 62.80086970329285
Epoch: 12, Steps: 208 | Train Loss: 0.558 Vali Loss: 10.558 Vali Acc: 0.077 Test Loss: 10.558 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3061281
	speed: 0.6982s/iter; left time: 12709.9933s
	iters: 200, epoch: 13 | loss: 0.8902938
	speed: 0.2845s/iter; left time: 5151.0221s
Epoch: 13 cost time: 60.95403027534485
Epoch: 13, Steps: 208 | Train Loss: 0.521 Vali Loss: 11.685 Vali Acc: 0.076 Test Loss: 11.685 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2840937
	speed: 0.6959s/iter; left time: 12524.0765s
	iters: 200, epoch: 14 | loss: 0.5059938
	speed: 0.2981s/iter; left time: 5334.2107s
Epoch: 14 cost time: 63.19828915596008
Epoch: 14, Steps: 208 | Train Loss: 0.468 Vali Loss: 11.099 Vali Acc: 0.080 Test Loss: 11.099 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1547585
	speed: 0.6814s/iter; left time: 12121.0890s
	iters: 200, epoch: 15 | loss: 0.0358890
	speed: 0.3050s/iter; left time: 5395.0960s
Epoch: 15 cost time: 62.40002465248108
Epoch: 15, Steps: 208 | Train Loss: 0.454 Vali Loss: 11.662 Vali Acc: 0.080 Test Loss: 11.662 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.4366944
	speed: 0.7240s/iter; left time: 12728.8846s
	iters: 200, epoch: 16 | loss: 0.2924384
	speed: 0.3003s/iter; left time: 5248.9280s
Epoch: 16 cost time: 64.39191031455994
Epoch: 16, Steps: 208 | Train Loss: 0.432 Vali Loss: 11.543 Vali Acc: 0.078 Test Loss: 11.543 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0460065
	speed: 0.6881s/iter; left time: 11954.5413s
	iters: 200, epoch: 17 | loss: 0.2075728
	speed: 0.3007s/iter; left time: 5193.7211s
Epoch: 17 cost time: 62.537025928497314
Epoch: 17, Steps: 208 | Train Loss: 0.418 Vali Loss: 12.047 Vali Acc: 0.082 Test Loss: 12.047 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09305099910527885
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4110732
	speed: 0.3102s/iter; left time: 6421.6034s
	iters: 200, epoch: 1 | loss: 5.6436939
	speed: 0.3063s/iter; left time: 6310.7182s
Epoch: 1 cost time: 64.27470064163208
Epoch: 1, Steps: 208 | Train Loss: 4.277 Vali Loss: 5.354 Vali Acc: 0.047 Test Loss: 5.354 Test Acc: 0.047
Validation loss decreased (inf --> -0.046472).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5070381
	speed: 0.7090s/iter; left time: 14529.9103s
	iters: 200, epoch: 2 | loss: 3.5566683
	speed: 0.2833s/iter; left time: 5777.5467s
Epoch: 2 cost time: 61.276753664016724
Epoch: 2, Steps: 208 | Train Loss: 3.774 Vali Loss: 5.705 Vali Acc: 0.062 Test Loss: 5.705 Test Acc: 0.062
Validation loss decreased (-0.046472 --> -0.061977).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0504043
	speed: 0.6740s/iter; left time: 13672.4999s
	iters: 200, epoch: 3 | loss: 2.8667431
	speed: 0.3002s/iter; left time: 6060.4423s
Epoch: 3 cost time: 61.426931381225586
Epoch: 3, Steps: 208 | Train Loss: 2.929 Vali Loss: 6.149 Vali Acc: 0.067 Test Loss: 6.149 Test Acc: 0.067
Validation loss decreased (-0.061977 --> -0.067043).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4536116
	speed: 0.7035s/iter; left time: 14124.8691s
	iters: 200, epoch: 4 | loss: 3.9141181
	speed: 0.2738s/iter; left time: 5468.7301s
Epoch: 4 cost time: 59.39712357521057
Epoch: 4, Steps: 208 | Train Loss: 2.293 Vali Loss: 6.049 Vali Acc: 0.077 Test Loss: 6.049 Test Acc: 0.077
Validation loss decreased (-0.067043 --> -0.076587).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5928706
	speed: 0.6973s/iter; left time: 13855.0080s
	iters: 200, epoch: 5 | loss: 1.8803865
	speed: 0.2982s/iter; left time: 5895.1639s
Epoch: 5 cost time: 62.6388213634491
Epoch: 5, Steps: 208 | Train Loss: 1.697 Vali Loss: 6.728 Vali Acc: 0.074 Test Loss: 6.728 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2694048
	speed: 0.6783s/iter; left time: 13336.0892s
	iters: 200, epoch: 6 | loss: 1.6985927
	speed: 0.2896s/iter; left time: 5664.4684s
Epoch: 6 cost time: 60.71685266494751
Epoch: 6, Steps: 208 | Train Loss: 1.428 Vali Loss: 7.733 Vali Acc: 0.071 Test Loss: 7.733 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3050524
	speed: 0.7125s/iter; left time: 13860.3196s
	iters: 200, epoch: 7 | loss: 1.3810017
	speed: 0.2954s/iter; left time: 5717.1415s
Epoch: 7 cost time: 62.93161416053772
Epoch: 7, Steps: 208 | Train Loss: 1.166 Vali Loss: 7.549 Vali Acc: 0.086 Test Loss: 7.549 Test Acc: 0.086
Validation loss decreased (-0.076587 --> -0.085818).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5690602
	speed: 0.6645s/iter; left time: 12787.4430s
	iters: 200, epoch: 8 | loss: 1.2719300
	speed: 0.2990s/iter; left time: 5723.8248s
Epoch: 8 cost time: 60.67821741104126
Epoch: 8, Steps: 208 | Train Loss: 0.951 Vali Loss: 8.678 Vali Acc: 0.085 Test Loss: 8.678 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9614917
	speed: 0.6853s/iter; left time: 13045.6187s
	iters: 200, epoch: 9 | loss: 1.0656055
	speed: 0.2912s/iter; left time: 5513.7748s
Epoch: 9 cost time: 60.01020860671997
Epoch: 9, Steps: 208 | Train Loss: 0.852 Vali Loss: 8.876 Vali Acc: 0.079 Test Loss: 8.876 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3440599
	speed: 0.7019s/iter; left time: 13216.9619s
	iters: 200, epoch: 10 | loss: 1.0260857
	speed: 0.3064s/iter; left time: 5739.2722s
Epoch: 10 cost time: 63.72832250595093
Epoch: 10, Steps: 208 | Train Loss: 0.743 Vali Loss: 9.507 Vali Acc: 0.079 Test Loss: 9.507 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4006328
	speed: 0.6958s/iter; left time: 12956.0631s
	iters: 200, epoch: 11 | loss: 0.8618066
	speed: 0.2973s/iter; left time: 5505.5754s
Epoch: 11 cost time: 63.0932092666626
Epoch: 11, Steps: 208 | Train Loss: 0.681 Vali Loss: 9.609 Vali Acc: 0.081 Test Loss: 9.609 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1366990
	speed: 0.7183s/iter; left time: 13225.2970s
	iters: 200, epoch: 12 | loss: 0.5785235
	speed: 0.2969s/iter; left time: 5437.6055s
Epoch: 12 cost time: 61.70791029930115
Epoch: 12, Steps: 208 | Train Loss: 0.558 Vali Loss: 9.924 Vali Acc: 0.086 Test Loss: 9.924 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0529402
	speed: 0.6768s/iter; left time: 12322.0394s
	iters: 200, epoch: 13 | loss: 1.0290068
	speed: 0.2753s/iter; left time: 4985.2055s
Epoch: 13 cost time: 59.18160820007324
Epoch: 13, Steps: 208 | Train Loss: 0.589 Vali Loss: 9.367 Vali Acc: 0.081 Test Loss: 9.367 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1544086
	speed: 0.6918s/iter; left time: 12449.7466s
	iters: 200, epoch: 14 | loss: 0.1458053
	speed: 0.2908s/iter; left time: 5204.0345s
Epoch: 14 cost time: 61.73226475715637
Epoch: 14, Steps: 208 | Train Loss: 0.534 Vali Loss: 10.099 Vali Acc: 0.074 Test Loss: 10.099 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0948448
	speed: 0.6984s/iter; left time: 12423.4886s
	iters: 200, epoch: 15 | loss: 0.4084474
	speed: 0.3122s/iter; left time: 5522.7789s
Epoch: 15 cost time: 63.48014760017395
Epoch: 15, Steps: 208 | Train Loss: 0.465 Vali Loss: 10.047 Vali Acc: 0.084 Test Loss: 10.047 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2259406
	speed: 0.6807s/iter; left time: 11967.4095s
	iters: 200, epoch: 16 | loss: 0.4753751
	speed: 0.2776s/iter; left time: 4853.5410s
Epoch: 16 cost time: 58.13996362686157
Epoch: 16, Steps: 208 | Train Loss: 0.439 Vali Loss: 10.978 Vali Acc: 0.079 Test Loss: 10.978 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5327916
	speed: 0.6967s/iter; left time: 12102.9705s
	iters: 200, epoch: 17 | loss: 0.6509988
	speed: 0.2810s/iter; left time: 4853.4650s
Epoch: 17 cost time: 59.83189153671265
Epoch: 17, Steps: 208 | Train Loss: 0.421 Vali Loss: 10.951 Vali Acc: 0.089 Test Loss: 10.951 Test Acc: 0.089
Validation loss decreased (-0.085818 --> -0.088766).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0702027
	speed: 0.6861s/iter; left time: 11776.5361s
	iters: 200, epoch: 18 | loss: 0.7719173
	speed: 0.2986s/iter; left time: 5094.7704s
Epoch: 18 cost time: 62.750197649002075
Epoch: 18, Steps: 208 | Train Loss: 0.436 Vali Loss: 11.175 Vali Acc: 0.088 Test Loss: 11.175 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0829394
	speed: 0.6687s/iter; left time: 11338.3110s
	iters: 200, epoch: 19 | loss: 0.0909317
	speed: 0.2909s/iter; left time: 4903.0691s
Epoch: 19 cost time: 60.247267961502075
Epoch: 19, Steps: 208 | Train Loss: 0.410 Vali Loss: 10.991 Vali Acc: 0.089 Test Loss: 10.991 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2434892
	speed: 0.6874s/iter; left time: 11512.7771s
	iters: 200, epoch: 20 | loss: 0.1636402
	speed: 0.2723s/iter; left time: 4534.3512s
Epoch: 20 cost time: 58.85504221916199
Epoch: 20, Steps: 208 | Train Loss: 0.367 Vali Loss: 11.177 Vali Acc: 0.089 Test Loss: 11.177 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.9143920
	speed: 0.6864s/iter; left time: 11353.1655s
	iters: 200, epoch: 21 | loss: 0.0672267
	speed: 0.2849s/iter; left time: 4683.6703s
Epoch: 21 cost time: 60.361902713775635
Epoch: 21, Steps: 208 | Train Loss: 0.367 Vali Loss: 11.074 Vali Acc: 0.086 Test Loss: 11.074 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1646940
	speed: 0.6862s/iter; left time: 11207.7153s
	iters: 200, epoch: 22 | loss: 0.4651587
	speed: 0.3058s/iter; left time: 4964.4936s
Epoch: 22 cost time: 63.561564207077026
Epoch: 22, Steps: 208 | Train Loss: 0.381 Vali Loss: 11.614 Vali Acc: 0.080 Test Loss: 11.614 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1695294
	speed: 0.6875s/iter; left time: 11085.4693s
	iters: 200, epoch: 23 | loss: 0.2877987
	speed: 0.2809s/iter; left time: 4501.6451s
Epoch: 23 cost time: 59.36421728134155
Epoch: 23, Steps: 208 | Train Loss: 0.369 Vali Loss: 11.469 Vali Acc: 0.079 Test Loss: 11.469 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.4127319
	speed: 0.6655s/iter; left time: 10593.5538s
	iters: 200, epoch: 24 | loss: 0.6086358
	speed: 0.2859s/iter; left time: 4522.1305s
Epoch: 24 cost time: 58.94371008872986
Epoch: 24, Steps: 208 | Train Loss: 0.334 Vali Loss: 12.346 Vali Acc: 0.083 Test Loss: 12.346 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0174388
	speed: 0.6921s/iter; left time: 10872.1090s
	iters: 200, epoch: 25 | loss: 0.0204163
	speed: 0.3047s/iter; left time: 4756.2686s
Epoch: 25 cost time: 63.563029527664185
Epoch: 25, Steps: 208 | Train Loss: 0.339 Vali Loss: 12.488 Vali Acc: 0.082 Test Loss: 12.488 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2243695
	speed: 0.6978s/iter; left time: 10816.8706s
	iters: 200, epoch: 26 | loss: 0.3254459
	speed: 0.2946s/iter; left time: 4537.3265s
Epoch: 26 cost time: 61.81067609786987
Epoch: 26, Steps: 208 | Train Loss: 0.336 Vali Loss: 11.989 Vali Acc: 0.084 Test Loss: 11.989 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0552946
	speed: 0.6893s/iter; left time: 10541.8391s
	iters: 200, epoch: 27 | loss: 0.2710029
	speed: 0.2933s/iter; left time: 4456.2872s
Epoch: 27 cost time: 60.052364349365234
Epoch: 27, Steps: 208 | Train Loss: 0.325 Vali Loss: 12.067 Vali Acc: 0.086 Test Loss: 12.067 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08887563376081122
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3763151
	speed: 0.2974s/iter; left time: 6156.6655s
	iters: 200, epoch: 1 | loss: 5.3991666
	speed: 0.2760s/iter; left time: 5686.3804s
Epoch: 1 cost time: 59.783862829208374
Epoch: 1, Steps: 208 | Train Loss: 4.126 Vali Loss: 5.663 Vali Acc: 0.054 Test Loss: 5.663 Test Acc: 0.054
Validation loss decreased (inf --> -0.053627).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0217679
	speed: 0.6611s/iter; left time: 13547.6466s
	iters: 200, epoch: 2 | loss: 4.6352720
	speed: 0.2861s/iter; left time: 5833.9340s
Epoch: 2 cost time: 59.62900900840759
Epoch: 2, Steps: 208 | Train Loss: 3.792 Vali Loss: 6.698 Vali Acc: 0.070 Test Loss: 6.698 Test Acc: 0.070
Validation loss decreased (-0.053627 --> -0.070020).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8277392
	speed: 0.6400s/iter; left time: 12981.8177s
	iters: 200, epoch: 3 | loss: 3.3133886
	speed: 0.2792s/iter; left time: 5635.7547s
Epoch: 3 cost time: 57.704447507858276
Epoch: 3, Steps: 208 | Train Loss: 3.342 Vali Loss: 7.689 Vali Acc: 0.079 Test Loss: 7.689 Test Acc: 0.079
Validation loss decreased (-0.070020 --> -0.078957).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5129695
	speed: 0.6542s/iter; left time: 13133.7202s
	iters: 200, epoch: 4 | loss: 3.1378775
	speed: 0.2778s/iter; left time: 5548.9884s
Epoch: 4 cost time: 57.61926555633545
Epoch: 4, Steps: 208 | Train Loss: 2.639 Vali Loss: 7.184 Vali Acc: 0.084 Test Loss: 7.184 Test Acc: 0.084
Validation loss decreased (-0.078957 --> -0.083435).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5005196
	speed: 0.6805s/iter; left time: 13520.4863s
	iters: 200, epoch: 5 | loss: 2.5123787
	speed: 0.2836s/iter; left time: 5606.4176s
Epoch: 5 cost time: 60.40220665931702
Epoch: 5, Steps: 208 | Train Loss: 2.131 Vali Loss: 7.396 Vali Acc: 0.087 Test Loss: 7.396 Test Acc: 0.087
Validation loss decreased (-0.083435 --> -0.086714).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6267166
	speed: 0.6394s/iter; left time: 12571.5127s
	iters: 200, epoch: 6 | loss: 2.2524321
	speed: 0.2845s/iter; left time: 5565.8923s
Epoch: 6 cost time: 58.855419397354126
Epoch: 6, Steps: 208 | Train Loss: 1.772 Vali Loss: 7.877 Vali Acc: 0.080 Test Loss: 7.877 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5344414
	speed: 0.6901s/iter; left time: 13423.9401s
	iters: 200, epoch: 7 | loss: 1.3428633
	speed: 0.2944s/iter; left time: 5697.0503s
Epoch: 7 cost time: 61.54709482192993
Epoch: 7, Steps: 208 | Train Loss: 1.442 Vali Loss: 7.654 Vali Acc: 0.088 Test Loss: 7.654 Test Acc: 0.088
Validation loss decreased (-0.086714 --> -0.088203).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6264053
	speed: 0.7198s/iter; left time: 13852.7669s
	iters: 200, epoch: 8 | loss: 1.3003047
	speed: 0.2894s/iter; left time: 5540.9784s
Epoch: 8 cost time: 62.61219835281372
Epoch: 8, Steps: 208 | Train Loss: 1.200 Vali Loss: 8.206 Vali Acc: 0.083 Test Loss: 8.206 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9537801
	speed: 0.6778s/iter; left time: 12904.1893s
	iters: 200, epoch: 9 | loss: 0.7999275
	speed: 0.2784s/iter; left time: 5271.3138s
Epoch: 9 cost time: 60.39239478111267
Epoch: 9, Steps: 208 | Train Loss: 1.133 Vali Loss: 8.693 Vali Acc: 0.080 Test Loss: 8.693 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6614633
	speed: 0.6493s/iter; left time: 12225.2159s
	iters: 200, epoch: 10 | loss: 1.8587513
	speed: 0.2866s/iter; left time: 5368.4534s
Epoch: 10 cost time: 59.22779846191406
Epoch: 10, Steps: 208 | Train Loss: 0.959 Vali Loss: 8.590 Vali Acc: 0.085 Test Loss: 8.590 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8863757
	speed: 0.6666s/iter; left time: 12411.8866s
	iters: 200, epoch: 11 | loss: 0.8818152
	speed: 0.2678s/iter; left time: 4960.3236s
Epoch: 11 cost time: 57.23264980316162
Epoch: 11, Steps: 208 | Train Loss: 0.936 Vali Loss: 8.870 Vali Acc: 0.079 Test Loss: 8.870 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1604696
	speed: 0.6626s/iter; left time: 12200.5803s
	iters: 200, epoch: 12 | loss: 1.5229830
	speed: 0.2734s/iter; left time: 5007.3370s
Epoch: 12 cost time: 58.52460598945618
Epoch: 12, Steps: 208 | Train Loss: 0.781 Vali Loss: 9.067 Vali Acc: 0.072 Test Loss: 9.067 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.5291260
	speed: 0.6721s/iter; left time: 12234.9085s
	iters: 200, epoch: 13 | loss: 1.1689816
	speed: 0.2920s/iter; left time: 5286.4118s
Epoch: 13 cost time: 61.24016547203064
Epoch: 13, Steps: 208 | Train Loss: 0.762 Vali Loss: 9.160 Vali Acc: 0.081 Test Loss: 9.160 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.4633473
	speed: 0.6327s/iter; left time: 11387.2220s
	iters: 200, epoch: 14 | loss: 1.3658526
	speed: 0.2662s/iter; left time: 4764.8614s
Epoch: 14 cost time: 56.01007390022278
Epoch: 14, Steps: 208 | Train Loss: 0.695 Vali Loss: 9.325 Vali Acc: 0.076 Test Loss: 9.325 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.4480213
	speed: 0.6539s/iter; left time: 11631.3954s
	iters: 200, epoch: 15 | loss: 0.3404104
	speed: 0.2546s/iter; left time: 4503.4570s
Epoch: 15 cost time: 55.9295175075531
Epoch: 15, Steps: 208 | Train Loss: 0.619 Vali Loss: 9.423 Vali Acc: 0.084 Test Loss: 9.423 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1546590
	speed: 0.6674s/iter; left time: 11733.5463s
	iters: 200, epoch: 16 | loss: 0.9962115
	speed: 0.2884s/iter; left time: 5041.6095s
Epoch: 16 cost time: 60.75066256523132
Epoch: 16, Steps: 208 | Train Loss: 0.611 Vali Loss: 9.485 Vali Acc: 0.074 Test Loss: 9.485 Test Acc: 0.074
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5038214
	speed: 0.6739s/iter; left time: 11707.2167s
	iters: 200, epoch: 17 | loss: 0.3417524
	speed: 0.2951s/iter; left time: 5096.5712s
Epoch: 17 cost time: 62.363916635513306
Epoch: 17, Steps: 208 | Train Loss: 0.551 Vali Loss: 9.398 Vali Acc: 0.090 Test Loss: 9.398 Test Acc: 0.090
Validation loss decreased (-0.088203 --> -0.089676).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1991903
	speed: 0.6727s/iter; left time: 11547.6298s
	iters: 200, epoch: 18 | loss: 0.8560656
	speed: 0.2784s/iter; left time: 4751.2781s
Epoch: 18 cost time: 57.70432901382446
Epoch: 18, Steps: 208 | Train Loss: 0.551 Vali Loss: 10.208 Vali Acc: 0.076 Test Loss: 10.208 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8205430
	speed: 0.6897s/iter; left time: 11695.8927s
	iters: 200, epoch: 19 | loss: 0.9788748
	speed: 0.2958s/iter; left time: 4986.3244s
Epoch: 19 cost time: 62.10889959335327
Epoch: 19, Steps: 208 | Train Loss: 0.535 Vali Loss: 9.726 Vali Acc: 0.075 Test Loss: 9.726 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0851689
	speed: 0.7032s/iter; left time: 11777.5462s
	iters: 200, epoch: 20 | loss: 1.0850433
	speed: 0.2973s/iter; left time: 4949.4456s
Epoch: 20 cost time: 63.01628041267395
Epoch: 20, Steps: 208 | Train Loss: 0.509 Vali Loss: 9.667 Vali Acc: 0.085 Test Loss: 9.667 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.8953118
	speed: 0.6375s/iter; left time: 10545.6833s
	iters: 200, epoch: 21 | loss: 0.1497141
	speed: 0.2943s/iter; left time: 4838.7438s
Epoch: 21 cost time: 60.271820068359375
Epoch: 21, Steps: 208 | Train Loss: 0.496 Vali Loss: 9.820 Vali Acc: 0.087 Test Loss: 9.820 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2398145
	speed: 0.6892s/iter; left time: 11256.5981s
	iters: 200, epoch: 22 | loss: 0.2824513
	speed: 0.2885s/iter; left time: 4682.5369s
Epoch: 22 cost time: 60.838011026382446
Epoch: 22, Steps: 208 | Train Loss: 0.451 Vali Loss: 10.143 Vali Acc: 0.090 Test Loss: 10.143 Test Acc: 0.090
Validation loss decreased (-0.089676 --> -0.090265).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.8586516
	speed: 0.6958s/iter; left time: 11219.0054s
	iters: 200, epoch: 23 | loss: 0.8548830
	speed: 0.2773s/iter; left time: 4444.4387s
Epoch: 23 cost time: 60.71871089935303
Epoch: 23, Steps: 208 | Train Loss: 0.443 Vali Loss: 10.102 Vali Acc: 0.085 Test Loss: 10.102 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.6535448
	speed: 0.6619s/iter; left time: 10535.2237s
	iters: 200, epoch: 24 | loss: 0.6679742
	speed: 0.2977s/iter; left time: 4709.0093s
Epoch: 24 cost time: 62.249093532562256
Epoch: 24, Steps: 208 | Train Loss: 0.402 Vali Loss: 10.169 Vali Acc: 0.089 Test Loss: 10.169 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2789596
	speed: 0.6433s/iter; left time: 10106.1696s
	iters: 200, epoch: 25 | loss: 0.5497742
	speed: 0.2927s/iter; left time: 4569.4941s
Epoch: 25 cost time: 60.4836483001709
Epoch: 25, Steps: 208 | Train Loss: 0.351 Vali Loss: 10.800 Vali Acc: 0.084 Test Loss: 10.800 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.5797284
	speed: 0.6680s/iter; left time: 10354.5555s
	iters: 200, epoch: 26 | loss: 0.5430418
	speed: 0.2651s/iter; left time: 4083.0606s
Epoch: 26 cost time: 57.312352657318115
Epoch: 26, Steps: 208 | Train Loss: 0.375 Vali Loss: 10.280 Vali Acc: 0.076 Test Loss: 10.280 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.3466390
	speed: 0.6668s/iter; left time: 10197.1983s
	iters: 200, epoch: 27 | loss: 0.0218220
	speed: 0.3013s/iter; left time: 4576.9084s
Epoch: 27 cost time: 62.473655223846436
Epoch: 27, Steps: 208 | Train Loss: 0.315 Vali Loss: 10.896 Vali Acc: 0.089 Test Loss: 10.896 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.5546557
	speed: 0.6494s/iter; left time: 9796.7302s
	iters: 200, epoch: 28 | loss: 0.5810175
	speed: 0.2860s/iter; left time: 4285.1152s
Epoch: 28 cost time: 59.0856773853302
Epoch: 28, Steps: 208 | Train Loss: 0.370 Vali Loss: 10.637 Vali Acc: 0.081 Test Loss: 10.637 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.3555827
	speed: 0.6499s/iter; left time: 9668.6554s
	iters: 200, epoch: 29 | loss: 0.8096378
	speed: 0.2772s/iter; left time: 4095.8976s
Epoch: 29 cost time: 56.66873073577881
Epoch: 29, Steps: 208 | Train Loss: 0.305 Vali Loss: 11.381 Vali Acc: 0.091 Test Loss: 11.381 Test Acc: 0.091
Validation loss decreased (-0.090265 --> -0.090551).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.1165067
	speed: 0.6595s/iter; left time: 9674.8348s
	iters: 200, epoch: 30 | loss: 0.1282919
	speed: 0.2874s/iter; left time: 4187.3488s
Epoch: 30 cost time: 58.94198274612427
Epoch: 30, Steps: 208 | Train Loss: 0.354 Vali Loss: 10.863 Vali Acc: 0.087 Test Loss: 10.863 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.2265369
	speed: 0.6963s/iter; left time: 10069.8551s
	iters: 200, epoch: 31 | loss: 0.2120601
	speed: 0.2913s/iter; left time: 4182.8590s
Epoch: 31 cost time: 61.31189036369324
Epoch: 31, Steps: 208 | Train Loss: 0.295 Vali Loss: 11.203 Vali Acc: 0.097 Test Loss: 11.203 Test Acc: 0.097
Validation loss decreased (-0.090551 --> -0.096816).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.2472010
	speed: 0.6837s/iter; left time: 9744.8525s
	iters: 200, epoch: 32 | loss: 0.3132489
	speed: 0.2864s/iter; left time: 4053.6152s
Epoch: 32 cost time: 59.79029989242554
Epoch: 32, Steps: 208 | Train Loss: 0.294 Vali Loss: 11.206 Vali Acc: 0.090 Test Loss: 11.206 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.2122741
	speed: 0.6648s/iter; left time: 9336.6844s
	iters: 200, epoch: 33 | loss: 0.0157455
	speed: 0.2739s/iter; left time: 3819.5905s
Epoch: 33 cost time: 59.21079134941101
Epoch: 33, Steps: 208 | Train Loss: 0.287 Vali Loss: 11.798 Vali Acc: 0.092 Test Loss: 11.798 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.2774717
	speed: 0.6907s/iter; left time: 9556.6084s
	iters: 200, epoch: 34 | loss: 0.5179134
	speed: 0.3042s/iter; left time: 4178.1448s
Epoch: 34 cost time: 63.441489458084106
Epoch: 34, Steps: 208 | Train Loss: 0.310 Vali Loss: 11.304 Vali Acc: 0.082 Test Loss: 11.304 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.2903721
	speed: 0.6948s/iter; left time: 9469.7450s
	iters: 200, epoch: 35 | loss: 0.1692168
	speed: 0.2801s/iter; left time: 3789.0404s
Epoch: 35 cost time: 61.032679319381714
Epoch: 35, Steps: 208 | Train Loss: 0.312 Vali Loss: 12.133 Vali Acc: 0.086 Test Loss: 12.133 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0775628
	speed: 0.6638s/iter; left time: 8908.4298s
	iters: 200, epoch: 36 | loss: 0.0152882
	speed: 0.2888s/iter; left time: 3847.0113s
Epoch: 36 cost time: 61.684264183044434
Epoch: 36, Steps: 208 | Train Loss: 0.259 Vali Loss: 12.048 Vali Acc: 0.080 Test Loss: 12.048 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.1798875
	speed: 0.6649s/iter; left time: 8784.8432s
	iters: 200, epoch: 37 | loss: 0.2874610
	speed: 0.3073s/iter; left time: 4029.8571s
Epoch: 37 cost time: 63.986700773239136
Epoch: 37, Steps: 208 | Train Loss: 0.291 Vali Loss: 11.690 Vali Acc: 0.084 Test Loss: 11.690 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.3815315
	speed: 0.6467s/iter; left time: 8410.0975s
	iters: 200, epoch: 38 | loss: 0.1229689
	speed: 0.2927s/iter; left time: 3777.2928s
Epoch: 38 cost time: 61.181031942367554
Epoch: 38, Steps: 208 | Train Loss: 0.221 Vali Loss: 12.160 Vali Acc: 0.093 Test Loss: 12.160 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.7665921
	speed: 0.6244s/iter; left time: 7990.6877s
	iters: 200, epoch: 39 | loss: 0.5614871
	speed: 0.2912s/iter; left time: 3697.9848s
Epoch: 39 cost time: 59.53241753578186
Epoch: 39, Steps: 208 | Train Loss: 0.241 Vali Loss: 11.938 Vali Acc: 0.090 Test Loss: 11.938 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0241049
	speed: 0.6432s/iter; left time: 8096.9028s
	iters: 200, epoch: 40 | loss: 0.6814584
	speed: 0.2960s/iter; left time: 3696.8018s
Epoch: 40 cost time: 60.68211102485657
Epoch: 40, Steps: 208 | Train Loss: 0.254 Vali Loss: 11.856 Vali Acc: 0.097 Test Loss: 11.856 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.7880929
	speed: 0.6469s/iter; left time: 8009.1107s
	iters: 200, epoch: 41 | loss: 0.6388485
	speed: 0.2971s/iter; left time: 3648.4804s
Epoch: 41 cost time: 60.84639024734497
Epoch: 41, Steps: 208 | Train Loss: 0.260 Vali Loss: 11.883 Vali Acc: 0.094 Test Loss: 11.883 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0969281240679988
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5715110
	speed: 0.3006s/iter; left time: 6222.3536s
	iters: 200, epoch: 1 | loss: 4.8510599
	speed: 0.2847s/iter; left time: 5865.7931s
Epoch: 1 cost time: 60.86459732055664
Epoch: 1, Steps: 208 | Train Loss: 4.080 Vali Loss: 5.366 Vali Acc: 0.063 Test Loss: 5.366 Test Acc: 0.063
Validation loss decreased (inf --> -0.062577).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6397388
	speed: 0.6346s/iter; left time: 13005.4205s
	iters: 200, epoch: 2 | loss: 4.7488122
	speed: 0.2766s/iter; left time: 5640.8652s
Epoch: 2 cost time: 58.45564532279968
Epoch: 2, Steps: 208 | Train Loss: 3.847 Vali Loss: 6.598 Vali Acc: 0.072 Test Loss: 6.598 Test Acc: 0.072
Validation loss decreased (-0.062577 --> -0.072406).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2729871
	speed: 0.6506s/iter; left time: 13197.2770s
	iters: 200, epoch: 3 | loss: 3.7764213
	speed: 0.2939s/iter; left time: 5931.7444s
Epoch: 3 cost time: 60.34064960479736
Epoch: 3, Steps: 208 | Train Loss: 3.587 Vali Loss: 7.460 Vali Acc: 0.072 Test Loss: 7.460 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2756009
	speed: 0.6558s/iter; left time: 13165.9129s
	iters: 200, epoch: 4 | loss: 3.5876362
	speed: 0.2975s/iter; left time: 5943.3000s
Epoch: 4 cost time: 60.664231061935425
Epoch: 4, Steps: 208 | Train Loss: 3.031 Vali Loss: 7.298 Vali Acc: 0.074 Test Loss: 7.298 Test Acc: 0.074
Validation loss decreased (-0.072406 --> -0.073592).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3376741
	speed: 0.6403s/iter; left time: 12721.3243s
	iters: 200, epoch: 5 | loss: 3.0024729
	speed: 0.2804s/iter; left time: 5543.8783s
Epoch: 5 cost time: 58.23487830162048
Epoch: 5, Steps: 208 | Train Loss: 2.441 Vali Loss: 7.081 Vali Acc: 0.069 Test Loss: 7.081 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.6947079
	speed: 0.6385s/iter; left time: 12553.1094s
	iters: 200, epoch: 6 | loss: 1.5780602
	speed: 0.2792s/iter; left time: 5461.3857s
Epoch: 6 cost time: 57.793354511260986
Epoch: 6, Steps: 208 | Train Loss: 2.082 Vali Loss: 7.239 Vali Acc: 0.075 Test Loss: 7.239 Test Acc: 0.075
Validation loss decreased (-0.073592 --> -0.074488).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6357007
	speed: 0.6674s/iter; left time: 12982.3361s
	iters: 200, epoch: 7 | loss: 1.5288430
	speed: 0.2845s/iter; left time: 5506.2406s
Epoch: 7 cost time: 59.04587388038635
Epoch: 7, Steps: 208 | Train Loss: 1.629 Vali Loss: 7.265 Vali Acc: 0.075 Test Loss: 7.265 Test Acc: 0.075
Validation loss decreased (-0.074488 --> -0.075382).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3946576
	speed: 0.6380s/iter; left time: 12277.9088s
	iters: 200, epoch: 8 | loss: 0.9447451
	speed: 0.2464s/iter; left time: 4716.5757s
Epoch: 8 cost time: 53.11891770362854
Epoch: 8, Steps: 208 | Train Loss: 1.402 Vali Loss: 7.320 Vali Acc: 0.070 Test Loss: 7.320 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1478354
	speed: 0.6511s/iter; left time: 12395.2361s
	iters: 200, epoch: 9 | loss: 1.5586267
	speed: 0.2522s/iter; left time: 4776.7894s
Epoch: 9 cost time: 55.487783908843994
Epoch: 9, Steps: 208 | Train Loss: 1.205 Vali Loss: 7.623 Vali Acc: 0.075 Test Loss: 7.623 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7870002
	speed: 0.6280s/iter; left time: 11825.5070s
	iters: 200, epoch: 10 | loss: 1.7176211
	speed: 0.2703s/iter; left time: 5063.2125s
Epoch: 10 cost time: 57.283971548080444
Epoch: 10, Steps: 208 | Train Loss: 1.086 Vali Loss: 7.599 Vali Acc: 0.072 Test Loss: 7.599 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0209944
	speed: 0.6615s/iter; left time: 12318.3580s
	iters: 200, epoch: 11 | loss: 1.5612875
	speed: 0.2731s/iter; left time: 5057.8978s
Epoch: 11 cost time: 57.19726610183716
Epoch: 11, Steps: 208 | Train Loss: 0.937 Vali Loss: 8.329 Vali Acc: 0.073 Test Loss: 8.329 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4147709
	speed: 0.6109s/iter; left time: 11248.9694s
	iters: 200, epoch: 12 | loss: 0.9452587
	speed: 0.2751s/iter; left time: 5038.0219s
Epoch: 12 cost time: 55.99506068229675
Epoch: 12, Steps: 208 | Train Loss: 0.822 Vali Loss: 8.271 Vali Acc: 0.076 Test Loss: 8.271 Test Acc: 0.076
Validation loss decreased (-0.075382 --> -0.075969).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4294537
	speed: 0.6226s/iter; left time: 11334.3369s
	iters: 200, epoch: 13 | loss: 0.7073488
	speed: 0.2632s/iter; left time: 4765.4835s
Epoch: 13 cost time: 56.89183044433594
Epoch: 13, Steps: 208 | Train Loss: 0.798 Vali Loss: 8.573 Vali Acc: 0.074 Test Loss: 8.573 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1603197
	speed: 0.6455s/iter; left time: 11617.6800s
	iters: 200, epoch: 14 | loss: 1.0596123
	speed: 0.2714s/iter; left time: 4857.6437s
Epoch: 14 cost time: 57.59849286079407
Epoch: 14, Steps: 208 | Train Loss: 0.736 Vali Loss: 8.380 Vali Acc: 0.069 Test Loss: 8.380 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4506829
	speed: 0.6484s/iter; left time: 11534.7425s
	iters: 200, epoch: 15 | loss: 0.1723616
	speed: 0.2805s/iter; left time: 4961.9348s
Epoch: 15 cost time: 57.37195420265198
Epoch: 15, Steps: 208 | Train Loss: 0.668 Vali Loss: 8.594 Vali Acc: 0.075 Test Loss: 8.594 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4095815
	speed: 0.6522s/iter; left time: 11465.5749s
	iters: 200, epoch: 16 | loss: 0.5717140
	speed: 0.2729s/iter; left time: 4769.7633s
Epoch: 16 cost time: 58.47403430938721
Epoch: 16, Steps: 208 | Train Loss: 0.580 Vali Loss: 8.803 Vali Acc: 0.072 Test Loss: 8.803 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4931271
	speed: 0.6509s/iter; left time: 11308.7055s
	iters: 200, epoch: 17 | loss: 1.3645016
	speed: 0.2675s/iter; left time: 4620.4615s
Epoch: 17 cost time: 57.26829504966736
Epoch: 17, Steps: 208 | Train Loss: 0.584 Vali Loss: 8.606 Vali Acc: 0.071 Test Loss: 8.606 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1656491
	speed: 0.6699s/iter; left time: 11499.3372s
	iters: 200, epoch: 18 | loss: 0.6560833
	speed: 0.2865s/iter; left time: 4889.5815s
Epoch: 18 cost time: 59.272740840911865
Epoch: 18, Steps: 208 | Train Loss: 0.549 Vali Loss: 8.964 Vali Acc: 0.067 Test Loss: 8.964 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3385195
	speed: 0.6641s/iter; left time: 11260.4295s
	iters: 200, epoch: 19 | loss: 0.4064258
	speed: 0.2768s/iter; left time: 4665.2827s
Epoch: 19 cost time: 58.58130717277527
Epoch: 19, Steps: 208 | Train Loss: 0.528 Vali Loss: 9.195 Vali Acc: 0.069 Test Loss: 9.195 Test Acc: 0.069
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.3202962
	speed: 0.6439s/iter; left time: 10784.1976s
	iters: 200, epoch: 20 | loss: 0.2412028
	speed: 0.2560s/iter; left time: 4262.4520s
Epoch: 20 cost time: 55.588481187820435
Epoch: 20, Steps: 208 | Train Loss: 0.495 Vali Loss: 9.195 Vali Acc: 0.085 Test Loss: 9.195 Test Acc: 0.085
Validation loss decreased (-0.075969 --> -0.084907).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5181232
	speed: 0.6567s/iter; left time: 10862.5985s
	iters: 200, epoch: 21 | loss: 0.6487373
	speed: 0.2742s/iter; left time: 4507.9854s
Epoch: 21 cost time: 58.045087814331055
Epoch: 21, Steps: 208 | Train Loss: 0.486 Vali Loss: 9.305 Vali Acc: 0.075 Test Loss: 9.305 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6713827
	speed: 0.6598s/iter; left time: 10777.0816s
	iters: 200, epoch: 22 | loss: 0.7178321
	speed: 0.2828s/iter; left time: 4591.1167s
Epoch: 22 cost time: 58.54856491088867
Epoch: 22, Steps: 208 | Train Loss: 0.472 Vali Loss: 9.321 Vali Acc: 0.084 Test Loss: 9.321 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5155035
	speed: 0.6491s/iter; left time: 10467.2895s
	iters: 200, epoch: 23 | loss: 1.1419041
	speed: 0.2555s/iter; left time: 4094.2350s
Epoch: 23 cost time: 56.653244495391846
Epoch: 23, Steps: 208 | Train Loss: 0.424 Vali Loss: 9.604 Vali Acc: 0.079 Test Loss: 9.604 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.9565635
	speed: 0.6329s/iter; left time: 10074.5159s
	iters: 200, epoch: 24 | loss: 0.4869437
	speed: 0.2660s/iter; left time: 4207.6003s
Epoch: 24 cost time: 56.25660824775696
Epoch: 24, Steps: 208 | Train Loss: 0.460 Vali Loss: 9.619 Vali Acc: 0.081 Test Loss: 9.619 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.5701711
	speed: 0.6562s/iter; left time: 10308.1494s
	iters: 200, epoch: 25 | loss: 0.0924433
	speed: 0.2839s/iter; left time: 4431.3492s
Epoch: 25 cost time: 58.03123736381531
Epoch: 25, Steps: 208 | Train Loss: 0.408 Vali Loss: 9.836 Vali Acc: 0.078 Test Loss: 9.836 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.2595115
	speed: 0.6629s/iter; left time: 10275.0438s
	iters: 200, epoch: 26 | loss: 0.2988590
	speed: 0.2594s/iter; left time: 3995.1973s
Epoch: 26 cost time: 56.343640089035034
Epoch: 26, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.910 Vali Acc: 0.076 Test Loss: 9.910 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.4036764
	speed: 0.6468s/iter; left time: 9892.0861s
	iters: 200, epoch: 27 | loss: 0.5421067
	speed: 0.2652s/iter; left time: 4029.6812s
Epoch: 27 cost time: 57.83920335769653
Epoch: 27, Steps: 208 | Train Loss: 0.405 Vali Loss: 9.964 Vali Acc: 0.078 Test Loss: 9.964 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.8258680
	speed: 0.6585s/iter; left time: 9933.3433s
	iters: 200, epoch: 28 | loss: 0.6385252
	speed: 0.2794s/iter; left time: 4186.2920s
Epoch: 28 cost time: 58.52498197555542
Epoch: 28, Steps: 208 | Train Loss: 0.369 Vali Loss: 10.160 Vali Acc: 0.086 Test Loss: 10.160 Test Acc: 0.086
Validation loss decreased (-0.084907 --> -0.086388).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.4134772
	speed: 0.6580s/iter; left time: 9789.1427s
	iters: 200, epoch: 29 | loss: 0.3803542
	speed: 0.2847s/iter; left time: 4206.9073s
Epoch: 29 cost time: 58.26453161239624
Epoch: 29, Steps: 208 | Train Loss: 0.379 Vali Loss: 9.814 Vali Acc: 0.072 Test Loss: 9.814 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.4095477
	speed: 0.6120s/iter; left time: 8976.8539s
	iters: 200, epoch: 30 | loss: 0.1055876
	speed: 0.2686s/iter; left time: 3912.8651s
Epoch: 30 cost time: 55.68699860572815
Epoch: 30, Steps: 208 | Train Loss: 0.298 Vali Loss: 10.366 Vali Acc: 0.082 Test Loss: 10.366 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.6645131
	speed: 0.6368s/iter; left time: 9208.6477s
	iters: 200, epoch: 31 | loss: 0.0256516
	speed: 0.2715s/iter; left time: 3898.3882s
Epoch: 31 cost time: 57.81512093544006
Epoch: 31, Steps: 208 | Train Loss: 0.358 Vali Loss: 10.348 Vali Acc: 0.082 Test Loss: 10.348 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.4137787
	speed: 0.6516s/iter; left time: 9286.7104s
	iters: 200, epoch: 32 | loss: 0.3968619
	speed: 0.2694s/iter; left time: 3813.3850s
Epoch: 32 cost time: 56.18948745727539
Epoch: 32, Steps: 208 | Train Loss: 0.320 Vali Loss: 10.230 Vali Acc: 0.075 Test Loss: 10.230 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.1090394
	speed: 0.6470s/iter; left time: 9087.1121s
	iters: 200, epoch: 33 | loss: 0.1609727
	speed: 0.2825s/iter; left time: 3939.5947s
Epoch: 33 cost time: 58.53467869758606
Epoch: 33, Steps: 208 | Train Loss: 0.298 Vali Loss: 10.441 Vali Acc: 0.067 Test Loss: 10.441 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.2872505
	speed: 0.6135s/iter; left time: 8488.5651s
	iters: 200, epoch: 34 | loss: 1.4051868
	speed: 0.2652s/iter; left time: 3642.4460s
Epoch: 34 cost time: 54.804908990859985
Epoch: 34, Steps: 208 | Train Loss: 0.317 Vali Loss: 10.169 Vali Acc: 0.073 Test Loss: 10.169 Test Acc: 0.073
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.1878490
	speed: 0.6577s/iter; left time: 8963.8912s
	iters: 200, epoch: 35 | loss: 0.1998788
	speed: 0.2637s/iter; left time: 3567.5916s
Epoch: 35 cost time: 56.03395366668701
Epoch: 35, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.434 Vali Acc: 0.086 Test Loss: 10.434 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0884478
	speed: 0.6237s/iter; left time: 8370.7547s
	iters: 200, epoch: 36 | loss: 0.0804350
	speed: 0.2741s/iter; left time: 3651.4966s
Epoch: 36 cost time: 56.702609062194824
Epoch: 36, Steps: 208 | Train Loss: 0.301 Vali Loss: 10.588 Vali Acc: 0.075 Test Loss: 10.588 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.2904413
	speed: 0.6630s/iter; left time: 8760.2327s
	iters: 200, epoch: 37 | loss: 0.3286836
	speed: 0.2584s/iter; left time: 3388.4158s
Epoch: 37 cost time: 56.75811767578125
Epoch: 37, Steps: 208 | Train Loss: 0.255 Vali Loss: 10.359 Vali Acc: 0.072 Test Loss: 10.359 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.3622803
	speed: 0.6277s/iter; left time: 8163.8293s
	iters: 200, epoch: 38 | loss: 0.1100029
	speed: 0.2744s/iter; left time: 3541.1135s
Epoch: 38 cost time: 56.79636240005493
Epoch: 38, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.013 Vali Acc: 0.077 Test Loss: 11.013 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0864897107068297
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2501760
	speed: 0.3014s/iter; left time: 6238.4965s
	iters: 200, epoch: 1 | loss: 4.8396387
	speed: 0.2779s/iter; left time: 5724.7244s
Epoch: 1 cost time: 60.43244814872742
Epoch: 1, Steps: 208 | Train Loss: 4.049 Vali Loss: 5.357 Vali Acc: 0.036 Test Loss: 5.357 Test Acc: 0.036
Validation loss decreased (inf --> -0.035735).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6203103
	speed: 0.6705s/iter; left time: 13740.0061s
	iters: 200, epoch: 2 | loss: 4.7037845
	speed: 0.2736s/iter; left time: 5579.9738s
Epoch: 2 cost time: 58.63945007324219
Epoch: 2, Steps: 208 | Train Loss: 3.888 Vali Loss: 6.787 Vali Acc: 0.049 Test Loss: 6.787 Test Acc: 0.049
Validation loss decreased (-0.035735 --> -0.048844).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6933894
	speed: 0.6147s/iter; left time: 12468.6859s
	iters: 200, epoch: 3 | loss: 4.0006690
	speed: 0.2779s/iter; left time: 5609.5665s
Epoch: 3 cost time: 56.6043655872345
Epoch: 3, Steps: 208 | Train Loss: 3.823 Vali Loss: 7.232 Vali Acc: 0.041 Test Loss: 7.232 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.9338055
	speed: 0.6716s/iter; left time: 13483.1325s
	iters: 200, epoch: 4 | loss: 3.8779886
	speed: 0.2835s/iter; left time: 5663.9696s
Epoch: 4 cost time: 60.15097093582153
Epoch: 4, Steps: 208 | Train Loss: 3.299 Vali Loss: 6.853 Vali Acc: 0.047 Test Loss: 6.853 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.4107022
	speed: 0.6674s/iter; left time: 13259.6278s
	iters: 200, epoch: 5 | loss: 3.3572810
	speed: 0.2907s/iter; left time: 5746.7572s
Epoch: 5 cost time: 60.325523853302
Epoch: 5, Steps: 208 | Train Loss: 2.805 Vali Loss: 6.452 Vali Acc: 0.059 Test Loss: 6.452 Test Acc: 0.059
Validation loss decreased (-0.048844 --> -0.058689).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1023455
	speed: 0.6271s/iter; left time: 12329.8996s
	iters: 200, epoch: 6 | loss: 2.0744252
	speed: 0.2696s/iter; left time: 5272.9190s
Epoch: 6 cost time: 55.754340171813965
Epoch: 6, Steps: 208 | Train Loss: 2.388 Vali Loss: 6.588 Vali Acc: 0.062 Test Loss: 6.588 Test Acc: 0.062
Validation loss decreased (-0.058689 --> -0.061968).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0859709
	speed: 0.6199s/iter; left time: 12058.7883s
	iters: 200, epoch: 7 | loss: 3.0146790
	speed: 0.2705s/iter; left time: 5235.1166s
Epoch: 7 cost time: 56.619306564331055
Epoch: 7, Steps: 208 | Train Loss: 1.902 Vali Loss: 6.297 Vali Acc: 0.063 Test Loss: 6.297 Test Acc: 0.063
Validation loss decreased (-0.061968 --> -0.062568).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1319804
	speed: 0.6478s/iter; left time: 12466.0416s
	iters: 200, epoch: 8 | loss: 1.8132346
	speed: 0.2603s/iter; left time: 4982.9355s
Epoch: 8 cost time: 55.77403426170349
Epoch: 8, Steps: 208 | Train Loss: 1.622 Vali Loss: 6.868 Vali Acc: 0.066 Test Loss: 6.868 Test Acc: 0.066
Validation loss decreased (-0.062568 --> -0.065544).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6446307
	speed: 0.6075s/iter; left time: 11564.4055s
	iters: 200, epoch: 9 | loss: 1.4178510
	speed: 0.2615s/iter; left time: 4951.8782s
Epoch: 9 cost time: 55.288795948028564
Epoch: 9, Steps: 208 | Train Loss: 1.324 Vali Loss: 7.094 Vali Acc: 0.060 Test Loss: 7.094 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1727846
	speed: 0.5994s/iter; left time: 11286.7497s
	iters: 200, epoch: 10 | loss: 1.1996108
	speed: 0.2498s/iter; left time: 4678.6084s
Epoch: 10 cost time: 53.090707540512085
Epoch: 10, Steps: 208 | Train Loss: 1.178 Vali Loss: 7.429 Vali Acc: 0.063 Test Loss: 7.429 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.7743815
	speed: 0.6175s/iter; left time: 11499.0139s
	iters: 200, epoch: 11 | loss: 1.6220483
	speed: 0.2877s/iter; left time: 5327.9041s
Epoch: 11 cost time: 59.50498580932617
Epoch: 11, Steps: 208 | Train Loss: 1.018 Vali Loss: 7.296 Vali Acc: 0.071 Test Loss: 7.296 Test Acc: 0.071
Validation loss decreased (-0.065544 --> -0.070908).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6456897
	speed: 0.5985s/iter; left time: 11020.6085s
	iters: 200, epoch: 12 | loss: 0.7256802
	speed: 0.2598s/iter; left time: 4757.9046s
Epoch: 12 cost time: 54.34450888633728
Epoch: 12, Steps: 208 | Train Loss: 0.955 Vali Loss: 7.768 Vali Acc: 0.065 Test Loss: 7.768 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2525486
	speed: 0.6146s/iter; left time: 11188.2162s
	iters: 200, epoch: 13 | loss: 0.3531193
	speed: 0.2558s/iter; left time: 4631.9816s
Epoch: 13 cost time: 54.87823796272278
Epoch: 13, Steps: 208 | Train Loss: 0.859 Vali Loss: 7.964 Vali Acc: 0.074 Test Loss: 7.964 Test Acc: 0.074
Validation loss decreased (-0.070908 --> -0.073586).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7824692
	speed: 0.6038s/iter; left time: 10866.9935s
	iters: 200, epoch: 14 | loss: 1.3110732
	speed: 0.2670s/iter; left time: 4777.9871s
Epoch: 14 cost time: 54.9931914806366
Epoch: 14, Steps: 208 | Train Loss: 0.790 Vali Loss: 8.206 Vali Acc: 0.069 Test Loss: 8.206 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9288322
	speed: 0.6655s/iter; left time: 11837.8486s
	iters: 200, epoch: 15 | loss: 0.2770064
	speed: 0.2548s/iter; left time: 4507.1593s
Epoch: 15 cost time: 56.54963183403015
Epoch: 15, Steps: 208 | Train Loss: 0.714 Vali Loss: 8.342 Vali Acc: 0.073 Test Loss: 8.342 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9959842
	speed: 0.6002s/iter; left time: 10552.5167s
	iters: 200, epoch: 16 | loss: 1.2520002
	speed: 0.2644s/iter; left time: 4622.6598s
Epoch: 16 cost time: 53.86508083343506
Epoch: 16, Steps: 208 | Train Loss: 0.646 Vali Loss: 8.619 Vali Acc: 0.066 Test Loss: 8.619 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4445465
	speed: 0.6437s/iter; left time: 11182.5610s
	iters: 200, epoch: 17 | loss: 1.8006465
	speed: 0.2436s/iter; left time: 4207.3983s
Epoch: 17 cost time: 54.35176134109497
Epoch: 17, Steps: 208 | Train Loss: 0.630 Vali Loss: 8.536 Vali Acc: 0.072 Test Loss: 8.536 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3960503
	speed: 0.5920s/iter; left time: 10161.6479s
	iters: 200, epoch: 18 | loss: 0.8390903
	speed: 0.2735s/iter; left time: 4666.9211s
Epoch: 18 cost time: 55.352805376052856
Epoch: 18, Steps: 208 | Train Loss: 0.565 Vali Loss: 8.799 Vali Acc: 0.067 Test Loss: 8.799 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1168441
	speed: 0.5859s/iter; left time: 9935.4439s
	iters: 200, epoch: 19 | loss: 1.3446831
	speed: 0.2653s/iter; left time: 4472.8744s
Epoch: 19 cost time: 53.40742230415344
Epoch: 19, Steps: 208 | Train Loss: 0.513 Vali Loss: 8.904 Vali Acc: 0.070 Test Loss: 8.904 Test Acc: 0.070
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.4266492
	speed: 0.6327s/iter; left time: 10596.2922s
	iters: 200, epoch: 20 | loss: 0.2938814
	speed: 0.2829s/iter; left time: 4709.6323s
Epoch: 20 cost time: 58.30707097053528
Epoch: 20, Steps: 208 | Train Loss: 0.466 Vali Loss: 8.637 Vali Acc: 0.081 Test Loss: 8.637 Test Acc: 0.081
Validation loss decreased (-0.073586 --> -0.080737).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3354705
	speed: 0.6191s/iter; left time: 10241.2340s
	iters: 200, epoch: 21 | loss: 0.6637772
	speed: 0.2525s/iter; left time: 4151.9126s
Epoch: 21 cost time: 53.29459238052368
Epoch: 21, Steps: 208 | Train Loss: 0.454 Vali Loss: 9.080 Vali Acc: 0.077 Test Loss: 9.080 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5756138
	speed: 0.6135s/iter; left time: 10020.7018s
	iters: 200, epoch: 22 | loss: 0.4914974
	speed: 0.2666s/iter; left time: 4327.9345s
Epoch: 22 cost time: 55.690070152282715
Epoch: 22, Steps: 208 | Train Loss: 0.433 Vali Loss: 9.154 Vali Acc: 0.074 Test Loss: 9.154 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4265535
	speed: 0.6366s/iter; left time: 10265.5505s
	iters: 200, epoch: 23 | loss: 0.8873395
	speed: 0.2639s/iter; left time: 4229.1699s
Epoch: 23 cost time: 56.84587049484253
Epoch: 23, Steps: 208 | Train Loss: 0.443 Vali Loss: 9.594 Vali Acc: 0.064 Test Loss: 9.594 Test Acc: 0.064
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.4094489
	speed: 0.6406s/iter; left time: 10195.6977s
	iters: 200, epoch: 24 | loss: 0.2280651
	speed: 0.2712s/iter; left time: 4288.7801s
Epoch: 24 cost time: 57.40590763092041
Epoch: 24, Steps: 208 | Train Loss: 0.368 Vali Loss: 9.675 Vali Acc: 0.082 Test Loss: 9.675 Test Acc: 0.082
Validation loss decreased (-0.080737 --> -0.082218).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.2831000
	speed: 0.5883s/iter; left time: 9241.3538s
	iters: 200, epoch: 25 | loss: 0.4068503
	speed: 0.2555s/iter; left time: 3987.3319s
Epoch: 25 cost time: 52.793986320495605
Epoch: 25, Steps: 208 | Train Loss: 0.380 Vali Loss: 10.001 Vali Acc: 0.076 Test Loss: 10.001 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.4564445
	speed: 0.6446s/iter; left time: 9992.1617s
	iters: 200, epoch: 26 | loss: 0.4836501
	speed: 0.2715s/iter; left time: 4181.9966s
Epoch: 26 cost time: 57.55728816986084
Epoch: 26, Steps: 208 | Train Loss: 0.339 Vali Loss: 10.208 Vali Acc: 0.072 Test Loss: 10.208 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1954336
	speed: 0.6459s/iter; left time: 9878.1475s
	iters: 200, epoch: 27 | loss: 0.5674056
	speed: 0.2808s/iter; left time: 4266.1472s
Epoch: 27 cost time: 58.08692765235901
Epoch: 27, Steps: 208 | Train Loss: 0.347 Vali Loss: 10.641 Vali Acc: 0.076 Test Loss: 10.641 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1044792
	speed: 0.6456s/iter; left time: 9738.4969s
	iters: 200, epoch: 28 | loss: 0.2400544
	speed: 0.2673s/iter; left time: 4005.5319s
Epoch: 28 cost time: 55.34115552902222
Epoch: 28, Steps: 208 | Train Loss: 0.388 Vali Loss: 9.921 Vali Acc: 0.082 Test Loss: 9.921 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.4402409
	speed: 0.6393s/iter; left time: 9510.6515s
	iters: 200, epoch: 29 | loss: 0.4505504
	speed: 0.2768s/iter; left time: 4089.9876s
Epoch: 29 cost time: 59.30310654640198
Epoch: 29, Steps: 208 | Train Loss: 0.369 Vali Loss: 10.329 Vali Acc: 0.080 Test Loss: 10.329 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.4824544
	speed: 0.6403s/iter; left time: 9392.4067s
	iters: 200, epoch: 30 | loss: 0.0904968
	speed: 0.2651s/iter; left time: 3861.5285s
Epoch: 30 cost time: 56.62660813331604
Epoch: 30, Steps: 208 | Train Loss: 0.328 Vali Loss: 9.940 Vali Acc: 0.081 Test Loss: 9.940 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0438503
	speed: 0.6285s/iter; left time: 9088.5263s
	iters: 200, epoch: 31 | loss: 0.1170783
	speed: 0.2849s/iter; left time: 4090.7788s
Epoch: 31 cost time: 58.82236170768738
Epoch: 31, Steps: 208 | Train Loss: 0.348 Vali Loss: 10.259 Vali Acc: 0.076 Test Loss: 10.259 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.3038671
	speed: 0.6056s/iter; left time: 8632.3056s
	iters: 200, epoch: 32 | loss: 0.0616097
	speed: 0.2611s/iter; left time: 3695.6429s
Epoch: 32 cost time: 54.24685454368591
Epoch: 32, Steps: 208 | Train Loss: 0.306 Vali Loss: 10.241 Vali Acc: 0.077 Test Loss: 10.241 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0817206
	speed: 0.6491s/iter; left time: 9116.1216s
	iters: 200, epoch: 33 | loss: 0.7415209
	speed: 0.2676s/iter; left time: 3732.3098s
Epoch: 33 cost time: 57.87707543373108
Epoch: 33, Steps: 208 | Train Loss: 0.292 Vali Loss: 10.443 Vali Acc: 0.080 Test Loss: 10.443 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.2129876
	speed: 0.6235s/iter; left time: 8627.4096s
	iters: 200, epoch: 34 | loss: 1.2514631
	speed: 0.2638s/iter; left time: 3624.2498s
Epoch: 34 cost time: 55.04231262207031
Epoch: 34, Steps: 208 | Train Loss: 0.296 Vali Loss: 10.455 Vali Acc: 0.085 Test Loss: 10.455 Test Acc: 0.085
Validation loss decreased (-0.082218 --> -0.084596).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0580866
	speed: 0.6599s/iter; left time: 8994.0227s
	iters: 200, epoch: 35 | loss: 0.0643902
	speed: 0.2628s/iter; left time: 3555.7640s
Epoch: 35 cost time: 56.93218755722046
Epoch: 35, Steps: 208 | Train Loss: 0.314 Vali Loss: 10.824 Vali Acc: 0.073 Test Loss: 10.824 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0551171
	speed: 0.6026s/iter; left time: 8087.4108s
	iters: 200, epoch: 36 | loss: 0.0900932
	speed: 0.2498s/iter; left time: 3327.8242s
Epoch: 36 cost time: 52.473514795303345
Epoch: 36, Steps: 208 | Train Loss: 0.273 Vali Loss: 10.531 Vali Acc: 0.081 Test Loss: 10.531 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.5192120
	speed: 0.6302s/iter; left time: 8326.1900s
	iters: 200, epoch: 37 | loss: 0.0973627
	speed: 0.2652s/iter; left time: 3478.1032s
Epoch: 37 cost time: 56.95487332344055
Epoch: 37, Steps: 208 | Train Loss: 0.283 Vali Loss: 10.666 Vali Acc: 0.078 Test Loss: 10.666 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.0934070
	speed: 0.6505s/iter; left time: 8460.3351s
	iters: 200, epoch: 38 | loss: 0.8922502
	speed: 0.2895s/iter; left time: 3736.2391s
Epoch: 38 cost time: 59.04407024383545
Epoch: 38, Steps: 208 | Train Loss: 0.298 Vali Loss: 11.102 Vali Acc: 0.080 Test Loss: 11.102 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.3759444
	speed: 0.6360s/iter; left time: 8138.3433s
	iters: 200, epoch: 39 | loss: 0.1183175
	speed: 0.2653s/iter; left time: 3368.9721s
Epoch: 39 cost time: 54.94618844985962
Epoch: 39, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.184 Vali Acc: 0.078 Test Loss: 11.184 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0324317
	speed: 0.6141s/iter; left time: 7730.6959s
	iters: 200, epoch: 40 | loss: 0.0485133
	speed: 0.2900s/iter; left time: 3622.2708s
Epoch: 40 cost time: 58.70443058013916
Epoch: 40, Steps: 208 | Train Loss: 0.251 Vali Loss: 11.343 Vali Acc: 0.075 Test Loss: 11.343 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0307122
	speed: 0.6536s/iter; left time: 8092.4922s
	iters: 200, epoch: 41 | loss: 0.3408714
	speed: 0.2854s/iter; left time: 3505.3080s
Epoch: 41 cost time: 59.215418577194214
Epoch: 41, Steps: 208 | Train Loss: 0.269 Vali Loss: 11.208 Vali Acc: 0.075 Test Loss: 11.208 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0299780
	speed: 0.6672s/iter; left time: 8121.7469s
	iters: 200, epoch: 42 | loss: 0.0215790
	speed: 0.2824s/iter; left time: 3409.9744s
Epoch: 42 cost time: 59.38291096687317
Epoch: 42, Steps: 208 | Train Loss: 0.243 Vali Loss: 11.445 Vali Acc: 0.074 Test Loss: 11.445 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0202228
	speed: 0.6178s/iter; left time: 7392.1261s
	iters: 200, epoch: 43 | loss: 0.6239988
	speed: 0.2660s/iter; left time: 3156.1072s
Epoch: 43 cost time: 54.957457304000854
Epoch: 43, Steps: 208 | Train Loss: 0.238 Vali Loss: 11.089 Vali Acc: 0.076 Test Loss: 11.089 Test Acc: 0.076
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.1112004
	speed: 0.6556s/iter; left time: 7708.1434s
	iters: 200, epoch: 44 | loss: 0.0697084
	speed: 0.2778s/iter; left time: 3237.7603s
Epoch: 44 cost time: 58.388978481292725
Epoch: 44, Steps: 208 | Train Loss: 0.195 Vali Loss: 11.923 Vali Acc: 0.077 Test Loss: 11.923 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08470026841634358
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6371925
	speed: 0.2819s/iter; left time: 5835.6284s
	iters: 200, epoch: 1 | loss: 4.4741216
	speed: 0.2715s/iter; left time: 5593.4643s
Epoch: 1 cost time: 57.59428668022156
Epoch: 1, Steps: 208 | Train Loss: 3.968 Vali Loss: 6.775 Vali Acc: 0.038 Test Loss: 6.775 Test Acc: 0.038
Validation loss decreased (inf --> -0.038107).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2040257
	speed: 0.6357s/iter; left time: 13027.7488s
	iters: 200, epoch: 2 | loss: 4.1576591
	speed: 0.2603s/iter; left time: 5307.5145s
Epoch: 2 cost time: 54.79995369911194
Epoch: 2, Steps: 208 | Train Loss: 3.904 Vali Loss: 8.183 Vali Acc: 0.037 Test Loss: 8.183 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.9706662
	speed: 0.6144s/iter; left time: 12463.6800s
	iters: 200, epoch: 3 | loss: 4.2398787
	speed: 0.2685s/iter; left time: 5419.6073s
Epoch: 3 cost time: 55.091476917266846
Epoch: 3, Steps: 208 | Train Loss: 4.077 Vali Loss: 9.407 Vali Acc: 0.042 Test Loss: 9.407 Test Acc: 0.042
Validation loss decreased (-0.038107 --> -0.041660).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9123151
	speed: 0.6518s/iter; left time: 13086.9285s
	iters: 200, epoch: 4 | loss: 4.6128731
	speed: 0.2709s/iter; left time: 5411.4916s
Epoch: 4 cost time: 56.539623498916626
Epoch: 4, Steps: 208 | Train Loss: 3.927 Vali Loss: 8.403 Vali Acc: 0.044 Test Loss: 8.403 Test Acc: 0.044
Validation loss decreased (-0.041660 --> -0.043757).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1782491
	speed: 0.6529s/iter; left time: 12971.9844s
	iters: 200, epoch: 5 | loss: 4.5766077
	speed: 0.2847s/iter; left time: 5627.7240s
Epoch: 5 cost time: 58.62722206115723
Epoch: 5, Steps: 208 | Train Loss: 3.676 Vali Loss: 7.629 Vali Acc: 0.052 Test Loss: 7.629 Test Acc: 0.052
Validation loss decreased (-0.043757 --> -0.052414).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8606629
	speed: 0.6220s/iter; left time: 12230.1242s
	iters: 200, epoch: 6 | loss: 2.1677046
	speed: 0.2701s/iter; left time: 5282.4606s
Epoch: 6 cost time: 55.17894434928894
Epoch: 6, Steps: 208 | Train Loss: 3.226 Vali Loss: 6.260 Vali Acc: 0.062 Test Loss: 6.260 Test Acc: 0.062
Validation loss decreased (-0.052414 --> -0.061971).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4375470
	speed: 0.6510s/iter; left time: 12663.2021s
	iters: 200, epoch: 7 | loss: 3.8455396
	speed: 0.2574s/iter; left time: 4980.8817s
Epoch: 7 cost time: 54.2146372795105
Epoch: 7, Steps: 208 | Train Loss: 2.754 Vali Loss: 5.233 Vali Acc: 0.065 Test Loss: 5.233 Test Acc: 0.065
Validation loss decreased (-0.061971 --> -0.064666).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0972695
	speed: 0.6471s/iter; left time: 12454.2960s
	iters: 200, epoch: 8 | loss: 2.3217168
	speed: 0.2959s/iter; left time: 5664.2944s
Epoch: 8 cost time: 59.91759443283081
Epoch: 8, Steps: 208 | Train Loss: 2.385 Vali Loss: 5.170 Vali Acc: 0.061 Test Loss: 5.170 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0986078
	speed: 0.6668s/iter; left time: 12693.5917s
	iters: 200, epoch: 9 | loss: 1.9846945
	speed: 0.2816s/iter; left time: 5332.0274s
Epoch: 9 cost time: 58.10319900512695
Epoch: 9, Steps: 208 | Train Loss: 1.973 Vali Loss: 5.279 Vali Acc: 0.071 Test Loss: 5.279 Test Acc: 0.071
Validation loss decreased (-0.064666 --> -0.071227).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9549940
	speed: 0.6732s/iter; left time: 12675.3456s
	iters: 200, epoch: 10 | loss: 2.1525486
	speed: 0.2690s/iter; left time: 5037.4932s
Epoch: 10 cost time: 57.19509243965149
Epoch: 10, Steps: 208 | Train Loss: 1.610 Vali Loss: 5.626 Vali Acc: 0.073 Test Loss: 5.626 Test Acc: 0.073
Validation loss decreased (-0.071227 --> -0.072714).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3063297
	speed: 0.6626s/iter; left time: 12338.0632s
	iters: 200, epoch: 11 | loss: 1.6329139
	speed: 0.2788s/iter; left time: 5164.1331s
Epoch: 11 cost time: 58.38826084136963
Epoch: 11, Steps: 208 | Train Loss: 1.385 Vali Loss: 6.073 Vali Acc: 0.069 Test Loss: 6.073 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6990620
	speed: 0.6645s/iter; left time: 12235.2511s
	iters: 200, epoch: 12 | loss: 0.8696554
	speed: 0.2812s/iter; left time: 5149.4998s
Epoch: 12 cost time: 59.45136880874634
Epoch: 12, Steps: 208 | Train Loss: 1.159 Vali Loss: 6.325 Vali Acc: 0.071 Test Loss: 6.325 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8222528
	speed: 0.6954s/iter; left time: 12660.3505s
	iters: 200, epoch: 13 | loss: 0.6476330
	speed: 0.2788s/iter; left time: 5047.7975s
Epoch: 13 cost time: 60.300546169281006
Epoch: 13, Steps: 208 | Train Loss: 1.047 Vali Loss: 6.726 Vali Acc: 0.076 Test Loss: 6.726 Test Acc: 0.076
Validation loss decreased (-0.072714 --> -0.075984).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7967969
	speed: 0.6661s/iter; left time: 11987.3022s
	iters: 200, epoch: 14 | loss: 2.1729441
	speed: 0.2790s/iter; left time: 4993.3923s
Epoch: 14 cost time: 59.2873432636261
Epoch: 14, Steps: 208 | Train Loss: 0.928 Vali Loss: 7.024 Vali Acc: 0.072 Test Loss: 7.024 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8881307
	speed: 0.6500s/iter; left time: 11562.9709s
	iters: 200, epoch: 15 | loss: 0.1425154
	speed: 0.2893s/iter; left time: 5117.9635s
Epoch: 15 cost time: 59.13557982444763
Epoch: 15, Steps: 208 | Train Loss: 0.784 Vali Loss: 7.305 Vali Acc: 0.078 Test Loss: 7.305 Test Acc: 0.078
Validation loss decreased (-0.075984 --> -0.078066).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.8588468
	speed: 0.6681s/iter; left time: 11745.3431s
	iters: 200, epoch: 16 | loss: 1.0742788
	speed: 0.2741s/iter; left time: 4792.2737s
Epoch: 16 cost time: 56.832282066345215
Epoch: 16, Steps: 208 | Train Loss: 0.747 Vali Loss: 7.572 Vali Acc: 0.076 Test Loss: 7.572 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9274569
	speed: 0.7031s/iter; left time: 12215.3850s
	iters: 200, epoch: 17 | loss: 1.2115735
	speed: 0.2780s/iter; left time: 4801.9016s
Epoch: 17 cost time: 60.29617476463318
Epoch: 17, Steps: 208 | Train Loss: 0.687 Vali Loss: 7.810 Vali Acc: 0.075 Test Loss: 7.810 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8268653
	speed: 0.6978s/iter; left time: 11977.0522s
	iters: 200, epoch: 18 | loss: 1.0037668
	speed: 0.2922s/iter; left time: 4985.6369s
Epoch: 18 cost time: 60.45617938041687
Epoch: 18, Steps: 208 | Train Loss: 0.659 Vali Loss: 7.836 Vali Acc: 0.073 Test Loss: 7.836 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1238594
	speed: 0.6907s/iter; left time: 11712.9120s
	iters: 200, epoch: 19 | loss: 0.9782732
	speed: 0.2732s/iter; left time: 4604.6098s
Epoch: 19 cost time: 58.85074520111084
Epoch: 19, Steps: 208 | Train Loss: 0.574 Vali Loss: 8.420 Vali Acc: 0.081 Test Loss: 8.420 Test Acc: 0.081
Validation loss decreased (-0.078066 --> -0.080739).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5041491
	speed: 0.7188s/iter; left time: 12038.8199s
	iters: 200, epoch: 20 | loss: 0.9936025
	speed: 0.2882s/iter; left time: 4798.5470s
Epoch: 20 cost time: 63.01885747909546
Epoch: 20, Steps: 208 | Train Loss: 0.557 Vali Loss: 8.115 Vali Acc: 0.075 Test Loss: 8.115 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.6039726
	speed: 0.6950s/iter; left time: 11496.2523s
	iters: 200, epoch: 21 | loss: 0.6781597
	speed: 0.3020s/iter; left time: 4964.9488s
Epoch: 21 cost time: 63.02457046508789
Epoch: 21, Steps: 208 | Train Loss: 0.559 Vali Loss: 8.039 Vali Acc: 0.074 Test Loss: 8.039 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.3639322
	speed: 0.6839s/iter; left time: 11170.9078s
	iters: 200, epoch: 22 | loss: 0.6886910
	speed: 0.2977s/iter; left time: 4832.1064s
Epoch: 22 cost time: 61.20899176597595
Epoch: 22, Steps: 208 | Train Loss: 0.499 Vali Loss: 8.622 Vali Acc: 0.081 Test Loss: 8.622 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.8517848
	speed: 0.7028s/iter; left time: 11333.0840s
	iters: 200, epoch: 23 | loss: 0.4149488
	speed: 0.2822s/iter; left time: 4521.7485s
Epoch: 23 cost time: 60.527647733688354
Epoch: 23, Steps: 208 | Train Loss: 0.496 Vali Loss: 9.031 Vali Acc: 0.076 Test Loss: 9.031 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.5221178
	speed: 0.7064s/iter; left time: 11243.6362s
	iters: 200, epoch: 24 | loss: 0.6219346
	speed: 0.2974s/iter; left time: 4703.3265s
Epoch: 24 cost time: 62.94963765144348
Epoch: 24, Steps: 208 | Train Loss: 0.482 Vali Loss: 8.488 Vali Acc: 0.085 Test Loss: 8.488 Test Acc: 0.085
Validation loss decreased (-0.080739 --> -0.084615).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.2941447
	speed: 0.6988s/iter; left time: 10977.3393s
	iters: 200, epoch: 25 | loss: 0.7208276
	speed: 0.3092s/iter; left time: 4826.6178s
Epoch: 25 cost time: 63.4309356212616
Epoch: 25, Steps: 208 | Train Loss: 0.458 Vali Loss: 8.443 Vali Acc: 0.075 Test Loss: 8.443 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.5600486
	speed: 0.6556s/iter; left time: 10162.2721s
	iters: 200, epoch: 26 | loss: 0.7760268
	speed: 0.2755s/iter; left time: 4242.7077s
Epoch: 26 cost time: 59.48941731452942
Epoch: 26, Steps: 208 | Train Loss: 0.424 Vali Loss: 8.435 Vali Acc: 0.077 Test Loss: 8.435 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3277660
	speed: 0.6501s/iter; left time: 9942.7028s
	iters: 200, epoch: 27 | loss: 0.1677781
	speed: 0.2705s/iter; left time: 4109.1773s
Epoch: 27 cost time: 56.71690130233765
Epoch: 27, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.104 Vali Acc: 0.084 Test Loss: 9.104 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.6659424
	speed: 0.6785s/iter; left time: 10235.4982s
	iters: 200, epoch: 28 | loss: 0.3395378
	speed: 0.2837s/iter; left time: 4251.8851s
Epoch: 28 cost time: 60.073894739151
Epoch: 28, Steps: 208 | Train Loss: 0.408 Vali Loss: 9.235 Vali Acc: 0.077 Test Loss: 9.235 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.2513632
	speed: 0.6516s/iter; left time: 9694.1548s
	iters: 200, epoch: 29 | loss: 0.1101174
	speed: 0.2826s/iter; left time: 4176.2948s
Epoch: 29 cost time: 58.14976906776428
Epoch: 29, Steps: 208 | Train Loss: 0.396 Vali Loss: 9.272 Vali Acc: 0.083 Test Loss: 9.272 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.5656345
	speed: 0.6701s/iter; left time: 9829.6563s
	iters: 200, epoch: 30 | loss: 0.1847620
	speed: 0.2557s/iter; left time: 3725.0508s
Epoch: 30 cost time: 55.39669108390808
Epoch: 30, Steps: 208 | Train Loss: 0.422 Vali Loss: 9.079 Vali Acc: 0.073 Test Loss: 9.079 Test Acc: 0.073
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.1521325
	speed: 0.6557s/iter; left time: 9482.2883s
	iters: 200, epoch: 31 | loss: 0.3418394
	speed: 0.2748s/iter; left time: 3946.5287s
Epoch: 31 cost time: 58.726757526397705
Epoch: 31, Steps: 208 | Train Loss: 0.381 Vali Loss: 9.168 Vali Acc: 0.085 Test Loss: 9.168 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.3693404
	speed: 0.6466s/iter; left time: 9215.5303s
	iters: 200, epoch: 32 | loss: 0.2834935
	speed: 0.2853s/iter; left time: 4037.7132s
Epoch: 32 cost time: 59.26361918449402
Epoch: 32, Steps: 208 | Train Loss: 0.378 Vali Loss: 9.040 Vali Acc: 0.071 Test Loss: 9.040 Test Acc: 0.071
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0200606
	speed: 0.6733s/iter; left time: 9456.7386s
	iters: 200, epoch: 33 | loss: 0.2728786
	speed: 0.2758s/iter; left time: 3846.1906s
Epoch: 33 cost time: 58.72152352333069
Epoch: 33, Steps: 208 | Train Loss: 0.341 Vali Loss: 9.441 Vali Acc: 0.082 Test Loss: 9.441 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0560881
	speed: 0.6800s/iter; left time: 9409.2171s
	iters: 200, epoch: 34 | loss: 0.2684970
	speed: 0.2798s/iter; left time: 3844.0107s
Epoch: 34 cost time: 60.44232797622681
Epoch: 34, Steps: 208 | Train Loss: 0.316 Vali Loss: 9.200 Vali Acc: 0.091 Test Loss: 9.200 Test Acc: 0.091
Validation loss decreased (-0.084615 --> -0.090871).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.2671284
	speed: 0.6419s/iter; left time: 8748.5048s
	iters: 200, epoch: 35 | loss: 0.5053395
	speed: 0.2818s/iter; left time: 3812.0904s
Epoch: 35 cost time: 57.54138231277466
Epoch: 35, Steps: 208 | Train Loss: 0.339 Vali Loss: 9.530 Vali Acc: 0.076 Test Loss: 9.530 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.2098758
	speed: 0.6935s/iter; left time: 9307.0647s
	iters: 200, epoch: 36 | loss: 0.2767828
	speed: 0.2925s/iter; left time: 3896.0720s
Epoch: 36 cost time: 61.76623344421387
Epoch: 36, Steps: 208 | Train Loss: 0.339 Vali Loss: 9.363 Vali Acc: 0.082 Test Loss: 9.363 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.3246694
	speed: 0.6706s/iter; left time: 8860.9602s
	iters: 200, epoch: 37 | loss: 0.4859760
	speed: 0.2912s/iter; left time: 3818.2258s
Epoch: 37 cost time: 61.32644176483154
Epoch: 37, Steps: 208 | Train Loss: 0.335 Vali Loss: 9.558 Vali Acc: 0.075 Test Loss: 9.558 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.2616161
	speed: 0.6501s/iter; left time: 8454.9291s
	iters: 200, epoch: 38 | loss: 0.3771205
	speed: 0.2643s/iter; left time: 3410.9590s
Epoch: 38 cost time: 55.80019927024841
Epoch: 38, Steps: 208 | Train Loss: 0.299 Vali Loss: 9.680 Vali Acc: 0.086 Test Loss: 9.680 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0475759
	speed: 0.6627s/iter; left time: 8480.4596s
	iters: 200, epoch: 39 | loss: 0.2263738
	speed: 0.2612s/iter; left time: 3316.5623s
Epoch: 39 cost time: 55.007516622543335
Epoch: 39, Steps: 208 | Train Loss: 0.283 Vali Loss: 9.997 Vali Acc: 0.076 Test Loss: 9.997 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0921199
	speed: 0.6458s/iter; left time: 8129.9085s
	iters: 200, epoch: 40 | loss: 0.2383038
	speed: 0.2785s/iter; left time: 3478.7332s
Epoch: 40 cost time: 58.92607831954956
Epoch: 40, Steps: 208 | Train Loss: 0.277 Vali Loss: 10.364 Vali Acc: 0.075 Test Loss: 10.364 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.4189874
	speed: 0.6567s/iter; left time: 8130.1858s
	iters: 200, epoch: 41 | loss: 0.2869074
	speed: 0.2771s/iter; left time: 3402.6277s
Epoch: 41 cost time: 58.01081442832947
Epoch: 41, Steps: 208 | Train Loss: 0.315 Vali Loss: 10.032 Vali Acc: 0.079 Test Loss: 10.032 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.1149063
	speed: 0.6760s/iter; left time: 8228.6937s
	iters: 200, epoch: 42 | loss: 0.0625059
	speed: 0.2740s/iter; left time: 3308.4679s
Epoch: 42 cost time: 58.50814151763916
Epoch: 42, Steps: 208 | Train Loss: 0.318 Vali Loss: 10.063 Vali Acc: 0.081 Test Loss: 10.063 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0718565
	speed: 0.6595s/iter; left time: 7891.0405s
	iters: 200, epoch: 43 | loss: 0.3297321
	speed: 0.2772s/iter; left time: 3288.5432s
Epoch: 43 cost time: 58.77873492240906
Epoch: 43, Steps: 208 | Train Loss: 0.258 Vali Loss: 10.707 Vali Acc: 0.075 Test Loss: 10.707 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.1222222
	speed: 0.6417s/iter; left time: 7544.1479s
	iters: 200, epoch: 44 | loss: 0.0764648
	speed: 0.2812s/iter; left time: 3277.7688s
Epoch: 44 cost time: 57.29961705207825
Epoch: 44, Steps: 208 | Train Loss: 0.260 Vali Loss: 10.557 Vali Acc: 0.078 Test Loss: 10.557 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09096331643304503
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7145410
	speed: 0.3163s/iter; left time: 6548.6683s
	iters: 200, epoch: 1 | loss: 4.3596950
	speed: 0.2919s/iter; left time: 6013.8601s
Epoch: 1 cost time: 63.764204263687134
Epoch: 1, Steps: 208 | Train Loss: 3.939 Vali Loss: 6.068 Vali Acc: 0.039 Test Loss: 6.068 Test Acc: 0.039
Validation loss decreased (inf --> -0.039307).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9668965
	speed: 0.7380s/iter; left time: 15124.8369s
	iters: 200, epoch: 2 | loss: 4.1013842
	speed: 0.2905s/iter; left time: 5923.7899s
Epoch: 2 cost time: 63.18689036369324
Epoch: 2, Steps: 208 | Train Loss: 3.690 Vali Loss: 7.825 Vali Acc: 0.042 Test Loss: 7.825 Test Acc: 0.042
Validation loss decreased (-0.039307 --> -0.042272).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9084561
	speed: 0.6902s/iter; left time: 14000.7393s
	iters: 200, epoch: 3 | loss: 3.3718042
	speed: 0.2922s/iter; left time: 5898.8023s
Epoch: 3 cost time: 61.05845522880554
Epoch: 3, Steps: 208 | Train Loss: 3.732 Vali Loss: 9.265 Vali Acc: 0.043 Test Loss: 9.265 Test Acc: 0.043
Validation loss decreased (-0.042272 --> -0.042854).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.3232603
	speed: 0.6860s/iter; left time: 13773.0084s
	iters: 200, epoch: 4 | loss: 5.4273906
	speed: 0.2854s/iter; left time: 5700.7902s
Epoch: 4 cost time: 58.361209869384766
Epoch: 4, Steps: 208 | Train Loss: 3.607 Vali Loss: 9.106 Vali Acc: 0.045 Test Loss: 9.106 Test Acc: 0.045
Validation loss decreased (-0.042854 --> -0.044943).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5982506
	speed: 0.7017s/iter; left time: 13942.3211s
	iters: 200, epoch: 5 | loss: 4.4385619
	speed: 0.2992s/iter; left time: 5914.3462s
Epoch: 5 cost time: 62.03688645362854
Epoch: 5, Steps: 208 | Train Loss: 3.281 Vali Loss: 9.168 Vali Acc: 0.056 Test Loss: 9.168 Test Acc: 0.056
Validation loss decreased (-0.044943 --> -0.055679).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5393133
	speed: 0.7333s/iter; left time: 14417.6527s
	iters: 200, epoch: 6 | loss: 2.8023188
	speed: 0.3041s/iter; left time: 5948.7490s
Epoch: 6 cost time: 63.03686857223511
Epoch: 6, Steps: 208 | Train Loss: 2.918 Vali Loss: 8.951 Vali Acc: 0.063 Test Loss: 8.951 Test Acc: 0.063
Validation loss decreased (-0.055679 --> -0.062839).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6942348
	speed: 0.7326s/iter; left time: 14251.5835s
	iters: 200, epoch: 7 | loss: 2.2907634
	speed: 0.2793s/iter; left time: 5405.3061s
Epoch: 7 cost time: 61.45078635215759
Epoch: 7, Steps: 208 | Train Loss: 2.422 Vali Loss: 8.201 Vali Acc: 0.068 Test Loss: 8.201 Test Acc: 0.068
Validation loss decreased (-0.062839 --> -0.067917).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8519728
	speed: 0.7071s/iter; left time: 13608.6814s
	iters: 200, epoch: 8 | loss: 2.1147084
	speed: 0.2922s/iter; left time: 5594.5364s
Epoch: 8 cost time: 62.39793252944946
Epoch: 8, Steps: 208 | Train Loss: 2.002 Vali Loss: 8.075 Vali Acc: 0.067 Test Loss: 8.075 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0551534
	speed: 0.6867s/iter; left time: 13072.1294s
	iters: 200, epoch: 9 | loss: 1.5015310
	speed: 0.2949s/iter; left time: 5583.9830s
Epoch: 9 cost time: 63.073468923568726
Epoch: 9, Steps: 208 | Train Loss: 1.666 Vali Loss: 7.840 Vali Acc: 0.069 Test Loss: 7.840 Test Acc: 0.069
Validation loss decreased (-0.067917 --> -0.068517).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4457861
	speed: 0.7244s/iter; left time: 13640.3551s
	iters: 200, epoch: 10 | loss: 1.3968251
	speed: 0.3076s/iter; left time: 5760.5437s
Epoch: 10 cost time: 64.90255641937256
Epoch: 10, Steps: 208 | Train Loss: 1.410 Vali Loss: 7.478 Vali Acc: 0.066 Test Loss: 7.478 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.0415211
	speed: 0.7293s/iter; left time: 13580.3838s
	iters: 200, epoch: 11 | loss: 2.2980425
	speed: 0.3133s/iter; left time: 5801.8687s
Epoch: 11 cost time: 65.44161200523376
Epoch: 11, Steps: 208 | Train Loss: 1.211 Vali Loss: 8.158 Vali Acc: 0.070 Test Loss: 8.158 Test Acc: 0.070
Validation loss decreased (-0.068517 --> -0.070005).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7981431
	speed: 0.6830s/iter; left time: 12576.8235s
	iters: 200, epoch: 12 | loss: 0.7197242
	speed: 0.3079s/iter; left time: 5638.2649s
Epoch: 12 cost time: 63.083001136779785
Epoch: 12, Steps: 208 | Train Loss: 1.029 Vali Loss: 8.006 Vali Acc: 0.077 Test Loss: 8.006 Test Acc: 0.077
Validation loss decreased (-0.070005 --> -0.077164).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0900054
	speed: 0.7027s/iter; left time: 12793.0987s
	iters: 200, epoch: 13 | loss: 0.1306662
	speed: 0.3088s/iter; left time: 5589.9744s
Epoch: 13 cost time: 64.71230673789978
Epoch: 13, Steps: 208 | Train Loss: 0.867 Vali Loss: 8.329 Vali Acc: 0.072 Test Loss: 8.329 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4145213
	speed: 0.7205s/iter; left time: 12967.3255s
	iters: 200, epoch: 14 | loss: 1.2248026
	speed: 0.3031s/iter; left time: 5424.0952s
Epoch: 14 cost time: 63.12680387496948
Epoch: 14, Steps: 208 | Train Loss: 0.791 Vali Loss: 8.724 Vali Acc: 0.084 Test Loss: 8.724 Test Acc: 0.084
Validation loss decreased (-0.077164 --> -0.084315).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6851574
	speed: 0.7266s/iter; left time: 12925.8688s
	iters: 200, epoch: 15 | loss: 0.7178451
	speed: 0.2975s/iter; left time: 5262.0335s
Epoch: 15 cost time: 62.64337515830994
Epoch: 15, Steps: 208 | Train Loss: 0.737 Vali Loss: 8.863 Vali Acc: 0.082 Test Loss: 8.863 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7244341
	speed: 0.7227s/iter; left time: 12706.4171s
	iters: 200, epoch: 16 | loss: 0.6914277
	speed: 0.2975s/iter; left time: 5201.0622s
Epoch: 16 cost time: 62.979663610458374
Epoch: 16, Steps: 208 | Train Loss: 0.620 Vali Loss: 9.310 Vali Acc: 0.074 Test Loss: 9.310 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4245685
	speed: 0.7355s/iter; left time: 12778.4001s
	iters: 200, epoch: 17 | loss: 1.3827459
	speed: 0.3086s/iter; left time: 5330.1060s
Epoch: 17 cost time: 65.49913191795349
Epoch: 17, Steps: 208 | Train Loss: 0.624 Vali Loss: 9.356 Vali Acc: 0.077 Test Loss: 9.356 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3941109
	speed: 0.7607s/iter; left time: 13057.9829s
	iters: 200, epoch: 18 | loss: 0.6739253
	speed: 0.3165s/iter; left time: 5400.3259s
Epoch: 18 cost time: 67.09335899353027
Epoch: 18, Steps: 208 | Train Loss: 0.562 Vali Loss: 9.765 Vali Acc: 0.075 Test Loss: 9.765 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3903376
	speed: 0.7456s/iter; left time: 12643.7570s
	iters: 200, epoch: 19 | loss: 1.1941868
	speed: 0.2861s/iter; left time: 4822.3514s
Epoch: 19 cost time: 63.593834400177
Epoch: 19, Steps: 208 | Train Loss: 0.498 Vali Loss: 10.480 Vali Acc: 0.068 Test Loss: 10.480 Test Acc: 0.068
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5894002
	speed: 0.6951s/iter; left time: 11641.4504s
	iters: 200, epoch: 20 | loss: 0.9831399
	speed: 0.2965s/iter; left time: 4936.2358s
Epoch: 20 cost time: 62.15426468849182
Epoch: 20, Steps: 208 | Train Loss: 0.472 Vali Loss: 9.434 Vali Acc: 0.085 Test Loss: 9.434 Test Acc: 0.085
Validation loss decreased (-0.084315 --> -0.085202).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2063374
	speed: 0.6907s/iter; left time: 11424.2784s
	iters: 200, epoch: 21 | loss: 0.5862145
	speed: 0.2973s/iter; left time: 4888.4269s
Epoch: 21 cost time: 61.74616551399231
Epoch: 21, Steps: 208 | Train Loss: 0.467 Vali Loss: 10.453 Vali Acc: 0.074 Test Loss: 10.453 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2717171
	speed: 0.6880s/iter; left time: 11236.5915s
	iters: 200, epoch: 22 | loss: 0.6198627
	speed: 0.2971s/iter; left time: 4823.5538s
Epoch: 22 cost time: 60.743001222610474
Epoch: 22, Steps: 208 | Train Loss: 0.452 Vali Loss: 10.349 Vali Acc: 0.074 Test Loss: 10.349 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4943113
	speed: 0.6775s/iter; left time: 10923.9327s
	iters: 200, epoch: 23 | loss: 0.3357342
	speed: 0.2887s/iter; left time: 4625.8319s
Epoch: 23 cost time: 59.63682579994202
Epoch: 23, Steps: 208 | Train Loss: 0.406 Vali Loss: 10.213 Vali Acc: 0.075 Test Loss: 10.213 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.4601260
	speed: 0.6760s/iter; left time: 10759.6825s
	iters: 200, epoch: 24 | loss: 0.2599375
	speed: 0.3070s/iter; left time: 4855.9435s
Epoch: 24 cost time: 62.04081869125366
Epoch: 24, Steps: 208 | Train Loss: 0.413 Vali Loss: 10.215 Vali Acc: 0.077 Test Loss: 10.215 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.3091031
	speed: 0.6991s/iter; left time: 10981.5263s
	iters: 200, epoch: 25 | loss: 0.6948171
	speed: 0.2894s/iter; left time: 4517.8693s
Epoch: 25 cost time: 60.78199005126953
Epoch: 25, Steps: 208 | Train Loss: 0.385 Vali Loss: 11.027 Vali Acc: 0.075 Test Loss: 11.027 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.8818079
	speed: 0.6912s/iter; left time: 10713.9904s
	iters: 200, epoch: 26 | loss: 0.1927006
	speed: 0.2892s/iter; left time: 4454.6278s
Epoch: 26 cost time: 60.590662479400635
Epoch: 26, Steps: 208 | Train Loss: 0.330 Vali Loss: 10.914 Vali Acc: 0.071 Test Loss: 10.914 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1115839
	speed: 0.6949s/iter; left time: 10627.8408s
	iters: 200, epoch: 27 | loss: 0.1373482
	speed: 0.2756s/iter; left time: 4187.2127s
Epoch: 27 cost time: 59.87649941444397
Epoch: 27, Steps: 208 | Train Loss: 0.349 Vali Loss: 11.050 Vali Acc: 0.073 Test Loss: 11.050 Test Acc: 0.073
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1424221
	speed: 0.6932s/iter; left time: 10457.6359s
	iters: 200, epoch: 28 | loss: 0.2401061
	speed: 0.2879s/iter; left time: 4314.8692s
Epoch: 28 cost time: 61.97270369529724
Epoch: 28, Steps: 208 | Train Loss: 0.316 Vali Loss: 10.902 Vali Acc: 0.081 Test Loss: 10.902 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1531270
	speed: 0.6704s/iter; left time: 9973.4450s
	iters: 200, epoch: 29 | loss: 0.0663882
	speed: 0.2969s/iter; left time: 4387.5271s
Epoch: 29 cost time: 61.92267107963562
Epoch: 29, Steps: 208 | Train Loss: 0.345 Vali Loss: 10.490 Vali Acc: 0.075 Test Loss: 10.490 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.2511604
	speed: 0.6859s/iter; left time: 10061.5315s
	iters: 200, epoch: 30 | loss: 0.0255744
	speed: 0.2969s/iter; left time: 4325.0398s
Epoch: 30 cost time: 61.894439458847046
Epoch: 30, Steps: 208 | Train Loss: 0.313 Vali Loss: 10.857 Vali Acc: 0.078 Test Loss: 10.857 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08529674917983895
model parameter : 5005607
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4213579
	speed: 0.3229s/iter; left time: 6683.9505s
	iters: 200, epoch: 1 | loss: 3.1496534
	speed: 0.3065s/iter; left time: 6314.0756s
Epoch: 1 cost time: 65.73780512809753
Epoch: 1, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.732 Vali Acc: 0.085 Test Loss: 3.732 Test Acc: 0.085
Validation loss decreased (inf --> -0.084663).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9064598
	speed: 0.7162s/iter; left time: 14677.0203s
	iters: 200, epoch: 2 | loss: 3.8712149
	speed: 0.3067s/iter; left time: 6255.2839s
Epoch: 2 cost time: 64.54208135604858
Epoch: 2, Steps: 208 | Train Loss: 3.137 Vali Loss: 3.905 Vali Acc: 0.086 Test Loss: 3.905 Test Acc: 0.086
Validation loss decreased (-0.084663 --> -0.085854).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1131396
	speed: 0.7200s/iter; left time: 14605.1679s
	iters: 200, epoch: 3 | loss: 2.3016641
	speed: 0.3209s/iter; left time: 6477.5313s
Epoch: 3 cost time: 65.61564493179321
Epoch: 3, Steps: 208 | Train Loss: 2.472 Vali Loss: 4.255 Vali Acc: 0.088 Test Loss: 4.255 Test Acc: 0.088
Validation loss decreased (-0.085854 --> -0.087938).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8043059
	speed: 0.7408s/iter; left time: 14872.0842s
	iters: 200, epoch: 4 | loss: 2.5383036
	speed: 0.3122s/iter; left time: 6236.2041s
Epoch: 4 cost time: 64.97446775436401
Epoch: 4, Steps: 208 | Train Loss: 1.884 Vali Loss: 4.828 Vali Acc: 0.089 Test Loss: 4.828 Test Acc: 0.089
Validation loss decreased (-0.087938 --> -0.088827).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1582472
	speed: 0.7304s/iter; left time: 14511.7663s
	iters: 200, epoch: 5 | loss: 1.4196448
	speed: 0.3016s/iter; left time: 5962.2410s
Epoch: 5 cost time: 63.47794818878174
Epoch: 5, Steps: 208 | Train Loss: 1.376 Vali Loss: 5.750 Vali Acc: 0.092 Test Loss: 5.750 Test Acc: 0.092
Validation loss decreased (-0.088827 --> -0.091502).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0078931
	speed: 0.7221s/iter; left time: 14196.5887s
	iters: 200, epoch: 6 | loss: 1.1870940
	speed: 0.2927s/iter; left time: 5724.7941s
Epoch: 6 cost time: 62.64100098609924
Epoch: 6, Steps: 208 | Train Loss: 1.033 Vali Loss: 6.107 Vali Acc: 0.095 Test Loss: 6.107 Test Acc: 0.095
Validation loss decreased (-0.091502 --> -0.094481).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8929668
	speed: 0.7247s/iter; left time: 14096.7426s
	iters: 200, epoch: 7 | loss: 1.0968502
	speed: 0.3226s/iter; left time: 6242.6735s
Epoch: 7 cost time: 67.15524911880493
Epoch: 7, Steps: 208 | Train Loss: 0.789 Vali Loss: 7.105 Vali Acc: 0.086 Test Loss: 7.105 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2977770
	speed: 0.7698s/iter; left time: 14814.6494s
	iters: 200, epoch: 8 | loss: 1.4125617
	speed: 0.3089s/iter; left time: 5912.9533s
Epoch: 8 cost time: 65.72746109962463
Epoch: 8, Steps: 208 | Train Loss: 0.672 Vali Loss: 7.648 Vali Acc: 0.081 Test Loss: 7.648 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3999880
	speed: 0.7451s/iter; left time: 14184.9626s
	iters: 200, epoch: 9 | loss: 0.6731552
	speed: 0.3276s/iter; left time: 6203.6928s
Epoch: 9 cost time: 67.31928586959839
Epoch: 9, Steps: 208 | Train Loss: 0.567 Vali Loss: 8.390 Vali Acc: 0.089 Test Loss: 8.390 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6053582
	speed: 0.7795s/iter; left time: 14677.5774s
	iters: 200, epoch: 10 | loss: 0.2607428
	speed: 0.3349s/iter; left time: 6272.8500s
Epoch: 10 cost time: 70.35204243659973
Epoch: 10, Steps: 208 | Train Loss: 0.476 Vali Loss: 8.911 Vali Acc: 0.089 Test Loss: 8.911 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9661009
	speed: 0.8030s/iter; left time: 14953.2339s
	iters: 200, epoch: 11 | loss: 0.4164421
	speed: 0.3193s/iter; left time: 5914.2613s
Epoch: 11 cost time: 71.3963611125946
Epoch: 11, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.427 Vali Acc: 0.082 Test Loss: 9.427 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0192272
	speed: 0.7328s/iter; left time: 13492.4855s
	iters: 200, epoch: 12 | loss: 0.4281490
	speed: 0.3263s/iter; left time: 5974.9943s
Epoch: 12 cost time: 67.259042263031
Epoch: 12, Steps: 208 | Train Loss: 0.326 Vali Loss: 9.284 Vali Acc: 0.088 Test Loss: 9.284 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2597835
	speed: 0.7685s/iter; left time: 13991.1849s
	iters: 200, epoch: 13 | loss: 0.0733073
	speed: 0.3350s/iter; left time: 6065.3597s
Epoch: 13 cost time: 70.04433012008667
Epoch: 13, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.823 Vali Acc: 0.083 Test Loss: 9.823 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2965420
	speed: 0.8033s/iter; left time: 14456.2457s
	iters: 200, epoch: 14 | loss: 0.0152942
	speed: 0.3504s/iter; left time: 6271.9590s
Epoch: 14 cost time: 71.47241258621216
Epoch: 14, Steps: 208 | Train Loss: 0.292 Vali Loss: 9.887 Vali Acc: 0.084 Test Loss: 9.887 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2385114
	speed: 0.7571s/iter; left time: 13467.7275s
	iters: 200, epoch: 15 | loss: 0.8976078
	speed: 0.3265s/iter; left time: 5776.3352s
Epoch: 15 cost time: 69.05461144447327
Epoch: 15, Steps: 208 | Train Loss: 0.228 Vali Loss: 10.037 Vali Acc: 0.087 Test Loss: 10.037 Test Acc: 0.087
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0862183
	speed: 0.7624s/iter; left time: 13403.5754s
	iters: 200, epoch: 16 | loss: 0.3261953
	speed: 0.3166s/iter; left time: 5533.9449s
Epoch: 16 cost time: 67.43756318092346
Epoch: 16, Steps: 208 | Train Loss: 0.229 Vali Loss: 10.678 Vali Acc: 0.087 Test Loss: 10.678 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0945422010140173
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5587382
	speed: 0.3174s/iter; left time: 6570.3141s
	iters: 200, epoch: 1 | loss: 3.2171814
	speed: 0.2956s/iter; left time: 6088.6824s
Epoch: 1 cost time: 63.91736388206482
Epoch: 1, Steps: 208 | Train Loss: 3.722 Vali Loss: 3.753 Vali Acc: 0.077 Test Loss: 3.753 Test Acc: 0.077
Validation loss decreased (inf --> -0.076908).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7337499
	speed: 0.7451s/iter; left time: 15269.1540s
	iters: 200, epoch: 2 | loss: 3.9167900
	speed: 0.2896s/iter; left time: 5906.5743s
Epoch: 2 cost time: 63.76442193984985
Epoch: 2, Steps: 208 | Train Loss: 3.139 Vali Loss: 3.973 Vali Acc: 0.083 Test Loss: 3.973 Test Acc: 0.083
Validation loss decreased (-0.076908 --> -0.082573).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0362778
	speed: 0.7019s/iter; left time: 14237.8986s
	iters: 200, epoch: 3 | loss: 2.3806970
	speed: 0.2750s/iter; left time: 5550.9261s
Epoch: 3 cost time: 60.011595487594604
Epoch: 3, Steps: 208 | Train Loss: 2.490 Vali Loss: 4.185 Vali Acc: 0.085 Test Loss: 4.185 Test Acc: 0.085
Validation loss decreased (-0.082573 --> -0.084658).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8022324
	speed: 0.7421s/iter; left time: 14898.5348s
	iters: 200, epoch: 4 | loss: 2.6225619
	speed: 0.2879s/iter; left time: 5752.3488s
Epoch: 4 cost time: 60.8422474861145
Epoch: 4, Steps: 208 | Train Loss: 1.880 Vali Loss: 4.845 Vali Acc: 0.088 Test Loss: 4.845 Test Acc: 0.088
Validation loss decreased (-0.084658 --> -0.087932).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6902523
	speed: 0.6902s/iter; left time: 13714.0671s
	iters: 200, epoch: 5 | loss: 1.8130550
	speed: 0.2939s/iter; left time: 5809.7377s
Epoch: 5 cost time: 60.766608476638794
Epoch: 5, Steps: 208 | Train Loss: 1.399 Vali Loss: 5.609 Vali Acc: 0.093 Test Loss: 5.609 Test Acc: 0.093
Validation loss decreased (-0.087932 --> -0.092995).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2479860
	speed: 0.7087s/iter; left time: 13934.3448s
	iters: 200, epoch: 6 | loss: 1.2310874
	speed: 0.3067s/iter; left time: 6000.0878s
Epoch: 6 cost time: 63.418333768844604
Epoch: 6, Steps: 208 | Train Loss: 1.058 Vali Loss: 6.211 Vali Acc: 0.096 Test Loss: 6.211 Test Acc: 0.096
Validation loss decreased (-0.092995 --> -0.096270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8977755
	speed: 0.7043s/iter; left time: 13701.4116s
	iters: 200, epoch: 7 | loss: 1.2125094
	speed: 0.2952s/iter; left time: 5712.1972s
Epoch: 7 cost time: 63.27922344207764
Epoch: 7, Steps: 208 | Train Loss: 0.797 Vali Loss: 7.145 Vali Acc: 0.089 Test Loss: 7.145 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4807816
	speed: 0.7092s/iter; left time: 13647.9061s
	iters: 200, epoch: 8 | loss: 1.7178330
	speed: 0.2982s/iter; left time: 5709.9299s
Epoch: 8 cost time: 63.0970561504364
Epoch: 8, Steps: 208 | Train Loss: 0.657 Vali Loss: 7.626 Vali Acc: 0.093 Test Loss: 7.626 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3712182
	speed: 0.7576s/iter; left time: 14422.6604s
	iters: 200, epoch: 9 | loss: 0.4992161
	speed: 0.2934s/iter; left time: 5555.8388s
Epoch: 9 cost time: 63.283180952072144
Epoch: 9, Steps: 208 | Train Loss: 0.553 Vali Loss: 7.799 Vali Acc: 0.088 Test Loss: 7.799 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5407617
	speed: 0.7094s/iter; left time: 13356.5504s
	iters: 200, epoch: 10 | loss: 0.4833718
	speed: 0.2751s/iter; left time: 5151.4343s
Epoch: 10 cost time: 59.464898109436035
Epoch: 10, Steps: 208 | Train Loss: 0.466 Vali Loss: 8.938 Vali Acc: 0.089 Test Loss: 8.938 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5883763
	speed: 0.7019s/iter; left time: 13069.4930s
	iters: 200, epoch: 11 | loss: 0.3570699
	speed: 0.2860s/iter; left time: 5296.6920s
Epoch: 11 cost time: 59.12602949142456
Epoch: 11, Steps: 208 | Train Loss: 0.404 Vali Loss: 9.382 Vali Acc: 0.084 Test Loss: 9.382 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2873456
	speed: 0.6817s/iter; left time: 12551.4648s
	iters: 200, epoch: 12 | loss: 0.2787272
	speed: 0.2943s/iter; left time: 5389.7686s
Epoch: 12 cost time: 60.218286991119385
Epoch: 12, Steps: 208 | Train Loss: 0.336 Vali Loss: 9.261 Vali Acc: 0.083 Test Loss: 9.261 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1293639
	speed: 0.6957s/iter; left time: 12664.3795s
	iters: 200, epoch: 13 | loss: 0.4091428
	speed: 0.3068s/iter; left time: 5554.4954s
Epoch: 13 cost time: 62.81575322151184
Epoch: 13, Steps: 208 | Train Loss: 0.304 Vali Loss: 9.735 Vali Acc: 0.084 Test Loss: 9.735 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0296100
	speed: 0.6888s/iter; left time: 12395.9581s
	iters: 200, epoch: 14 | loss: 0.0372949
	speed: 0.3063s/iter; left time: 5481.3936s
Epoch: 14 cost time: 62.98892951011658
Epoch: 14, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.071 Vali Acc: 0.088 Test Loss: 10.071 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5422314
	speed: 0.7271s/iter; left time: 12933.5322s
	iters: 200, epoch: 15 | loss: 0.2566919
	speed: 0.3087s/iter; left time: 5461.3790s
Epoch: 15 cost time: 66.19206929206848
Epoch: 15, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.371 Vali Acc: 0.077 Test Loss: 10.371 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0283896
	speed: 0.7451s/iter; left time: 13100.1697s
	iters: 200, epoch: 16 | loss: 0.4957261
	speed: 0.3102s/iter; left time: 5422.8456s
Epoch: 16 cost time: 64.24265027046204
Epoch: 16, Steps: 208 | Train Loss: 0.259 Vali Loss: 10.447 Vali Acc: 0.081 Test Loss: 10.447 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09633164330450343
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5523264
	speed: 0.3180s/iter; left time: 6583.5360s
	iters: 200, epoch: 1 | loss: 3.2331176
	speed: 0.2806s/iter; left time: 5781.2841s
Epoch: 1 cost time: 62.339537382125854
Epoch: 1, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.709 Vali Acc: 0.087 Test Loss: 3.709 Test Acc: 0.087
Validation loss decreased (inf --> -0.087049).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5910776
	speed: 0.6794s/iter; left time: 13922.7345s
	iters: 200, epoch: 2 | loss: 3.9195366
	speed: 0.2893s/iter; left time: 5899.4333s
Epoch: 2 cost time: 61.24614500999451
Epoch: 2, Steps: 208 | Train Loss: 3.139 Vali Loss: 3.877 Vali Acc: 0.094 Test Loss: 3.877 Test Acc: 0.094
Validation loss decreased (-0.087049 --> -0.094205).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1839614
	speed: 0.6768s/iter; left time: 13727.9562s
	iters: 200, epoch: 3 | loss: 2.4056523
	speed: 0.3210s/iter; left time: 6479.3367s
Epoch: 3 cost time: 63.629854917526245
Epoch: 3, Steps: 208 | Train Loss: 2.491 Vali Loss: 4.210 Vali Acc: 0.087 Test Loss: 4.210 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1450109
	speed: 0.7513s/iter; left time: 15084.6718s
	iters: 200, epoch: 4 | loss: 2.4900868
	speed: 0.3237s/iter; left time: 6466.4319s
Epoch: 4 cost time: 67.76283359527588
Epoch: 4, Steps: 208 | Train Loss: 1.889 Vali Loss: 4.758 Vali Acc: 0.089 Test Loss: 4.758 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0490271
	speed: 0.7192s/iter; left time: 14289.1186s
	iters: 200, epoch: 5 | loss: 1.0663235
	speed: 0.3089s/iter; left time: 6106.1909s
Epoch: 5 cost time: 64.00840544700623
Epoch: 5, Steps: 208 | Train Loss: 1.395 Vali Loss: 5.726 Vali Acc: 0.093 Test Loss: 5.726 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.6630601
	speed: 0.7297s/iter; left time: 14347.0142s
	iters: 200, epoch: 6 | loss: 1.4500426
	speed: 0.2985s/iter; left time: 5839.8604s
Epoch: 6 cost time: 63.08481192588806
Epoch: 6, Steps: 208 | Train Loss: 1.061 Vali Loss: 6.119 Vali Acc: 0.088 Test Loss: 6.119 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7807270
	speed: 0.7020s/iter; left time: 13656.2820s
	iters: 200, epoch: 7 | loss: 1.1241770
	speed: 0.3026s/iter; left time: 5856.0593s
Epoch: 7 cost time: 64.26352858543396
Epoch: 7, Steps: 208 | Train Loss: 0.834 Vali Loss: 6.832 Vali Acc: 0.092 Test Loss: 6.832 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.0530219
	speed: 0.7102s/iter; left time: 13667.4333s
	iters: 200, epoch: 8 | loss: 1.2339154
	speed: 0.2976s/iter; left time: 5697.5693s
Epoch: 8 cost time: 63.50309491157532
Epoch: 8, Steps: 208 | Train Loss: 0.683 Vali Loss: 7.673 Vali Acc: 0.086 Test Loss: 7.673 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2452178
	speed: 0.7247s/iter; left time: 13796.0127s
	iters: 200, epoch: 9 | loss: 1.1037139
	speed: 0.2965s/iter; left time: 5614.5960s
Epoch: 9 cost time: 63.148730993270874
Epoch: 9, Steps: 208 | Train Loss: 0.550 Vali Loss: 8.043 Vali Acc: 0.087 Test Loss: 8.043 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5211855
	speed: 0.6879s/iter; left time: 12953.3727s
	iters: 200, epoch: 10 | loss: 0.8260837
	speed: 0.2932s/iter; left time: 5491.4659s
Epoch: 10 cost time: 61.884403228759766
Epoch: 10, Steps: 208 | Train Loss: 0.494 Vali Loss: 8.473 Vali Acc: 0.090 Test Loss: 8.473 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8067811
	speed: 0.6921s/iter; left time: 12887.5864s
	iters: 200, epoch: 11 | loss: 0.2634292
	speed: 0.2885s/iter; left time: 5343.7701s
Epoch: 11 cost time: 61.7227566242218
Epoch: 11, Steps: 208 | Train Loss: 0.404 Vali Loss: 9.271 Vali Acc: 0.078 Test Loss: 9.271 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1747520
	speed: 0.7275s/iter; left time: 13394.7523s
	iters: 200, epoch: 12 | loss: 0.3173509
	speed: 0.3002s/iter; left time: 5497.2407s
Epoch: 12 cost time: 63.91873550415039
Epoch: 12, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.431 Vali Acc: 0.081 Test Loss: 9.431 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09424396063226961
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4592268
	speed: 0.3084s/iter; left time: 6383.6347s
	iters: 200, epoch: 1 | loss: 3.2890875
	speed: 0.2899s/iter; left time: 5971.8010s
Epoch: 1 cost time: 62.95160627365112
Epoch: 1, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.691 Vali Acc: 0.090 Test Loss: 3.691 Test Acc: 0.090
Validation loss decreased (inf --> -0.090032).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9245064
	speed: 0.7201s/iter; left time: 14757.5978s
	iters: 200, epoch: 2 | loss: 3.9215603
	speed: 0.2986s/iter; left time: 6089.1125s
Epoch: 2 cost time: 62.61662673950195
Epoch: 2, Steps: 208 | Train Loss: 3.135 Vali Loss: 3.922 Vali Acc: 0.080 Test Loss: 3.922 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.9418046
	speed: 0.7176s/iter; left time: 14556.3965s
	iters: 200, epoch: 3 | loss: 2.8411174
	speed: 0.3318s/iter; left time: 6697.6030s
Epoch: 3 cost time: 67.1312928199768
Epoch: 3, Steps: 208 | Train Loss: 2.461 Vali Loss: 4.207 Vali Acc: 0.092 Test Loss: 4.207 Test Acc: 0.092
Validation loss decreased (-0.090032 --> -0.092114).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7707022
	speed: 0.7282s/iter; left time: 14620.6463s
	iters: 200, epoch: 4 | loss: 2.7833312
	speed: 0.2935s/iter; left time: 5863.6043s
Epoch: 4 cost time: 62.2674446105957
Epoch: 4, Steps: 208 | Train Loss: 1.838 Vali Loss: 4.725 Vali Acc: 0.098 Test Loss: 4.725 Test Acc: 0.098
Validation loss decreased (-0.092114 --> -0.097776).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6811445
	speed: 0.7241s/iter; left time: 14386.2287s
	iters: 200, epoch: 5 | loss: 0.6401805
	speed: 0.3072s/iter; left time: 6074.0102s
Epoch: 5 cost time: 64.92463493347168
Epoch: 5, Steps: 208 | Train Loss: 1.331 Vali Loss: 5.909 Vali Acc: 0.094 Test Loss: 5.909 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9132900
	speed: 0.7046s/iter; left time: 13852.5747s
	iters: 200, epoch: 6 | loss: 0.9155417
	speed: 0.3063s/iter; left time: 5991.4160s
Epoch: 6 cost time: 62.94062542915344
Epoch: 6, Steps: 208 | Train Loss: 1.023 Vali Loss: 6.373 Vali Acc: 0.088 Test Loss: 6.373 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2972381
	speed: 0.7495s/iter; left time: 14580.5416s
	iters: 200, epoch: 7 | loss: 1.6592841
	speed: 0.3056s/iter; left time: 5914.9509s
Epoch: 7 cost time: 65.8580846786499
Epoch: 7, Steps: 208 | Train Loss: 0.798 Vali Loss: 7.366 Vali Acc: 0.092 Test Loss: 7.366 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5991339
	speed: 0.7074s/iter; left time: 13613.7664s
	iters: 200, epoch: 8 | loss: 1.0891210
	speed: 0.3069s/iter; left time: 5875.8591s
Epoch: 8 cost time: 64.40262079238892
Epoch: 8, Steps: 208 | Train Loss: 0.689 Vali Loss: 7.473 Vali Acc: 0.091 Test Loss: 7.473 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2109732
	speed: 0.7144s/iter; left time: 13599.2462s
	iters: 200, epoch: 9 | loss: 0.3997440
	speed: 0.2970s/iter; left time: 5623.7580s
Epoch: 9 cost time: 62.86860013008118
Epoch: 9, Steps: 208 | Train Loss: 0.558 Vali Loss: 8.270 Vali Acc: 0.090 Test Loss: 8.270 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5418926
	speed: 0.6627s/iter; left time: 12478.5658s
	iters: 200, epoch: 10 | loss: 0.9150532
	speed: 0.2871s/iter; left time: 5377.0006s
Epoch: 10 cost time: 60.28810691833496
Epoch: 10, Steps: 208 | Train Loss: 0.460 Vali Loss: 8.572 Vali Acc: 0.084 Test Loss: 8.572 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1809410
	speed: 0.6793s/iter; left time: 12648.6144s
	iters: 200, epoch: 11 | loss: 0.5664538
	speed: 0.2785s/iter; left time: 5157.9471s
Epoch: 11 cost time: 58.94924235343933
Epoch: 11, Steps: 208 | Train Loss: 0.403 Vali Loss: 9.028 Vali Acc: 0.096 Test Loss: 9.028 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0315097
	speed: 0.6770s/iter; left time: 12465.6106s
	iters: 200, epoch: 12 | loss: 0.0233747
	speed: 0.2831s/iter; left time: 5183.8250s
Epoch: 12 cost time: 58.657490730285645
Epoch: 12, Steps: 208 | Train Loss: 0.350 Vali Loss: 9.318 Vali Acc: 0.087 Test Loss: 9.318 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0103591
	speed: 0.6582s/iter; left time: 11983.4201s
	iters: 200, epoch: 13 | loss: 0.0337945
	speed: 0.2882s/iter; left time: 5218.5717s
Epoch: 13 cost time: 59.15994143486023
Epoch: 13, Steps: 208 | Train Loss: 0.313 Vali Loss: 9.653 Vali Acc: 0.089 Test Loss: 9.653 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1558004
	speed: 0.6807s/iter; left time: 12251.4157s
	iters: 200, epoch: 14 | loss: 0.2539157
	speed: 0.2974s/iter; left time: 5323.0134s
Epoch: 14 cost time: 61.798174142837524
Epoch: 14, Steps: 208 | Train Loss: 0.263 Vali Loss: 10.214 Vali Acc: 0.089 Test Loss: 10.214 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09782284521324187
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6306074
	speed: 0.3450s/iter; left time: 7140.9326s
	iters: 200, epoch: 1 | loss: 3.3061159
	speed: 0.3252s/iter; left time: 6698.8652s
Epoch: 1 cost time: 69.8751711845398
Epoch: 1, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.861 Vali Acc: 0.080 Test Loss: 3.861 Test Acc: 0.080
Validation loss decreased (inf --> -0.079592).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7680476
	speed: 0.7055s/iter; left time: 14458.5408s
	iters: 200, epoch: 2 | loss: 3.3716896
	speed: 0.2979s/iter; left time: 6074.0627s
Epoch: 2 cost time: 61.58904194831848
Epoch: 2, Steps: 208 | Train Loss: 3.156 Vali Loss: 3.979 Vali Acc: 0.070 Test Loss: 3.979 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.8121605
	speed: 0.7337s/iter; left time: 14883.2953s
	iters: 200, epoch: 3 | loss: 2.9664152
	speed: 0.3044s/iter; left time: 6143.8998s
Epoch: 3 cost time: 64.61503434181213
Epoch: 3, Steps: 208 | Train Loss: 2.524 Vali Loss: 4.416 Vali Acc: 0.082 Test Loss: 4.416 Test Acc: 0.082
Validation loss decreased (-0.079592 --> -0.082270).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9998221
	speed: 0.6878s/iter; left time: 13808.0848s
	iters: 200, epoch: 4 | loss: 2.9605234
	speed: 0.3019s/iter; left time: 6030.7642s
Epoch: 4 cost time: 61.8361394405365
Epoch: 4, Steps: 208 | Train Loss: 1.920 Vali Loss: 4.857 Vali Acc: 0.083 Test Loss: 4.857 Test Acc: 0.083
Validation loss decreased (-0.082270 --> -0.083160).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0169662
	speed: 0.7224s/iter; left time: 14352.9357s
	iters: 200, epoch: 5 | loss: 2.1244819
	speed: 0.2967s/iter; left time: 5864.8541s
Epoch: 5 cost time: 62.893717765808105
Epoch: 5, Steps: 208 | Train Loss: 1.465 Vali Loss: 5.550 Vali Acc: 0.095 Test Loss: 5.550 Test Acc: 0.095
Validation loss decreased (-0.083160 --> -0.094487).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3685591
	speed: 0.7277s/iter; left time: 14308.2080s
	iters: 200, epoch: 6 | loss: 1.4247129
	speed: 0.3117s/iter; left time: 6097.6719s
Epoch: 6 cost time: 65.3696722984314
Epoch: 6, Steps: 208 | Train Loss: 1.143 Vali Loss: 6.039 Vali Acc: 0.077 Test Loss: 6.039 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6016615
	speed: 0.7101s/iter; left time: 13813.2159s
	iters: 200, epoch: 7 | loss: 1.4896088
	speed: 0.3046s/iter; left time: 5894.3231s
Epoch: 7 cost time: 63.64279341697693
Epoch: 7, Steps: 208 | Train Loss: 0.886 Vali Loss: 6.758 Vali Acc: 0.086 Test Loss: 6.758 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8795679
	speed: 0.7253s/iter; left time: 13958.6294s
	iters: 200, epoch: 8 | loss: 2.0743587
	speed: 0.3033s/iter; left time: 5806.7000s
Epoch: 8 cost time: 64.33788752555847
Epoch: 8, Steps: 208 | Train Loss: 0.777 Vali Loss: 7.081 Vali Acc: 0.089 Test Loss: 7.081 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5672278
	speed: 0.7105s/iter; left time: 13526.7400s
	iters: 200, epoch: 9 | loss: 0.8061646
	speed: 0.3155s/iter; left time: 5975.0266s
Epoch: 9 cost time: 64.32521343231201
Epoch: 9, Steps: 208 | Train Loss: 0.618 Vali Loss: 7.798 Vali Acc: 0.091 Test Loss: 7.798 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1605268
	speed: 0.7507s/iter; left time: 14134.4798s
	iters: 200, epoch: 10 | loss: 1.2983390
	speed: 0.3030s/iter; left time: 5675.8028s
Epoch: 10 cost time: 65.5370020866394
Epoch: 10, Steps: 208 | Train Loss: 0.531 Vali Loss: 8.173 Vali Acc: 0.089 Test Loss: 8.173 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.2280927
	speed: 0.7184s/iter; left time: 13378.1596s
	iters: 200, epoch: 11 | loss: 0.2072412
	speed: 0.3205s/iter; left time: 5936.1772s
Epoch: 11 cost time: 65.98118591308594
Epoch: 11, Steps: 208 | Train Loss: 0.472 Vali Loss: 8.618 Vali Acc: 0.090 Test Loss: 8.618 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1674117
	speed: 0.7093s/iter; left time: 13060.2267s
	iters: 200, epoch: 12 | loss: 0.2435678
	speed: 0.2988s/iter; left time: 5471.9392s
Epoch: 12 cost time: 63.313626766204834
Epoch: 12, Steps: 208 | Train Loss: 0.386 Vali Loss: 9.457 Vali Acc: 0.084 Test Loss: 9.457 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0233084
	speed: 0.7835s/iter; left time: 14263.6848s
	iters: 200, epoch: 13 | loss: 0.1702813
	speed: 0.3217s/iter; left time: 5824.6306s
Epoch: 13 cost time: 69.68302845954895
Epoch: 13, Steps: 208 | Train Loss: 0.331 Vali Loss: 9.087 Vali Acc: 0.090 Test Loss: 9.087 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0177861
	speed: 0.7253s/iter; left time: 13053.3368s
	iters: 200, epoch: 14 | loss: 0.5279162
	speed: 0.3198s/iter; left time: 5723.4073s
Epoch: 14 cost time: 65.49178338050842
Epoch: 14, Steps: 208 | Train Loss: 0.297 Vali Loss: 9.157 Vali Acc: 0.091 Test Loss: 9.157 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0675436
	speed: 0.7332s/iter; left time: 13043.0096s
	iters: 200, epoch: 15 | loss: 0.1263220
	speed: 0.3080s/iter; left time: 5448.7801s
Epoch: 15 cost time: 65.22481894493103
Epoch: 15, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.071 Vali Acc: 0.089 Test Loss: 9.071 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0945422010140173
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7918224
	speed: 0.3294s/iter; left time: 6818.5588s
	iters: 200, epoch: 1 | loss: 3.7914395
	speed: 0.3026s/iter; left time: 6233.1733s
Epoch: 1 cost time: 65.86716365814209
Epoch: 1, Steps: 208 | Train Loss: 3.671 Vali Loss: 4.240 Vali Acc: 0.077 Test Loss: 4.240 Test Acc: 0.077
Validation loss decreased (inf --> -0.076605).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3202457
	speed: 0.7200s/iter; left time: 14755.4894s
	iters: 200, epoch: 2 | loss: 3.6669710
	speed: 0.3015s/iter; left time: 6149.0061s
Epoch: 2 cost time: 64.27976536750793
Epoch: 2, Steps: 208 | Train Loss: 3.210 Vali Loss: 4.286 Vali Acc: 0.072 Test Loss: 4.286 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5467610
	speed: 0.7026s/iter; left time: 14252.7179s
	iters: 200, epoch: 3 | loss: 2.4472077
	speed: 0.3016s/iter; left time: 6087.9238s
Epoch: 3 cost time: 62.75887989997864
Epoch: 3, Steps: 208 | Train Loss: 2.658 Vali Loss: 5.097 Vali Acc: 0.089 Test Loss: 5.097 Test Acc: 0.089
Validation loss decreased (-0.076605 --> -0.089421).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3856668
	speed: 0.7153s/iter; left time: 14360.9641s
	iters: 200, epoch: 4 | loss: 2.3985555
	speed: 0.3140s/iter; left time: 6273.7633s
Epoch: 4 cost time: 65.1535325050354
Epoch: 4, Steps: 208 | Train Loss: 2.186 Vali Loss: 4.855 Vali Acc: 0.101 Test Loss: 4.855 Test Acc: 0.101
Validation loss decreased (-0.089421 --> -0.100458).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2781879
	speed: 0.7227s/iter; left time: 14358.6600s
	iters: 200, epoch: 5 | loss: 1.5414159
	speed: 0.2945s/iter; left time: 5822.7234s
Epoch: 5 cost time: 63.46377992630005
Epoch: 5, Steps: 208 | Train Loss: 1.698 Vali Loss: 6.030 Vali Acc: 0.086 Test Loss: 6.030 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0985827
	speed: 0.7415s/iter; left time: 14577.6891s
	iters: 200, epoch: 6 | loss: 2.1012053
	speed: 0.3093s/iter; left time: 6050.0541s
Epoch: 6 cost time: 65.49819993972778
Epoch: 6, Steps: 208 | Train Loss: 1.363 Vali Loss: 5.877 Vali Acc: 0.095 Test Loss: 5.877 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9675488
	speed: 0.7039s/iter; left time: 13693.0041s
	iters: 200, epoch: 7 | loss: 1.8058476
	speed: 0.3076s/iter; left time: 5952.9198s
Epoch: 7 cost time: 64.68934226036072
Epoch: 7, Steps: 208 | Train Loss: 1.059 Vali Loss: 6.555 Vali Acc: 0.095 Test Loss: 6.555 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1441879
	speed: 0.7348s/iter; left time: 14141.8965s
	iters: 200, epoch: 8 | loss: 0.8706378
	speed: 0.3083s/iter; left time: 5902.2603s
Epoch: 8 cost time: 64.82447671890259
Epoch: 8, Steps: 208 | Train Loss: 0.945 Vali Loss: 6.667 Vali Acc: 0.101 Test Loss: 6.667 Test Acc: 0.101
Validation loss decreased (-0.100458 --> -0.100739).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3120038
	speed: 0.7089s/iter; left time: 13495.1547s
	iters: 200, epoch: 9 | loss: 0.5301387
	speed: 0.2970s/iter; left time: 5625.1028s
Epoch: 9 cost time: 63.33606004714966
Epoch: 9, Steps: 208 | Train Loss: 0.772 Vali Loss: 7.232 Vali Acc: 0.099 Test Loss: 7.232 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8665856
	speed: 0.6930s/iter; left time: 13048.3408s
	iters: 200, epoch: 10 | loss: 0.6105071
	speed: 0.3067s/iter; left time: 5744.2457s
Epoch: 10 cost time: 62.0401566028595
Epoch: 10, Steps: 208 | Train Loss: 0.678 Vali Loss: 7.438 Vali Acc: 0.101 Test Loss: 7.438 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0299401
	speed: 0.7125s/iter; left time: 13267.7797s
	iters: 200, epoch: 11 | loss: 0.2573527
	speed: 0.3198s/iter; left time: 5923.2363s
Epoch: 11 cost time: 65.72779488563538
Epoch: 11, Steps: 208 | Train Loss: 0.593 Vali Loss: 7.628 Vali Acc: 0.096 Test Loss: 7.628 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.7744936
	speed: 0.7208s/iter; left time: 13272.0994s
	iters: 200, epoch: 12 | loss: 0.6003398
	speed: 0.3191s/iter; left time: 5844.3315s
Epoch: 12 cost time: 65.70869517326355
Epoch: 12, Steps: 208 | Train Loss: 0.532 Vali Loss: 8.579 Vali Acc: 0.097 Test Loss: 8.579 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1849164
	speed: 0.7176s/iter; left time: 13064.3095s
	iters: 200, epoch: 13 | loss: 0.4125879
	speed: 0.3062s/iter; left time: 5544.2801s
Epoch: 13 cost time: 65.18827080726624
Epoch: 13, Steps: 208 | Train Loss: 0.445 Vali Loss: 8.505 Vali Acc: 0.092 Test Loss: 8.505 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3699293
	speed: 0.7566s/iter; left time: 13615.8882s
	iters: 200, epoch: 14 | loss: 0.2714249
	speed: 0.2953s/iter; left time: 5284.9871s
Epoch: 14 cost time: 64.83180403709412
Epoch: 14, Steps: 208 | Train Loss: 0.405 Vali Loss: 8.739 Vali Acc: 0.086 Test Loss: 8.739 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3000669
	speed: 0.7175s/iter; left time: 12764.1948s
	iters: 200, epoch: 15 | loss: 0.2341186
	speed: 0.3109s/iter; left time: 5499.0610s
Epoch: 15 cost time: 64.73580241203308
Epoch: 15, Steps: 208 | Train Loss: 0.362 Vali Loss: 8.727 Vali Acc: 0.098 Test Loss: 8.727 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1524080
	speed: 0.7017s/iter; left time: 12337.4051s
	iters: 200, epoch: 16 | loss: 0.5144004
	speed: 0.3006s/iter; left time: 5255.2280s
Epoch: 16 cost time: 61.86854290962219
Epoch: 16, Steps: 208 | Train Loss: 0.347 Vali Loss: 8.921 Vali Acc: 0.106 Test Loss: 8.921 Test Acc: 0.106
Validation loss decreased (-0.100739 --> -0.105786).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7660232
	speed: 0.7186s/iter; left time: 12483.8857s
	iters: 200, epoch: 17 | loss: 0.5832263
	speed: 0.3005s/iter; left time: 5190.9960s
Epoch: 17 cost time: 62.54594373703003
Epoch: 17, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.477 Vali Acc: 0.100 Test Loss: 9.477 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0616028
	speed: 0.7289s/iter; left time: 12510.7828s
	iters: 200, epoch: 18 | loss: 0.3211884
	speed: 0.3074s/iter; left time: 5245.5333s
Epoch: 18 cost time: 65.28817248344421
Epoch: 18, Steps: 208 | Train Loss: 0.293 Vali Loss: 9.722 Vali Acc: 0.094 Test Loss: 9.722 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4958586
	speed: 0.7302s/iter; left time: 12382.4801s
	iters: 200, epoch: 19 | loss: 0.0194272
	speed: 0.3075s/iter; left time: 5182.9822s
Epoch: 19 cost time: 65.1498954296112
Epoch: 19, Steps: 208 | Train Loss: 0.274 Vali Loss: 9.900 Vali Acc: 0.097 Test Loss: 9.900 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.5079097
	speed: 0.7152s/iter; left time: 11978.5160s
	iters: 200, epoch: 20 | loss: 0.4288773
	speed: 0.2969s/iter; left time: 4942.8984s
Epoch: 20 cost time: 62.120934009552
Epoch: 20, Steps: 208 | Train Loss: 0.259 Vali Loss: 10.261 Vali Acc: 0.103 Test Loss: 10.261 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0780275
	speed: 0.7475s/iter; left time: 12364.2969s
	iters: 200, epoch: 21 | loss: 0.1416046
	speed: 0.3037s/iter; left time: 4992.6124s
Epoch: 21 cost time: 65.95574307441711
Epoch: 21, Steps: 208 | Train Loss: 0.265 Vali Loss: 9.635 Vali Acc: 0.097 Test Loss: 9.635 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3823996
	speed: 0.7062s/iter; left time: 11533.8207s
	iters: 200, epoch: 22 | loss: 0.0204689
	speed: 0.3110s/iter; left time: 5049.1831s
Epoch: 22 cost time: 64.60975813865662
Epoch: 22, Steps: 208 | Train Loss: 0.210 Vali Loss: 10.303 Vali Acc: 0.089 Test Loss: 10.303 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0202575
	speed: 0.7264s/iter; left time: 11713.7198s
	iters: 200, epoch: 23 | loss: 0.1219519
	speed: 0.3051s/iter; left time: 4888.5593s
Epoch: 23 cost time: 64.58008360862732
Epoch: 23, Steps: 208 | Train Loss: 0.204 Vali Loss: 10.422 Vali Acc: 0.097 Test Loss: 10.422 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2669493
	speed: 0.7695s/iter; left time: 12248.7952s
	iters: 200, epoch: 24 | loss: 0.0020369
	speed: 0.3170s/iter; left time: 5013.3135s
Epoch: 24 cost time: 67.50478339195251
Epoch: 24, Steps: 208 | Train Loss: 0.214 Vali Loss: 10.709 Vali Acc: 0.095 Test Loss: 10.709 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1027409
	speed: 0.7306s/iter; left time: 11477.3663s
	iters: 200, epoch: 25 | loss: 0.1384350
	speed: 0.2995s/iter; left time: 4674.5698s
Epoch: 25 cost time: 63.88673520088196
Epoch: 25, Steps: 208 | Train Loss: 0.218 Vali Loss: 10.567 Vali Acc: 0.100 Test Loss: 10.567 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0209411
	speed: 0.6996s/iter; left time: 10844.2923s
	iters: 200, epoch: 26 | loss: 0.2371273
	speed: 0.2921s/iter; left time: 4498.5699s
Epoch: 26 cost time: 61.9267680644989
Epoch: 26, Steps: 208 | Train Loss: 0.168 Vali Loss: 10.736 Vali Acc: 0.093 Test Loss: 10.736 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10587533552042946
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6602519
	speed: 0.3218s/iter; left time: 6661.3400s
	iters: 200, epoch: 1 | loss: 3.7303872
	speed: 0.3083s/iter; left time: 6351.6278s
Epoch: 1 cost time: 65.83901238441467
Epoch: 1, Steps: 208 | Train Loss: 3.687 Vali Loss: 4.339 Vali Acc: 0.073 Test Loss: 4.339 Test Acc: 0.073
Validation loss decreased (inf --> -0.073026).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9013588
	speed: 0.7255s/iter; left time: 14867.5523s
	iters: 200, epoch: 2 | loss: 3.7173340
	speed: 0.2987s/iter; left time: 6091.7050s
Epoch: 2 cost time: 63.87592625617981
Epoch: 2, Steps: 208 | Train Loss: 3.330 Vali Loss: 4.571 Vali Acc: 0.068 Test Loss: 4.571 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.1645069
	speed: 0.7062s/iter; left time: 14325.5887s
	iters: 200, epoch: 3 | loss: 3.0545805
	speed: 0.2933s/iter; left time: 5920.4480s
Epoch: 3 cost time: 61.3436062335968
Epoch: 3, Steps: 208 | Train Loss: 2.925 Vali Loss: 5.036 Vali Acc: 0.074 Test Loss: 5.036 Test Acc: 0.074
Validation loss decreased (-0.073026 --> -0.073615).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7236156
	speed: 0.6896s/iter; left time: 13845.4417s
	iters: 200, epoch: 4 | loss: 2.9530287
	speed: 0.3146s/iter; left time: 6285.1664s
Epoch: 4 cost time: 64.50310015678406
Epoch: 4, Steps: 208 | Train Loss: 2.533 Vali Loss: 4.990 Vali Acc: 0.081 Test Loss: 4.990 Test Acc: 0.081
Validation loss decreased (-0.073615 --> -0.080475).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4864395
	speed: 0.7384s/iter; left time: 14671.4098s
	iters: 200, epoch: 5 | loss: 2.1989896
	speed: 0.3104s/iter; left time: 6137.0444s
Epoch: 5 cost time: 65.03988146781921
Epoch: 5, Steps: 208 | Train Loss: 2.095 Vali Loss: 5.551 Vali Acc: 0.075 Test Loss: 5.551 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7722301
	speed: 0.7565s/iter; left time: 14872.7907s
	iters: 200, epoch: 6 | loss: 1.7617803
	speed: 0.2951s/iter; left time: 5772.3831s
Epoch: 6 cost time: 63.530938148498535
Epoch: 6, Steps: 208 | Train Loss: 1.745 Vali Loss: 5.496 Vali Acc: 0.089 Test Loss: 5.496 Test Acc: 0.089
Validation loss decreased (-0.080475 --> -0.089417).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7513580
	speed: 0.7034s/iter; left time: 13682.6280s
	iters: 200, epoch: 7 | loss: 2.8629491
	speed: 0.3056s/iter; left time: 5914.0372s
Epoch: 7 cost time: 65.02734303474426
Epoch: 7, Steps: 208 | Train Loss: 1.424 Vali Loss: 5.987 Vali Acc: 0.078 Test Loss: 5.987 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6299083
	speed: 0.6933s/iter; left time: 13342.8188s
	iters: 200, epoch: 8 | loss: 1.4285928
	speed: 0.2979s/iter; left time: 5702.4516s
Epoch: 8 cost time: 61.60130572319031
Epoch: 8, Steps: 208 | Train Loss: 1.210 Vali Loss: 6.064 Vali Acc: 0.095 Test Loss: 6.064 Test Acc: 0.095
Validation loss decreased (-0.089417 --> -0.094482).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5288540
	speed: 0.7511s/iter; left time: 14297.9327s
	iters: 200, epoch: 9 | loss: 1.0513299
	speed: 0.2946s/iter; left time: 5578.4209s
Epoch: 9 cost time: 64.55203175544739
Epoch: 9, Steps: 208 | Train Loss: 1.002 Vali Loss: 6.800 Vali Acc: 0.084 Test Loss: 6.800 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3337002
	speed: 0.6989s/iter; left time: 13159.3554s
	iters: 200, epoch: 10 | loss: 0.6618504
	speed: 0.3059s/iter; left time: 5728.7611s
Epoch: 10 cost time: 63.425607681274414
Epoch: 10, Steps: 208 | Train Loss: 0.880 Vali Loss: 6.729 Vali Acc: 0.091 Test Loss: 6.729 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8372374
	speed: 0.7246s/iter; left time: 13493.2031s
	iters: 200, epoch: 11 | loss: 0.7518300
	speed: 0.3263s/iter; left time: 6043.0989s
Epoch: 11 cost time: 66.2300751209259
Epoch: 11, Steps: 208 | Train Loss: 0.751 Vali Loss: 7.102 Vali Acc: 0.078 Test Loss: 7.102 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3210516
	speed: 0.7562s/iter; left time: 13923.8431s
	iters: 200, epoch: 12 | loss: 0.6456102
	speed: 0.3143s/iter; left time: 5756.4259s
Epoch: 12 cost time: 66.56621503829956
Epoch: 12, Steps: 208 | Train Loss: 0.684 Vali Loss: 7.956 Vali Acc: 0.081 Test Loss: 7.956 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4773870
	speed: 0.7233s/iter; left time: 13168.2691s
	iters: 200, epoch: 13 | loss: 0.5660113
	speed: 0.2972s/iter; left time: 5381.3122s
Epoch: 13 cost time: 63.28921151161194
Epoch: 13, Steps: 208 | Train Loss: 0.570 Vali Loss: 7.709 Vali Acc: 0.088 Test Loss: 7.709 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.8582265
	speed: 0.6920s/iter; left time: 12453.9376s
	iters: 200, epoch: 14 | loss: 0.5330960
	speed: 0.2873s/iter; left time: 5141.4132s
Epoch: 14 cost time: 60.200637102127075
Epoch: 14, Steps: 208 | Train Loss: 0.533 Vali Loss: 7.985 Vali Acc: 0.082 Test Loss: 7.985 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3644057
	speed: 0.6923s/iter; left time: 12314.6479s
	iters: 200, epoch: 15 | loss: 0.1878358
	speed: 0.2872s/iter; left time: 5079.6711s
Epoch: 15 cost time: 60.49759769439697
Epoch: 15, Steps: 208 | Train Loss: 0.464 Vali Loss: 8.234 Vali Acc: 0.086 Test Loss: 8.234 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.4545907
	speed: 0.7051s/iter; left time: 12396.0585s
	iters: 200, epoch: 16 | loss: 1.1421443
	speed: 0.2942s/iter; left time: 5142.1270s
Epoch: 16 cost time: 62.423076152801514
Epoch: 16, Steps: 208 | Train Loss: 0.425 Vali Loss: 7.996 Vali Acc: 0.096 Test Loss: 7.996 Test Acc: 0.096
Validation loss decreased (-0.094482 --> -0.095953).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1485530
	speed: 0.6933s/iter; left time: 12044.4734s
	iters: 200, epoch: 17 | loss: 0.9267375
	speed: 0.3337s/iter; left time: 5764.5184s
Epoch: 17 cost time: 65.22491264343262
Epoch: 17, Steps: 208 | Train Loss: 0.390 Vali Loss: 8.434 Vali Acc: 0.078 Test Loss: 8.434 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2295143
	speed: 0.7348s/iter; left time: 12612.5600s
	iters: 200, epoch: 18 | loss: 0.4950678
	speed: 0.2811s/iter; left time: 4797.6531s
Epoch: 18 cost time: 60.29550385475159
Epoch: 18, Steps: 208 | Train Loss: 0.336 Vali Loss: 9.026 Vali Acc: 0.085 Test Loss: 9.026 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2555494
	speed: 0.7219s/iter; left time: 12242.0503s
	iters: 200, epoch: 19 | loss: 0.0638640
	speed: 0.2952s/iter; left time: 4976.6401s
Epoch: 19 cost time: 63.8804612159729
Epoch: 19, Steps: 208 | Train Loss: 0.303 Vali Loss: 8.692 Vali Acc: 0.083 Test Loss: 8.692 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1149960
	speed: 0.7116s/iter; left time: 11918.3561s
	iters: 200, epoch: 20 | loss: 0.1765226
	speed: 0.3072s/iter; left time: 5114.5196s
Epoch: 20 cost time: 64.31362056732178
Epoch: 20, Steps: 208 | Train Loss: 0.266 Vali Loss: 9.420 Vali Acc: 0.078 Test Loss: 9.420 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0940342
	speed: 0.6876s/iter; left time: 11374.1200s
	iters: 200, epoch: 21 | loss: 0.8042716
	speed: 0.2816s/iter; left time: 4630.0013s
Epoch: 21 cost time: 58.9327278137207
Epoch: 21, Steps: 208 | Train Loss: 0.260 Vali Loss: 9.460 Vali Acc: 0.087 Test Loss: 9.460 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4314569
	speed: 0.6941s/iter; left time: 11337.2447s
	iters: 200, epoch: 22 | loss: 0.3161938
	speed: 0.2763s/iter; left time: 4484.5165s
Epoch: 22 cost time: 59.45266914367676
Epoch: 22, Steps: 208 | Train Loss: 0.268 Vali Loss: 9.279 Vali Acc: 0.086 Test Loss: 9.279 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0554023
	speed: 0.6660s/iter; left time: 10739.0491s
	iters: 200, epoch: 23 | loss: 0.4175230
	speed: 0.3193s/iter; left time: 5117.5460s
Epoch: 23 cost time: 64.72999882698059
Epoch: 23, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.161 Vali Acc: 0.088 Test Loss: 9.161 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0040000
	speed: 0.6967s/iter; left time: 11089.8572s
	iters: 200, epoch: 24 | loss: 0.0534205
	speed: 0.2882s/iter; left time: 4558.3946s
Epoch: 24 cost time: 61.09768557548523
Epoch: 24, Steps: 208 | Train Loss: 0.239 Vali Loss: 10.047 Vali Acc: 0.086 Test Loss: 10.047 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1215818
	speed: 0.7061s/iter; left time: 11092.1889s
	iters: 200, epoch: 25 | loss: 0.2479459
	speed: 0.2805s/iter; left time: 4378.1386s
Epoch: 25 cost time: 60.23483109474182
Epoch: 25, Steps: 208 | Train Loss: 0.183 Vali Loss: 10.005 Vali Acc: 0.091 Test Loss: 10.005 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0149119
	speed: 0.6615s/iter; left time: 10253.8080s
	iters: 200, epoch: 26 | loss: 0.1457630
	speed: 0.2946s/iter; left time: 4536.7521s
Epoch: 26 cost time: 60.694098234176636
Epoch: 26, Steps: 208 | Train Loss: 0.169 Vali Loss: 10.388 Vali Acc: 0.085 Test Loss: 10.388 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09603340292275574
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6099305
	speed: 0.3229s/iter; left time: 6683.7755s
	iters: 200, epoch: 1 | loss: 3.4176793
	speed: 0.3349s/iter; left time: 6898.8882s
Epoch: 1 cost time: 68.69590759277344
Epoch: 1, Steps: 208 | Train Loss: 3.693 Vali Loss: 4.452 Vali Acc: 0.039 Test Loss: 4.452 Test Acc: 0.039
Validation loss decreased (inf --> -0.039025).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7971368
	speed: 0.7123s/iter; left time: 14597.9289s
	iters: 200, epoch: 2 | loss: 3.3453875
	speed: 0.3015s/iter; left time: 6147.4814s
Epoch: 2 cost time: 62.12483024597168
Epoch: 2, Steps: 208 | Train Loss: 3.401 Vali Loss: 4.910 Vali Acc: 0.037 Test Loss: 4.910 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.1471708
	speed: 0.6921s/iter; left time: 14039.5089s
	iters: 200, epoch: 3 | loss: 3.3469589
	speed: 0.2901s/iter; left time: 5855.7904s
Epoch: 3 cost time: 60.179227352142334
Epoch: 3, Steps: 208 | Train Loss: 3.139 Vali Loss: 4.898 Vali Acc: 0.039 Test Loss: 4.898 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3995454
	speed: 0.6986s/iter; left time: 14025.9686s
	iters: 200, epoch: 4 | loss: 3.0092311
	speed: 0.2998s/iter; left time: 5989.3464s
Epoch: 4 cost time: 62.27408480644226
Epoch: 4, Steps: 208 | Train Loss: 2.865 Vali Loss: 4.949 Vali Acc: 0.055 Test Loss: 4.949 Test Acc: 0.055
Validation loss decreased (-0.039025 --> -0.055423).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6239583
	speed: 0.7071s/iter; left time: 14048.4541s
	iters: 200, epoch: 5 | loss: 3.1696239
	speed: 0.2827s/iter; left time: 5589.2431s
Epoch: 5 cost time: 59.86285352706909
Epoch: 5, Steps: 208 | Train Loss: 2.565 Vali Loss: 5.150 Vali Acc: 0.050 Test Loss: 5.150 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5084348
	speed: 0.6984s/iter; left time: 13731.6915s
	iters: 200, epoch: 6 | loss: 2.6352539
	speed: 0.2785s/iter; left time: 5448.5162s
Epoch: 6 cost time: 59.84386467933655
Epoch: 6, Steps: 208 | Train Loss: 2.167 Vali Loss: 5.114 Vali Acc: 0.066 Test Loss: 5.114 Test Acc: 0.066
Validation loss decreased (-0.055423 --> -0.066158).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5668993
	speed: 0.7177s/iter; left time: 13961.6323s
	iters: 200, epoch: 7 | loss: 2.6369295
	speed: 0.3088s/iter; left time: 5975.8956s
Epoch: 7 cost time: 64.86727929115295
Epoch: 7, Steps: 208 | Train Loss: 1.759 Vali Loss: 5.503 Vali Acc: 0.069 Test Loss: 5.503 Test Acc: 0.069
Validation loss decreased (-0.066158 --> -0.069137).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1991282
	speed: 0.7038s/iter; left time: 13544.7271s
	iters: 200, epoch: 8 | loss: 1.3521786
	speed: 0.2861s/iter; left time: 5478.1758s
Epoch: 8 cost time: 62.112826347351074
Epoch: 8, Steps: 208 | Train Loss: 1.403 Vali Loss: 6.144 Vali Acc: 0.065 Test Loss: 6.144 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5524579
	speed: 0.6990s/iter; left time: 13306.9857s
	iters: 200, epoch: 9 | loss: 1.2355570
	speed: 0.2826s/iter; left time: 5352.2304s
Epoch: 9 cost time: 61.39911699295044
Epoch: 9, Steps: 208 | Train Loss: 1.157 Vali Loss: 6.364 Vali Acc: 0.076 Test Loss: 6.364 Test Acc: 0.076
Validation loss decreased (-0.069137 --> -0.076286).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5043681
	speed: 0.6839s/iter; left time: 12877.9034s
	iters: 200, epoch: 10 | loss: 0.8929199
	speed: 0.2874s/iter; left time: 5383.1222s
Epoch: 10 cost time: 61.858612298965454
Epoch: 10, Steps: 208 | Train Loss: 0.954 Vali Loss: 6.726 Vali Acc: 0.081 Test Loss: 6.726 Test Acc: 0.081
Validation loss decreased (-0.076286 --> -0.080458).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8270239
	speed: 0.6613s/iter; left time: 12314.8468s
	iters: 200, epoch: 11 | loss: 0.4137955
	speed: 0.3001s/iter; left time: 5557.7310s
Epoch: 11 cost time: 61.41122317314148
Epoch: 11, Steps: 208 | Train Loss: 0.783 Vali Loss: 7.293 Vali Acc: 0.072 Test Loss: 7.293 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8037694
	speed: 0.6802s/iter; left time: 12523.9937s
	iters: 200, epoch: 12 | loss: 0.5839980
	speed: 0.2939s/iter; left time: 5382.5653s
Epoch: 12 cost time: 62.06524085998535
Epoch: 12, Steps: 208 | Train Loss: 0.673 Vali Loss: 7.560 Vali Acc: 0.077 Test Loss: 7.560 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5060709
	speed: 0.6975s/iter; left time: 12697.6993s
	iters: 200, epoch: 13 | loss: 0.5020298
	speed: 0.2959s/iter; left time: 5358.0542s
Epoch: 13 cost time: 62.729092836380005
Epoch: 13, Steps: 208 | Train Loss: 0.584 Vali Loss: 7.890 Vali Acc: 0.076 Test Loss: 7.890 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1148891
	speed: 0.6803s/iter; left time: 12243.7375s
	iters: 200, epoch: 14 | loss: 0.4175360
	speed: 0.2883s/iter; left time: 5159.0786s
Epoch: 14 cost time: 61.117037773132324
Epoch: 14, Steps: 208 | Train Loss: 0.519 Vali Loss: 8.016 Vali Acc: 0.071 Test Loss: 8.016 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2951048
	speed: 0.6568s/iter; left time: 11683.3473s
	iters: 200, epoch: 15 | loss: 0.3023607
	speed: 0.2967s/iter; left time: 5247.5887s
Epoch: 15 cost time: 59.310893058776855
Epoch: 15, Steps: 208 | Train Loss: 0.460 Vali Loss: 8.033 Vali Acc: 0.073 Test Loss: 8.033 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4845241
	speed: 0.6828s/iter; left time: 12003.7381s
	iters: 200, epoch: 16 | loss: 0.4752982
	speed: 0.2859s/iter; left time: 4998.2064s
Epoch: 16 cost time: 59.661699533462524
Epoch: 16, Steps: 208 | Train Loss: 0.428 Vali Loss: 8.571 Vali Acc: 0.083 Test Loss: 8.571 Test Acc: 0.083
Validation loss decreased (-0.080458 --> -0.082825).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3932766
	speed: 0.6787s/iter; left time: 11791.3279s
	iters: 200, epoch: 17 | loss: 0.5998771
	speed: 0.2726s/iter; left time: 4709.2254s
Epoch: 17 cost time: 58.39173913002014
Epoch: 17, Steps: 208 | Train Loss: 0.347 Vali Loss: 8.960 Vali Acc: 0.076 Test Loss: 8.960 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5386563
	speed: 0.6699s/iter; left time: 11498.3860s
	iters: 200, epoch: 18 | loss: 0.0966961
	speed: 0.2729s/iter; left time: 4656.5062s
Epoch: 18 cost time: 57.32962107658386
Epoch: 18, Steps: 208 | Train Loss: 0.348 Vali Loss: 9.221 Vali Acc: 0.082 Test Loss: 9.221 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0149351
	speed: 0.6695s/iter; left time: 11351.9046s
	iters: 200, epoch: 19 | loss: 0.2445705
	speed: 0.2643s/iter; left time: 4454.8723s
Epoch: 19 cost time: 57.10151481628418
Epoch: 19, Steps: 208 | Train Loss: 0.326 Vali Loss: 9.267 Vali Acc: 0.073 Test Loss: 9.267 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.5879155
	speed: 0.6787s/iter; left time: 11368.1761s
	iters: 200, epoch: 20 | loss: 0.3871631
	speed: 0.2922s/iter; left time: 4865.6475s
Epoch: 20 cost time: 60.93654942512512
Epoch: 20, Steps: 208 | Train Loss: 0.294 Vali Loss: 9.299 Vali Acc: 0.076 Test Loss: 9.299 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0143076
	speed: 0.6695s/iter; left time: 11073.3949s
	iters: 200, epoch: 21 | loss: 0.5510773
	speed: 0.2852s/iter; left time: 4689.3205s
Epoch: 21 cost time: 59.992531299591064
Epoch: 21, Steps: 208 | Train Loss: 0.254 Vali Loss: 9.706 Vali Acc: 0.082 Test Loss: 9.706 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2096356
	speed: 0.6592s/iter; left time: 10767.0032s
	iters: 200, epoch: 22 | loss: 0.6771096
	speed: 0.2897s/iter; left time: 4702.3944s
Epoch: 22 cost time: 60.408467531204224
Epoch: 22, Steps: 208 | Train Loss: 0.280 Vali Loss: 9.793 Vali Acc: 0.069 Test Loss: 9.793 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0260315
	speed: 0.6638s/iter; left time: 10703.6076s
	iters: 200, epoch: 23 | loss: 0.1991830
	speed: 0.2834s/iter; left time: 4542.0969s
Epoch: 23 cost time: 60.563233852386475
Epoch: 23, Steps: 208 | Train Loss: 0.219 Vali Loss: 10.278 Vali Acc: 0.083 Test Loss: 10.278 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0412649
	speed: 0.6669s/iter; left time: 10615.1734s
	iters: 200, epoch: 24 | loss: 0.0764380
	speed: 0.2937s/iter; left time: 4646.1548s
Epoch: 24 cost time: 60.15923094749451
Epoch: 24, Steps: 208 | Train Loss: 0.220 Vali Loss: 10.268 Vali Acc: 0.064 Test Loss: 10.268 Test Acc: 0.064
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0033943
	speed: 0.6987s/iter; left time: 10975.1639s
	iters: 200, epoch: 25 | loss: 0.0393336
	speed: 0.2871s/iter; left time: 4481.7733s
Epoch: 25 cost time: 59.87731099128723
Epoch: 25, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.329 Vali Acc: 0.085 Test Loss: 10.329 Test Acc: 0.085
Validation loss decreased (-0.082825 --> -0.085193).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0200367
	speed: 0.6732s/iter; left time: 10435.2666s
	iters: 200, epoch: 26 | loss: 0.0140828
	speed: 0.2809s/iter; left time: 4326.0446s
Epoch: 26 cost time: 59.731327533721924
Epoch: 26, Steps: 208 | Train Loss: 0.189 Vali Loss: 10.133 Vali Acc: 0.073 Test Loss: 10.133 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.2477556
	speed: 0.6823s/iter; left time: 10434.0187s
	iters: 200, epoch: 27 | loss: 0.5300504
	speed: 0.2924s/iter; left time: 4442.9811s
Epoch: 27 cost time: 60.07388186454773
Epoch: 27, Steps: 208 | Train Loss: 0.217 Vali Loss: 10.478 Vali Acc: 0.077 Test Loss: 10.478 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.4494998
	speed: 0.7087s/iter; left time: 10690.9337s
	iters: 200, epoch: 28 | loss: 0.0357293
	speed: 0.2751s/iter; left time: 4122.3599s
Epoch: 28 cost time: 59.55186676979065
Epoch: 28, Steps: 208 | Train Loss: 0.208 Vali Loss: 10.732 Vali Acc: 0.075 Test Loss: 10.732 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0519232
	speed: 0.7039s/iter; left time: 10471.4692s
	iters: 200, epoch: 29 | loss: 0.0835179
	speed: 0.2767s/iter; left time: 4088.3920s
Epoch: 29 cost time: 60.52476382255554
Epoch: 29, Steps: 208 | Train Loss: 0.199 Vali Loss: 10.538 Vali Acc: 0.080 Test Loss: 10.538 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0955847
	speed: 0.6886s/iter; left time: 10101.0297s
	iters: 200, epoch: 30 | loss: 0.0106258
	speed: 0.2843s/iter; left time: 4142.4735s
Epoch: 30 cost time: 60.28067493438721
Epoch: 30, Steps: 208 | Train Loss: 0.154 Vali Loss: 10.808 Vali Acc: 0.081 Test Loss: 10.808 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0235241
	speed: 0.7014s/iter; left time: 10142.4289s
	iters: 200, epoch: 31 | loss: 0.2046084
	speed: 0.2867s/iter; left time: 4117.4930s
Epoch: 31 cost time: 61.863150119781494
Epoch: 31, Steps: 208 | Train Loss: 0.167 Vali Loss: 10.771 Vali Acc: 0.081 Test Loss: 10.771 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.1988895
	speed: 0.7184s/iter; left time: 10239.0622s
	iters: 200, epoch: 32 | loss: 0.1937205
	speed: 0.2992s/iter; left time: 4234.7366s
Epoch: 32 cost time: 63.50839972496033
Epoch: 32, Steps: 208 | Train Loss: 0.154 Vali Loss: 11.038 Vali Acc: 0.081 Test Loss: 11.038 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.1776451
	speed: 0.6538s/iter; left time: 9182.0301s
	iters: 200, epoch: 33 | loss: 0.5404544
	speed: 0.2939s/iter; left time: 4098.5510s
Epoch: 33 cost time: 59.32386040687561
Epoch: 33, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.023 Vali Acc: 0.076 Test Loss: 11.023 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.1396803
	speed: 0.6553s/iter; left time: 9067.3244s
	iters: 200, epoch: 34 | loss: 0.1706823
	speed: 0.2747s/iter; left time: 3773.1153s
Epoch: 34 cost time: 57.898695945739746
Epoch: 34, Steps: 208 | Train Loss: 0.168 Vali Loss: 11.148 Vali Acc: 0.079 Test Loss: 11.148 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0882197
	speed: 0.6946s/iter; left time: 9466.2231s
	iters: 200, epoch: 35 | loss: 0.2878595
	speed: 0.2753s/iter; left time: 3724.7949s
Epoch: 35 cost time: 60.822237491607666
Epoch: 35, Steps: 208 | Train Loss: 0.162 Vali Loss: 11.912 Vali Acc: 0.079 Test Loss: 11.912 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08529674917983895
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5367937
	speed: 0.2983s/iter; left time: 6175.3103s
	iters: 200, epoch: 1 | loss: 3.6234279
	speed: 0.2833s/iter; left time: 5835.6511s
Epoch: 1 cost time: 60.73733639717102
Epoch: 1, Steps: 208 | Train Loss: 3.658 Vali Loss: 4.881 Vali Acc: 0.033 Test Loss: 4.881 Test Acc: 0.033
Validation loss decreased (inf --> -0.033056).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9223990
	speed: 0.6677s/iter; left time: 13683.5795s
	iters: 200, epoch: 2 | loss: 3.7722509
	speed: 0.2771s/iter; left time: 5651.5359s
Epoch: 2 cost time: 59.6446738243103
Epoch: 2, Steps: 208 | Train Loss: 3.454 Vali Loss: 5.330 Vali Acc: 0.033 Test Loss: 5.330 Test Acc: 0.033
Validation loss decreased (-0.033056 --> -0.033350).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3366940
	speed: 0.7360s/iter; left time: 14930.6489s
	iters: 200, epoch: 3 | loss: 3.1004114
	speed: 0.3338s/iter; left time: 6736.8933s
Epoch: 3 cost time: 67.71241188049316
Epoch: 3, Steps: 208 | Train Loss: 3.293 Vali Loss: 4.841 Vali Acc: 0.043 Test Loss: 4.841 Test Acc: 0.043
Validation loss decreased (-0.033350 --> -0.042600).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1264143
	speed: 0.7267s/iter; left time: 14590.3171s
	iters: 200, epoch: 4 | loss: 3.1515155
	speed: 0.3136s/iter; left time: 6264.2924s
Epoch: 4 cost time: 65.65885043144226
Epoch: 4, Steps: 208 | Train Loss: 3.105 Vali Loss: 4.754 Vali Acc: 0.052 Test Loss: 4.754 Test Acc: 0.052
Validation loss decreased (-0.042600 --> -0.051846).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4735684
	speed: 0.7011s/iter; left time: 13929.2055s
	iters: 200, epoch: 5 | loss: 3.4241121
	speed: 0.3037s/iter; left time: 6003.3344s
Epoch: 5 cost time: 62.77464270591736
Epoch: 5, Steps: 208 | Train Loss: 2.797 Vali Loss: 4.857 Vali Acc: 0.052 Test Loss: 4.857 Test Acc: 0.052
Validation loss decreased (-0.051846 --> -0.052442).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3375280
	speed: 0.7177s/iter; left time: 14109.8751s
	iters: 200, epoch: 6 | loss: 2.8373234
	speed: 0.3203s/iter; left time: 6265.4211s
Epoch: 6 cost time: 65.69869112968445
Epoch: 6, Steps: 208 | Train Loss: 2.527 Vali Loss: 4.836 Vali Acc: 0.058 Test Loss: 4.836 Test Acc: 0.058
Validation loss decreased (-0.052442 --> -0.058407).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3036826
	speed: 0.7219s/iter; left time: 14042.6269s
	iters: 200, epoch: 7 | loss: 2.6831205
	speed: 0.2929s/iter; left time: 5667.6653s
Epoch: 7 cost time: 63.696820974349976
Epoch: 7, Steps: 208 | Train Loss: 2.135 Vali Loss: 5.004 Vali Acc: 0.062 Test Loss: 5.004 Test Acc: 0.062
Validation loss decreased (-0.058407 --> -0.062282).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4455707
	speed: 0.7122s/iter; left time: 13705.6626s
	iters: 200, epoch: 8 | loss: 2.2200944
	speed: 0.3074s/iter; left time: 5885.3370s
Epoch: 8 cost time: 63.19197368621826
Epoch: 8, Steps: 208 | Train Loss: 1.868 Vali Loss: 5.302 Vali Acc: 0.069 Test Loss: 5.302 Test Acc: 0.069
Validation loss decreased (-0.062282 --> -0.069437).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4653407
	speed: 0.6920s/iter; left time: 13174.3512s
	iters: 200, epoch: 9 | loss: 2.3720074
	speed: 0.2915s/iter; left time: 5520.1892s
Epoch: 9 cost time: 62.656821489334106
Epoch: 9, Steps: 208 | Train Loss: 1.481 Vali Loss: 5.703 Vali Acc: 0.067 Test Loss: 5.703 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6891007
	speed: 0.6747s/iter; left time: 12704.7551s
	iters: 200, epoch: 10 | loss: 1.2785501
	speed: 0.2879s/iter; left time: 5392.1872s
Epoch: 10 cost time: 61.653496980667114
Epoch: 10, Steps: 208 | Train Loss: 1.251 Vali Loss: 6.068 Vali Acc: 0.077 Test Loss: 6.068 Test Acc: 0.077
Validation loss decreased (-0.069437 --> -0.076587).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1593270
	speed: 0.6790s/iter; left time: 12644.0156s
	iters: 200, epoch: 11 | loss: 1.4348397
	speed: 0.3059s/iter; left time: 5666.2762s
Epoch: 11 cost time: 61.779149770736694
Epoch: 11, Steps: 208 | Train Loss: 1.036 Vali Loss: 6.399 Vali Acc: 0.073 Test Loss: 6.399 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9328351
	speed: 0.7253s/iter; left time: 13354.6708s
	iters: 200, epoch: 12 | loss: 0.3944007
	speed: 0.3160s/iter; left time: 5786.9716s
Epoch: 12 cost time: 67.50861382484436
Epoch: 12, Steps: 208 | Train Loss: 0.913 Vali Loss: 6.641 Vali Acc: 0.077 Test Loss: 6.641 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9997792
	speed: 0.7075s/iter; left time: 12879.6714s
	iters: 200, epoch: 13 | loss: 0.8226035
	speed: 0.2946s/iter; left time: 5333.9411s
Epoch: 13 cost time: 61.9128360748291
Epoch: 13, Steps: 208 | Train Loss: 0.778 Vali Loss: 7.092 Vali Acc: 0.070 Test Loss: 7.092 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2392424
	speed: 0.6856s/iter; left time: 12338.2770s
	iters: 200, epoch: 14 | loss: 0.6589337
	speed: 0.3071s/iter; left time: 5496.0687s
Epoch: 14 cost time: 63.876429080963135
Epoch: 14, Steps: 208 | Train Loss: 0.658 Vali Loss: 7.450 Vali Acc: 0.070 Test Loss: 7.450 Test Acc: 0.070
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.5684202
	speed: 0.7137s/iter; left time: 12696.2635s
	iters: 200, epoch: 15 | loss: 0.3399228
	speed: 0.3039s/iter; left time: 5374.9583s
Epoch: 15 cost time: 64.48607087135315
Epoch: 15, Steps: 208 | Train Loss: 0.625 Vali Loss: 7.563 Vali Acc: 0.067 Test Loss: 7.563 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4913581
	speed: 0.7170s/iter; left time: 12605.6545s
	iters: 200, epoch: 16 | loss: 1.3225442
	speed: 0.3070s/iter; left time: 5366.1882s
Epoch: 16 cost time: 64.29715490341187
Epoch: 16, Steps: 208 | Train Loss: 0.547 Vali Loss: 7.826 Vali Acc: 0.078 Test Loss: 7.826 Test Acc: 0.078
Validation loss decreased (-0.076587 --> -0.078359).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4786793
	speed: 0.6619s/iter; left time: 11498.5439s
	iters: 200, epoch: 17 | loss: 1.2400863
	speed: 0.2974s/iter; left time: 5137.3330s
Epoch: 17 cost time: 62.21985602378845
Epoch: 17, Steps: 208 | Train Loss: 0.499 Vali Loss: 7.945 Vali Acc: 0.072 Test Loss: 7.945 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0100708
	speed: 0.6849s/iter; left time: 11756.9996s
	iters: 200, epoch: 18 | loss: 0.3177569
	speed: 0.2961s/iter; left time: 5052.5649s
Epoch: 18 cost time: 62.959452867507935
Epoch: 18, Steps: 208 | Train Loss: 0.453 Vali Loss: 7.898 Vali Acc: 0.073 Test Loss: 7.898 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0187105
	speed: 0.7168s/iter; left time: 12155.2014s
	iters: 200, epoch: 19 | loss: 0.2664056
	speed: 0.3214s/iter; left time: 5418.2557s
Epoch: 19 cost time: 65.38477325439453
Epoch: 19, Steps: 208 | Train Loss: 0.438 Vali Loss: 8.126 Vali Acc: 0.071 Test Loss: 8.126 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2990721
	speed: 0.6809s/iter; left time: 11404.7813s
	iters: 200, epoch: 20 | loss: 0.8703111
	speed: 0.2837s/iter; left time: 4723.6610s
Epoch: 20 cost time: 60.75774049758911
Epoch: 20, Steps: 208 | Train Loss: 0.429 Vali Loss: 8.196 Vali Acc: 0.078 Test Loss: 8.196 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2021258
	speed: 0.6771s/iter; left time: 11200.2859s
	iters: 200, epoch: 21 | loss: 0.5615590
	speed: 0.3084s/iter; left time: 5070.4492s
Epoch: 21 cost time: 64.11787533760071
Epoch: 21, Steps: 208 | Train Loss: 0.392 Vali Loss: 8.094 Vali Acc: 0.076 Test Loss: 8.094 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6156701
	speed: 0.6991s/iter; left time: 11418.8358s
	iters: 200, epoch: 22 | loss: 0.1624450
	speed: 0.3123s/iter; left time: 5069.0430s
Epoch: 22 cost time: 64.86126017570496
Epoch: 22, Steps: 208 | Train Loss: 0.360 Vali Loss: 8.755 Vali Acc: 0.080 Test Loss: 8.755 Test Acc: 0.080
Validation loss decreased (-0.078359 --> -0.080139).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0567814
	speed: 0.7267s/iter; left time: 11718.0628s
	iters: 200, epoch: 23 | loss: 0.6403641
	speed: 0.2925s/iter; left time: 4687.7094s
Epoch: 23 cost time: 63.05046463012695
Epoch: 23, Steps: 208 | Train Loss: 0.350 Vali Loss: 8.703 Vali Acc: 0.080 Test Loss: 8.703 Test Acc: 0.080
Validation loss decreased (-0.080139 --> -0.080140).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2367373
	speed: 0.6705s/iter; left time: 10672.5097s
	iters: 200, epoch: 24 | loss: 0.2614552
	speed: 0.3068s/iter; left time: 4852.2596s
Epoch: 24 cost time: 64.03293967247009
Epoch: 24, Steps: 208 | Train Loss: 0.340 Vali Loss: 8.906 Vali Acc: 0.077 Test Loss: 8.906 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1876165
	speed: 0.7108s/iter; left time: 11166.6403s
	iters: 200, epoch: 25 | loss: 0.1394815
	speed: 0.2961s/iter; left time: 4622.3632s
Epoch: 25 cost time: 61.439783811569214
Epoch: 25, Steps: 208 | Train Loss: 0.312 Vali Loss: 9.109 Vali Acc: 0.086 Test Loss: 9.109 Test Acc: 0.086
Validation loss decreased (-0.080140 --> -0.085504).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0438866
	speed: 0.7052s/iter; left time: 10931.7171s
	iters: 200, epoch: 26 | loss: 0.1655863
	speed: 0.3038s/iter; left time: 4679.5082s
Epoch: 26 cost time: 64.11879920959473
Epoch: 26, Steps: 208 | Train Loss: 0.296 Vali Loss: 9.217 Vali Acc: 0.075 Test Loss: 9.217 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.4323230
	speed: 0.6763s/iter; left time: 10343.0252s
	iters: 200, epoch: 27 | loss: 0.2579843
	speed: 0.2929s/iter; left time: 4449.5953s
Epoch: 27 cost time: 61.78901529312134
Epoch: 27, Steps: 208 | Train Loss: 0.295 Vali Loss: 9.264 Vali Acc: 0.080 Test Loss: 9.264 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.1191706
	speed: 0.6998s/iter; left time: 10556.5100s
	iters: 200, epoch: 28 | loss: 0.1341122
	speed: 0.2986s/iter; left time: 4474.0000s
Epoch: 28 cost time: 63.16870093345642
Epoch: 28, Steps: 208 | Train Loss: 0.257 Vali Loss: 9.749 Vali Acc: 0.070 Test Loss: 9.749 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.1836807
	speed: 0.6893s/iter; left time: 10254.8599s
	iters: 200, epoch: 29 | loss: 0.6609253
	speed: 0.3165s/iter; left time: 4676.8777s
Epoch: 29 cost time: 64.33569812774658
Epoch: 29, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.544 Vali Acc: 0.085 Test Loss: 9.544 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0635387
	speed: 0.7112s/iter; left time: 10432.6847s
	iters: 200, epoch: 30 | loss: 0.1317337
	speed: 0.2956s/iter; left time: 4305.9768s
Epoch: 30 cost time: 62.888609647750854
Epoch: 30, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.708 Vali Acc: 0.071 Test Loss: 9.708 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0435069
	speed: 0.6833s/iter; left time: 9880.8589s
	iters: 200, epoch: 31 | loss: 0.2217588
	speed: 0.3066s/iter; left time: 4403.3978s
Epoch: 31 cost time: 63.23246955871582
Epoch: 31, Steps: 208 | Train Loss: 0.245 Vali Loss: 9.923 Vali Acc: 0.071 Test Loss: 9.923 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0767508
	speed: 0.6747s/iter; left time: 9616.0414s
	iters: 200, epoch: 32 | loss: 0.8853774
	speed: 0.2906s/iter; left time: 4112.8240s
Epoch: 32 cost time: 61.5669002532959
Epoch: 32, Steps: 208 | Train Loss: 0.246 Vali Loss: 10.239 Vali Acc: 0.078 Test Loss: 10.239 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.5388230
	speed: 0.7337s/iter; left time: 10304.8473s
	iters: 200, epoch: 33 | loss: 0.0421090
	speed: 0.3029s/iter; left time: 4224.1963s
Epoch: 33 cost time: 64.55843806266785
Epoch: 33, Steps: 208 | Train Loss: 0.218 Vali Loss: 9.888 Vali Acc: 0.078 Test Loss: 9.888 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0515901
	speed: 0.7234s/iter; left time: 10009.9044s
	iters: 200, epoch: 34 | loss: 0.0208263
	speed: 0.3009s/iter; left time: 4133.0072s
Epoch: 34 cost time: 64.10490608215332
Epoch: 34, Steps: 208 | Train Loss: 0.216 Vali Loss: 9.870 Vali Acc: 0.082 Test Loss: 9.870 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.3262423
	speed: 0.6780s/iter; left time: 9240.4167s
	iters: 200, epoch: 35 | loss: 0.3130699
	speed: 0.2964s/iter; left time: 4009.3705s
Epoch: 35 cost time: 61.35757923126221
Epoch: 35, Steps: 208 | Train Loss: 0.208 Vali Loss: 10.144 Vali Acc: 0.080 Test Loss: 10.144 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08559498956158663
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6462646
	speed: 0.3200s/iter; left time: 6623.5513s
	iters: 200, epoch: 1 | loss: 3.5977414
	speed: 0.3020s/iter; left time: 6220.6629s
Epoch: 1 cost time: 64.74435520172119
Epoch: 1, Steps: 208 | Train Loss: 3.656 Vali Loss: 4.761 Vali Acc: 0.037 Test Loss: 4.761 Test Acc: 0.037
Validation loss decreased (inf --> -0.037232).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7076743
	speed: 0.6860s/iter; left time: 14057.8628s
	iters: 200, epoch: 2 | loss: 3.8253222
	speed: 0.3029s/iter; left time: 6176.3050s
Epoch: 2 cost time: 62.04246187210083
Epoch: 2, Steps: 208 | Train Loss: 3.324 Vali Loss: 5.193 Vali Acc: 0.035 Test Loss: 5.193 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.7450514
	speed: 0.6828s/iter; left time: 13850.6020s
	iters: 200, epoch: 3 | loss: 2.8607345
	speed: 0.2915s/iter; left time: 5883.9987s
Epoch: 3 cost time: 60.2562460899353
Epoch: 3, Steps: 208 | Train Loss: 3.114 Vali Loss: 4.985 Vali Acc: 0.043 Test Loss: 4.985 Test Acc: 0.043
Validation loss decreased (-0.037232 --> -0.043195).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6968744
	speed: 0.6934s/iter; left time: 13921.1028s
	iters: 200, epoch: 4 | loss: 3.0955172
	speed: 0.3071s/iter; left time: 6135.8717s
Epoch: 4 cost time: 63.25845122337341
Epoch: 4, Steps: 208 | Train Loss: 2.868 Vali Loss: 5.076 Vali Acc: 0.054 Test Loss: 5.076 Test Acc: 0.054
Validation loss decreased (-0.043195 --> -0.053633).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1496658
	speed: 0.6946s/iter; left time: 13801.1390s
	iters: 200, epoch: 5 | loss: 2.7410576
	speed: 0.2926s/iter; left time: 5784.0808s
Epoch: 5 cost time: 62.039825677871704
Epoch: 5, Steps: 208 | Train Loss: 2.528 Vali Loss: 5.381 Vali Acc: 0.058 Test Loss: 5.381 Test Acc: 0.058
Validation loss decreased (-0.053633 --> -0.058401).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9573436
	speed: 0.6964s/iter; left time: 13692.8297s
	iters: 200, epoch: 6 | loss: 2.4735489
	speed: 0.2973s/iter; left time: 5816.1625s
Epoch: 6 cost time: 63.10123085975647
Epoch: 6, Steps: 208 | Train Loss: 2.114 Vali Loss: 5.347 Vali Acc: 0.059 Test Loss: 5.347 Test Acc: 0.059
Validation loss decreased (-0.058401 --> -0.058700).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7508148
	speed: 0.7032s/iter; left time: 13678.7127s
	iters: 200, epoch: 7 | loss: 2.4496777
	speed: 0.2985s/iter; left time: 5777.6755s
Epoch: 7 cost time: 62.33691453933716
Epoch: 7, Steps: 208 | Train Loss: 1.721 Vali Loss: 5.751 Vali Acc: 0.069 Test Loss: 5.751 Test Acc: 0.069
Validation loss decreased (-0.058700 --> -0.068538).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6420097
	speed: 0.7132s/iter; left time: 13725.1613s
	iters: 200, epoch: 8 | loss: 1.8167651
	speed: 0.2810s/iter; left time: 5378.7895s
Epoch: 8 cost time: 60.63711380958557
Epoch: 8, Steps: 208 | Train Loss: 1.459 Vali Loss: 5.845 Vali Acc: 0.069 Test Loss: 5.845 Test Acc: 0.069
Validation loss decreased (-0.068538 --> -0.068835).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8152350
	speed: 0.6896s/iter; left time: 13128.0039s
	iters: 200, epoch: 9 | loss: 1.5532486
	speed: 0.2952s/iter; left time: 5589.9428s
Epoch: 9 cost time: 63.04963445663452
Epoch: 9, Steps: 208 | Train Loss: 1.140 Vali Loss: 6.628 Vali Acc: 0.068 Test Loss: 6.628 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0744488
	speed: 0.6596s/iter; left time: 12419.7159s
	iters: 200, epoch: 10 | loss: 1.1887966
	speed: 0.2878s/iter; left time: 5389.3367s
Epoch: 10 cost time: 59.289639949798584
Epoch: 10, Steps: 208 | Train Loss: 0.949 Vali Loss: 6.810 Vali Acc: 0.066 Test Loss: 6.810 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7296302
	speed: 0.6968s/iter; left time: 12974.2138s
	iters: 200, epoch: 11 | loss: 0.3048712
	speed: 0.2946s/iter; left time: 5455.4721s
Epoch: 11 cost time: 61.62907958030701
Epoch: 11, Steps: 208 | Train Loss: 0.803 Vali Loss: 7.186 Vali Acc: 0.070 Test Loss: 7.186 Test Acc: 0.070
Validation loss decreased (-0.068835 --> -0.070313).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2922435
	speed: 0.6962s/iter; left time: 12819.7208s
	iters: 200, epoch: 12 | loss: 0.2902921
	speed: 0.3021s/iter; left time: 5532.9824s
Epoch: 12 cost time: 62.528627157211304
Epoch: 12, Steps: 208 | Train Loss: 0.712 Vali Loss: 7.274 Vali Acc: 0.075 Test Loss: 7.274 Test Acc: 0.075
Validation loss decreased (-0.070313 --> -0.074487).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4197346
	speed: 0.6920s/iter; left time: 12598.2605s
	iters: 200, epoch: 13 | loss: 0.2068520
	speed: 0.2766s/iter; left time: 5007.6466s
Epoch: 13 cost time: 59.03649306297302
Epoch: 13, Steps: 208 | Train Loss: 0.601 Vali Loss: 7.910 Vali Acc: 0.065 Test Loss: 7.910 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0415499
	speed: 0.6734s/iter; left time: 12119.8806s
	iters: 200, epoch: 14 | loss: 0.3157589
	speed: 0.3034s/iter; left time: 5429.1824s
Epoch: 14 cost time: 62.83554458618164
Epoch: 14, Steps: 208 | Train Loss: 0.504 Vali Loss: 7.831 Vali Acc: 0.077 Test Loss: 7.831 Test Acc: 0.077
Validation loss decreased (-0.074487 --> -0.076868).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6028725
	speed: 0.6795s/iter; left time: 12087.0505s
	iters: 200, epoch: 15 | loss: 0.6048490
	speed: 0.2939s/iter; left time: 5198.5164s
Epoch: 15 cost time: 61.55079388618469
Epoch: 15, Steps: 208 | Train Loss: 0.472 Vali Loss: 8.116 Vali Acc: 0.071 Test Loss: 8.116 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0856384
	speed: 0.7249s/iter; left time: 12744.0674s
	iters: 200, epoch: 16 | loss: 0.9477268
	speed: 0.2885s/iter; left time: 5042.5831s
Epoch: 16 cost time: 63.24295687675476
Epoch: 16, Steps: 208 | Train Loss: 0.401 Vali Loss: 8.388 Vali Acc: 0.071 Test Loss: 8.388 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3273252
	speed: 0.6722s/iter; left time: 11677.4372s
	iters: 200, epoch: 17 | loss: 1.3520650
	speed: 0.2982s/iter; left time: 5150.9176s
Epoch: 17 cost time: 61.23196744918823
Epoch: 17, Steps: 208 | Train Loss: 0.370 Vali Loss: 8.779 Vali Acc: 0.077 Test Loss: 8.779 Test Acc: 0.077
Validation loss decreased (-0.076868 --> -0.077156).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5107980
	speed: 0.7041s/iter; left time: 12086.3671s
	iters: 200, epoch: 18 | loss: 0.1772614
	speed: 0.2944s/iter; left time: 5023.4061s
Epoch: 18 cost time: 63.248607873916626
Epoch: 18, Steps: 208 | Train Loss: 0.356 Vali Loss: 9.080 Vali Acc: 0.073 Test Loss: 9.080 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0651953
	speed: 0.6837s/iter; left time: 11594.1621s
	iters: 200, epoch: 19 | loss: 0.2856190
	speed: 0.3057s/iter; left time: 5152.7261s
Epoch: 19 cost time: 63.415706157684326
Epoch: 19, Steps: 208 | Train Loss: 0.319 Vali Loss: 9.554 Vali Acc: 0.076 Test Loss: 9.554 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1798510
	speed: 0.6827s/iter; left time: 11433.7817s
	iters: 200, epoch: 20 | loss: 0.3552082
	speed: 0.2957s/iter; left time: 4923.4659s
Epoch: 20 cost time: 61.741047382354736
Epoch: 20, Steps: 208 | Train Loss: 0.312 Vali Loss: 9.553 Vali Acc: 0.074 Test Loss: 9.553 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0067357
	speed: 0.7096s/iter; left time: 11737.3971s
	iters: 200, epoch: 21 | loss: 0.1747159
	speed: 0.2848s/iter; left time: 4682.3264s
Epoch: 21 cost time: 61.49494552612305
Epoch: 21, Steps: 208 | Train Loss: 0.282 Vali Loss: 9.495 Vali Acc: 0.068 Test Loss: 9.495 Test Acc: 0.068
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0783404
	speed: 0.6687s/iter; left time: 10922.6495s
	iters: 200, epoch: 22 | loss: 0.9149789
	speed: 0.3005s/iter; left time: 4877.9176s
Epoch: 22 cost time: 62.02263832092285
Epoch: 22, Steps: 208 | Train Loss: 0.268 Vali Loss: 9.655 Vali Acc: 0.070 Test Loss: 9.655 Test Acc: 0.070
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.5068097
	speed: 0.6996s/iter; left time: 11280.5845s
	iters: 200, epoch: 23 | loss: 0.5381927
	speed: 0.2974s/iter; left time: 4765.8992s
Epoch: 23 cost time: 62.36863303184509
Epoch: 23, Steps: 208 | Train Loss: 0.236 Vali Loss: 9.902 Vali Acc: 0.081 Test Loss: 9.902 Test Acc: 0.081
Validation loss decreased (-0.077156 --> -0.080724).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0235663
	speed: 0.6877s/iter; left time: 10945.3791s
	iters: 200, epoch: 24 | loss: 0.0167796
	speed: 0.2930s/iter; left time: 4633.9714s
Epoch: 24 cost time: 61.527283906936646
Epoch: 24, Steps: 208 | Train Loss: 0.204 Vali Loss: 10.156 Vali Acc: 0.078 Test Loss: 10.156 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0033809
	speed: 0.6485s/iter; left time: 10187.7446s
	iters: 200, epoch: 25 | loss: 0.1036136
	speed: 0.2891s/iter; left time: 4512.1053s
Epoch: 25 cost time: 59.021772146224976
Epoch: 25, Steps: 208 | Train Loss: 0.236 Vali Loss: 10.048 Vali Acc: 0.076 Test Loss: 10.048 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0674032
	speed: 0.7134s/iter; left time: 11059.1353s
	iters: 200, epoch: 26 | loss: 0.0619860
	speed: 0.3002s/iter; left time: 4623.1854s
Epoch: 26 cost time: 63.39493250846863
Epoch: 26, Steps: 208 | Train Loss: 0.218 Vali Loss: 10.660 Vali Acc: 0.078 Test Loss: 10.660 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1926463
	speed: 0.6791s/iter; left time: 10384.7742s
	iters: 200, epoch: 27 | loss: 0.0775270
	speed: 0.2972s/iter; left time: 4515.5984s
Epoch: 27 cost time: 62.31323766708374
Epoch: 27, Steps: 208 | Train Loss: 0.201 Vali Loss: 10.682 Vali Acc: 0.079 Test Loss: 10.682 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0189930
	speed: 0.6864s/iter; left time: 10353.5950s
	iters: 200, epoch: 28 | loss: 0.2648449
	speed: 0.2626s/iter; left time: 3934.5576s
Epoch: 28 cost time: 57.464548110961914
Epoch: 28, Steps: 208 | Train Loss: 0.206 Vali Loss: 10.438 Vali Acc: 0.077 Test Loss: 10.438 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0488495
	speed: 0.6591s/iter; left time: 9806.1501s
	iters: 200, epoch: 29 | loss: 0.0228554
	speed: 0.3031s/iter; left time: 4479.1343s
Epoch: 29 cost time: 63.155911445617676
Epoch: 29, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.820 Vali Acc: 0.079 Test Loss: 10.820 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0463640
	speed: 0.7056s/iter; left time: 10351.0230s
	iters: 200, epoch: 30 | loss: 0.0179937
	speed: 0.3009s/iter; left time: 4384.4898s
Epoch: 30 cost time: 63.528339862823486
Epoch: 30, Steps: 208 | Train Loss: 0.195 Vali Loss: 10.934 Vali Acc: 0.080 Test Loss: 10.934 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.2969035
	speed: 0.7135s/iter; left time: 10317.2558s
	iters: 200, epoch: 31 | loss: 0.0131514
	speed: 0.2925s/iter; left time: 4201.0536s
Epoch: 31 cost time: 62.46209383010864
Epoch: 31, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.105 Vali Acc: 0.075 Test Loss: 11.105 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0288376
	speed: 0.6791s/iter; left time: 9678.8122s
	iters: 200, epoch: 32 | loss: 0.0306592
	speed: 0.2929s/iter; left time: 4145.7011s
Epoch: 32 cost time: 61.53598737716675
Epoch: 32, Steps: 208 | Train Loss: 0.155 Vali Loss: 11.334 Vali Acc: 0.083 Test Loss: 11.334 Test Acc: 0.083
Validation loss decreased (-0.080724 --> -0.082499).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.3580992
	speed: 0.6762s/iter; left time: 9497.7060s
	iters: 200, epoch: 33 | loss: 0.0021257
	speed: 0.2860s/iter; left time: 3988.6026s
Epoch: 33 cost time: 60.6002357006073
Epoch: 33, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.711 Vali Acc: 0.079 Test Loss: 11.711 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.3614140
	speed: 0.7028s/iter; left time: 9725.2083s
	iters: 200, epoch: 34 | loss: 0.0063342
	speed: 0.2999s/iter; left time: 4119.4884s
Epoch: 34 cost time: 62.41244626045227
Epoch: 34, Steps: 208 | Train Loss: 0.178 Vali Loss: 11.161 Vali Acc: 0.078 Test Loss: 11.161 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.1650035
	speed: 0.6692s/iter; left time: 9120.1172s
	iters: 200, epoch: 35 | loss: 0.3912868
	speed: 0.2856s/iter; left time: 3863.3455s
Epoch: 35 cost time: 60.412306785583496
Epoch: 35, Steps: 208 | Train Loss: 0.145 Vali Loss: 11.108 Vali Acc: 0.082 Test Loss: 11.108 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.4524650
	speed: 0.6760s/iter; left time: 9072.0180s
	iters: 200, epoch: 36 | loss: 0.0464211
	speed: 0.3026s/iter; left time: 4030.4452s
Epoch: 36 cost time: 63.14655900001526
Epoch: 36, Steps: 208 | Train Loss: 0.149 Vali Loss: 11.891 Vali Acc: 0.075 Test Loss: 11.891 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.1091976
	speed: 0.6995s/iter; left time: 9242.7536s
	iters: 200, epoch: 37 | loss: 0.1787348
	speed: 0.2940s/iter; left time: 3855.3020s
Epoch: 37 cost time: 62.73818111419678
Epoch: 37, Steps: 208 | Train Loss: 0.121 Vali Loss: 11.970 Vali Acc: 0.082 Test Loss: 11.970 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.8890157
	speed: 0.6882s/iter; left time: 8949.6453s
	iters: 200, epoch: 38 | loss: 0.4885851
	speed: 0.2877s/iter; left time: 3712.3670s
Epoch: 38 cost time: 60.16104483604431
Epoch: 38, Steps: 208 | Train Loss: 0.129 Vali Loss: 12.112 Vali Acc: 0.079 Test Loss: 12.112 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.2126503
	speed: 0.6994s/iter; left time: 8950.6274s
	iters: 200, epoch: 39 | loss: 0.0036156
	speed: 0.2740s/iter; left time: 3479.3036s
Epoch: 39 cost time: 59.9307222366333
Epoch: 39, Steps: 208 | Train Loss: 0.114 Vali Loss: 12.041 Vali Acc: 0.078 Test Loss: 12.041 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.6074736
	speed: 0.6654s/iter; left time: 8376.1665s
	iters: 200, epoch: 40 | loss: 0.0270383
	speed: 0.3028s/iter; left time: 3782.0472s
Epoch: 40 cost time: 63.054396629333496
Epoch: 40, Steps: 208 | Train Loss: 0.151 Vali Loss: 11.971 Vali Acc: 0.077 Test Loss: 11.971 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0048882
	speed: 0.7084s/iter; left time: 8771.0987s
	iters: 200, epoch: 41 | loss: 0.1457395
	speed: 0.3154s/iter; left time: 3873.5809s
Epoch: 41 cost time: 63.9106011390686
Epoch: 41, Steps: 208 | Train Loss: 0.128 Vali Loss: 12.099 Vali Acc: 0.071 Test Loss: 12.099 Test Acc: 0.071
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0049225
	speed: 0.6995s/iter; left time: 8515.6040s
	iters: 200, epoch: 42 | loss: 0.0731406
	speed: 0.2784s/iter; left time: 3361.5219s
Epoch: 42 cost time: 60.10818266868591
Epoch: 42, Steps: 208 | Train Loss: 0.119 Vali Loss: 12.329 Vali Acc: 0.078 Test Loss: 12.329 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08261258574410975
model parameter : 3322023
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0290203
	speed: 0.2839s/iter; left time: 5877.4015s
	iters: 200, epoch: 1 | loss: 3.7740145
	speed: 0.2826s/iter; left time: 5821.4755s
Epoch: 1 cost time: 59.231789112091064
Epoch: 1, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.683 Vali Acc: 0.078 Test Loss: 3.683 Test Acc: 0.078
Validation loss decreased (inf --> -0.077506).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7364364
	speed: 0.6849s/iter; left time: 14036.5492s
	iters: 200, epoch: 2 | loss: 3.5839829
	speed: 0.2871s/iter; left time: 5854.7562s
Epoch: 2 cost time: 61.14060568809509
Epoch: 2, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.931 Vali Acc: 0.084 Test Loss: 3.931 Test Acc: 0.084
Validation loss decreased (-0.077506 --> -0.084064).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5070207
	speed: 0.6657s/iter; left time: 13503.1380s
	iters: 200, epoch: 3 | loss: 3.2755749
	speed: 0.2790s/iter; left time: 5632.3944s
Epoch: 3 cost time: 59.78550958633423
Epoch: 3, Steps: 208 | Train Loss: 2.516 Vali Loss: 4.466 Vali Acc: 0.086 Test Loss: 4.466 Test Acc: 0.086
Validation loss decreased (-0.084064 --> -0.086445).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1404591
	speed: 0.6420s/iter; left time: 12888.4746s
	iters: 200, epoch: 4 | loss: 1.6923231
	speed: 0.2832s/iter; left time: 5657.4734s
Epoch: 4 cost time: 58.26047897338867
Epoch: 4, Steps: 208 | Train Loss: 1.881 Vali Loss: 5.033 Vali Acc: 0.093 Test Loss: 5.033 Test Acc: 0.093
Validation loss decreased (-0.086445 --> -0.093299).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4717550
	speed: 0.6923s/iter; left time: 13754.4702s
	iters: 200, epoch: 5 | loss: 2.1563725
	speed: 0.3004s/iter; left time: 5938.3400s
Epoch: 5 cost time: 61.988511085510254
Epoch: 5, Steps: 208 | Train Loss: 1.360 Vali Loss: 5.643 Vali Acc: 0.086 Test Loss: 5.643 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1850234
	speed: 0.7111s/iter; left time: 13980.6816s
	iters: 200, epoch: 6 | loss: 1.4979619
	speed: 0.2914s/iter; left time: 5699.3121s
Epoch: 6 cost time: 62.786731243133545
Epoch: 6, Steps: 208 | Train Loss: 1.008 Vali Loss: 6.428 Vali Acc: 0.076 Test Loss: 6.428 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1821424
	speed: 0.6828s/iter; left time: 13281.9669s
	iters: 200, epoch: 7 | loss: 1.3509641
	speed: 0.2962s/iter; left time: 5733.1128s
Epoch: 7 cost time: 61.73140358924866
Epoch: 7, Steps: 208 | Train Loss: 0.775 Vali Loss: 7.417 Vali Acc: 0.092 Test Loss: 7.417 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2821567
	speed: 0.6712s/iter; left time: 12916.9627s
	iters: 200, epoch: 8 | loss: 0.7105547
	speed: 0.2886s/iter; left time: 5525.9019s
Epoch: 8 cost time: 59.92370581626892
Epoch: 8, Steps: 208 | Train Loss: 0.671 Vali Loss: 7.860 Vali Acc: 0.088 Test Loss: 7.860 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0060390
	speed: 0.7181s/iter; left time: 13669.7313s
	iters: 200, epoch: 9 | loss: 0.4947341
	speed: 0.3121s/iter; left time: 5911.0415s
Epoch: 9 cost time: 66.02088356018066
Epoch: 9, Steps: 208 | Train Loss: 0.518 Vali Loss: 9.092 Vali Acc: 0.089 Test Loss: 9.092 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4463038
	speed: 0.7385s/iter; left time: 13905.0214s
	iters: 200, epoch: 10 | loss: 0.4564163
	speed: 0.3115s/iter; left time: 5833.7615s
Epoch: 10 cost time: 65.16171669960022
Epoch: 10, Steps: 208 | Train Loss: 0.449 Vali Loss: 8.764 Vali Acc: 0.081 Test Loss: 8.764 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1387381
	speed: 0.6717s/iter; left time: 12506.9869s
	iters: 200, epoch: 11 | loss: 0.5443165
	speed: 0.2963s/iter; left time: 5488.0170s
Epoch: 11 cost time: 60.404982805252075
Epoch: 11, Steps: 208 | Train Loss: 0.384 Vali Loss: 9.389 Vali Acc: 0.082 Test Loss: 9.389 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0446476
	speed: 0.7010s/iter; left time: 12908.3731s
	iters: 200, epoch: 12 | loss: 0.0834216
	speed: 0.3039s/iter; left time: 5564.9750s
Epoch: 12 cost time: 64.01366782188416
Epoch: 12, Steps: 208 | Train Loss: 0.353 Vali Loss: 9.546 Vali Acc: 0.082 Test Loss: 9.546 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0285082
	speed: 0.7191s/iter; left time: 13090.8738s
	iters: 200, epoch: 13 | loss: 0.3763882
	speed: 0.2948s/iter; left time: 5338.1186s
Epoch: 13 cost time: 63.2323215007782
Epoch: 13, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.456 Vali Acc: 0.082 Test Loss: 10.456 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0708843
	speed: 0.6911s/iter; left time: 12437.2520s
	iters: 200, epoch: 14 | loss: 0.2067425
	speed: 0.3050s/iter; left time: 5459.4254s
Epoch: 14 cost time: 63.980045557022095
Epoch: 14, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.060 Vali Acc: 0.087 Test Loss: 10.060 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09334923948702654
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0645690
	speed: 0.3112s/iter; left time: 6441.3760s
	iters: 200, epoch: 1 | loss: 3.6880975
	speed: 0.3006s/iter; left time: 6193.3461s
Epoch: 1 cost time: 63.63762307167053
Epoch: 1, Steps: 208 | Train Loss: 3.773 Vali Loss: 3.692 Vali Acc: 0.075 Test Loss: 3.692 Test Acc: 0.075
Validation loss decreased (inf --> -0.074523).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6791246
	speed: 0.6693s/iter; left time: 13714.9646s
	iters: 200, epoch: 2 | loss: 3.5453725
	speed: 0.3011s/iter; left time: 6139.5510s
Epoch: 2 cost time: 62.181774377822876
Epoch: 2, Steps: 208 | Train Loss: 3.146 Vali Loss: 3.909 Vali Acc: 0.072 Test Loss: 3.909 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4684036
	speed: 0.6719s/iter; left time: 13630.2527s
	iters: 200, epoch: 3 | loss: 3.1657069
	speed: 0.2870s/iter; left time: 5794.0969s
Epoch: 3 cost time: 61.0368390083313
Epoch: 3, Steps: 208 | Train Loss: 2.488 Vali Loss: 4.553 Vali Acc: 0.088 Test Loss: 4.553 Test Acc: 0.088
Validation loss decreased (-0.074523 --> -0.087935).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9589884
	speed: 0.6829s/iter; left time: 13709.7208s
	iters: 200, epoch: 4 | loss: 1.5913434
	speed: 0.2838s/iter; left time: 5668.7899s
Epoch: 4 cost time: 59.242366313934326
Epoch: 4, Steps: 208 | Train Loss: 1.901 Vali Loss: 4.925 Vali Acc: 0.089 Test Loss: 4.925 Test Acc: 0.089
Validation loss decreased (-0.087935 --> -0.089125).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3439641
	speed: 0.7109s/iter; left time: 14124.8772s
	iters: 200, epoch: 5 | loss: 1.7448229
	speed: 0.2987s/iter; left time: 5904.9701s
Epoch: 5 cost time: 64.63195443153381
Epoch: 5, Steps: 208 | Train Loss: 1.381 Vali Loss: 5.764 Vali Acc: 0.081 Test Loss: 5.764 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9133222
	speed: 0.6759s/iter; left time: 13289.7182s
	iters: 200, epoch: 6 | loss: 2.5496328
	speed: 0.3136s/iter; left time: 6133.9573s
Epoch: 6 cost time: 64.31054949760437
Epoch: 6, Steps: 208 | Train Loss: 1.027 Vali Loss: 6.284 Vali Acc: 0.093 Test Loss: 6.284 Test Acc: 0.093
Validation loss decreased (-0.089125 --> -0.093286).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5785728
	speed: 0.6785s/iter; left time: 13199.1037s
	iters: 200, epoch: 7 | loss: 0.7110190
	speed: 0.2820s/iter; left time: 5458.0755s
Epoch: 7 cost time: 59.653098344802856
Epoch: 7, Steps: 208 | Train Loss: 0.754 Vali Loss: 7.455 Vali Acc: 0.085 Test Loss: 7.455 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0650350
	speed: 0.7128s/iter; left time: 13718.6234s
	iters: 200, epoch: 8 | loss: 0.7562376
	speed: 0.2768s/iter; left time: 5299.2072s
Epoch: 8 cost time: 60.63233828544617
Epoch: 8, Steps: 208 | Train Loss: 0.648 Vali Loss: 7.411 Vali Acc: 0.085 Test Loss: 7.411 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6238912
	speed: 0.6313s/iter; left time: 12017.6332s
	iters: 200, epoch: 9 | loss: 0.6678150
	speed: 0.3012s/iter; left time: 5704.1011s
Epoch: 9 cost time: 60.83259129524231
Epoch: 9, Steps: 208 | Train Loss: 0.556 Vali Loss: 8.398 Vali Acc: 0.089 Test Loss: 8.398 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8386176
	speed: 0.6331s/iter; left time: 11920.3244s
	iters: 200, epoch: 10 | loss: 0.9444298
	speed: 0.2980s/iter; left time: 5581.3647s
Epoch: 10 cost time: 60.286890745162964
Epoch: 10, Steps: 208 | Train Loss: 0.457 Vali Loss: 8.712 Vali Acc: 0.086 Test Loss: 8.712 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1210297
	speed: 0.7150s/iter; left time: 13314.2354s
	iters: 200, epoch: 11 | loss: 0.7082136
	speed: 0.2859s/iter; left time: 5295.6645s
Epoch: 11 cost time: 62.18009829521179
Epoch: 11, Steps: 208 | Train Loss: 0.359 Vali Loss: 9.271 Vali Acc: 0.096 Test Loss: 9.271 Test Acc: 0.096
Validation loss decreased (-0.093286 --> -0.095642).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1676739
	speed: 0.7021s/iter; left time: 12927.3461s
	iters: 200, epoch: 12 | loss: 0.6847158
	speed: 0.2796s/iter; left time: 5120.4313s
Epoch: 12 cost time: 60.65431785583496
Epoch: 12, Steps: 208 | Train Loss: 0.342 Vali Loss: 9.458 Vali Acc: 0.084 Test Loss: 9.458 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1397665
	speed: 0.6380s/iter; left time: 11614.7086s
	iters: 200, epoch: 13 | loss: 0.4381627
	speed: 0.2953s/iter; left time: 5346.0672s
Epoch: 13 cost time: 60.31147623062134
Epoch: 13, Steps: 208 | Train Loss: 0.319 Vali Loss: 10.037 Vali Acc: 0.085 Test Loss: 10.037 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0159100
	speed: 0.6675s/iter; left time: 12012.9112s
	iters: 200, epoch: 14 | loss: 0.1833318
	speed: 0.3013s/iter; left time: 5391.8845s
Epoch: 14 cost time: 61.52553129196167
Epoch: 14, Steps: 208 | Train Loss: 0.284 Vali Loss: 10.651 Vali Acc: 0.076 Test Loss: 10.651 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0155631
	speed: 0.7106s/iter; left time: 12641.6581s
	iters: 200, epoch: 15 | loss: 0.1634149
	speed: 0.2842s/iter; left time: 5027.2589s
Epoch: 15 cost time: 61.37166380882263
Epoch: 15, Steps: 208 | Train Loss: 0.239 Vali Loss: 10.882 Vali Acc: 0.087 Test Loss: 10.882 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0857540
	speed: 0.6780s/iter; left time: 11919.3833s
	iters: 200, epoch: 16 | loss: 0.4027959
	speed: 0.3053s/iter; left time: 5337.6118s
Epoch: 16 cost time: 62.72283172607422
Epoch: 16, Steps: 208 | Train Loss: 0.244 Vali Loss: 10.893 Vali Acc: 0.087 Test Loss: 10.893 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0983135
	speed: 0.6482s/iter; left time: 11261.6160s
	iters: 200, epoch: 17 | loss: 0.2203060
	speed: 0.3017s/iter; left time: 5211.4066s
Epoch: 17 cost time: 61.58879542350769
Epoch: 17, Steps: 208 | Train Loss: 0.202 Vali Loss: 11.656 Vali Acc: 0.082 Test Loss: 11.656 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2620849
	speed: 0.7098s/iter; left time: 12183.0883s
	iters: 200, epoch: 18 | loss: 0.0036200
	speed: 0.3119s/iter; left time: 5322.7295s
Epoch: 18 cost time: 64.88701796531677
Epoch: 18, Steps: 208 | Train Loss: 0.201 Vali Loss: 11.346 Vali Acc: 0.087 Test Loss: 11.346 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2752076
	speed: 0.6756s/iter; left time: 11456.5230s
	iters: 200, epoch: 19 | loss: 0.0293441
	speed: 0.2767s/iter; left time: 4664.3772s
Epoch: 19 cost time: 59.4041211605072
Epoch: 19, Steps: 208 | Train Loss: 0.203 Vali Loss: 12.090 Vali Acc: 0.079 Test Loss: 12.090 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0186648
	speed: 0.6288s/iter; left time: 10531.2295s
	iters: 200, epoch: 20 | loss: 0.2201934
	speed: 0.2852s/iter; left time: 4748.1420s
Epoch: 20 cost time: 58.79040503501892
Epoch: 20, Steps: 208 | Train Loss: 0.166 Vali Loss: 11.997 Vali Acc: 0.084 Test Loss: 11.997 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0248728
	speed: 0.6473s/iter; left time: 10707.1085s
	iters: 200, epoch: 21 | loss: 0.0031553
	speed: 0.2836s/iter; left time: 4663.4876s
Epoch: 21 cost time: 58.71703815460205
Epoch: 21, Steps: 208 | Train Loss: 0.192 Vali Loss: 11.925 Vali Acc: 0.087 Test Loss: 11.925 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09573516254100806
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0723672
	speed: 0.3174s/iter; left time: 6570.5044s
	iters: 200, epoch: 1 | loss: 3.5677717
	speed: 0.3041s/iter; left time: 6264.7424s
Epoch: 1 cost time: 64.72239947319031
Epoch: 1, Steps: 208 | Train Loss: 3.785 Vali Loss: 3.658 Vali Acc: 0.079 Test Loss: 3.658 Test Acc: 0.079
Validation loss decreased (inf --> -0.079295).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5703378
	speed: 0.6485s/iter; left time: 13290.5339s
	iters: 200, epoch: 2 | loss: 3.6325495
	speed: 0.2885s/iter; left time: 5883.9829s
Epoch: 2 cost time: 59.53026628494263
Epoch: 2, Steps: 208 | Train Loss: 3.150 Vali Loss: 3.951 Vali Acc: 0.075 Test Loss: 3.951 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3647082
	speed: 0.6505s/iter; left time: 13195.4614s
	iters: 200, epoch: 3 | loss: 2.8243377
	speed: 0.2975s/iter; left time: 6004.6775s
Epoch: 3 cost time: 60.841872453689575
Epoch: 3, Steps: 208 | Train Loss: 2.508 Vali Loss: 4.570 Vali Acc: 0.088 Test Loss: 4.570 Test Acc: 0.088
Validation loss decreased (-0.079295 --> -0.087637).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8468969
	speed: 0.6659s/iter; left time: 13369.9647s
	iters: 200, epoch: 4 | loss: 1.2771516
	speed: 0.2844s/iter; left time: 5681.8019s
Epoch: 4 cost time: 59.781485080718994
Epoch: 4, Steps: 208 | Train Loss: 1.909 Vali Loss: 5.084 Vali Acc: 0.089 Test Loss: 5.084 Test Acc: 0.089
Validation loss decreased (-0.087637 --> -0.088527).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2572709
	speed: 0.6531s/iter; left time: 12976.2728s
	iters: 200, epoch: 5 | loss: 1.7221240
	speed: 0.2841s/iter; left time: 5615.9558s
Epoch: 5 cost time: 58.17639470100403
Epoch: 5, Steps: 208 | Train Loss: 1.378 Vali Loss: 5.620 Vali Acc: 0.082 Test Loss: 5.620 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9341346
	speed: 0.6784s/iter; left time: 13337.7411s
	iters: 200, epoch: 6 | loss: 1.6417187
	speed: 0.2870s/iter; left time: 5613.6162s
Epoch: 6 cost time: 59.75640034675598
Epoch: 6, Steps: 208 | Train Loss: 1.011 Vali Loss: 6.420 Vali Acc: 0.086 Test Loss: 6.420 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6201469
	speed: 0.6629s/iter; left time: 12896.2877s
	iters: 200, epoch: 7 | loss: 0.3190486
	speed: 0.2761s/iter; left time: 5342.5289s
Epoch: 7 cost time: 57.67666506767273
Epoch: 7, Steps: 208 | Train Loss: 0.797 Vali Loss: 7.116 Vali Acc: 0.080 Test Loss: 7.116 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4618686
	speed: 0.6604s/iter; left time: 12709.7511s
	iters: 200, epoch: 8 | loss: 0.7418948
	speed: 0.2791s/iter; left time: 5344.0112s
Epoch: 8 cost time: 58.310717821121216
Epoch: 8, Steps: 208 | Train Loss: 0.669 Vali Loss: 7.586 Vali Acc: 0.091 Test Loss: 7.586 Test Acc: 0.091
Validation loss decreased (-0.088527 --> -0.091186).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5724147
	speed: 0.6595s/iter; left time: 12554.8424s
	iters: 200, epoch: 9 | loss: 1.0034741
	speed: 0.2688s/iter; left time: 5090.3154s
Epoch: 9 cost time: 57.07398438453674
Epoch: 9, Steps: 208 | Train Loss: 0.543 Vali Loss: 8.543 Vali Acc: 0.087 Test Loss: 8.543 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2992689
	speed: 0.6550s/iter; left time: 12333.6818s
	iters: 200, epoch: 10 | loss: 0.8216265
	speed: 0.2783s/iter; left time: 5212.9940s
Epoch: 10 cost time: 59.41916489601135
Epoch: 10, Steps: 208 | Train Loss: 0.469 Vali Loss: 8.698 Vali Acc: 0.077 Test Loss: 8.698 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8447741
	speed: 0.6725s/iter; left time: 12522.3962s
	iters: 200, epoch: 11 | loss: 0.1871893
	speed: 0.2779s/iter; left time: 5147.5076s
Epoch: 11 cost time: 59.22954177856445
Epoch: 11, Steps: 208 | Train Loss: 0.398 Vali Loss: 8.759 Vali Acc: 0.084 Test Loss: 8.759 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2832900
	speed: 0.6588s/iter; left time: 12131.1927s
	iters: 200, epoch: 12 | loss: 0.0187781
	speed: 0.2759s/iter; left time: 5053.2982s
Epoch: 12 cost time: 59.048521995544434
Epoch: 12, Steps: 208 | Train Loss: 0.327 Vali Loss: 9.628 Vali Acc: 0.078 Test Loss: 9.628 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0313089
	speed: 0.6427s/iter; left time: 11700.9844s
	iters: 200, epoch: 13 | loss: 0.1626745
	speed: 0.2827s/iter; left time: 5117.5473s
Epoch: 13 cost time: 59.12431049346924
Epoch: 13, Steps: 208 | Train Loss: 0.285 Vali Loss: 10.255 Vali Acc: 0.085 Test Loss: 10.255 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0275437
	speed: 0.6351s/iter; left time: 11429.3641s
	iters: 200, epoch: 14 | loss: 0.0818460
	speed: 0.2835s/iter; left time: 5073.2610s
Epoch: 14 cost time: 58.68985438346863
Epoch: 14, Steps: 208 | Train Loss: 0.249 Vali Loss: 10.323 Vali Acc: 0.081 Test Loss: 10.323 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6869919
	speed: 0.6603s/iter; left time: 11746.5380s
	iters: 200, epoch: 15 | loss: 0.2936516
	speed: 0.2812s/iter; left time: 4974.5899s
Epoch: 15 cost time: 58.58717393875122
Epoch: 15, Steps: 208 | Train Loss: 0.237 Vali Loss: 11.312 Vali Acc: 0.086 Test Loss: 11.312 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0683766
	speed: 0.6321s/iter; left time: 11112.7117s
	iters: 200, epoch: 16 | loss: 0.3681475
	speed: 0.2802s/iter; left time: 4898.5649s
Epoch: 16 cost time: 57.23804807662964
Epoch: 16, Steps: 208 | Train Loss: 0.281 Vali Loss: 11.155 Vali Acc: 0.079 Test Loss: 11.155 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0087845
	speed: 0.6470s/iter; left time: 11240.9497s
	iters: 200, epoch: 17 | loss: 0.6141465
	speed: 0.2745s/iter; left time: 4740.6269s
Epoch: 17 cost time: 57.344839334487915
Epoch: 17, Steps: 208 | Train Loss: 0.259 Vali Loss: 11.177 Vali Acc: 0.085 Test Loss: 11.177 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0165195
	speed: 0.6738s/iter; left time: 11565.0814s
	iters: 200, epoch: 18 | loss: 0.2421810
	speed: 0.2921s/iter; left time: 4984.7245s
Epoch: 18 cost time: 61.015347957611084
Epoch: 18, Steps: 208 | Train Loss: 0.221 Vali Loss: 11.444 Vali Acc: 0.081 Test Loss: 11.444 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09126155681479273
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0820727
	speed: 0.2916s/iter; left time: 6035.8680s
	iters: 200, epoch: 1 | loss: 3.6864345
	speed: 0.2845s/iter; left time: 5861.1374s
Epoch: 1 cost time: 60.068862199783325
Epoch: 1, Steps: 208 | Train Loss: 3.780 Vali Loss: 3.657 Vali Acc: 0.077 Test Loss: 3.657 Test Acc: 0.077
Validation loss decreased (inf --> -0.076611).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6359954
	speed: 0.6574s/iter; left time: 13471.8807s
	iters: 200, epoch: 2 | loss: 3.3911028
	speed: 0.2686s/iter; left time: 5476.5702s
Epoch: 2 cost time: 56.92255663871765
Epoch: 2, Steps: 208 | Train Loss: 3.140 Vali Loss: 3.822 Vali Acc: 0.105 Test Loss: 3.822 Test Acc: 0.105
Validation loss decreased (-0.076611 --> -0.104644).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5236940
	speed: 0.6671s/iter; left time: 13532.3602s
	iters: 200, epoch: 3 | loss: 3.3916869
	speed: 0.2825s/iter; left time: 5701.7251s
Epoch: 3 cost time: 59.35204076766968
Epoch: 3, Steps: 208 | Train Loss: 2.487 Vali Loss: 4.425 Vali Acc: 0.090 Test Loss: 4.425 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8972079
	speed: 0.6793s/iter; left time: 13637.3480s
	iters: 200, epoch: 4 | loss: 1.6398743
	speed: 0.2812s/iter; left time: 5618.2683s
Epoch: 4 cost time: 58.852494955062866
Epoch: 4, Steps: 208 | Train Loss: 1.871 Vali Loss: 4.937 Vali Acc: 0.093 Test Loss: 4.937 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4612614
	speed: 0.6642s/iter; left time: 13196.2307s
	iters: 200, epoch: 5 | loss: 1.7023066
	speed: 0.2726s/iter; left time: 5389.6039s
Epoch: 5 cost time: 57.42236518859863
Epoch: 5, Steps: 208 | Train Loss: 1.373 Vali Loss: 5.953 Vali Acc: 0.089 Test Loss: 5.953 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4918649
	speed: 0.6484s/iter; left time: 12748.3350s
	iters: 200, epoch: 6 | loss: 1.2752317
	speed: 0.2616s/iter; left time: 5117.9120s
Epoch: 6 cost time: 55.837910652160645
Epoch: 6, Steps: 208 | Train Loss: 1.011 Vali Loss: 6.654 Vali Acc: 0.088 Test Loss: 6.654 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.8963959
	speed: 0.6773s/iter; left time: 13174.6192s
	iters: 200, epoch: 7 | loss: 0.6461161
	speed: 0.2816s/iter; left time: 5450.6605s
Epoch: 7 cost time: 59.702611684799194
Epoch: 7, Steps: 208 | Train Loss: 0.806 Vali Loss: 7.209 Vali Acc: 0.091 Test Loss: 7.209 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1467552
	speed: 0.6852s/iter; left time: 13186.8296s
	iters: 200, epoch: 8 | loss: 0.5734457
	speed: 0.2714s/iter; left time: 5195.7815s
Epoch: 8 cost time: 58.45489263534546
Epoch: 8, Steps: 208 | Train Loss: 0.697 Vali Loss: 7.755 Vali Acc: 0.088 Test Loss: 7.755 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8868108
	speed: 0.6320s/iter; left time: 12031.5861s
	iters: 200, epoch: 9 | loss: 0.5382390
	speed: 0.2831s/iter; left time: 5361.9571s
Epoch: 9 cost time: 58.30074501037598
Epoch: 9, Steps: 208 | Train Loss: 0.543 Vali Loss: 8.849 Vali Acc: 0.087 Test Loss: 8.849 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.8878919
	speed: 0.6690s/iter; left time: 12596.2020s
	iters: 200, epoch: 10 | loss: 0.5798714
	speed: 0.2882s/iter; left time: 5397.1822s
Epoch: 10 cost time: 60.96938109397888
Epoch: 10, Steps: 208 | Train Loss: 0.501 Vali Loss: 8.953 Vali Acc: 0.091 Test Loss: 8.953 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.4057482
	speed: 0.6688s/iter; left time: 12453.8104s
	iters: 200, epoch: 11 | loss: 0.1428347
	speed: 0.2900s/iter; left time: 5370.4275s
Epoch: 11 cost time: 59.97377634048462
Epoch: 11, Steps: 208 | Train Loss: 0.443 Vali Loss: 8.869 Vali Acc: 0.080 Test Loss: 8.869 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0518845
	speed: 0.6534s/iter; left time: 12031.4918s
	iters: 200, epoch: 12 | loss: 0.4017915
	speed: 0.2813s/iter; left time: 5151.8577s
Epoch: 12 cost time: 58.145646810531616
Epoch: 12, Steps: 208 | Train Loss: 0.386 Vali Loss: 9.241 Vali Acc: 0.084 Test Loss: 9.241 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10468237399343872
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1490440
	speed: 0.2872s/iter; left time: 5946.2543s
	iters: 200, epoch: 1 | loss: 3.6986241
	speed: 0.3030s/iter; left time: 6241.6291s
Epoch: 1 cost time: 61.8248815536499
Epoch: 1, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.908 Vali Acc: 0.068 Test Loss: 3.908 Test Acc: 0.068
Validation loss decreased (inf --> -0.068258).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1801889
	speed: 0.6906s/iter; left time: 14153.1181s
	iters: 200, epoch: 2 | loss: 3.7015975
	speed: 0.2838s/iter; left time: 5786.5904s
Epoch: 2 cost time: 60.95100736618042
Epoch: 2, Steps: 208 | Train Loss: 3.165 Vali Loss: 4.361 Vali Acc: 0.078 Test Loss: 4.361 Test Acc: 0.078
Validation loss decreased (-0.068258 --> -0.078095).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7646985
	speed: 0.6959s/iter; left time: 14116.6232s
	iters: 200, epoch: 3 | loss: 2.8218634
	speed: 0.3064s/iter; left time: 6183.8999s
Epoch: 3 cost time: 64.25622820854187
Epoch: 3, Steps: 208 | Train Loss: 2.561 Vali Loss: 4.925 Vali Acc: 0.075 Test Loss: 4.925 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2673500
	speed: 0.6859s/iter; left time: 13771.3622s
	iters: 200, epoch: 4 | loss: 2.1230128
	speed: 0.3066s/iter; left time: 6124.9236s
Epoch: 4 cost time: 62.85326838493347
Epoch: 4, Steps: 208 | Train Loss: 1.974 Vali Loss: 4.978 Vali Acc: 0.083 Test Loss: 4.978 Test Acc: 0.083
Validation loss decreased (-0.078095 --> -0.082861).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6195464
	speed: 0.6889s/iter; left time: 13688.5104s
	iters: 200, epoch: 5 | loss: 1.4297966
	speed: 0.2818s/iter; left time: 5571.3125s
Epoch: 5 cost time: 61.67676281929016
Epoch: 5, Steps: 208 | Train Loss: 1.451 Vali Loss: 5.672 Vali Acc: 0.090 Test Loss: 5.672 Test Acc: 0.090
Validation loss decreased (-0.082861 --> -0.089714).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6883424
	speed: 0.6737s/iter; left time: 13244.9349s
	iters: 200, epoch: 6 | loss: 1.5277275
	speed: 0.2772s/iter; left time: 5422.3584s
Epoch: 6 cost time: 58.811124086380005
Epoch: 6, Steps: 208 | Train Loss: 1.088 Vali Loss: 6.275 Vali Acc: 0.082 Test Loss: 6.275 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7099019
	speed: 0.6913s/iter; left time: 13448.3800s
	iters: 200, epoch: 7 | loss: 1.8200357
	speed: 0.3129s/iter; left time: 6055.4198s
Epoch: 7 cost time: 63.92651867866516
Epoch: 7, Steps: 208 | Train Loss: 0.879 Vali Loss: 6.771 Vali Acc: 0.092 Test Loss: 6.771 Test Acc: 0.092
Validation loss decreased (-0.089714 --> -0.091492).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8944639
	speed: 0.6910s/iter; left time: 13297.7578s
	iters: 200, epoch: 8 | loss: 1.6879565
	speed: 0.2916s/iter; left time: 5583.0701s
Epoch: 8 cost time: 63.24804162979126
Epoch: 8, Steps: 208 | Train Loss: 0.756 Vali Loss: 7.328 Vali Acc: 0.092 Test Loss: 7.328 Test Acc: 0.092
Validation loss decreased (-0.091492 --> -0.092083).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0209380
	speed: 0.6971s/iter; left time: 13270.4892s
	iters: 200, epoch: 9 | loss: 0.4505117
	speed: 0.2908s/iter; left time: 5506.8591s
Epoch: 9 cost time: 60.18550682067871
Epoch: 9, Steps: 208 | Train Loss: 0.637 Vali Loss: 7.941 Vali Acc: 0.090 Test Loss: 7.941 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9302767
	speed: 0.6834s/iter; left time: 12867.5799s
	iters: 200, epoch: 10 | loss: 1.2525122
	speed: 0.3129s/iter; left time: 5859.9620s
Epoch: 10 cost time: 62.97518229484558
Epoch: 10, Steps: 208 | Train Loss: 0.556 Vali Loss: 8.477 Vali Acc: 0.080 Test Loss: 8.477 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5826825
	speed: 0.6986s/iter; left time: 13008.5200s
	iters: 200, epoch: 11 | loss: 0.4780710
	speed: 0.2934s/iter; left time: 5434.2627s
Epoch: 11 cost time: 62.65629768371582
Epoch: 11, Steps: 208 | Train Loss: 0.479 Vali Loss: 8.553 Vali Acc: 0.093 Test Loss: 8.553 Test Acc: 0.093
Validation loss decreased (-0.092083 --> -0.093264).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2334905
	speed: 0.6940s/iter; left time: 12779.5040s
	iters: 200, epoch: 12 | loss: 0.3039504
	speed: 0.2987s/iter; left time: 5469.7718s
Epoch: 12 cost time: 62.34230852127075
Epoch: 12, Steps: 208 | Train Loss: 0.406 Vali Loss: 8.988 Vali Acc: 0.082 Test Loss: 8.988 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1016438
	speed: 0.7044s/iter; left time: 12823.2691s
	iters: 200, epoch: 13 | loss: 0.8773626
	speed: 0.3181s/iter; left time: 5759.8574s
Epoch: 13 cost time: 63.600818157196045
Epoch: 13, Steps: 208 | Train Loss: 0.395 Vali Loss: 9.384 Vali Acc: 0.086 Test Loss: 9.384 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4935307
	speed: 0.7016s/iter; left time: 12626.5269s
	iters: 200, epoch: 14 | loss: 1.0662888
	speed: 0.2906s/iter; left time: 5201.1484s
Epoch: 14 cost time: 63.53220796585083
Epoch: 14, Steps: 208 | Train Loss: 0.329 Vali Loss: 9.902 Vali Acc: 0.078 Test Loss: 9.902 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1858422
	speed: 0.6920s/iter; left time: 12309.5565s
	iters: 200, epoch: 15 | loss: 0.3451695
	speed: 0.2845s/iter; left time: 5033.0577s
Epoch: 15 cost time: 61.14903688430786
Epoch: 15, Steps: 208 | Train Loss: 0.293 Vali Loss: 9.705 Vali Acc: 0.086 Test Loss: 9.705 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1727592
	speed: 0.6744s/iter; left time: 11857.3198s
	iters: 200, epoch: 16 | loss: 0.4181911
	speed: 0.3146s/iter; left time: 5499.2124s
Epoch: 16 cost time: 61.623685121536255
Epoch: 16, Steps: 208 | Train Loss: 0.291 Vali Loss: 10.007 Vali Acc: 0.081 Test Loss: 10.007 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1083411
	speed: 0.7148s/iter; left time: 12418.1210s
	iters: 200, epoch: 17 | loss: 0.2464913
	speed: 0.3141s/iter; left time: 5426.1157s
Epoch: 17 cost time: 66.93030738830566
Epoch: 17, Steps: 208 | Train Loss: 0.268 Vali Loss: 10.127 Vali Acc: 0.078 Test Loss: 10.127 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3612532
	speed: 0.7289s/iter; left time: 12511.1860s
	iters: 200, epoch: 18 | loss: 0.4563190
	speed: 0.2961s/iter; left time: 5052.1409s
Epoch: 18 cost time: 62.540050745010376
Epoch: 18, Steps: 208 | Train Loss: 0.273 Vali Loss: 10.664 Vali Acc: 0.077 Test Loss: 10.664 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2125240
	speed: 0.6969s/iter; left time: 11817.7112s
	iters: 200, epoch: 19 | loss: 0.3436254
	speed: 0.3004s/iter; left time: 5063.3794s
Epoch: 19 cost time: 61.865439891815186
Epoch: 19, Steps: 208 | Train Loss: 0.235 Vali Loss: 10.277 Vali Acc: 0.088 Test Loss: 10.277 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1959153
	speed: 0.6798s/iter; left time: 11385.3045s
	iters: 200, epoch: 20 | loss: 0.1051089
	speed: 0.3158s/iter; left time: 5257.4696s
Epoch: 20 cost time: 65.51427888870239
Epoch: 20, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.257 Vali Acc: 0.085 Test Loss: 11.257 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0573490
	speed: 0.6962s/iter; left time: 11516.2506s
	iters: 200, epoch: 21 | loss: 0.0993255
	speed: 0.3045s/iter; left time: 5005.9710s
Epoch: 21 cost time: 62.304136753082275
Epoch: 21, Steps: 208 | Train Loss: 0.194 Vali Loss: 11.025 Vali Acc: 0.075 Test Loss: 11.025 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09334923948702654
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8997369
	speed: 0.3278s/iter; left time: 6785.1364s
	iters: 200, epoch: 1 | loss: 3.6633556
	speed: 0.3026s/iter; left time: 6233.3843s
Epoch: 1 cost time: 65.65047216415405
Epoch: 1, Steps: 208 | Train Loss: 3.682 Vali Loss: 4.148 Vali Acc: 0.072 Test Loss: 4.148 Test Acc: 0.072
Validation loss decreased (inf --> -0.072431).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2380090
	speed: 0.7134s/iter; left time: 14619.5802s
	iters: 200, epoch: 2 | loss: 3.8090050
	speed: 0.2908s/iter; left time: 5930.4201s
Epoch: 2 cost time: 62.17978310585022
Epoch: 2, Steps: 208 | Train Loss: 3.187 Vali Loss: 4.963 Vali Acc: 0.067 Test Loss: 4.963 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2363710
	speed: 0.6984s/iter; left time: 14168.0037s
	iters: 200, epoch: 3 | loss: 3.1385717
	speed: 0.3056s/iter; left time: 6168.9594s
Epoch: 3 cost time: 63.871655225753784
Epoch: 3, Steps: 208 | Train Loss: 2.674 Vali Loss: 5.016 Vali Acc: 0.087 Test Loss: 5.016 Test Acc: 0.087
Validation loss decreased (-0.072431 --> -0.087334).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9534401
	speed: 0.7034s/iter; left time: 14122.5272s
	iters: 200, epoch: 4 | loss: 2.3484409
	speed: 0.3044s/iter; left time: 6081.2197s
Epoch: 4 cost time: 61.85193943977356
Epoch: 4, Steps: 208 | Train Loss: 2.155 Vali Loss: 5.163 Vali Acc: 0.092 Test Loss: 5.163 Test Acc: 0.092
Validation loss decreased (-0.087334 --> -0.091806).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7491333
	speed: 0.7160s/iter; left time: 14226.1899s
	iters: 200, epoch: 5 | loss: 1.4769987
	speed: 0.3012s/iter; left time: 5954.6718s
Epoch: 5 cost time: 63.60727095603943
Epoch: 5, Steps: 208 | Train Loss: 1.733 Vali Loss: 5.409 Vali Acc: 0.091 Test Loss: 5.409 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8203053
	speed: 0.7005s/iter; left time: 13771.6955s
	iters: 200, epoch: 6 | loss: 1.6664625
	speed: 0.3040s/iter; left time: 5946.5133s
Epoch: 6 cost time: 63.16753697395325
Epoch: 6, Steps: 208 | Train Loss: 1.385 Vali Loss: 5.967 Vali Acc: 0.091 Test Loss: 5.967 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0543005
	speed: 0.7075s/iter; left time: 13763.0577s
	iters: 200, epoch: 7 | loss: 1.2091842
	speed: 0.3010s/iter; left time: 5825.4890s
Epoch: 7 cost time: 62.20959234237671
Epoch: 7, Steps: 208 | Train Loss: 1.106 Vali Loss: 6.365 Vali Acc: 0.093 Test Loss: 6.365 Test Acc: 0.093
Validation loss decreased (-0.091806 --> -0.093286).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9816197
	speed: 0.7085s/iter; left time: 13635.9132s
	iters: 200, epoch: 8 | loss: 0.5004765
	speed: 0.3013s/iter; left time: 5768.5356s
Epoch: 8 cost time: 63.00894236564636
Epoch: 8, Steps: 208 | Train Loss: 0.962 Vali Loss: 6.919 Vali Acc: 0.093 Test Loss: 6.919 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2757039
	speed: 0.6832s/iter; left time: 13006.4406s
	iters: 200, epoch: 9 | loss: 1.0049000
	speed: 0.3117s/iter; left time: 5901.7581s
Epoch: 9 cost time: 64.6402657032013
Epoch: 9, Steps: 208 | Train Loss: 0.833 Vali Loss: 7.327 Vali Acc: 0.095 Test Loss: 7.327 Test Acc: 0.095
Validation loss decreased (-0.093286 --> -0.094767).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6150855
	speed: 0.7320s/iter; left time: 13782.3346s
	iters: 200, epoch: 10 | loss: 0.8418549
	speed: 0.3079s/iter; left time: 5766.4746s
Epoch: 10 cost time: 64.59727931022644
Epoch: 10, Steps: 208 | Train Loss: 0.714 Vali Loss: 7.398 Vali Acc: 0.092 Test Loss: 7.398 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4316081
	speed: 0.7211s/iter; left time: 13427.4207s
	iters: 200, epoch: 11 | loss: 0.9567963
	speed: 0.3028s/iter; left time: 5609.0560s
Epoch: 11 cost time: 63.753807067871094
Epoch: 11, Steps: 208 | Train Loss: 0.626 Vali Loss: 7.599 Vali Acc: 0.093 Test Loss: 7.599 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4740849
	speed: 0.6915s/iter; left time: 12732.3450s
	iters: 200, epoch: 12 | loss: 0.1957815
	speed: 0.2943s/iter; left time: 5390.1540s
Epoch: 12 cost time: 61.033979654312134
Epoch: 12, Steps: 208 | Train Loss: 0.537 Vali Loss: 8.551 Vali Acc: 0.089 Test Loss: 8.551 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1588866
	speed: 0.6794s/iter; left time: 12368.8377s
	iters: 200, epoch: 13 | loss: 0.8551095
	speed: 0.3014s/iter; left time: 5456.0396s
Epoch: 13 cost time: 62.37171149253845
Epoch: 13, Steps: 208 | Train Loss: 0.477 Vali Loss: 9.043 Vali Acc: 0.092 Test Loss: 9.043 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3676583
	speed: 0.7447s/iter; left time: 13402.9622s
	iters: 200, epoch: 14 | loss: 1.0604267
	speed: 0.3128s/iter; left time: 5598.1137s
Epoch: 14 cost time: 65.39658689498901
Epoch: 14, Steps: 208 | Train Loss: 0.430 Vali Loss: 9.102 Vali Acc: 0.092 Test Loss: 9.102 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0629995
	speed: 0.7094s/iter; left time: 12619.3248s
	iters: 200, epoch: 15 | loss: 0.7050546
	speed: 0.2991s/iter; left time: 5290.5774s
Epoch: 15 cost time: 62.69015192985535
Epoch: 15, Steps: 208 | Train Loss: 0.432 Vali Loss: 8.703 Vali Acc: 0.101 Test Loss: 8.703 Test Acc: 0.101
Validation loss decreased (-0.094767 --> -0.101016).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0805869
	speed: 0.6954s/iter; left time: 12226.0084s
	iters: 200, epoch: 16 | loss: 0.1957301
	speed: 0.2910s/iter; left time: 5086.9807s
Epoch: 16 cost time: 60.72140574455261
Epoch: 16, Steps: 208 | Train Loss: 0.335 Vali Loss: 9.759 Vali Acc: 0.094 Test Loss: 9.759 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0094964
	speed: 0.7203s/iter; left time: 12514.0216s
	iters: 200, epoch: 17 | loss: 0.2112276
	speed: 0.3152s/iter; left time: 5444.7440s
Epoch: 17 cost time: 66.59197163581848
Epoch: 17, Steps: 208 | Train Loss: 0.335 Vali Loss: 9.731 Vali Acc: 0.087 Test Loss: 9.731 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0461020
	speed: 0.7562s/iter; left time: 12979.7037s
	iters: 200, epoch: 18 | loss: 0.3663765
	speed: 0.3046s/iter; left time: 5197.7758s
Epoch: 18 cost time: 65.1705207824707
Epoch: 18, Steps: 208 | Train Loss: 0.273 Vali Loss: 9.727 Vali Acc: 0.095 Test Loss: 9.727 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6581550
	speed: 0.7059s/iter; left time: 11970.0221s
	iters: 200, epoch: 19 | loss: 0.2060446
	speed: 0.2917s/iter; left time: 4916.9498s
Epoch: 19 cost time: 61.57739472389221
Epoch: 19, Steps: 208 | Train Loss: 0.281 Vali Loss: 10.695 Vali Acc: 0.088 Test Loss: 10.695 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0020888
	speed: 0.6981s/iter; left time: 11691.8331s
	iters: 200, epoch: 20 | loss: 0.0402788
	speed: 0.3107s/iter; left time: 5173.2377s
Epoch: 20 cost time: 64.92257142066956
Epoch: 20, Steps: 208 | Train Loss: 0.253 Vali Loss: 10.314 Vali Acc: 0.095 Test Loss: 10.314 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0704681
	speed: 0.7243s/iter; left time: 11981.0184s
	iters: 200, epoch: 21 | loss: 0.3595708
	speed: 0.3023s/iter; left time: 4969.3091s
Epoch: 21 cost time: 63.88763380050659
Epoch: 21, Steps: 208 | Train Loss: 0.234 Vali Loss: 10.467 Vali Acc: 0.102 Test Loss: 10.467 Test Acc: 0.102
Validation loss decreased (-0.101016 --> -0.102192).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3007422
	speed: 0.7173s/iter; left time: 11715.2343s
	iters: 200, epoch: 22 | loss: 0.0271245
	speed: 0.2983s/iter; left time: 4841.7077s
Epoch: 22 cost time: 62.960166692733765
Epoch: 22, Steps: 208 | Train Loss: 0.206 Vali Loss: 10.653 Vali Acc: 0.094 Test Loss: 10.653 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.5267443
	speed: 0.7047s/iter; left time: 11362.8444s
	iters: 200, epoch: 23 | loss: 0.3157307
	speed: 0.2948s/iter; left time: 4724.3295s
Epoch: 23 cost time: 62.06773352622986
Epoch: 23, Steps: 208 | Train Loss: 0.211 Vali Loss: 10.946 Vali Acc: 0.097 Test Loss: 10.946 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2146515
	speed: 0.7208s/iter; left time: 11473.2975s
	iters: 200, epoch: 24 | loss: 0.0773274
	speed: 0.3087s/iter; left time: 4882.3790s
Epoch: 24 cost time: 63.96065592765808
Epoch: 24, Steps: 208 | Train Loss: 0.192 Vali Loss: 11.272 Vali Acc: 0.092 Test Loss: 11.272 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0221454
	speed: 0.7422s/iter; left time: 11659.2393s
	iters: 200, epoch: 25 | loss: 0.0719741
	speed: 0.3047s/iter; left time: 4755.4265s
Epoch: 25 cost time: 65.28707122802734
Epoch: 25, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.104 Vali Acc: 0.095 Test Loss: 11.104 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0076788
	speed: 0.7065s/iter; left time: 10951.6822s
	iters: 200, epoch: 26 | loss: 0.0051498
	speed: 0.2840s/iter; left time: 4374.5400s
Epoch: 26 cost time: 61.289817333221436
Epoch: 26, Steps: 208 | Train Loss: 0.163 Vali Loss: 11.587 Vali Acc: 0.096 Test Loss: 11.587 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2584142
	speed: 0.7029s/iter; left time: 10748.9229s
	iters: 200, epoch: 27 | loss: 0.1686864
	speed: 0.2905s/iter; left time: 4414.1203s
Epoch: 27 cost time: 61.40384650230408
Epoch: 27, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.368 Vali Acc: 0.092 Test Loss: 11.368 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0029083
	speed: 0.7298s/iter; left time: 11008.7510s
	iters: 200, epoch: 28 | loss: 0.0205103
	speed: 0.3211s/iter; left time: 4812.1288s
Epoch: 28 cost time: 66.40222191810608
Epoch: 28, Steps: 208 | Train Loss: 0.175 Vali Loss: 11.167 Vali Acc: 0.096 Test Loss: 11.167 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.6165699
	speed: 0.6867s/iter; left time: 10215.9039s
	iters: 200, epoch: 29 | loss: 0.0408871
	speed: 0.2775s/iter; left time: 4101.0007s
Epoch: 29 cost time: 58.80871772766113
Epoch: 29, Steps: 208 | Train Loss: 0.150 Vali Loss: 12.080 Vali Acc: 0.093 Test Loss: 12.080 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0084390
	speed: 0.6904s/iter; left time: 10127.7509s
	iters: 200, epoch: 30 | loss: 0.2974161
	speed: 0.2916s/iter; left time: 4248.5604s
Epoch: 30 cost time: 61.986432790756226
Epoch: 30, Steps: 208 | Train Loss: 0.132 Vali Loss: 12.048 Vali Acc: 0.089 Test Loss: 12.048 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.2689928
	speed: 0.6951s/iter; left time: 10051.9187s
	iters: 200, epoch: 31 | loss: 0.0084416
	speed: 0.3008s/iter; left time: 4320.0383s
Epoch: 31 cost time: 63.53996825218201
Epoch: 31, Steps: 208 | Train Loss: 0.141 Vali Loss: 11.541 Vali Acc: 0.097 Test Loss: 11.541 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1022964509394572
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7995002
	speed: 0.2866s/iter; left time: 5933.8016s
	iters: 200, epoch: 1 | loss: 3.6285629
	speed: 0.2740s/iter; left time: 5643.8289s
Epoch: 1 cost time: 58.47602081298828
Epoch: 1, Steps: 208 | Train Loss: 3.679 Vali Loss: 4.142 Vali Acc: 0.051 Test Loss: 4.142 Test Acc: 0.051
Validation loss decreased (inf --> -0.051256).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3888333
	speed: 0.6641s/iter; left time: 13610.3445s
	iters: 200, epoch: 2 | loss: 3.8104489
	speed: 0.2862s/iter; left time: 5835.8715s
Epoch: 2 cost time: 59.83534026145935
Epoch: 2, Steps: 208 | Train Loss: 3.236 Vali Loss: 4.773 Vali Acc: 0.058 Test Loss: 4.773 Test Acc: 0.058
Validation loss decreased (-0.051256 --> -0.057811).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0037086
	speed: 0.6631s/iter; left time: 13451.9962s
	iters: 200, epoch: 3 | loss: 3.4699702
	speed: 0.2790s/iter; left time: 5630.6450s
Epoch: 3 cost time: 58.29990530014038
Epoch: 3, Steps: 208 | Train Loss: 2.848 Vali Loss: 4.983 Vali Acc: 0.075 Test Loss: 4.983 Test Acc: 0.075
Validation loss decreased (-0.057811 --> -0.075405).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3643775
	speed: 0.6827s/iter; left time: 13707.0607s
	iters: 200, epoch: 4 | loss: 2.5035443
	speed: 0.2785s/iter; left time: 5564.1786s
Epoch: 4 cost time: 58.998350381851196
Epoch: 4, Steps: 208 | Train Loss: 2.454 Vali Loss: 5.190 Vali Acc: 0.083 Test Loss: 5.190 Test Acc: 0.083
Validation loss decreased (-0.075405 --> -0.083157).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9708855
	speed: 0.6612s/iter; left time: 13138.1703s
	iters: 200, epoch: 5 | loss: 1.5360602
	speed: 0.2831s/iter; left time: 5595.9036s
Epoch: 5 cost time: 58.43854260444641
Epoch: 5, Steps: 208 | Train Loss: 2.030 Vali Loss: 5.710 Vali Acc: 0.083 Test Loss: 5.710 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7157569
	speed: 0.6470s/iter; left time: 12720.3056s
	iters: 200, epoch: 6 | loss: 2.6103528
	speed: 0.2719s/iter; left time: 5318.5692s
Epoch: 6 cost time: 56.70399594306946
Epoch: 6, Steps: 208 | Train Loss: 1.659 Vali Loss: 5.766 Vali Acc: 0.075 Test Loss: 5.766 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0787107
	speed: 0.6884s/iter; left time: 13391.5884s
	iters: 200, epoch: 7 | loss: 2.3946643
	speed: 0.3071s/iter; left time: 5943.1234s
Epoch: 7 cost time: 63.911555767059326
Epoch: 7, Steps: 208 | Train Loss: 1.368 Vali Loss: 6.469 Vali Acc: 0.069 Test Loss: 6.469 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5088043
	speed: 0.7118s/iter; left time: 13697.7004s
	iters: 200, epoch: 8 | loss: 0.9363107
	speed: 0.3108s/iter; left time: 5950.6505s
Epoch: 8 cost time: 65.03574895858765
Epoch: 8, Steps: 208 | Train Loss: 1.135 Vali Loss: 6.491 Vali Acc: 0.071 Test Loss: 6.491 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.2459116
	speed: 0.7270s/iter; left time: 13839.3213s
	iters: 200, epoch: 9 | loss: 0.8101612
	speed: 0.2817s/iter; left time: 5335.3562s
Epoch: 9 cost time: 60.571327924728394
Epoch: 9, Steps: 208 | Train Loss: 0.910 Vali Loss: 6.976 Vali Acc: 0.074 Test Loss: 6.976 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5690284
	speed: 0.6961s/iter; left time: 13106.3962s
	iters: 200, epoch: 10 | loss: 0.9013241
	speed: 0.3176s/iter; left time: 5948.9016s
Epoch: 10 cost time: 65.43773102760315
Epoch: 10, Steps: 208 | Train Loss: 0.821 Vali Loss: 7.062 Vali Acc: 0.083 Test Loss: 7.062 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.0856856
	speed: 0.7005s/iter; left time: 13043.9391s
	iters: 200, epoch: 11 | loss: 1.1701324
	speed: 0.3006s/iter; left time: 5567.5608s
Epoch: 11 cost time: 61.961052894592285
Epoch: 11, Steps: 208 | Train Loss: 0.701 Vali Loss: 7.648 Vali Acc: 0.072 Test Loss: 7.648 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0894762
	speed: 0.7425s/iter; left time: 13672.3700s
	iters: 200, epoch: 12 | loss: 0.1822641
	speed: 0.3039s/iter; left time: 5565.3417s
Epoch: 12 cost time: 64.79291152954102
Epoch: 12, Steps: 208 | Train Loss: 0.610 Vali Loss: 8.225 Vali Acc: 0.079 Test Loss: 8.225 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0670341
	speed: 0.7023s/iter; left time: 12785.6160s
	iters: 200, epoch: 13 | loss: 0.7442963
	speed: 0.2989s/iter; left time: 5410.7422s
Epoch: 13 cost time: 62.17527198791504
Epoch: 13, Steps: 208 | Train Loss: 0.562 Vali Loss: 8.443 Vali Acc: 0.086 Test Loss: 8.443 Test Acc: 0.086
Validation loss decreased (-0.083157 --> -0.086107).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5524194
	speed: 0.7237s/iter; left time: 13024.6165s
	iters: 200, epoch: 14 | loss: 1.5520266
	speed: 0.2957s/iter; left time: 5292.4864s
Epoch: 14 cost time: 63.328749895095825
Epoch: 14, Steps: 208 | Train Loss: 0.499 Vali Loss: 8.645 Vali Acc: 0.073 Test Loss: 8.645 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5813206
	speed: 0.7506s/iter; left time: 13351.5374s
	iters: 200, epoch: 15 | loss: 0.7815765
	speed: 0.3145s/iter; left time: 5563.2032s
Epoch: 15 cost time: 66.55370044708252
Epoch: 15, Steps: 208 | Train Loss: 0.444 Vali Loss: 9.027 Vali Acc: 0.074 Test Loss: 9.027 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1524608
	speed: 0.7065s/iter; left time: 12420.5558s
	iters: 200, epoch: 16 | loss: 0.7877355
	speed: 0.2907s/iter; left time: 5081.6687s
Epoch: 16 cost time: 60.98324179649353
Epoch: 16, Steps: 208 | Train Loss: 0.487 Vali Loss: 8.840 Vali Acc: 0.075 Test Loss: 8.840 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2254488
	speed: 0.7002s/iter; left time: 12164.2450s
	iters: 200, epoch: 17 | loss: 0.5143086
	speed: 0.2912s/iter; left time: 5030.6211s
Epoch: 17 cost time: 60.37540864944458
Epoch: 17, Steps: 208 | Train Loss: 0.383 Vali Loss: 9.336 Vali Acc: 0.078 Test Loss: 9.336 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2412452
	speed: 0.6918s/iter; left time: 11875.0485s
	iters: 200, epoch: 18 | loss: 0.0613511
	speed: 0.2979s/iter; left time: 5083.9350s
Epoch: 18 cost time: 61.968470096588135
Epoch: 18, Steps: 208 | Train Loss: 0.361 Vali Loss: 9.440 Vali Acc: 0.080 Test Loss: 9.440 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3887445
	speed: 0.7120s/iter; left time: 12072.6685s
	iters: 200, epoch: 19 | loss: 0.2226489
	speed: 0.2840s/iter; left time: 4788.0735s
Epoch: 19 cost time: 61.012415647506714
Epoch: 19, Steps: 208 | Train Loss: 0.328 Vali Loss: 9.601 Vali Acc: 0.081 Test Loss: 9.601 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1602799
	speed: 0.6757s/iter; left time: 11317.2674s
	iters: 200, epoch: 20 | loss: 0.0100635
	speed: 0.3070s/iter; left time: 5111.4622s
Epoch: 20 cost time: 61.804094552993774
Epoch: 20, Steps: 208 | Train Loss: 0.299 Vali Loss: 9.675 Vali Acc: 0.073 Test Loss: 9.675 Test Acc: 0.073
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1494674
	speed: 0.6664s/iter; left time: 11022.2606s
	iters: 200, epoch: 21 | loss: 0.3941303
	speed: 0.2981s/iter; left time: 4901.2914s
Epoch: 21 cost time: 60.588802099227905
Epoch: 21, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.725 Vali Acc: 0.077 Test Loss: 9.725 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4857030
	speed: 0.7055s/iter; left time: 11523.4864s
	iters: 200, epoch: 22 | loss: 0.0495958
	speed: 0.2850s/iter; left time: 4626.7250s
Epoch: 22 cost time: 60.7394859790802
Epoch: 22, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.450 Vali Acc: 0.085 Test Loss: 9.450 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3365270
	speed: 0.6975s/iter; left time: 11247.4410s
	iters: 200, epoch: 23 | loss: 0.1221228
	speed: 0.2920s/iter; left time: 4679.5112s
Epoch: 23 cost time: 62.07121801376343
Epoch: 23, Steps: 208 | Train Loss: 0.274 Vali Loss: 10.012 Vali Acc: 0.080 Test Loss: 10.012 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08619147032508202
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7042191
	speed: 0.3156s/iter; left time: 6533.4063s
	iters: 200, epoch: 1 | loss: 3.8519073
	speed: 0.2860s/iter; left time: 5891.4135s
Epoch: 1 cost time: 62.986446142196655
Epoch: 1, Steps: 208 | Train Loss: 3.699 Vali Loss: 4.678 Vali Acc: 0.031 Test Loss: 4.678 Test Acc: 0.031
Validation loss decreased (inf --> -0.030970).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1317241
	speed: 0.7110s/iter; left time: 14571.1081s
	iters: 200, epoch: 2 | loss: 3.8820071
	speed: 0.3011s/iter; left time: 6140.0195s
Epoch: 2 cost time: 63.1379280090332
Epoch: 2, Steps: 208 | Train Loss: 3.337 Vali Loss: 5.080 Vali Acc: 0.045 Test Loss: 5.080 Test Acc: 0.045
Validation loss decreased (-0.030970 --> -0.045282).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7141225
	speed: 0.6640s/iter; left time: 13468.3858s
	iters: 200, epoch: 3 | loss: 3.7332540
	speed: 0.2992s/iter; left time: 6038.4111s
Epoch: 3 cost time: 61.042513847351074
Epoch: 3, Steps: 208 | Train Loss: 3.133 Vali Loss: 5.355 Vali Acc: 0.047 Test Loss: 5.355 Test Acc: 0.047
Validation loss decreased (-0.045282 --> -0.046472).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7618084
	speed: 0.6726s/iter; left time: 13503.8416s
	iters: 200, epoch: 4 | loss: 3.4242082
	speed: 0.2861s/iter; left time: 5714.6676s
Epoch: 4 cost time: 59.05112171173096
Epoch: 4, Steps: 208 | Train Loss: 2.867 Vali Loss: 5.159 Vali Acc: 0.050 Test Loss: 5.159 Test Acc: 0.050
Validation loss decreased (-0.046472 --> -0.050351).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1190116
	speed: 0.7296s/iter; left time: 14495.4765s
	iters: 200, epoch: 5 | loss: 2.3877783
	speed: 0.3094s/iter; left time: 6116.2775s
Epoch: 5 cost time: 65.89748001098633
Epoch: 5, Steps: 208 | Train Loss: 2.544 Vali Loss: 5.182 Vali Acc: 0.066 Test Loss: 5.182 Test Acc: 0.066
Validation loss decreased (-0.050351 --> -0.065859).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1394813
	speed: 0.7268s/iter; left time: 14289.4216s
	iters: 200, epoch: 6 | loss: 3.3006468
	speed: 0.3007s/iter; left time: 5882.7217s
Epoch: 6 cost time: 64.79275608062744
Epoch: 6, Steps: 208 | Train Loss: 2.115 Vali Loss: 5.291 Vali Acc: 0.063 Test Loss: 5.291 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3661301
	speed: 0.6563s/iter; left time: 12767.1812s
	iters: 200, epoch: 7 | loss: 2.0991473
	speed: 0.3018s/iter; left time: 5839.9282s
Epoch: 7 cost time: 59.88905310630798
Epoch: 7, Steps: 208 | Train Loss: 1.713 Vali Loss: 5.537 Vali Acc: 0.061 Test Loss: 5.537 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0711303
	speed: 0.6536s/iter; left time: 12577.8715s
	iters: 200, epoch: 8 | loss: 1.7309439
	speed: 0.2697s/iter; left time: 5163.9438s
Epoch: 8 cost time: 55.91745924949646
Epoch: 8, Steps: 208 | Train Loss: 1.349 Vali Loss: 6.008 Vali Acc: 0.075 Test Loss: 6.008 Test Acc: 0.075
Validation loss decreased (-0.065859 --> -0.074798).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6858054
	speed: 0.6823s/iter; left time: 12988.9835s
	iters: 200, epoch: 9 | loss: 0.8652214
	speed: 0.2814s/iter; left time: 5328.9306s
Epoch: 9 cost time: 59.770808696746826
Epoch: 9, Steps: 208 | Train Loss: 1.059 Vali Loss: 6.589 Vali Acc: 0.074 Test Loss: 6.589 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1414560
	speed: 0.6760s/iter; left time: 12729.0509s
	iters: 200, epoch: 10 | loss: 0.9818397
	speed: 0.2832s/iter; left time: 5303.2534s
Epoch: 10 cost time: 59.4176766872406
Epoch: 10, Steps: 208 | Train Loss: 0.914 Vali Loss: 6.846 Vali Acc: 0.067 Test Loss: 6.846 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2324351
	speed: 0.6575s/iter; left time: 12243.5172s
	iters: 200, epoch: 11 | loss: 1.4263097
	speed: 0.2791s/iter; left time: 5170.0048s
Epoch: 11 cost time: 58.2388961315155
Epoch: 11, Steps: 208 | Train Loss: 0.791 Vali Loss: 7.032 Vali Acc: 0.081 Test Loss: 7.032 Test Acc: 0.081
Validation loss decreased (-0.074798 --> -0.080753).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2544540
	speed: 0.6627s/iter; left time: 12201.7760s
	iters: 200, epoch: 12 | loss: 0.9883134
	speed: 0.2723s/iter; left time: 4986.1310s
Epoch: 12 cost time: 57.3804087638855
Epoch: 12, Steps: 208 | Train Loss: 0.671 Vali Loss: 7.770 Vali Acc: 0.072 Test Loss: 7.770 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1643536
	speed: 0.6676s/iter; left time: 12153.8363s
	iters: 200, epoch: 13 | loss: 0.3358126
	speed: 0.2793s/iter; left time: 5056.9900s
Epoch: 13 cost time: 58.72809314727783
Epoch: 13, Steps: 208 | Train Loss: 0.589 Vali Loss: 7.837 Vali Acc: 0.084 Test Loss: 7.837 Test Acc: 0.084
Validation loss decreased (-0.080753 --> -0.084324).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2710877
	speed: 0.6724s/iter; left time: 12101.6138s
	iters: 200, epoch: 14 | loss: 1.8195232
	speed: 0.3146s/iter; left time: 5630.6859s
Epoch: 14 cost time: 63.264920711517334
Epoch: 14, Steps: 208 | Train Loss: 0.510 Vali Loss: 8.046 Vali Acc: 0.081 Test Loss: 8.046 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2660782
	speed: 0.7109s/iter; left time: 12646.7754s
	iters: 200, epoch: 15 | loss: 0.7664807
	speed: 0.2832s/iter; left time: 5010.2509s
Epoch: 15 cost time: 60.842167377471924
Epoch: 15, Steps: 208 | Train Loss: 0.472 Vali Loss: 8.585 Vali Acc: 0.082 Test Loss: 8.585 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1836969
	speed: 0.7021s/iter; left time: 12344.4197s
	iters: 200, epoch: 16 | loss: 0.4695327
	speed: 0.2843s/iter; left time: 4969.4753s
Epoch: 16 cost time: 60.77783155441284
Epoch: 16, Steps: 208 | Train Loss: 0.439 Vali Loss: 8.702 Vali Acc: 0.078 Test Loss: 8.702 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1456349
	speed: 0.6747s/iter; left time: 11722.3037s
	iters: 200, epoch: 17 | loss: 0.8807513
	speed: 0.3001s/iter; left time: 5183.3807s
Epoch: 17 cost time: 62.29432678222656
Epoch: 17, Steps: 208 | Train Loss: 0.391 Vali Loss: 9.220 Vali Acc: 0.075 Test Loss: 9.220 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.1682215
	speed: 0.6902s/iter; left time: 11846.9344s
	iters: 200, epoch: 18 | loss: 0.7226243
	speed: 0.3070s/iter; left time: 5239.2628s
Epoch: 18 cost time: 63.00831747055054
Epoch: 18, Steps: 208 | Train Loss: 0.375 Vali Loss: 9.334 Vali Acc: 0.082 Test Loss: 9.334 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7716832
	speed: 0.6984s/iter; left time: 11842.2615s
	iters: 200, epoch: 19 | loss: 0.3425182
	speed: 0.2744s/iter; left time: 4624.7193s
Epoch: 19 cost time: 57.72962546348572
Epoch: 19, Steps: 208 | Train Loss: 0.322 Vali Loss: 9.340 Vali Acc: 0.075 Test Loss: 9.340 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1339713
	speed: 0.6579s/iter; left time: 11019.5805s
	iters: 200, epoch: 20 | loss: 0.1128099
	speed: 0.2782s/iter; left time: 4630.9460s
Epoch: 20 cost time: 60.001259565353394
Epoch: 20, Steps: 208 | Train Loss: 0.322 Vali Loss: 9.750 Vali Acc: 0.090 Test Loss: 9.750 Test Acc: 0.090
Validation loss decreased (-0.084324 --> -0.089971).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2877131
	speed: 0.6754s/iter; left time: 11170.9874s
	iters: 200, epoch: 21 | loss: 0.2362923
	speed: 0.2950s/iter; left time: 4849.5565s
Epoch: 21 cost time: 60.809484004974365
Epoch: 21, Steps: 208 | Train Loss: 0.320 Vali Loss: 9.721 Vali Acc: 0.089 Test Loss: 9.721 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.8375636
	speed: 0.6692s/iter; left time: 10929.2379s
	iters: 200, epoch: 22 | loss: 0.4652137
	speed: 0.2679s/iter; left time: 4348.5378s
Epoch: 22 cost time: 56.955050230026245
Epoch: 22, Steps: 208 | Train Loss: 0.305 Vali Loss: 9.718 Vali Acc: 0.077 Test Loss: 9.718 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5658848
	speed: 0.7094s/iter; left time: 11438.5825s
	iters: 200, epoch: 23 | loss: 0.3715203
	speed: 0.2781s/iter; left time: 4457.1650s
Epoch: 23 cost time: 61.3202338218689
Epoch: 23, Steps: 208 | Train Loss: 0.284 Vali Loss: 9.906 Vali Acc: 0.079 Test Loss: 9.906 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0161856
	speed: 0.6998s/iter; left time: 11138.9628s
	iters: 200, epoch: 24 | loss: 0.5052679
	speed: 0.2957s/iter; left time: 4676.6552s
Epoch: 24 cost time: 63.22447156906128
Epoch: 24, Steps: 208 | Train Loss: 0.265 Vali Loss: 10.078 Vali Acc: 0.084 Test Loss: 10.078 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0659497
	speed: 0.6719s/iter; left time: 10554.7273s
	iters: 200, epoch: 25 | loss: 0.4081372
	speed: 0.2988s/iter; left time: 4664.3012s
Epoch: 25 cost time: 61.375404834747314
Epoch: 25, Steps: 208 | Train Loss: 0.253 Vali Loss: 10.082 Vali Acc: 0.088 Test Loss: 10.082 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.2058974
	speed: 0.6681s/iter; left time: 10355.5340s
	iters: 200, epoch: 26 | loss: 0.1734586
	speed: 0.2789s/iter; left time: 4294.6767s
Epoch: 26 cost time: 58.21185564994812
Epoch: 26, Steps: 208 | Train Loss: 0.234 Vali Loss: 10.620 Vali Acc: 0.075 Test Loss: 10.620 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.2245402
	speed: 0.6727s/iter; left time: 10287.9968s
	iters: 200, epoch: 27 | loss: 0.9440740
	speed: 0.2701s/iter; left time: 4104.1511s
Epoch: 27 cost time: 58.150999784469604
Epoch: 27, Steps: 208 | Train Loss: 0.223 Vali Loss: 10.995 Vali Acc: 0.074 Test Loss: 10.995 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.2218345
	speed: 0.6842s/iter; left time: 10321.3231s
	iters: 200, epoch: 28 | loss: 0.3378302
	speed: 0.3057s/iter; left time: 4581.2495s
Epoch: 28 cost time: 62.97651529312134
Epoch: 28, Steps: 208 | Train Loss: 0.222 Vali Loss: 10.650 Vali Acc: 0.082 Test Loss: 10.650 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1860612
	speed: 0.7071s/iter; left time: 10519.5286s
	iters: 200, epoch: 29 | loss: 0.0681562
	speed: 0.2932s/iter; left time: 4333.1946s
Epoch: 29 cost time: 62.40789246559143
Epoch: 29, Steps: 208 | Train Loss: 0.201 Vali Loss: 11.224 Vali Acc: 0.079 Test Loss: 11.224 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0937912
	speed: 0.6989s/iter; left time: 10252.6759s
	iters: 200, epoch: 30 | loss: 0.6077023
	speed: 0.2776s/iter; left time: 4044.9745s
Epoch: 30 cost time: 60.328179359436035
Epoch: 30, Steps: 208 | Train Loss: 0.221 Vali Loss: 11.197 Vali Acc: 0.078 Test Loss: 11.197 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09006859528780196
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7405894
	speed: 0.2928s/iter; left time: 6060.3015s
	iters: 200, epoch: 1 | loss: 3.7109182
	speed: 0.2889s/iter; left time: 5951.1018s
Epoch: 1 cost time: 60.61516213417053
Epoch: 1, Steps: 208 | Train Loss: 3.679 Vali Loss: 5.519 Vali Acc: 0.032 Test Loss: 5.519 Test Acc: 0.032
Validation loss decreased (inf --> -0.032155).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4608793
	speed: 0.7055s/iter; left time: 14458.4715s
	iters: 200, epoch: 2 | loss: 3.9211469
	speed: 0.2933s/iter; left time: 5981.2389s
Epoch: 2 cost time: 62.84255123138428
Epoch: 2, Steps: 208 | Train Loss: 3.418 Vali Loss: 5.652 Vali Acc: 0.031 Test Loss: 5.652 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6044712
	speed: 0.6631s/iter; left time: 13450.4778s
	iters: 200, epoch: 3 | loss: 4.0873785
	speed: 0.2853s/iter; left time: 5758.5406s
Epoch: 3 cost time: 58.74154567718506
Epoch: 3, Steps: 208 | Train Loss: 3.310 Vali Loss: 5.819 Vali Acc: 0.043 Test Loss: 5.819 Test Acc: 0.043
Validation loss decreased (-0.032155 --> -0.042590).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8188195
	speed: 0.6471s/iter; left time: 12992.1809s
	iters: 200, epoch: 4 | loss: 2.4937475
	speed: 0.2643s/iter; left time: 5279.6729s
Epoch: 4 cost time: 56.407485008239746
Epoch: 4, Steps: 208 | Train Loss: 3.171 Vali Loss: 5.214 Vali Acc: 0.049 Test Loss: 5.214 Test Acc: 0.049
Validation loss decreased (-0.042590 --> -0.048561).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6831923
	speed: 0.6813s/iter; left time: 13537.3999s
	iters: 200, epoch: 5 | loss: 3.3637967
	speed: 0.2851s/iter; left time: 5635.3652s
Epoch: 5 cost time: 60.17546510696411
Epoch: 5, Steps: 208 | Train Loss: 2.941 Vali Loss: 4.978 Vali Acc: 0.051 Test Loss: 4.978 Test Acc: 0.051
Validation loss decreased (-0.048561 --> -0.050651).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0014880
	speed: 0.6816s/iter; left time: 13401.5142s
	iters: 200, epoch: 6 | loss: 3.4097896
	speed: 0.3103s/iter; left time: 6068.8612s
Epoch: 6 cost time: 63.153199434280396
Epoch: 6, Steps: 208 | Train Loss: 2.551 Vali Loss: 4.893 Vali Acc: 0.062 Test Loss: 4.893 Test Acc: 0.062
Validation loss decreased (-0.050651 --> -0.061985).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4032509
	speed: 0.7032s/iter; left time: 13679.1133s
	iters: 200, epoch: 7 | loss: 2.9423661
	speed: 0.2942s/iter; left time: 5693.1847s
Epoch: 7 cost time: 62.016541957855225
Epoch: 7, Steps: 208 | Train Loss: 2.135 Vali Loss: 5.190 Vali Acc: 0.065 Test Loss: 5.190 Test Acc: 0.065
Validation loss decreased (-0.061985 --> -0.064965).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6315942
	speed: 0.6916s/iter; left time: 13309.8320s
	iters: 200, epoch: 8 | loss: 1.2390530
	speed: 0.2930s/iter; left time: 5610.2849s
Epoch: 8 cost time: 62.23229384422302
Epoch: 8, Steps: 208 | Train Loss: 1.799 Vali Loss: 5.303 Vali Acc: 0.072 Test Loss: 5.303 Test Acc: 0.072
Validation loss decreased (-0.064965 --> -0.072121).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7326988
	speed: 0.6915s/iter; left time: 13164.0078s
	iters: 200, epoch: 9 | loss: 2.0742717
	speed: 0.2925s/iter; left time: 5539.7604s
Epoch: 9 cost time: 61.467193603515625
Epoch: 9, Steps: 208 | Train Loss: 1.471 Vali Loss: 5.875 Vali Acc: 0.077 Test Loss: 5.875 Test Acc: 0.077
Validation loss decreased (-0.072121 --> -0.076887).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1509728
	speed: 0.7099s/iter; left time: 13366.8687s
	iters: 200, epoch: 10 | loss: 1.5070958
	speed: 0.3227s/iter; left time: 6044.2594s
Epoch: 10 cost time: 65.788822889328
Epoch: 10, Steps: 208 | Train Loss: 1.233 Vali Loss: 6.104 Vali Acc: 0.070 Test Loss: 6.104 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7354854
	speed: 0.7524s/iter; left time: 14010.1005s
	iters: 200, epoch: 11 | loss: 1.1021414
	speed: 0.2941s/iter; left time: 5446.7314s
Epoch: 11 cost time: 63.80884766578674
Epoch: 11, Steps: 208 | Train Loss: 1.059 Vali Loss: 6.190 Vali Acc: 0.077 Test Loss: 6.190 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4349008
	speed: 0.7249s/iter; left time: 13347.9191s
	iters: 200, epoch: 12 | loss: 0.9593116
	speed: 0.3023s/iter; left time: 5536.8190s
Epoch: 12 cost time: 64.28879523277283
Epoch: 12, Steps: 208 | Train Loss: 0.887 Vali Loss: 6.832 Vali Acc: 0.074 Test Loss: 6.832 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6199024
	speed: 0.6457s/iter; left time: 11754.8591s
	iters: 200, epoch: 13 | loss: 0.7071289
	speed: 0.2815s/iter; left time: 5095.9259s
Epoch: 13 cost time: 59.055628061294556
Epoch: 13, Steps: 208 | Train Loss: 0.751 Vali Loss: 7.008 Vali Acc: 0.085 Test Loss: 7.008 Test Acc: 0.085
Validation loss decreased (-0.076887 --> -0.084630).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2283441
	speed: 0.6887s/iter; left time: 12393.7734s
	iters: 200, epoch: 14 | loss: 1.5936370
	speed: 0.2981s/iter; left time: 5335.8174s
Epoch: 14 cost time: 62.55786848068237
Epoch: 14, Steps: 208 | Train Loss: 0.692 Vali Loss: 7.126 Vali Acc: 0.075 Test Loss: 7.126 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3676826
	speed: 0.6507s/iter; left time: 11575.3317s
	iters: 200, epoch: 15 | loss: 1.0044801
	speed: 0.2793s/iter; left time: 4941.3453s
Epoch: 15 cost time: 57.38637852668762
Epoch: 15, Steps: 208 | Train Loss: 0.630 Vali Loss: 7.580 Vali Acc: 0.081 Test Loss: 7.580 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8424349
	speed: 0.6549s/iter; left time: 11513.4461s
	iters: 200, epoch: 16 | loss: 0.5126210
	speed: 0.2724s/iter; left time: 4762.1032s
Epoch: 16 cost time: 57.0184645652771
Epoch: 16, Steps: 208 | Train Loss: 0.577 Vali Loss: 7.727 Vali Acc: 0.080 Test Loss: 7.727 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1201895
	speed: 0.6959s/iter; left time: 12090.5465s
	iters: 200, epoch: 17 | loss: 0.8216200
	speed: 0.2879s/iter; left time: 4972.1377s
Epoch: 17 cost time: 61.57255673408508
Epoch: 17, Steps: 208 | Train Loss: 0.509 Vali Loss: 8.414 Vali Acc: 0.074 Test Loss: 8.414 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3129716
	speed: 0.7091s/iter; left time: 12171.4992s
	iters: 200, epoch: 18 | loss: 0.3442378
	speed: 0.2959s/iter; left time: 5049.4782s
Epoch: 18 cost time: 62.35984706878662
Epoch: 18, Steps: 208 | Train Loss: 0.499 Vali Loss: 7.726 Vali Acc: 0.075 Test Loss: 7.726 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6857566
	speed: 0.6920s/iter; left time: 11733.8290s
	iters: 200, epoch: 19 | loss: 0.4094364
	speed: 0.2660s/iter; left time: 4483.7654s
Epoch: 19 cost time: 57.52996873855591
Epoch: 19, Steps: 208 | Train Loss: 0.450 Vali Loss: 8.209 Vali Acc: 0.074 Test Loss: 8.209 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.5999182
	speed: 0.6804s/iter; left time: 11395.1984s
	iters: 200, epoch: 20 | loss: 0.4607711
	speed: 0.2886s/iter; left time: 4805.6232s
Epoch: 20 cost time: 61.40998363494873
Epoch: 20, Steps: 208 | Train Loss: 0.435 Vali Loss: 8.501 Vali Acc: 0.088 Test Loss: 8.501 Test Acc: 0.088
Validation loss decreased (-0.084630 --> -0.087896).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3404553
	speed: 0.7525s/iter; left time: 12447.6880s
	iters: 200, epoch: 21 | loss: 0.1893727
	speed: 0.3004s/iter; left time: 4939.6972s
Epoch: 21 cost time: 65.30305194854736
Epoch: 21, Steps: 208 | Train Loss: 0.384 Vali Loss: 8.441 Vali Acc: 0.086 Test Loss: 8.441 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.8890037
	speed: 0.6945s/iter; left time: 11343.4704s
	iters: 200, epoch: 22 | loss: 0.1637164
	speed: 0.2864s/iter; left time: 4648.5832s
Epoch: 22 cost time: 60.628023624420166
Epoch: 22, Steps: 208 | Train Loss: 0.373 Vali Loss: 8.646 Vali Acc: 0.073 Test Loss: 8.646 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4508961
	speed: 0.6844s/iter; left time: 11035.2883s
	iters: 200, epoch: 23 | loss: 0.4725226
	speed: 0.2948s/iter; left time: 4723.4738s
Epoch: 23 cost time: 61.951565742492676
Epoch: 23, Steps: 208 | Train Loss: 0.342 Vali Loss: 9.170 Vali Acc: 0.076 Test Loss: 9.170 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0451092
	speed: 0.6782s/iter; left time: 10794.2970s
	iters: 200, epoch: 24 | loss: 0.2300215
	speed: 0.3019s/iter; left time: 4775.7343s
Epoch: 24 cost time: 63.02150535583496
Epoch: 24, Steps: 208 | Train Loss: 0.350 Vali Loss: 8.977 Vali Acc: 0.073 Test Loss: 8.977 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.7104963
	speed: 0.7213s/iter; left time: 11330.7674s
	iters: 200, epoch: 25 | loss: 0.0734542
	speed: 0.3175s/iter; left time: 4955.9148s
Epoch: 25 cost time: 65.32705426216125
Epoch: 25, Steps: 208 | Train Loss: 0.329 Vali Loss: 8.887 Vali Acc: 0.087 Test Loss: 8.887 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1954044
	speed: 0.6652s/iter; left time: 10311.1676s
	iters: 200, epoch: 26 | loss: 0.1391436
	speed: 0.2908s/iter; left time: 4478.6582s
Epoch: 26 cost time: 59.3550705909729
Epoch: 26, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.385 Vali Acc: 0.081 Test Loss: 9.385 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1034654
	speed: 0.6521s/iter; left time: 9972.5403s
	iters: 200, epoch: 27 | loss: 1.1866038
	speed: 0.3020s/iter; left time: 4588.8880s
Epoch: 27 cost time: 60.72369456291199
Epoch: 27, Steps: 208 | Train Loss: 0.286 Vali Loss: 9.455 Vali Acc: 0.080 Test Loss: 9.455 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.3420173
	speed: 0.7773s/iter; left time: 11724.9634s
	iters: 200, epoch: 28 | loss: 0.6144919
	speed: 0.3009s/iter; left time: 4509.0832s
Epoch: 28 cost time: 64.3053548336029
Epoch: 28, Steps: 208 | Train Loss: 0.286 Vali Loss: 9.848 Vali Acc: 0.082 Test Loss: 9.848 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1567183
	speed: 0.6955s/iter; left time: 10346.3665s
	iters: 200, epoch: 29 | loss: 0.2075817
	speed: 0.3050s/iter; left time: 4506.8594s
Epoch: 29 cost time: 62.05726647377014
Epoch: 29, Steps: 208 | Train Loss: 0.257 Vali Loss: 10.008 Vali Acc: 0.085 Test Loss: 10.008 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.3460863
	speed: 0.7078s/iter; left time: 10382.2405s
	iters: 200, epoch: 30 | loss: 0.5971135
	speed: 0.2736s/iter; left time: 3986.5980s
Epoch: 30 cost time: 58.332571268081665
Epoch: 30, Steps: 208 | Train Loss: 0.268 Vali Loss: 10.290 Vali Acc: 0.084 Test Loss: 10.290 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08798091261556815
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8995132
	speed: 0.3228s/iter; left time: 6682.3312s
	iters: 200, epoch: 1 | loss: 3.7672088
	speed: 0.3206s/iter; left time: 6604.1730s
Epoch: 1 cost time: 67.23995113372803
Epoch: 1, Steps: 208 | Train Loss: 3.674 Vali Loss: 5.031 Vali Acc: 0.033 Test Loss: 5.031 Test Acc: 0.033
Validation loss decreased (inf --> -0.032756).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4232347
	speed: 0.7173s/iter; left time: 14700.2460s
	iters: 200, epoch: 2 | loss: 3.5092764
	speed: 0.2958s/iter; left time: 6032.3552s
Epoch: 2 cost time: 62.526376724243164
Epoch: 2, Steps: 208 | Train Loss: 3.295 Vali Loss: 5.562 Vali Acc: 0.034 Test Loss: 5.562 Test Acc: 0.034
Validation loss decreased (-0.032756 --> -0.034242).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8197551
	speed: 0.6997s/iter; left time: 14192.7825s
	iters: 200, epoch: 3 | loss: 3.6248891
	speed: 0.2968s/iter; left time: 5990.1866s
Epoch: 3 cost time: 61.055665254592896
Epoch: 3, Steps: 208 | Train Loss: 3.089 Vali Loss: 6.071 Vali Acc: 0.043 Test Loss: 6.071 Test Acc: 0.043
Validation loss decreased (-0.034242 --> -0.042886).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7377532
	speed: 0.7050s/iter; left time: 14154.4830s
	iters: 200, epoch: 4 | loss: 2.6816385
	speed: 0.2883s/iter; left time: 5758.8920s
Epoch: 4 cost time: 60.9247887134552
Epoch: 4, Steps: 208 | Train Loss: 2.900 Vali Loss: 5.575 Vali Acc: 0.049 Test Loss: 5.575 Test Acc: 0.049
Validation loss decreased (-0.042886 --> -0.048856).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4001908
	speed: 0.7159s/iter; left time: 14225.0234s
	iters: 200, epoch: 5 | loss: 2.6198545
	speed: 0.3113s/iter; left time: 6153.9152s
Epoch: 5 cost time: 63.79150366783142
Epoch: 5, Steps: 208 | Train Loss: 2.592 Vali Loss: 5.677 Vali Acc: 0.061 Test Loss: 5.677 Test Acc: 0.061
Validation loss decreased (-0.048856 --> -0.060784).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6558558
	speed: 0.7406s/iter; left time: 14560.2843s
	iters: 200, epoch: 6 | loss: 3.0754220
	speed: 0.3008s/iter; left time: 5884.1483s
Epoch: 6 cost time: 63.343700647354126
Epoch: 6, Steps: 208 | Train Loss: 2.205 Vali Loss: 5.663 Vali Acc: 0.058 Test Loss: 5.663 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7801548
	speed: 0.7130s/iter; left time: 13869.0958s
	iters: 200, epoch: 7 | loss: 2.7040663
	speed: 0.2884s/iter; left time: 5581.6115s
Epoch: 7 cost time: 60.19101428985596
Epoch: 7, Steps: 208 | Train Loss: 1.815 Vali Loss: 5.837 Vali Acc: 0.063 Test Loss: 5.837 Test Acc: 0.063
Validation loss decreased (-0.060784 --> -0.062870).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4784287
	speed: 0.7034s/iter; left time: 13536.1634s
	iters: 200, epoch: 8 | loss: 0.9365007
	speed: 0.2912s/iter; left time: 5574.3205s
Epoch: 8 cost time: 61.19727110862732
Epoch: 8, Steps: 208 | Train Loss: 1.462 Vali Loss: 6.358 Vali Acc: 0.070 Test Loss: 6.358 Test Acc: 0.070
Validation loss decreased (-0.062870 --> -0.070023).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4978832
	speed: 0.6896s/iter; left time: 13127.8584s
	iters: 200, epoch: 9 | loss: 1.3772995
	speed: 0.2835s/iter; left time: 5369.1004s
Epoch: 9 cost time: 60.32329535484314
Epoch: 9, Steps: 208 | Train Loss: 1.146 Vali Loss: 6.912 Vali Acc: 0.066 Test Loss: 6.912 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3153847
	speed: 0.6794s/iter; left time: 12792.9124s
	iters: 200, epoch: 10 | loss: 1.1014897
	speed: 0.2841s/iter; left time: 5320.9688s
Epoch: 10 cost time: 60.40114092826843
Epoch: 10, Steps: 208 | Train Loss: 0.992 Vali Loss: 6.792 Vali Acc: 0.072 Test Loss: 6.792 Test Acc: 0.072
Validation loss decreased (-0.070023 --> -0.072404).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3374802
	speed: 0.6953s/iter; left time: 12946.6429s
	iters: 200, epoch: 11 | loss: 0.8756877
	speed: 0.2820s/iter; left time: 5223.6448s
Epoch: 11 cost time: 60.134894132614136
Epoch: 11, Steps: 208 | Train Loss: 0.809 Vali Loss: 7.104 Vali Acc: 0.068 Test Loss: 7.104 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6306224
	speed: 0.6718s/iter; left time: 12369.2531s
	iters: 200, epoch: 12 | loss: 0.9469560
	speed: 0.2860s/iter; left time: 5238.0979s
Epoch: 12 cost time: 58.716338872909546
Epoch: 12, Steps: 208 | Train Loss: 0.688 Vali Loss: 7.828 Vali Acc: 0.070 Test Loss: 7.828 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2316454
	speed: 0.6760s/iter; left time: 12306.6174s
	iters: 200, epoch: 13 | loss: 0.7171828
	speed: 0.2807s/iter; left time: 5082.7559s
Epoch: 13 cost time: 58.86155295372009
Epoch: 13, Steps: 208 | Train Loss: 0.593 Vali Loss: 8.012 Vali Acc: 0.073 Test Loss: 8.012 Test Acc: 0.073
Validation loss decreased (-0.072404 --> -0.073287).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3672266
	speed: 0.6646s/iter; left time: 11961.1419s
	iters: 200, epoch: 14 | loss: 1.5093005
	speed: 0.2723s/iter; left time: 4872.9458s
Epoch: 14 cost time: 58.43436050415039
Epoch: 14, Steps: 208 | Train Loss: 0.532 Vali Loss: 8.630 Vali Acc: 0.064 Test Loss: 8.630 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0591973
	speed: 0.6773s/iter; left time: 12047.7259s
	iters: 200, epoch: 15 | loss: 1.0755299
	speed: 0.2904s/iter; left time: 5136.2428s
Epoch: 15 cost time: 59.43829655647278
Epoch: 15, Steps: 208 | Train Loss: 0.477 Vali Loss: 8.893 Vali Acc: 0.070 Test Loss: 8.893 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.2401676
	speed: 0.6687s/iter; left time: 11757.0151s
	iters: 200, epoch: 16 | loss: 0.8453740
	speed: 0.2894s/iter; left time: 5059.1855s
Epoch: 16 cost time: 59.718608379364014
Epoch: 16, Steps: 208 | Train Loss: 0.429 Vali Loss: 9.083 Vali Acc: 0.072 Test Loss: 9.083 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9606338
	speed: 0.6917s/iter; left time: 12017.2640s
	iters: 200, epoch: 17 | loss: 0.6714867
	speed: 0.2915s/iter; left time: 5034.2181s
Epoch: 17 cost time: 62.22083067893982
Epoch: 17, Steps: 208 | Train Loss: 0.399 Vali Loss: 9.751 Vali Acc: 0.062 Test Loss: 9.751 Test Acc: 0.062
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5407822
	speed: 0.6682s/iter; left time: 11470.0878s
	iters: 200, epoch: 18 | loss: 0.3331273
	speed: 0.2627s/iter; left time: 4482.4187s
Epoch: 18 cost time: 56.186623334884644
Epoch: 18, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.698 Vali Acc: 0.067 Test Loss: 9.698 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.1353146
	speed: 0.6776s/iter; left time: 11490.1998s
	iters: 200, epoch: 19 | loss: 0.1483471
	speed: 0.2848s/iter; left time: 4801.4904s
Epoch: 19 cost time: 59.09442329406738
Epoch: 19, Steps: 208 | Train Loss: 0.369 Vali Loss: 9.417 Vali Acc: 0.073 Test Loss: 9.417 Test Acc: 0.073
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.4382396
	speed: 0.6802s/iter; left time: 11393.2938s
	iters: 200, epoch: 20 | loss: 0.1733353
	speed: 0.3047s/iter; left time: 5072.1350s
Epoch: 20 cost time: 62.552310943603516
Epoch: 20, Steps: 208 | Train Loss: 0.307 Vali Loss: 10.192 Vali Acc: 0.070 Test Loss: 10.192 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1564454
	speed: 0.7306s/iter; left time: 12085.6154s
	iters: 200, epoch: 21 | loss: 0.1467856
	speed: 0.2880s/iter; left time: 4735.7988s
Epoch: 21 cost time: 63.10169816017151
Epoch: 21, Steps: 208 | Train Loss: 0.293 Vali Loss: 10.090 Vali Acc: 0.074 Test Loss: 10.090 Test Acc: 0.074
Validation loss decreased (-0.073287 --> -0.074161).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.9632592
	speed: 0.7238s/iter; left time: 11822.1717s
	iters: 200, epoch: 22 | loss: 0.0786647
	speed: 0.2839s/iter; left time: 4608.5241s
Epoch: 22 cost time: 62.12587070465088
Epoch: 22, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.345 Vali Acc: 0.073 Test Loss: 10.345 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2622642
	speed: 0.6834s/iter; left time: 11019.4573s
	iters: 200, epoch: 23 | loss: 0.4102727
	speed: 0.3006s/iter; left time: 4816.7986s
Epoch: 23 cost time: 62.53812527656555
Epoch: 23, Steps: 208 | Train Loss: 0.272 Vali Loss: 10.109 Vali Acc: 0.072 Test Loss: 10.109 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0475978
	speed: 0.6623s/iter; left time: 10542.1713s
	iters: 200, epoch: 24 | loss: 0.1318198
	speed: 0.2807s/iter; left time: 4439.9423s
Epoch: 24 cost time: 60.770713090896606
Epoch: 24, Steps: 208 | Train Loss: 0.265 Vali Loss: 10.448 Vali Acc: 0.071 Test Loss: 10.448 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.3569563
	speed: 0.6565s/iter; left time: 10313.5532s
	iters: 200, epoch: 25 | loss: 0.0128613
	speed: 0.2668s/iter; left time: 4164.8376s
Epoch: 25 cost time: 57.85515236854553
Epoch: 25, Steps: 208 | Train Loss: 0.219 Vali Loss: 11.060 Vali Acc: 0.080 Test Loss: 11.060 Test Acc: 0.080
Validation loss decreased (-0.074161 --> -0.079520).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0451170
	speed: 0.6442s/iter; left time: 9985.1633s
	iters: 200, epoch: 26 | loss: 0.2566122
	speed: 0.2920s/iter; left time: 4496.4533s
Epoch: 26 cost time: 58.65408635139465
Epoch: 26, Steps: 208 | Train Loss: 0.277 Vali Loss: 10.703 Vali Acc: 0.069 Test Loss: 10.703 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0083390
	speed: 0.6609s/iter; left time: 10107.3299s
	iters: 200, epoch: 27 | loss: 0.2182190
	speed: 0.2533s/iter; left time: 3848.5903s
Epoch: 27 cost time: 57.366212129592896
Epoch: 27, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.692 Vali Acc: 0.079 Test Loss: 10.692 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0828325
	speed: 0.6484s/iter; left time: 9781.5875s
	iters: 200, epoch: 28 | loss: 0.2211653
	speed: 0.2935s/iter; left time: 4397.7543s
Epoch: 28 cost time: 59.366495847702026
Epoch: 28, Steps: 208 | Train Loss: 0.217 Vali Loss: 10.892 Vali Acc: 0.070 Test Loss: 10.892 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0257924
	speed: 0.6298s/iter; left time: 9369.0010s
	iters: 200, epoch: 29 | loss: 0.0660902
	speed: 0.2861s/iter; left time: 4226.9943s
Epoch: 29 cost time: 58.77448892593384
Epoch: 29, Steps: 208 | Train Loss: 0.183 Vali Loss: 11.432 Vali Acc: 0.078 Test Loss: 11.432 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0278990
	speed: 0.6573s/iter; left time: 9642.5381s
	iters: 200, epoch: 30 | loss: 0.3959719
	speed: 0.2616s/iter; left time: 3811.7654s
Epoch: 30 cost time: 58.10471963882446
Epoch: 30, Steps: 208 | Train Loss: 0.183 Vali Loss: 11.560 Vali Acc: 0.081 Test Loss: 11.560 Test Acc: 0.081
Validation loss decreased (-0.079520 --> -0.080708).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.2157897
	speed: 0.6833s/iter; left time: 9881.1197s
	iters: 200, epoch: 31 | loss: 0.0873621
	speed: 0.3007s/iter; left time: 4318.6362s
Epoch: 31 cost time: 61.29296827316284
Epoch: 31, Steps: 208 | Train Loss: 0.185 Vali Loss: 11.087 Vali Acc: 0.079 Test Loss: 11.087 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.1436730
	speed: 0.6834s/iter; left time: 9740.5440s
	iters: 200, epoch: 32 | loss: 0.3862778
	speed: 0.3058s/iter; left time: 4328.3269s
Epoch: 32 cost time: 62.984310150146484
Epoch: 32, Steps: 208 | Train Loss: 0.169 Vali Loss: 11.407 Vali Acc: 0.080 Test Loss: 11.407 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.2801241
	speed: 0.6600s/iter; left time: 9270.0128s
	iters: 200, epoch: 33 | loss: 0.0708091
	speed: 0.2867s/iter; left time: 3997.9187s
Epoch: 33 cost time: 60.200969219207764
Epoch: 33, Steps: 208 | Train Loss: 0.143 Vali Loss: 12.063 Vali Acc: 0.073 Test Loss: 12.063 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.1855540
	speed: 0.6813s/iter; left time: 9426.8698s
	iters: 200, epoch: 34 | loss: 0.1166097
	speed: 0.2762s/iter; left time: 3794.8002s
Epoch: 34 cost time: 60.98921585083008
Epoch: 34, Steps: 208 | Train Loss: 0.160 Vali Loss: 12.188 Vali Acc: 0.075 Test Loss: 12.188 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0879713
	speed: 0.6231s/iter; left time: 8491.8114s
	iters: 200, epoch: 35 | loss: 0.2912332
	speed: 0.2569s/iter; left time: 3475.3278s
Epoch: 35 cost time: 54.782917737960815
Epoch: 35, Steps: 208 | Train Loss: 0.166 Vali Loss: 11.587 Vali Acc: 0.073 Test Loss: 11.587 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0102541
	speed: 0.6581s/iter; left time: 8832.4113s
	iters: 200, epoch: 36 | loss: 0.1254439
	speed: 0.2718s/iter; left time: 3620.8335s
Epoch: 36 cost time: 57.76888847351074
Epoch: 36, Steps: 208 | Train Loss: 0.172 Vali Loss: 12.141 Vali Acc: 0.080 Test Loss: 12.141 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0090827
	speed: 0.6647s/iter; left time: 8782.8759s
	iters: 200, epoch: 37 | loss: 0.0553115
	speed: 0.2750s/iter; left time: 3606.5498s
Epoch: 37 cost time: 58.432008266448975
Epoch: 37, Steps: 208 | Train Loss: 0.175 Vali Loss: 11.912 Vali Acc: 0.077 Test Loss: 11.912 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0323533
	speed: 0.6384s/iter; left time: 8302.0476s
	iters: 200, epoch: 38 | loss: 0.0128636
	speed: 0.2678s/iter; left time: 3455.6462s
Epoch: 38 cost time: 56.05702042579651
Epoch: 38, Steps: 208 | Train Loss: 0.126 Vali Loss: 12.123 Vali Acc: 0.071 Test Loss: 12.123 Test Acc: 0.071
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.2683363
	speed: 0.6184s/iter; left time: 7913.5301s
	iters: 200, epoch: 39 | loss: 0.0116634
	speed: 0.2766s/iter; left time: 3511.4713s
Epoch: 39 cost time: 56.783058643341064
Epoch: 39, Steps: 208 | Train Loss: 0.143 Vali Loss: 12.158 Vali Acc: 0.077 Test Loss: 12.158 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.2176566
	speed: 0.6584s/iter; left time: 8288.5785s
	iters: 200, epoch: 40 | loss: 0.0207011
	speed: 0.2808s/iter; left time: 3507.5234s
Epoch: 40 cost time: 59.235509157180786
Epoch: 40, Steps: 208 | Train Loss: 0.154 Vali Loss: 11.612 Vali Acc: 0.075 Test Loss: 11.612 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08082314345362362
model parameter : 2535591
model size : 14.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4116218
	speed: 0.3079s/iter; left time: 6373.7378s
	iters: 200, epoch: 1 | loss: 3.6400621
	speed: 0.3024s/iter; left time: 6229.4291s
Epoch: 1 cost time: 63.61073184013367
Epoch: 1, Steps: 208 | Train Loss: 3.829 Vali Loss: 3.719 Vali Acc: 0.073 Test Loss: 3.719 Test Acc: 0.073
Validation loss decreased (inf --> -0.073032).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5158443
	speed: 0.6633s/iter; left time: 13593.1372s
	iters: 200, epoch: 2 | loss: 3.8462465
	speed: 0.2619s/iter; left time: 5341.4814s
Epoch: 2 cost time: 57.13860607147217
Epoch: 2, Steps: 208 | Train Loss: 3.189 Vali Loss: 4.292 Vali Acc: 0.084 Test Loss: 4.292 Test Acc: 0.084
Validation loss decreased (-0.073032 --> -0.083763).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3311069
	speed: 0.6937s/iter; left time: 14071.5337s
	iters: 200, epoch: 3 | loss: 3.1648011
	speed: 0.2812s/iter; left time: 5676.6071s
Epoch: 3 cost time: 61.83487033843994
Epoch: 3, Steps: 208 | Train Loss: 2.559 Vali Loss: 4.317 Vali Acc: 0.090 Test Loss: 4.317 Test Acc: 0.090
Validation loss decreased (-0.083763 --> -0.090324).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0508301
	speed: 0.6748s/iter; left time: 13548.5386s
	iters: 200, epoch: 4 | loss: 2.4546587
	speed: 0.3063s/iter; left time: 6118.9919s
Epoch: 4 cost time: 62.517614126205444
Epoch: 4, Steps: 208 | Train Loss: 1.925 Vali Loss: 5.302 Vali Acc: 0.091 Test Loss: 5.302 Test Acc: 0.091
Validation loss decreased (-0.090324 --> -0.090910).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1031305
	speed: 0.6912s/iter; left time: 13732.7306s
	iters: 200, epoch: 5 | loss: 2.2775099
	speed: 0.2972s/iter; left time: 5875.1587s
Epoch: 5 cost time: 60.851444482803345
Epoch: 5, Steps: 208 | Train Loss: 1.365 Vali Loss: 5.686 Vali Acc: 0.095 Test Loss: 5.686 Test Acc: 0.095
Validation loss decreased (-0.090910 --> -0.094485).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8081411
	speed: 0.6805s/iter; left time: 13378.3628s
	iters: 200, epoch: 6 | loss: 1.3904845
	speed: 0.2938s/iter; left time: 5747.7439s
Epoch: 6 cost time: 61.48041224479675
Epoch: 6, Steps: 208 | Train Loss: 1.074 Vali Loss: 6.538 Vali Acc: 0.091 Test Loss: 6.538 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1048882
	speed: 0.6766s/iter; left time: 13162.8116s
	iters: 200, epoch: 7 | loss: 0.9778774
	speed: 0.2931s/iter; left time: 5672.7837s
Epoch: 7 cost time: 61.51399302482605
Epoch: 7, Steps: 208 | Train Loss: 0.758 Vali Loss: 6.971 Vali Acc: 0.086 Test Loss: 6.971 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1634373
	speed: 0.6990s/iter; left time: 13451.6062s
	iters: 200, epoch: 8 | loss: 1.0480149
	speed: 0.2942s/iter; left time: 5632.8711s
Epoch: 8 cost time: 61.729182958602905
Epoch: 8, Steps: 208 | Train Loss: 0.656 Vali Loss: 7.806 Vali Acc: 0.094 Test Loss: 7.806 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3293651
	speed: 0.6588s/iter; left time: 12541.6907s
	iters: 200, epoch: 9 | loss: 1.4906833
	speed: 0.2987s/iter; left time: 5657.3626s
Epoch: 9 cost time: 60.968387603759766
Epoch: 9, Steps: 208 | Train Loss: 0.524 Vali Loss: 8.303 Vali Acc: 0.079 Test Loss: 8.303 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9208216
	speed: 0.6956s/iter; left time: 13097.8157s
	iters: 200, epoch: 10 | loss: 0.2866810
	speed: 0.3043s/iter; left time: 5699.8890s
Epoch: 10 cost time: 62.961567640304565
Epoch: 10, Steps: 208 | Train Loss: 0.497 Vali Loss: 9.057 Vali Acc: 0.090 Test Loss: 9.057 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0211145
	speed: 0.6800s/iter; left time: 12662.6080s
	iters: 200, epoch: 11 | loss: 0.4136522
	speed: 0.2992s/iter; left time: 5542.2490s
Epoch: 11 cost time: 62.684147119522095
Epoch: 11, Steps: 208 | Train Loss: 0.380 Vali Loss: 9.488 Vali Acc: 0.094 Test Loss: 9.488 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1899057
	speed: 0.6840s/iter; left time: 12593.6813s
	iters: 200, epoch: 12 | loss: 0.5517267
	speed: 0.2698s/iter; left time: 4941.6771s
Epoch: 12 cost time: 58.87865734100342
Epoch: 12, Steps: 208 | Train Loss: 0.353 Vali Loss: 9.382 Vali Acc: 0.082 Test Loss: 9.382 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2711537
	speed: 0.6692s/iter; left time: 12183.0319s
	iters: 200, epoch: 13 | loss: 0.0877632
	speed: 0.3038s/iter; left time: 5500.0272s
Epoch: 13 cost time: 62.27274513244629
Epoch: 13, Steps: 208 | Train Loss: 0.299 Vali Loss: 9.878 Vali Acc: 0.088 Test Loss: 9.878 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.7662109
	speed: 0.6908s/iter; left time: 12432.8787s
	iters: 200, epoch: 14 | loss: 0.1975101
	speed: 0.2946s/iter; left time: 5272.0871s
Epoch: 14 cost time: 61.3003716468811
Epoch: 14, Steps: 208 | Train Loss: 0.287 Vali Loss: 10.172 Vali Acc: 0.083 Test Loss: 10.172 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0632053
	speed: 0.7016s/iter; left time: 12481.5733s
	iters: 200, epoch: 15 | loss: 0.0437280
	speed: 0.2734s/iter; left time: 4835.8484s
Epoch: 15 cost time: 60.005791425704956
Epoch: 15, Steps: 208 | Train Loss: 0.240 Vali Loss: 10.733 Vali Acc: 0.086 Test Loss: 10.733 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0945422010140173
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3820908
	speed: 0.3106s/iter; left time: 6429.7614s
	iters: 200, epoch: 1 | loss: 3.6037219
	speed: 0.3018s/iter; left time: 6218.2443s
Epoch: 1 cost time: 64.11956763267517
Epoch: 1, Steps: 208 | Train Loss: 3.815 Vali Loss: 3.733 Vali Acc: 0.073 Test Loss: 3.733 Test Acc: 0.073
Validation loss decreased (inf --> -0.073330).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5435376
	speed: 0.6734s/iter; left time: 13800.9796s
	iters: 200, epoch: 2 | loss: 3.6885297
	speed: 0.3129s/iter; left time: 6381.6094s
Epoch: 2 cost time: 63.83143162727356
Epoch: 2, Steps: 208 | Train Loss: 3.181 Vali Loss: 4.265 Vali Acc: 0.089 Test Loss: 4.265 Test Acc: 0.089
Validation loss decreased (-0.073330 --> -0.088535).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3842125
	speed: 0.7246s/iter; left time: 14699.0710s
	iters: 200, epoch: 3 | loss: 3.2397947
	speed: 0.3004s/iter; left time: 6062.8279s
Epoch: 3 cost time: 63.84158205986023
Epoch: 3, Steps: 208 | Train Loss: 2.557 Vali Loss: 4.304 Vali Acc: 0.083 Test Loss: 4.304 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2582569
	speed: 0.6583s/iter; left time: 13216.9511s
	iters: 200, epoch: 4 | loss: 2.3035083
	speed: 0.3013s/iter; left time: 6018.3516s
Epoch: 4 cost time: 61.95693922042847
Epoch: 4, Steps: 208 | Train Loss: 1.930 Vali Loss: 5.234 Vali Acc: 0.098 Test Loss: 5.234 Test Acc: 0.098
Validation loss decreased (-0.088535 --> -0.098367).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2517707
	speed: 0.6945s/iter; left time: 13799.0020s
	iters: 200, epoch: 5 | loss: 2.6160440
	speed: 0.2902s/iter; left time: 5737.9197s
Epoch: 5 cost time: 61.338722467422485
Epoch: 5, Steps: 208 | Train Loss: 1.374 Vali Loss: 5.660 Vali Acc: 0.094 Test Loss: 5.660 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8179236
	speed: 0.6915s/iter; left time: 13595.2823s
	iters: 200, epoch: 6 | loss: 1.3175348
	speed: 0.3107s/iter; left time: 6077.0923s
Epoch: 6 cost time: 65.46798491477966
Epoch: 6, Steps: 208 | Train Loss: 1.044 Vali Loss: 6.465 Vali Acc: 0.096 Test Loss: 6.465 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9950024
	speed: 0.7096s/iter; left time: 13803.9170s
	iters: 200, epoch: 7 | loss: 0.7871968
	speed: 0.2800s/iter; left time: 5417.9286s
Epoch: 7 cost time: 61.61791801452637
Epoch: 7, Steps: 208 | Train Loss: 0.797 Vali Loss: 7.341 Vali Acc: 0.096 Test Loss: 7.341 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2702444
	speed: 0.7015s/iter; left time: 13500.3767s
	iters: 200, epoch: 8 | loss: 0.3991790
	speed: 0.3040s/iter; left time: 5819.6380s
Epoch: 8 cost time: 63.803534269332886
Epoch: 8, Steps: 208 | Train Loss: 0.636 Vali Loss: 7.948 Vali Acc: 0.097 Test Loss: 7.948 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2699777
	speed: 0.6636s/iter; left time: 12633.7371s
	iters: 200, epoch: 9 | loss: 0.3918130
	speed: 0.3114s/iter; left time: 5896.8370s
Epoch: 9 cost time: 62.749711751937866
Epoch: 9, Steps: 208 | Train Loss: 0.550 Vali Loss: 8.332 Vali Acc: 0.083 Test Loss: 8.332 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5632412
	speed: 0.7437s/iter; left time: 14002.8590s
	iters: 200, epoch: 10 | loss: 0.1200499
	speed: 0.3103s/iter; left time: 5811.8269s
Epoch: 10 cost time: 65.30382037162781
Epoch: 10, Steps: 208 | Train Loss: 0.462 Vali Loss: 8.801 Vali Acc: 0.094 Test Loss: 8.801 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1268607
	speed: 0.6742s/iter; left time: 12554.7556s
	iters: 200, epoch: 11 | loss: 0.5846642
	speed: 0.2833s/iter; left time: 5247.3407s
Epoch: 11 cost time: 60.627641439437866
Epoch: 11, Steps: 208 | Train Loss: 0.398 Vali Loss: 9.491 Vali Acc: 0.083 Test Loss: 9.491 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2273628
	speed: 0.6546s/iter; left time: 12053.7582s
	iters: 200, epoch: 12 | loss: 0.5898616
	speed: 0.2609s/iter; left time: 4777.9678s
Epoch: 12 cost time: 56.32478928565979
Epoch: 12, Steps: 208 | Train Loss: 0.356 Vali Loss: 9.585 Vali Acc: 0.093 Test Loss: 9.585 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.8714206
	speed: 0.6854s/iter; left time: 12478.1275s
	iters: 200, epoch: 13 | loss: 0.3632538
	speed: 0.2957s/iter; left time: 5352.9884s
Epoch: 13 cost time: 61.666966676712036
Epoch: 13, Steps: 208 | Train Loss: 0.308 Vali Loss: 10.056 Vali Acc: 0.089 Test Loss: 10.056 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0819976
	speed: 0.7102s/iter; left time: 12781.9711s
	iters: 200, epoch: 14 | loss: 0.1557055
	speed: 0.3012s/iter; left time: 5391.2494s
Epoch: 14 cost time: 63.82933187484741
Epoch: 14, Steps: 208 | Train Loss: 0.304 Vali Loss: 10.051 Vali Acc: 0.089 Test Loss: 10.051 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09841932597673725
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3754921
	speed: 0.3040s/iter; left time: 6292.1987s
	iters: 200, epoch: 1 | loss: 3.6509104
	speed: 0.2852s/iter; left time: 5874.5230s
Epoch: 1 cost time: 61.2395453453064
Epoch: 1, Steps: 208 | Train Loss: 3.810 Vali Loss: 3.717 Vali Acc: 0.078 Test Loss: 3.717 Test Acc: 0.078
Validation loss decreased (inf --> -0.078102).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5830693
	speed: 0.6676s/iter; left time: 13680.1434s
	iters: 200, epoch: 2 | loss: 3.6346941
	speed: 0.2939s/iter; left time: 5994.2089s
Epoch: 2 cost time: 61.84280586242676
Epoch: 2, Steps: 208 | Train Loss: 3.174 Vali Loss: 4.235 Vali Acc: 0.082 Test Loss: 4.235 Test Acc: 0.082
Validation loss decreased (-0.078102 --> -0.082272).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5368047
	speed: 0.6604s/iter; left time: 13397.0060s
	iters: 200, epoch: 3 | loss: 2.9189317
	speed: 0.2875s/iter; left time: 5803.5444s
Epoch: 3 cost time: 59.637821674346924
Epoch: 3, Steps: 208 | Train Loss: 2.545 Vali Loss: 4.272 Vali Acc: 0.080 Test Loss: 4.272 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1147981
	speed: 0.6929s/iter; left time: 13912.2288s
	iters: 200, epoch: 4 | loss: 2.3534744
	speed: 0.2944s/iter; left time: 5882.0219s
Epoch: 4 cost time: 62.513359785079956
Epoch: 4, Steps: 208 | Train Loss: 1.885 Vali Loss: 5.334 Vali Acc: 0.091 Test Loss: 5.334 Test Acc: 0.091
Validation loss decreased (-0.082272 --> -0.090910).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3749560
	speed: 0.6840s/iter; left time: 13590.5261s
	iters: 200, epoch: 5 | loss: 2.5832536
	speed: 0.2959s/iter; left time: 5850.4135s
Epoch: 5 cost time: 61.280089378356934
Epoch: 5, Steps: 208 | Train Loss: 1.378 Vali Loss: 5.725 Vali Acc: 0.088 Test Loss: 5.725 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5429292
	speed: 0.6901s/iter; left time: 13567.0828s
	iters: 200, epoch: 6 | loss: 1.3118432
	speed: 0.2814s/iter; left time: 5504.4409s
Epoch: 6 cost time: 59.95579171180725
Epoch: 6, Steps: 208 | Train Loss: 1.057 Vali Loss: 6.592 Vali Acc: 0.082 Test Loss: 6.592 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9630734
	speed: 0.6646s/iter; left time: 12929.3905s
	iters: 200, epoch: 7 | loss: 0.7427101
	speed: 0.3078s/iter; left time: 5957.6329s
Epoch: 7 cost time: 62.84779071807861
Epoch: 7, Steps: 208 | Train Loss: 0.796 Vali Loss: 7.165 Vali Acc: 0.092 Test Loss: 7.165 Test Acc: 0.092
Validation loss decreased (-0.090910 --> -0.091786).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6398522
	speed: 0.6847s/iter; left time: 13176.5990s
	iters: 200, epoch: 8 | loss: 1.3690393
	speed: 0.2907s/iter; left time: 5565.6628s
Epoch: 8 cost time: 60.535194396972656
Epoch: 8, Steps: 208 | Train Loss: 0.663 Vali Loss: 7.590 Vali Acc: 0.082 Test Loss: 7.590 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1460748
	speed: 0.6754s/iter; left time: 12856.9982s
	iters: 200, epoch: 9 | loss: 0.4290479
	speed: 0.2977s/iter; left time: 5636.7602s
Epoch: 9 cost time: 61.82716703414917
Epoch: 9, Steps: 208 | Train Loss: 0.573 Vali Loss: 8.562 Vali Acc: 0.080 Test Loss: 8.562 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7394762
	speed: 0.6777s/iter; left time: 12759.5114s
	iters: 200, epoch: 10 | loss: 0.8173904
	speed: 0.2737s/iter; left time: 5126.6367s
Epoch: 10 cost time: 58.712952613830566
Epoch: 10, Steps: 208 | Train Loss: 0.461 Vali Loss: 9.064 Vali Acc: 0.086 Test Loss: 9.064 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0525188
	speed: 0.6865s/iter; left time: 12782.3917s
	iters: 200, epoch: 11 | loss: 0.3007210
	speed: 0.2826s/iter; left time: 5234.9266s
Epoch: 11 cost time: 59.958815813064575
Epoch: 11, Steps: 208 | Train Loss: 0.439 Vali Loss: 9.232 Vali Acc: 0.085 Test Loss: 9.232 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3745041
	speed: 0.6798s/iter; left time: 12517.0883s
	iters: 200, epoch: 12 | loss: 0.5025879
	speed: 0.2768s/iter; left time: 5069.5438s
Epoch: 12 cost time: 58.69444561004639
Epoch: 12, Steps: 208 | Train Loss: 0.350 Vali Loss: 9.468 Vali Acc: 0.078 Test Loss: 9.468 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.5009948
	speed: 0.6614s/iter; left time: 12040.7142s
	iters: 200, epoch: 13 | loss: 0.0253711
	speed: 0.2723s/iter; left time: 4929.9086s
Epoch: 13 cost time: 58.49881649017334
Epoch: 13, Steps: 208 | Train Loss: 0.326 Vali Loss: 10.239 Vali Acc: 0.080 Test Loss: 10.239 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.6279982
	speed: 0.6469s/iter; left time: 11642.1870s
	iters: 200, epoch: 14 | loss: 0.2531960
	speed: 0.2952s/iter; left time: 5282.7567s
Epoch: 14 cost time: 59.85188388824463
Epoch: 14, Steps: 208 | Train Loss: 0.270 Vali Loss: 10.415 Vali Acc: 0.085 Test Loss: 10.415 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0921134
	speed: 0.6813s/iter; left time: 12118.9920s
	iters: 200, epoch: 15 | loss: 0.3019217
	speed: 0.2730s/iter; left time: 4828.9574s
Epoch: 15 cost time: 57.41455316543579
Epoch: 15, Steps: 208 | Train Loss: 0.281 Vali Loss: 10.381 Vali Acc: 0.084 Test Loss: 10.381 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0032219
	speed: 0.6596s/iter; left time: 11595.5585s
	iters: 200, epoch: 16 | loss: 0.6234553
	speed: 0.2789s/iter; left time: 4875.6234s
Epoch: 16 cost time: 58.71113586425781
Epoch: 16, Steps: 208 | Train Loss: 0.236 Vali Loss: 10.940 Vali Acc: 0.079 Test Loss: 10.940 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1597180
	speed: 0.6452s/iter; left time: 11208.7796s
	iters: 200, epoch: 17 | loss: 0.0390297
	speed: 0.2608s/iter; left time: 4504.2046s
Epoch: 17 cost time: 55.858017921447754
Epoch: 17, Steps: 208 | Train Loss: 0.227 Vali Loss: 10.866 Vali Acc: 0.083 Test Loss: 10.866 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0918580375782881
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3211446
	speed: 0.3255s/iter; left time: 6737.7795s
	iters: 200, epoch: 1 | loss: 3.6736097
	speed: 0.3046s/iter; left time: 6275.5831s
Epoch: 1 cost time: 65.73822379112244
Epoch: 1, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.642 Vali Acc: 0.080 Test Loss: 3.642 Test Acc: 0.080
Validation loss decreased (inf --> -0.079594).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1468537
	speed: 0.7463s/iter; left time: 15293.7634s
	iters: 200, epoch: 2 | loss: 4.0248322
	speed: 0.3147s/iter; left time: 6418.4384s
Epoch: 2 cost time: 66.82852697372437
Epoch: 2, Steps: 208 | Train Loss: 3.182 Vali Loss: 4.282 Vali Acc: 0.087 Test Loss: 4.282 Test Acc: 0.087
Validation loss decreased (-0.079594 --> -0.087043).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2166903
	speed: 0.7068s/iter; left time: 14336.5456s
	iters: 200, epoch: 3 | loss: 3.1158841
	speed: 0.3144s/iter; left time: 6345.8293s
Epoch: 3 cost time: 65.29020810127258
Epoch: 3, Steps: 208 | Train Loss: 2.541 Vali Loss: 4.239 Vali Acc: 0.086 Test Loss: 4.239 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9643285
	speed: 0.7195s/iter; left time: 14446.1941s
	iters: 200, epoch: 4 | loss: 1.8940066
	speed: 0.2945s/iter; left time: 5883.3206s
Epoch: 4 cost time: 62.76462388038635
Epoch: 4, Steps: 208 | Train Loss: 1.895 Vali Loss: 5.298 Vali Acc: 0.101 Test Loss: 5.298 Test Acc: 0.101
Validation loss decreased (-0.087043 --> -0.100454).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3749934
	speed: 0.7455s/iter; left time: 14812.7123s
	iters: 200, epoch: 5 | loss: 2.4788382
	speed: 0.2929s/iter; left time: 5789.4284s
Epoch: 5 cost time: 64.23131680488586
Epoch: 5, Steps: 208 | Train Loss: 1.361 Vali Loss: 5.631 Vali Acc: 0.100 Test Loss: 5.631 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6621867
	speed: 0.7329s/iter; left time: 14409.9543s
	iters: 200, epoch: 6 | loss: 0.6950183
	speed: 0.2981s/iter; left time: 5830.3857s
Epoch: 6 cost time: 64.95319437980652
Epoch: 6, Steps: 208 | Train Loss: 1.014 Vali Loss: 6.590 Vali Acc: 0.098 Test Loss: 6.590 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1161906
	speed: 0.7056s/iter; left time: 13725.8549s
	iters: 200, epoch: 7 | loss: 0.2769510
	speed: 0.3208s/iter; left time: 6207.7150s
Epoch: 7 cost time: 65.27541136741638
Epoch: 7, Steps: 208 | Train Loss: 0.765 Vali Loss: 6.975 Vali Acc: 0.098 Test Loss: 6.975 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6665673
	speed: 0.7020s/iter; left time: 13509.2597s
	iters: 200, epoch: 8 | loss: 0.5897614
	speed: 0.3105s/iter; left time: 5944.7060s
Epoch: 8 cost time: 62.312286376953125
Epoch: 8, Steps: 208 | Train Loss: 0.683 Vali Loss: 7.603 Vali Acc: 0.094 Test Loss: 7.603 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4156106
	speed: 0.7436s/iter; left time: 14155.6135s
	iters: 200, epoch: 9 | loss: 0.3442273
	speed: 0.3022s/iter; left time: 5723.4361s
Epoch: 9 cost time: 64.54140043258667
Epoch: 9, Steps: 208 | Train Loss: 0.508 Vali Loss: 8.564 Vali Acc: 0.092 Test Loss: 8.564 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.8658099
	speed: 0.7026s/iter; left time: 13229.4037s
	iters: 200, epoch: 10 | loss: 0.4605965
	speed: 0.3037s/iter; left time: 5688.5984s
Epoch: 10 cost time: 64.3524079322815
Epoch: 10, Steps: 208 | Train Loss: 0.477 Vali Loss: 8.881 Vali Acc: 0.084 Test Loss: 8.881 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0903254
	speed: 0.7148s/iter; left time: 13310.8119s
	iters: 200, epoch: 11 | loss: 1.0155975
	speed: 0.3155s/iter; left time: 5844.0909s
Epoch: 11 cost time: 65.45555686950684
Epoch: 11, Steps: 208 | Train Loss: 0.419 Vali Loss: 8.977 Vali Acc: 0.084 Test Loss: 8.977 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.5839816
	speed: 0.7146s/iter; left time: 13158.5502s
	iters: 200, epoch: 12 | loss: 0.1340128
	speed: 0.3106s/iter; left time: 5688.4773s
Epoch: 12 cost time: 64.61855673789978
Epoch: 12, Steps: 208 | Train Loss: 0.359 Vali Loss: 9.568 Vali Acc: 0.084 Test Loss: 9.568 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5012909
	speed: 0.7191s/iter; left time: 13092.0779s
	iters: 200, epoch: 13 | loss: 0.0954434
	speed: 0.3044s/iter; left time: 5511.0486s
Epoch: 13 cost time: 63.825727701187134
Epoch: 13, Steps: 208 | Train Loss: 0.307 Vali Loss: 10.292 Vali Acc: 0.085 Test Loss: 10.292 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.5350532
	speed: 0.7268s/iter; left time: 13080.4488s
	iters: 200, epoch: 14 | loss: 0.4276972
	speed: 0.2999s/iter; left time: 5367.3444s
Epoch: 14 cost time: 64.90999293327332
Epoch: 14, Steps: 208 | Train Loss: 0.298 Vali Loss: 10.095 Vali Acc: 0.085 Test Loss: 10.095 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10050700864897107
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.1753290
	speed: 0.3118s/iter; left time: 6454.5302s
	iters: 200, epoch: 1 | loss: 3.7401342
	speed: 0.2961s/iter; left time: 6099.8452s
Epoch: 1 cost time: 63.373364210128784
Epoch: 1, Steps: 208 | Train Loss: 3.746 Vali Loss: 3.938 Vali Acc: 0.072 Test Loss: 3.938 Test Acc: 0.072
Validation loss decreased (inf --> -0.071538).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3396223
	speed: 0.6973s/iter; left time: 14290.2491s
	iters: 200, epoch: 2 | loss: 4.1747088
	speed: 0.3037s/iter; left time: 6193.4820s
Epoch: 2 cost time: 63.01618814468384
Epoch: 2, Steps: 208 | Train Loss: 3.183 Vali Loss: 4.486 Vali Acc: 0.076 Test Loss: 4.486 Test Acc: 0.076
Validation loss decreased (-0.071538 --> -0.076006).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6579237
	speed: 0.6979s/iter; left time: 14157.6337s
	iters: 200, epoch: 3 | loss: 3.1384058
	speed: 0.3041s/iter; left time: 6138.1946s
Epoch: 3 cost time: 63.40777778625488
Epoch: 3, Steps: 208 | Train Loss: 2.588 Vali Loss: 4.845 Vali Acc: 0.085 Test Loss: 4.845 Test Acc: 0.085
Validation loss decreased (-0.076006 --> -0.084652).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0931258
	speed: 0.6786s/iter; left time: 13625.1551s
	iters: 200, epoch: 4 | loss: 2.4953656
	speed: 0.2682s/iter; left time: 5357.2260s
Epoch: 4 cost time: 56.89403414726257
Epoch: 4, Steps: 208 | Train Loss: 1.995 Vali Loss: 5.452 Vali Acc: 0.091 Test Loss: 5.452 Test Acc: 0.091
Validation loss decreased (-0.084652 --> -0.090611).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1917520
	speed: 0.6664s/iter; left time: 13240.6293s
	iters: 200, epoch: 5 | loss: 1.8053815
	speed: 0.2631s/iter; left time: 5200.7919s
Epoch: 5 cost time: 56.55144739151001
Epoch: 5, Steps: 208 | Train Loss: 1.424 Vali Loss: 5.823 Vali Acc: 0.078 Test Loss: 5.823 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0351877
	speed: 0.6502s/iter; left time: 12782.9165s
	iters: 200, epoch: 6 | loss: 1.3424259
	speed: 0.2861s/iter; left time: 5595.6105s
Epoch: 6 cost time: 59.28343057632446
Epoch: 6, Steps: 208 | Train Loss: 1.165 Vali Loss: 6.297 Vali Acc: 0.079 Test Loss: 6.297 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0028394
	speed: 0.6655s/iter; left time: 12946.1477s
	iters: 200, epoch: 7 | loss: 1.0303594
	speed: 0.3029s/iter; left time: 5861.3014s
Epoch: 7 cost time: 61.90164232254028
Epoch: 7, Steps: 208 | Train Loss: 0.873 Vali Loss: 7.014 Vali Acc: 0.083 Test Loss: 7.014 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2181522
	speed: 0.6928s/iter; left time: 13333.4280s
	iters: 200, epoch: 8 | loss: 1.3627431
	speed: 0.2677s/iter; left time: 5124.3039s
Epoch: 8 cost time: 58.79169702529907
Epoch: 8, Steps: 208 | Train Loss: 0.765 Vali Loss: 7.234 Vali Acc: 0.089 Test Loss: 7.234 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2074674
	speed: 0.6589s/iter; left time: 12544.1953s
	iters: 200, epoch: 9 | loss: 0.6507013
	speed: 0.2813s/iter; left time: 5326.9407s
Epoch: 9 cost time: 58.87868905067444
Epoch: 9, Steps: 208 | Train Loss: 0.611 Vali Loss: 7.773 Vali Acc: 0.093 Test Loss: 7.773 Test Acc: 0.093
Validation loss decreased (-0.090611 --> -0.092675).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9277803
	speed: 0.6682s/iter; left time: 12580.8680s
	iters: 200, epoch: 10 | loss: 1.1251969
	speed: 0.2927s/iter; left time: 5481.9357s
Epoch: 10 cost time: 60.76677751541138
Epoch: 10, Steps: 208 | Train Loss: 0.553 Vali Loss: 8.747 Vali Acc: 0.091 Test Loss: 8.747 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1972290
	speed: 0.6685s/iter; left time: 12449.0204s
	iters: 200, epoch: 11 | loss: 0.0890798
	speed: 0.2686s/iter; left time: 4974.6637s
Epoch: 11 cost time: 56.84425759315491
Epoch: 11, Steps: 208 | Train Loss: 0.457 Vali Loss: 8.955 Vali Acc: 0.091 Test Loss: 8.955 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1934278
	speed: 0.6742s/iter; left time: 12413.2387s
	iters: 200, epoch: 12 | loss: 0.3384296
	speed: 0.2923s/iter; left time: 5352.8446s
Epoch: 12 cost time: 61.13127040863037
Epoch: 12, Steps: 208 | Train Loss: 0.403 Vali Loss: 8.853 Vali Acc: 0.090 Test Loss: 8.853 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2225218
	speed: 0.6906s/iter; left time: 12572.5729s
	iters: 200, epoch: 13 | loss: 0.2833548
	speed: 0.3055s/iter; left time: 5531.8106s
Epoch: 13 cost time: 62.7022647857666
Epoch: 13, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.481 Vali Acc: 0.086 Test Loss: 9.481 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0972769
	speed: 0.6967s/iter; left time: 12538.7528s
	iters: 200, epoch: 14 | loss: 0.0863225
	speed: 0.2734s/iter; left time: 4892.9405s
Epoch: 14 cost time: 57.79059386253357
Epoch: 14, Steps: 208 | Train Loss: 0.325 Vali Loss: 9.114 Vali Acc: 0.087 Test Loss: 9.114 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2111464
	speed: 0.6836s/iter; left time: 12161.1642s
	iters: 200, epoch: 15 | loss: 0.1686051
	speed: 0.2914s/iter; left time: 5155.1945s
Epoch: 15 cost time: 60.93165063858032
Epoch: 15, Steps: 208 | Train Loss: 0.290 Vali Loss: 9.926 Vali Acc: 0.090 Test Loss: 9.926 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2288671
	speed: 0.6411s/iter; left time: 11271.5972s
	iters: 200, epoch: 16 | loss: 0.6213335
	speed: 0.2839s/iter; left time: 4962.4770s
Epoch: 16 cost time: 58.196305990219116
Epoch: 16, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.188 Vali Acc: 0.089 Test Loss: 10.188 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3696330
	speed: 0.6913s/iter; left time: 12010.1807s
	iters: 200, epoch: 17 | loss: 0.0542471
	speed: 0.2718s/iter; left time: 4695.3329s
Epoch: 17 cost time: 58.92174553871155
Epoch: 17, Steps: 208 | Train Loss: 0.269 Vali Loss: 10.233 Vali Acc: 0.087 Test Loss: 10.233 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5416301
	speed: 0.6711s/iter; left time: 11519.4592s
	iters: 200, epoch: 18 | loss: 0.0783180
	speed: 0.2609s/iter; left time: 4451.6448s
Epoch: 18 cost time: 56.78789734840393
Epoch: 18, Steps: 208 | Train Loss: 0.264 Vali Loss: 10.072 Vali Acc: 0.095 Test Loss: 10.072 Test Acc: 0.095
Validation loss decreased (-0.092675 --> -0.095038).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0662042
	speed: 0.6205s/iter; left time: 10522.4776s
	iters: 200, epoch: 19 | loss: 0.4182336
	speed: 0.2803s/iter; left time: 4725.1076s
Epoch: 19 cost time: 56.90789079666138
Epoch: 19, Steps: 208 | Train Loss: 0.220 Vali Loss: 11.100 Vali Acc: 0.083 Test Loss: 11.100 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0322399
	speed: 0.6550s/iter; left time: 10970.8741s
	iters: 200, epoch: 20 | loss: 0.0871900
	speed: 0.2701s/iter; left time: 4497.4206s
Epoch: 20 cost time: 57.00742316246033
Epoch: 20, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.355 Vali Acc: 0.091 Test Loss: 11.355 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2511030
	speed: 0.7037s/iter; left time: 11640.6367s
	iters: 200, epoch: 21 | loss: 0.1174313
	speed: 0.2879s/iter; left time: 4732.7063s
Epoch: 21 cost time: 62.657838106155396
Epoch: 21, Steps: 208 | Train Loss: 0.218 Vali Loss: 10.944 Vali Acc: 0.082 Test Loss: 10.944 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.2514772
	speed: 0.6758s/iter; left time: 11037.4706s
	iters: 200, epoch: 22 | loss: 0.2576052
	speed: 0.2955s/iter; left time: 4796.8222s
Epoch: 22 cost time: 60.535425662994385
Epoch: 22, Steps: 208 | Train Loss: 0.212 Vali Loss: 10.676 Vali Acc: 0.089 Test Loss: 10.676 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1024630
	speed: 0.6498s/iter; left time: 10478.5242s
	iters: 200, epoch: 23 | loss: 0.6014001
	speed: 0.2866s/iter; left time: 4592.8184s
Epoch: 23 cost time: 58.634544372558594
Epoch: 23, Steps: 208 | Train Loss: 0.212 Vali Loss: 11.412 Vali Acc: 0.087 Test Loss: 11.412 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0754649
	speed: 0.6863s/iter; left time: 10924.0965s
	iters: 200, epoch: 24 | loss: 0.2011626
	speed: 0.2737s/iter; left time: 4329.6267s
Epoch: 24 cost time: 57.91729521751404
Epoch: 24, Steps: 208 | Train Loss: 0.186 Vali Loss: 11.755 Vali Acc: 0.089 Test Loss: 11.755 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0082365
	speed: 0.6897s/iter; left time: 10834.9656s
	iters: 200, epoch: 25 | loss: 0.0691430
	speed: 0.2909s/iter; left time: 4541.1616s
Epoch: 25 cost time: 60.670639753341675
Epoch: 25, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.318 Vali Acc: 0.084 Test Loss: 11.318 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0590088
	speed: 0.6661s/iter; left time: 10324.7268s
	iters: 200, epoch: 26 | loss: 0.1525323
	speed: 0.2738s/iter; left time: 4216.4249s
Epoch: 26 cost time: 58.94268441200256
Epoch: 26, Steps: 208 | Train Loss: 0.163 Vali Loss: 11.610 Vali Acc: 0.087 Test Loss: 11.610 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.8400682
	speed: 0.6967s/iter; left time: 10654.7104s
	iters: 200, epoch: 27 | loss: 0.1107724
	speed: 0.2812s/iter; left time: 4271.7007s
Epoch: 27 cost time: 60.20474195480347
Epoch: 27, Steps: 208 | Train Loss: 0.155 Vali Loss: 11.839 Vali Acc: 0.090 Test Loss: 11.839 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.7539955
	speed: 0.7241s/iter; left time: 10923.6967s
	iters: 200, epoch: 28 | loss: 0.2007329
	speed: 0.2968s/iter; left time: 4447.9031s
Epoch: 28 cost time: 63.504709005355835
Epoch: 28, Steps: 208 | Train Loss: 0.157 Vali Loss: 11.997 Vali Acc: 0.091 Test Loss: 11.997 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09513868177751268
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3694737
	speed: 0.3101s/iter; left time: 6418.7569s
	iters: 200, epoch: 1 | loss: 3.8809371
	speed: 0.2769s/iter; left time: 5704.4174s
Epoch: 1 cost time: 61.2822642326355
Epoch: 1, Steps: 208 | Train Loss: 3.699 Vali Loss: 4.228 Vali Acc: 0.072 Test Loss: 4.228 Test Acc: 0.072
Validation loss decreased (inf --> -0.071834).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7235887
	speed: 0.6940s/iter; left time: 14222.4487s
	iters: 200, epoch: 2 | loss: 3.6907454
	speed: 0.2981s/iter; left time: 6079.3947s
Epoch: 2 cost time: 62.30241322517395
Epoch: 2, Steps: 208 | Train Loss: 3.202 Vali Loss: 4.834 Vali Acc: 0.075 Test Loss: 4.834 Test Acc: 0.075
Validation loss decreased (-0.071834 --> -0.075108).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0827816
	speed: 0.7211s/iter; left time: 14627.6114s
	iters: 200, epoch: 3 | loss: 3.0672321
	speed: 0.2938s/iter; left time: 5930.9343s
Epoch: 3 cost time: 63.27312350273132
Epoch: 3, Steps: 208 | Train Loss: 2.720 Vali Loss: 5.249 Vali Acc: 0.085 Test Loss: 5.249 Test Acc: 0.085
Validation loss decreased (-0.075108 --> -0.085244).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2829866
	speed: 0.6941s/iter; left time: 13935.9704s
	iters: 200, epoch: 4 | loss: 2.6194003
	speed: 0.2869s/iter; left time: 5731.7500s
Epoch: 4 cost time: 61.124693155288696
Epoch: 4, Steps: 208 | Train Loss: 2.275 Vali Loss: 5.947 Vali Acc: 0.097 Test Loss: 5.947 Test Acc: 0.097
Validation loss decreased (-0.085244 --> -0.096869).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8005966
	speed: 0.6811s/iter; left time: 13533.4503s
	iters: 200, epoch: 5 | loss: 3.1161535
	speed: 0.2857s/iter; left time: 5648.5818s
Epoch: 5 cost time: 60.97085666656494
Epoch: 5, Steps: 208 | Train Loss: 1.837 Vali Loss: 6.154 Vali Acc: 0.096 Test Loss: 6.154 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3619875
	speed: 0.6952s/iter; left time: 13667.7977s
	iters: 200, epoch: 6 | loss: 1.2313765
	speed: 0.2972s/iter; left time: 5813.0186s
Epoch: 6 cost time: 63.7651641368866
Epoch: 6, Steps: 208 | Train Loss: 1.489 Vali Loss: 6.405 Vali Acc: 0.097 Test Loss: 6.405 Test Acc: 0.097
Validation loss decreased (-0.096869 --> -0.097162).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0230169
	speed: 0.6886s/iter; left time: 13395.6795s
	iters: 200, epoch: 7 | loss: 0.8264706
	speed: 0.2995s/iter; left time: 5796.2828s
Epoch: 7 cost time: 62.88265037536621
Epoch: 7, Steps: 208 | Train Loss: 1.184 Vali Loss: 7.243 Vali Acc: 0.088 Test Loss: 7.243 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8441541
	speed: 0.6908s/iter; left time: 13294.5857s
	iters: 200, epoch: 8 | loss: 1.4249972
	speed: 0.3099s/iter; left time: 5933.6591s
Epoch: 8 cost time: 63.88980722427368
Epoch: 8, Steps: 208 | Train Loss: 0.976 Vali Loss: 7.193 Vali Acc: 0.092 Test Loss: 7.193 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5539385
	speed: 0.7120s/iter; left time: 13555.1357s
	iters: 200, epoch: 9 | loss: 0.8066710
	speed: 0.3214s/iter; left time: 6086.2442s
Epoch: 9 cost time: 66.88241410255432
Epoch: 9, Steps: 208 | Train Loss: 0.857 Vali Loss: 7.435 Vali Acc: 0.095 Test Loss: 7.435 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1378700
	speed: 0.7035s/iter; left time: 13246.1805s
	iters: 200, epoch: 10 | loss: 1.2906671
	speed: 0.3131s/iter; left time: 5863.6823s
Epoch: 10 cost time: 65.0154345035553
Epoch: 10, Steps: 208 | Train Loss: 0.690 Vali Loss: 8.196 Vali Acc: 0.095 Test Loss: 8.196 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2984897
	speed: 0.7181s/iter; left time: 13371.9725s
	iters: 200, epoch: 11 | loss: 0.5926492
	speed: 0.3255s/iter; left time: 6028.6980s
Epoch: 11 cost time: 66.48900961875916
Epoch: 11, Steps: 208 | Train Loss: 0.583 Vali Loss: 8.258 Vali Acc: 0.090 Test Loss: 8.258 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6886122
	speed: 0.7204s/iter; left time: 13264.7059s
	iters: 200, epoch: 12 | loss: 0.8625183
	speed: 0.3205s/iter; left time: 5869.2168s
Epoch: 12 cost time: 66.2524995803833
Epoch: 12, Steps: 208 | Train Loss: 0.580 Vali Loss: 8.687 Vali Acc: 0.082 Test Loss: 8.687 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1319708
	speed: 0.7020s/iter; left time: 12779.7566s
	iters: 200, epoch: 13 | loss: 0.5588843
	speed: 0.3126s/iter; left time: 5659.7853s
Epoch: 13 cost time: 63.75523281097412
Epoch: 13, Steps: 208 | Train Loss: 0.491 Vali Loss: 8.894 Vali Acc: 0.089 Test Loss: 8.894 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.8021505
	speed: 0.7194s/iter; left time: 12947.6113s
	iters: 200, epoch: 14 | loss: 0.2677104
	speed: 0.3128s/iter; left time: 5599.0045s
Epoch: 14 cost time: 65.00136303901672
Epoch: 14, Steps: 208 | Train Loss: 0.432 Vali Loss: 8.673 Vali Acc: 0.103 Test Loss: 8.673 Test Acc: 0.103
Validation loss decreased (-0.097162 --> -0.103104).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4848031
	speed: 0.7278s/iter; left time: 12946.3211s
	iters: 200, epoch: 15 | loss: 0.5973550
	speed: 0.2953s/iter; left time: 5223.3860s
Epoch: 15 cost time: 63.08092927932739
Epoch: 15, Steps: 208 | Train Loss: 0.384 Vali Loss: 9.615 Vali Acc: 0.089 Test Loss: 9.615 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2003418
	speed: 0.6955s/iter; left time: 12228.1926s
	iters: 200, epoch: 16 | loss: 1.0845916
	speed: 0.3084s/iter; left time: 5390.4214s
Epoch: 16 cost time: 62.74073386192322
Epoch: 16, Steps: 208 | Train Loss: 0.349 Vali Loss: 9.907 Vali Acc: 0.091 Test Loss: 9.907 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5332678
	speed: 0.7068s/iter; left time: 12279.1150s
	iters: 200, epoch: 17 | loss: 0.1785306
	speed: 0.2932s/iter; left time: 5065.0029s
Epoch: 17 cost time: 62.03612422943115
Epoch: 17, Steps: 208 | Train Loss: 0.320 Vali Loss: 9.621 Vali Acc: 0.095 Test Loss: 9.621 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3528434
	speed: 0.7099s/iter; left time: 12184.9596s
	iters: 200, epoch: 18 | loss: 0.1023049
	speed: 0.2815s/iter; left time: 4803.7263s
Epoch: 18 cost time: 60.86731028556824
Epoch: 18, Steps: 208 | Train Loss: 0.299 Vali Loss: 10.143 Vali Acc: 0.101 Test Loss: 10.143 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0096382
	speed: 0.6739s/iter; left time: 11428.0652s
	iters: 200, epoch: 19 | loss: 0.9639766
	speed: 0.2845s/iter; left time: 4796.5768s
Epoch: 19 cost time: 59.73278617858887
Epoch: 19, Steps: 208 | Train Loss: 0.263 Vali Loss: 10.710 Vali Acc: 0.098 Test Loss: 10.710 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3878720
	speed: 0.7025s/iter; left time: 11765.6411s
	iters: 200, epoch: 20 | loss: 0.1699165
	speed: 0.2861s/iter; left time: 4762.7359s
Epoch: 20 cost time: 60.61503553390503
Epoch: 20, Steps: 208 | Train Loss: 0.258 Vali Loss: 10.975 Vali Acc: 0.092 Test Loss: 10.975 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3521770
	speed: 0.6941s/iter; left time: 11481.8680s
	iters: 200, epoch: 21 | loss: 0.1211212
	speed: 0.2887s/iter; left time: 4746.9201s
Epoch: 21 cost time: 62.02235770225525
Epoch: 21, Steps: 208 | Train Loss: 0.243 Vali Loss: 10.122 Vali Acc: 0.091 Test Loss: 10.122 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6880254
	speed: 0.6935s/iter; left time: 11327.5429s
	iters: 200, epoch: 22 | loss: 0.0284752
	speed: 0.2907s/iter; left time: 4718.7235s
Epoch: 22 cost time: 62.56240463256836
Epoch: 22, Steps: 208 | Train Loss: 0.210 Vali Loss: 11.405 Vali Acc: 0.100 Test Loss: 11.405 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1298146
	speed: 0.6862s/iter; left time: 11065.3505s
	iters: 200, epoch: 23 | loss: 0.4048707
	speed: 0.2846s/iter; left time: 4560.2720s
Epoch: 23 cost time: 60.86363697052002
Epoch: 23, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.221 Vali Acc: 0.096 Test Loss: 11.221 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0056237
	speed: 0.6791s/iter; left time: 10808.7847s
	iters: 200, epoch: 24 | loss: 0.0175053
	speed: 0.2926s/iter; left time: 4627.5859s
Epoch: 24 cost time: 62.00753116607666
Epoch: 24, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.635 Vali Acc: 0.097 Test Loss: 11.635 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10319117208470027
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5308104
	speed: 0.3235s/iter; left time: 6695.7663s
	iters: 200, epoch: 1 | loss: 3.5600033
	speed: 0.2929s/iter; left time: 6033.6556s
Epoch: 1 cost time: 64.30551624298096
Epoch: 1, Steps: 208 | Train Loss: 3.686 Vali Loss: 4.054 Vali Acc: 0.068 Test Loss: 4.054 Test Acc: 0.068
Validation loss decreased (inf --> -0.067660).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9457152
	speed: 0.7287s/iter; left time: 14932.5192s
	iters: 200, epoch: 2 | loss: 4.0332413
	speed: 0.2878s/iter; left time: 5869.1105s
Epoch: 2 cost time: 63.38294959068298
Epoch: 2, Steps: 208 | Train Loss: 3.271 Vali Loss: 4.998 Vali Acc: 0.063 Test Loss: 4.998 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3558707
	speed: 0.6686s/iter; left time: 13562.2284s
	iters: 200, epoch: 3 | loss: 2.9882648
	speed: 0.2928s/iter; left time: 5909.2952s
Epoch: 3 cost time: 62.002756118774414
Epoch: 3, Steps: 208 | Train Loss: 2.913 Vali Loss: 5.178 Vali Acc: 0.076 Test Loss: 5.178 Test Acc: 0.076
Validation loss decreased (-0.067660 --> -0.076000).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3181732
	speed: 0.6843s/iter; left time: 13738.8651s
	iters: 200, epoch: 4 | loss: 2.8295162
	speed: 0.2998s/iter; left time: 5989.8576s
Epoch: 4 cost time: 62.54452848434448
Epoch: 4, Steps: 208 | Train Loss: 2.502 Vali Loss: 5.491 Vali Acc: 0.083 Test Loss: 5.491 Test Acc: 0.083
Validation loss decreased (-0.076000 --> -0.083154).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2640843
	speed: 0.7002s/iter; left time: 13913.0187s
	iters: 200, epoch: 5 | loss: 2.5711365
	speed: 0.3003s/iter; left time: 5935.9855s
Epoch: 5 cost time: 64.1282172203064
Epoch: 5, Steps: 208 | Train Loss: 2.089 Vali Loss: 5.711 Vali Acc: 0.089 Test Loss: 5.711 Test Acc: 0.089
Validation loss decreased (-0.083154 --> -0.088819).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9137727
	speed: 0.6589s/iter; left time: 12955.3694s
	iters: 200, epoch: 6 | loss: 1.6771687
	speed: 0.2906s/iter; left time: 5683.7873s
Epoch: 6 cost time: 59.39788842201233
Epoch: 6, Steps: 208 | Train Loss: 1.631 Vali Loss: 6.325 Vali Acc: 0.079 Test Loss: 6.325 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4638634
	speed: 0.7170s/iter; left time: 13948.2221s
	iters: 200, epoch: 7 | loss: 1.3648599
	speed: 0.3156s/iter; left time: 6107.7374s
Epoch: 7 cost time: 65.94366407394409
Epoch: 7, Steps: 208 | Train Loss: 1.288 Vali Loss: 6.601 Vali Acc: 0.084 Test Loss: 6.601 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9290425
	speed: 0.6982s/iter; left time: 13436.1008s
	iters: 200, epoch: 8 | loss: 1.0953989
	speed: 0.2966s/iter; left time: 5677.5764s
Epoch: 8 cost time: 63.27352285385132
Epoch: 8, Steps: 208 | Train Loss: 1.144 Vali Loss: 6.961 Vali Acc: 0.081 Test Loss: 6.961 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0106046
	speed: 0.7081s/iter; left time: 13479.2786s
	iters: 200, epoch: 9 | loss: 1.0183319
	speed: 0.2786s/iter; left time: 5275.1876s
Epoch: 9 cost time: 60.34922122955322
Epoch: 9, Steps: 208 | Train Loss: 0.993 Vali Loss: 7.508 Vali Acc: 0.078 Test Loss: 7.508 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4555019
	speed: 0.7158s/iter; left time: 13476.9026s
	iters: 200, epoch: 10 | loss: 1.0451643
	speed: 0.3018s/iter; left time: 5651.6956s
Epoch: 10 cost time: 63.51811647415161
Epoch: 10, Steps: 208 | Train Loss: 0.760 Vali Loss: 7.627 Vali Acc: 0.077 Test Loss: 7.627 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4656556
	speed: 0.7141s/iter; left time: 13296.8223s
	iters: 200, epoch: 11 | loss: 1.1269686
	speed: 0.3016s/iter; left time: 5585.4575s
Epoch: 11 cost time: 64.57855701446533
Epoch: 11, Steps: 208 | Train Loss: 0.700 Vali Loss: 7.728 Vali Acc: 0.082 Test Loss: 7.728 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7490901
	speed: 0.7218s/iter; left time: 13291.0603s
	iters: 200, epoch: 12 | loss: 1.0119892
	speed: 0.2803s/iter; left time: 5133.8794s
Epoch: 12 cost time: 63.65731120109558
Epoch: 12, Steps: 208 | Train Loss: 0.624 Vali Loss: 7.863 Vali Acc: 0.077 Test Loss: 7.863 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.7169280
	speed: 0.7221s/iter; left time: 13145.7084s
	iters: 200, epoch: 13 | loss: 0.1598700
	speed: 0.3162s/iter; left time: 5724.8313s
Epoch: 13 cost time: 65.38155126571655
Epoch: 13, Steps: 208 | Train Loss: 0.543 Vali Loss: 8.560 Vali Acc: 0.075 Test Loss: 8.560 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3256248
	speed: 0.7142s/iter; left time: 12853.1940s
	iters: 200, epoch: 14 | loss: 0.4770407
	speed: 0.3164s/iter; left time: 5663.3686s
Epoch: 14 cost time: 64.52524638175964
Epoch: 14, Steps: 208 | Train Loss: 0.507 Vali Loss: 8.356 Vali Acc: 0.082 Test Loss: 8.356 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2680486
	speed: 0.6840s/iter; left time: 12167.6922s
	iters: 200, epoch: 15 | loss: 0.5024315
	speed: 0.3012s/iter; left time: 5328.1175s
Epoch: 15 cost time: 63.765937089920044
Epoch: 15, Steps: 208 | Train Loss: 0.460 Vali Loss: 8.737 Vali Acc: 0.081 Test Loss: 8.737 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08887563376081122
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6433845
	speed: 0.3108s/iter; left time: 6433.8038s
	iters: 200, epoch: 1 | loss: 3.8490031
	speed: 0.3161s/iter; left time: 6512.4959s
Epoch: 1 cost time: 65.47770094871521
Epoch: 1, Steps: 208 | Train Loss: 3.708 Vali Loss: 4.349 Vali Acc: 0.033 Test Loss: 4.349 Test Acc: 0.033
Validation loss decreased (inf --> -0.032763).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2406425
	speed: 0.7091s/iter; left time: 14530.8722s
	iters: 200, epoch: 2 | loss: 4.2649288
	speed: 0.2911s/iter; left time: 5935.5136s
Epoch: 2 cost time: 62.40057349205017
Epoch: 2, Steps: 208 | Train Loss: 3.361 Vali Loss: 5.797 Vali Acc: 0.032 Test Loss: 5.797 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3677471
	speed: 0.6769s/iter; left time: 13731.7623s
	iters: 200, epoch: 3 | loss: 3.5229790
	speed: 0.2799s/iter; left time: 5649.9080s
Epoch: 3 cost time: 59.250205278396606
Epoch: 3, Steps: 208 | Train Loss: 3.155 Vali Loss: 5.654 Vali Acc: 0.040 Test Loss: 5.654 Test Acc: 0.040
Validation loss decreased (-0.032763 --> -0.039908).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1412117
	speed: 0.6771s/iter; left time: 13593.7957s
	iters: 200, epoch: 4 | loss: 3.1269925
	speed: 0.2967s/iter; left time: 5927.2545s
Epoch: 4 cost time: 59.8106153011322
Epoch: 4, Steps: 208 | Train Loss: 2.908 Vali Loss: 5.657 Vali Acc: 0.047 Test Loss: 5.657 Test Acc: 0.047
Validation loss decreased (-0.039908 --> -0.046469).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8350873
	speed: 0.7149s/iter; left time: 14203.9122s
	iters: 200, epoch: 5 | loss: 3.5739796
	speed: 0.2925s/iter; left time: 5782.3343s
Epoch: 5 cost time: 62.928823471069336
Epoch: 5, Steps: 208 | Train Loss: 2.600 Vali Loss: 5.371 Vali Acc: 0.064 Test Loss: 5.371 Test Acc: 0.064
Validation loss decreased (-0.046469 --> -0.063770).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0035706
	speed: 0.6931s/iter; left time: 13627.4507s
	iters: 200, epoch: 6 | loss: 2.8839390
	speed: 0.2776s/iter; left time: 5430.9500s
Epoch: 6 cost time: 60.89130735397339
Epoch: 6, Steps: 208 | Train Loss: 2.167 Vali Loss: 5.629 Vali Acc: 0.054 Test Loss: 5.629 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7381768
	speed: 0.6709s/iter; left time: 13050.2259s
	iters: 200, epoch: 7 | loss: 2.0688906
	speed: 0.2790s/iter; left time: 5399.7521s
Epoch: 7 cost time: 58.79283905029297
Epoch: 7, Steps: 208 | Train Loss: 1.778 Vali Loss: 5.628 Vali Acc: 0.082 Test Loss: 5.628 Test Acc: 0.082
Validation loss decreased (-0.063770 --> -0.081960).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8577876
	speed: 0.6634s/iter; left time: 12766.7900s
	iters: 200, epoch: 8 | loss: 2.1052761
	speed: 0.3025s/iter; left time: 5790.5738s
Epoch: 8 cost time: 60.09860706329346
Epoch: 8, Steps: 208 | Train Loss: 1.421 Vali Loss: 6.279 Vali Acc: 0.079 Test Loss: 6.279 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4136018
	speed: 0.6844s/iter; left time: 13029.3921s
	iters: 200, epoch: 9 | loss: 1.0201496
	speed: 0.2811s/iter; left time: 5324.1367s
Epoch: 9 cost time: 60.87765145301819
Epoch: 9, Steps: 208 | Train Loss: 1.171 Vali Loss: 6.412 Vali Acc: 0.071 Test Loss: 6.412 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.8533388
	speed: 0.6890s/iter; left time: 12973.3077s
	iters: 200, epoch: 10 | loss: 1.4715425
	speed: 0.2742s/iter; left time: 5134.6252s
Epoch: 10 cost time: 59.64175462722778
Epoch: 10, Steps: 208 | Train Loss: 0.956 Vali Loss: 7.081 Vali Acc: 0.080 Test Loss: 7.081 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0567714
	speed: 0.6988s/iter; left time: 13012.8747s
	iters: 200, epoch: 11 | loss: 1.0411687
	speed: 0.2873s/iter; left time: 5320.9391s
Epoch: 11 cost time: 59.159379959106445
Epoch: 11, Steps: 208 | Train Loss: 0.775 Vali Loss: 7.565 Vali Acc: 0.081 Test Loss: 7.565 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3442616
	speed: 0.6608s/iter; left time: 12167.8921s
	iters: 200, epoch: 12 | loss: 1.0494838
	speed: 0.2852s/iter; left time: 5222.6672s
Epoch: 12 cost time: 59.28068208694458
Epoch: 12, Steps: 208 | Train Loss: 0.680 Vali Loss: 7.754 Vali Acc: 0.085 Test Loss: 7.754 Test Acc: 0.085
Validation loss decreased (-0.081960 --> -0.084623).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0624341
	speed: 0.6765s/iter; left time: 12316.1288s
	iters: 200, epoch: 13 | loss: 0.9896619
	speed: 0.2943s/iter; left time: 5329.1969s
Epoch: 13 cost time: 63.034727573394775
Epoch: 13, Steps: 208 | Train Loss: 0.618 Vali Loss: 7.973 Vali Acc: 0.078 Test Loss: 7.973 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7119711
	speed: 0.7107s/iter; left time: 12790.4115s
	iters: 200, epoch: 14 | loss: 0.3343518
	speed: 0.2816s/iter; left time: 5039.5479s
Epoch: 14 cost time: 60.198206186294556
Epoch: 14, Steps: 208 | Train Loss: 0.540 Vali Loss: 8.449 Vali Acc: 0.081 Test Loss: 8.449 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2778581
	speed: 0.6551s/iter; left time: 11653.0876s
	iters: 200, epoch: 15 | loss: 1.1343257
	speed: 0.2855s/iter; left time: 5049.3443s
Epoch: 15 cost time: 58.966952085494995
Epoch: 15, Steps: 208 | Train Loss: 0.481 Vali Loss: 8.411 Vali Acc: 0.086 Test Loss: 8.411 Test Acc: 0.086
Validation loss decreased (-0.084623 --> -0.085809).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4042391
	speed: 0.6643s/iter; left time: 11679.2414s
	iters: 200, epoch: 16 | loss: 0.7662014
	speed: 0.2770s/iter; left time: 4841.8861s
Epoch: 16 cost time: 58.42435431480408
Epoch: 16, Steps: 208 | Train Loss: 0.417 Vali Loss: 8.916 Vali Acc: 0.080 Test Loss: 8.916 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2197139
	speed: 0.6535s/iter; left time: 11353.4961s
	iters: 200, epoch: 17 | loss: 0.1468255
	speed: 0.2808s/iter; left time: 4850.9341s
Epoch: 17 cost time: 59.233612060546875
Epoch: 17, Steps: 208 | Train Loss: 0.383 Vali Loss: 9.142 Vali Acc: 0.084 Test Loss: 9.142 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2082335
	speed: 0.6779s/iter; left time: 11636.2928s
	iters: 200, epoch: 18 | loss: 0.2675228
	speed: 0.2745s/iter; left time: 4684.5946s
Epoch: 18 cost time: 57.527698278427124
Epoch: 18, Steps: 208 | Train Loss: 0.378 Vali Loss: 9.070 Vali Acc: 0.075 Test Loss: 9.070 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3533619
	speed: 0.6519s/iter; left time: 11054.6082s
	iters: 200, epoch: 19 | loss: 1.2262576
	speed: 0.2851s/iter; left time: 4805.9428s
Epoch: 19 cost time: 59.392630100250244
Epoch: 19, Steps: 208 | Train Loss: 0.349 Vali Loss: 9.401 Vali Acc: 0.078 Test Loss: 9.401 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1247638
	speed: 0.6409s/iter; left time: 10734.5489s
	iters: 200, epoch: 20 | loss: 0.5404913
	speed: 0.2744s/iter; left time: 4568.9858s
Epoch: 20 cost time: 56.65097260475159
Epoch: 20, Steps: 208 | Train Loss: 0.314 Vali Loss: 9.246 Vali Acc: 0.081 Test Loss: 9.246 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.9035287
	speed: 0.6735s/iter; left time: 11140.8100s
	iters: 200, epoch: 21 | loss: 0.0865295
	speed: 0.2766s/iter; left time: 4547.5961s
Epoch: 21 cost time: 58.85315775871277
Epoch: 21, Steps: 208 | Train Loss: 0.271 Vali Loss: 9.796 Vali Acc: 0.079 Test Loss: 9.796 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4786163
	speed: 0.6576s/iter; left time: 10741.0419s
	iters: 200, epoch: 22 | loss: 0.3494974
	speed: 0.2793s/iter; left time: 4534.4211s
Epoch: 22 cost time: 57.71150469779968
Epoch: 22, Steps: 208 | Train Loss: 0.274 Vali Loss: 10.146 Vali Acc: 0.080 Test Loss: 10.146 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0375161
	speed: 0.6702s/iter; left time: 10807.6043s
	iters: 200, epoch: 23 | loss: 0.4278913
	speed: 0.2717s/iter; left time: 4354.0239s
Epoch: 23 cost time: 57.72949481010437
Epoch: 23, Steps: 208 | Train Loss: 0.239 Vali Loss: 10.110 Vali Acc: 0.076 Test Loss: 10.110 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0930584
	speed: 0.6510s/iter; left time: 10361.4656s
	iters: 200, epoch: 24 | loss: 0.0797028
	speed: 0.2859s/iter; left time: 4522.4567s
Epoch: 24 cost time: 59.77531337738037
Epoch: 24, Steps: 208 | Train Loss: 0.244 Vali Loss: 10.431 Vali Acc: 0.084 Test Loss: 10.431 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.6626685
	speed: 0.6681s/iter; left time: 10494.4208s
	iters: 200, epoch: 25 | loss: 0.3522170
	speed: 0.2673s/iter; left time: 4171.9709s
Epoch: 25 cost time: 56.9192750453949
Epoch: 25, Steps: 208 | Train Loss: 0.237 Vali Loss: 9.741 Vali Acc: 0.081 Test Loss: 9.741 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08589322994333433
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2106335
	speed: 0.2864s/iter; left time: 5928.9840s
	iters: 200, epoch: 1 | loss: 3.7249289
	speed: 0.2739s/iter; left time: 5643.6317s
Epoch: 1 cost time: 58.320722818374634
Epoch: 1, Steps: 208 | Train Loss: 3.676 Vali Loss: 4.834 Vali Acc: 0.036 Test Loss: 4.834 Test Acc: 0.036
Validation loss decreased (inf --> -0.035741).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1585703
	speed: 0.6572s/iter; left time: 13468.1768s
	iters: 200, epoch: 2 | loss: 3.9836280
	speed: 0.2910s/iter; left time: 5934.6590s
Epoch: 2 cost time: 60.62066841125488
Epoch: 2, Steps: 208 | Train Loss: 3.378 Vali Loss: 6.592 Vali Acc: 0.037 Test Loss: 6.592 Test Acc: 0.037
Validation loss decreased (-0.035741 --> -0.036916).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8333755
	speed: 0.6702s/iter; left time: 13595.6719s
	iters: 200, epoch: 3 | loss: 3.4419029
	speed: 0.2775s/iter; left time: 5601.9453s
Epoch: 3 cost time: 58.89663243293762
Epoch: 3, Steps: 208 | Train Loss: 3.328 Vali Loss: 6.392 Vali Acc: 0.037 Test Loss: 6.392 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5491087
	speed: 0.6804s/iter; left time: 13660.0708s
	iters: 200, epoch: 4 | loss: 2.4537075
	speed: 0.2844s/iter; left time: 5680.5717s
Epoch: 4 cost time: 59.9768590927124
Epoch: 4, Steps: 208 | Train Loss: 3.184 Vali Loss: 6.070 Vali Acc: 0.047 Test Loss: 6.070 Test Acc: 0.047
Validation loss decreased (-0.036916 --> -0.046763).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0182996
	speed: 0.6416s/iter; left time: 12747.3524s
	iters: 200, epoch: 5 | loss: 3.3754096
	speed: 0.2839s/iter; left time: 5612.2134s
Epoch: 5 cost time: 58.378979444503784
Epoch: 5, Steps: 208 | Train Loss: 2.983 Vali Loss: 5.718 Vali Acc: 0.055 Test Loss: 5.718 Test Acc: 0.055
Validation loss decreased (-0.046763 --> -0.054521).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9138954
	speed: 0.6772s/iter; left time: 13315.1068s
	iters: 200, epoch: 6 | loss: 3.0009990
	speed: 0.2834s/iter; left time: 5544.0880s
Epoch: 6 cost time: 60.11762475967407
Epoch: 6, Steps: 208 | Train Loss: 2.647 Vali Loss: 5.546 Vali Acc: 0.053 Test Loss: 5.546 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2967644
	speed: 0.6983s/iter; left time: 13583.2971s
	iters: 200, epoch: 7 | loss: 2.5359704
	speed: 0.2913s/iter; left time: 5637.8923s
Epoch: 7 cost time: 62.781397104263306
Epoch: 7, Steps: 208 | Train Loss: 2.233 Vali Loss: 5.447 Vali Acc: 0.072 Test Loss: 5.447 Test Acc: 0.072
Validation loss decreased (-0.054521 --> -0.072418).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5076691
	speed: 0.6698s/iter; left time: 12890.3663s
	iters: 200, epoch: 8 | loss: 1.9064138
	speed: 0.2661s/iter; left time: 5095.1105s
Epoch: 8 cost time: 56.85411286354065
Epoch: 8, Steps: 208 | Train Loss: 1.889 Vali Loss: 5.630 Vali Acc: 0.070 Test Loss: 5.630 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2895598
	speed: 0.6824s/iter; left time: 12990.6331s
	iters: 200, epoch: 9 | loss: 1.6867690
	speed: 0.2732s/iter; left time: 5174.2356s
Epoch: 9 cost time: 59.90649652481079
Epoch: 9, Steps: 208 | Train Loss: 1.612 Vali Loss: 5.713 Vali Acc: 0.074 Test Loss: 5.713 Test Acc: 0.074
Validation loss decreased (-0.072418 --> -0.073608).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7050804
	speed: 0.6370s/iter; left time: 11993.6481s
	iters: 200, epoch: 10 | loss: 1.8708564
	speed: 0.2813s/iter; left time: 5267.8574s
Epoch: 10 cost time: 57.712488651275635
Epoch: 10, Steps: 208 | Train Loss: 1.331 Vali Loss: 6.137 Vali Acc: 0.075 Test Loss: 6.137 Test Acc: 0.075
Validation loss decreased (-0.073608 --> -0.074797).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3732640
	speed: 0.6947s/iter; left time: 12936.2745s
	iters: 200, epoch: 11 | loss: 0.8793687
	speed: 0.2844s/iter; left time: 5266.9990s
Epoch: 11 cost time: 60.87473821640015
Epoch: 11, Steps: 208 | Train Loss: 1.109 Vali Loss: 6.747 Vali Acc: 0.079 Test Loss: 6.747 Test Acc: 0.079
Validation loss decreased (-0.074797 --> -0.078668).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8625541
	speed: 0.6814s/iter; left time: 12546.5242s
	iters: 200, epoch: 12 | loss: 1.3694639
	speed: 0.2855s/iter; left time: 5229.2608s
Epoch: 12 cost time: 61.27955913543701
Epoch: 12, Steps: 208 | Train Loss: 0.998 Vali Loss: 6.771 Vali Acc: 0.081 Test Loss: 6.771 Test Acc: 0.081
Validation loss decreased (-0.078668 --> -0.080457).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8842323
	speed: 0.6546s/iter; left time: 11917.8017s
	iters: 200, epoch: 13 | loss: 1.5129534
	speed: 0.2834s/iter; left time: 5130.8191s
Epoch: 13 cost time: 58.450480937957764
Epoch: 13, Steps: 208 | Train Loss: 0.807 Vali Loss: 7.053 Vali Acc: 0.080 Test Loss: 7.053 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1015847
	speed: 0.6727s/iter; left time: 12106.4748s
	iters: 200, epoch: 14 | loss: 0.4225240
	speed: 0.2918s/iter; left time: 5221.6793s
Epoch: 14 cost time: 61.34335207939148
Epoch: 14, Steps: 208 | Train Loss: 0.688 Vali Loss: 7.726 Vali Acc: 0.080 Test Loss: 7.726 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1742348
	speed: 0.6930s/iter; left time: 12327.3212s
	iters: 200, epoch: 15 | loss: 0.9504613
	speed: 0.3042s/iter; left time: 5380.7956s
Epoch: 15 cost time: 63.71961045265198
Epoch: 15, Steps: 208 | Train Loss: 0.627 Vali Loss: 7.926 Vali Acc: 0.084 Test Loss: 7.926 Test Acc: 0.084
Validation loss decreased (-0.080457 --> -0.083428).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4584061
	speed: 0.7121s/iter; left time: 12520.0194s
	iters: 200, epoch: 16 | loss: 1.0979325
	speed: 0.3028s/iter; left time: 5293.9795s
Epoch: 16 cost time: 63.11095380783081
Epoch: 16, Steps: 208 | Train Loss: 0.590 Vali Loss: 8.453 Vali Acc: 0.082 Test Loss: 8.453 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3884150
	speed: 0.6824s/iter; left time: 11855.0234s
	iters: 200, epoch: 17 | loss: 0.3824434
	speed: 0.3046s/iter; left time: 5262.0620s
Epoch: 17 cost time: 62.80417823791504
Epoch: 17, Steps: 208 | Train Loss: 0.529 Vali Loss: 8.419 Vali Acc: 0.077 Test Loss: 8.419 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2060140
	speed: 0.6785s/iter; left time: 11646.3737s
	iters: 200, epoch: 18 | loss: 0.6874518
	speed: 0.2959s/iter; left time: 5049.0724s
Epoch: 18 cost time: 61.28889608383179
Epoch: 18, Steps: 208 | Train Loss: 0.513 Vali Loss: 8.777 Vali Acc: 0.079 Test Loss: 8.777 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1463450
	speed: 0.7095s/iter; left time: 12031.3881s
	iters: 200, epoch: 19 | loss: 0.8508653
	speed: 0.3042s/iter; left time: 5127.9654s
Epoch: 19 cost time: 64.29903221130371
Epoch: 19, Steps: 208 | Train Loss: 0.450 Vali Loss: 8.850 Vali Acc: 0.085 Test Loss: 8.850 Test Acc: 0.085
Validation loss decreased (-0.083428 --> -0.085208).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1649176
	speed: 0.6803s/iter; left time: 11394.2426s
	iters: 200, epoch: 20 | loss: 1.0315467
	speed: 0.3075s/iter; left time: 5120.2288s
Epoch: 20 cost time: 62.312936782836914
Epoch: 20, Steps: 208 | Train Loss: 0.379 Vali Loss: 9.213 Vali Acc: 0.086 Test Loss: 9.213 Test Acc: 0.086
Validation loss decreased (-0.085208 --> -0.086398).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8411304
	speed: 0.6677s/iter; left time: 11044.8421s
	iters: 200, epoch: 21 | loss: 0.1357821
	speed: 0.2892s/iter; left time: 4754.7017s
Epoch: 21 cost time: 59.3743040561676
Epoch: 21, Steps: 208 | Train Loss: 0.385 Vali Loss: 9.307 Vali Acc: 0.076 Test Loss: 9.307 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.4806789
	speed: 0.7174s/iter; left time: 11716.8880s
	iters: 200, epoch: 22 | loss: 1.3296096
	speed: 0.3055s/iter; left time: 4958.6254s
Epoch: 22 cost time: 65.56317281723022
Epoch: 22, Steps: 208 | Train Loss: 0.375 Vali Loss: 9.489 Vali Acc: 0.075 Test Loss: 9.489 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.1519704
	speed: 0.7082s/iter; left time: 11419.1827s
	iters: 200, epoch: 23 | loss: 0.2432220
	speed: 0.3083s/iter; left time: 4940.0732s
Epoch: 23 cost time: 64.2347469329834
Epoch: 23, Steps: 208 | Train Loss: 0.368 Vali Loss: 9.882 Vali Acc: 0.078 Test Loss: 9.882 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2843177
	speed: 0.7235s/iter; left time: 11515.2789s
	iters: 200, epoch: 24 | loss: 0.1245307
	speed: 0.2848s/iter; left time: 4504.6965s
Epoch: 24 cost time: 61.606961250305176
Epoch: 24, Steps: 208 | Train Loss: 0.330 Vali Loss: 10.141 Vali Acc: 0.082 Test Loss: 10.141 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.4596709
	speed: 0.6828s/iter; left time: 10726.7755s
	iters: 200, epoch: 25 | loss: 0.1153941
	speed: 0.3090s/iter; left time: 4822.7456s
Epoch: 25 cost time: 63.588449239730835
Epoch: 25, Steps: 208 | Train Loss: 0.336 Vali Loss: 9.846 Vali Acc: 0.081 Test Loss: 9.846 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.6646384
	speed: 0.7139s/iter; left time: 11065.7691s
	iters: 200, epoch: 26 | loss: 0.2150773
	speed: 0.2963s/iter; left time: 4562.9643s
Epoch: 26 cost time: 62.86504864692688
Epoch: 26, Steps: 208 | Train Loss: 0.312 Vali Loss: 9.833 Vali Acc: 0.086 Test Loss: 9.833 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6357827
	speed: 0.7219s/iter; left time: 11039.4332s
	iters: 200, epoch: 27 | loss: 0.1150346
	speed: 0.2957s/iter; left time: 4492.6592s
Epoch: 27 cost time: 63.9050714969635
Epoch: 27, Steps: 208 | Train Loss: 0.281 Vali Loss: 9.823 Vali Acc: 0.082 Test Loss: 9.823 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.3510846
	speed: 0.6654s/iter; left time: 10037.7689s
	iters: 200, epoch: 28 | loss: 0.4909663
	speed: 0.2984s/iter; left time: 4471.8238s
Epoch: 28 cost time: 61.782187938690186
Epoch: 28, Steps: 208 | Train Loss: 0.293 Vali Loss: 9.834 Vali Acc: 0.093 Test Loss: 9.834 Test Acc: 0.093
Validation loss decreased (-0.086398 --> -0.092654).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0523533
	speed: 0.7161s/iter; left time: 10653.5584s
	iters: 200, epoch: 29 | loss: 0.0123184
	speed: 0.3034s/iter; left time: 4483.8595s
Epoch: 29 cost time: 63.45028376579285
Epoch: 29, Steps: 208 | Train Loss: 0.269 Vali Loss: 10.225 Vali Acc: 0.079 Test Loss: 10.225 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.2509644
	speed: 0.7305s/iter; left time: 10716.2470s
	iters: 200, epoch: 30 | loss: 0.1776282
	speed: 0.2993s/iter; left time: 4360.7880s
Epoch: 30 cost time: 65.13938307762146
Epoch: 30, Steps: 208 | Train Loss: 0.243 Vali Loss: 10.717 Vali Acc: 0.081 Test Loss: 10.717 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.1981273
	speed: 0.6771s/iter; left time: 9791.6798s
	iters: 200, epoch: 31 | loss: 0.3367255
	speed: 0.2884s/iter; left time: 4142.0331s
Epoch: 31 cost time: 61.84037971496582
Epoch: 31, Steps: 208 | Train Loss: 0.237 Vali Loss: 10.547 Vali Acc: 0.079 Test Loss: 10.547 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0552946
	speed: 0.6990s/iter; left time: 9962.8167s
	iters: 200, epoch: 32 | loss: 0.1861424
	speed: 0.2911s/iter; left time: 4119.9199s
Epoch: 32 cost time: 62.15990328788757
Epoch: 32, Steps: 208 | Train Loss: 0.242 Vali Loss: 10.737 Vali Acc: 0.088 Test Loss: 10.737 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0159834
	speed: 0.7004s/iter; left time: 9836.6870s
	iters: 200, epoch: 33 | loss: 0.2102965
	speed: 0.3051s/iter; left time: 4255.1814s
Epoch: 33 cost time: 63.4847629070282
Epoch: 33, Steps: 208 | Train Loss: 0.230 Vali Loss: 10.926 Vali Acc: 0.081 Test Loss: 10.926 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0636890
	speed: 0.7018s/iter; left time: 9710.7045s
	iters: 200, epoch: 34 | loss: 0.4619721
	speed: 0.3112s/iter; left time: 4274.7147s
Epoch: 34 cost time: 63.41993260383606
Epoch: 34, Steps: 208 | Train Loss: 0.250 Vali Loss: 10.833 Vali Acc: 0.082 Test Loss: 10.833 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.1155247
	speed: 0.6966s/iter; left time: 9494.6198s
	iters: 200, epoch: 35 | loss: 0.2837164
	speed: 0.3026s/iter; left time: 4093.9882s
Epoch: 35 cost time: 63.28346109390259
Epoch: 35, Steps: 208 | Train Loss: 0.260 Vali Loss: 10.776 Vali Acc: 0.076 Test Loss: 10.776 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.2166223
	speed: 0.7085s/iter; left time: 9508.8378s
	iters: 200, epoch: 36 | loss: 0.2318269
	speed: 0.3012s/iter; left time: 4012.2434s
Epoch: 36 cost time: 63.639381647109985
Epoch: 36, Steps: 208 | Train Loss: 0.217 Vali Loss: 10.962 Vali Acc: 0.088 Test Loss: 10.962 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.3343669
	speed: 0.7295s/iter; left time: 9639.4359s
	iters: 200, epoch: 37 | loss: 0.4480131
	speed: 0.3045s/iter; left time: 3992.7124s
Epoch: 37 cost time: 64.39383912086487
Epoch: 37, Steps: 208 | Train Loss: 0.221 Vali Loss: 11.089 Vali Acc: 0.084 Test Loss: 11.089 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0745902
	speed: 0.7310s/iter; left time: 9506.0386s
	iters: 200, epoch: 38 | loss: 0.0317799
	speed: 0.3153s/iter; left time: 4069.2393s
Epoch: 38 cost time: 66.36477494239807
Epoch: 38, Steps: 208 | Train Loss: 0.219 Vali Loss: 11.116 Vali Acc: 0.089 Test Loss: 11.116 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09275275872353117
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3695595
	speed: 0.2914s/iter; left time: 6032.7334s
	iters: 200, epoch: 1 | loss: 3.8186746
	speed: 0.2577s/iter; left time: 5308.2401s
Epoch: 1 cost time: 57.37923288345337
Epoch: 1, Steps: 208 | Train Loss: 3.664 Vali Loss: 4.538 Vali Acc: 0.041 Test Loss: 4.538 Test Acc: 0.041
Validation loss decreased (inf --> -0.040515).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3763478
	speed: 0.6946s/iter; left time: 14234.6434s
	iters: 200, epoch: 2 | loss: 3.9524233
	speed: 0.2743s/iter; left time: 5594.3930s
Epoch: 2 cost time: 60.39372634887695
Epoch: 2, Steps: 208 | Train Loss: 3.266 Vali Loss: 6.407 Vali Acc: 0.032 Test Loss: 6.407 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5657506
	speed: 0.6842s/iter; left time: 13879.8694s
	iters: 200, epoch: 3 | loss: 3.4872096
	speed: 0.2886s/iter; left time: 5826.3008s
Epoch: 3 cost time: 60.53784799575806
Epoch: 3, Steps: 208 | Train Loss: 3.077 Vali Loss: 6.772 Vali Acc: 0.039 Test Loss: 6.772 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.0996261
	speed: 0.6471s/iter; left time: 12992.6811s
	iters: 200, epoch: 4 | loss: 3.2578146
	speed: 0.2841s/iter; left time: 5675.2587s
Epoch: 4 cost time: 59.044381618499756
Epoch: 4, Steps: 208 | Train Loss: 2.902 Vali Loss: 6.801 Vali Acc: 0.051 Test Loss: 6.801 Test Acc: 0.051
Validation loss decreased (-0.040515 --> -0.050633).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9948025
	speed: 0.6700s/iter; left time: 13312.8810s
	iters: 200, epoch: 5 | loss: 3.2475531
	speed: 0.2882s/iter; left time: 5697.0305s
Epoch: 5 cost time: 58.88838982582092
Epoch: 5, Steps: 208 | Train Loss: 2.652 Vali Loss: 6.962 Vali Acc: 0.059 Test Loss: 6.962 Test Acc: 0.059
Validation loss decreased (-0.050633 --> -0.058982).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5148258
	speed: 0.6612s/iter; left time: 13000.8037s
	iters: 200, epoch: 6 | loss: 1.8765707
	speed: 0.2901s/iter; left time: 5675.5739s
Epoch: 6 cost time: 59.550389766693115
Epoch: 6, Steps: 208 | Train Loss: 2.316 Vali Loss: 7.425 Vali Acc: 0.055 Test Loss: 7.425 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1233616
	speed: 0.6712s/iter; left time: 13056.6987s
	iters: 200, epoch: 7 | loss: 2.8917832
	speed: 0.2809s/iter; left time: 5437.0294s
Epoch: 7 cost time: 58.50849938392639
Epoch: 7, Steps: 208 | Train Loss: 1.908 Vali Loss: 7.090 Vali Acc: 0.069 Test Loss: 7.090 Test Acc: 0.069
Validation loss decreased (-0.058982 --> -0.069121).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3872337
	speed: 0.6612s/iter; left time: 12724.5357s
	iters: 200, epoch: 8 | loss: 1.9513496
	speed: 0.2771s/iter; left time: 5304.9432s
Epoch: 8 cost time: 58.11757493019104
Epoch: 8, Steps: 208 | Train Loss: 1.631 Vali Loss: 7.037 Vali Acc: 0.064 Test Loss: 7.037 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7720512
	speed: 0.6839s/iter; left time: 13019.7510s
	iters: 200, epoch: 9 | loss: 1.7876105
	speed: 0.2855s/iter; left time: 5405.6903s
Epoch: 9 cost time: 61.158066511154175
Epoch: 9, Steps: 208 | Train Loss: 1.344 Vali Loss: 7.552 Vali Acc: 0.068 Test Loss: 7.552 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4587440
	speed: 0.6972s/iter; left time: 13127.9641s
	iters: 200, epoch: 10 | loss: 2.0659125
	speed: 0.2914s/iter; left time: 5458.0280s
Epoch: 10 cost time: 62.4072368144989
Epoch: 10, Steps: 208 | Train Loss: 1.149 Vali Loss: 7.630 Vali Acc: 0.068 Test Loss: 7.630 Test Acc: 0.068
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9101910
	speed: 0.6584s/iter; left time: 12260.3854s
	iters: 200, epoch: 11 | loss: 0.8510267
	speed: 0.2838s/iter; left time: 5255.4478s
Epoch: 11 cost time: 58.93226623535156
Epoch: 11, Steps: 208 | Train Loss: 0.979 Vali Loss: 8.011 Vali Acc: 0.080 Test Loss: 8.011 Test Acc: 0.080
Validation loss decreased (-0.069121 --> -0.079848).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3191021
	speed: 0.6634s/iter; left time: 12214.6890s
	iters: 200, epoch: 12 | loss: 0.9718637
	speed: 0.2643s/iter; left time: 4840.4721s
Epoch: 12 cost time: 55.921600580215454
Epoch: 12, Steps: 208 | Train Loss: 0.821 Vali Loss: 8.519 Vali Acc: 0.078 Test Loss: 8.519 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9040008
	speed: 0.6940s/iter; left time: 12634.9806s
	iters: 200, epoch: 13 | loss: 0.8137580
	speed: 0.2746s/iter; left time: 4972.4222s
Epoch: 13 cost time: 59.60077381134033
Epoch: 13, Steps: 208 | Train Loss: 0.753 Vali Loss: 8.928 Vali Acc: 0.068 Test Loss: 8.928 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7780576
	speed: 0.6838s/iter; left time: 12306.8008s
	iters: 200, epoch: 14 | loss: 0.8053203
	speed: 0.3033s/iter; left time: 5429.0030s
Epoch: 14 cost time: 62.720656871795654
Epoch: 14, Steps: 208 | Train Loss: 0.665 Vali Loss: 9.205 Vali Acc: 0.076 Test Loss: 9.205 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2514023
	speed: 0.6488s/iter; left time: 11541.9692s
	iters: 200, epoch: 15 | loss: 0.8706765
	speed: 0.3061s/iter; left time: 5413.7537s
Epoch: 15 cost time: 61.42358136177063
Epoch: 15, Steps: 208 | Train Loss: 0.557 Vali Loss: 9.790 Vali Acc: 0.081 Test Loss: 9.790 Test Acc: 0.081
Validation loss decreased (-0.079848 --> -0.080427).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3705272
	speed: 0.6898s/iter; left time: 12127.8980s
	iters: 200, epoch: 16 | loss: 0.4518796
	speed: 0.2721s/iter; left time: 4757.0503s
Epoch: 16 cost time: 57.82787585258484
Epoch: 16, Steps: 208 | Train Loss: 0.512 Vali Loss: 9.690 Vali Acc: 0.075 Test Loss: 9.690 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6235067
	speed: 0.7062s/iter; left time: 12268.0912s
	iters: 200, epoch: 17 | loss: 0.4820526
	speed: 0.2878s/iter; left time: 4971.9510s
Epoch: 17 cost time: 61.4766206741333
Epoch: 17, Steps: 208 | Train Loss: 0.485 Vali Loss: 10.718 Vali Acc: 0.073 Test Loss: 10.718 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4229505
	speed: 0.7037s/iter; left time: 12079.2507s
	iters: 200, epoch: 18 | loss: 0.7697314
	speed: 0.2993s/iter; left time: 5107.2527s
Epoch: 18 cost time: 63.05486464500427
Epoch: 18, Steps: 208 | Train Loss: 0.453 Vali Loss: 10.284 Vali Acc: 0.078 Test Loss: 10.284 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0781106
	speed: 0.6708s/iter; left time: 11375.2177s
	iters: 200, epoch: 19 | loss: 0.4409004
	speed: 0.2939s/iter; left time: 4954.0019s
Epoch: 19 cost time: 60.05133819580078
Epoch: 19, Steps: 208 | Train Loss: 0.411 Vali Loss: 10.821 Vali Acc: 0.072 Test Loss: 10.821 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1056378
	speed: 0.6792s/iter; left time: 11376.1355s
	iters: 200, epoch: 20 | loss: 0.6811666
	speed: 0.2873s/iter; left time: 4782.4833s
Epoch: 20 cost time: 59.322263956069946
Epoch: 20, Steps: 208 | Train Loss: 0.361 Vali Loss: 10.723 Vali Acc: 0.083 Test Loss: 10.723 Test Acc: 0.083
Validation loss decreased (-0.080427 --> -0.082804).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.2905681
	speed: 0.6803s/iter; left time: 11252.5660s
	iters: 200, epoch: 21 | loss: 0.2286741
	speed: 0.2934s/iter; left time: 4823.3153s
Epoch: 21 cost time: 61.00845813751221
Epoch: 21, Steps: 208 | Train Loss: 0.320 Vali Loss: 11.233 Vali Acc: 0.076 Test Loss: 11.233 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.0234061
	speed: 0.6744s/iter; left time: 11015.5862s
	iters: 200, epoch: 22 | loss: 0.2004536
	speed: 0.2882s/iter; left time: 4678.4157s
Epoch: 22 cost time: 60.78212928771973
Epoch: 22, Steps: 208 | Train Loss: 0.331 Vali Loss: 11.067 Vali Acc: 0.069 Test Loss: 11.067 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5437042
	speed: 0.6616s/iter; left time: 10668.4713s
	iters: 200, epoch: 23 | loss: 0.4338863
	speed: 0.2871s/iter; left time: 4600.4605s
Epoch: 23 cost time: 59.42405128479004
Epoch: 23, Steps: 208 | Train Loss: 0.317 Vali Loss: 11.003 Vali Acc: 0.072 Test Loss: 11.003 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3118110
	speed: 0.7055s/iter; left time: 11228.7732s
	iters: 200, epoch: 24 | loss: 0.0954968
	speed: 0.3016s/iter; left time: 4769.8646s
Epoch: 24 cost time: 61.85182309150696
Epoch: 24, Steps: 208 | Train Loss: 0.272 Vali Loss: 11.357 Vali Acc: 0.088 Test Loss: 11.357 Test Acc: 0.088
Validation loss decreased (-0.082804 --> -0.087569).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.1869509
	speed: 0.7247s/iter; left time: 11384.2026s
	iters: 200, epoch: 25 | loss: 0.3189709
	speed: 0.2940s/iter; left time: 4588.5056s
Epoch: 25 cost time: 64.18409729003906
Epoch: 25, Steps: 208 | Train Loss: 0.256 Vali Loss: 11.008 Vali Acc: 0.093 Test Loss: 11.008 Test Acc: 0.093
Validation loss decreased (-0.087569 --> -0.092941).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1648147
	speed: 0.6727s/iter; left time: 10427.8645s
	iters: 200, epoch: 26 | loss: 0.0807986
	speed: 0.2941s/iter; left time: 4529.2516s
Epoch: 26 cost time: 61.28472685813904
Epoch: 26, Steps: 208 | Train Loss: 0.270 Vali Loss: 11.342 Vali Acc: 0.092 Test Loss: 11.342 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.5681049
	speed: 0.7055s/iter; left time: 10788.8549s
	iters: 200, epoch: 27 | loss: 0.3472537
	speed: 0.3051s/iter; left time: 4635.6293s
Epoch: 27 cost time: 63.6277220249176
Epoch: 27, Steps: 208 | Train Loss: 0.225 Vali Loss: 11.813 Vali Acc: 0.085 Test Loss: 11.813 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.4930660
	speed: 0.6943s/iter; left time: 10473.8706s
	iters: 200, epoch: 28 | loss: 0.2842100
	speed: 0.2782s/iter; left time: 4168.6342s
Epoch: 28 cost time: 59.9546012878418
Epoch: 28, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.483 Vali Acc: 0.086 Test Loss: 11.483 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.2868491
	speed: 0.6777s/iter; left time: 10081.6164s
	iters: 200, epoch: 29 | loss: 0.0236425
	speed: 0.2893s/iter; left time: 4275.2338s
Epoch: 29 cost time: 61.17467737197876
Epoch: 29, Steps: 208 | Train Loss: 0.248 Vali Loss: 11.884 Vali Acc: 0.089 Test Loss: 11.884 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.0534999
	speed: 0.6553s/iter; left time: 9612.6695s
	iters: 200, epoch: 30 | loss: 0.1196218
	speed: 0.2901s/iter; left time: 4226.2402s
Epoch: 30 cost time: 59.88798546791077
Epoch: 30, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.286 Vali Acc: 0.090 Test Loss: 11.286 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.3738572
	speed: 0.6912s/iter; left time: 9994.8833s
	iters: 200, epoch: 31 | loss: 0.2949812
	speed: 0.2703s/iter; left time: 3881.3444s
Epoch: 31 cost time: 57.57930278778076
Epoch: 31, Steps: 208 | Train Loss: 0.240 Vali Loss: 12.324 Vali Acc: 0.082 Test Loss: 12.324 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0069391
	speed: 0.6906s/iter; left time: 9842.4974s
	iters: 200, epoch: 32 | loss: 0.2357877
	speed: 0.2832s/iter; left time: 4008.0982s
Epoch: 32 cost time: 60.602516174316406
Epoch: 32, Steps: 208 | Train Loss: 0.220 Vali Loss: 12.095 Vali Acc: 0.085 Test Loss: 12.095 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.3247313
	speed: 0.6819s/iter; left time: 9577.7436s
	iters: 200, epoch: 33 | loss: 0.0567521
	speed: 0.2888s/iter; left time: 4027.8211s
Epoch: 33 cost time: 61.45285773277283
Epoch: 33, Steps: 208 | Train Loss: 0.174 Vali Loss: 12.420 Vali Acc: 0.081 Test Loss: 12.420 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2424540
	speed: 0.6838s/iter; left time: 9462.2805s
	iters: 200, epoch: 34 | loss: 0.4688738
	speed: 0.2771s/iter; left time: 3806.2642s
Epoch: 34 cost time: 59.58904409408569
Epoch: 34, Steps: 208 | Train Loss: 0.187 Vali Loss: 12.450 Vali Acc: 0.076 Test Loss: 12.450 Test Acc: 0.076
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.1243415
	speed: 0.6591s/iter; left time: 8982.4253s
	iters: 200, epoch: 35 | loss: 0.0613523
	speed: 0.2620s/iter; left time: 3544.2631s
Epoch: 35 cost time: 55.46282482147217
Epoch: 35, Steps: 208 | Train Loss: 0.182 Vali Loss: 12.276 Vali Acc: 0.080 Test Loss: 12.276 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09305099910527885
model parameter : 2142375
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5710797
	speed: 0.3094s/iter; left time: 6404.6557s
	iters: 200, epoch: 1 | loss: 3.8746290
	speed: 0.2806s/iter; left time: 5780.2784s
Epoch: 1 cost time: 61.623188495635986
Epoch: 1, Steps: 208 | Train Loss: 3.839 Vali Loss: 4.053 Vali Acc: 0.065 Test Loss: 4.053 Test Acc: 0.065
Validation loss decreased (inf --> -0.064976).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4880846
	speed: 0.6704s/iter; left time: 13738.4079s
	iters: 200, epoch: 2 | loss: 3.5958700
	speed: 0.2782s/iter; left time: 5672.8319s
Epoch: 2 cost time: 59.7080512046814
Epoch: 2, Steps: 208 | Train Loss: 3.249 Vali Loss: 4.103 Vali Acc: 0.084 Test Loss: 4.103 Test Acc: 0.084
Validation loss decreased (-0.064976 --> -0.084063).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8331358
	speed: 0.6575s/iter; left time: 13338.1783s
	iters: 200, epoch: 3 | loss: 2.9359479
	speed: 0.2918s/iter; left time: 5890.2896s
Epoch: 3 cost time: 59.961976766586304
Epoch: 3, Steps: 208 | Train Loss: 2.597 Vali Loss: 4.567 Vali Acc: 0.094 Test Loss: 4.567 Test Acc: 0.094
Validation loss decreased (-0.084063 --> -0.093900).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4985869
	speed: 0.6614s/iter; left time: 13279.2360s
	iters: 200, epoch: 4 | loss: 2.7148459
	speed: 0.2773s/iter; left time: 5539.3961s
Epoch: 4 cost time: 58.488189697265625
Epoch: 4, Steps: 208 | Train Loss: 1.943 Vali Loss: 5.084 Vali Acc: 0.087 Test Loss: 5.084 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5438962
	speed: 0.6834s/iter; left time: 13578.8260s
	iters: 200, epoch: 5 | loss: 2.3540483
	speed: 0.2818s/iter; left time: 5571.6612s
Epoch: 5 cost time: 60.269195795059204
Epoch: 5, Steps: 208 | Train Loss: 1.452 Vali Loss: 5.736 Vali Acc: 0.088 Test Loss: 5.736 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0361369
	speed: 0.6668s/iter; left time: 13109.8634s
	iters: 200, epoch: 6 | loss: 0.8736612
	speed: 0.2896s/iter; left time: 5665.0839s
Epoch: 6 cost time: 60.34582829475403
Epoch: 6, Steps: 208 | Train Loss: 1.014 Vali Loss: 6.785 Vali Acc: 0.083 Test Loss: 6.785 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3387544
	speed: 0.6538s/iter; left time: 12718.1975s
	iters: 200, epoch: 7 | loss: 1.4250616
	speed: 0.2690s/iter; left time: 5206.2896s
Epoch: 7 cost time: 56.65407371520996
Epoch: 7, Steps: 208 | Train Loss: 0.787 Vali Loss: 7.458 Vali Acc: 0.088 Test Loss: 7.458 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1745905
	speed: 0.6506s/iter; left time: 12520.7071s
	iters: 200, epoch: 8 | loss: 0.3360697
	speed: 0.2753s/iter; left time: 5271.1973s
Epoch: 8 cost time: 59.15487742424011
Epoch: 8, Steps: 208 | Train Loss: 0.635 Vali Loss: 8.153 Vali Acc: 0.092 Test Loss: 8.153 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2262074
	speed: 0.6583s/iter; left time: 12531.3222s
	iters: 200, epoch: 9 | loss: 0.6763468
	speed: 0.2765s/iter; left time: 5235.8055s
Epoch: 9 cost time: 59.163304805755615
Epoch: 9, Steps: 208 | Train Loss: 0.551 Vali Loss: 8.679 Vali Acc: 0.085 Test Loss: 8.679 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2154116
	speed: 0.6539s/iter; left time: 12312.2269s
	iters: 200, epoch: 10 | loss: 0.3524116
	speed: 0.2830s/iter; left time: 5299.6301s
Epoch: 10 cost time: 58.960121393203735
Epoch: 10, Steps: 208 | Train Loss: 0.462 Vali Loss: 9.075 Vali Acc: 0.086 Test Loss: 9.075 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0486331
	speed: 0.6424s/iter; left time: 11961.2326s
	iters: 200, epoch: 11 | loss: 0.0591273
	speed: 0.2842s/iter; left time: 5263.9809s
Epoch: 11 cost time: 58.849036693573
Epoch: 11, Steps: 208 | Train Loss: 0.393 Vali Loss: 9.685 Vali Acc: 0.086 Test Loss: 9.685 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2820465
	speed: 0.6477s/iter; left time: 11926.6406s
	iters: 200, epoch: 12 | loss: 0.3046819
	speed: 0.2841s/iter; left time: 5202.2595s
Epoch: 12 cost time: 58.600122690200806
Epoch: 12, Steps: 208 | Train Loss: 0.376 Vali Loss: 10.067 Vali Acc: 0.084 Test Loss: 10.067 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0466868
	speed: 0.6759s/iter; left time: 12304.8805s
	iters: 200, epoch: 13 | loss: 0.8780193
	speed: 0.2956s/iter; left time: 5350.9834s
Epoch: 13 cost time: 60.91195249557495
Epoch: 13, Steps: 208 | Train Loss: 0.332 Vali Loss: 10.249 Vali Acc: 0.086 Test Loss: 10.249 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09394572025052192
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5166435
	speed: 0.3218s/iter; left time: 6662.5224s
	iters: 200, epoch: 1 | loss: 3.9034150
	speed: 0.3075s/iter; left time: 6333.8474s
Epoch: 1 cost time: 65.57517957687378
Epoch: 1, Steps: 208 | Train Loss: 3.826 Vali Loss: 4.069 Vali Acc: 0.071 Test Loss: 4.069 Test Acc: 0.071
Validation loss decreased (inf --> -0.071239).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4680517
	speed: 0.6692s/iter; left time: 13713.7825s
	iters: 200, epoch: 2 | loss: 3.8009417
	speed: 0.2928s/iter; left time: 5970.5298s
Epoch: 2 cost time: 61.242586612701416
Epoch: 2, Steps: 208 | Train Loss: 3.248 Vali Loss: 4.143 Vali Acc: 0.093 Test Loss: 4.143 Test Acc: 0.093
Validation loss decreased (-0.071239 --> -0.092711).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5092478
	speed: 0.7035s/iter; left time: 14270.0488s
	iters: 200, epoch: 3 | loss: 3.3859158
	speed: 0.3031s/iter; left time: 6118.6323s
Epoch: 3 cost time: 63.083619356155396
Epoch: 3, Steps: 208 | Train Loss: 2.602 Vali Loss: 4.571 Vali Acc: 0.096 Test Loss: 4.571 Test Acc: 0.096
Validation loss decreased (-0.092711 --> -0.095988).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2326138
	speed: 0.7097s/iter; left time: 14248.8444s
	iters: 200, epoch: 4 | loss: 2.9879808
	speed: 0.3003s/iter; left time: 6000.0252s
Epoch: 4 cost time: 63.82307243347168
Epoch: 4, Steps: 208 | Train Loss: 1.985 Vali Loss: 5.106 Vali Acc: 0.089 Test Loss: 5.106 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3229306
	speed: 0.6923s/iter; left time: 13755.9738s
	iters: 200, epoch: 5 | loss: 2.4617171
	speed: 0.3063s/iter; left time: 6054.6332s
Epoch: 5 cost time: 63.835253953933716
Epoch: 5, Steps: 208 | Train Loss: 1.454 Vali Loss: 5.678 Vali Acc: 0.094 Test Loss: 5.678 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7931136
	speed: 0.6642s/iter; left time: 13058.7484s
	iters: 200, epoch: 6 | loss: 1.2300484
	speed: 0.3021s/iter; left time: 5908.9724s
Epoch: 6 cost time: 62.65100622177124
Epoch: 6, Steps: 208 | Train Loss: 1.065 Vali Loss: 6.754 Vali Acc: 0.086 Test Loss: 6.754 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2069305
	speed: 0.7190s/iter; left time: 13986.3211s
	iters: 200, epoch: 7 | loss: 1.1363920
	speed: 0.3045s/iter; left time: 5892.7865s
Epoch: 7 cost time: 63.27125024795532
Epoch: 7, Steps: 208 | Train Loss: 0.837 Vali Loss: 7.129 Vali Acc: 0.096 Test Loss: 7.129 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7795210
	speed: 0.6838s/iter; left time: 13159.7837s
	iters: 200, epoch: 8 | loss: 0.4974267
	speed: 0.2978s/iter; left time: 5701.5658s
Epoch: 8 cost time: 61.13372230529785
Epoch: 8, Steps: 208 | Train Loss: 0.650 Vali Loss: 7.926 Vali Acc: 0.094 Test Loss: 7.926 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.1046691
	speed: 0.6752s/iter; left time: 12853.5697s
	iters: 200, epoch: 9 | loss: 0.8619062
	speed: 0.2963s/iter; left time: 5611.0156s
Epoch: 9 cost time: 61.5889995098114
Epoch: 9, Steps: 208 | Train Loss: 0.588 Vali Loss: 8.529 Vali Acc: 0.083 Test Loss: 8.529 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2325598
	speed: 0.6789s/iter; left time: 12782.2391s
	iters: 200, epoch: 10 | loss: 0.7945859
	speed: 0.2891s/iter; left time: 5414.1760s
Epoch: 10 cost time: 60.53087115287781
Epoch: 10, Steps: 208 | Train Loss: 0.454 Vali Loss: 8.691 Vali Acc: 0.088 Test Loss: 8.691 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1736338
	speed: 0.6694s/iter; left time: 12465.7734s
	iters: 200, epoch: 11 | loss: 0.1196317
	speed: 0.2930s/iter; left time: 5427.5602s
Epoch: 11 cost time: 59.49368357658386
Epoch: 11, Steps: 208 | Train Loss: 0.412 Vali Loss: 9.014 Vali Acc: 0.086 Test Loss: 9.014 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.4883653
	speed: 0.6767s/iter; left time: 12460.9651s
	iters: 200, epoch: 12 | loss: 0.0947538
	speed: 0.2692s/iter; left time: 4929.8590s
Epoch: 12 cost time: 58.32492661476135
Epoch: 12, Steps: 208 | Train Loss: 0.366 Vali Loss: 9.497 Vali Acc: 0.087 Test Loss: 9.497 Test Acc: 0.087
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.5089492
	speed: 0.6454s/iter; left time: 11749.2404s
	iters: 200, epoch: 13 | loss: 1.0365025
	speed: 0.2820s/iter; left time: 5106.1340s
Epoch: 13 cost time: 57.354201555252075
Epoch: 13, Steps: 208 | Train Loss: 0.301 Vali Loss: 10.189 Vali Acc: 0.086 Test Loss: 10.189 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09603340292275574
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4873471
	speed: 0.2928s/iter; left time: 6061.5963s
	iters: 200, epoch: 1 | loss: 3.8033214
	speed: 0.2949s/iter; left time: 6074.5397s
Epoch: 1 cost time: 61.44525671005249
Epoch: 1, Steps: 208 | Train Loss: 3.826 Vali Loss: 3.890 Vali Acc: 0.075 Test Loss: 3.890 Test Acc: 0.075
Validation loss decreased (inf --> -0.075416).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1962428
	speed: 0.6720s/iter; left time: 13771.9577s
	iters: 200, epoch: 2 | loss: 3.8464971
	speed: 0.3003s/iter; left time: 6123.0393s
Epoch: 2 cost time: 61.57873296737671
Epoch: 2, Steps: 208 | Train Loss: 3.217 Vali Loss: 4.158 Vali Acc: 0.087 Test Loss: 4.158 Test Acc: 0.087
Validation loss decreased (-0.075416 --> -0.087045).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8833420
	speed: 0.6405s/iter; left time: 12993.3692s
	iters: 200, epoch: 3 | loss: 3.2036612
	speed: 0.3023s/iter; left time: 6102.0447s
Epoch: 3 cost time: 60.84825325012207
Epoch: 3, Steps: 208 | Train Loss: 2.577 Vali Loss: 4.492 Vali Acc: 0.092 Test Loss: 4.492 Test Acc: 0.092
Validation loss decreased (-0.087045 --> -0.091515).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0556448
	speed: 0.6533s/iter; left time: 13116.9955s
	iters: 200, epoch: 4 | loss: 2.1553910
	speed: 0.2975s/iter; left time: 5944.1151s
Epoch: 4 cost time: 61.166136264801025
Epoch: 4, Steps: 208 | Train Loss: 1.989 Vali Loss: 5.070 Vali Acc: 0.086 Test Loss: 5.070 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1386667
	speed: 0.6591s/iter; left time: 13095.7464s
	iters: 200, epoch: 5 | loss: 2.6031547
	speed: 0.3018s/iter; left time: 5965.5699s
Epoch: 5 cost time: 61.324981451034546
Epoch: 5, Steps: 208 | Train Loss: 1.464 Vali Loss: 5.576 Vali Acc: 0.077 Test Loss: 5.576 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1447713
	speed: 0.6956s/iter; left time: 13675.2980s
	iters: 200, epoch: 6 | loss: 1.4063969
	speed: 0.2898s/iter; left time: 5669.0428s
Epoch: 6 cost time: 61.73605680465698
Epoch: 6, Steps: 208 | Train Loss: 1.077 Vali Loss: 6.648 Vali Acc: 0.085 Test Loss: 6.648 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.1061833
	speed: 0.6557s/iter; left time: 12754.4999s
	iters: 200, epoch: 7 | loss: 0.4255334
	speed: 0.2844s/iter; left time: 5504.2239s
Epoch: 7 cost time: 58.58411741256714
Epoch: 7, Steps: 208 | Train Loss: 0.831 Vali Loss: 7.245 Vali Acc: 0.089 Test Loss: 7.245 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2232986
	speed: 0.6548s/iter; left time: 12601.1650s
	iters: 200, epoch: 8 | loss: 0.5880370
	speed: 0.2810s/iter; left time: 5380.5749s
Epoch: 8 cost time: 58.779444217681885
Epoch: 8, Steps: 208 | Train Loss: 0.647 Vali Loss: 7.656 Vali Acc: 0.091 Test Loss: 7.656 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2385024
	speed: 0.6878s/iter; left time: 13093.6492s
	iters: 200, epoch: 9 | loss: 0.9677837
	speed: 0.2981s/iter; left time: 5645.2660s
Epoch: 9 cost time: 61.10308766365051
Epoch: 9, Steps: 208 | Train Loss: 0.547 Vali Loss: 8.227 Vali Acc: 0.087 Test Loss: 8.227 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1788100
	speed: 0.6826s/iter; left time: 12853.2646s
	iters: 200, epoch: 10 | loss: 0.3824587
	speed: 0.2753s/iter; left time: 5156.5136s
Epoch: 10 cost time: 59.02390384674072
Epoch: 10, Steps: 208 | Train Loss: 0.457 Vali Loss: 8.872 Vali Acc: 0.079 Test Loss: 8.872 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3970196
	speed: 0.6470s/iter; left time: 12048.5126s
	iters: 200, epoch: 11 | loss: 0.5117757
	speed: 0.2831s/iter; left time: 5244.1104s
Epoch: 11 cost time: 57.04349946975708
Epoch: 11, Steps: 208 | Train Loss: 0.409 Vali Loss: 9.156 Vali Acc: 0.088 Test Loss: 9.156 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2104555
	speed: 0.6710s/iter; left time: 12355.5396s
	iters: 200, epoch: 12 | loss: 0.1514902
	speed: 0.2739s/iter; left time: 5015.8884s
Epoch: 12 cost time: 58.47358560562134
Epoch: 12, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.608 Vali Acc: 0.084 Test Loss: 9.608 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6392993
	speed: 0.6909s/iter; left time: 12577.2064s
	iters: 200, epoch: 13 | loss: 0.3960505
	speed: 0.2783s/iter; left time: 5039.0336s
Epoch: 13 cost time: 61.51790142059326
Epoch: 13, Steps: 208 | Train Loss: 0.329 Vali Loss: 10.031 Vali Acc: 0.086 Test Loss: 10.031 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09155979719654041
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2985473
	speed: 0.3119s/iter; left time: 6457.5825s
	iters: 200, epoch: 1 | loss: 3.8313661
	speed: 0.2767s/iter; left time: 5701.1690s
Epoch: 1 cost time: 61.2609384059906
Epoch: 1, Steps: 208 | Train Loss: 3.821 Vali Loss: 3.822 Vali Acc: 0.071 Test Loss: 3.822 Test Acc: 0.071
Validation loss decreased (inf --> -0.071241).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3264368
	speed: 0.6469s/iter; left time: 13257.1344s
	iters: 200, epoch: 2 | loss: 3.9682181
	speed: 0.2941s/iter; left time: 5997.5392s
Epoch: 2 cost time: 60.66168284416199
Epoch: 2, Steps: 208 | Train Loss: 3.199 Vali Loss: 4.066 Vali Acc: 0.103 Test Loss: 4.066 Test Acc: 0.103
Validation loss decreased (-0.071241 --> -0.103449).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5252287
	speed: 0.6745s/iter; left time: 13682.5260s
	iters: 200, epoch: 3 | loss: 3.2172494
	speed: 0.3012s/iter; left time: 6080.1263s
Epoch: 3 cost time: 62.08559799194336
Epoch: 3, Steps: 208 | Train Loss: 2.564 Vali Loss: 4.310 Vali Acc: 0.102 Test Loss: 4.310 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.5697896
	speed: 0.7037s/iter; left time: 14127.2875s
	iters: 200, epoch: 4 | loss: 2.6263251
	speed: 0.2863s/iter; left time: 5719.9605s
Epoch: 4 cost time: 62.54815602302551
Epoch: 4, Steps: 208 | Train Loss: 1.934 Vali Loss: 5.026 Vali Acc: 0.094 Test Loss: 5.026 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2987210
	speed: 0.6682s/iter; left time: 13277.1454s
	iters: 200, epoch: 5 | loss: 1.6829250
	speed: 0.2864s/iter; left time: 5662.2255s
Epoch: 5 cost time: 58.26474046707153
Epoch: 5, Steps: 208 | Train Loss: 1.434 Vali Loss: 5.673 Vali Acc: 0.100 Test Loss: 5.673 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1005125
	speed: 0.6427s/iter; left time: 12635.4348s
	iters: 200, epoch: 6 | loss: 0.8909717
	speed: 0.2766s/iter; left time: 5410.2073s
Epoch: 6 cost time: 57.800204038619995
Epoch: 6, Steps: 208 | Train Loss: 1.041 Vali Loss: 6.836 Vali Acc: 0.093 Test Loss: 6.836 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.8068336
	speed: 0.6746s/iter; left time: 13123.1323s
	iters: 200, epoch: 7 | loss: 1.5376953
	speed: 0.2851s/iter; left time: 5518.1275s
Epoch: 7 cost time: 61.05937719345093
Epoch: 7, Steps: 208 | Train Loss: 0.826 Vali Loss: 7.402 Vali Acc: 0.085 Test Loss: 7.402 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.4269220
	speed: 0.6700s/iter; left time: 12894.5913s
	iters: 200, epoch: 8 | loss: 0.0893572
	speed: 0.2938s/iter; left time: 5625.1175s
Epoch: 8 cost time: 60.16402721405029
Epoch: 8, Steps: 208 | Train Loss: 0.670 Vali Loss: 8.041 Vali Acc: 0.102 Test Loss: 8.041 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8337138
	speed: 0.6736s/iter; left time: 12824.0227s
	iters: 200, epoch: 9 | loss: 1.3489208
	speed: 0.2810s/iter; left time: 5322.2091s
Epoch: 9 cost time: 60.74827218055725
Epoch: 9, Steps: 208 | Train Loss: 0.558 Vali Loss: 8.396 Vali Acc: 0.090 Test Loss: 8.396 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1384329
	speed: 0.6666s/iter; left time: 12551.9222s
	iters: 200, epoch: 10 | loss: 0.6724985
	speed: 0.2860s/iter; left time: 5355.7970s
Epoch: 10 cost time: 60.34697461128235
Epoch: 10, Steps: 208 | Train Loss: 0.476 Vali Loss: 9.121 Vali Acc: 0.092 Test Loss: 9.121 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.3048176
	speed: 0.6789s/iter; left time: 12642.1555s
	iters: 200, epoch: 11 | loss: 0.5766895
	speed: 0.3038s/iter; left time: 5626.2949s
Epoch: 11 cost time: 62.36134600639343
Epoch: 11, Steps: 208 | Train Loss: 0.418 Vali Loss: 9.111 Vali Acc: 0.092 Test Loss: 9.111 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0621773
	speed: 0.6956s/iter; left time: 12808.1574s
	iters: 200, epoch: 12 | loss: 0.0952987
	speed: 0.2857s/iter; left time: 5232.3401s
Epoch: 12 cost time: 61.96963667869568
Epoch: 12, Steps: 208 | Train Loss: 0.356 Vali Loss: 10.168 Vali Acc: 0.088 Test Loss: 10.168 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10348941246644795
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2938004
	speed: 0.3125s/iter; left time: 6469.6470s
	iters: 200, epoch: 1 | loss: 4.1556187
	speed: 0.2932s/iter; left time: 6041.1164s
Epoch: 1 cost time: 63.31317067146301
Epoch: 1, Steps: 208 | Train Loss: 3.770 Vali Loss: 4.340 Vali Acc: 0.074 Test Loss: 4.340 Test Acc: 0.074
Validation loss decreased (inf --> -0.073920).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4024949
	speed: 0.6962s/iter; left time: 14267.5875s
	iters: 200, epoch: 2 | loss: 3.7098660
	speed: 0.2904s/iter; left time: 5922.6001s
Epoch: 2 cost time: 62.44118547439575
Epoch: 2, Steps: 208 | Train Loss: 3.192 Vali Loss: 4.460 Vali Acc: 0.085 Test Loss: 4.460 Test Acc: 0.085
Validation loss decreased (-0.073920 --> -0.084954).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6871629
	speed: 0.6915s/iter; left time: 14027.6148s
	iters: 200, epoch: 3 | loss: 3.5527775
	speed: 0.3115s/iter; left time: 6286.7221s
Epoch: 3 cost time: 61.653717279434204
Epoch: 3, Steps: 208 | Train Loss: 2.625 Vali Loss: 5.254 Vali Acc: 0.076 Test Loss: 5.254 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1712697
	speed: 0.6978s/iter; left time: 14009.2345s
	iters: 200, epoch: 4 | loss: 2.1321747
	speed: 0.2885s/iter; left time: 5763.5048s
Epoch: 4 cost time: 62.53944635391235
Epoch: 4, Steps: 208 | Train Loss: 1.995 Vali Loss: 5.761 Vali Acc: 0.088 Test Loss: 5.761 Test Acc: 0.088
Validation loss decreased (-0.084954 --> -0.088222).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3256280
	speed: 0.6766s/iter; left time: 13443.9781s
	iters: 200, epoch: 5 | loss: 2.1158025
	speed: 0.2946s/iter; left time: 5824.8259s
Epoch: 5 cost time: 59.50092601776123
Epoch: 5, Steps: 208 | Train Loss: 1.541 Vali Loss: 6.155 Vali Acc: 0.083 Test Loss: 6.155 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0208844
	speed: 0.6889s/iter; left time: 13544.6422s
	iters: 200, epoch: 6 | loss: 1.8701696
	speed: 0.3014s/iter; left time: 5895.4304s
Epoch: 6 cost time: 63.28378915786743
Epoch: 6, Steps: 208 | Train Loss: 1.170 Vali Loss: 6.620 Vali Acc: 0.079 Test Loss: 6.620 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3496146
	speed: 0.7058s/iter; left time: 13729.8629s
	iters: 200, epoch: 7 | loss: 0.7627062
	speed: 0.2984s/iter; left time: 5774.6803s
Epoch: 7 cost time: 63.3800847530365
Epoch: 7, Steps: 208 | Train Loss: 0.927 Vali Loss: 7.197 Vali Acc: 0.090 Test Loss: 7.197 Test Acc: 0.090
Validation loss decreased (-0.088222 --> -0.090295).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6526105
	speed: 0.7016s/iter; left time: 13501.5103s
	iters: 200, epoch: 8 | loss: 0.5821400
	speed: 0.2999s/iter; left time: 5740.7885s
Epoch: 8 cost time: 62.23044991493225
Epoch: 8, Steps: 208 | Train Loss: 0.711 Vali Loss: 7.551 Vali Acc: 0.089 Test Loss: 7.551 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0719609
	speed: 0.6833s/iter; left time: 13007.2955s
	iters: 200, epoch: 9 | loss: 1.0372790
	speed: 0.2876s/iter; left time: 5446.8249s
Epoch: 9 cost time: 61.34114098548889
Epoch: 9, Steps: 208 | Train Loss: 0.596 Vali Loss: 8.498 Vali Acc: 0.082 Test Loss: 8.498 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3975885
	speed: 0.7097s/iter; left time: 13362.7466s
	iters: 200, epoch: 10 | loss: 0.4205242
	speed: 0.2917s/iter; left time: 5463.0729s
Epoch: 10 cost time: 62.300095319747925
Epoch: 10, Steps: 208 | Train Loss: 0.531 Vali Loss: 8.485 Vali Acc: 0.084 Test Loss: 8.485 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3938257
	speed: 0.6924s/iter; left time: 12893.5772s
	iters: 200, epoch: 11 | loss: 0.4114742
	speed: 0.3020s/iter; left time: 5594.1935s
Epoch: 11 cost time: 61.05611538887024
Epoch: 11, Steps: 208 | Train Loss: 0.464 Vali Loss: 9.082 Vali Acc: 0.093 Test Loss: 9.082 Test Acc: 0.093
Validation loss decreased (-0.090295 --> -0.092960).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2078509
	speed: 0.6908s/iter; left time: 12719.4797s
	iters: 200, epoch: 12 | loss: 0.1270195
	speed: 0.2866s/iter; left time: 5249.3758s
Epoch: 12 cost time: 60.06074261665344
Epoch: 12, Steps: 208 | Train Loss: 0.423 Vali Loss: 8.994 Vali Acc: 0.087 Test Loss: 8.994 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3539638
	speed: 0.6913s/iter; left time: 12585.4314s
	iters: 200, epoch: 13 | loss: 0.8960422
	speed: 0.2990s/iter; left time: 5413.4320s
Epoch: 13 cost time: 62.85299825668335
Epoch: 13, Steps: 208 | Train Loss: 0.350 Vali Loss: 9.457 Vali Acc: 0.088 Test Loss: 9.457 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0188848
	speed: 0.6901s/iter; left time: 12419.3310s
	iters: 200, epoch: 14 | loss: 0.0479093
	speed: 0.2736s/iter; left time: 4896.9136s
Epoch: 14 cost time: 59.39462161064148
Epoch: 14, Steps: 208 | Train Loss: 0.310 Vali Loss: 9.622 Vali Acc: 0.085 Test Loss: 9.622 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3265998
	speed: 0.6835s/iter; left time: 12159.1148s
	iters: 200, epoch: 15 | loss: 0.0825360
	speed: 0.2771s/iter; left time: 4901.0850s
Epoch: 15 cost time: 60.2023663520813
Epoch: 15, Steps: 208 | Train Loss: 0.274 Vali Loss: 10.376 Vali Acc: 0.095 Test Loss: 10.376 Test Acc: 0.095
Validation loss decreased (-0.092960 --> -0.094438).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1995423
	speed: 0.6724s/iter; left time: 11820.7740s
	iters: 200, epoch: 16 | loss: 0.4919926
	speed: 0.2984s/iter; left time: 5217.1159s
Epoch: 16 cost time: 62.14171481132507
Epoch: 16, Steps: 208 | Train Loss: 0.282 Vali Loss: 10.232 Vali Acc: 0.093 Test Loss: 10.232 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0241850
	speed: 0.6914s/iter; left time: 12012.2548s
	iters: 200, epoch: 17 | loss: 0.4498581
	speed: 0.2943s/iter; left time: 5084.1653s
Epoch: 17 cost time: 61.13857412338257
Epoch: 17, Steps: 208 | Train Loss: 0.294 Vali Loss: 10.462 Vali Acc: 0.093 Test Loss: 10.462 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4814603
	speed: 0.7034s/iter; left time: 12073.5439s
	iters: 200, epoch: 18 | loss: 0.0326238
	speed: 0.2957s/iter; left time: 5045.7338s
Epoch: 18 cost time: 62.70279598236084
Epoch: 18, Steps: 208 | Train Loss: 0.263 Vali Loss: 10.619 Vali Acc: 0.091 Test Loss: 10.619 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2949422
	speed: 0.6800s/iter; left time: 11530.5484s
	iters: 200, epoch: 19 | loss: 0.0824564
	speed: 0.3087s/iter; left time: 5203.4006s
Epoch: 19 cost time: 63.53014636039734
Epoch: 19, Steps: 208 | Train Loss: 0.213 Vali Loss: 11.509 Vali Acc: 0.095 Test Loss: 11.509 Test Acc: 0.095
Validation loss decreased (-0.094438 --> -0.095322).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1127718
	speed: 0.7047s/iter; left time: 11802.7052s
	iters: 200, epoch: 20 | loss: 0.5085905
	speed: 0.2957s/iter; left time: 4922.7548s
Epoch: 20 cost time: 62.393516540527344
Epoch: 20, Steps: 208 | Train Loss: 0.206 Vali Loss: 11.436 Vali Acc: 0.089 Test Loss: 11.436 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.6703137
	speed: 0.7037s/iter; left time: 11640.4346s
	iters: 200, epoch: 21 | loss: 0.3616813
	speed: 0.3141s/iter; left time: 5163.5580s
Epoch: 21 cost time: 64.41708421707153
Epoch: 21, Steps: 208 | Train Loss: 0.216 Vali Loss: 11.517 Vali Acc: 0.090 Test Loss: 11.517 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.5023264
	speed: 0.6583s/iter; left time: 10751.9768s
	iters: 200, epoch: 22 | loss: 0.2252192
	speed: 0.2770s/iter; left time: 4496.7725s
Epoch: 22 cost time: 58.43728446960449
Epoch: 22, Steps: 208 | Train Loss: 0.253 Vali Loss: 11.510 Vali Acc: 0.081 Test Loss: 11.510 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1350245
	speed: 0.6999s/iter; left time: 11286.6662s
	iters: 200, epoch: 23 | loss: 0.0441076
	speed: 0.2957s/iter; left time: 4738.1005s
Epoch: 23 cost time: 62.595752000808716
Epoch: 23, Steps: 208 | Train Loss: 0.220 Vali Loss: 11.641 Vali Acc: 0.089 Test Loss: 11.641 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0011711
	speed: 0.6909s/iter; left time: 10997.3935s
	iters: 200, epoch: 24 | loss: 0.0293632
	speed: 0.3043s/iter; left time: 4813.6878s
Epoch: 24 cost time: 62.93663716316223
Epoch: 24, Steps: 208 | Train Loss: 0.196 Vali Loss: 12.145 Vali Acc: 0.089 Test Loss: 12.145 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0120668
	speed: 0.6997s/iter; left time: 10991.5305s
	iters: 200, epoch: 25 | loss: 0.0709504
	speed: 0.2755s/iter; left time: 4300.1500s
Epoch: 25 cost time: 60.19260334968567
Epoch: 25, Steps: 208 | Train Loss: 0.202 Vali Loss: 12.215 Vali Acc: 0.084 Test Loss: 12.215 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0067832
	speed: 0.6969s/iter; left time: 10802.0072s
	iters: 200, epoch: 26 | loss: 0.0012710
	speed: 0.2957s/iter; left time: 4553.5581s
Epoch: 26 cost time: 62.856974840164185
Epoch: 26, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.890 Vali Acc: 0.087 Test Loss: 11.890 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0030051
	speed: 0.6894s/iter; left time: 10542.3877s
	iters: 200, epoch: 27 | loss: 0.0052524
	speed: 0.3061s/iter; left time: 4650.6177s
Epoch: 27 cost time: 62.65530252456665
Epoch: 27, Steps: 208 | Train Loss: 0.161 Vali Loss: 12.411 Vali Acc: 0.089 Test Loss: 12.411 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.3574192
	speed: 0.7198s/iter; left time: 10857.8149s
	iters: 200, epoch: 28 | loss: 0.1242325
	speed: 0.2986s/iter; left time: 4474.8522s
Epoch: 28 cost time: 62.85582733154297
Epoch: 28, Steps: 208 | Train Loss: 0.177 Vali Loss: 12.063 Vali Acc: 0.088 Test Loss: 12.063 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0029704
	speed: 0.6880s/iter; left time: 10235.7754s
	iters: 200, epoch: 29 | loss: 0.0635676
	speed: 0.3043s/iter; left time: 4496.1705s
Epoch: 29 cost time: 62.83869171142578
Epoch: 29, Steps: 208 | Train Loss: 0.144 Vali Loss: 11.873 Vali Acc: 0.089 Test Loss: 11.873 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09543692215926036
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3097758
	speed: 0.2800s/iter; left time: 5795.6335s
	iters: 200, epoch: 1 | loss: 3.6699879
	speed: 0.2875s/iter; left time: 5923.7643s
Epoch: 1 cost time: 59.36496615409851
Epoch: 1, Steps: 208 | Train Loss: 3.699 Vali Loss: 4.528 Vali Acc: 0.078 Test Loss: 4.528 Test Acc: 0.078
Validation loss decreased (inf --> -0.078094).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6721189
	speed: 0.6620s/iter; left time: 13567.1047s
	iters: 200, epoch: 2 | loss: 3.8240910
	speed: 0.2732s/iter; left time: 5571.8993s
Epoch: 2 cost time: 58.268362283706665
Epoch: 2, Steps: 208 | Train Loss: 3.176 Vali Loss: 4.878 Vali Acc: 0.083 Test Loss: 4.878 Test Acc: 0.083
Validation loss decreased (-0.078094 --> -0.082862).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8894277
	speed: 0.6290s/iter; left time: 12759.9618s
	iters: 200, epoch: 3 | loss: 2.9353321
	speed: 0.2765s/iter; left time: 5580.4026s
Epoch: 3 cost time: 57.867830991744995
Epoch: 3, Steps: 208 | Train Loss: 2.761 Vali Loss: 5.525 Vali Acc: 0.081 Test Loss: 5.525 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.5425115
	speed: 0.6221s/iter; left time: 12490.3177s
	iters: 200, epoch: 4 | loss: 2.9452059
	speed: 0.2549s/iter; left time: 5092.6480s
Epoch: 4 cost time: 54.66396713256836
Epoch: 4, Steps: 208 | Train Loss: 2.269 Vali Loss: 5.836 Vali Acc: 0.092 Test Loss: 5.836 Test Acc: 0.092
Validation loss decreased (-0.082862 --> -0.091800).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0127451
	speed: 0.6546s/iter; left time: 13005.5888s
	iters: 200, epoch: 5 | loss: 2.7661436
	speed: 0.2761s/iter; left time: 5458.4225s
Epoch: 5 cost time: 58.19897770881653
Epoch: 5, Steps: 208 | Train Loss: 1.819 Vali Loss: 6.209 Vali Acc: 0.091 Test Loss: 6.209 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0580165
	speed: 0.6190s/iter; left time: 12170.1783s
	iters: 200, epoch: 6 | loss: 2.1993670
	speed: 0.2786s/iter; left time: 5449.3151s
Epoch: 6 cost time: 56.835729360580444
Epoch: 6, Steps: 208 | Train Loss: 1.443 Vali Loss: 7.258 Vali Acc: 0.075 Test Loss: 7.258 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2925241
	speed: 0.6344s/iter; left time: 12340.8150s
	iters: 200, epoch: 7 | loss: 1.2128386
	speed: 0.2490s/iter; left time: 4819.6392s
Epoch: 7 cost time: 53.47159481048584
Epoch: 7, Steps: 208 | Train Loss: 1.161 Vali Loss: 7.143 Vali Acc: 0.089 Test Loss: 7.143 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4569830
	speed: 0.6053s/iter; left time: 11649.3597s
	iters: 200, epoch: 8 | loss: 0.7131061
	speed: 0.3080s/iter; left time: 5896.9681s
Epoch: 8 cost time: 61.65673542022705
Epoch: 8, Steps: 208 | Train Loss: 0.957 Vali Loss: 7.516 Vali Acc: 0.097 Test Loss: 7.516 Test Acc: 0.097
Validation loss decreased (-0.091800 --> -0.096853).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0775638
	speed: 0.6779s/iter; left time: 12905.3775s
	iters: 200, epoch: 9 | loss: 1.1931746
	speed: 0.2710s/iter; left time: 5132.5355s
Epoch: 9 cost time: 59.72476243972778
Epoch: 9, Steps: 208 | Train Loss: 0.818 Vali Loss: 7.817 Vali Acc: 0.093 Test Loss: 7.817 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9511670
	speed: 0.6515s/iter; left time: 12267.2466s
	iters: 200, epoch: 10 | loss: 0.7799358
	speed: 0.2764s/iter; left time: 5176.1858s
Epoch: 10 cost time: 57.92326498031616
Epoch: 10, Steps: 208 | Train Loss: 0.706 Vali Loss: 8.305 Vali Acc: 0.096 Test Loss: 8.305 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3215369
	speed: 0.6011s/iter; left time: 11193.7502s
	iters: 200, epoch: 11 | loss: 1.4797921
	speed: 0.2666s/iter; left time: 4938.5312s
Epoch: 11 cost time: 55.15653467178345
Epoch: 11, Steps: 208 | Train Loss: 0.619 Vali Loss: 8.405 Vali Acc: 0.097 Test Loss: 8.405 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3297506
	speed: 0.6442s/iter; left time: 11862.0992s
	iters: 200, epoch: 12 | loss: 0.0882448
	speed: 0.2699s/iter; left time: 4943.4864s
Epoch: 12 cost time: 57.38528084754944
Epoch: 12, Steps: 208 | Train Loss: 0.556 Vali Loss: 8.688 Vali Acc: 0.090 Test Loss: 8.688 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6428058
	speed: 0.6244s/iter; left time: 11367.9236s
	iters: 200, epoch: 13 | loss: 0.8732594
	speed: 0.2743s/iter; left time: 4966.0232s
Epoch: 13 cost time: 56.34207224845886
Epoch: 13, Steps: 208 | Train Loss: 0.468 Vali Loss: 9.363 Vali Acc: 0.091 Test Loss: 9.363 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0969400
	speed: 0.6466s/iter; left time: 11636.3729s
	iters: 200, epoch: 14 | loss: 0.4517220
	speed: 0.2628s/iter; left time: 4704.1470s
Epoch: 14 cost time: 56.26881718635559
Epoch: 14, Steps: 208 | Train Loss: 0.443 Vali Loss: 10.085 Vali Acc: 0.094 Test Loss: 10.085 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.7040575
	speed: 0.6276s/iter; left time: 11164.0202s
	iters: 200, epoch: 15 | loss: 0.0901253
	speed: 0.2770s/iter; left time: 4900.7222s
Epoch: 15 cost time: 57.74056363105774
Epoch: 15, Steps: 208 | Train Loss: 0.420 Vali Loss: 9.558 Vali Acc: 0.089 Test Loss: 9.558 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3544833
	speed: 0.6058s/iter; left time: 10649.9974s
	iters: 200, epoch: 16 | loss: 0.3231834
	speed: 0.2530s/iter; left time: 4421.9547s
Epoch: 16 cost time: 52.96640205383301
Epoch: 16, Steps: 208 | Train Loss: 0.378 Vali Loss: 9.670 Vali Acc: 0.094 Test Loss: 9.670 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2671811
	speed: 0.6317s/iter; left time: 10974.4256s
	iters: 200, epoch: 17 | loss: 0.4115509
	speed: 0.2721s/iter; left time: 4700.8074s
Epoch: 17 cost time: 57.08657193183899
Epoch: 17, Steps: 208 | Train Loss: 0.374 Vali Loss: 9.935 Vali Acc: 0.103 Test Loss: 9.935 Test Acc: 0.103
Validation loss decreased (-0.096853 --> -0.102794).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1644857
	speed: 0.6291s/iter; left time: 10798.2973s
	iters: 200, epoch: 18 | loss: 0.0551193
	speed: 0.2711s/iter; left time: 4625.8700s
Epoch: 18 cost time: 56.96832251548767
Epoch: 18, Steps: 208 | Train Loss: 0.303 Vali Loss: 10.503 Vali Acc: 0.096 Test Loss: 10.503 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3751190
	speed: 0.6628s/iter; left time: 11239.6504s
	iters: 200, epoch: 19 | loss: 0.2348245
	speed: 0.2614s/iter; left time: 4406.8487s
Epoch: 19 cost time: 56.07772350311279
Epoch: 19, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.700 Vali Acc: 0.092 Test Loss: 10.700 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1908251
	speed: 0.5878s/iter; left time: 9844.7246s
	iters: 200, epoch: 20 | loss: 0.0224636
	speed: 0.2741s/iter; left time: 4563.3736s
Epoch: 20 cost time: 56.40499496459961
Epoch: 20, Steps: 208 | Train Loss: 0.270 Vali Loss: 11.215 Vali Acc: 0.100 Test Loss: 11.215 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2340778
	speed: 0.6494s/iter; left time: 10742.1901s
	iters: 200, epoch: 21 | loss: 0.1216423
	speed: 0.2934s/iter; left time: 4823.9964s
Epoch: 21 cost time: 60.00226926803589
Epoch: 21, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.154 Vali Acc: 0.102 Test Loss: 11.154 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3272884
	speed: 0.7036s/iter; left time: 11491.5589s
	iters: 200, epoch: 22 | loss: 0.1029505
	speed: 0.3025s/iter; left time: 4911.2622s
Epoch: 22 cost time: 63.902602195739746
Epoch: 22, Steps: 208 | Train Loss: 0.259 Vali Loss: 11.512 Vali Acc: 0.094 Test Loss: 11.512 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1100131
	speed: 0.6793s/iter; left time: 10954.0498s
	iters: 200, epoch: 23 | loss: 0.4311529
	speed: 0.2874s/iter; left time: 4604.8763s
Epoch: 23 cost time: 60.720850229263306
Epoch: 23, Steps: 208 | Train Loss: 0.253 Vali Loss: 10.993 Vali Acc: 0.103 Test Loss: 10.993 Test Acc: 0.103
Validation loss decreased (-0.102794 --> -0.103379).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1240814
	speed: 0.6832s/iter; left time: 10874.6773s
	iters: 200, epoch: 24 | loss: 0.0201963
	speed: 0.2741s/iter; left time: 4334.7262s
Epoch: 24 cost time: 58.97625732421875
Epoch: 24, Steps: 208 | Train Loss: 0.212 Vali Loss: 11.286 Vali Acc: 0.096 Test Loss: 11.286 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0778728
	speed: 0.6609s/iter; left time: 10382.6821s
	iters: 200, epoch: 25 | loss: 0.2129689
	speed: 0.3010s/iter; left time: 4698.7939s
Epoch: 25 cost time: 62.61445879936218
Epoch: 25, Steps: 208 | Train Loss: 0.206 Vali Loss: 11.998 Vali Acc: 0.100 Test Loss: 11.998 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.1145008
	speed: 0.6633s/iter; left time: 10282.2992s
	iters: 200, epoch: 26 | loss: 0.0274540
	speed: 0.2931s/iter; left time: 4514.2518s
Epoch: 26 cost time: 61.02528977394104
Epoch: 26, Steps: 208 | Train Loss: 0.188 Vali Loss: 11.861 Vali Acc: 0.090 Test Loss: 11.861 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0440820
	speed: 0.7010s/iter; left time: 10720.6487s
	iters: 200, epoch: 27 | loss: 0.2054527
	speed: 0.2677s/iter; left time: 4067.5643s
Epoch: 27 cost time: 59.36933898925781
Epoch: 27, Steps: 208 | Train Loss: 0.195 Vali Loss: 12.126 Vali Acc: 0.098 Test Loss: 12.126 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0843080
	speed: 0.6202s/iter; left time: 9356.4488s
	iters: 200, epoch: 28 | loss: 0.0825857
	speed: 0.2718s/iter; left time: 4073.4516s
Epoch: 28 cost time: 57.53291916847229
Epoch: 28, Steps: 208 | Train Loss: 0.164 Vali Loss: 12.527 Vali Acc: 0.089 Test Loss: 12.527 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2263761
	speed: 0.6590s/iter; left time: 9803.6404s
	iters: 200, epoch: 29 | loss: 0.1239469
	speed: 0.2920s/iter; left time: 4315.0412s
Epoch: 29 cost time: 60.303690910339355
Epoch: 29, Steps: 208 | Train Loss: 0.191 Vali Loss: 11.871 Vali Acc: 0.090 Test Loss: 11.871 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.5134549
	speed: 0.6603s/iter; left time: 9685.8703s
	iters: 200, epoch: 30 | loss: 0.0304405
	speed: 0.2987s/iter; left time: 4351.8993s
Epoch: 30 cost time: 61.26813626289368
Epoch: 30, Steps: 208 | Train Loss: 0.167 Vali Loss: 12.800 Vali Acc: 0.089 Test Loss: 12.800 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.5153167
	speed: 0.6435s/iter; left time: 9305.1307s
	iters: 200, epoch: 31 | loss: 0.1044145
	speed: 0.2789s/iter; left time: 4005.3202s
Epoch: 31 cost time: 58.572208404541016
Epoch: 31, Steps: 208 | Train Loss: 0.152 Vali Loss: 12.955 Vali Acc: 0.091 Test Loss: 12.955 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.5478809
	speed: 0.6371s/iter; left time: 9080.0987s
	iters: 200, epoch: 32 | loss: 0.4127572
	speed: 0.2599s/iter; left time: 3678.8363s
Epoch: 32 cost time: 54.03024744987488
Epoch: 32, Steps: 208 | Train Loss: 0.173 Vali Loss: 13.000 Vali Acc: 0.091 Test Loss: 13.000 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0501353
	speed: 0.6582s/iter; left time: 9244.7417s
	iters: 200, epoch: 33 | loss: 0.0034063
	speed: 0.2776s/iter; left time: 3870.8582s
Epoch: 33 cost time: 60.330262899398804
Epoch: 33, Steps: 208 | Train Loss: 0.166 Vali Loss: 12.787 Vali Acc: 0.099 Test Loss: 12.787 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10348941246644795
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3991361
	speed: 0.2940s/iter; left time: 6086.5726s
	iters: 200, epoch: 1 | loss: 3.9795980
	speed: 0.2582s/iter; left time: 5318.8577s
Epoch: 1 cost time: 57.398404598236084
Epoch: 1, Steps: 208 | Train Loss: 3.718 Vali Loss: 4.389 Vali Acc: 0.075 Test Loss: 4.389 Test Acc: 0.075
Validation loss decreased (inf --> -0.075113).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5431814
	speed: 0.6145s/iter; left time: 12592.0298s
	iters: 200, epoch: 2 | loss: 3.9332500
	speed: 0.2742s/iter; left time: 5592.1029s
Epoch: 2 cost time: 56.98907971382141
Epoch: 2, Steps: 208 | Train Loss: 3.292 Vali Loss: 5.021 Vali Acc: 0.073 Test Loss: 5.021 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.1215236
	speed: 0.5944s/iter; left time: 12056.8240s
	iters: 200, epoch: 3 | loss: 3.4532940
	speed: 0.2806s/iter; left time: 5664.1276s
Epoch: 3 cost time: 56.8221333026886
Epoch: 3, Steps: 208 | Train Loss: 2.975 Vali Loss: 5.527 Vali Acc: 0.076 Test Loss: 5.527 Test Acc: 0.076
Validation loss decreased (-0.075113 --> -0.075698).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0404110
	speed: 0.6630s/iter; left time: 13311.0903s
	iters: 200, epoch: 4 | loss: 3.3714142
	speed: 0.2648s/iter; left time: 5289.1032s
Epoch: 4 cost time: 57.01218771934509
Epoch: 4, Steps: 208 | Train Loss: 2.537 Vali Loss: 6.236 Vali Acc: 0.078 Test Loss: 6.236 Test Acc: 0.078
Validation loss decreased (-0.075698 --> -0.077778).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8786223
	speed: 0.6542s/iter; left time: 12997.8985s
	iters: 200, epoch: 5 | loss: 3.5118196
	speed: 0.2797s/iter; left time: 5529.5535s
Epoch: 5 cost time: 58.778021574020386
Epoch: 5, Steps: 208 | Train Loss: 2.228 Vali Loss: 6.160 Vali Acc: 0.084 Test Loss: 6.160 Test Acc: 0.084
Validation loss decreased (-0.077778 --> -0.083744).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2499961
	speed: 0.6259s/iter; left time: 12305.2745s
	iters: 200, epoch: 6 | loss: 1.9375523
	speed: 0.2806s/iter; left time: 5488.5453s
Epoch: 6 cost time: 58.36702847480774
Epoch: 6, Steps: 208 | Train Loss: 1.789 Vali Loss: 7.078 Vali Acc: 0.060 Test Loss: 7.078 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3943404
	speed: 0.6200s/iter; left time: 12061.0752s
	iters: 200, epoch: 7 | loss: 1.9582087
	speed: 0.2716s/iter; left time: 5256.0873s
Epoch: 7 cost time: 56.37547969818115
Epoch: 7, Steps: 208 | Train Loss: 1.503 Vali Loss: 7.234 Vali Acc: 0.085 Test Loss: 7.234 Test Acc: 0.085
Validation loss decreased (-0.083744 --> -0.085224).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8119926
	speed: 0.6558s/iter; left time: 12620.4964s
	iters: 200, epoch: 8 | loss: 0.9792849
	speed: 0.2737s/iter; left time: 5239.2150s
Epoch: 8 cost time: 56.85321617126465
Epoch: 8, Steps: 208 | Train Loss: 1.239 Vali Loss: 7.631 Vali Acc: 0.079 Test Loss: 7.631 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7860819
	speed: 0.6351s/iter; left time: 12090.7185s
	iters: 200, epoch: 9 | loss: 1.6691387
	speed: 0.2771s/iter; left time: 5246.5713s
Epoch: 9 cost time: 58.005608320236206
Epoch: 9, Steps: 208 | Train Loss: 1.053 Vali Loss: 7.995 Vali Acc: 0.083 Test Loss: 7.995 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2788380
	speed: 0.6229s/iter; left time: 11728.4351s
	iters: 200, epoch: 10 | loss: 2.0119538
	speed: 0.2740s/iter; left time: 5131.8088s
Epoch: 10 cost time: 57.026273250579834
Epoch: 10, Steps: 208 | Train Loss: 0.906 Vali Loss: 8.144 Vali Acc: 0.086 Test Loss: 8.144 Test Acc: 0.086
Validation loss decreased (-0.085224 --> -0.086408).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1776942
	speed: 0.6329s/iter; left time: 11784.7622s
	iters: 200, epoch: 11 | loss: 0.3495458
	speed: 0.2671s/iter; left time: 4946.4897s
Epoch: 11 cost time: 55.63229966163635
Epoch: 11, Steps: 208 | Train Loss: 0.768 Vali Loss: 8.722 Vali Acc: 0.081 Test Loss: 8.722 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0916632
	speed: 0.6414s/iter; left time: 11809.2051s
	iters: 200, epoch: 12 | loss: 0.2985602
	speed: 0.2706s/iter; left time: 4956.1869s
Epoch: 12 cost time: 57.56416583061218
Epoch: 12, Steps: 208 | Train Loss: 0.709 Vali Loss: 8.553 Vali Acc: 0.085 Test Loss: 8.553 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1898572
	speed: 0.6321s/iter; left time: 11507.8828s
	iters: 200, epoch: 13 | loss: 1.0104163
	speed: 0.2767s/iter; left time: 5009.8843s
Epoch: 13 cost time: 58.07836103439331
Epoch: 13, Steps: 208 | Train Loss: 0.610 Vali Loss: 9.050 Vali Acc: 0.089 Test Loss: 9.050 Test Acc: 0.089
Validation loss decreased (-0.086408 --> -0.089382).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2496320
	speed: 0.6123s/iter; left time: 11020.2084s
	iters: 200, epoch: 14 | loss: 0.5485347
	speed: 0.2846s/iter; left time: 5093.6413s
Epoch: 14 cost time: 56.84891152381897
Epoch: 14, Steps: 208 | Train Loss: 0.535 Vali Loss: 9.072 Vali Acc: 0.091 Test Loss: 9.072 Test Acc: 0.091
Validation loss decreased (-0.089382 --> -0.091171).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7800629
	speed: 0.6384s/iter; left time: 11356.6235s
	iters: 200, epoch: 15 | loss: 0.4543602
	speed: 0.2778s/iter; left time: 4913.7048s
Epoch: 15 cost time: 56.55440044403076
Epoch: 15, Steps: 208 | Train Loss: 0.533 Vali Loss: 9.080 Vali Acc: 0.089 Test Loss: 9.080 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6593978
	speed: 0.6512s/iter; left time: 11447.8929s
	iters: 200, epoch: 16 | loss: 1.0025859
	speed: 0.2605s/iter; left time: 4554.1836s
Epoch: 16 cost time: 56.539098024368286
Epoch: 16, Steps: 208 | Train Loss: 0.466 Vali Loss: 9.559 Vali Acc: 0.091 Test Loss: 9.559 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2608559
	speed: 0.6379s/iter; left time: 11081.4745s
	iters: 200, epoch: 17 | loss: 0.5676695
	speed: 0.2856s/iter; left time: 4933.3496s
Epoch: 17 cost time: 59.64816689491272
Epoch: 17, Steps: 208 | Train Loss: 0.446 Vali Loss: 9.589 Vali Acc: 0.092 Test Loss: 9.589 Test Acc: 0.092
Validation loss decreased (-0.091171 --> -0.092359).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.8018306
	speed: 0.6268s/iter; left time: 10759.1409s
	iters: 200, epoch: 18 | loss: 0.5679336
	speed: 0.2807s/iter; left time: 4790.2915s
Epoch: 18 cost time: 57.96271014213562
Epoch: 18, Steps: 208 | Train Loss: 0.377 Vali Loss: 9.834 Vali Acc: 0.088 Test Loss: 9.834 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1680834
	speed: 0.6640s/iter; left time: 11259.7848s
	iters: 200, epoch: 19 | loss: 0.4624783
	speed: 0.2847s/iter; left time: 4798.9988s
Epoch: 19 cost time: 59.3101761341095
Epoch: 19, Steps: 208 | Train Loss: 0.356 Vali Loss: 10.518 Vali Acc: 0.089 Test Loss: 10.518 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0725547
	speed: 0.6748s/iter; left time: 11301.4297s
	iters: 200, epoch: 20 | loss: 0.1041369
	speed: 0.2697s/iter; left time: 4489.4437s
Epoch: 20 cost time: 59.32919216156006
Epoch: 20, Steps: 208 | Train Loss: 0.332 Vali Loss: 10.679 Vali Acc: 0.077 Test Loss: 10.679 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4037480
	speed: 0.6302s/iter; left time: 10423.7379s
	iters: 200, epoch: 21 | loss: 0.3169042
	speed: 0.2801s/iter; left time: 4604.5995s
Epoch: 21 cost time: 58.71185851097107
Epoch: 21, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.740 Vali Acc: 0.082 Test Loss: 10.740 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.4385070
	speed: 0.6357s/iter; left time: 10383.2844s
	iters: 200, epoch: 22 | loss: 0.3140070
	speed: 0.2879s/iter; left time: 4673.7057s
Epoch: 22 cost time: 59.070327043533325
Epoch: 22, Steps: 208 | Train Loss: 0.292 Vali Loss: 10.948 Vali Acc: 0.079 Test Loss: 10.948 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3010324
	speed: 0.6685s/iter; left time: 10779.4293s
	iters: 200, epoch: 23 | loss: 0.5117911
	speed: 0.2697s/iter; left time: 4322.0708s
Epoch: 23 cost time: 57.919241428375244
Epoch: 23, Steps: 208 | Train Loss: 0.315 Vali Loss: 11.030 Vali Acc: 0.095 Test Loss: 11.030 Test Acc: 0.095
Validation loss decreased (-0.092359 --> -0.094432).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.7059045
	speed: 0.6399s/iter; left time: 10185.8817s
	iters: 200, epoch: 24 | loss: 0.1141414
	speed: 0.2605s/iter; left time: 4120.8712s
Epoch: 24 cost time: 55.69508600234985
Epoch: 24, Steps: 208 | Train Loss: 0.288 Vali Loss: 11.306 Vali Acc: 0.086 Test Loss: 11.306 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1046228
	speed: 0.6261s/iter; left time: 9836.0145s
	iters: 200, epoch: 25 | loss: 0.4465984
	speed: 0.2864s/iter; left time: 4469.7066s
Epoch: 25 cost time: 59.37556219100952
Epoch: 25, Steps: 208 | Train Loss: 0.251 Vali Loss: 10.692 Vali Acc: 0.091 Test Loss: 10.692 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0197285
	speed: 0.6340s/iter; left time: 9827.9630s
	iters: 200, epoch: 26 | loss: 0.1697133
	speed: 0.2852s/iter; left time: 4392.6187s
Epoch: 26 cost time: 59.03847098350525
Epoch: 26, Steps: 208 | Train Loss: 0.244 Vali Loss: 11.169 Vali Acc: 0.082 Test Loss: 11.169 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0189297
	speed: 0.6526s/iter; left time: 9980.1007s
	iters: 200, epoch: 27 | loss: 0.0872540
	speed: 0.2631s/iter; left time: 3997.1746s
Epoch: 27 cost time: 56.67783522605896
Epoch: 27, Steps: 208 | Train Loss: 0.217 Vali Loss: 11.160 Vali Acc: 0.086 Test Loss: 11.160 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.4060444
	speed: 0.6625s/iter; left time: 9993.8781s
	iters: 200, epoch: 28 | loss: 0.1139174
	speed: 0.2654s/iter; left time: 3977.2500s
Epoch: 28 cost time: 58.39236617088318
Epoch: 28, Steps: 208 | Train Loss: 0.221 Vali Loss: 11.400 Vali Acc: 0.089 Test Loss: 11.400 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1312945
	speed: 0.6368s/iter; left time: 9473.5457s
	iters: 200, epoch: 29 | loss: 0.2353801
	speed: 0.2917s/iter; left time: 4309.8923s
Epoch: 29 cost time: 60.96317386627197
Epoch: 29, Steps: 208 | Train Loss: 0.244 Vali Loss: 11.228 Vali Acc: 0.085 Test Loss: 11.228 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1868975
	speed: 0.6565s/iter; left time: 9629.6632s
	iters: 200, epoch: 30 | loss: 0.0308613
	speed: 0.2851s/iter; left time: 4154.3350s
Epoch: 30 cost time: 59.230042934417725
Epoch: 30, Steps: 208 | Train Loss: 0.206 Vali Loss: 11.175 Vali Acc: 0.088 Test Loss: 11.175 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.3610662
	speed: 0.6331s/iter; left time: 9155.2370s
	iters: 200, epoch: 31 | loss: 0.3415775
	speed: 0.2675s/iter; left time: 3840.9308s
Epoch: 31 cost time: 56.018861055374146
Epoch: 31, Steps: 208 | Train Loss: 0.215 Vali Loss: 11.609 Vali Acc: 0.091 Test Loss: 11.609 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.1990689
	speed: 0.6595s/iter; left time: 9400.3585s
	iters: 200, epoch: 32 | loss: 0.3086071
	speed: 0.2729s/iter; left time: 3861.7485s
Epoch: 32 cost time: 58.19689130783081
Epoch: 32, Steps: 208 | Train Loss: 0.179 Vali Loss: 11.841 Vali Acc: 0.088 Test Loss: 11.841 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0110841
	speed: 0.6703s/iter; left time: 9413.7243s
	iters: 200, epoch: 33 | loss: 0.1226394
	speed: 0.3050s/iter; left time: 4253.7635s
Epoch: 33 cost time: 62.912550926208496
Epoch: 33, Steps: 208 | Train Loss: 0.163 Vali Loss: 12.071 Vali Acc: 0.089 Test Loss: 12.071 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0945422010140173
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4728065
	speed: 0.3011s/iter; left time: 6232.6100s
	iters: 200, epoch: 1 | loss: 3.7983255
	speed: 0.2857s/iter; left time: 5885.7349s
Epoch: 1 cost time: 61.191288232803345
Epoch: 1, Steps: 208 | Train Loss: 3.725 Vali Loss: 4.943 Vali Acc: 0.040 Test Loss: 4.943 Test Acc: 0.040
Validation loss decreased (inf --> -0.039915).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5909386
	speed: 0.6241s/iter; left time: 12788.8989s
	iters: 200, epoch: 2 | loss: 3.8133371
	speed: 0.2901s/iter; left time: 5915.4641s
Epoch: 2 cost time: 59.53923940658569
Epoch: 2, Steps: 208 | Train Loss: 3.371 Vali Loss: 5.418 Vali Acc: 0.041 Test Loss: 5.418 Test Acc: 0.041
Validation loss decreased (-0.039915 --> -0.040805).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4623115
	speed: 0.6527s/iter; left time: 13240.7124s
	iters: 200, epoch: 3 | loss: 4.5226836
	speed: 0.2649s/iter; left time: 5346.1978s
Epoch: 3 cost time: 56.56638264656067
Epoch: 3, Steps: 208 | Train Loss: 3.147 Vali Loss: 5.846 Vali Acc: 0.048 Test Loss: 5.846 Test Acc: 0.048
Validation loss decreased (-0.040805 --> -0.047660).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1707504
	speed: 0.6500s/iter; left time: 13050.1827s
	iters: 200, epoch: 4 | loss: 3.0574541
	speed: 0.2932s/iter; left time: 5856.7247s
Epoch: 4 cost time: 61.087990522384644
Epoch: 4, Steps: 208 | Train Loss: 2.886 Vali Loss: 6.283 Vali Acc: 0.055 Test Loss: 6.283 Test Acc: 0.055
Validation loss decreased (-0.047660 --> -0.054813).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1920295
	speed: 0.6486s/iter; left time: 12886.4878s
	iters: 200, epoch: 5 | loss: 3.4176672
	speed: 0.2935s/iter; left time: 5801.6445s
Epoch: 5 cost time: 60.70350790023804
Epoch: 5, Steps: 208 | Train Loss: 2.627 Vali Loss: 5.777 Vali Acc: 0.058 Test Loss: 5.777 Test Acc: 0.058
Validation loss decreased (-0.054813 --> -0.057503).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1881905
	speed: 0.6512s/iter; left time: 12804.1720s
	iters: 200, epoch: 6 | loss: 1.9766836
	speed: 0.2869s/iter; left time: 5611.2651s
Epoch: 6 cost time: 59.69672179222107
Epoch: 6, Steps: 208 | Train Loss: 2.209 Vali Loss: 6.825 Vali Acc: 0.050 Test Loss: 6.825 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5055550
	speed: 0.6709s/iter; left time: 13050.8285s
	iters: 200, epoch: 7 | loss: 2.3138478
	speed: 0.2947s/iter; left time: 5702.6046s
Epoch: 7 cost time: 62.6428005695343
Epoch: 7, Steps: 208 | Train Loss: 1.839 Vali Loss: 6.424 Vali Acc: 0.067 Test Loss: 6.424 Test Acc: 0.067
Validation loss decreased (-0.057503 --> -0.067338).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4768553
	speed: 0.6824s/iter; left time: 13132.7287s
	iters: 200, epoch: 8 | loss: 1.5778775
	speed: 0.2962s/iter; left time: 5670.1813s
Epoch: 8 cost time: 61.13192653656006
Epoch: 8, Steps: 208 | Train Loss: 1.509 Vali Loss: 7.070 Vali Acc: 0.070 Test Loss: 7.070 Test Acc: 0.070
Validation loss decreased (-0.067338 --> -0.070314).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5612448
	speed: 0.6582s/iter; left time: 12529.9451s
	iters: 200, epoch: 9 | loss: 1.8370550
	speed: 0.2930s/iter; left time: 5549.2241s
Epoch: 9 cost time: 60.13642740249634
Epoch: 9, Steps: 208 | Train Loss: 1.267 Vali Loss: 7.460 Vali Acc: 0.074 Test Loss: 7.460 Test Acc: 0.074
Validation loss decreased (-0.070314 --> -0.073889).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1292033
	speed: 0.6519s/iter; left time: 12274.3348s
	iters: 200, epoch: 10 | loss: 1.1791155
	speed: 0.2991s/iter; left time: 5602.2499s
Epoch: 10 cost time: 62.02426266670227
Epoch: 10, Steps: 208 | Train Loss: 1.052 Vali Loss: 7.740 Vali Acc: 0.075 Test Loss: 7.740 Test Acc: 0.075
Validation loss decreased (-0.073889 --> -0.074483).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6231754
	speed: 0.6658s/iter; left time: 12398.3423s
	iters: 200, epoch: 11 | loss: 1.1675107
	speed: 0.2930s/iter; left time: 5426.4844s
Epoch: 11 cost time: 61.030308961868286
Epoch: 11, Steps: 208 | Train Loss: 0.912 Vali Loss: 8.370 Vali Acc: 0.075 Test Loss: 8.370 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0242372
	speed: 0.6180s/iter; left time: 11380.0961s
	iters: 200, epoch: 12 | loss: 0.4432951
	speed: 0.2813s/iter; left time: 5151.8020s
Epoch: 12 cost time: 56.68431091308594
Epoch: 12, Steps: 208 | Train Loss: 0.810 Vali Loss: 8.697 Vali Acc: 0.073 Test Loss: 8.697 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1946699
	speed: 0.6165s/iter; left time: 11222.4943s
	iters: 200, epoch: 13 | loss: 1.1349297
	speed: 0.2834s/iter; left time: 5130.7248s
Epoch: 13 cost time: 57.632890462875366
Epoch: 13, Steps: 208 | Train Loss: 0.711 Vali Loss: 8.584 Vali Acc: 0.080 Test Loss: 8.584 Test Acc: 0.080
Validation loss decreased (-0.074483 --> -0.080141).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9809449
	speed: 0.6535s/iter; left time: 11760.6761s
	iters: 200, epoch: 14 | loss: 0.3804243
	speed: 0.2870s/iter; left time: 5136.2470s
Epoch: 14 cost time: 58.88596153259277
Epoch: 14, Steps: 208 | Train Loss: 0.634 Vali Loss: 9.157 Vali Acc: 0.079 Test Loss: 9.157 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9220490
	speed: 0.6729s/iter; left time: 11970.8683s
	iters: 200, epoch: 15 | loss: 0.9768181
	speed: 0.2712s/iter; left time: 4796.6429s
Epoch: 15 cost time: 58.58185815811157
Epoch: 15, Steps: 208 | Train Loss: 0.530 Vali Loss: 9.274 Vali Acc: 0.069 Test Loss: 9.274 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6370480
	speed: 0.6354s/iter; left time: 11170.2946s
	iters: 200, epoch: 16 | loss: 0.5628974
	speed: 0.2635s/iter; left time: 4605.6987s
Epoch: 16 cost time: 54.87011241912842
Epoch: 16, Steps: 208 | Train Loss: 0.528 Vali Loss: 9.850 Vali Acc: 0.072 Test Loss: 9.850 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4829547
	speed: 0.6500s/iter; left time: 11292.0861s
	iters: 200, epoch: 17 | loss: 1.1913122
	speed: 0.2726s/iter; left time: 4707.7939s
Epoch: 17 cost time: 57.634207248687744
Epoch: 17, Steps: 208 | Train Loss: 0.495 Vali Loss: 9.727 Vali Acc: 0.080 Test Loss: 9.727 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5475653
	speed: 0.6624s/iter; left time: 11369.2852s
	iters: 200, epoch: 18 | loss: 0.4896891
	speed: 0.2857s/iter; left time: 4874.6776s
Epoch: 18 cost time: 59.89067459106445
Epoch: 18, Steps: 208 | Train Loss: 0.396 Vali Loss: 10.655 Vali Acc: 0.072 Test Loss: 10.655 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4888266
	speed: 0.6862s/iter; left time: 11635.3795s
	iters: 200, epoch: 19 | loss: 0.4479646
	speed: 0.2824s/iter; left time: 4760.4898s
Epoch: 19 cost time: 61.279038190841675
Epoch: 19, Steps: 208 | Train Loss: 0.408 Vali Loss: 10.072 Vali Acc: 0.080 Test Loss: 10.072 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1888428
	speed: 0.6780s/iter; left time: 11356.3297s
	iters: 200, epoch: 20 | loss: 0.0770288
	speed: 0.2728s/iter; left time: 4542.1640s
Epoch: 20 cost time: 59.18947625160217
Epoch: 20, Steps: 208 | Train Loss: 0.366 Vali Loss: 10.474 Vali Acc: 0.080 Test Loss: 10.474 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1749622
	speed: 0.6676s/iter; left time: 11042.1089s
	iters: 200, epoch: 21 | loss: 0.1761839
	speed: 0.2849s/iter; left time: 4684.2066s
Epoch: 21 cost time: 59.33040523529053
Epoch: 21, Steps: 208 | Train Loss: 0.333 Vali Loss: 10.216 Vali Acc: 0.076 Test Loss: 10.216 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3881653
	speed: 0.6659s/iter; left time: 10876.5390s
	iters: 200, epoch: 22 | loss: 0.1999936
	speed: 0.2799s/iter; left time: 4543.8267s
Epoch: 22 cost time: 59.869657039642334
Epoch: 22, Steps: 208 | Train Loss: 0.309 Vali Loss: 11.136 Vali Acc: 0.078 Test Loss: 11.136 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.1955119
	speed: 0.6623s/iter; left time: 10679.7517s
	iters: 200, epoch: 23 | loss: 0.3347195
	speed: 0.2723s/iter; left time: 4364.3347s
Epoch: 23 cost time: 59.16004037857056
Epoch: 23, Steps: 208 | Train Loss: 0.308 Vali Loss: 11.418 Vali Acc: 0.074 Test Loss: 11.418 Test Acc: 0.074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08022666269012824
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2355666
	speed: 0.3022s/iter; left time: 6254.9820s
	iters: 200, epoch: 1 | loss: 3.6945086
	speed: 0.2846s/iter; left time: 5862.8892s
Epoch: 1 cost time: 61.36355185508728
Epoch: 1, Steps: 208 | Train Loss: 3.675 Vali Loss: 5.570 Vali Acc: 0.035 Test Loss: 5.570 Test Acc: 0.035
Validation loss decreased (inf --> -0.034540).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7600825
	speed: 0.7069s/iter; left time: 14487.2879s
	iters: 200, epoch: 2 | loss: 3.3087928
	speed: 0.2841s/iter; left time: 5794.2203s
Epoch: 2 cost time: 60.107685565948486
Epoch: 2, Steps: 208 | Train Loss: 3.380 Vali Loss: 6.248 Vali Acc: 0.033 Test Loss: 6.248 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.8459921
	speed: 0.6715s/iter; left time: 13620.8379s
	iters: 200, epoch: 3 | loss: 3.6331279
	speed: 0.2753s/iter; left time: 5555.9801s
Epoch: 3 cost time: 56.62216901779175
Epoch: 3, Steps: 208 | Train Loss: 3.281 Vali Loss: 6.087 Vali Acc: 0.038 Test Loss: 6.087 Test Acc: 0.038
Validation loss decreased (-0.034540 --> -0.038412).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7277811
	speed: 0.6846s/iter; left time: 13745.4832s
	iters: 200, epoch: 4 | loss: 3.5021532
	speed: 0.2754s/iter; left time: 5502.5855s
Epoch: 4 cost time: 58.09755778312683
Epoch: 4, Steps: 208 | Train Loss: 3.126 Vali Loss: 6.076 Vali Acc: 0.050 Test Loss: 6.076 Test Acc: 0.050
Validation loss decreased (-0.038412 --> -0.050044).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5372081
	speed: 0.6893s/iter; left time: 13695.8486s
	iters: 200, epoch: 5 | loss: 3.1042693
	speed: 0.2926s/iter; left time: 5783.8357s
Epoch: 5 cost time: 60.52990531921387
Epoch: 5, Steps: 208 | Train Loss: 2.892 Vali Loss: 5.693 Vali Acc: 0.058 Test Loss: 5.693 Test Acc: 0.058
Validation loss decreased (-0.050044 --> -0.057802).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9406462
	speed: 0.6633s/iter; left time: 13040.6506s
	iters: 200, epoch: 6 | loss: 2.7941632
	speed: 0.2800s/iter; left time: 5477.2301s
Epoch: 6 cost time: 58.44602680206299
Epoch: 6, Steps: 208 | Train Loss: 2.493 Vali Loss: 5.773 Vali Acc: 0.055 Test Loss: 5.773 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0331872
	speed: 0.6751s/iter; left time: 13133.0580s
	iters: 200, epoch: 7 | loss: 2.9623406
	speed: 0.2816s/iter; left time: 5450.6747s
Epoch: 7 cost time: 59.56018280982971
Epoch: 7, Steps: 208 | Train Loss: 2.172 Vali Loss: 6.017 Vali Acc: 0.069 Test Loss: 6.017 Test Acc: 0.069
Validation loss decreased (-0.057802 --> -0.069430).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6756401
	speed: 0.6785s/iter; left time: 13057.6493s
	iters: 200, epoch: 8 | loss: 1.2118257
	speed: 0.2828s/iter; left time: 5415.0846s
Epoch: 8 cost time: 60.16490817070007
Epoch: 8, Steps: 208 | Train Loss: 1.813 Vali Loss: 6.458 Vali Acc: 0.064 Test Loss: 6.458 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2595203
	speed: 0.6771s/iter; left time: 12889.6671s
	iters: 200, epoch: 9 | loss: 1.5148351
	speed: 0.2910s/iter; left time: 5509.8598s
Epoch: 9 cost time: 60.48903250694275
Epoch: 9, Steps: 208 | Train Loss: 1.537 Vali Loss: 6.325 Vali Acc: 0.072 Test Loss: 6.325 Test Acc: 0.072
Validation loss decreased (-0.069430 --> -0.072111).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2067411
	speed: 0.6854s/iter; left time: 12905.4459s
	iters: 200, epoch: 10 | loss: 1.3890013
	speed: 0.2874s/iter; left time: 5382.8867s
Epoch: 10 cost time: 60.02060341835022
Epoch: 10, Steps: 208 | Train Loss: 1.259 Vali Loss: 6.827 Vali Acc: 0.070 Test Loss: 6.827 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3716840
	speed: 0.6972s/iter; left time: 12981.8185s
	iters: 200, epoch: 11 | loss: 1.6115732
	speed: 0.2734s/iter; left time: 5064.3084s
Epoch: 11 cost time: 60.50720024108887
Epoch: 11, Steps: 208 | Train Loss: 1.067 Vali Loss: 6.812 Vali Acc: 0.082 Test Loss: 6.812 Test Acc: 0.082
Validation loss decreased (-0.072111 --> -0.081948).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0977552
	speed: 0.6507s/iter; left time: 11981.8334s
	iters: 200, epoch: 12 | loss: 0.8902664
	speed: 0.2692s/iter; left time: 4930.5022s
Epoch: 12 cost time: 58.69606423377991
Epoch: 12, Steps: 208 | Train Loss: 0.916 Vali Loss: 7.322 Vali Acc: 0.075 Test Loss: 7.322 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2968303
	speed: 0.6610s/iter; left time: 12033.6046s
	iters: 200, epoch: 13 | loss: 1.1770091
	speed: 0.2839s/iter; left time: 5139.9190s
Epoch: 13 cost time: 58.311654567718506
Epoch: 13, Steps: 208 | Train Loss: 0.776 Vali Loss: 7.585 Vali Acc: 0.079 Test Loss: 7.585 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3615988
	speed: 0.6398s/iter; left time: 11515.0761s
	iters: 200, epoch: 14 | loss: 0.9301203
	speed: 0.2739s/iter; left time: 4902.7521s
Epoch: 14 cost time: 57.43896508216858
Epoch: 14, Steps: 208 | Train Loss: 0.702 Vali Loss: 7.966 Vali Acc: 0.084 Test Loss: 7.966 Test Acc: 0.084
Validation loss decreased (-0.081948 --> -0.083726).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7720172
	speed: 0.6575s/iter; left time: 11696.3460s
	iters: 200, epoch: 15 | loss: 0.6857349
	speed: 0.2603s/iter; left time: 4603.9377s
Epoch: 15 cost time: 57.17219614982605
Epoch: 15, Steps: 208 | Train Loss: 0.632 Vali Loss: 8.043 Vali Acc: 0.080 Test Loss: 8.043 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5743899
	speed: 0.6816s/iter; left time: 11983.2904s
	iters: 200, epoch: 16 | loss: 0.7817200
	speed: 0.2997s/iter; left time: 5239.0715s
Epoch: 16 cost time: 61.70635724067688
Epoch: 16, Steps: 208 | Train Loss: 0.553 Vali Loss: 8.120 Vali Acc: 0.080 Test Loss: 8.120 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2818980
	speed: 0.6800s/iter; left time: 11813.0072s
	iters: 200, epoch: 17 | loss: 0.4756751
	speed: 0.2761s/iter; left time: 4768.2874s
Epoch: 17 cost time: 59.94824147224426
Epoch: 17, Steps: 208 | Train Loss: 0.489 Vali Loss: 8.671 Vali Acc: 0.083 Test Loss: 8.671 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3571481
	speed: 0.6679s/iter; left time: 11465.0396s
	iters: 200, epoch: 18 | loss: 0.7038426
	speed: 0.3005s/iter; left time: 5127.8844s
Epoch: 18 cost time: 60.783726930618286
Epoch: 18, Steps: 208 | Train Loss: 0.458 Vali Loss: 8.945 Vali Acc: 0.083 Test Loss: 8.945 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.4603852
	speed: 0.6529s/iter; left time: 11070.4475s
	iters: 200, epoch: 19 | loss: 0.6005322
	speed: 0.2688s/iter; left time: 4531.9797s
Epoch: 19 cost time: 58.25359869003296
Epoch: 19, Steps: 208 | Train Loss: 0.423 Vali Loss: 8.867 Vali Acc: 0.080 Test Loss: 8.867 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1064138
	speed: 0.6720s/iter; left time: 11254.5485s
	iters: 200, epoch: 20 | loss: 0.3271813
	speed: 0.2883s/iter; left time: 4799.9082s
Epoch: 20 cost time: 60.83916211128235
Epoch: 20, Steps: 208 | Train Loss: 0.404 Vali Loss: 9.298 Vali Acc: 0.074 Test Loss: 9.298 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4412652
	speed: 0.6678s/iter; left time: 11046.7027s
	iters: 200, epoch: 21 | loss: 0.4293162
	speed: 0.2836s/iter; left time: 4662.8348s
Epoch: 21 cost time: 59.0558385848999
Epoch: 21, Steps: 208 | Train Loss: 0.387 Vali Loss: 9.248 Vali Acc: 0.080 Test Loss: 9.248 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.8132907
	speed: 0.6644s/iter; left time: 10852.0313s
	iters: 200, epoch: 22 | loss: 0.3734589
	speed: 0.2625s/iter; left time: 4260.8817s
Epoch: 22 cost time: 56.91837763786316
Epoch: 22, Steps: 208 | Train Loss: 0.369 Vali Loss: 9.788 Vali Acc: 0.082 Test Loss: 9.788 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2176909
	speed: 0.6560s/iter; left time: 10577.3349s
	iters: 200, epoch: 23 | loss: 0.2224384
	speed: 0.2879s/iter; left time: 4613.3802s
Epoch: 23 cost time: 58.88929462432861
Epoch: 23, Steps: 208 | Train Loss: 0.339 Vali Loss: 9.295 Vali Acc: 0.084 Test Loss: 9.295 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.7781462
	speed: 0.6665s/iter; left time: 10608.8349s
	iters: 200, epoch: 24 | loss: 0.3241746
	speed: 0.2851s/iter; left time: 4509.7828s
Epoch: 24 cost time: 60.8319411277771
Epoch: 24, Steps: 208 | Train Loss: 0.338 Vali Loss: 9.689 Vali Acc: 0.092 Test Loss: 9.689 Test Acc: 0.092
Validation loss decreased (-0.083726 --> -0.092358).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.3678352
	speed: 0.6864s/iter; left time: 10782.0258s
	iters: 200, epoch: 25 | loss: 0.3225067
	speed: 0.2817s/iter; left time: 4397.7896s
Epoch: 25 cost time: 60.036534547805786
Epoch: 25, Steps: 208 | Train Loss: 0.283 Vali Loss: 9.760 Vali Acc: 0.092 Test Loss: 9.760 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0379868
	speed: 0.6484s/iter; left time: 10050.2683s
	iters: 200, epoch: 26 | loss: 0.1607167
	speed: 0.2870s/iter; left time: 4419.6528s
Epoch: 26 cost time: 59.20436143875122
Epoch: 26, Steps: 208 | Train Loss: 0.286 Vali Loss: 9.904 Vali Acc: 0.092 Test Loss: 9.904 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.2674676
	speed: 0.6326s/iter; left time: 9673.8743s
	iters: 200, epoch: 27 | loss: 0.1483961
	speed: 0.2582s/iter; left time: 3922.5583s
Epoch: 27 cost time: 56.67115068435669
Epoch: 27, Steps: 208 | Train Loss: 0.252 Vali Loss: 10.480 Vali Acc: 0.084 Test Loss: 10.480 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.2919028
	speed: 0.6655s/iter; left time: 10038.3376s
	iters: 200, epoch: 28 | loss: 0.3956457
	speed: 0.2896s/iter; left time: 4339.5629s
Epoch: 28 cost time: 59.81514525413513
Epoch: 28, Steps: 208 | Train Loss: 0.273 Vali Loss: 10.845 Vali Acc: 0.093 Test Loss: 10.845 Test Acc: 0.093
Validation loss decreased (-0.092358 --> -0.092644).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1923991
	speed: 0.6711s/iter; left time: 9984.1714s
	iters: 200, epoch: 29 | loss: 1.1557306
	speed: 0.2829s/iter; left time: 4179.7339s
Epoch: 29 cost time: 60.207159996032715
Epoch: 29, Steps: 208 | Train Loss: 0.277 Vali Loss: 10.340 Vali Acc: 0.078 Test Loss: 10.340 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.8167595
	speed: 0.6435s/iter; left time: 9439.6888s
	iters: 200, epoch: 30 | loss: 0.0377721
	speed: 0.2772s/iter; left time: 4038.5765s
Epoch: 30 cost time: 57.852489709854126
Epoch: 30, Steps: 208 | Train Loss: 0.268 Vali Loss: 10.113 Vali Acc: 0.088 Test Loss: 10.113 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.4648589
	speed: 0.6517s/iter; left time: 9424.2234s
	iters: 200, epoch: 31 | loss: 0.3366108
	speed: 0.2873s/iter; left time: 4126.4645s
Epoch: 31 cost time: 58.78724527359009
Epoch: 31, Steps: 208 | Train Loss: 0.263 Vali Loss: 10.876 Vali Acc: 0.085 Test Loss: 10.876 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.6071104
	speed: 0.6734s/iter; left time: 9598.4075s
	iters: 200, epoch: 32 | loss: 0.3229277
	speed: 0.2730s/iter; left time: 3863.2867s
Epoch: 32 cost time: 59.009937047958374
Epoch: 32, Steps: 208 | Train Loss: 0.251 Vali Loss: 10.911 Vali Acc: 0.087 Test Loss: 10.911 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.2415767
	speed: 0.6682s/iter; left time: 9385.5435s
	iters: 200, epoch: 33 | loss: 0.0121419
	speed: 0.2775s/iter; left time: 3870.3363s
Epoch: 33 cost time: 58.13984513282776
Epoch: 33, Steps: 208 | Train Loss: 0.228 Vali Loss: 11.056 Vali Acc: 0.089 Test Loss: 11.056 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.4515354
	speed: 0.6233s/iter; left time: 8623.9640s
	iters: 200, epoch: 34 | loss: 0.4094786
	speed: 0.2768s/iter; left time: 3802.6617s
Epoch: 34 cost time: 56.93805956840515
Epoch: 34, Steps: 208 | Train Loss: 0.238 Vali Loss: 10.909 Vali Acc: 0.094 Test Loss: 10.909 Test Acc: 0.094
Validation loss decreased (-0.092644 --> -0.094135).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0084330
	speed: 0.6551s/iter; left time: 8927.9493s
	iters: 200, epoch: 35 | loss: 0.4182966
	speed: 0.2810s/iter; left time: 3801.9291s
Epoch: 35 cost time: 58.53451752662659
Epoch: 35, Steps: 208 | Train Loss: 0.235 Vali Loss: 11.139 Vali Acc: 0.089 Test Loss: 11.139 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.7037759
	speed: 0.6868s/iter; left time: 9217.7198s
	iters: 200, epoch: 36 | loss: 0.0218460
	speed: 0.2863s/iter; left time: 3813.3359s
Epoch: 36 cost time: 60.76704788208008
Epoch: 36, Steps: 208 | Train Loss: 0.221 Vali Loss: 10.953 Vali Acc: 0.095 Test Loss: 10.953 Test Acc: 0.095
Validation loss decreased (-0.094135 --> -0.095327).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0058455
	speed: 0.6540s/iter; left time: 8640.6761s
	iters: 200, epoch: 37 | loss: 0.0171881
	speed: 0.2727s/iter; left time: 3575.4996s
Epoch: 37 cost time: 57.464272022247314
Epoch: 37, Steps: 208 | Train Loss: 0.186 Vali Loss: 11.019 Vali Acc: 0.090 Test Loss: 11.019 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0399417
	speed: 0.6673s/iter; left time: 8677.6294s
	iters: 200, epoch: 38 | loss: 0.1208031
	speed: 0.2786s/iter; left time: 3594.8369s
Epoch: 38 cost time: 58.11101174354553
Epoch: 38, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.183 Vali Acc: 0.090 Test Loss: 11.183 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.2548808
	speed: 0.6609s/iter; left time: 8458.0568s
	iters: 200, epoch: 39 | loss: 0.0547502
	speed: 0.2894s/iter; left time: 3674.2055s
Epoch: 39 cost time: 60.69018483161926
Epoch: 39, Steps: 208 | Train Loss: 0.233 Vali Loss: 11.015 Vali Acc: 0.086 Test Loss: 11.015 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0043450
	speed: 0.6488s/iter; left time: 8167.7545s
	iters: 200, epoch: 40 | loss: 0.4967862
	speed: 0.2768s/iter; left time: 3456.5794s
Epoch: 40 cost time: 57.18008041381836
Epoch: 40, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.036 Vali Acc: 0.081 Test Loss: 11.036 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.1910457
	speed: 0.6743s/iter; left time: 8348.0352s
	iters: 200, epoch: 41 | loss: 0.1474235
	speed: 0.2622s/iter; left time: 3220.1530s
Epoch: 41 cost time: 57.70979428291321
Epoch: 41, Steps: 208 | Train Loss: 0.202 Vali Loss: 11.540 Vali Acc: 0.091 Test Loss: 11.540 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.2895495
	speed: 0.6571s/iter; left time: 7998.4511s
	iters: 200, epoch: 42 | loss: 0.0184137
	speed: 0.2976s/iter; left time: 3592.8192s
Epoch: 42 cost time: 61.68745541572571
Epoch: 42, Steps: 208 | Train Loss: 0.186 Vali Loss: 11.416 Vali Acc: 0.081 Test Loss: 11.416 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0394732
	speed: 0.6680s/iter; left time: 7993.2178s
	iters: 200, epoch: 43 | loss: 0.0376566
	speed: 0.2732s/iter; left time: 3240.9861s
Epoch: 43 cost time: 58.116692304611206
Epoch: 43, Steps: 208 | Train Loss: 0.224 Vali Loss: 11.467 Vali Acc: 0.089 Test Loss: 11.467 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.2715071
	speed: 0.6669s/iter; left time: 7840.8258s
	iters: 200, epoch: 44 | loss: 0.2589742
	speed: 0.2853s/iter; left time: 3326.3136s
Epoch: 44 cost time: 60.68923759460449
Epoch: 44, Steps: 208 | Train Loss: 0.180 Vali Loss: 11.527 Vali Acc: 0.101 Test Loss: 11.527 Test Acc: 0.101
Validation loss decreased (-0.095327 --> -0.100392).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0803383
	speed: 0.6337s/iter; left time: 7318.9317s
	iters: 200, epoch: 45 | loss: 0.4190441
	speed: 0.2774s/iter; left time: 3175.6351s
Epoch: 45 cost time: 57.772117137908936
Epoch: 45, Steps: 208 | Train Loss: 0.181 Vali Loss: 11.397 Vali Acc: 0.092 Test Loss: 11.397 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0096909
	speed: 0.6727s/iter; left time: 7629.0351s
	iters: 200, epoch: 46 | loss: 0.0070438
	speed: 0.2703s/iter; left time: 3038.1720s
Epoch: 46 cost time: 58.16355323791504
Epoch: 46, Steps: 208 | Train Loss: 0.168 Vali Loss: 11.801 Vali Acc: 0.093 Test Loss: 11.801 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0301242
	speed: 0.6626s/iter; left time: 7377.1782s
	iters: 200, epoch: 47 | loss: 0.0006688
	speed: 0.2951s/iter; left time: 3255.3424s
Epoch: 47 cost time: 61.126333475112915
Epoch: 47, Steps: 208 | Train Loss: 0.194 Vali Loss: 11.740 Vali Acc: 0.092 Test Loss: 11.740 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.0852544
	speed: 0.6856s/iter; left time: 7490.3270s
	iters: 200, epoch: 48 | loss: 0.2463176
	speed: 0.2842s/iter; left time: 3076.2657s
Epoch: 48 cost time: 60.549365520477295
Epoch: 48, Steps: 208 | Train Loss: 0.160 Vali Loss: 11.665 Vali Acc: 0.086 Test Loss: 11.665 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.0038188
	speed: 0.6870s/iter; left time: 7362.9988s
	iters: 200, epoch: 49 | loss: 0.0517250
	speed: 0.2841s/iter; left time: 3016.0963s
Epoch: 49 cost time: 60.34153985977173
Epoch: 49, Steps: 208 | Train Loss: 0.158 Vali Loss: 11.538 Vali Acc: 0.099 Test Loss: 11.538 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 0.0021977
	speed: 0.6359s/iter; left time: 6682.6783s
	iters: 200, epoch: 50 | loss: 0.2318041
	speed: 0.2998s/iter; left time: 3120.4598s
Epoch: 50 cost time: 61.712674379348755
Epoch: 50, Steps: 208 | Train Loss: 0.184 Vali Loss: 11.895 Vali Acc: 0.090 Test Loss: 11.895 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.2400218
	speed: 0.6948s/iter; left time: 7157.3299s
	iters: 200, epoch: 51 | loss: 0.2293054
	speed: 0.2819s/iter; left time: 2875.5769s
Epoch: 51 cost time: 60.08711385726929
Epoch: 51, Steps: 208 | Train Loss: 0.180 Vali Loss: 11.728 Vali Acc: 0.095 Test Loss: 11.728 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.3110188
	speed: 0.6806s/iter; left time: 6868.9155s
	iters: 200, epoch: 52 | loss: 0.0197986
	speed: 0.2849s/iter; left time: 2846.7391s
Epoch: 52 cost time: 61.308420181274414
Epoch: 52, Steps: 208 | Train Loss: 0.155 Vali Loss: 11.703 Vali Acc: 0.092 Test Loss: 11.703 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.2304720
	speed: 0.6406s/iter; left time: 6332.3440s
	iters: 200, epoch: 53 | loss: 0.0143585
	speed: 0.2957s/iter; left time: 2893.1977s
Epoch: 53 cost time: 60.52809286117554
Epoch: 53, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.652 Vali Acc: 0.095 Test Loss: 11.652 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 0.1928345
	speed: 0.6950s/iter; left time: 6725.1910s
	iters: 200, epoch: 54 | loss: 0.1114499
	speed: 0.2858s/iter; left time: 2737.2533s
Epoch: 54 cost time: 61.01614284515381
Epoch: 54, Steps: 208 | Train Loss: 0.145 Vali Loss: 12.099 Vali Acc: 0.089 Test Loss: 12.099 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10050700864897107
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1228352
	speed: 0.3034s/iter; left time: 6281.5726s
	iters: 200, epoch: 1 | loss: 3.6573551
	speed: 0.2805s/iter; left time: 5777.8650s
Epoch: 1 cost time: 61.04270577430725
Epoch: 1, Steps: 208 | Train Loss: 3.681 Vali Loss: 5.272 Vali Acc: 0.036 Test Loss: 5.272 Test Acc: 0.036
Validation loss decreased (inf --> -0.036333).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7569489
	speed: 0.6334s/iter; left time: 12980.0665s
	iters: 200, epoch: 2 | loss: 3.2035775
	speed: 0.2758s/iter; left time: 5625.0420s
Epoch: 2 cost time: 57.610419034957886
Epoch: 2, Steps: 208 | Train Loss: 3.250 Vali Loss: 6.225 Vali Acc: 0.030 Test Loss: 6.225 Test Acc: 0.030
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.7644396
	speed: 0.6670s/iter; left time: 13529.4891s
	iters: 200, epoch: 3 | loss: 3.8096330
	speed: 0.2744s/iter; left time: 5539.4745s
Epoch: 3 cost time: 57.68839430809021
Epoch: 3, Steps: 208 | Train Loss: 3.090 Vali Loss: 6.338 Vali Acc: 0.038 Test Loss: 6.338 Test Acc: 0.038
Validation loss decreased (-0.036333 --> -0.037813).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4654667
	speed: 0.6685s/iter; left time: 13420.8802s
	iters: 200, epoch: 4 | loss: 3.2791393
	speed: 0.2956s/iter; left time: 5904.9274s
Epoch: 4 cost time: 61.90618181228638
Epoch: 4, Steps: 208 | Train Loss: 2.814 Vali Loss: 6.882 Vali Acc: 0.051 Test Loss: 6.882 Test Acc: 0.051
Validation loss decreased (-0.037813 --> -0.050930).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0680816
	speed: 0.6709s/iter; left time: 13329.7663s
	iters: 200, epoch: 5 | loss: 3.1247864
	speed: 0.2779s/iter; left time: 5494.5821s
Epoch: 5 cost time: 58.173075914382935
Epoch: 5, Steps: 208 | Train Loss: 2.606 Vali Loss: 6.514 Vali Acc: 0.049 Test Loss: 6.514 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.4120102
	speed: 0.6688s/iter; left time: 13148.6733s
	iters: 200, epoch: 6 | loss: 3.1707230
	speed: 0.2747s/iter; left time: 5373.0896s
Epoch: 6 cost time: 58.69269418716431
Epoch: 6, Steps: 208 | Train Loss: 2.178 Vali Loss: 7.217 Vali Acc: 0.053 Test Loss: 7.217 Test Acc: 0.053
Validation loss decreased (-0.050930 --> -0.053015).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8805346
	speed: 0.6336s/iter; left time: 12326.0658s
	iters: 200, epoch: 7 | loss: 2.7709234
	speed: 0.2862s/iter; left time: 5539.2528s
Epoch: 7 cost time: 59.188950061798096
Epoch: 7, Steps: 208 | Train Loss: 1.862 Vali Loss: 7.743 Vali Acc: 0.056 Test Loss: 7.743 Test Acc: 0.056
Validation loss decreased (-0.053015 --> -0.056290).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1562686
	speed: 0.6782s/iter; left time: 13051.7653s
	iters: 200, epoch: 8 | loss: 1.1148696
	speed: 0.2836s/iter; left time: 5429.8062s
Epoch: 8 cost time: 59.09337568283081
Epoch: 8, Steps: 208 | Train Loss: 1.545 Vali Loss: 7.692 Vali Acc: 0.059 Test Loss: 7.692 Test Acc: 0.059
Validation loss decreased (-0.056290 --> -0.058676).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6850528
	speed: 0.6485s/iter; left time: 12345.1126s
	iters: 200, epoch: 9 | loss: 1.4919393
	speed: 0.2785s/iter; left time: 5274.7848s
Epoch: 9 cost time: 59.26022553443909
Epoch: 9, Steps: 208 | Train Loss: 1.310 Vali Loss: 7.864 Vali Acc: 0.065 Test Loss: 7.864 Test Acc: 0.065
Validation loss decreased (-0.058676 --> -0.064640).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9876600
	speed: 0.6287s/iter; left time: 11838.4562s
	iters: 200, epoch: 10 | loss: 1.4839463
	speed: 0.2692s/iter; left time: 5042.2540s
Epoch: 10 cost time: 58.591957330703735
Epoch: 10, Steps: 208 | Train Loss: 1.121 Vali Loss: 8.443 Vali Acc: 0.067 Test Loss: 8.443 Test Acc: 0.067
Validation loss decreased (-0.064640 --> -0.066423).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3045624
	speed: 0.6838s/iter; left time: 12732.3428s
	iters: 200, epoch: 11 | loss: 0.8039654
	speed: 0.2867s/iter; left time: 5309.2067s
Epoch: 11 cost time: 60.6495246887207
Epoch: 11, Steps: 208 | Train Loss: 0.957 Vali Loss: 8.252 Vali Acc: 0.072 Test Loss: 8.252 Test Acc: 0.072
Validation loss decreased (-0.066423 --> -0.071495).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4803563
	speed: 0.6751s/iter; left time: 12430.6580s
	iters: 200, epoch: 12 | loss: 0.4465073
	speed: 0.2926s/iter; left time: 5358.4984s
Epoch: 12 cost time: 61.510197162628174
Epoch: 12, Steps: 208 | Train Loss: 0.789 Vali Loss: 8.571 Vali Acc: 0.065 Test Loss: 8.571 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6580307
	speed: 0.6739s/iter; left time: 12267.8621s
	iters: 200, epoch: 13 | loss: 0.8612875
	speed: 0.2769s/iter; left time: 5013.5617s
Epoch: 13 cost time: 58.88847541809082
Epoch: 13, Steps: 208 | Train Loss: 0.685 Vali Loss: 9.366 Vali Acc: 0.072 Test Loss: 9.366 Test Acc: 0.072
Validation loss decreased (-0.071495 --> -0.072081).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2857702
	speed: 0.6753s/iter; left time: 12153.0485s
	iters: 200, epoch: 14 | loss: 1.1108207
	speed: 0.2949s/iter; left time: 5278.1236s
Epoch: 14 cost time: 61.40691804885864
Epoch: 14, Steps: 208 | Train Loss: 0.638 Vali Loss: 9.362 Vali Acc: 0.075 Test Loss: 9.362 Test Acc: 0.075
Validation loss decreased (-0.072081 --> -0.074466).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5512826
	speed: 0.6339s/iter; left time: 11277.1057s
	iters: 200, epoch: 15 | loss: 0.3614950
	speed: 0.2952s/iter; left time: 5220.9275s
Epoch: 15 cost time: 58.87342143058777
Epoch: 15, Steps: 208 | Train Loss: 0.558 Vali Loss: 9.713 Vali Acc: 0.071 Test Loss: 9.713 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4037221
	speed: 0.6638s/iter; left time: 11671.0415s
	iters: 200, epoch: 16 | loss: 0.8982338
	speed: 0.2738s/iter; left time: 4786.6109s
Epoch: 16 cost time: 58.64077353477478
Epoch: 16, Steps: 208 | Train Loss: 0.505 Vali Loss: 9.747 Vali Acc: 0.073 Test Loss: 9.747 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6334895
	speed: 0.6566s/iter; left time: 11406.8128s
	iters: 200, epoch: 17 | loss: 0.4385198
	speed: 0.2969s/iter; left time: 5128.1165s
Epoch: 17 cost time: 60.69973158836365
Epoch: 17, Steps: 208 | Train Loss: 0.495 Vali Loss: 9.898 Vali Acc: 0.080 Test Loss: 9.898 Test Acc: 0.080
Validation loss decreased (-0.074466 --> -0.079531).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6481673
	speed: 0.6412s/iter; left time: 11005.8112s
	iters: 200, epoch: 18 | loss: 0.1867736
	speed: 0.2883s/iter; left time: 4919.1288s
Epoch: 18 cost time: 58.42251968383789
Epoch: 18, Steps: 208 | Train Loss: 0.397 Vali Loss: 10.062 Vali Acc: 0.073 Test Loss: 10.062 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.7683713
	speed: 0.6959s/iter; left time: 11800.7688s
	iters: 200, epoch: 19 | loss: 0.5845381
	speed: 0.2860s/iter; left time: 4821.3201s
Epoch: 19 cost time: 61.78688311576843
Epoch: 19, Steps: 208 | Train Loss: 0.405 Vali Loss: 10.406 Vali Acc: 0.078 Test Loss: 10.406 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2276556
	speed: 0.6766s/iter; left time: 11331.5623s
	iters: 200, epoch: 20 | loss: 0.1536234
	speed: 0.2953s/iter; left time: 4915.7687s
Epoch: 20 cost time: 61.14400768280029
Epoch: 20, Steps: 208 | Train Loss: 0.360 Vali Loss: 10.112 Vali Acc: 0.074 Test Loss: 10.112 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.5796514
	speed: 0.6503s/iter; left time: 10756.1144s
	iters: 200, epoch: 21 | loss: 0.2040213
	speed: 0.2678s/iter; left time: 4403.4260s
Epoch: 21 cost time: 56.157267570495605
Epoch: 21, Steps: 208 | Train Loss: 0.324 Vali Loss: 10.623 Vali Acc: 0.080 Test Loss: 10.623 Test Acc: 0.080
Validation loss decreased (-0.079531 --> -0.080120).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4164462
	speed: 0.6426s/iter; left time: 10494.9272s
	iters: 200, epoch: 22 | loss: 0.5485705
	speed: 0.2883s/iter; left time: 4680.3747s
Epoch: 22 cost time: 60.84795522689819
Epoch: 22, Steps: 208 | Train Loss: 0.308 Vali Loss: 10.897 Vali Acc: 0.072 Test Loss: 10.897 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0657169
	speed: 0.6344s/iter; left time: 10229.9918s
	iters: 200, epoch: 23 | loss: 0.7971626
	speed: 0.2783s/iter; left time: 4459.1442s
Epoch: 23 cost time: 57.445656299591064
Epoch: 23, Steps: 208 | Train Loss: 0.274 Vali Loss: 11.465 Vali Acc: 0.084 Test Loss: 11.465 Test Acc: 0.084
Validation loss decreased (-0.080120 --> -0.083393).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.5407187
	speed: 0.6493s/iter; left time: 10335.0407s
	iters: 200, epoch: 24 | loss: 0.0821525
	speed: 0.2640s/iter; left time: 4175.3483s
Epoch: 24 cost time: 57.085636138916016
Epoch: 24, Steps: 208 | Train Loss: 0.290 Vali Loss: 11.692 Vali Acc: 0.078 Test Loss: 11.692 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.3915893
	speed: 0.5925s/iter; left time: 9308.2759s
	iters: 200, epoch: 25 | loss: 0.2441966
	speed: 0.2588s/iter; left time: 4038.8488s
Epoch: 25 cost time: 54.54303956031799
Epoch: 25, Steps: 208 | Train Loss: 0.253 Vali Loss: 11.616 Vali Acc: 0.090 Test Loss: 11.616 Test Acc: 0.090
Validation loss decreased (-0.083393 --> -0.090251).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0628731
	speed: 0.6900s/iter; left time: 10695.0788s
	iters: 200, epoch: 26 | loss: 0.0673434
	speed: 0.2896s/iter; left time: 4460.6129s
Epoch: 26 cost time: 61.39745235443115
Epoch: 26, Steps: 208 | Train Loss: 0.240 Vali Loss: 11.805 Vali Acc: 0.083 Test Loss: 11.805 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0114020
	speed: 0.6473s/iter; left time: 9898.5502s
	iters: 200, epoch: 27 | loss: 0.2324692
	speed: 0.2848s/iter; left time: 4327.5936s
Epoch: 27 cost time: 58.951183795928955
Epoch: 27, Steps: 208 | Train Loss: 0.264 Vali Loss: 11.670 Vali Acc: 0.082 Test Loss: 11.670 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.4166613
	speed: 0.6348s/iter; left time: 9576.3078s
	iters: 200, epoch: 28 | loss: 0.7335737
	speed: 0.2621s/iter; left time: 3927.7555s
Epoch: 28 cost time: 55.39725589752197
Epoch: 28, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.945 Vali Acc: 0.080 Test Loss: 11.945 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.1752962
	speed: 0.6217s/iter; left time: 9249.0584s
	iters: 200, epoch: 29 | loss: 0.0795339
	speed: 0.2750s/iter; left time: 4063.7302s
Epoch: 29 cost time: 57.102046728134155
Epoch: 29, Steps: 208 | Train Loss: 0.232 Vali Loss: 11.874 Vali Acc: 0.077 Test Loss: 11.874 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1626967
	speed: 0.6531s/iter; left time: 9580.5346s
	iters: 200, epoch: 30 | loss: 0.0109357
	speed: 0.2712s/iter; left time: 3951.0166s
Epoch: 30 cost time: 57.169477224349976
Epoch: 30, Steps: 208 | Train Loss: 0.210 Vali Loss: 11.953 Vali Acc: 0.079 Test Loss: 11.953 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0138403
	speed: 0.6558s/iter; left time: 9483.9880s
	iters: 200, epoch: 31 | loss: 0.0410133
	speed: 0.2745s/iter; left time: 3941.8949s
Epoch: 31 cost time: 57.91313719749451
Epoch: 31, Steps: 208 | Train Loss: 0.207 Vali Loss: 12.015 Vali Acc: 0.081 Test Loss: 12.015 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.2681586
	speed: 0.6340s/iter; left time: 9036.0287s
	iters: 200, epoch: 32 | loss: 0.1147403
	speed: 0.2826s/iter; left time: 3999.6971s
Epoch: 32 cost time: 59.02175688743591
Epoch: 32, Steps: 208 | Train Loss: 0.208 Vali Loss: 12.266 Vali Acc: 0.073 Test Loss: 12.266 Test Acc: 0.073
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.8008786
	speed: 0.6526s/iter; left time: 9165.4835s
	iters: 200, epoch: 33 | loss: 0.0026792
	speed: 0.2917s/iter; left time: 4067.3687s
Epoch: 33 cost time: 59.796910524368286
Epoch: 33, Steps: 208 | Train Loss: 0.203 Vali Loss: 11.948 Vali Acc: 0.088 Test Loss: 11.948 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2225068
	speed: 0.6673s/iter; left time: 9232.8905s
	iters: 200, epoch: 34 | loss: 0.2450688
	speed: 0.2795s/iter; left time: 3839.8357s
Epoch: 34 cost time: 57.68673348426819
Epoch: 34, Steps: 208 | Train Loss: 0.188 Vali Loss: 12.347 Vali Acc: 0.080 Test Loss: 12.347 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0057320
	speed: 0.6864s/iter; left time: 9355.1666s
	iters: 200, epoch: 35 | loss: 0.1440300
	speed: 0.2763s/iter; left time: 3737.9102s
Epoch: 35 cost time: 59.380990982055664
Epoch: 35, Steps: 208 | Train Loss: 0.182 Vali Loss: 12.320 Vali Acc: 0.082 Test Loss: 12.320 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09036683566954966
model parameter : 1945767
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2029181
	speed: 0.3091s/iter; left time: 6398.9936s
	iters: 200, epoch: 1 | loss: 3.9897945
	speed: 0.2813s/iter; left time: 5794.0886s
Epoch: 1 cost time: 61.110755920410156
Epoch: 1, Steps: 208 | Train Loss: 3.907 Vali Loss: 4.194 Vali Acc: 0.079 Test Loss: 4.194 Test Acc: 0.079
Validation loss decreased (inf --> -0.078992).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4455113
	speed: 0.6375s/iter; left time: 13065.0851s
	iters: 200, epoch: 2 | loss: 3.5883758
	speed: 0.2917s/iter; left time: 5949.0683s
Epoch: 2 cost time: 60.418964862823486
Epoch: 2, Steps: 208 | Train Loss: 3.336 Vali Loss: 4.049 Vali Acc: 0.088 Test Loss: 4.049 Test Acc: 0.088
Validation loss decreased (-0.078992 --> -0.088239).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6973491
	speed: 0.6920s/iter; left time: 14036.7865s
	iters: 200, epoch: 3 | loss: 2.3766236
	speed: 0.2982s/iter; left time: 6019.3617s
Epoch: 3 cost time: 61.95221495628357
Epoch: 3, Steps: 208 | Train Loss: 2.653 Vali Loss: 4.427 Vali Acc: 0.087 Test Loss: 4.427 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2804828
	speed: 0.6739s/iter; left time: 13529.9279s
	iters: 200, epoch: 4 | loss: 1.7233105
	speed: 0.2758s/iter; left time: 5509.3628s
Epoch: 4 cost time: 59.1985285282135
Epoch: 4, Steps: 208 | Train Loss: 1.983 Vali Loss: 5.231 Vali Acc: 0.092 Test Loss: 5.231 Test Acc: 0.092
Validation loss decreased (-0.088239 --> -0.091507).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1664157
	speed: 0.6947s/iter; left time: 13803.5823s
	iters: 200, epoch: 5 | loss: 2.0655127
	speed: 0.2980s/iter; left time: 5891.1109s
Epoch: 5 cost time: 61.88848638534546
Epoch: 5, Steps: 208 | Train Loss: 1.473 Vali Loss: 5.971 Vali Acc: 0.086 Test Loss: 5.971 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6603230
	speed: 0.6951s/iter; left time: 13666.9049s
	iters: 200, epoch: 6 | loss: 2.2620113
	speed: 0.2984s/iter; left time: 5836.6490s
Epoch: 6 cost time: 62.612146615982056
Epoch: 6, Steps: 208 | Train Loss: 1.078 Vali Loss: 6.558 Vali Acc: 0.093 Test Loss: 6.558 Test Acc: 0.093
Validation loss decreased (-0.091507 --> -0.093284).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9607613
	speed: 0.6752s/iter; left time: 13134.1952s
	iters: 200, epoch: 7 | loss: 1.8694779
	speed: 0.2873s/iter; left time: 5559.4487s
Epoch: 7 cost time: 60.92851805686951
Epoch: 7, Steps: 208 | Train Loss: 0.868 Vali Loss: 7.289 Vali Acc: 0.099 Test Loss: 7.289 Test Acc: 0.099
Validation loss decreased (-0.093284 --> -0.098645).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6198461
	speed: 0.6400s/iter; left time: 12316.6025s
	iters: 200, epoch: 8 | loss: 0.6316113
	speed: 0.2705s/iter; left time: 5177.8205s
Epoch: 8 cost time: 56.945850133895874
Epoch: 8, Steps: 208 | Train Loss: 0.673 Vali Loss: 7.814 Vali Acc: 0.087 Test Loss: 7.814 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3901811
	speed: 0.6760s/iter; left time: 12869.0714s
	iters: 200, epoch: 9 | loss: 0.4632853
	speed: 0.2725s/iter; left time: 5161.1264s
Epoch: 9 cost time: 58.00719904899597
Epoch: 9, Steps: 208 | Train Loss: 0.567 Vali Loss: 8.880 Vali Acc: 0.086 Test Loss: 8.880 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5073770
	speed: 0.6711s/iter; left time: 12635.5978s
	iters: 200, epoch: 10 | loss: 0.4375676
	speed: 0.2859s/iter; left time: 5355.1806s
Epoch: 10 cost time: 60.23749899864197
Epoch: 10, Steps: 208 | Train Loss: 0.472 Vali Loss: 9.037 Vali Acc: 0.087 Test Loss: 9.037 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1442141
	speed: 0.6793s/iter; left time: 12648.6559s
	iters: 200, epoch: 11 | loss: 0.2560129
	speed: 0.3044s/iter; left time: 5638.2983s
Epoch: 11 cost time: 63.18533110618591
Epoch: 11, Steps: 208 | Train Loss: 0.364 Vali Loss: 9.755 Vali Acc: 0.085 Test Loss: 9.755 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0793483
	speed: 0.6601s/iter; left time: 12153.9429s
	iters: 200, epoch: 12 | loss: 0.1421703
	speed: 0.2818s/iter; left time: 5160.6286s
Epoch: 12 cost time: 58.784488677978516
Epoch: 12, Steps: 208 | Train Loss: 0.374 Vali Loss: 10.078 Vali Acc: 0.084 Test Loss: 10.078 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.5130206
	speed: 0.6848s/iter; left time: 12466.8277s
	iters: 200, epoch: 13 | loss: 0.2696244
	speed: 0.2770s/iter; left time: 5014.4915s
Epoch: 13 cost time: 59.32272124290466
Epoch: 13, Steps: 208 | Train Loss: 0.327 Vali Loss: 10.482 Vali Acc: 0.087 Test Loss: 10.482 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0629477
	speed: 0.6665s/iter; left time: 11994.8219s
	iters: 200, epoch: 14 | loss: 1.1253139
	speed: 0.2837s/iter; left time: 5077.3078s
Epoch: 14 cost time: 59.70396041870117
Epoch: 14, Steps: 208 | Train Loss: 0.282 Vali Loss: 10.735 Vali Acc: 0.079 Test Loss: 10.735 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.5367009
	speed: 0.6518s/iter; left time: 11594.4966s
	iters: 200, epoch: 15 | loss: 0.2055785
	speed: 0.2880s/iter; left time: 5094.6030s
Epoch: 15 cost time: 59.401089906692505
Epoch: 15, Steps: 208 | Train Loss: 0.258 Vali Loss: 10.751 Vali Acc: 0.087 Test Loss: 10.751 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2369154
	speed: 0.6605s/iter; left time: 11612.0901s
	iters: 200, epoch: 16 | loss: 0.4183162
	speed: 0.2889s/iter; left time: 5050.4374s
Epoch: 16 cost time: 59.71417832374573
Epoch: 16, Steps: 208 | Train Loss: 0.225 Vali Loss: 11.255 Vali Acc: 0.077 Test Loss: 11.255 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0475022
	speed: 0.6740s/iter; left time: 11708.8664s
	iters: 200, epoch: 17 | loss: 0.0652300
	speed: 0.2955s/iter; left time: 5104.2927s
Epoch: 17 cost time: 60.72366237640381
Epoch: 17, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.922 Vali Acc: 0.085 Test Loss: 11.922 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09871756635848494
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2404799
	speed: 0.3249s/iter; left time: 6725.6420s
	iters: 200, epoch: 1 | loss: 4.0127163
	speed: 0.2939s/iter; left time: 6053.6860s
Epoch: 1 cost time: 64.45347499847412
Epoch: 1, Steps: 208 | Train Loss: 3.896 Vali Loss: 4.235 Vali Acc: 0.078 Test Loss: 4.235 Test Acc: 0.078
Validation loss decreased (inf --> -0.078395).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1673164
	speed: 0.7025s/iter; left time: 14397.1212s
	iters: 200, epoch: 2 | loss: 3.7233605
	speed: 0.2849s/iter; left time: 5809.3128s
Epoch: 2 cost time: 62.095423221588135
Epoch: 2, Steps: 208 | Train Loss: 3.336 Vali Loss: 4.110 Vali Acc: 0.080 Test Loss: 4.110 Test Acc: 0.080
Validation loss decreased (-0.078395 --> -0.080186).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0908403
	speed: 0.6908s/iter; left time: 14013.7782s
	iters: 200, epoch: 3 | loss: 2.3450222
	speed: 0.3054s/iter; left time: 6165.1310s
Epoch: 3 cost time: 65.35963869094849
Epoch: 3, Steps: 208 | Train Loss: 2.657 Vali Loss: 4.551 Vali Acc: 0.087 Test Loss: 4.551 Test Acc: 0.087
Validation loss decreased (-0.080186 --> -0.086742).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0673177
	speed: 0.6866s/iter; left time: 13784.7734s
	iters: 200, epoch: 4 | loss: 2.4226003
	speed: 0.3163s/iter; left time: 6317.9750s
Epoch: 4 cost time: 63.41848683357239
Epoch: 4, Steps: 208 | Train Loss: 2.003 Vali Loss: 5.229 Vali Acc: 0.099 Test Loss: 5.229 Test Acc: 0.099
Validation loss decreased (-0.086742 --> -0.098964).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3934227
	speed: 0.6730s/iter; left time: 13372.4214s
	iters: 200, epoch: 5 | loss: 1.7459042
	speed: 0.2770s/iter; left time: 5476.7174s
Epoch: 5 cost time: 58.44448709487915
Epoch: 5, Steps: 208 | Train Loss: 1.480 Vali Loss: 5.925 Vali Acc: 0.093 Test Loss: 5.925 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0791322
	speed: 0.7093s/iter; left time: 13945.5409s
	iters: 200, epoch: 6 | loss: 1.8669484
	speed: 0.2915s/iter; left time: 5701.2613s
Epoch: 6 cost time: 62.40748357772827
Epoch: 6, Steps: 208 | Train Loss: 1.072 Vali Loss: 6.436 Vali Acc: 0.102 Test Loss: 6.436 Test Acc: 0.102
Validation loss decreased (-0.098964 --> -0.101636).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1125757
	speed: 0.7154s/iter; left time: 13916.1719s
	iters: 200, epoch: 7 | loss: 2.0786357
	speed: 0.3107s/iter; left time: 6013.8691s
Epoch: 7 cost time: 66.00299191474915
Epoch: 7, Steps: 208 | Train Loss: 0.867 Vali Loss: 7.278 Vali Acc: 0.096 Test Loss: 7.278 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9477682
	speed: 0.6955s/iter; left time: 13384.5795s
	iters: 200, epoch: 8 | loss: 0.9752528
	speed: 0.2931s/iter; left time: 5611.8577s
Epoch: 8 cost time: 61.67598080635071
Epoch: 8, Steps: 208 | Train Loss: 0.675 Vali Loss: 7.858 Vali Acc: 0.091 Test Loss: 7.858 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6476744
	speed: 0.6344s/iter; left time: 12076.4214s
	iters: 200, epoch: 9 | loss: 0.2980722
	speed: 0.2872s/iter; left time: 5438.3200s
Epoch: 9 cost time: 59.574894428253174
Epoch: 9, Steps: 208 | Train Loss: 0.562 Vali Loss: 8.459 Vali Acc: 0.086 Test Loss: 8.459 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2509760
	speed: 0.6744s/iter; left time: 12699.1364s
	iters: 200, epoch: 10 | loss: 0.3152460
	speed: 0.2943s/iter; left time: 5512.5182s
Epoch: 10 cost time: 61.37586498260498
Epoch: 10, Steps: 208 | Train Loss: 0.442 Vali Loss: 9.185 Vali Acc: 0.086 Test Loss: 9.185 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1758247
	speed: 0.7057s/iter; left time: 13140.4395s
	iters: 200, epoch: 11 | loss: 0.0965483
	speed: 0.2792s/iter; left time: 5170.4258s
Epoch: 11 cost time: 61.50563168525696
Epoch: 11, Steps: 208 | Train Loss: 0.408 Vali Loss: 9.352 Vali Acc: 0.086 Test Loss: 9.352 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6527623
	speed: 0.6621s/iter; left time: 12190.9841s
	iters: 200, epoch: 12 | loss: 0.1240845
	speed: 0.2865s/iter; left time: 5245.8514s
Epoch: 12 cost time: 60.91426110267639
Epoch: 12, Steps: 208 | Train Loss: 0.323 Vali Loss: 9.984 Vali Acc: 0.085 Test Loss: 9.984 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2676959
	speed: 0.6577s/iter; left time: 11973.8510s
	iters: 200, epoch: 13 | loss: 0.6529755
	speed: 0.3107s/iter; left time: 5625.9446s
Epoch: 13 cost time: 63.2604775428772
Epoch: 13, Steps: 208 | Train Loss: 0.304 Vali Loss: 10.043 Vali Acc: 0.085 Test Loss: 10.043 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2808906
	speed: 0.7042s/iter; left time: 12672.9488s
	iters: 200, epoch: 14 | loss: 0.7941947
	speed: 0.2908s/iter; left time: 5204.8947s
Epoch: 14 cost time: 62.838730335235596
Epoch: 14, Steps: 208 | Train Loss: 0.280 Vali Loss: 10.694 Vali Acc: 0.085 Test Loss: 10.694 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3331366
	speed: 0.6991s/iter; left time: 12436.1987s
	iters: 200, epoch: 15 | loss: 0.2561415
	speed: 0.2853s/iter; left time: 5045.8882s
Epoch: 15 cost time: 61.315335273742676
Epoch: 15, Steps: 208 | Train Loss: 0.301 Vali Loss: 10.493 Vali Acc: 0.085 Test Loss: 10.493 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.4097822
	speed: 0.6596s/iter; left time: 11595.9118s
	iters: 200, epoch: 16 | loss: 0.2218080
	speed: 0.2974s/iter; left time: 5198.4784s
Epoch: 16 cost time: 61.213738203048706
Epoch: 16, Steps: 208 | Train Loss: 0.239 Vali Loss: 11.433 Vali Acc: 0.086 Test Loss: 11.433 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10169997017596183
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3284488
	speed: 0.3030s/iter; left time: 6272.9081s
	iters: 200, epoch: 1 | loss: 3.8610451
	speed: 0.2866s/iter; left time: 5904.2337s
Epoch: 1 cost time: 61.45103216171265
Epoch: 1, Steps: 208 | Train Loss: 3.887 Vali Loss: 4.176 Vali Acc: 0.077 Test Loss: 4.176 Test Acc: 0.077
Validation loss decreased (inf --> -0.076606).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4116836
	speed: 0.6581s/iter; left time: 13486.7412s
	iters: 200, epoch: 2 | loss: 3.7442634
	speed: 0.2882s/iter; left time: 5877.7542s
Epoch: 2 cost time: 60.61714696884155
Epoch: 2, Steps: 208 | Train Loss: 3.349 Vali Loss: 4.075 Vali Acc: 0.086 Test Loss: 4.075 Test Acc: 0.086
Validation loss decreased (-0.076606 --> -0.086449).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1463594
	speed: 0.6579s/iter; left time: 13345.8807s
	iters: 200, epoch: 3 | loss: 2.2731843
	speed: 0.2849s/iter; left time: 5751.4540s
Epoch: 3 cost time: 59.688947916030884
Epoch: 3, Steps: 208 | Train Loss: 2.657 Vali Loss: 4.434 Vali Acc: 0.090 Test Loss: 4.434 Test Acc: 0.090
Validation loss decreased (-0.086449 --> -0.090024).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5611086
	speed: 0.6560s/iter; left time: 13171.1702s
	iters: 200, epoch: 4 | loss: 1.6805397
	speed: 0.2993s/iter; left time: 5978.1581s
Epoch: 4 cost time: 63.158212661743164
Epoch: 4, Steps: 208 | Train Loss: 2.003 Vali Loss: 5.112 Vali Acc: 0.089 Test Loss: 5.112 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0305530
	speed: 0.6405s/iter; left time: 12726.3385s
	iters: 200, epoch: 5 | loss: 1.4615514
	speed: 0.2961s/iter; left time: 5852.9782s
Epoch: 5 cost time: 60.371882915496826
Epoch: 5, Steps: 208 | Train Loss: 1.488 Vali Loss: 5.898 Vali Acc: 0.083 Test Loss: 5.898 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2557856
	speed: 0.6769s/iter; left time: 13309.1923s
	iters: 200, epoch: 6 | loss: 2.4615827
	speed: 0.2882s/iter; left time: 5637.1898s
Epoch: 6 cost time: 60.2857768535614
Epoch: 6, Steps: 208 | Train Loss: 1.146 Vali Loss: 6.505 Vali Acc: 0.085 Test Loss: 6.505 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5008605
	speed: 0.6473s/iter; left time: 12591.7665s
	iters: 200, epoch: 7 | loss: 1.9029856
	speed: 0.2805s/iter; left time: 5428.5950s
Epoch: 7 cost time: 58.80644392967224
Epoch: 7, Steps: 208 | Train Loss: 0.859 Vali Loss: 7.132 Vali Acc: 0.093 Test Loss: 7.132 Test Acc: 0.093
Validation loss decreased (-0.090024 --> -0.092980).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9091551
	speed: 0.6231s/iter; left time: 11991.9406s
	iters: 200, epoch: 8 | loss: 0.8824678
	speed: 0.2836s/iter; left time: 5430.3938s
Epoch: 8 cost time: 57.61917567253113
Epoch: 8, Steps: 208 | Train Loss: 0.677 Vali Loss: 7.868 Vali Acc: 0.088 Test Loss: 7.868 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6418499
	speed: 0.6694s/iter; left time: 12743.7562s
	iters: 200, epoch: 9 | loss: 0.6453655
	speed: 0.2893s/iter; left time: 5477.7256s
Epoch: 9 cost time: 60.95643615722656
Epoch: 9, Steps: 208 | Train Loss: 0.560 Vali Loss: 8.711 Vali Acc: 0.083 Test Loss: 8.711 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3483557
	speed: 0.6716s/iter; left time: 12645.5227s
	iters: 200, epoch: 10 | loss: 0.4296489
	speed: 0.2904s/iter; left time: 5438.4766s
Epoch: 10 cost time: 60.394286155700684
Epoch: 10, Steps: 208 | Train Loss: 0.490 Vali Loss: 8.908 Vali Acc: 0.087 Test Loss: 8.908 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3790658
	speed: 0.6599s/iter; left time: 12288.0265s
	iters: 200, epoch: 11 | loss: 0.3238461
	speed: 0.2856s/iter; left time: 5288.8279s
Epoch: 11 cost time: 59.92266273498535
Epoch: 11, Steps: 208 | Train Loss: 0.381 Vali Loss: 9.784 Vali Acc: 0.080 Test Loss: 9.784 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3490940
	speed: 0.6787s/iter; left time: 12497.5176s
	iters: 200, epoch: 12 | loss: 0.2707172
	speed: 0.2863s/iter; left time: 5243.5928s
Epoch: 12 cost time: 60.205095052719116
Epoch: 12, Steps: 208 | Train Loss: 0.335 Vali Loss: 10.563 Vali Acc: 0.083 Test Loss: 10.563 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2635038
	speed: 0.6625s/iter; left time: 12060.8994s
	iters: 200, epoch: 13 | loss: 0.4681931
	speed: 0.2810s/iter; left time: 5086.7801s
Epoch: 13 cost time: 58.88279676437378
Epoch: 13, Steps: 208 | Train Loss: 0.358 Vali Loss: 10.309 Vali Acc: 0.084 Test Loss: 10.309 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3909449
	speed: 0.6636s/iter; left time: 11942.8317s
	iters: 200, epoch: 14 | loss: 0.4926492
	speed: 0.2942s/iter; left time: 5266.1266s
Epoch: 14 cost time: 59.771472454071045
Epoch: 14, Steps: 208 | Train Loss: 0.275 Vali Loss: 11.345 Vali Acc: 0.081 Test Loss: 11.345 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2184129
	speed: 0.6803s/iter; left time: 12102.4573s
	iters: 200, epoch: 15 | loss: 0.3352288
	speed: 0.2825s/iter; left time: 4997.4264s
Epoch: 15 cost time: 60.091471433639526
Epoch: 15, Steps: 208 | Train Loss: 0.261 Vali Loss: 10.953 Vali Acc: 0.086 Test Loss: 10.953 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.5753313
	speed: 0.6928s/iter; left time: 12179.4415s
	iters: 200, epoch: 16 | loss: 0.0538058
	speed: 0.2902s/iter; left time: 5072.5043s
Epoch: 16 cost time: 61.252915382385254
Epoch: 16, Steps: 208 | Train Loss: 0.212 Vali Loss: 11.264 Vali Acc: 0.080 Test Loss: 11.264 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0760480
	speed: 0.7064s/iter; left time: 12272.9356s
	iters: 200, epoch: 17 | loss: 0.1513891
	speed: 0.3036s/iter; left time: 5244.8616s
Epoch: 17 cost time: 64.09270143508911
Epoch: 17, Steps: 208 | Train Loss: 0.210 Vali Loss: 11.768 Vali Acc: 0.084 Test Loss: 11.768 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09305099910527885
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3621387
	speed: 0.3012s/iter; left time: 6234.3399s
	iters: 200, epoch: 1 | loss: 3.7605679
	speed: 0.2974s/iter; left time: 6127.3145s
Epoch: 1 cost time: 62.41398882865906
Epoch: 1, Steps: 208 | Train Loss: 3.892 Vali Loss: 4.111 Vali Acc: 0.076 Test Loss: 4.111 Test Acc: 0.076
Validation loss decreased (inf --> -0.076010).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1706581
	speed: 0.6564s/iter; left time: 13451.4499s
	iters: 200, epoch: 2 | loss: 4.0596919
	speed: 0.2996s/iter; left time: 6110.6271s
Epoch: 2 cost time: 62.31618881225586
Epoch: 2, Steps: 208 | Train Loss: 3.310 Vali Loss: 4.096 Vali Acc: 0.083 Test Loss: 4.096 Test Acc: 0.083
Validation loss decreased (-0.076010 --> -0.082572).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3506117
	speed: 0.6845s/iter; left time: 13884.2661s
	iters: 200, epoch: 3 | loss: 2.4374475
	speed: 0.2964s/iter; left time: 5983.2474s
Epoch: 3 cost time: 61.53290128707886
Epoch: 3, Steps: 208 | Train Loss: 2.630 Vali Loss: 4.560 Vali Acc: 0.094 Test Loss: 4.560 Test Acc: 0.094
Validation loss decreased (-0.082572 --> -0.094198).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9101925
	speed: 0.6338s/iter; left time: 12724.7143s
	iters: 200, epoch: 4 | loss: 1.7583408
	speed: 0.2811s/iter; left time: 5615.9961s
Epoch: 4 cost time: 57.671966791152954
Epoch: 4, Steps: 208 | Train Loss: 2.008 Vali Loss: 5.030 Vali Acc: 0.100 Test Loss: 5.030 Test Acc: 0.100
Validation loss decreased (-0.094198 --> -0.099860).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1497614
	speed: 0.6803s/iter; left time: 13516.7360s
	iters: 200, epoch: 5 | loss: 1.6047143
	speed: 0.2899s/iter; left time: 5731.9024s
Epoch: 5 cost time: 61.587119340896606
Epoch: 5, Steps: 208 | Train Loss: 1.444 Vali Loss: 5.716 Vali Acc: 0.101 Test Loss: 5.716 Test Acc: 0.101
Validation loss decreased (-0.099860 --> -0.100748).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2575403
	speed: 0.6754s/iter; left time: 13279.1670s
	iters: 200, epoch: 6 | loss: 2.2016454
	speed: 0.2830s/iter; left time: 5535.2824s
Epoch: 6 cost time: 59.316176414489746
Epoch: 6, Steps: 208 | Train Loss: 1.078 Vali Loss: 6.384 Vali Acc: 0.106 Test Loss: 6.384 Test Acc: 0.106
Validation loss decreased (-0.100748 --> -0.106408).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5188804
	speed: 0.6601s/iter; left time: 12841.3602s
	iters: 200, epoch: 7 | loss: 1.1902568
	speed: 0.2942s/iter; left time: 5693.8092s
Epoch: 7 cost time: 60.090688705444336
Epoch: 7, Steps: 208 | Train Loss: 0.881 Vali Loss: 7.187 Vali Acc: 0.100 Test Loss: 7.187 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7753071
	speed: 0.6666s/iter; left time: 12828.3055s
	iters: 200, epoch: 8 | loss: 1.2619894
	speed: 0.2698s/iter; left time: 5165.6677s
Epoch: 8 cost time: 57.547528982162476
Epoch: 8, Steps: 208 | Train Loss: 0.674 Vali Loss: 7.843 Vali Acc: 0.096 Test Loss: 7.843 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3710662
	speed: 0.6489s/iter; left time: 12353.3004s
	iters: 200, epoch: 9 | loss: 0.4849228
	speed: 0.2748s/iter; left time: 5204.7799s
Epoch: 9 cost time: 57.228129386901855
Epoch: 9, Steps: 208 | Train Loss: 0.539 Vali Loss: 8.737 Vali Acc: 0.098 Test Loss: 8.737 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3406886
	speed: 0.6837s/iter; left time: 12873.7031s
	iters: 200, epoch: 10 | loss: 1.1474930
	speed: 0.2891s/iter; left time: 5414.9713s
Epoch: 10 cost time: 60.75055956840515
Epoch: 10, Steps: 208 | Train Loss: 0.465 Vali Loss: 8.914 Vali Acc: 0.089 Test Loss: 8.914 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4666864
	speed: 0.7042s/iter; left time: 13113.0608s
	iters: 200, epoch: 11 | loss: 0.2037290
	speed: 0.2909s/iter; left time: 5387.7931s
Epoch: 11 cost time: 61.48343801498413
Epoch: 11, Steps: 208 | Train Loss: 0.388 Vali Loss: 9.579 Vali Acc: 0.094 Test Loss: 9.579 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2485254
	speed: 0.6774s/iter; left time: 12472.2592s
	iters: 200, epoch: 12 | loss: 0.5150608
	speed: 0.2834s/iter; left time: 5190.8161s
Epoch: 12 cost time: 59.73907685279846
Epoch: 12, Steps: 208 | Train Loss: 0.342 Vali Loss: 10.063 Vali Acc: 0.096 Test Loss: 10.063 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2161943
	speed: 0.6683s/iter; left time: 12166.6717s
	iters: 200, epoch: 13 | loss: 0.2335331
	speed: 0.2865s/iter; left time: 5186.8755s
Epoch: 13 cost time: 60.891205072402954
Epoch: 13, Steps: 208 | Train Loss: 0.331 Vali Loss: 10.329 Vali Acc: 0.093 Test Loss: 10.329 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3078782
	speed: 0.6767s/iter; left time: 12179.1808s
	iters: 200, epoch: 14 | loss: 0.1844061
	speed: 0.2792s/iter; left time: 4997.1420s
Epoch: 14 cost time: 60.73882603645325
Epoch: 14, Steps: 208 | Train Loss: 0.277 Vali Loss: 10.903 Vali Acc: 0.090 Test Loss: 10.903 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0494331
	speed: 0.6866s/iter; left time: 12213.2990s
	iters: 200, epoch: 15 | loss: 0.4949618
	speed: 0.3028s/iter; left time: 5355.8404s
Epoch: 15 cost time: 62.83882117271423
Epoch: 15, Steps: 208 | Train Loss: 0.278 Vali Loss: 11.013 Vali Acc: 0.103 Test Loss: 11.013 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.3200305
	speed: 0.6622s/iter; left time: 11642.9812s
	iters: 200, epoch: 16 | loss: 0.1101768
	speed: 0.2885s/iter; left time: 5043.1715s
Epoch: 16 cost time: 61.55124044418335
Epoch: 16, Steps: 208 | Train Loss: 0.238 Vali Loss: 11.129 Vali Acc: 0.093 Test Loss: 11.129 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10647181628392484
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7866676
	speed: 0.3116s/iter; left time: 6451.4297s
	iters: 200, epoch: 1 | loss: 3.7345471
	speed: 0.2961s/iter; left time: 6099.6347s
Epoch: 1 cost time: 63.312896490097046
Epoch: 1, Steps: 208 | Train Loss: 3.835 Vali Loss: 4.366 Vali Acc: 0.063 Test Loss: 4.366 Test Acc: 0.063
Validation loss decreased (inf --> -0.062587).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8471539
	speed: 0.7026s/iter; left time: 14397.9985s
	iters: 200, epoch: 2 | loss: 3.4268472
	speed: 0.2960s/iter; left time: 6035.3789s
Epoch: 2 cost time: 61.94465470314026
Epoch: 2, Steps: 208 | Train Loss: 3.310 Vali Loss: 4.647 Vali Acc: 0.072 Test Loss: 4.647 Test Acc: 0.072
Validation loss decreased (-0.062587 --> -0.072426).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5528646
	speed: 0.6709s/iter; left time: 13609.1303s
	iters: 200, epoch: 3 | loss: 2.4288812
	speed: 0.2824s/iter; left time: 5700.5017s
Epoch: 3 cost time: 59.6389639377594
Epoch: 3, Steps: 208 | Train Loss: 2.688 Vali Loss: 4.943 Vali Acc: 0.085 Test Loss: 4.943 Test Acc: 0.085
Validation loss decreased (-0.072426 --> -0.084651).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4559979
	speed: 0.6572s/iter; left time: 13195.5113s
	iters: 200, epoch: 4 | loss: 1.9168738
	speed: 0.2817s/iter; left time: 5626.9826s
Epoch: 4 cost time: 59.1052942276001
Epoch: 4, Steps: 208 | Train Loss: 2.074 Vali Loss: 5.748 Vali Acc: 0.086 Test Loss: 5.748 Test Acc: 0.086
Validation loss decreased (-0.084651 --> -0.086134).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3994238
	speed: 0.6865s/iter; left time: 13639.5140s
	iters: 200, epoch: 5 | loss: 2.2771492
	speed: 0.2976s/iter; left time: 5882.3756s
Epoch: 5 cost time: 62.28233098983765
Epoch: 5, Steps: 208 | Train Loss: 1.547 Vali Loss: 6.198 Vali Acc: 0.074 Test Loss: 6.198 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6260447
	speed: 0.6888s/iter; left time: 13542.5154s
	iters: 200, epoch: 6 | loss: 1.8085154
	speed: 0.2701s/iter; left time: 5284.2862s
Epoch: 6 cost time: 59.58881092071533
Epoch: 6, Steps: 208 | Train Loss: 1.186 Vali Loss: 6.672 Vali Acc: 0.086 Test Loss: 6.672 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1666733
	speed: 0.6517s/iter; left time: 12678.2376s
	iters: 200, epoch: 7 | loss: 2.0542293
	speed: 0.2918s/iter; left time: 5647.1889s
Epoch: 7 cost time: 58.89741659164429
Epoch: 7, Steps: 208 | Train Loss: 0.945 Vali Loss: 7.545 Vali Acc: 0.081 Test Loss: 7.545 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.9315161
	speed: 0.6722s/iter; left time: 12936.3167s
	iters: 200, epoch: 8 | loss: 0.8317411
	speed: 0.2873s/iter; left time: 5500.4600s
Epoch: 8 cost time: 62.080493450164795
Epoch: 8, Steps: 208 | Train Loss: 0.742 Vali Loss: 7.898 Vali Acc: 0.087 Test Loss: 7.898 Test Acc: 0.087
Validation loss decreased (-0.086134 --> -0.086709).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0898738
	speed: 0.6916s/iter; left time: 13165.3005s
	iters: 200, epoch: 9 | loss: 0.7877487
	speed: 0.2826s/iter; left time: 5351.6252s
Epoch: 9 cost time: 59.45354390144348
Epoch: 9, Steps: 208 | Train Loss: 0.647 Vali Loss: 8.096 Vali Acc: 0.086 Test Loss: 8.096 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1522487
	speed: 0.6589s/iter; left time: 12406.9778s
	iters: 200, epoch: 10 | loss: 0.5192326
	speed: 0.2810s/iter; left time: 5263.3483s
Epoch: 10 cost time: 59.71079134941101
Epoch: 10, Steps: 208 | Train Loss: 0.535 Vali Loss: 8.898 Vali Acc: 0.080 Test Loss: 8.898 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6509396
	speed: 0.6493s/iter; left time: 12091.3846s
	iters: 200, epoch: 11 | loss: 0.2436866
	speed: 0.2612s/iter; left time: 4838.4750s
Epoch: 11 cost time: 57.816534757614136
Epoch: 11, Steps: 208 | Train Loss: 0.448 Vali Loss: 8.858 Vali Acc: 0.093 Test Loss: 8.858 Test Acc: 0.093
Validation loss decreased (-0.086709 --> -0.092962).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5170829
	speed: 0.6744s/iter; left time: 12418.4834s
	iters: 200, epoch: 12 | loss: 0.4038228
	speed: 0.2849s/iter; left time: 5217.9787s
Epoch: 12 cost time: 60.042720556259155
Epoch: 12, Steps: 208 | Train Loss: 0.412 Vali Loss: 9.073 Vali Acc: 0.097 Test Loss: 9.073 Test Acc: 0.097
Validation loss decreased (-0.092962 --> -0.097136).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1181988
	speed: 0.6533s/iter; left time: 11892.7325s
	iters: 200, epoch: 13 | loss: 0.1198919
	speed: 0.2607s/iter; left time: 4719.8938s
Epoch: 13 cost time: 57.42283868789673
Epoch: 13, Steps: 208 | Train Loss: 0.357 Vali Loss: 9.644 Vali Acc: 0.092 Test Loss: 9.644 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0693181
	speed: 0.6617s/iter; left time: 11908.0397s
	iters: 200, epoch: 14 | loss: 0.3633595
	speed: 0.2723s/iter; left time: 4873.4684s
Epoch: 14 cost time: 58.21773386001587
Epoch: 14, Steps: 208 | Train Loss: 0.325 Vali Loss: 10.203 Vali Acc: 0.097 Test Loss: 10.203 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5602253
	speed: 0.6589s/iter; left time: 11720.8487s
	iters: 200, epoch: 15 | loss: 0.1285772
	speed: 0.2888s/iter; left time: 5108.5451s
Epoch: 15 cost time: 59.31549119949341
Epoch: 15, Steps: 208 | Train Loss: 0.271 Vali Loss: 10.709 Vali Acc: 0.092 Test Loss: 10.709 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5836372
	speed: 0.6972s/iter; left time: 12258.0539s
	iters: 200, epoch: 16 | loss: 0.0968011
	speed: 0.2914s/iter; left time: 5094.1811s
Epoch: 16 cost time: 62.81076526641846
Epoch: 16, Steps: 208 | Train Loss: 0.288 Vali Loss: 10.479 Vali Acc: 0.093 Test Loss: 10.479 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3682680
	speed: 0.6557s/iter; left time: 11391.5555s
	iters: 200, epoch: 17 | loss: 0.7060267
	speed: 0.2950s/iter; left time: 5095.7940s
Epoch: 17 cost time: 58.92955160140991
Epoch: 17, Steps: 208 | Train Loss: 0.289 Vali Loss: 11.210 Vali Acc: 0.087 Test Loss: 11.210 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1585826
	speed: 0.6436s/iter; left time: 11047.6347s
	iters: 200, epoch: 18 | loss: 0.2206383
	speed: 0.2872s/iter; left time: 4901.1010s
Epoch: 18 cost time: 59.72401237487793
Epoch: 18, Steps: 208 | Train Loss: 0.245 Vali Loss: 10.745 Vali Acc: 0.087 Test Loss: 10.745 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2387109
	speed: 0.6450s/iter; left time: 10937.1067s
	iters: 200, epoch: 19 | loss: 0.6924406
	speed: 0.3039s/iter; left time: 5123.4304s
Epoch: 19 cost time: 62.14952731132507
Epoch: 19, Steps: 208 | Train Loss: 0.228 Vali Loss: 11.161 Vali Acc: 0.092 Test Loss: 11.161 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1013517
	speed: 0.6642s/iter; left time: 11125.3471s
	iters: 200, epoch: 20 | loss: 0.0206335
	speed: 0.2946s/iter; left time: 4905.4276s
Epoch: 20 cost time: 60.47162747383118
Epoch: 20, Steps: 208 | Train Loss: 0.202 Vali Loss: 11.409 Vali Acc: 0.095 Test Loss: 11.409 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2526102
	speed: 0.6513s/iter; left time: 10773.0537s
	iters: 200, epoch: 21 | loss: 0.4195850
	speed: 0.3079s/iter; left time: 5061.4392s
Epoch: 21 cost time: 62.05395698547363
Epoch: 21, Steps: 208 | Train Loss: 0.220 Vali Loss: 10.877 Vali Acc: 0.092 Test Loss: 10.877 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4682160
	speed: 0.6591s/iter; left time: 10765.0757s
	iters: 200, epoch: 22 | loss: 0.0993948
	speed: 0.2775s/iter; left time: 4504.8304s
Epoch: 22 cost time: 58.42651677131653
Epoch: 22, Steps: 208 | Train Loss: 0.217 Vali Loss: 11.817 Vali Acc: 0.090 Test Loss: 11.817 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0972263644497465
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4822979
	speed: 0.3271s/iter; left time: 6770.4269s
	iters: 200, epoch: 1 | loss: 4.3658204
	speed: 0.3026s/iter; left time: 6233.5891s
Epoch: 1 cost time: 65.85739588737488
Epoch: 1, Steps: 208 | Train Loss: 3.756 Vali Loss: 4.514 Vali Acc: 0.063 Test Loss: 4.514 Test Acc: 0.063
Validation loss decreased (inf --> -0.063182).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9812467
	speed: 0.7067s/iter; left time: 14483.3186s
	iters: 200, epoch: 2 | loss: 4.1065526
	speed: 0.2961s/iter; left time: 6038.6731s
Epoch: 2 cost time: 63.2673122882843
Epoch: 2, Steps: 208 | Train Loss: 3.283 Vali Loss: 4.902 Vali Acc: 0.073 Test Loss: 4.902 Test Acc: 0.073
Validation loss decreased (-0.063182 --> -0.072722).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4462135
	speed: 0.7014s/iter; left time: 14227.4848s
	iters: 200, epoch: 3 | loss: 2.7065885
	speed: 0.2811s/iter; left time: 5673.0873s
Epoch: 3 cost time: 62.00436353683472
Epoch: 3, Steps: 208 | Train Loss: 2.784 Vali Loss: 5.144 Vali Acc: 0.088 Test Loss: 5.144 Test Acc: 0.088
Validation loss decreased (-0.072722 --> -0.087631).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4065893
	speed: 0.7055s/iter; left time: 14163.6983s
	iters: 200, epoch: 4 | loss: 2.1528628
	speed: 0.2999s/iter; left time: 5991.5824s
Epoch: 4 cost time: 63.03600287437439
Epoch: 4, Steps: 208 | Train Loss: 2.307 Vali Loss: 6.008 Vali Acc: 0.089 Test Loss: 6.008 Test Acc: 0.089
Validation loss decreased (-0.087631 --> -0.089412).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9104831
	speed: 0.6979s/iter; left time: 13867.4079s
	iters: 200, epoch: 5 | loss: 1.9513875
	speed: 0.2852s/iter; left time: 5637.4159s
Epoch: 5 cost time: 61.14979815483093
Epoch: 5, Steps: 208 | Train Loss: 1.834 Vali Loss: 6.633 Vali Acc: 0.090 Test Loss: 6.633 Test Acc: 0.090
Validation loss decreased (-0.089412 --> -0.090002).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6223714
	speed: 0.6889s/iter; left time: 13543.6316s
	iters: 200, epoch: 6 | loss: 1.9759610
	speed: 0.2916s/iter; left time: 5703.3593s
Epoch: 6 cost time: 61.537259101867676
Epoch: 6, Steps: 208 | Train Loss: 1.505 Vali Loss: 6.892 Vali Acc: 0.095 Test Loss: 6.892 Test Acc: 0.095
Validation loss decreased (-0.090002 --> -0.095368).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0424950
	speed: 0.7131s/iter; left time: 13872.5736s
	iters: 200, epoch: 7 | loss: 2.1332190
	speed: 0.2959s/iter; left time: 5725.6130s
Epoch: 7 cost time: 62.647422552108765
Epoch: 7, Steps: 208 | Train Loss: 1.260 Vali Loss: 7.877 Vali Acc: 0.087 Test Loss: 7.877 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1984460
	speed: 0.7080s/iter; left time: 13624.9209s
	iters: 200, epoch: 8 | loss: 1.3571709
	speed: 0.2978s/iter; left time: 5700.6942s
Epoch: 8 cost time: 62.84399151802063
Epoch: 8, Steps: 208 | Train Loss: 1.020 Vali Loss: 7.930 Vali Acc: 0.085 Test Loss: 7.930 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5788379
	speed: 0.6847s/iter; left time: 13034.8718s
	iters: 200, epoch: 9 | loss: 0.8431479
	speed: 0.2832s/iter; left time: 5363.7960s
Epoch: 9 cost time: 60.63798785209656
Epoch: 9, Steps: 208 | Train Loss: 0.817 Vali Loss: 8.535 Vali Acc: 0.092 Test Loss: 8.535 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3528531
	speed: 0.6818s/iter; left time: 12837.5590s
	iters: 200, epoch: 10 | loss: 0.7437069
	speed: 0.2884s/iter; left time: 5401.9485s
Epoch: 10 cost time: 60.45291590690613
Epoch: 10, Steps: 208 | Train Loss: 0.733 Vali Loss: 9.041 Vali Acc: 0.083 Test Loss: 9.041 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4044720
	speed: 0.7034s/iter; left time: 13097.9025s
	iters: 200, epoch: 11 | loss: 0.8114445
	speed: 0.2985s/iter; left time: 5528.2999s
Epoch: 11 cost time: 63.00926876068115
Epoch: 11, Steps: 208 | Train Loss: 0.636 Vali Loss: 8.897 Vali Acc: 0.084 Test Loss: 8.897 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.9676217
	speed: 0.7039s/iter; left time: 12960.2525s
	iters: 200, epoch: 12 | loss: 0.0830251
	speed: 0.2939s/iter; left time: 5382.3529s
Epoch: 12 cost time: 62.641326904296875
Epoch: 12, Steps: 208 | Train Loss: 0.568 Vali Loss: 9.392 Vali Acc: 0.089 Test Loss: 9.392 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.5785314
	speed: 0.6783s/iter; left time: 12348.1540s
	iters: 200, epoch: 13 | loss: 0.2737891
	speed: 0.2849s/iter; left time: 5158.8112s
Epoch: 13 cost time: 59.57176756858826
Epoch: 13, Steps: 208 | Train Loss: 0.512 Vali Loss: 9.392 Vali Acc: 0.082 Test Loss: 9.392 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1059875
	speed: 0.7096s/iter; left time: 12770.3377s
	iters: 200, epoch: 14 | loss: 0.3712811
	speed: 0.2933s/iter; left time: 5249.5668s
Epoch: 14 cost time: 62.61664128303528
Epoch: 14, Steps: 208 | Train Loss: 0.440 Vali Loss: 9.704 Vali Acc: 0.086 Test Loss: 9.704 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0344625
	speed: 0.7434s/iter; left time: 13224.7515s
	iters: 200, epoch: 15 | loss: 0.6414843
	speed: 0.2999s/iter; left time: 5305.6484s
Epoch: 15 cost time: 63.95062732696533
Epoch: 15, Steps: 208 | Train Loss: 0.432 Vali Loss: 10.206 Vali Acc: 0.092 Test Loss: 10.206 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3836369
	speed: 0.7140s/iter; left time: 12553.0366s
	iters: 200, epoch: 16 | loss: 0.4696555
	speed: 0.3023s/iter; left time: 5284.3955s
Epoch: 16 cost time: 62.12021064758301
Epoch: 16, Steps: 208 | Train Loss: 0.402 Vali Loss: 10.246 Vali Acc: 0.085 Test Loss: 10.246 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09543692215926036
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0469241
	speed: 0.3106s/iter; left time: 6429.3610s
	iters: 200, epoch: 1 | loss: 4.0215163
	speed: 0.2881s/iter; left time: 5934.9717s
Epoch: 1 cost time: 62.50664401054382
Epoch: 1, Steps: 208 | Train Loss: 3.750 Vali Loss: 4.543 Vali Acc: 0.061 Test Loss: 4.543 Test Acc: 0.061
Validation loss decreased (inf --> -0.060796).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6690443
	speed: 0.7478s/iter; left time: 15325.5628s
	iters: 200, epoch: 2 | loss: 3.8644280
	speed: 0.3242s/iter; left time: 6610.9015s
Epoch: 2 cost time: 66.78656125068665
Epoch: 2, Steps: 208 | Train Loss: 3.342 Vali Loss: 4.985 Vali Acc: 0.067 Test Loss: 4.985 Test Acc: 0.067
Validation loss decreased (-0.060796 --> -0.066458).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0211279
	speed: 0.7342s/iter; left time: 14893.6460s
	iters: 200, epoch: 3 | loss: 2.5917628
	speed: 0.3096s/iter; left time: 6248.5985s
Epoch: 3 cost time: 64.43833947181702
Epoch: 3, Steps: 208 | Train Loss: 3.001 Vali Loss: 5.409 Vali Acc: 0.076 Test Loss: 5.409 Test Acc: 0.076
Validation loss decreased (-0.066458 --> -0.076295).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5989010
	speed: 0.6756s/iter; left time: 13564.3431s
	iters: 200, epoch: 4 | loss: 2.2764051
	speed: 0.2952s/iter; left time: 5896.2986s
Epoch: 4 cost time: 60.70380353927612
Epoch: 4, Steps: 208 | Train Loss: 2.605 Vali Loss: 5.790 Vali Acc: 0.089 Test Loss: 5.790 Test Acc: 0.089
Validation loss decreased (-0.076295 --> -0.088818).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9373727
	speed: 0.6907s/iter; left time: 13723.4811s
	iters: 200, epoch: 5 | loss: 1.9153708
	speed: 0.2981s/iter; left time: 5893.0449s
Epoch: 5 cost time: 62.7032368183136
Epoch: 5, Steps: 208 | Train Loss: 2.147 Vali Loss: 6.702 Vali Acc: 0.073 Test Loss: 6.702 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3022614
	speed: 0.7127s/iter; left time: 14012.1053s
	iters: 200, epoch: 6 | loss: 2.9933622
	speed: 0.2864s/iter; left time: 5601.5773s
Epoch: 6 cost time: 62.061354875564575
Epoch: 6, Steps: 208 | Train Loss: 1.805 Vali Loss: 6.908 Vali Acc: 0.074 Test Loss: 6.908 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0690582
	speed: 0.6887s/iter; left time: 13397.8346s
	iters: 200, epoch: 7 | loss: 2.1936090
	speed: 0.2777s/iter; left time: 5374.9516s
Epoch: 7 cost time: 59.355119943618774
Epoch: 7, Steps: 208 | Train Loss: 1.461 Vali Loss: 7.797 Vali Acc: 0.077 Test Loss: 7.797 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1546001
	speed: 0.6751s/iter; left time: 12991.6033s
	iters: 200, epoch: 8 | loss: 1.4120709
	speed: 0.2721s/iter; left time: 5208.4081s
Epoch: 8 cost time: 57.913588762283325
Epoch: 8, Steps: 208 | Train Loss: 1.254 Vali Loss: 7.935 Vali Acc: 0.079 Test Loss: 7.935 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6780765
	speed: 0.7054s/iter; left time: 13429.4403s
	iters: 200, epoch: 9 | loss: 0.7527761
	speed: 0.2919s/iter; left time: 5528.1935s
Epoch: 9 cost time: 61.14715647697449
Epoch: 9, Steps: 208 | Train Loss: 1.060 Vali Loss: 8.381 Vali Acc: 0.078 Test Loss: 8.381 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3693061
	speed: 0.6926s/iter; left time: 13041.6971s
	iters: 200, epoch: 10 | loss: 0.2468160
	speed: 0.3068s/iter; left time: 5745.8558s
Epoch: 10 cost time: 62.66996717453003
Epoch: 10, Steps: 208 | Train Loss: 0.898 Vali Loss: 8.712 Vali Acc: 0.074 Test Loss: 8.712 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4906893
	speed: 0.6831s/iter; left time: 12719.6514s
	iters: 200, epoch: 11 | loss: 0.5288367
	speed: 0.3015s/iter; left time: 5583.9694s
Epoch: 11 cost time: 62.73092985153198
Epoch: 11, Steps: 208 | Train Loss: 0.802 Vali Loss: 8.646 Vali Acc: 0.072 Test Loss: 8.646 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.8258523
	speed: 0.6647s/iter; left time: 12238.7120s
	iters: 200, epoch: 12 | loss: 0.2888139
	speed: 0.2954s/iter; left time: 5410.4946s
Epoch: 12 cost time: 60.534122467041016
Epoch: 12, Steps: 208 | Train Loss: 0.698 Vali Loss: 8.962 Vali Acc: 0.079 Test Loss: 8.962 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1182596
	speed: 0.7217s/iter; left time: 13138.5901s
	iters: 200, epoch: 13 | loss: 1.0587468
	speed: 0.2937s/iter; left time: 5317.5004s
Epoch: 13 cost time: 65.09079194068909
Epoch: 13, Steps: 208 | Train Loss: 0.631 Vali Loss: 9.065 Vali Acc: 0.090 Test Loss: 9.065 Test Acc: 0.090
Validation loss decreased (-0.088818 --> -0.090276).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3053252
	speed: 0.7483s/iter; left time: 13467.7028s
	iters: 200, epoch: 14 | loss: 0.6843165
	speed: 0.3161s/iter; left time: 5657.4655s
Epoch: 14 cost time: 64.59385466575623
Epoch: 14, Steps: 208 | Train Loss: 0.581 Vali Loss: 9.395 Vali Acc: 0.081 Test Loss: 9.395 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4313452
	speed: 0.7105s/iter; left time: 12639.6562s
	iters: 200, epoch: 15 | loss: 0.1005271
	speed: 0.2858s/iter; left time: 5055.9948s
Epoch: 15 cost time: 63.53684449195862
Epoch: 15, Steps: 208 | Train Loss: 0.537 Vali Loss: 9.810 Vali Acc: 0.084 Test Loss: 9.810 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3124867
	speed: 0.7168s/iter; left time: 12601.9067s
	iters: 200, epoch: 16 | loss: 0.2089455
	speed: 0.3199s/iter; left time: 5592.5950s
Epoch: 16 cost time: 64.13816142082214
Epoch: 16, Steps: 208 | Train Loss: 0.467 Vali Loss: 9.585 Vali Acc: 0.080 Test Loss: 9.585 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1093022
	speed: 0.7163s/iter; left time: 12443.9202s
	iters: 200, epoch: 17 | loss: 0.4374287
	speed: 0.2911s/iter; left time: 5028.9506s
Epoch: 17 cost time: 62.78291654586792
Epoch: 17, Steps: 208 | Train Loss: 0.408 Vali Loss: 9.732 Vali Acc: 0.084 Test Loss: 9.732 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2059769
	speed: 0.7023s/iter; left time: 12054.7226s
	iters: 200, epoch: 18 | loss: 0.5116805
	speed: 0.3118s/iter; left time: 5321.0981s
Epoch: 18 cost time: 63.14963221549988
Epoch: 18, Steps: 208 | Train Loss: 0.380 Vali Loss: 9.759 Vali Acc: 0.084 Test Loss: 9.759 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3542747
	speed: 0.6915s/iter; left time: 11726.6047s
	iters: 200, epoch: 19 | loss: 0.3755614
	speed: 0.2840s/iter; left time: 4786.6132s
Epoch: 19 cost time: 60.51038908958435
Epoch: 19, Steps: 208 | Train Loss: 0.368 Vali Loss: 10.454 Vali Acc: 0.083 Test Loss: 10.454 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1765637
	speed: 0.7150s/iter; left time: 11974.8044s
	iters: 200, epoch: 20 | loss: 0.3192542
	speed: 0.2954s/iter; left time: 4917.8585s
Epoch: 20 cost time: 60.47878694534302
Epoch: 20, Steps: 208 | Train Loss: 0.342 Vali Loss: 10.608 Vali Acc: 0.086 Test Loss: 10.608 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2977084
	speed: 0.7287s/iter; left time: 12053.3800s
	iters: 200, epoch: 21 | loss: 0.3585999
	speed: 0.3183s/iter; left time: 5233.5594s
Epoch: 21 cost time: 65.85832738876343
Epoch: 21, Steps: 208 | Train Loss: 0.365 Vali Loss: 10.798 Vali Acc: 0.079 Test Loss: 10.798 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4154957
	speed: 0.7239s/iter; left time: 11823.5034s
	iters: 200, epoch: 22 | loss: 0.1208798
	speed: 0.2913s/iter; left time: 4728.1648s
Epoch: 22 cost time: 62.24188828468323
Epoch: 22, Steps: 208 | Train Loss: 0.286 Vali Loss: 10.805 Vali Acc: 0.079 Test Loss: 10.805 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3917923
	speed: 0.7115s/iter; left time: 11472.3283s
	iters: 200, epoch: 23 | loss: 0.0362731
	speed: 0.3219s/iter; left time: 5158.8160s
Epoch: 23 cost time: 65.30493879318237
Epoch: 23, Steps: 208 | Train Loss: 0.257 Vali Loss: 11.124 Vali Acc: 0.086 Test Loss: 11.124 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09036683566954966
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0813570
	speed: 0.3365s/iter; left time: 6966.4223s
	iters: 200, epoch: 1 | loss: 4.2182598
	speed: 0.2870s/iter; left time: 5913.0622s
Epoch: 1 cost time: 65.14532208442688
Epoch: 1, Steps: 208 | Train Loss: 3.768 Vali Loss: 5.079 Vali Acc: 0.042 Test Loss: 5.079 Test Acc: 0.042
Validation loss decreased (inf --> -0.042299).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8348954
	speed: 0.7183s/iter; left time: 14720.8780s
	iters: 200, epoch: 2 | loss: 4.0729733
	speed: 0.3086s/iter; left time: 6293.2647s
Epoch: 2 cost time: 64.85851502418518
Epoch: 2, Steps: 208 | Train Loss: 3.409 Vali Loss: 5.389 Vali Acc: 0.038 Test Loss: 5.389 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.0229354
	speed: 0.7182s/iter; left time: 14567.9986s
	iters: 200, epoch: 3 | loss: 3.0846210
	speed: 0.3046s/iter; left time: 6147.6750s
Epoch: 3 cost time: 64.19285893440247
Epoch: 3, Steps: 208 | Train Loss: 3.167 Vali Loss: 5.688 Vali Acc: 0.054 Test Loss: 5.688 Test Acc: 0.054
Validation loss decreased (-0.042299 --> -0.053626).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1862555
	speed: 0.7523s/iter; left time: 15104.2104s
	iters: 200, epoch: 4 | loss: 2.7034655
	speed: 0.3221s/iter; left time: 6434.4936s
Epoch: 4 cost time: 67.63229537010193
Epoch: 4, Steps: 208 | Train Loss: 2.941 Vali Loss: 6.395 Vali Acc: 0.046 Test Loss: 6.395 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2324154
	speed: 0.6996s/iter; left time: 13900.7194s
	iters: 200, epoch: 5 | loss: 2.8275003
	speed: 0.3168s/iter; left time: 6261.8665s
Epoch: 5 cost time: 63.29057455062866
Epoch: 5, Steps: 208 | Train Loss: 2.609 Vali Loss: 6.125 Vali Acc: 0.055 Test Loss: 6.125 Test Acc: 0.055
Validation loss decreased (-0.053626 --> -0.054815).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4832277
	speed: 0.6991s/iter; left time: 13744.3758s
	iters: 200, epoch: 6 | loss: 2.7519233
	speed: 0.3090s/iter; left time: 6044.6990s
Epoch: 6 cost time: 62.07909035682678
Epoch: 6, Steps: 208 | Train Loss: 2.248 Vali Loss: 6.401 Vali Acc: 0.068 Test Loss: 6.401 Test Acc: 0.068
Validation loss decreased (-0.054815 --> -0.067935).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7858889
	speed: 0.7452s/iter; left time: 14496.1940s
	iters: 200, epoch: 7 | loss: 3.1941266
	speed: 0.3157s/iter; left time: 6110.1161s
Epoch: 7 cost time: 65.99089503288269
Epoch: 7, Steps: 208 | Train Loss: 1.850 Vali Loss: 6.687 Vali Acc: 0.071 Test Loss: 6.687 Test Acc: 0.071
Validation loss decreased (-0.067935 --> -0.071213).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1277971
	speed: 0.7723s/iter; left time: 14862.0604s
	iters: 200, epoch: 8 | loss: 2.6972973
	speed: 0.3092s/iter; left time: 5919.5337s
Epoch: 8 cost time: 66.45629930496216
Epoch: 8, Steps: 208 | Train Loss: 1.465 Vali Loss: 6.881 Vali Acc: 0.077 Test Loss: 6.881 Test Acc: 0.077
Validation loss decreased (-0.071213 --> -0.076877).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4785212
	speed: 0.7221s/iter; left time: 13746.6738s
	iters: 200, epoch: 9 | loss: 0.9552739
	speed: 0.3012s/iter; left time: 5704.2558s
Epoch: 9 cost time: 64.7528064250946
Epoch: 9, Steps: 208 | Train Loss: 1.255 Vali Loss: 7.160 Vali Acc: 0.077 Test Loss: 7.160 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5806782
	speed: 0.7205s/iter; left time: 13567.1221s
	iters: 200, epoch: 10 | loss: 0.9454180
	speed: 0.3007s/iter; left time: 5631.0577s
Epoch: 10 cost time: 64.25396466255188
Epoch: 10, Steps: 208 | Train Loss: 1.012 Vali Loss: 7.900 Vali Acc: 0.063 Test Loss: 7.900 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.7865624
	speed: 0.7323s/iter; left time: 13636.1966s
	iters: 200, epoch: 11 | loss: 0.5612541
	speed: 0.3191s/iter; left time: 5909.6737s
Epoch: 11 cost time: 67.28178381919861
Epoch: 11, Steps: 208 | Train Loss: 0.864 Vali Loss: 8.017 Vali Acc: 0.070 Test Loss: 8.017 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4990406
	speed: 0.7532s/iter; left time: 13869.3994s
	iters: 200, epoch: 12 | loss: 0.5722109
	speed: 0.3308s/iter; left time: 6057.3890s
Epoch: 12 cost time: 69.59587597846985
Epoch: 12, Steps: 208 | Train Loss: 0.760 Vali Loss: 8.298 Vali Acc: 0.072 Test Loss: 8.298 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4912062
	speed: 0.7366s/iter; left time: 13410.1688s
	iters: 200, epoch: 13 | loss: 0.4255211
	speed: 0.3040s/iter; left time: 5504.0185s
Epoch: 13 cost time: 63.67089056968689
Epoch: 13, Steps: 208 | Train Loss: 0.644 Vali Loss: 8.534 Vali Acc: 0.075 Test Loss: 8.534 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1800824
	speed: 0.7156s/iter; left time: 12878.7163s
	iters: 200, epoch: 14 | loss: 0.5621977
	speed: 0.2745s/iter; left time: 4912.8244s
Epoch: 14 cost time: 60.59861087799072
Epoch: 14, Steps: 208 | Train Loss: 0.606 Vali Loss: 8.687 Vali Acc: 0.077 Test Loss: 8.687 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4028836
	speed: 0.6610s/iter; left time: 11758.6557s
	iters: 200, epoch: 15 | loss: 0.2936037
	speed: 0.2836s/iter; left time: 5015.7526s
Epoch: 15 cost time: 59.81110501289368
Epoch: 15, Steps: 208 | Train Loss: 0.523 Vali Loss: 8.922 Vali Acc: 0.073 Test Loss: 8.922 Test Acc: 0.073
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.5438499
	speed: 0.7003s/iter; left time: 12311.3909s
	iters: 200, epoch: 16 | loss: 0.4403566
	speed: 0.2860s/iter; left time: 4999.7847s
Epoch: 16 cost time: 61.62078499794006
Epoch: 16, Steps: 208 | Train Loss: 0.464 Vali Loss: 9.690 Vali Acc: 0.079 Test Loss: 9.690 Test Acc: 0.079
Validation loss decreased (-0.076877 --> -0.078639).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6050831
	speed: 0.7324s/iter; left time: 12724.4953s
	iters: 200, epoch: 17 | loss: 0.3578728
	speed: 0.3077s/iter; left time: 5315.5837s
Epoch: 17 cost time: 65.97246217727661
Epoch: 17, Steps: 208 | Train Loss: 0.445 Vali Loss: 9.774 Vali Acc: 0.079 Test Loss: 9.774 Test Acc: 0.079
Validation loss decreased (-0.078639 --> -0.079234).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3380208
	speed: 0.7121s/iter; left time: 12222.6255s
	iters: 200, epoch: 18 | loss: 0.0889708
	speed: 0.3100s/iter; left time: 5290.2926s
Epoch: 18 cost time: 64.10704445838928
Epoch: 18, Steps: 208 | Train Loss: 0.396 Vali Loss: 9.468 Vali Acc: 0.075 Test Loss: 9.468 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5475780
	speed: 0.7197s/iter; left time: 12204.5335s
	iters: 200, epoch: 19 | loss: 0.0964829
	speed: 0.3087s/iter; left time: 5204.1094s
Epoch: 19 cost time: 64.54870367050171
Epoch: 19, Steps: 208 | Train Loss: 0.362 Vali Loss: 10.295 Vali Acc: 0.086 Test Loss: 10.295 Test Acc: 0.086
Validation loss decreased (-0.079234 --> -0.086089).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4576727
	speed: 0.7298s/iter; left time: 12224.1681s
	iters: 200, epoch: 20 | loss: 0.3018742
	speed: 0.3152s/iter; left time: 5247.6660s
Epoch: 20 cost time: 64.87886643409729
Epoch: 20, Steps: 208 | Train Loss: 0.365 Vali Loss: 10.279 Vali Acc: 0.073 Test Loss: 10.279 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0589336
	speed: 0.7427s/iter; left time: 12285.4982s
	iters: 200, epoch: 21 | loss: 0.6702419
	speed: 0.3202s/iter; left time: 5265.2006s
Epoch: 21 cost time: 65.54797959327698
Epoch: 21, Steps: 208 | Train Loss: 0.330 Vali Loss: 10.246 Vali Acc: 0.074 Test Loss: 10.246 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1118684
	speed: 0.7113s/iter; left time: 11617.8778s
	iters: 200, epoch: 22 | loss: 0.0779695
	speed: 0.3172s/iter; left time: 5149.6391s
Epoch: 22 cost time: 64.32219982147217
Epoch: 22, Steps: 208 | Train Loss: 0.327 Vali Loss: 10.403 Vali Acc: 0.076 Test Loss: 10.403 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1343374
	speed: 0.7267s/iter; left time: 11717.6210s
	iters: 200, epoch: 23 | loss: 0.4496032
	speed: 0.3241s/iter; left time: 5194.0094s
Epoch: 23 cost time: 66.75507259368896
Epoch: 23, Steps: 208 | Train Loss: 0.305 Vali Loss: 10.927 Vali Acc: 0.087 Test Loss: 10.927 Test Acc: 0.087
Validation loss decreased (-0.086089 --> -0.087275).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2200145
	speed: 0.7161s/iter; left time: 11398.3653s
	iters: 200, epoch: 24 | loss: 0.1697247
	speed: 0.3369s/iter; left time: 5329.4331s
Epoch: 24 cost time: 67.13628435134888
Epoch: 24, Steps: 208 | Train Loss: 0.295 Vali Loss: 10.900 Vali Acc: 0.081 Test Loss: 10.900 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1016589
	speed: 0.6933s/iter; left time: 10890.3923s
	iters: 200, epoch: 25 | loss: 0.0059786
	speed: 0.3043s/iter; left time: 4750.4207s
Epoch: 25 cost time: 63.80011606216431
Epoch: 25, Steps: 208 | Train Loss: 0.278 Vali Loss: 10.524 Vali Acc: 0.080 Test Loss: 10.524 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0121878
	speed: 0.7255s/iter; left time: 11245.8744s
	iters: 200, epoch: 26 | loss: 0.1580635
	speed: 0.3196s/iter; left time: 4921.7782s
Epoch: 26 cost time: 66.62736368179321
Epoch: 26, Steps: 208 | Train Loss: 0.249 Vali Loss: 11.275 Vali Acc: 0.076 Test Loss: 11.275 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.2028610
	speed: 0.7206s/iter; left time: 11019.6031s
	iters: 200, epoch: 27 | loss: 0.0078537
	speed: 0.3040s/iter; left time: 4618.3904s
Epoch: 27 cost time: 65.0502667427063
Epoch: 27, Steps: 208 | Train Loss: 0.244 Vali Loss: 10.769 Vali Acc: 0.082 Test Loss: 10.769 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.7103680
	speed: 0.7064s/iter; left time: 10655.4886s
	iters: 200, epoch: 28 | loss: 0.4801712
	speed: 0.3127s/iter; left time: 4686.5460s
Epoch: 28 cost time: 66.23870396614075
Epoch: 28, Steps: 208 | Train Loss: 0.225 Vali Loss: 11.251 Vali Acc: 0.078 Test Loss: 11.251 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1966525
	speed: 0.7315s/iter; left time: 10883.0228s
	iters: 200, epoch: 29 | loss: 0.0124640
	speed: 0.3288s/iter; left time: 4858.7554s
Epoch: 29 cost time: 67.76041603088379
Epoch: 29, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.911 Vali Acc: 0.086 Test Loss: 11.911 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0239749
	speed: 0.7263s/iter; left time: 10654.7860s
	iters: 200, epoch: 30 | loss: 0.7243912
	speed: 0.3081s/iter; left time: 4488.5924s
Epoch: 30 cost time: 65.08282732963562
Epoch: 30, Steps: 208 | Train Loss: 0.212 Vali Loss: 11.482 Vali Acc: 0.088 Test Loss: 11.482 Test Acc: 0.088
Validation loss decreased (-0.087275 --> -0.087568).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.3925667
	speed: 0.6882s/iter; left time: 9951.9387s
	iters: 200, epoch: 31 | loss: 0.0377343
	speed: 0.2947s/iter; left time: 4231.5345s
Epoch: 31 cost time: 62.0961172580719
Epoch: 31, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.515 Vali Acc: 0.076 Test Loss: 11.515 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.1905631
	speed: 0.7440s/iter; left time: 10604.3472s
	iters: 200, epoch: 32 | loss: 0.0618468
	speed: 0.3087s/iter; left time: 4368.5688s
Epoch: 32 cost time: 67.01273679733276
Epoch: 32, Steps: 208 | Train Loss: 0.233 Vali Loss: 11.181 Vali Acc: 0.080 Test Loss: 11.181 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0859474
	speed: 0.7630s/iter; left time: 10715.8688s
	iters: 200, epoch: 33 | loss: 0.0637043
	speed: 0.3198s/iter; left time: 4459.0417s
Epoch: 33 cost time: 66.5014910697937
Epoch: 33, Steps: 208 | Train Loss: 0.209 Vali Loss: 11.914 Vali Acc: 0.084 Test Loss: 11.914 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0279318
	speed: 0.7578s/iter; left time: 10485.5542s
	iters: 200, epoch: 34 | loss: 0.4998524
	speed: 0.3063s/iter; left time: 4207.8124s
Epoch: 34 cost time: 65.40000677108765
Epoch: 34, Steps: 208 | Train Loss: 0.240 Vali Loss: 11.114 Vali Acc: 0.084 Test Loss: 11.114 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.1478044
	speed: 0.7206s/iter; left time: 9820.4006s
	iters: 200, epoch: 35 | loss: 0.0022201
	speed: 0.3084s/iter; left time: 4172.3109s
Epoch: 35 cost time: 63.394503355026245
Epoch: 35, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.927 Vali Acc: 0.081 Test Loss: 11.927 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0362631
	speed: 0.7649s/iter; left time: 10265.5175s
	iters: 200, epoch: 36 | loss: 0.0563985
	speed: 0.3347s/iter; left time: 4458.2060s
Epoch: 36 cost time: 68.58062171936035
Epoch: 36, Steps: 208 | Train Loss: 0.185 Vali Loss: 12.156 Vali Acc: 0.085 Test Loss: 12.156 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0086658
	speed: 0.7140s/iter; left time: 9434.1213s
	iters: 200, epoch: 37 | loss: 0.0041665
	speed: 0.3035s/iter; left time: 3979.3512s
Epoch: 37 cost time: 63.910480260849
Epoch: 37, Steps: 208 | Train Loss: 0.160 Vali Loss: 11.996 Vali Acc: 0.086 Test Loss: 11.996 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.3591493
	speed: 0.7183s/iter; left time: 9341.4513s
	iters: 200, epoch: 38 | loss: 0.0067920
	speed: 0.3063s/iter; left time: 3952.7207s
Epoch: 38 cost time: 64.14432740211487
Epoch: 38, Steps: 208 | Train Loss: 0.161 Vali Loss: 12.229 Vali Acc: 0.092 Test Loss: 12.229 Test Acc: 0.092
Validation loss decreased (-0.087568 --> -0.091736).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0046013
	speed: 0.7376s/iter; left time: 9439.0766s
	iters: 200, epoch: 39 | loss: 0.1612748
	speed: 0.2979s/iter; left time: 3782.1155s
Epoch: 39 cost time: 65.14792203903198
Epoch: 39, Steps: 208 | Train Loss: 0.172 Vali Loss: 12.181 Vali Acc: 0.088 Test Loss: 12.181 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0093967
	speed: 0.7158s/iter; left time: 9011.3579s
	iters: 200, epoch: 40 | loss: 0.5544407
	speed: 0.2895s/iter; left time: 3615.3585s
Epoch: 40 cost time: 61.51770257949829
Epoch: 40, Steps: 208 | Train Loss: 0.165 Vali Loss: 12.294 Vali Acc: 0.084 Test Loss: 12.294 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0221382
	speed: 0.7264s/iter; left time: 8994.0796s
	iters: 200, epoch: 41 | loss: 0.0080101
	speed: 0.3118s/iter; left time: 3829.4922s
Epoch: 41 cost time: 65.5161521434784
Epoch: 41, Steps: 208 | Train Loss: 0.167 Vali Loss: 12.512 Vali Acc: 0.081 Test Loss: 12.512 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0105477
	speed: 0.7446s/iter; left time: 9063.6196s
	iters: 200, epoch: 42 | loss: 0.1852409
	speed: 0.3065s/iter; left time: 3700.3880s
Epoch: 42 cost time: 63.49679398536682
Epoch: 42, Steps: 208 | Train Loss: 0.179 Vali Loss: 12.813 Vali Acc: 0.088 Test Loss: 12.813 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0881814
	speed: 0.6982s/iter; left time: 8354.1013s
	iters: 200, epoch: 43 | loss: 0.0063787
	speed: 0.2955s/iter; left time: 3505.5452s
Epoch: 43 cost time: 62.53540873527527
Epoch: 43, Steps: 208 | Train Loss: 0.170 Vali Loss: 12.034 Vali Acc: 0.078 Test Loss: 12.034 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0167208
	speed: 0.7414s/iter; left time: 8716.0644s
	iters: 200, epoch: 44 | loss: 0.0018062
	speed: 0.2861s/iter; left time: 3334.5731s
Epoch: 44 cost time: 62.41885852813721
Epoch: 44, Steps: 208 | Train Loss: 0.173 Vali Loss: 12.198 Vali Acc: 0.072 Test Loss: 12.198 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0381180
	speed: 0.7201s/iter; left time: 8316.9778s
	iters: 200, epoch: 45 | loss: 0.4172147
	speed: 0.2686s/iter; left time: 3075.5209s
Epoch: 45 cost time: 59.92640829086304
Epoch: 45, Steps: 208 | Train Loss: 0.162 Vali Loss: 12.149 Vali Acc: 0.085 Test Loss: 12.149 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.0087020
	speed: 0.7039s/iter; left time: 7982.9862s
	iters: 200, epoch: 46 | loss: 0.0620200
	speed: 0.2774s/iter; left time: 3118.1186s
Epoch: 46 cost time: 59.18197798728943
Epoch: 46, Steps: 208 | Train Loss: 0.158 Vali Loss: 12.929 Vali Acc: 0.086 Test Loss: 12.929 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.0051993
	speed: 0.7099s/iter; left time: 7903.8074s
	iters: 200, epoch: 47 | loss: 0.0044297
	speed: 0.3218s/iter; left time: 3550.6463s
Epoch: 47 cost time: 64.56267642974854
Epoch: 47, Steps: 208 | Train Loss: 0.156 Vali Loss: 12.620 Vali Acc: 0.086 Test Loss: 12.620 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.2358524
	speed: 0.7232s/iter; left time: 7901.2530s
	iters: 200, epoch: 48 | loss: 0.0332398
	speed: 0.2866s/iter; left time: 3102.9110s
Epoch: 48 cost time: 62.45300078392029
Epoch: 48, Steps: 208 | Train Loss: 0.144 Vali Loss: 13.087 Vali Acc: 0.077 Test Loss: 13.087 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0918580375782881
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8212898
	speed: 0.3221s/iter; left time: 6667.0409s
	iters: 200, epoch: 1 | loss: 3.7492430
	speed: 0.3188s/iter; left time: 6567.5290s
Epoch: 1 cost time: 66.80772662162781
Epoch: 1, Steps: 208 | Train Loss: 3.708 Vali Loss: 5.781 Vali Acc: 0.033 Test Loss: 5.781 Test Acc: 0.033
Validation loss decreased (inf --> -0.033345).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4736152
	speed: 0.7841s/iter; left time: 16068.7553s
	iters: 200, epoch: 2 | loss: 4.1529064
	speed: 0.3307s/iter; left time: 6743.8580s
Epoch: 2 cost time: 70.13381743431091
Epoch: 2, Steps: 208 | Train Loss: 3.428 Vali Loss: 5.942 Vali Acc: 0.039 Test Loss: 5.942 Test Acc: 0.039
Validation loss decreased (-0.033345 --> -0.039308).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1983590
	speed: 0.7127s/iter; left time: 14456.2981s
	iters: 200, epoch: 3 | loss: 3.3701408
	speed: 0.3102s/iter; left time: 6260.6545s
Epoch: 3 cost time: 63.3392014503479
Epoch: 3, Steps: 208 | Train Loss: 3.318 Vali Loss: 6.898 Vali Acc: 0.041 Test Loss: 6.898 Test Acc: 0.041
Validation loss decreased (-0.039308 --> -0.040492).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6651800
	speed: 0.7164s/iter; left time: 14382.5449s
	iters: 200, epoch: 4 | loss: 3.2177303
	speed: 0.2829s/iter; left time: 5652.4493s
Epoch: 4 cost time: 60.94244337081909
Epoch: 4, Steps: 208 | Train Loss: 3.190 Vali Loss: 6.971 Vali Acc: 0.041 Test Loss: 6.971 Test Acc: 0.041
Validation loss decreased (-0.040492 --> -0.040789).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0825992
	speed: 0.7213s/iter; left time: 14330.6750s
	iters: 200, epoch: 5 | loss: 2.8998141
	speed: 0.2914s/iter; left time: 5760.6619s
Epoch: 5 cost time: 63.62665033340454
Epoch: 5, Steps: 208 | Train Loss: 2.938 Vali Loss: 6.783 Vali Acc: 0.048 Test Loss: 6.783 Test Acc: 0.048
Validation loss decreased (-0.040789 --> -0.047651).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3798783
	speed: 0.7097s/iter; left time: 13953.8000s
	iters: 200, epoch: 6 | loss: 3.4000041
	speed: 0.3120s/iter; left time: 6102.4969s
Epoch: 6 cost time: 63.043519020080566
Epoch: 6, Steps: 208 | Train Loss: 2.697 Vali Loss: 6.327 Vali Acc: 0.067 Test Loss: 6.327 Test Acc: 0.067
Validation loss decreased (-0.047651 --> -0.066743).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6004077
	speed: 0.7130s/iter; left time: 13870.1609s
	iters: 200, epoch: 7 | loss: 3.2675533
	speed: 0.2893s/iter; left time: 5599.0308s
Epoch: 7 cost time: 62.23949384689331
Epoch: 7, Steps: 208 | Train Loss: 2.290 Vali Loss: 6.476 Vali Acc: 0.055 Test Loss: 6.476 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3806486
	speed: 0.7069s/iter; left time: 13604.6886s
	iters: 200, epoch: 8 | loss: 1.8889169
	speed: 0.2937s/iter; left time: 5622.4312s
Epoch: 8 cost time: 60.96867918968201
Epoch: 8, Steps: 208 | Train Loss: 1.947 Vali Loss: 6.396 Vali Acc: 0.065 Test Loss: 6.396 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.1949515
	speed: 0.6694s/iter; left time: 12742.8916s
	iters: 200, epoch: 9 | loss: 2.1455624
	speed: 0.3000s/iter; left time: 5680.9458s
Epoch: 9 cost time: 61.08863306045532
Epoch: 9, Steps: 208 | Train Loss: 1.644 Vali Loss: 6.334 Vali Acc: 0.072 Test Loss: 6.334 Test Acc: 0.072
Validation loss decreased (-0.066743 --> -0.072409).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8546869
	speed: 0.7211s/iter; left time: 13576.7120s
	iters: 200, epoch: 10 | loss: 1.3287790
	speed: 0.3105s/iter; left time: 5815.4349s
Epoch: 10 cost time: 63.67598557472229
Epoch: 10, Steps: 208 | Train Loss: 1.365 Vali Loss: 6.981 Vali Acc: 0.065 Test Loss: 6.981 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1034858
	speed: 0.7070s/iter; left time: 13165.1320s
	iters: 200, epoch: 11 | loss: 0.9546606
	speed: 0.3114s/iter; left time: 5768.0015s
Epoch: 11 cost time: 63.530277729034424
Epoch: 11, Steps: 208 | Train Loss: 1.118 Vali Loss: 7.292 Vali Acc: 0.069 Test Loss: 7.292 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2731313
	speed: 0.7258s/iter; left time: 13364.3087s
	iters: 200, epoch: 12 | loss: 0.6993086
	speed: 0.3143s/iter; left time: 5756.6038s
Epoch: 12 cost time: 64.72520017623901
Epoch: 12, Steps: 208 | Train Loss: 0.963 Vali Loss: 7.523 Vali Acc: 0.079 Test Loss: 7.523 Test Acc: 0.079
Validation loss decreased (-0.072409 --> -0.078660).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4147660
	speed: 0.7166s/iter; left time: 13045.5955s
	iters: 200, epoch: 13 | loss: 0.9577833
	speed: 0.2943s/iter; left time: 5327.6790s
Epoch: 13 cost time: 63.01861882209778
Epoch: 13, Steps: 208 | Train Loss: 0.834 Vali Loss: 7.799 Vali Acc: 0.070 Test Loss: 7.799 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5629581
	speed: 0.7298s/iter; left time: 13134.3138s
	iters: 200, epoch: 14 | loss: 2.2965696
	speed: 0.3058s/iter; left time: 5472.1763s
Epoch: 14 cost time: 65.23622965812683
Epoch: 14, Steps: 208 | Train Loss: 0.707 Vali Loss: 8.198 Vali Acc: 0.076 Test Loss: 8.198 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5981519
	speed: 0.7497s/iter; left time: 13335.5786s
	iters: 200, epoch: 15 | loss: 0.2092071
	speed: 0.3202s/iter; left time: 5664.6440s
Epoch: 15 cost time: 66.34091663360596
Epoch: 15, Steps: 208 | Train Loss: 0.648 Vali Loss: 8.645 Vali Acc: 0.087 Test Loss: 8.645 Test Acc: 0.087
Validation loss decreased (-0.078660 --> -0.087298).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7110006
	speed: 0.7608s/iter; left time: 13376.3478s
	iters: 200, epoch: 16 | loss: 0.4738191
	speed: 0.3297s/iter; left time: 5762.8492s
Epoch: 16 cost time: 67.43290734291077
Epoch: 16, Steps: 208 | Train Loss: 0.578 Vali Loss: 8.519 Vali Acc: 0.080 Test Loss: 8.519 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3638375
	speed: 0.7583s/iter; left time: 13174.3216s
	iters: 200, epoch: 17 | loss: 0.6813855
	speed: 0.3323s/iter; left time: 5740.5593s
Epoch: 17 cost time: 67.78557085990906
Epoch: 17, Steps: 208 | Train Loss: 0.558 Vali Loss: 8.913 Vali Acc: 0.080 Test Loss: 8.913 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1217570
	speed: 0.7859s/iter; left time: 13489.8852s
	iters: 200, epoch: 18 | loss: 0.2927772
	speed: 0.3475s/iter; left time: 5929.6717s
Epoch: 18 cost time: 71.90040755271912
Epoch: 18, Steps: 208 | Train Loss: 0.482 Vali Loss: 9.315 Vali Acc: 0.078 Test Loss: 9.315 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8635465
	speed: 0.8131s/iter; left time: 13786.9987s
	iters: 200, epoch: 19 | loss: 0.2323090
	speed: 0.3319s/iter; left time: 5594.2282s
Epoch: 19 cost time: 70.81616282463074
Epoch: 19, Steps: 208 | Train Loss: 0.458 Vali Loss: 9.360 Vali Acc: 0.091 Test Loss: 9.360 Test Acc: 0.091
Validation loss decreased (-0.087298 --> -0.091168).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5885178
	speed: 0.7561s/iter; left time: 12663.2689s
	iters: 200, epoch: 20 | loss: 0.0407029
	speed: 0.3032s/iter; left time: 5048.2631s
Epoch: 20 cost time: 64.58694696426392
Epoch: 20, Steps: 208 | Train Loss: 0.425 Vali Loss: 9.356 Vali Acc: 0.089 Test Loss: 9.356 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.6575397
	speed: 0.7715s/iter; left time: 12760.8169s
	iters: 200, epoch: 21 | loss: 0.4559344
	speed: 0.3203s/iter; left time: 5265.4349s
Epoch: 21 cost time: 68.24702453613281
Epoch: 21, Steps: 208 | Train Loss: 0.413 Vali Loss: 9.477 Vali Acc: 0.078 Test Loss: 9.477 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2017414
	speed: 0.7905s/iter; left time: 12911.6631s
	iters: 200, epoch: 22 | loss: 0.3168533
	speed: 0.3286s/iter; left time: 5333.8950s
Epoch: 22 cost time: 68.38650131225586
Epoch: 22, Steps: 208 | Train Loss: 0.380 Vali Loss: 9.431 Vali Acc: 0.092 Test Loss: 9.431 Test Acc: 0.092
Validation loss decreased (-0.091168 --> -0.091764).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0477780
	speed: 0.8041s/iter; left time: 12965.8713s
	iters: 200, epoch: 23 | loss: 0.3160456
	speed: 0.3193s/iter; left time: 5116.7276s
Epoch: 23 cost time: 66.66781902313232
Epoch: 23, Steps: 208 | Train Loss: 0.382 Vali Loss: 9.683 Vali Acc: 0.086 Test Loss: 9.683 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.5245624
	speed: 0.7469s/iter; left time: 11889.0351s
	iters: 200, epoch: 24 | loss: 0.3324402
	speed: 0.3014s/iter; left time: 4767.9848s
Epoch: 24 cost time: 64.22969889640808
Epoch: 24, Steps: 208 | Train Loss: 0.319 Vali Loss: 10.030 Vali Acc: 0.087 Test Loss: 10.030 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.6721198
	speed: 0.7447s/iter; left time: 11698.3802s
	iters: 200, epoch: 25 | loss: 0.1696101
	speed: 0.3165s/iter; left time: 4940.5975s
Epoch: 25 cost time: 65.62056803703308
Epoch: 25, Steps: 208 | Train Loss: 0.353 Vali Loss: 10.198 Vali Acc: 0.084 Test Loss: 10.198 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0568679
	speed: 0.7443s/iter; left time: 11537.4117s
	iters: 200, epoch: 26 | loss: 0.2407735
	speed: 0.3259s/iter; left time: 5018.8911s
Epoch: 26 cost time: 66.22625827789307
Epoch: 26, Steps: 208 | Train Loss: 0.281 Vali Loss: 10.039 Vali Acc: 0.092 Test Loss: 10.039 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0401748
	speed: 0.7641s/iter; left time: 11685.1209s
	iters: 200, epoch: 27 | loss: 0.0475964
	speed: 0.3150s/iter; left time: 4785.0572s
Epoch: 27 cost time: 64.55890607833862
Epoch: 27, Steps: 208 | Train Loss: 0.293 Vali Loss: 10.344 Vali Acc: 0.092 Test Loss: 10.344 Test Acc: 0.092
Validation loss decreased (-0.091764 --> -0.092053).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.0268322
	speed: 0.7537s/iter; left time: 11368.8288s
	iters: 200, epoch: 28 | loss: 0.2371691
	speed: 0.3170s/iter; left time: 4750.7402s
Epoch: 28 cost time: 64.7640860080719
Epoch: 28, Steps: 208 | Train Loss: 0.301 Vali Loss: 10.272 Vali Acc: 0.096 Test Loss: 10.272 Test Acc: 0.096
Validation loss decreased (-0.092053 --> -0.096229).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.4633131
	speed: 0.7213s/iter; left time: 10731.0320s
	iters: 200, epoch: 29 | loss: 0.2728364
	speed: 0.3198s/iter; left time: 4726.2275s
Epoch: 29 cost time: 65.73027062416077
Epoch: 29, Steps: 208 | Train Loss: 0.290 Vali Loss: 10.615 Vali Acc: 0.096 Test Loss: 10.615 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0474570
	speed: 0.7570s/iter; left time: 11104.0604s
	iters: 200, epoch: 30 | loss: 0.3165141
	speed: 0.3238s/iter; left time: 4718.1197s
Epoch: 30 cost time: 66.4061484336853
Epoch: 30, Steps: 208 | Train Loss: 0.250 Vali Loss: 10.572 Vali Acc: 0.090 Test Loss: 10.572 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0748033
	speed: 0.7225s/iter; left time: 10448.6388s
	iters: 200, epoch: 31 | loss: 0.3021593
	speed: 0.3356s/iter; left time: 4819.5319s
Epoch: 31 cost time: 67.59814214706421
Epoch: 31, Steps: 208 | Train Loss: 0.249 Vali Loss: 10.599 Vali Acc: 0.097 Test Loss: 10.599 Test Acc: 0.097
Validation loss decreased (-0.096229 --> -0.096524).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.1900653
	speed: 0.7319s/iter; left time: 10431.9966s
	iters: 200, epoch: 32 | loss: 0.1178228
	speed: 0.3339s/iter; left time: 4725.2749s
Epoch: 32 cost time: 67.13767552375793
Epoch: 32, Steps: 208 | Train Loss: 0.234 Vali Loss: 11.209 Vali Acc: 0.094 Test Loss: 11.209 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.3368683
	speed: 0.7658s/iter; left time: 10755.9290s
	iters: 200, epoch: 33 | loss: 0.1483439
	speed: 0.3293s/iter; left time: 4591.9461s
Epoch: 33 cost time: 68.96475839614868
Epoch: 33, Steps: 208 | Train Loss: 0.240 Vali Loss: 11.124 Vali Acc: 0.087 Test Loss: 11.124 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.2722439
	speed: 0.7433s/iter; left time: 10285.0857s
	iters: 200, epoch: 34 | loss: 0.1383974
	speed: 0.3382s/iter; left time: 4645.4291s
Epoch: 34 cost time: 68.22029495239258
Epoch: 34, Steps: 208 | Train Loss: 0.233 Vali Loss: 10.912 Vali Acc: 0.085 Test Loss: 10.912 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.1994404
	speed: 0.7329s/iter; left time: 9988.7589s
	iters: 200, epoch: 35 | loss: 0.2259314
	speed: 0.3206s/iter; left time: 4337.7231s
Epoch: 35 cost time: 66.5197446346283
Epoch: 35, Steps: 208 | Train Loss: 0.251 Vali Loss: 11.127 Vali Acc: 0.092 Test Loss: 11.127 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0278664
	speed: 0.7362s/iter; left time: 9880.1060s
	iters: 200, epoch: 36 | loss: 0.0056983
	speed: 0.3299s/iter; left time: 4394.8836s
Epoch: 36 cost time: 67.53523278236389
Epoch: 36, Steps: 208 | Train Loss: 0.206 Vali Loss: 11.018 Vali Acc: 0.094 Test Loss: 11.018 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0102768
	speed: 0.7669s/iter; left time: 10133.6774s
	iters: 200, epoch: 37 | loss: 0.0983263
	speed: 0.3264s/iter; left time: 4280.2966s
Epoch: 37 cost time: 69.92385745048523
Epoch: 37, Steps: 208 | Train Loss: 0.200 Vali Loss: 11.227 Vali Acc: 0.081 Test Loss: 11.227 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.6577737
	speed: 0.7439s/iter; left time: 9674.3740s
	iters: 200, epoch: 38 | loss: 0.3117323
	speed: 0.3027s/iter; left time: 3906.0839s
Epoch: 38 cost time: 64.7414116859436
Epoch: 38, Steps: 208 | Train Loss: 0.215 Vali Loss: 11.204 Vali Acc: 0.098 Test Loss: 11.204 Test Acc: 0.098
Validation loss decreased (-0.096524 --> -0.098307).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0078090
	speed: 0.7201s/iter; left time: 9215.0419s
	iters: 200, epoch: 39 | loss: 0.0158273
	speed: 0.2984s/iter; left time: 3788.6913s
Epoch: 39 cost time: 63.62446880340576
Epoch: 39, Steps: 208 | Train Loss: 0.203 Vali Loss: 11.135 Vali Acc: 0.097 Test Loss: 11.135 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0675257
	speed: 0.7254s/iter; left time: 9132.4625s
	iters: 200, epoch: 40 | loss: 0.1255983
	speed: 0.3262s/iter; left time: 4074.4465s
Epoch: 40 cost time: 67.64067506790161
Epoch: 40, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.368 Vali Acc: 0.100 Test Loss: 11.368 Test Acc: 0.100
Validation loss decreased (-0.098307 --> -0.100095).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0190110
	speed: 0.7336s/iter; left time: 9082.2386s
	iters: 200, epoch: 41 | loss: 0.0678726
	speed: 0.3279s/iter; left time: 4027.1454s
Epoch: 41 cost time: 67.4346969127655
Epoch: 41, Steps: 208 | Train Loss: 0.185 Vali Loss: 11.428 Vali Acc: 0.090 Test Loss: 11.428 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.2554866
	speed: 0.7842s/iter; left time: 9546.1939s
	iters: 200, epoch: 42 | loss: 0.0533137
	speed: 0.3087s/iter; left time: 3726.4789s
Epoch: 42 cost time: 65.49440479278564
Epoch: 42, Steps: 208 | Train Loss: 0.185 Vali Loss: 11.647 Vali Acc: 0.084 Test Loss: 11.647 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0328501
	speed: 0.7400s/iter; left time: 8854.6549s
	iters: 200, epoch: 43 | loss: 0.0373047
	speed: 0.2916s/iter; left time: 3459.9193s
Epoch: 43 cost time: 61.728809118270874
Epoch: 43, Steps: 208 | Train Loss: 0.179 Vali Loss: 11.529 Vali Acc: 0.091 Test Loss: 11.529 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0033985
	speed: 0.6757s/iter; left time: 7943.9026s
	iters: 200, epoch: 44 | loss: 0.3644227
	speed: 0.3011s/iter; left time: 3509.6024s
Epoch: 44 cost time: 61.091593980789185
Epoch: 44, Steps: 208 | Train Loss: 0.160 Vali Loss: 11.478 Vali Acc: 0.096 Test Loss: 11.478 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.1003619
	speed: 0.7178s/iter; left time: 8290.2136s
	iters: 200, epoch: 45 | loss: 0.5738953
	speed: 0.2969s/iter; left time: 3398.8422s
Epoch: 45 cost time: 63.38028359413147
Epoch: 45, Steps: 208 | Train Loss: 0.183 Vali Loss: 11.652 Vali Acc: 0.089 Test Loss: 11.652 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0105007
	speed: 0.7165s/iter; left time: 8126.3103s
	iters: 200, epoch: 46 | loss: 0.0965835
	speed: 0.3154s/iter; left time: 3545.2149s
Epoch: 46 cost time: 66.61441421508789
Epoch: 46, Steps: 208 | Train Loss: 0.195 Vali Loss: 11.612 Vali Acc: 0.090 Test Loss: 11.612 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.1272609
	speed: 0.7062s/iter; left time: 7861.7897s
	iters: 200, epoch: 47 | loss: 0.0930231
	speed: 0.3019s/iter; left time: 3330.8168s
Epoch: 47 cost time: 63.47514319419861
Epoch: 47, Steps: 208 | Train Loss: 0.178 Vali Loss: 11.948 Vali Acc: 0.093 Test Loss: 11.948 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0647221
	speed: 0.7107s/iter; left time: 7764.1038s
	iters: 200, epoch: 48 | loss: 0.0100916
	speed: 0.2898s/iter; left time: 3136.7418s
Epoch: 48 cost time: 60.562801122665405
Epoch: 48, Steps: 208 | Train Loss: 0.176 Vali Loss: 12.528 Vali Acc: 0.084 Test Loss: 12.528 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0161798
	speed: 0.7160s/iter; left time: 7673.5965s
	iters: 200, epoch: 49 | loss: 0.2562723
	speed: 0.2883s/iter; left time: 3060.7791s
Epoch: 49 cost time: 60.41068434715271
Epoch: 49, Steps: 208 | Train Loss: 0.177 Vali Loss: 11.834 Vali Acc: 0.099 Test Loss: 11.834 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0048655
	speed: 0.6973s/iter; left time: 7328.0363s
	iters: 200, epoch: 50 | loss: 0.0554572
	speed: 0.2940s/iter; left time: 3060.1179s
Epoch: 50 cost time: 60.11856126785278
Epoch: 50, Steps: 208 | Train Loss: 0.150 Vali Loss: 12.236 Vali Acc: 0.085 Test Loss: 12.236 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10020876826722339
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8742282
	speed: 0.3179s/iter; left time: 6581.5717s
	iters: 200, epoch: 1 | loss: 3.8843138
	speed: 0.2902s/iter; left time: 5977.4134s
Epoch: 1 cost time: 63.37308192253113
Epoch: 1, Steps: 208 | Train Loss: 3.699 Vali Loss: 5.309 Vali Acc: 0.038 Test Loss: 5.309 Test Acc: 0.038
Validation loss decreased (inf --> -0.037525).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5510721
	speed: 0.7543s/iter; left time: 15457.5076s
	iters: 200, epoch: 2 | loss: 4.0350223
	speed: 0.3116s/iter; left time: 6354.5272s
Epoch: 2 cost time: 66.26189994812012
Epoch: 2, Steps: 208 | Train Loss: 3.302 Vali Loss: 5.879 Vali Acc: 0.041 Test Loss: 5.879 Test Acc: 0.041
Validation loss decreased (-0.037525 --> -0.041397).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9358671
	speed: 0.7197s/iter; left time: 14599.7984s
	iters: 200, epoch: 3 | loss: 3.0136559
	speed: 0.3224s/iter; left time: 6508.0305s
Epoch: 3 cost time: 63.89783596992493
Epoch: 3, Steps: 208 | Train Loss: 3.087 Vali Loss: 6.742 Vali Acc: 0.047 Test Loss: 6.742 Test Acc: 0.047
Validation loss decreased (-0.041397 --> -0.046458).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2957754
	speed: 0.6853s/iter; left time: 13759.4988s
	iters: 200, epoch: 4 | loss: 2.7146106
	speed: 0.3023s/iter; left time: 6038.0679s
Epoch: 4 cost time: 62.91706991195679
Epoch: 4, Steps: 208 | Train Loss: 2.906 Vali Loss: 7.450 Vali Acc: 0.042 Test Loss: 7.450 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4477601
	speed: 0.7094s/iter; left time: 14095.2497s
	iters: 200, epoch: 5 | loss: 2.0130320
	speed: 0.2971s/iter; left time: 5873.1882s
Epoch: 5 cost time: 62.43799161911011
Epoch: 5, Steps: 208 | Train Loss: 2.595 Vali Loss: 7.777 Vali Acc: 0.048 Test Loss: 7.777 Test Acc: 0.048
Validation loss decreased (-0.046458 --> -0.047939).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1292160
	speed: 0.7324s/iter; left time: 14400.3349s
	iters: 200, epoch: 6 | loss: 3.1658905
	speed: 0.2901s/iter; left time: 5675.2667s
Epoch: 6 cost time: 61.493090867996216
Epoch: 6, Steps: 208 | Train Loss: 2.320 Vali Loss: 7.600 Vali Acc: 0.058 Test Loss: 7.600 Test Acc: 0.058
Validation loss decreased (-0.047939 --> -0.057783).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2776451
	speed: 0.7104s/iter; left time: 13819.1207s
	iters: 200, epoch: 7 | loss: 3.2473149
	speed: 0.3004s/iter; left time: 5813.8864s
Epoch: 7 cost time: 61.885579109191895
Epoch: 7, Steps: 208 | Train Loss: 1.971 Vali Loss: 8.181 Vali Acc: 0.058 Test Loss: 8.181 Test Acc: 0.058
Validation loss decreased (-0.057783 --> -0.058373).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5464158
	speed: 0.6765s/iter; left time: 13019.9924s
	iters: 200, epoch: 8 | loss: 2.1459708
	speed: 0.2927s/iter; left time: 5603.3782s
Epoch: 8 cost time: 60.13932490348816
Epoch: 8, Steps: 208 | Train Loss: 1.655 Vali Loss: 8.335 Vali Acc: 0.060 Test Loss: 8.335 Test Acc: 0.060
Validation loss decreased (-0.058373 --> -0.059565).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8373170
	speed: 0.6844s/iter; left time: 13029.6430s
	iters: 200, epoch: 9 | loss: 1.5466740
	speed: 0.2945s/iter; left time: 5576.0755s
Epoch: 9 cost time: 60.96249556541443
Epoch: 9, Steps: 208 | Train Loss: 1.380 Vali Loss: 8.528 Vali Acc: 0.066 Test Loss: 8.528 Test Acc: 0.066
Validation loss decreased (-0.059565 --> -0.065826).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6933208
	speed: 0.6995s/iter; left time: 13170.5654s
	iters: 200, epoch: 10 | loss: 1.4110107
	speed: 0.2816s/iter; left time: 5273.1678s
Epoch: 10 cost time: 60.817479610443115
Epoch: 10, Steps: 208 | Train Loss: 1.190 Vali Loss: 8.978 Vali Acc: 0.063 Test Loss: 8.978 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7408417
	speed: 0.6964s/iter; left time: 12967.7416s
	iters: 200, epoch: 11 | loss: 0.9177898
	speed: 0.2842s/iter; left time: 5264.1252s
Epoch: 11 cost time: 60.61781024932861
Epoch: 11, Steps: 208 | Train Loss: 0.974 Vali Loss: 8.942 Vali Acc: 0.069 Test Loss: 8.942 Test Acc: 0.069
Validation loss decreased (-0.065826 --> -0.069102).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5737674
	speed: 0.7067s/iter; left time: 13012.6086s
	iters: 200, epoch: 12 | loss: 0.6404258
	speed: 0.2766s/iter; left time: 5065.5486s
Epoch: 12 cost time: 58.75749206542969
Epoch: 12, Steps: 208 | Train Loss: 0.865 Vali Loss: 9.121 Vali Acc: 0.078 Test Loss: 9.121 Test Acc: 0.078
Validation loss decreased (-0.069102 --> -0.077451).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3855744
	speed: 0.7037s/iter; left time: 12810.3803s
	iters: 200, epoch: 13 | loss: 1.4565077
	speed: 0.2931s/iter; left time: 5306.5969s
Epoch: 13 cost time: 60.89190697669983
Epoch: 13, Steps: 208 | Train Loss: 0.736 Vali Loss: 9.510 Vali Acc: 0.078 Test Loss: 9.510 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3299372
	speed: 0.7507s/iter; left time: 13510.4416s
	iters: 200, epoch: 14 | loss: 1.0413120
	speed: 0.3178s/iter; left time: 5687.1153s
Epoch: 14 cost time: 67.89108204841614
Epoch: 14, Steps: 208 | Train Loss: 0.654 Vali Loss: 9.821 Vali Acc: 0.072 Test Loss: 9.821 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8061428
	speed: 0.7233s/iter; left time: 12867.0016s
	iters: 200, epoch: 15 | loss: 0.4258253
	speed: 0.3094s/iter; left time: 5472.3864s
Epoch: 15 cost time: 64.88302063941956
Epoch: 15, Steps: 208 | Train Loss: 0.560 Vali Loss: 10.334 Vali Acc: 0.078 Test Loss: 10.334 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4524028
	speed: 0.7064s/iter; left time: 12419.7462s
	iters: 200, epoch: 16 | loss: 0.6403698
	speed: 0.2844s/iter; left time: 4970.8096s
Epoch: 16 cost time: 62.45673179626465
Epoch: 16, Steps: 208 | Train Loss: 0.529 Vali Loss: 10.526 Vali Acc: 0.078 Test Loss: 10.526 Test Acc: 0.078
Validation loss decreased (-0.077451 --> -0.077735).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6303250
	speed: 0.7132s/iter; left time: 12390.8010s
	iters: 200, epoch: 17 | loss: 0.2755015
	speed: 0.3062s/iter; left time: 5289.5125s
Epoch: 17 cost time: 65.02028584480286
Epoch: 17, Steps: 208 | Train Loss: 0.489 Vali Loss: 11.121 Vali Acc: 0.064 Test Loss: 11.121 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0244540
	speed: 0.7467s/iter; left time: 12816.3108s
	iters: 200, epoch: 18 | loss: 0.3567610
	speed: 0.3264s/iter; left time: 5569.8143s
Epoch: 18 cost time: 66.98535633087158
Epoch: 18, Steps: 208 | Train Loss: 0.433 Vali Loss: 10.784 Vali Acc: 0.070 Test Loss: 10.784 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0404941
	speed: 0.7461s/iter; left time: 12651.3017s
	iters: 200, epoch: 19 | loss: 0.1594350
	speed: 0.3009s/iter; left time: 5072.4308s
Epoch: 19 cost time: 63.71943545341492
Epoch: 19, Steps: 208 | Train Loss: 0.409 Vali Loss: 11.021 Vali Acc: 0.075 Test Loss: 11.021 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.4127774
	speed: 0.7274s/iter; left time: 12183.2371s
	iters: 200, epoch: 20 | loss: 0.1301967
	speed: 0.3087s/iter; left time: 5139.3173s
Epoch: 20 cost time: 64.164959192276
Epoch: 20, Steps: 208 | Train Loss: 0.382 Vali Loss: 11.267 Vali Acc: 0.073 Test Loss: 11.267 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1740762
	speed: 0.7345s/iter; left time: 12150.0015s
	iters: 200, epoch: 21 | loss: 0.3066044
	speed: 0.2959s/iter; left time: 4865.1761s
Epoch: 21 cost time: 64.94620156288147
Epoch: 21, Steps: 208 | Train Loss: 0.365 Vali Loss: 11.615 Vali Acc: 0.076 Test Loss: 11.615 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4252995
	speed: 0.7404s/iter; left time: 12092.2187s
	iters: 200, epoch: 22 | loss: 0.3007376
	speed: 0.3056s/iter; left time: 4960.9425s
Epoch: 22 cost time: 63.0732262134552
Epoch: 22, Steps: 208 | Train Loss: 0.312 Vali Loss: 11.394 Vali Acc: 0.080 Test Loss: 11.394 Test Acc: 0.080
Validation loss decreased (-0.077735 --> -0.079516).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.2613864
	speed: 0.7292s/iter; left time: 11757.8480s
	iters: 200, epoch: 23 | loss: 0.0398105
	speed: 0.2927s/iter; left time: 4690.2085s
Epoch: 23 cost time: 63.26392841339111
Epoch: 23, Steps: 208 | Train Loss: 0.282 Vali Loss: 11.683 Vali Acc: 0.078 Test Loss: 11.683 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.4886065
	speed: 0.7113s/iter; left time: 11321.2406s
	iters: 200, epoch: 24 | loss: 0.5055714
	speed: 0.2932s/iter; left time: 4637.8113s
Epoch: 24 cost time: 60.05169892311096
Epoch: 24, Steps: 208 | Train Loss: 0.309 Vali Loss: 11.953 Vali Acc: 0.085 Test Loss: 11.953 Test Acc: 0.085
Validation loss decreased (-0.079516 --> -0.085177).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6644667
	speed: 0.6999s/iter; left time: 10994.4300s
	iters: 200, epoch: 25 | loss: 0.6727532
	speed: 0.3090s/iter; left time: 4823.7554s
Epoch: 25 cost time: 63.94093656539917
Epoch: 25, Steps: 208 | Train Loss: 0.289 Vali Loss: 11.781 Vali Acc: 0.076 Test Loss: 11.781 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0597834
	speed: 0.7140s/iter; left time: 11067.9250s
	iters: 200, epoch: 26 | loss: 0.0972680
	speed: 0.3015s/iter; left time: 4644.1447s
Epoch: 26 cost time: 62.37425446510315
Epoch: 26, Steps: 208 | Train Loss: 0.257 Vali Loss: 12.388 Vali Acc: 0.083 Test Loss: 12.388 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1160472
	speed: 0.7242s/iter; left time: 11075.7541s
	iters: 200, epoch: 27 | loss: 0.2027656
	speed: 0.3030s/iter; left time: 4603.8137s
Epoch: 27 cost time: 62.97362685203552
Epoch: 27, Steps: 208 | Train Loss: 0.271 Vali Loss: 12.528 Vali Acc: 0.083 Test Loss: 12.528 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.2739489
	speed: 0.7469s/iter; left time: 11266.9132s
	iters: 200, epoch: 28 | loss: 0.3881085
	speed: 0.3039s/iter; left time: 4554.1198s
Epoch: 28 cost time: 65.08933162689209
Epoch: 28, Steps: 208 | Train Loss: 0.275 Vali Loss: 12.315 Vali Acc: 0.083 Test Loss: 12.315 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.2861607
	speed: 0.6924s/iter; left time: 10301.3857s
	iters: 200, epoch: 29 | loss: 0.3012077
	speed: 0.2912s/iter; left time: 4303.7938s
Epoch: 29 cost time: 59.89949822425842
Epoch: 29, Steps: 208 | Train Loss: 0.244 Vali Loss: 12.397 Vali Acc: 0.078 Test Loss: 12.397 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0501629
	speed: 0.7475s/iter; left time: 10965.6048s
	iters: 200, epoch: 30 | loss: 0.6303668
	speed: 0.2965s/iter; left time: 4319.9048s
Epoch: 30 cost time: 62.81575155258179
Epoch: 30, Steps: 208 | Train Loss: 0.242 Vali Loss: 12.214 Vali Acc: 0.088 Test Loss: 12.214 Test Acc: 0.088
Validation loss decreased (-0.085177 --> -0.088157).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0041641
	speed: 0.7173s/iter; left time: 10372.2376s
	iters: 200, epoch: 31 | loss: 0.0800328
	speed: 0.2954s/iter; left time: 4242.1765s
Epoch: 31 cost time: 61.506046295166016
Epoch: 31, Steps: 208 | Train Loss: 0.219 Vali Loss: 12.700 Vali Acc: 0.083 Test Loss: 12.700 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0228367
	speed: 0.7366s/iter; left time: 10498.5509s
	iters: 200, epoch: 32 | loss: 0.1941953
	speed: 0.3034s/iter; left time: 4293.5003s
Epoch: 32 cost time: 62.112565994262695
Epoch: 32, Steps: 208 | Train Loss: 0.225 Vali Loss: 12.941 Vali Acc: 0.091 Test Loss: 12.941 Test Acc: 0.091
Validation loss decreased (-0.088157 --> -0.090536).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.2594255
	speed: 0.7158s/iter; left time: 10053.2432s
	iters: 200, epoch: 33 | loss: 0.0303854
	speed: 0.2971s/iter; left time: 4142.6937s
Epoch: 33 cost time: 63.28670001029968
Epoch: 33, Steps: 208 | Train Loss: 0.246 Vali Loss: 12.959 Vali Acc: 0.079 Test Loss: 12.959 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.1490331
	speed: 0.7393s/iter; left time: 10229.4998s
	iters: 200, epoch: 34 | loss: 0.4131087
	speed: 0.2998s/iter; left time: 4118.3565s
Epoch: 34 cost time: 64.68118238449097
Epoch: 34, Steps: 208 | Train Loss: 0.209 Vali Loss: 13.587 Vali Acc: 0.077 Test Loss: 13.587 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.1095249
	speed: 0.7296s/iter; left time: 9943.5745s
	iters: 200, epoch: 35 | loss: 0.1232402
	speed: 0.3001s/iter; left time: 4059.6820s
Epoch: 35 cost time: 62.395753145217896
Epoch: 35, Steps: 208 | Train Loss: 0.211 Vali Loss: 13.164 Vali Acc: 0.089 Test Loss: 13.164 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.1418061
	speed: 0.7302s/iter; left time: 9800.1048s
	iters: 200, epoch: 36 | loss: 0.1888436
	speed: 0.3140s/iter; left time: 4182.3826s
Epoch: 36 cost time: 64.4385015964508
Epoch: 36, Steps: 208 | Train Loss: 0.206 Vali Loss: 12.899 Vali Acc: 0.084 Test Loss: 12.899 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.2805785
	speed: 0.7419s/iter; left time: 9802.5263s
	iters: 200, epoch: 37 | loss: 0.1968360
	speed: 0.3285s/iter; left time: 4307.2771s
Epoch: 37 cost time: 67.7552661895752
Epoch: 37, Steps: 208 | Train Loss: 0.203 Vali Loss: 13.475 Vali Acc: 0.083 Test Loss: 13.475 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.3389695
	speed: 0.7551s/iter; left time: 9820.4159s
	iters: 200, epoch: 38 | loss: 0.0058384
	speed: 0.2973s/iter; left time: 3836.5256s
Epoch: 38 cost time: 63.610538482666016
Epoch: 38, Steps: 208 | Train Loss: 0.183 Vali Loss: 12.907 Vali Acc: 0.092 Test Loss: 12.907 Test Acc: 0.092
Validation loss decreased (-0.090536 --> -0.092027).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.2106725
	speed: 0.7773s/iter; left time: 9947.1485s
	iters: 200, epoch: 39 | loss: 0.0342355
	speed: 0.3147s/iter; left time: 3996.3724s
Epoch: 39 cost time: 67.55320763587952
Epoch: 39, Steps: 208 | Train Loss: 0.183 Vali Loss: 13.603 Vali Acc: 0.091 Test Loss: 13.603 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.1424056
	speed: 0.7555s/iter; left time: 9511.0081s
	iters: 200, epoch: 40 | loss: 0.0244284
	speed: 0.3111s/iter; left time: 3885.2982s
Epoch: 40 cost time: 63.88792037963867
Epoch: 40, Steps: 208 | Train Loss: 0.175 Vali Loss: 13.551 Vali Acc: 0.092 Test Loss: 13.551 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0023669
	speed: 0.7508s/iter; left time: 9295.8484s
	iters: 200, epoch: 41 | loss: 0.0172253
	speed: 0.3241s/iter; left time: 3980.1801s
Epoch: 41 cost time: 66.5789213180542
Epoch: 41, Steps: 208 | Train Loss: 0.164 Vali Loss: 13.676 Vali Acc: 0.086 Test Loss: 13.676 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.1059867
	speed: 0.8172s/iter; left time: 9947.9030s
	iters: 200, epoch: 42 | loss: 0.0053379
	speed: 0.3013s/iter; left time: 3637.6675s
Epoch: 42 cost time: 67.30702590942383
Epoch: 42, Steps: 208 | Train Loss: 0.174 Vali Loss: 13.724 Vali Acc: 0.079 Test Loss: 13.724 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0334296
	speed: 0.7125s/iter; left time: 8524.8099s
	iters: 200, epoch: 43 | loss: 0.3026219
	speed: 0.3097s/iter; left time: 3674.8777s
Epoch: 43 cost time: 63.01272678375244
Epoch: 43, Steps: 208 | Train Loss: 0.157 Vali Loss: 13.980 Vali Acc: 0.077 Test Loss: 13.980 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.2846681
	speed: 0.7915s/iter; left time: 9305.9512s
	iters: 200, epoch: 44 | loss: 0.2458381
	speed: 0.3346s/iter; left time: 3900.1262s
Epoch: 44 cost time: 71.29816341400146
Epoch: 44, Steps: 208 | Train Loss: 0.162 Vali Loss: 13.238 Vali Acc: 0.083 Test Loss: 13.238 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0451104
	speed: 0.7976s/iter; left time: 9210.9727s
	iters: 200, epoch: 45 | loss: 0.1360283
	speed: 0.3033s/iter; left time: 3473.0198s
Epoch: 45 cost time: 65.84987807273865
Epoch: 45, Steps: 208 | Train Loss: 0.171 Vali Loss: 13.938 Vali Acc: 0.084 Test Loss: 13.938 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.0171764
	speed: 0.7769s/iter; left time: 8810.9587s
	iters: 200, epoch: 46 | loss: 0.0165917
	speed: 0.3233s/iter; left time: 3633.9598s
Epoch: 46 cost time: 67.1025984287262
Epoch: 46, Steps: 208 | Train Loss: 0.131 Vali Loss: 13.918 Vali Acc: 0.077 Test Loss: 13.918 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.2230768
	speed: 0.7551s/iter; left time: 8406.6742s
	iters: 200, epoch: 47 | loss: 0.0834715
	speed: 0.3278s/iter; left time: 3617.1020s
Epoch: 47 cost time: 68.21383619308472
Epoch: 47, Steps: 208 | Train Loss: 0.151 Vali Loss: 14.164 Vali Acc: 0.088 Test Loss: 14.164 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.3482312
	speed: 0.7064s/iter; left time: 7717.9189s
	iters: 200, epoch: 48 | loss: 0.0177679
	speed: 0.2937s/iter; left time: 3179.2284s
Epoch: 48 cost time: 60.939629316329956
Epoch: 48, Steps: 208 | Train Loss: 0.158 Vali Loss: 14.277 Vali Acc: 0.070 Test Loss: 14.277 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0921562779600358
model parameter : 1847463
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3910291
	speed: 0.3169s/iter; left time: 6561.0470s
	iters: 200, epoch: 1 | loss: 3.9059525
	speed: 0.2986s/iter; left time: 6150.6283s
Epoch: 1 cost time: 64.24564790725708
Epoch: 1, Steps: 208 | Train Loss: 3.639 Vali Loss: 3.554 Vali Acc: 0.078 Test Loss: 3.554 Test Acc: 0.078
Validation loss decreased (inf --> -0.077507).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2416074
	speed: 0.7025s/iter; left time: 14397.2716s
	iters: 200, epoch: 2 | loss: 3.0417182
	speed: 0.3042s/iter; left time: 6202.9674s
Epoch: 2 cost time: 62.88115215301514
Epoch: 2, Steps: 208 | Train Loss: 3.099 Vali Loss: 3.689 Vali Acc: 0.081 Test Loss: 3.689 Test Acc: 0.081
Validation loss decreased (-0.077507 --> -0.081383).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6072259
	speed: 0.6943s/iter; left time: 14083.0448s
	iters: 200, epoch: 3 | loss: 2.9635561
	speed: 0.2993s/iter; left time: 6041.1653s
Epoch: 3 cost time: 62.261343240737915
Epoch: 3, Steps: 208 | Train Loss: 2.514 Vali Loss: 3.855 Vali Acc: 0.093 Test Loss: 3.855 Test Acc: 0.093
Validation loss decreased (-0.081383 --> -0.093311).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8634696
	speed: 0.7312s/iter; left time: 14680.3332s
	iters: 200, epoch: 4 | loss: 2.0852439
	speed: 0.2890s/iter; left time: 5773.6059s
Epoch: 4 cost time: 63.01815915107727
Epoch: 4, Steps: 208 | Train Loss: 1.908 Vali Loss: 4.386 Vali Acc: 0.097 Test Loss: 4.386 Test Acc: 0.097
Validation loss decreased (-0.093311 --> -0.097183).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6946450
	speed: 0.6821s/iter; left time: 13552.7755s
	iters: 200, epoch: 5 | loss: 1.1542794
	speed: 0.3028s/iter; left time: 5985.9596s
Epoch: 5 cost time: 61.559545278549194
Epoch: 5, Steps: 208 | Train Loss: 1.392 Vali Loss: 5.125 Vali Acc: 0.106 Test Loss: 5.125 Test Acc: 0.106
Validation loss decreased (-0.097183 --> -0.106421).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0015131
	speed: 0.7369s/iter; left time: 14488.6162s
	iters: 200, epoch: 6 | loss: 1.2764091
	speed: 0.3362s/iter; left time: 6577.1968s
Epoch: 6 cost time: 68.59155941009521
Epoch: 6, Steps: 208 | Train Loss: 0.946 Vali Loss: 5.758 Vali Acc: 0.091 Test Loss: 5.758 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6189467
	speed: 0.7225s/iter; left time: 14055.3901s
	iters: 200, epoch: 7 | loss: 0.3217593
	speed: 0.3228s/iter; left time: 6247.6530s
Epoch: 7 cost time: 66.66852021217346
Epoch: 7, Steps: 208 | Train Loss: 0.740 Vali Loss: 6.499 Vali Acc: 0.097 Test Loss: 6.499 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5888303
	speed: 0.7592s/iter; left time: 14610.9520s
	iters: 200, epoch: 8 | loss: 0.5432337
	speed: 0.3375s/iter; left time: 6461.2923s
Epoch: 8 cost time: 69.92445707321167
Epoch: 8, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.617 Vali Acc: 0.095 Test Loss: 6.617 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1774186
	speed: 0.7377s/iter; left time: 14042.7759s
	iters: 200, epoch: 9 | loss: 1.5049492
	speed: 0.3212s/iter; left time: 6082.3959s
Epoch: 9 cost time: 66.3163378238678
Epoch: 9, Steps: 208 | Train Loss: 0.480 Vali Loss: 7.300 Vali Acc: 0.093 Test Loss: 7.300 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2894157
	speed: 0.7200s/iter; left time: 13557.1042s
	iters: 200, epoch: 10 | loss: 1.0272406
	speed: 0.3265s/iter; left time: 6115.8598s
Epoch: 10 cost time: 67.84938883781433
Epoch: 10, Steps: 208 | Train Loss: 0.394 Vali Loss: 7.779 Vali Acc: 0.087 Test Loss: 7.779 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1298245
	speed: 0.7738s/iter; left time: 14409.0350s
	iters: 200, epoch: 11 | loss: 0.3333250
	speed: 0.3085s/iter; left time: 5714.6011s
Epoch: 11 cost time: 68.22023224830627
Epoch: 11, Steps: 208 | Train Loss: 0.368 Vali Loss: 8.109 Vali Acc: 0.098 Test Loss: 8.109 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2369120
	speed: 0.7141s/iter; left time: 13148.2011s
	iters: 200, epoch: 12 | loss: 0.2147958
	speed: 0.2755s/iter; left time: 5044.6118s
Epoch: 12 cost time: 62.32471966743469
Epoch: 12, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.625 Vali Acc: 0.094 Test Loss: 8.625 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2863533
	speed: 0.6998s/iter; left time: 12739.8954s
	iters: 200, epoch: 13 | loss: 0.1163021
	speed: 0.2682s/iter; left time: 4855.7590s
Epoch: 13 cost time: 60.05338764190674
Epoch: 13, Steps: 208 | Train Loss: 0.239 Vali Loss: 8.944 Vali Acc: 0.092 Test Loss: 8.944 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0581230
	speed: 0.7318s/iter; left time: 13169.9325s
	iters: 200, epoch: 14 | loss: 0.1544759
	speed: 0.2839s/iter; left time: 5080.1528s
Epoch: 14 cost time: 61.64552187919617
Epoch: 14, Steps: 208 | Train Loss: 0.249 Vali Loss: 9.432 Vali Acc: 0.089 Test Loss: 9.432 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0217117
	speed: 0.6691s/iter; left time: 11902.7492s
	iters: 200, epoch: 15 | loss: 0.6120055
	speed: 0.2877s/iter; left time: 5089.8220s
Epoch: 15 cost time: 60.10713219642639
Epoch: 15, Steps: 208 | Train Loss: 0.211 Vali Loss: 9.607 Vali Acc: 0.091 Test Loss: 9.607 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10647181628392484
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4321673
	speed: 0.2994s/iter; left time: 6198.1457s
	iters: 200, epoch: 1 | loss: 3.9184775
	speed: 0.2764s/iter; left time: 5694.0066s
Epoch: 1 cost time: 60.2557590007782
Epoch: 1, Steps: 208 | Train Loss: 3.641 Vali Loss: 3.571 Vali Acc: 0.071 Test Loss: 3.571 Test Acc: 0.071
Validation loss decreased (inf --> -0.070647).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0807121
	speed: 0.6677s/iter; left time: 13683.1121s
	iters: 200, epoch: 2 | loss: 2.8794091
	speed: 0.2835s/iter; left time: 5781.0950s
Epoch: 2 cost time: 58.551262855529785
Epoch: 2, Steps: 208 | Train Loss: 3.094 Vali Loss: 3.781 Vali Acc: 0.087 Test Loss: 3.781 Test Acc: 0.087
Validation loss decreased (-0.070647 --> -0.086750).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3832316
	speed: 0.6772s/iter; left time: 13736.0419s
	iters: 200, epoch: 3 | loss: 2.9422472
	speed: 0.2707s/iter; left time: 5463.9416s
Epoch: 3 cost time: 57.3284227848053
Epoch: 3, Steps: 208 | Train Loss: 2.511 Vali Loss: 3.919 Vali Acc: 0.099 Test Loss: 3.919 Test Acc: 0.099
Validation loss decreased (-0.086750 --> -0.098678).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7660522
	speed: 0.6431s/iter; left time: 12910.6162s
	iters: 200, epoch: 4 | loss: 1.8803301
	speed: 0.2586s/iter; left time: 5166.3339s
Epoch: 4 cost time: 56.04646825790405
Epoch: 4, Steps: 208 | Train Loss: 1.926 Vali Loss: 4.461 Vali Acc: 0.094 Test Loss: 4.461 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0244840
	speed: 0.6765s/iter; left time: 13440.5911s
	iters: 200, epoch: 5 | loss: 1.1757869
	speed: 0.2857s/iter; left time: 5647.6003s
Epoch: 5 cost time: 60.482414960861206
Epoch: 5, Steps: 208 | Train Loss: 1.392 Vali Loss: 5.223 Vali Acc: 0.099 Test Loss: 5.223 Test Acc: 0.099
Validation loss decreased (-0.098678 --> -0.099262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9653317
	speed: 0.7304s/iter; left time: 14361.0660s
	iters: 200, epoch: 6 | loss: 0.7839376
	speed: 0.2934s/iter; left time: 5739.8485s
Epoch: 6 cost time: 61.94643712043762
Epoch: 6, Steps: 208 | Train Loss: 0.950 Vali Loss: 5.930 Vali Acc: 0.091 Test Loss: 5.930 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7593833
	speed: 0.6569s/iter; left time: 12778.8996s
	iters: 200, epoch: 7 | loss: 0.5698445
	speed: 0.2916s/iter; left time: 5642.9781s
Epoch: 7 cost time: 59.18938660621643
Epoch: 7, Steps: 208 | Train Loss: 0.733 Vali Loss: 6.450 Vali Acc: 0.095 Test Loss: 6.450 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9917991
	speed: 0.6451s/iter; left time: 12414.9428s
	iters: 200, epoch: 8 | loss: 0.6419225
	speed: 0.2749s/iter; left time: 5262.5082s
Epoch: 8 cost time: 57.88431906700134
Epoch: 8, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.848 Vali Acc: 0.100 Test Loss: 6.848 Test Acc: 0.100
Validation loss decreased (-0.099262 --> -0.099842).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0900530
	speed: 0.6978s/iter; left time: 13283.9608s
	iters: 200, epoch: 9 | loss: 1.4267703
	speed: 0.2851s/iter; left time: 5399.0224s
Epoch: 9 cost time: 62.39494347572327
Epoch: 9, Steps: 208 | Train Loss: 0.476 Vali Loss: 7.385 Vali Acc: 0.087 Test Loss: 7.385 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3281046
	speed: 0.7023s/iter; left time: 13224.3415s
	iters: 200, epoch: 10 | loss: 0.6625251
	speed: 0.3160s/iter; left time: 5917.4840s
Epoch: 10 cost time: 63.94563007354736
Epoch: 10, Steps: 208 | Train Loss: 0.380 Vali Loss: 8.363 Vali Acc: 0.091 Test Loss: 8.363 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1416998
	speed: 0.7492s/iter; left time: 13951.3470s
	iters: 200, epoch: 11 | loss: 0.6363362
	speed: 0.3245s/iter; left time: 6010.5495s
Epoch: 11 cost time: 67.0651319026947
Epoch: 11, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.184 Vali Acc: 0.091 Test Loss: 8.184 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.7388401
	speed: 0.6997s/iter; left time: 12883.2541s
	iters: 200, epoch: 12 | loss: 0.3030541
	speed: 0.2942s/iter; left time: 5387.6087s
Epoch: 12 cost time: 62.311402559280396
Epoch: 12, Steps: 208 | Train Loss: 0.282 Vali Loss: 8.817 Vali Acc: 0.097 Test Loss: 8.817 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0448922
	speed: 0.7078s/iter; left time: 12885.5223s
	iters: 200, epoch: 13 | loss: 0.2369646
	speed: 0.2815s/iter; left time: 5095.7896s
Epoch: 13 cost time: 60.09370946884155
Epoch: 13, Steps: 208 | Train Loss: 0.261 Vali Loss: 9.545 Vali Acc: 0.097 Test Loss: 9.545 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0854076
	speed: 0.6845s/iter; left time: 12319.1235s
	iters: 200, epoch: 14 | loss: 0.1803829
	speed: 0.2901s/iter; left time: 5191.5165s
Epoch: 14 cost time: 59.70823931694031
Epoch: 14, Steps: 208 | Train Loss: 0.270 Vali Loss: 9.199 Vali Acc: 0.089 Test Loss: 9.199 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1109237
	speed: 0.7012s/iter; left time: 12474.3290s
	iters: 200, epoch: 15 | loss: 0.3347426
	speed: 0.2925s/iter; left time: 5174.4830s
Epoch: 15 cost time: 60.649115562438965
Epoch: 15, Steps: 208 | Train Loss: 0.237 Vali Loss: 9.359 Vali Acc: 0.088 Test Loss: 9.359 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2341272
	speed: 0.6763s/iter; left time: 11889.7802s
	iters: 200, epoch: 16 | loss: 0.1426442
	speed: 0.2874s/iter; left time: 5024.3667s
Epoch: 16 cost time: 60.53102898597717
Epoch: 16, Steps: 208 | Train Loss: 0.212 Vali Loss: 10.034 Vali Acc: 0.080 Test Loss: 10.034 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2802116
	speed: 0.6882s/iter; left time: 11955.4372s
	iters: 200, epoch: 17 | loss: 0.0874545
	speed: 0.2654s/iter; left time: 4584.9748s
Epoch: 17 cost time: 58.82968068122864
Epoch: 17, Steps: 208 | Train Loss: 0.188 Vali Loss: 9.939 Vali Acc: 0.086 Test Loss: 9.939 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1264525
	speed: 0.6959s/iter; left time: 11944.7211s
	iters: 200, epoch: 18 | loss: 0.1270735
	speed: 0.2855s/iter; left time: 4871.6328s
Epoch: 18 cost time: 61.69946479797363
Epoch: 18, Steps: 208 | Train Loss: 0.172 Vali Loss: 10.571 Vali Acc: 0.090 Test Loss: 10.571 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09991052788547569
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4609447
	speed: 0.3131s/iter; left time: 6480.6420s
	iters: 200, epoch: 1 | loss: 3.8991706
	speed: 0.2847s/iter; left time: 5864.5374s
Epoch: 1 cost time: 62.275524377822876
Epoch: 1, Steps: 208 | Train Loss: 3.644 Vali Loss: 3.526 Vali Acc: 0.071 Test Loss: 3.526 Test Acc: 0.071
Validation loss decreased (inf --> -0.071244).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2697415
	speed: 0.6744s/iter; left time: 13820.5601s
	iters: 200, epoch: 2 | loss: 3.0624752
	speed: 0.2912s/iter; left time: 5937.6652s
Epoch: 2 cost time: 60.962186336517334
Epoch: 2, Steps: 208 | Train Loss: 3.105 Vali Loss: 3.719 Vali Acc: 0.081 Test Loss: 3.719 Test Acc: 0.081
Validation loss decreased (-0.071244 --> -0.080786).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4757500
	speed: 0.6770s/iter; left time: 13733.2827s
	iters: 200, epoch: 3 | loss: 3.2235794
	speed: 0.2874s/iter; left time: 5802.1237s
Epoch: 3 cost time: 59.459739208221436
Epoch: 3, Steps: 208 | Train Loss: 2.511 Vali Loss: 3.927 Vali Acc: 0.089 Test Loss: 3.927 Test Acc: 0.089
Validation loss decreased (-0.080786 --> -0.088836).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6984177
	speed: 0.6468s/iter; left time: 12986.0429s
	iters: 200, epoch: 4 | loss: 2.0050757
	speed: 0.2857s/iter; left time: 5706.8839s
Epoch: 4 cost time: 57.494486808776855
Epoch: 4, Steps: 208 | Train Loss: 1.942 Vali Loss: 4.367 Vali Acc: 0.099 Test Loss: 4.367 Test Acc: 0.099
Validation loss decreased (-0.088836 --> -0.098674).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9168330
	speed: 0.6478s/iter; left time: 12871.3384s
	iters: 200, epoch: 5 | loss: 1.9922560
	speed: 0.2757s/iter; left time: 5451.1820s
Epoch: 5 cost time: 57.90931510925293
Epoch: 5, Steps: 208 | Train Loss: 1.392 Vali Loss: 5.148 Vali Acc: 0.096 Test Loss: 5.148 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2864504
	speed: 0.6563s/iter; left time: 12903.9806s
	iters: 200, epoch: 6 | loss: 1.3981022
	speed: 0.2733s/iter; left time: 5346.6082s
Epoch: 6 cost time: 58.28243017196655
Epoch: 6, Steps: 208 | Train Loss: 0.985 Vali Loss: 5.706 Vali Acc: 0.089 Test Loss: 5.706 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8989338
	speed: 0.6364s/iter; left time: 12379.3132s
	iters: 200, epoch: 7 | loss: 0.3506973
	speed: 0.2825s/iter; left time: 5466.5176s
Epoch: 7 cost time: 58.67705726623535
Epoch: 7, Steps: 208 | Train Loss: 0.753 Vali Loss: 6.368 Vali Acc: 0.095 Test Loss: 6.368 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2146013
	speed: 0.6790s/iter; left time: 13068.0675s
	iters: 200, epoch: 8 | loss: 0.8666263
	speed: 0.2925s/iter; left time: 5600.2271s
Epoch: 8 cost time: 61.0718789100647
Epoch: 8, Steps: 208 | Train Loss: 0.594 Vali Loss: 6.716 Vali Acc: 0.093 Test Loss: 6.716 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9405479
	speed: 0.6674s/iter; left time: 12704.4957s
	iters: 200, epoch: 9 | loss: 1.2597470
	speed: 0.2696s/iter; left time: 5104.5735s
Epoch: 9 cost time: 58.197428703308105
Epoch: 9, Steps: 208 | Train Loss: 0.475 Vali Loss: 7.108 Vali Acc: 0.087 Test Loss: 7.108 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0707498
	speed: 0.6469s/iter; left time: 12180.0483s
	iters: 200, epoch: 10 | loss: 0.5650634
	speed: 0.2603s/iter; left time: 4875.3588s
Epoch: 10 cost time: 56.60467791557312
Epoch: 10, Steps: 208 | Train Loss: 0.403 Vali Loss: 7.979 Vali Acc: 0.094 Test Loss: 7.979 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3286037
	speed: 0.6576s/iter; left time: 12245.2390s
	iters: 200, epoch: 11 | loss: 0.2391006
	speed: 0.2750s/iter; left time: 5093.0318s
Epoch: 11 cost time: 57.36890625953674
Epoch: 11, Steps: 208 | Train Loss: 0.371 Vali Loss: 8.671 Vali Acc: 0.090 Test Loss: 8.671 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0134245
	speed: 0.6346s/iter; left time: 11684.6279s
	iters: 200, epoch: 12 | loss: 0.3825073
	speed: 0.2719s/iter; left time: 4979.3841s
Epoch: 12 cost time: 57.762916564941406
Epoch: 12, Steps: 208 | Train Loss: 0.286 Vali Loss: 9.307 Vali Acc: 0.083 Test Loss: 9.307 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0144599
	speed: 0.6264s/iter; left time: 11404.3777s
	iters: 200, epoch: 13 | loss: 0.4608758
	speed: 0.2784s/iter; left time: 5039.8788s
Epoch: 13 cost time: 55.60484290122986
Epoch: 13, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.011 Vali Acc: 0.083 Test Loss: 9.011 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0208652
	speed: 0.6235s/iter; left time: 11221.0738s
	iters: 200, epoch: 14 | loss: 1.1492110
	speed: 0.2648s/iter; left time: 4738.7259s
Epoch: 14 cost time: 56.79002618789673
Epoch: 14, Steps: 208 | Train Loss: 0.249 Vali Loss: 9.275 Vali Acc: 0.091 Test Loss: 9.275 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09871756635848494
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4692154
	speed: 0.3132s/iter; left time: 6483.0798s
	iters: 200, epoch: 1 | loss: 3.7214897
	speed: 0.2905s/iter; left time: 5984.5729s
Epoch: 1 cost time: 63.051127433776855
Epoch: 1, Steps: 208 | Train Loss: 3.652 Vali Loss: 3.534 Vali Acc: 0.077 Test Loss: 3.534 Test Acc: 0.077
Validation loss decreased (inf --> -0.076911).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2016478
	speed: 0.6666s/iter; left time: 13659.6142s
	iters: 200, epoch: 2 | loss: 3.1853628
	speed: 0.2908s/iter; left time: 5930.9136s
Epoch: 2 cost time: 60.374399185180664
Epoch: 2, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.683 Vali Acc: 0.087 Test Loss: 3.683 Test Acc: 0.087
Validation loss decreased (-0.076911 --> -0.086751).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3568053
	speed: 0.6868s/iter; left time: 13931.1170s
	iters: 200, epoch: 3 | loss: 3.2097697
	speed: 0.2923s/iter; left time: 5900.8067s
Epoch: 3 cost time: 60.63987135887146
Epoch: 3, Steps: 208 | Train Loss: 2.507 Vali Loss: 3.757 Vali Acc: 0.098 Test Loss: 3.757 Test Acc: 0.098
Validation loss decreased (-0.086751 --> -0.097785).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1609893
	speed: 0.6817s/iter; left time: 13686.3468s
	iters: 200, epoch: 4 | loss: 1.9631402
	speed: 0.2746s/iter; left time: 5485.1919s
Epoch: 4 cost time: 60.09879922866821
Epoch: 4, Steps: 208 | Train Loss: 1.901 Vali Loss: 4.309 Vali Acc: 0.097 Test Loss: 4.309 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0768676
	speed: 0.6865s/iter; left time: 13639.3671s
	iters: 200, epoch: 5 | loss: 1.7837830
	speed: 0.3048s/iter; left time: 6026.3350s
Epoch: 5 cost time: 63.751689195632935
Epoch: 5, Steps: 208 | Train Loss: 1.337 Vali Loss: 5.099 Vali Acc: 0.109 Test Loss: 5.099 Test Acc: 0.109
Validation loss decreased (-0.097785 --> -0.108509).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0429330
	speed: 0.6987s/iter; left time: 13737.4948s
	iters: 200, epoch: 6 | loss: 1.1378924
	speed: 0.2887s/iter; left time: 5647.7246s
Epoch: 6 cost time: 62.818296670913696
Epoch: 6, Steps: 208 | Train Loss: 0.970 Vali Loss: 5.725 Vali Acc: 0.101 Test Loss: 5.725 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5278758
	speed: 0.6537s/iter; left time: 12715.9288s
	iters: 200, epoch: 7 | loss: 0.2841536
	speed: 0.2886s/iter; left time: 5585.2785s
Epoch: 7 cost time: 59.07715845108032
Epoch: 7, Steps: 208 | Train Loss: 0.734 Vali Loss: 6.308 Vali Acc: 0.092 Test Loss: 6.308 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0065303
	speed: 0.6482s/iter; left time: 12475.3725s
	iters: 200, epoch: 8 | loss: 0.4630094
	speed: 0.2820s/iter; left time: 5398.4564s
Epoch: 8 cost time: 58.26260042190552
Epoch: 8, Steps: 208 | Train Loss: 0.596 Vali Loss: 6.827 Vali Acc: 0.089 Test Loss: 6.827 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.9009001
	speed: 0.6654s/iter; left time: 12666.6627s
	iters: 200, epoch: 9 | loss: 0.8246987
	speed: 0.2702s/iter; left time: 5116.3456s
Epoch: 9 cost time: 58.12314295768738
Epoch: 9, Steps: 208 | Train Loss: 0.513 Vali Loss: 7.192 Vali Acc: 0.094 Test Loss: 7.192 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6073312
	speed: 0.6875s/iter; left time: 12944.7427s
	iters: 200, epoch: 10 | loss: 0.8793145
	speed: 0.2969s/iter; left time: 5560.8811s
Epoch: 10 cost time: 62.04792642593384
Epoch: 10, Steps: 208 | Train Loss: 0.408 Vali Loss: 7.576 Vali Acc: 0.091 Test Loss: 7.576 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7646827
	speed: 0.7056s/iter; left time: 13138.1650s
	iters: 200, epoch: 11 | loss: 0.2853882
	speed: 0.2966s/iter; left time: 5492.7687s
Epoch: 11 cost time: 62.93339395523071
Epoch: 11, Steps: 208 | Train Loss: 0.359 Vali Loss: 8.319 Vali Acc: 0.094 Test Loss: 8.319 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0128308
	speed: 0.6805s/iter; left time: 12529.9960s
	iters: 200, epoch: 12 | loss: 0.2804929
	speed: 0.2807s/iter; left time: 5140.3044s
Epoch: 12 cost time: 60.012577056884766
Epoch: 12, Steps: 208 | Train Loss: 0.311 Vali Loss: 9.014 Vali Acc: 0.088 Test Loss: 9.014 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2561618
	speed: 0.6805s/iter; left time: 12388.3847s
	iters: 200, epoch: 13 | loss: 0.1131019
	speed: 0.2747s/iter; left time: 4973.7717s
Epoch: 13 cost time: 59.64033007621765
Epoch: 13, Steps: 208 | Train Loss: 0.258 Vali Loss: 8.749 Vali Acc: 0.095 Test Loss: 8.749 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0282256
	speed: 0.6737s/iter; left time: 12125.2812s
	iters: 200, epoch: 14 | loss: 0.2015617
	speed: 0.2911s/iter; left time: 5209.9783s
Epoch: 14 cost time: 61.28616666793823
Epoch: 14, Steps: 208 | Train Loss: 0.237 Vali Loss: 9.183 Vali Acc: 0.088 Test Loss: 9.183 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.5932311
	speed: 0.6631s/iter; left time: 11796.2632s
	iters: 200, epoch: 15 | loss: 1.1526660
	speed: 0.2837s/iter; left time: 5017.7786s
Epoch: 15 cost time: 58.906805992126465
Epoch: 15, Steps: 208 | Train Loss: 0.223 Vali Loss: 9.422 Vali Acc: 0.091 Test Loss: 9.422 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10855949895615867
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4223969
	speed: 0.3113s/iter; left time: 6443.7676s
	iters: 200, epoch: 1 | loss: 3.7794459
	speed: 0.3067s/iter; left time: 6319.1595s
Epoch: 1 cost time: 64.34122109413147
Epoch: 1, Steps: 208 | Train Loss: 3.627 Vali Loss: 3.510 Vali Acc: 0.076 Test Loss: 3.510 Test Acc: 0.076
Validation loss decreased (inf --> -0.075718).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0904412
	speed: 0.6880s/iter; left time: 14098.4714s
	iters: 200, epoch: 2 | loss: 2.9161568
	speed: 0.3087s/iter; left time: 6296.1346s
Epoch: 2 cost time: 62.436482667922974
Epoch: 2, Steps: 208 | Train Loss: 3.118 Vali Loss: 3.743 Vali Acc: 0.084 Test Loss: 3.743 Test Acc: 0.084
Validation loss decreased (-0.075718 --> -0.084365).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2734416
	speed: 0.6831s/iter; left time: 13856.1147s
	iters: 200, epoch: 3 | loss: 3.1224186
	speed: 0.2664s/iter; left time: 5376.2842s
Epoch: 3 cost time: 57.05502390861511
Epoch: 3, Steps: 208 | Train Loss: 2.563 Vali Loss: 3.892 Vali Acc: 0.090 Test Loss: 3.892 Test Acc: 0.090
Validation loss decreased (-0.084365 --> -0.090328).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0672524
	speed: 0.6641s/iter; left time: 13333.9223s
	iters: 200, epoch: 4 | loss: 1.7200429
	speed: 0.2843s/iter; left time: 5679.8461s
Epoch: 4 cost time: 58.65152955055237
Epoch: 4, Steps: 208 | Train Loss: 1.982 Vali Loss: 4.487 Vali Acc: 0.082 Test Loss: 4.487 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0362304
	speed: 0.6848s/iter; left time: 13606.1891s
	iters: 200, epoch: 5 | loss: 1.6304859
	speed: 0.3016s/iter; left time: 5961.9184s
Epoch: 5 cost time: 61.53733682632446
Epoch: 5, Steps: 208 | Train Loss: 1.407 Vali Loss: 4.828 Vali Acc: 0.105 Test Loss: 4.828 Test Acc: 0.105
Validation loss decreased (-0.090328 --> -0.105231).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2450858
	speed: 0.7042s/iter; left time: 13844.9604s
	iters: 200, epoch: 6 | loss: 1.4255109
	speed: 0.2948s/iter; left time: 5767.2519s
Epoch: 6 cost time: 61.64874243736267
Epoch: 6, Steps: 208 | Train Loss: 1.013 Vali Loss: 5.569 Vali Acc: 0.100 Test Loss: 5.569 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8080121
	speed: 0.6693s/iter; left time: 13019.0503s
	iters: 200, epoch: 7 | loss: 0.4405144
	speed: 0.2932s/iter; left time: 5674.3090s
Epoch: 7 cost time: 61.25586938858032
Epoch: 7, Steps: 208 | Train Loss: 0.759 Vali Loss: 6.093 Vali Acc: 0.096 Test Loss: 6.093 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2652264
	speed: 0.6497s/iter; left time: 12503.3298s
	iters: 200, epoch: 8 | loss: 0.7044311
	speed: 0.2854s/iter; left time: 5463.2172s
Epoch: 8 cost time: 60.11942100524902
Epoch: 8, Steps: 208 | Train Loss: 0.618 Vali Loss: 6.558 Vali Acc: 0.105 Test Loss: 6.558 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1458933
	speed: 0.6456s/iter; left time: 12290.4569s
	iters: 200, epoch: 9 | loss: 0.7647710
	speed: 0.2873s/iter; left time: 5441.3588s
Epoch: 9 cost time: 59.73393964767456
Epoch: 9, Steps: 208 | Train Loss: 0.520 Vali Loss: 6.872 Vali Acc: 0.095 Test Loss: 6.872 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6986055
	speed: 0.6654s/iter; left time: 12529.5145s
	iters: 200, epoch: 10 | loss: 0.4304278
	speed: 0.2841s/iter; left time: 5321.7960s
Epoch: 10 cost time: 60.155720949172974
Epoch: 10, Steps: 208 | Train Loss: 0.412 Vali Loss: 7.542 Vali Acc: 0.091 Test Loss: 7.542 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2637175
	speed: 0.6308s/iter; left time: 11745.2137s
	iters: 200, epoch: 11 | loss: 0.6179893
	speed: 0.2780s/iter; left time: 5148.2415s
Epoch: 11 cost time: 57.71912670135498
Epoch: 11, Steps: 208 | Train Loss: 0.373 Vali Loss: 8.112 Vali Acc: 0.100 Test Loss: 8.112 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3445334
	speed: 0.6569s/iter; left time: 12095.6193s
	iters: 200, epoch: 12 | loss: 0.4356509
	speed: 0.2823s/iter; left time: 5170.1092s
Epoch: 12 cost time: 59.139273166656494
Epoch: 12, Steps: 208 | Train Loss: 0.351 Vali Loss: 8.289 Vali Acc: 0.095 Test Loss: 8.289 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0803522
	speed: 0.6510s/iter; left time: 11851.0597s
	iters: 200, epoch: 13 | loss: 0.1579371
	speed: 0.2874s/iter; left time: 5202.7989s
Epoch: 13 cost time: 59.98998975753784
Epoch: 13, Steps: 208 | Train Loss: 0.290 Vali Loss: 8.695 Vali Acc: 0.093 Test Loss: 8.695 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3641511
	speed: 0.6765s/iter; left time: 12174.1730s
	iters: 200, epoch: 14 | loss: 0.3362161
	speed: 0.2797s/iter; left time: 5006.0313s
Epoch: 14 cost time: 59.833826780319214
Epoch: 14, Steps: 208 | Train Loss: 0.269 Vali Loss: 8.922 Vali Acc: 0.097 Test Loss: 8.922 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3031662
	speed: 0.6599s/iter; left time: 11738.0797s
	iters: 200, epoch: 15 | loss: 0.8963894
	speed: 0.2674s/iter; left time: 4730.4352s
Epoch: 15 cost time: 58.19848155975342
Epoch: 15, Steps: 208 | Train Loss: 0.224 Vali Loss: 9.137 Vali Acc: 0.095 Test Loss: 9.137 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10527885475693409
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2620943
	speed: 0.2986s/iter; left time: 6181.9701s
	iters: 200, epoch: 1 | loss: 3.9706790
	speed: 0.2898s/iter; left time: 5970.3100s
Epoch: 1 cost time: 61.665507793426514
Epoch: 1, Steps: 208 | Train Loss: 3.586 Vali Loss: 3.518 Vali Acc: 0.073 Test Loss: 3.518 Test Acc: 0.073
Validation loss decreased (inf --> -0.073332).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1358359
	speed: 0.6961s/iter; left time: 14264.7883s
	iters: 200, epoch: 2 | loss: 2.9314303
	speed: 0.2916s/iter; left time: 5947.4310s
Epoch: 2 cost time: 61.10154175758362
Epoch: 2, Steps: 208 | Train Loss: 3.047 Vali Loss: 3.709 Vali Acc: 0.096 Test Loss: 3.709 Test Acc: 0.096
Validation loss decreased (-0.073332 --> -0.095996).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0306597
	speed: 0.6585s/iter; left time: 13357.9532s
	iters: 200, epoch: 3 | loss: 2.7216496
	speed: 0.2848s/iter; left time: 5748.6039s
Epoch: 3 cost time: 58.37240672111511
Epoch: 3, Steps: 208 | Train Loss: 2.587 Vali Loss: 3.912 Vali Acc: 0.093 Test Loss: 3.912 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1439970
	speed: 0.6662s/iter; left time: 13374.6614s
	iters: 200, epoch: 4 | loss: 2.0243797
	speed: 0.2917s/iter; left time: 5827.4160s
Epoch: 4 cost time: 60.181432247161865
Epoch: 4, Steps: 208 | Train Loss: 2.043 Vali Loss: 4.583 Vali Acc: 0.098 Test Loss: 4.583 Test Acc: 0.098
Validation loss decreased (-0.095996 --> -0.098075).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2885218
	speed: 0.6896s/iter; left time: 13702.5243s
	iters: 200, epoch: 5 | loss: 1.8840781
	speed: 0.2970s/iter; left time: 5870.4624s
Epoch: 5 cost time: 61.642080307006836
Epoch: 5, Steps: 208 | Train Loss: 1.564 Vali Loss: 4.917 Vali Acc: 0.107 Test Loss: 4.917 Test Acc: 0.107
Validation loss decreased (-0.098075 --> -0.107019).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1726536
	speed: 0.6863s/iter; left time: 13492.4094s
	iters: 200, epoch: 6 | loss: 1.4786474
	speed: 0.3115s/iter; left time: 6092.6545s
Epoch: 6 cost time: 63.60520100593567
Epoch: 6, Steps: 208 | Train Loss: 1.179 Vali Loss: 5.486 Vali Acc: 0.095 Test Loss: 5.486 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7414787
	speed: 0.6703s/iter; left time: 13039.8091s
	iters: 200, epoch: 7 | loss: 0.4358935
	speed: 0.3001s/iter; left time: 5807.7314s
Epoch: 7 cost time: 61.88356828689575
Epoch: 7, Steps: 208 | Train Loss: 1.001 Vali Loss: 5.778 Vali Acc: 0.095 Test Loss: 5.778 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5886875
	speed: 0.6675s/iter; left time: 12846.8642s
	iters: 200, epoch: 8 | loss: 0.9154687
	speed: 0.3072s/iter; left time: 5881.0351s
Epoch: 8 cost time: 62.92232275009155
Epoch: 8, Steps: 208 | Train Loss: 0.770 Vali Loss: 6.404 Vali Acc: 0.095 Test Loss: 6.404 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0056860
	speed: 0.7116s/iter; left time: 13546.2804s
	iters: 200, epoch: 9 | loss: 1.3534708
	speed: 0.3113s/iter; left time: 5895.4591s
Epoch: 9 cost time: 64.6929759979248
Epoch: 9, Steps: 208 | Train Loss: 0.657 Vali Loss: 6.643 Vali Acc: 0.106 Test Loss: 6.643 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.7018914
	speed: 0.6953s/iter; left time: 13091.1008s
	iters: 200, epoch: 10 | loss: 0.8310571
	speed: 0.2913s/iter; left time: 5455.4432s
Epoch: 10 cost time: 61.39216470718384
Epoch: 10, Steps: 208 | Train Loss: 0.584 Vali Loss: 6.725 Vali Acc: 0.112 Test Loss: 6.725 Test Acc: 0.112
Validation loss decreased (-0.107019 --> -0.112071).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1436059
	speed: 0.6574s/iter; left time: 12241.9624s
	iters: 200, epoch: 11 | loss: 0.6256316
	speed: 0.3069s/iter; left time: 5683.7846s
Epoch: 11 cost time: 60.94312930107117
Epoch: 11, Steps: 208 | Train Loss: 0.526 Vali Loss: 7.582 Vali Acc: 0.097 Test Loss: 7.582 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6515887
	speed: 0.6798s/iter; left time: 12518.0682s
	iters: 200, epoch: 12 | loss: 0.5354222
	speed: 0.2981s/iter; left time: 5459.9453s
Epoch: 12 cost time: 63.10344052314758
Epoch: 12, Steps: 208 | Train Loss: 0.459 Vali Loss: 7.809 Vali Acc: 0.101 Test Loss: 7.809 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4824697
	speed: 0.6940s/iter; left time: 12634.3010s
	iters: 200, epoch: 13 | loss: 0.3591583
	speed: 0.2926s/iter; left time: 5298.3906s
Epoch: 13 cost time: 61.504096269607544
Epoch: 13, Steps: 208 | Train Loss: 0.394 Vali Loss: 7.972 Vali Acc: 0.099 Test Loss: 7.972 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9420773
	speed: 0.6961s/iter; left time: 12526.9064s
	iters: 200, epoch: 14 | loss: 0.9235801
	speed: 0.3054s/iter; left time: 5465.4593s
Epoch: 14 cost time: 62.72199320793152
Epoch: 14, Steps: 208 | Train Loss: 0.360 Vali Loss: 8.275 Vali Acc: 0.095 Test Loss: 8.275 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7786595
	speed: 0.6671s/iter; left time: 11866.2276s
	iters: 200, epoch: 15 | loss: 0.4315639
	speed: 0.3002s/iter; left time: 5310.3173s
Epoch: 15 cost time: 62.669310569763184
Epoch: 15, Steps: 208 | Train Loss: 0.345 Vali Loss: 8.729 Vali Acc: 0.103 Test Loss: 8.729 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.2000974
	speed: 0.6993s/iter; left time: 12294.5405s
	iters: 200, epoch: 16 | loss: 0.4726347
	speed: 0.2826s/iter; left time: 4940.4405s
Epoch: 16 cost time: 61.18735361099243
Epoch: 16, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.257 Vali Acc: 0.099 Test Loss: 9.257 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.3968808
	speed: 0.6796s/iter; left time: 11805.8330s
	iters: 200, epoch: 17 | loss: 0.1689076
	speed: 0.2923s/iter; left time: 5049.5557s
Epoch: 17 cost time: 60.799965143203735
Epoch: 17, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.194 Vali Acc: 0.107 Test Loss: 9.194 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3486245
	speed: 0.6651s/iter; left time: 11416.6034s
	iters: 200, epoch: 18 | loss: 0.3001166
	speed: 0.3023s/iter; left time: 5158.5241s
Epoch: 18 cost time: 61.872546911239624
Epoch: 18, Steps: 208 | Train Loss: 0.251 Vali Loss: 9.435 Vali Acc: 0.098 Test Loss: 9.435 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2480608
	speed: 0.7120s/iter; left time: 12072.7084s
	iters: 200, epoch: 19 | loss: 0.0949408
	speed: 0.2940s/iter; left time: 4956.4084s
Epoch: 19 cost time: 64.10230588912964
Epoch: 19, Steps: 208 | Train Loss: 0.213 Vali Loss: 9.515 Vali Acc: 0.102 Test Loss: 9.515 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1351699
	speed: 0.6863s/iter; left time: 11494.0927s
	iters: 200, epoch: 20 | loss: 0.0642620
	speed: 0.3036s/iter; left time: 5054.0906s
Epoch: 20 cost time: 61.37180161476135
Epoch: 20, Steps: 208 | Train Loss: 0.204 Vali Loss: 9.643 Vali Acc: 0.098 Test Loss: 9.643 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11213838353713093
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2411532
	speed: 0.2956s/iter; left time: 6118.7921s
	iters: 200, epoch: 1 | loss: 3.8418970
	speed: 0.2649s/iter; left time: 5457.2289s
Epoch: 1 cost time: 58.408796548843384
Epoch: 1, Steps: 208 | Train Loss: 3.591 Vali Loss: 3.655 Vali Acc: 0.074 Test Loss: 3.655 Test Acc: 0.074
Validation loss decreased (inf --> -0.073629).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1447976
	speed: 0.6629s/iter; left time: 13583.9588s
	iters: 200, epoch: 2 | loss: 2.9213948
	speed: 0.2810s/iter; left time: 5730.2750s
Epoch: 2 cost time: 59.44064211845398
Epoch: 2, Steps: 208 | Train Loss: 3.155 Vali Loss: 4.035 Vali Acc: 0.076 Test Loss: 4.035 Test Acc: 0.076
Validation loss decreased (-0.073629 --> -0.075713).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5938690
	speed: 0.6767s/iter; left time: 13726.4721s
	iters: 200, epoch: 3 | loss: 2.9169405
	speed: 0.2745s/iter; left time: 5540.7839s
Epoch: 3 cost time: 58.38027501106262
Epoch: 3, Steps: 208 | Train Loss: 2.812 Vali Loss: 4.047 Vali Acc: 0.072 Test Loss: 4.047 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3553076
	speed: 0.6348s/iter; left time: 12744.5063s
	iters: 200, epoch: 4 | loss: 2.4350538
	speed: 0.2793s/iter; left time: 5578.8097s
Epoch: 4 cost time: 57.321579694747925
Epoch: 4, Steps: 208 | Train Loss: 2.413 Vali Loss: 4.376 Vali Acc: 0.074 Test Loss: 4.376 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7342911
	speed: 0.6488s/iter; left time: 12891.9877s
	iters: 200, epoch: 5 | loss: 2.1805232
	speed: 0.2751s/iter; left time: 5438.3430s
Epoch: 5 cost time: 58.412601947784424
Epoch: 5, Steps: 208 | Train Loss: 2.032 Vali Loss: 4.592 Vali Acc: 0.090 Test Loss: 4.592 Test Acc: 0.090
Validation loss decreased (-0.075713 --> -0.090023).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8872805
	speed: 0.6615s/iter; left time: 13006.1746s
	iters: 200, epoch: 6 | loss: 1.9847332
	speed: 0.2900s/iter; left time: 5672.2408s
Epoch: 6 cost time: 60.22790026664734
Epoch: 6, Steps: 208 | Train Loss: 1.576 Vali Loss: 5.109 Vali Acc: 0.089 Test Loss: 5.109 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0098008
	speed: 0.6744s/iter; left time: 13119.9144s
	iters: 200, epoch: 7 | loss: 1.3354391
	speed: 0.2712s/iter; left time: 5248.6692s
Epoch: 7 cost time: 57.925894021987915
Epoch: 7, Steps: 208 | Train Loss: 1.300 Vali Loss: 5.442 Vali Acc: 0.089 Test Loss: 5.442 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3458341
	speed: 0.6829s/iter; left time: 13142.2910s
	iters: 200, epoch: 8 | loss: 1.4803518
	speed: 0.2819s/iter; left time: 5396.7896s
Epoch: 8 cost time: 59.363563776016235
Epoch: 8, Steps: 208 | Train Loss: 1.033 Vali Loss: 5.861 Vali Acc: 0.089 Test Loss: 5.861 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6180453
	speed: 0.6399s/iter; left time: 12181.7794s
	iters: 200, epoch: 9 | loss: 2.0156786
	speed: 0.2749s/iter; left time: 5205.7124s
Epoch: 9 cost time: 58.16138029098511
Epoch: 9, Steps: 208 | Train Loss: 0.871 Vali Loss: 6.136 Vali Acc: 0.085 Test Loss: 6.136 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5854812
	speed: 0.6892s/iter; left time: 12977.4128s
	iters: 200, epoch: 10 | loss: 1.4157345
	speed: 0.2956s/iter; left time: 5537.1402s
Epoch: 10 cost time: 60.89747714996338
Epoch: 10, Steps: 208 | Train Loss: 0.769 Vali Loss: 6.472 Vali Acc: 0.093 Test Loss: 6.472 Test Acc: 0.093
Validation loss decreased (-0.090023 --> -0.092688).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3058480
	speed: 0.6739s/iter; left time: 12548.5245s
	iters: 200, epoch: 11 | loss: 0.6234733
	speed: 0.2942s/iter; left time: 5447.9983s
Epoch: 11 cost time: 61.66025114059448
Epoch: 11, Steps: 208 | Train Loss: 0.633 Vali Loss: 6.731 Vali Acc: 0.096 Test Loss: 6.731 Test Acc: 0.096
Validation loss decreased (-0.092688 --> -0.095966).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4778066
	speed: 0.6808s/iter; left time: 12535.3293s
	iters: 200, epoch: 12 | loss: 0.5953229
	speed: 0.2988s/iter; left time: 5472.6831s
Epoch: 12 cost time: 61.622151136398315
Epoch: 12, Steps: 208 | Train Loss: 0.574 Vali Loss: 7.102 Vali Acc: 0.102 Test Loss: 7.102 Test Acc: 0.102
Validation loss decreased (-0.095966 --> -0.101629).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3472921
	speed: 0.7259s/iter; left time: 13215.2370s
	iters: 200, epoch: 13 | loss: 0.4041005
	speed: 0.3340s/iter; left time: 6046.2737s
Epoch: 13 cost time: 67.42708158493042
Epoch: 13, Steps: 208 | Train Loss: 0.511 Vali Loss: 7.292 Vali Acc: 0.094 Test Loss: 7.292 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4577264
	speed: 0.6467s/iter; left time: 11638.8951s
	iters: 200, epoch: 14 | loss: 1.2493708
	speed: 0.2733s/iter; left time: 4890.4006s
Epoch: 14 cost time: 57.47538375854492
Epoch: 14, Steps: 208 | Train Loss: 0.450 Vali Loss: 7.577 Vali Acc: 0.103 Test Loss: 7.577 Test Acc: 0.103
Validation loss decreased (-0.101629 --> -0.102519).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5747700
	speed: 0.6647s/iter; left time: 11824.6757s
	iters: 200, epoch: 15 | loss: 0.8344138
	speed: 0.2850s/iter; left time: 5041.1275s
Epoch: 15 cost time: 58.09396290779114
Epoch: 15, Steps: 208 | Train Loss: 0.408 Vali Loss: 7.813 Vali Acc: 0.095 Test Loss: 7.813 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2729801
	speed: 0.6902s/iter; left time: 12133.8902s
	iters: 200, epoch: 16 | loss: 0.7256899
	speed: 0.2902s/iter; left time: 5073.1547s
Epoch: 16 cost time: 63.57315444946289
Epoch: 16, Steps: 208 | Train Loss: 0.372 Vali Loss: 8.320 Vali Acc: 0.098 Test Loss: 8.320 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2222602
	speed: 0.6722s/iter; left time: 11678.1370s
	iters: 200, epoch: 17 | loss: 0.3819788
	speed: 0.2705s/iter; left time: 4672.9169s
Epoch: 17 cost time: 57.13739037513733
Epoch: 17, Steps: 208 | Train Loss: 0.307 Vali Loss: 8.539 Vali Acc: 0.088 Test Loss: 8.539 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1757199
	speed: 0.6646s/iter; left time: 11407.5040s
	iters: 200, epoch: 18 | loss: 0.0317004
	speed: 0.2787s/iter; left time: 4755.5006s
Epoch: 18 cost time: 59.55027174949646
Epoch: 18, Steps: 208 | Train Loss: 0.282 Vali Loss: 8.369 Vali Acc: 0.100 Test Loss: 8.369 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3636061
	speed: 0.7128s/iter; left time: 12087.4704s
	iters: 200, epoch: 19 | loss: 0.2004486
	speed: 0.2921s/iter; left time: 4923.7139s
Epoch: 19 cost time: 60.97059202194214
Epoch: 19, Steps: 208 | Train Loss: 0.244 Vali Loss: 8.458 Vali Acc: 0.093 Test Loss: 8.458 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1988930
	speed: 0.6978s/iter; left time: 11687.4777s
	iters: 200, epoch: 20 | loss: 0.0555760
	speed: 0.2803s/iter; left time: 4666.2353s
Epoch: 20 cost time: 61.54522657394409
Epoch: 20, Steps: 208 | Train Loss: 0.241 Vali Loss: 8.864 Vali Acc: 0.104 Test Loss: 8.864 Test Acc: 0.104
Validation loss decreased (-0.102519 --> -0.103699).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1882706
	speed: 0.6746s/iter; left time: 11158.3128s
	iters: 200, epoch: 21 | loss: 0.0667678
	speed: 0.2888s/iter; left time: 4748.2017s
Epoch: 21 cost time: 59.687058448791504
Epoch: 21, Steps: 208 | Train Loss: 0.234 Vali Loss: 9.004 Vali Acc: 0.099 Test Loss: 9.004 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0608320
	speed: 0.6884s/iter; left time: 11244.2284s
	iters: 200, epoch: 22 | loss: 0.2272295
	speed: 0.2773s/iter; left time: 4501.8371s
Epoch: 22 cost time: 59.8494176864624
Epoch: 22, Steps: 208 | Train Loss: 0.198 Vali Loss: 9.457 Vali Acc: 0.103 Test Loss: 9.457 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5052186
	speed: 0.6922s/iter; left time: 11162.3572s
	iters: 200, epoch: 23 | loss: 0.3896416
	speed: 0.2901s/iter; left time: 4648.7262s
Epoch: 23 cost time: 62.19474124908447
Epoch: 23, Steps: 208 | Train Loss: 0.184 Vali Loss: 9.433 Vali Acc: 0.096 Test Loss: 9.433 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0411805
	speed: 0.7203s/iter; left time: 11465.6585s
	iters: 200, epoch: 24 | loss: 0.2976049
	speed: 0.2720s/iter; left time: 4302.1528s
Epoch: 24 cost time: 60.050283670425415
Epoch: 24, Steps: 208 | Train Loss: 0.188 Vali Loss: 9.971 Vali Acc: 0.094 Test Loss: 9.971 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.3507739
	speed: 0.6770s/iter; left time: 10635.2598s
	iters: 200, epoch: 25 | loss: 0.1085192
	speed: 0.2986s/iter; left time: 4660.5461s
Epoch: 25 cost time: 61.654093980789185
Epoch: 25, Steps: 208 | Train Loss: 0.166 Vali Loss: 10.064 Vali Acc: 0.085 Test Loss: 10.064 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0314706
	speed: 0.6915s/iter; left time: 10718.9900s
	iters: 200, epoch: 26 | loss: 1.0228705
	speed: 0.3037s/iter; left time: 4677.2715s
Epoch: 26 cost time: 64.51299834251404
Epoch: 26, Steps: 208 | Train Loss: 0.188 Vali Loss: 9.779 Vali Acc: 0.092 Test Loss: 9.779 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0153398
	speed: 0.7077s/iter; left time: 10822.7540s
	iters: 200, epoch: 27 | loss: 0.3138859
	speed: 0.2850s/iter; left time: 4329.7225s
Epoch: 27 cost time: 61.97886896133423
Epoch: 27, Steps: 208 | Train Loss: 0.174 Vali Loss: 10.580 Vali Acc: 0.093 Test Loss: 10.580 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.2114474
	speed: 0.6705s/iter; left time: 10114.6209s
	iters: 200, epoch: 28 | loss: 0.0267076
	speed: 0.2991s/iter; left time: 4482.5787s
Epoch: 28 cost time: 61.825355768203735
Epoch: 28, Steps: 208 | Train Loss: 0.180 Vali Loss: 10.195 Vali Acc: 0.098 Test Loss: 10.195 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1065429
	speed: 0.6668s/iter; left time: 9920.6252s
	iters: 200, epoch: 29 | loss: 0.0965217
	speed: 0.2912s/iter; left time: 4302.9103s
Epoch: 29 cost time: 61.0905442237854
Epoch: 29, Steps: 208 | Train Loss: 0.175 Vali Loss: 10.061 Vali Acc: 0.098 Test Loss: 10.061 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1568582
	speed: 0.6998s/iter; left time: 10265.7323s
	iters: 200, epoch: 30 | loss: 0.0165215
	speed: 0.3008s/iter; left time: 4382.0068s
Epoch: 30 cost time: 61.8964946269989
Epoch: 30, Steps: 208 | Train Loss: 0.148 Vali Loss: 10.732 Vali Acc: 0.092 Test Loss: 10.732 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10378765284819565
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2565713
	speed: 0.3068s/iter; left time: 6352.0829s
	iters: 200, epoch: 1 | loss: 3.6164346
	speed: 0.2858s/iter; left time: 5887.5850s
Epoch: 1 cost time: 61.65088987350464
Epoch: 1, Steps: 208 | Train Loss: 3.628 Vali Loss: 4.461 Vali Acc: 0.030 Test Loss: 4.461 Test Acc: 0.030
Validation loss decreased (inf --> -0.029779).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0991485
	speed: 0.6650s/iter; left time: 13627.3657s
	iters: 200, epoch: 2 | loss: 3.2357118
	speed: 0.2853s/iter; left time: 5818.5508s
Epoch: 2 cost time: 59.44362425804138
Epoch: 2, Steps: 208 | Train Loss: 3.263 Vali Loss: 4.496 Vali Acc: 0.044 Test Loss: 4.496 Test Acc: 0.044
Validation loss decreased (-0.029779 --> -0.044095).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5222075
	speed: 0.6550s/iter; left time: 13285.8403s
	iters: 200, epoch: 3 | loss: 2.6993022
	speed: 0.2977s/iter; left time: 6009.5385s
Epoch: 3 cost time: 60.994060039520264
Epoch: 3, Steps: 208 | Train Loss: 3.045 Vali Loss: 4.834 Vali Acc: 0.047 Test Loss: 4.834 Test Acc: 0.047
Validation loss decreased (-0.044095 --> -0.046775).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8547826
	speed: 0.7001s/iter; left time: 14055.7039s
	iters: 200, epoch: 4 | loss: 2.6143517
	speed: 0.2879s/iter; left time: 5752.2937s
Epoch: 4 cost time: 61.97338104248047
Epoch: 4, Steps: 208 | Train Loss: 2.775 Vali Loss: 4.826 Vali Acc: 0.053 Test Loss: 4.826 Test Acc: 0.053
Validation loss decreased (-0.046775 --> -0.053039).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1712406
	speed: 0.6474s/iter; left time: 12863.0549s
	iters: 200, epoch: 5 | loss: 2.7052386
	speed: 0.2782s/iter; left time: 5499.4417s
Epoch: 5 cost time: 59.18973159790039
Epoch: 5, Steps: 208 | Train Loss: 2.510 Vali Loss: 4.832 Vali Acc: 0.055 Test Loss: 4.832 Test Acc: 0.055
Validation loss decreased (-0.053039 --> -0.054530).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7587072
	speed: 0.6305s/iter; left time: 12397.0976s
	iters: 200, epoch: 6 | loss: 2.3484390
	speed: 0.2765s/iter; left time: 5408.2652s
Epoch: 6 cost time: 59.00503349304199
Epoch: 6, Steps: 208 | Train Loss: 2.148 Vali Loss: 5.232 Vali Acc: 0.065 Test Loss: 5.232 Test Acc: 0.065
Validation loss decreased (-0.054530 --> -0.065262).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4657408
	speed: 0.6449s/iter; left time: 12545.8271s
	iters: 200, epoch: 7 | loss: 2.6887982
	speed: 0.2706s/iter; left time: 5237.6848s
Epoch: 7 cost time: 57.93818736076355
Epoch: 7, Steps: 208 | Train Loss: 1.839 Vali Loss: 5.233 Vali Acc: 0.075 Test Loss: 5.233 Test Acc: 0.075
Validation loss decreased (-0.065262 --> -0.075104).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7155044
	speed: 0.6504s/iter; left time: 12516.5650s
	iters: 200, epoch: 8 | loss: 2.1757593
	speed: 0.2688s/iter; left time: 5146.9011s
Epoch: 8 cost time: 56.81185817718506
Epoch: 8, Steps: 208 | Train Loss: 1.474 Vali Loss: 5.451 Vali Acc: 0.079 Test Loss: 5.451 Test Acc: 0.079
Validation loss decreased (-0.075104 --> -0.078681).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8551006
	speed: 0.6351s/iter; left time: 12089.9977s
	iters: 200, epoch: 9 | loss: 2.0174611
	speed: 0.2417s/iter; left time: 4576.6808s
Epoch: 9 cost time: 53.855828523635864
Epoch: 9, Steps: 208 | Train Loss: 1.199 Vali Loss: 5.965 Vali Acc: 0.086 Test Loss: 5.965 Test Acc: 0.086
Validation loss decreased (-0.078681 --> -0.085834).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4530660
	speed: 0.6400s/iter; left time: 12049.6527s
	iters: 200, epoch: 10 | loss: 1.1922318
	speed: 0.2596s/iter; left time: 4861.1920s
Epoch: 10 cost time: 55.168243408203125
Epoch: 10, Steps: 208 | Train Loss: 0.989 Vali Loss: 6.371 Vali Acc: 0.085 Test Loss: 6.371 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5660317
	speed: 0.6615s/iter; left time: 12318.2490s
	iters: 200, epoch: 11 | loss: 0.8992069
	speed: 0.2736s/iter; left time: 5066.8775s
Epoch: 11 cost time: 58.31691837310791
Epoch: 11, Steps: 208 | Train Loss: 0.832 Vali Loss: 6.485 Vali Acc: 0.084 Test Loss: 6.485 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7076592
	speed: 0.6514s/iter; left time: 11993.6123s
	iters: 200, epoch: 12 | loss: 0.9528770
	speed: 0.2605s/iter; left time: 4770.6625s
Epoch: 12 cost time: 55.08574676513672
Epoch: 12, Steps: 208 | Train Loss: 0.702 Vali Loss: 6.937 Vali Acc: 0.079 Test Loss: 6.937 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2388811
	speed: 0.6680s/iter; left time: 12161.6973s
	iters: 200, epoch: 13 | loss: 0.5618145
	speed: 0.2548s/iter; left time: 4613.8062s
Epoch: 13 cost time: 55.88817739486694
Epoch: 13, Steps: 208 | Train Loss: 0.593 Vali Loss: 7.365 Vali Acc: 0.089 Test Loss: 7.365 Test Acc: 0.089
Validation loss decreased (-0.085834 --> -0.089100).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5197957
	speed: 0.6299s/iter; left time: 11336.9302s
	iters: 200, epoch: 14 | loss: 1.4649769
	speed: 0.2644s/iter; left time: 4731.5754s
Epoch: 14 cost time: 55.17947721481323
Epoch: 14, Steps: 208 | Train Loss: 0.529 Vali Loss: 7.730 Vali Acc: 0.081 Test Loss: 7.730 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5973096
	speed: 0.6490s/iter; left time: 11545.6648s
	iters: 200, epoch: 15 | loss: 0.8417394
	speed: 0.2556s/iter; left time: 4520.4904s
Epoch: 15 cost time: 55.10950040817261
Epoch: 15, Steps: 208 | Train Loss: 0.483 Vali Loss: 7.719 Vali Acc: 0.082 Test Loss: 7.719 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0122012
	speed: 0.6413s/iter; left time: 11274.8606s
	iters: 200, epoch: 16 | loss: 0.9461156
	speed: 0.2757s/iter; left time: 4819.6259s
Epoch: 16 cost time: 56.38968539237976
Epoch: 16, Steps: 208 | Train Loss: 0.414 Vali Loss: 8.019 Vali Acc: 0.085 Test Loss: 8.019 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4782377
	speed: 0.6131s/iter; left time: 10651.2209s
	iters: 200, epoch: 17 | loss: 0.3152151
	speed: 0.2612s/iter; left time: 4511.6659s
Epoch: 17 cost time: 52.9282009601593
Epoch: 17, Steps: 208 | Train Loss: 0.370 Vali Loss: 8.198 Vali Acc: 0.084 Test Loss: 8.198 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0222421
	speed: 0.6290s/iter; left time: 10796.3399s
	iters: 200, epoch: 18 | loss: 0.3742137
	speed: 0.2658s/iter; left time: 4536.0470s
Epoch: 18 cost time: 55.01188850402832
Epoch: 18, Steps: 208 | Train Loss: 0.331 Vali Loss: 8.507 Vali Acc: 0.087 Test Loss: 8.507 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6955528
	speed: 0.6174s/iter; left time: 10468.7586s
	iters: 200, epoch: 19 | loss: 0.4200070
	speed: 0.2440s/iter; left time: 4112.9468s
Epoch: 19 cost time: 52.627060651779175
Epoch: 19, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.778 Vali Acc: 0.091 Test Loss: 8.778 Test Acc: 0.091
Validation loss decreased (-0.089100 --> -0.090577).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1533421
	speed: 0.6298s/iter; left time: 10548.4913s
	iters: 200, epoch: 20 | loss: 0.0185085
	speed: 0.2584s/iter; left time: 4302.6598s
Epoch: 20 cost time: 54.695141553878784
Epoch: 20, Steps: 208 | Train Loss: 0.274 Vali Loss: 8.964 Vali Acc: 0.084 Test Loss: 8.964 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4966425
	speed: 0.6450s/iter; left time: 10668.5391s
	iters: 200, epoch: 21 | loss: 0.0216920
	speed: 0.2635s/iter; left time: 4332.8096s
Epoch: 21 cost time: 56.022467613220215
Epoch: 21, Steps: 208 | Train Loss: 0.254 Vali Loss: 9.035 Vali Acc: 0.091 Test Loss: 9.035 Test Acc: 0.091
Validation loss decreased (-0.090577 --> -0.090873).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5211439
	speed: 0.6251s/iter; left time: 10209.0108s
	iters: 200, epoch: 22 | loss: 0.5609009
	speed: 0.2577s/iter; left time: 4183.6292s
Epoch: 22 cost time: 54.14988446235657
Epoch: 22, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.634 Vali Acc: 0.081 Test Loss: 9.634 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3696778
	speed: 0.6351s/iter; left time: 10241.6801s
	iters: 200, epoch: 23 | loss: 0.7652196
	speed: 0.2638s/iter; left time: 4226.6900s
Epoch: 23 cost time: 54.743910789489746
Epoch: 23, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.758 Vali Acc: 0.083 Test Loss: 9.758 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0992867
	speed: 0.6491s/iter; left time: 10331.0455s
	iters: 200, epoch: 24 | loss: 0.3209751
	speed: 0.2822s/iter; left time: 4463.3309s
Epoch: 24 cost time: 57.7474308013916
Epoch: 24, Steps: 208 | Train Loss: 0.205 Vali Loss: 9.611 Vali Acc: 0.094 Test Loss: 9.611 Test Acc: 0.094
Validation loss decreased (-0.090873 --> -0.094148).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.1531823
	speed: 0.6320s/iter; left time: 9927.5804s
	iters: 200, epoch: 25 | loss: 0.1986053
	speed: 0.2749s/iter; left time: 4290.5121s
Epoch: 25 cost time: 56.7046856880188
Epoch: 25, Steps: 208 | Train Loss: 0.199 Vali Loss: 9.869 Vali Acc: 0.092 Test Loss: 9.869 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0566164
	speed: 0.6246s/iter; left time: 9682.6949s
	iters: 200, epoch: 26 | loss: 0.5077932
	speed: 0.2809s/iter; left time: 4326.4430s
Epoch: 26 cost time: 57.408695459365845
Epoch: 26, Steps: 208 | Train Loss: 0.189 Vali Loss: 9.970 Vali Acc: 0.092 Test Loss: 9.970 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0253880
	speed: 0.6015s/iter; left time: 9197.9999s
	iters: 200, epoch: 27 | loss: 0.3455702
	speed: 0.2766s/iter; left time: 4202.0570s
Epoch: 27 cost time: 55.60590577125549
Epoch: 27, Steps: 208 | Train Loss: 0.198 Vali Loss: 10.084 Vali Acc: 0.087 Test Loss: 10.084 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0066433
	speed: 0.6087s/iter; left time: 9182.4917s
	iters: 200, epoch: 28 | loss: 0.1656963
	speed: 0.2533s/iter; left time: 3795.1993s
Epoch: 28 cost time: 53.40567874908447
Epoch: 28, Steps: 208 | Train Loss: 0.165 Vali Loss: 10.010 Vali Acc: 0.096 Test Loss: 10.010 Test Acc: 0.096
Validation loss decreased (-0.094148 --> -0.095635).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0555482
	speed: 0.6442s/iter; left time: 9584.3642s
	iters: 200, epoch: 29 | loss: 0.1045440
	speed: 0.2666s/iter; left time: 3939.6415s
Epoch: 29 cost time: 55.4145348072052
Epoch: 29, Steps: 208 | Train Loss: 0.158 Vali Loss: 10.111 Vali Acc: 0.090 Test Loss: 10.111 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0063250
	speed: 0.5955s/iter; left time: 8735.4528s
	iters: 200, epoch: 30 | loss: 0.0101272
	speed: 0.2874s/iter; left time: 4187.1681s
Epoch: 30 cost time: 56.29757118225098
Epoch: 30, Steps: 208 | Train Loss: 0.165 Vali Loss: 9.869 Vali Acc: 0.095 Test Loss: 9.869 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0513234
	speed: 0.6225s/iter; left time: 9002.5870s
	iters: 200, epoch: 31 | loss: 0.1448691
	speed: 0.2744s/iter; left time: 3940.4514s
Epoch: 31 cost time: 57.6756808757782
Epoch: 31, Steps: 208 | Train Loss: 0.148 Vali Loss: 10.313 Vali Acc: 0.088 Test Loss: 10.313 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0356880
	speed: 0.6346s/iter; left time: 9045.4427s
	iters: 200, epoch: 32 | loss: 0.0931057
	speed: 0.2635s/iter; left time: 3729.3566s
Epoch: 32 cost time: 59.15696334838867
Epoch: 32, Steps: 208 | Train Loss: 0.139 Vali Loss: 10.197 Vali Acc: 0.089 Test Loss: 10.197 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0423673
	speed: 0.6556s/iter; left time: 9207.8463s
	iters: 200, epoch: 33 | loss: 0.1624858
	speed: 0.2877s/iter; left time: 4011.3709s
Epoch: 33 cost time: 58.932705879211426
Epoch: 33, Steps: 208 | Train Loss: 0.145 Vali Loss: 10.561 Vali Acc: 0.094 Test Loss: 10.561 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.1195623
	speed: 0.6181s/iter; left time: 8552.5997s
	iters: 200, epoch: 34 | loss: 0.0207845
	speed: 0.2813s/iter; left time: 3864.4963s
Epoch: 34 cost time: 55.74572801589966
Epoch: 34, Steps: 208 | Train Loss: 0.134 Vali Loss: 10.572 Vali Acc: 0.088 Test Loss: 10.572 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0399608
	speed: 0.6095s/iter; left time: 8306.2278s
	iters: 200, epoch: 35 | loss: 0.0068478
	speed: 0.2827s/iter; left time: 3825.1306s
Epoch: 35 cost time: 56.825703620910645
Epoch: 35, Steps: 208 | Train Loss: 0.132 Vali Loss: 10.386 Vali Acc: 0.092 Test Loss: 10.386 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0960234
	speed: 0.6088s/iter; left time: 8171.2723s
	iters: 200, epoch: 36 | loss: 0.0449294
	speed: 0.2874s/iter; left time: 3828.6695s
Epoch: 36 cost time: 59.393643856048584
Epoch: 36, Steps: 208 | Train Loss: 0.106 Vali Loss: 11.028 Vali Acc: 0.094 Test Loss: 11.028 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0044194
	speed: 0.6587s/iter; left time: 8703.7805s
	iters: 200, epoch: 37 | loss: 0.1228574
	speed: 0.2837s/iter; left time: 3719.9878s
Epoch: 37 cost time: 59.56423473358154
Epoch: 37, Steps: 208 | Train Loss: 0.106 Vali Loss: 11.354 Vali Acc: 0.089 Test Loss: 11.354 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0032707
	speed: 0.6473s/iter; left time: 8417.6832s
	iters: 200, epoch: 38 | loss: 0.0990439
	speed: 0.2687s/iter; left time: 3467.4368s
Epoch: 38 cost time: 55.929051876068115
Epoch: 38, Steps: 208 | Train Loss: 0.112 Vali Loss: 11.140 Vali Acc: 0.086 Test Loss: 11.140 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09573516254100806
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3957186
	speed: 0.2946s/iter; left time: 6097.7991s
	iters: 200, epoch: 1 | loss: 3.7072935
	speed: 0.2500s/iter; left time: 5149.7887s
Epoch: 1 cost time: 56.62743091583252
Epoch: 1, Steps: 208 | Train Loss: 3.630 Vali Loss: 5.384 Vali Acc: 0.030 Test Loss: 5.384 Test Acc: 0.030
Validation loss decreased (inf --> -0.029472).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2836313
	speed: 0.6649s/iter; left time: 13626.2192s
	iters: 200, epoch: 2 | loss: 3.1124866
	speed: 0.2741s/iter; left time: 5589.8746s
Epoch: 2 cost time: 59.45361018180847
Epoch: 2, Steps: 208 | Train Loss: 3.310 Vali Loss: 4.999 Vali Acc: 0.038 Test Loss: 4.999 Test Acc: 0.038
Validation loss decreased (-0.029472 --> -0.038423).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2422829
	speed: 0.6401s/iter; left time: 12984.2837s
	iters: 200, epoch: 3 | loss: 3.3499839
	speed: 0.2970s/iter; left time: 5994.8837s
Epoch: 3 cost time: 59.451693058013916
Epoch: 3, Steps: 208 | Train Loss: 3.173 Vali Loss: 5.108 Vali Acc: 0.052 Test Loss: 5.108 Test Acc: 0.052
Validation loss decreased (-0.038423 --> -0.051545).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6805711
	speed: 0.6187s/iter; left time: 12421.2250s
	iters: 200, epoch: 4 | loss: 2.9352438
	speed: 0.2596s/iter; left time: 5186.0788s
Epoch: 4 cost time: 56.010624408721924
Epoch: 4, Steps: 208 | Train Loss: 3.011 Vali Loss: 4.952 Vali Acc: 0.047 Test Loss: 4.952 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9250882
	speed: 0.6414s/iter; left time: 12743.4139s
	iters: 200, epoch: 5 | loss: 3.7920446
	speed: 0.2618s/iter; left time: 5175.7664s
Epoch: 5 cost time: 56.40947389602661
Epoch: 5, Steps: 208 | Train Loss: 2.799 Vali Loss: 4.795 Vali Acc: 0.063 Test Loss: 4.795 Test Acc: 0.063
Validation loss decreased (-0.051545 --> -0.062881).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3561563
	speed: 0.6591s/iter; left time: 12959.3454s
	iters: 200, epoch: 6 | loss: 2.6160412
	speed: 0.2864s/iter; left time: 5601.8892s
Epoch: 6 cost time: 58.96658635139465
Epoch: 6, Steps: 208 | Train Loss: 2.493 Vali Loss: 4.792 Vali Acc: 0.063 Test Loss: 4.792 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2563528
	speed: 0.6470s/iter; left time: 12585.8477s
	iters: 200, epoch: 7 | loss: 2.5264552
	speed: 0.2934s/iter; left time: 5678.1887s
Epoch: 7 cost time: 59.410929918289185
Epoch: 7, Steps: 208 | Train Loss: 2.213 Vali Loss: 4.903 Vali Acc: 0.062 Test Loss: 4.903 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8772758
	speed: 0.6101s/iter; left time: 11742.2573s
	iters: 200, epoch: 8 | loss: 2.1645548
	speed: 0.2802s/iter; left time: 5365.0974s
Epoch: 8 cost time: 55.40907049179077
Epoch: 8, Steps: 208 | Train Loss: 1.876 Vali Loss: 5.047 Vali Acc: 0.076 Test Loss: 5.047 Test Acc: 0.076
Validation loss decreased (-0.062881 --> -0.076001).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7898037
	speed: 0.6152s/iter; left time: 11711.3264s
	iters: 200, epoch: 9 | loss: 2.4760923
	speed: 0.2574s/iter; left time: 4874.9604s
Epoch: 9 cost time: 55.448463678359985
Epoch: 9, Steps: 208 | Train Loss: 1.571 Vali Loss: 5.457 Vali Acc: 0.071 Test Loss: 5.457 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5336607
	speed: 0.6547s/iter; left time: 12326.9641s
	iters: 200, epoch: 10 | loss: 1.2695550
	speed: 0.2807s/iter; left time: 5257.9781s
Epoch: 10 cost time: 59.26321458816528
Epoch: 10, Steps: 208 | Train Loss: 1.347 Vali Loss: 5.566 Vali Acc: 0.077 Test Loss: 5.566 Test Acc: 0.077
Validation loss decreased (-0.076001 --> -0.076592).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7028930
	speed: 0.6398s/iter; left time: 11913.4193s
	iters: 200, epoch: 11 | loss: 1.3868012
	speed: 0.2766s/iter; left time: 5122.7052s
Epoch: 11 cost time: 57.92880582809448
Epoch: 11, Steps: 208 | Train Loss: 1.140 Vali Loss: 5.916 Vali Acc: 0.076 Test Loss: 5.916 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7028631
	speed: 0.6349s/iter; left time: 11690.6886s
	iters: 200, epoch: 12 | loss: 1.3597382
	speed: 0.2581s/iter; left time: 4725.8991s
Epoch: 12 cost time: 57.03613305091858
Epoch: 12, Steps: 208 | Train Loss: 0.956 Vali Loss: 6.118 Vali Acc: 0.078 Test Loss: 6.118 Test Acc: 0.078
Validation loss decreased (-0.076592 --> -0.078376).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3927855
	speed: 0.6219s/iter; left time: 11322.4907s
	iters: 200, epoch: 13 | loss: 0.7007765
	speed: 0.2758s/iter; left time: 4992.8277s
Epoch: 13 cost time: 56.224780321121216
Epoch: 13, Steps: 208 | Train Loss: 0.803 Vali Loss: 6.749 Vali Acc: 0.076 Test Loss: 6.749 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5435660
	speed: 0.6143s/iter; left time: 11054.7077s
	iters: 200, epoch: 14 | loss: 0.7867452
	speed: 0.2832s/iter; left time: 5068.0442s
Epoch: 14 cost time: 58.566645860672
Epoch: 14, Steps: 208 | Train Loss: 0.709 Vali Loss: 6.787 Vali Acc: 0.077 Test Loss: 6.787 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4917960
	speed: 0.6598s/iter; left time: 11736.9325s
	iters: 200, epoch: 15 | loss: 0.7601824
	speed: 0.2851s/iter; left time: 5042.2949s
Epoch: 15 cost time: 58.037142753601074
Epoch: 15, Steps: 208 | Train Loss: 0.613 Vali Loss: 6.923 Vali Acc: 0.089 Test Loss: 6.923 Test Acc: 0.089
Validation loss decreased (-0.078376 --> -0.089105).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6345649
	speed: 0.6346s/iter; left time: 11156.5928s
	iters: 200, epoch: 16 | loss: 0.6687999
	speed: 0.2695s/iter; left time: 4711.0005s
Epoch: 16 cost time: 58.10851740837097
Epoch: 16, Steps: 208 | Train Loss: 0.555 Vali Loss: 7.225 Vali Acc: 0.084 Test Loss: 7.225 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3026323
	speed: 0.6227s/iter; left time: 10817.6196s
	iters: 200, epoch: 17 | loss: 0.7396053
	speed: 0.2773s/iter; left time: 4789.3189s
Epoch: 17 cost time: 56.761401653289795
Epoch: 17, Steps: 208 | Train Loss: 0.516 Vali Loss: 7.513 Vali Acc: 0.080 Test Loss: 7.513 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.0028958
	speed: 0.6397s/iter; left time: 10979.7869s
	iters: 200, epoch: 18 | loss: 0.7518443
	speed: 0.2812s/iter; left time: 4798.1621s
Epoch: 18 cost time: 58.841325759887695
Epoch: 18, Steps: 208 | Train Loss: 0.477 Vali Loss: 7.731 Vali Acc: 0.088 Test Loss: 7.731 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1950402
	speed: 0.6585s/iter; left time: 11165.3677s
	iters: 200, epoch: 19 | loss: 0.3168060
	speed: 0.2818s/iter; left time: 4750.5270s
Epoch: 19 cost time: 59.91569781303406
Epoch: 19, Steps: 208 | Train Loss: 0.398 Vali Loss: 7.897 Vali Acc: 0.088 Test Loss: 7.897 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3344683
	speed: 0.6669s/iter; left time: 11170.0857s
	iters: 200, epoch: 20 | loss: 0.1315417
	speed: 0.2945s/iter; left time: 4902.4871s
Epoch: 20 cost time: 59.70002245903015
Epoch: 20, Steps: 208 | Train Loss: 0.379 Vali Loss: 8.205 Vali Acc: 0.087 Test Loss: 8.205 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.9203676
	speed: 0.6380s/iter; left time: 10552.7737s
	iters: 200, epoch: 21 | loss: 0.2820666
	speed: 0.2529s/iter; left time: 4158.0798s
Epoch: 21 cost time: 55.39008927345276
Epoch: 21, Steps: 208 | Train Loss: 0.362 Vali Loss: 7.884 Vali Acc: 0.085 Test Loss: 7.884 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2473436
	speed: 0.6419s/iter; left time: 10483.7624s
	iters: 200, epoch: 22 | loss: 0.2872580
	speed: 0.2946s/iter; left time: 4781.9080s
Epoch: 22 cost time: 58.9394166469574
Epoch: 22, Steps: 208 | Train Loss: 0.314 Vali Loss: 8.796 Vali Acc: 0.087 Test Loss: 8.796 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.6163869
	speed: 0.6439s/iter; left time: 10383.3901s
	iters: 200, epoch: 23 | loss: 0.7410305
	speed: 0.2689s/iter; left time: 4308.3661s
Epoch: 23 cost time: 58.82308292388916
Epoch: 23, Steps: 208 | Train Loss: 0.301 Vali Loss: 8.563 Vali Acc: 0.094 Test Loss: 8.563 Test Acc: 0.094
Validation loss decreased (-0.089105 --> -0.094158).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0878835
	speed: 0.6537s/iter; left time: 10404.1868s
	iters: 200, epoch: 24 | loss: 0.7040826
	speed: 0.2843s/iter; left time: 4496.6510s
Epoch: 24 cost time: 57.89895582199097
Epoch: 24, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.697 Vali Acc: 0.094 Test Loss: 8.697 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1596701
	speed: 0.6316s/iter; left time: 9921.5013s
	iters: 200, epoch: 25 | loss: 0.6564265
	speed: 0.2542s/iter; left time: 3967.5214s
Epoch: 25 cost time: 55.88268041610718
Epoch: 25, Steps: 208 | Train Loss: 0.265 Vali Loss: 8.752 Vali Acc: 0.090 Test Loss: 8.752 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3833190
	speed: 0.6549s/iter; left time: 10151.8946s
	iters: 200, epoch: 26 | loss: 0.7163861
	speed: 0.2973s/iter; left time: 4579.1316s
Epoch: 26 cost time: 61.240376234054565
Epoch: 26, Steps: 208 | Train Loss: 0.285 Vali Loss: 8.997 Vali Acc: 0.091 Test Loss: 8.997 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0576402
	speed: 0.6511s/iter; left time: 9957.4587s
	iters: 200, epoch: 27 | loss: 0.5443571
	speed: 0.2621s/iter; left time: 3981.9447s
Epoch: 27 cost time: 56.96169066429138
Epoch: 27, Steps: 208 | Train Loss: 0.250 Vali Loss: 8.889 Vali Acc: 0.090 Test Loss: 8.889 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.4065352
	speed: 0.6472s/iter; left time: 9762.3503s
	iters: 200, epoch: 28 | loss: 0.2890279
	speed: 0.2633s/iter; left time: 3945.9715s
Epoch: 28 cost time: 56.749295711517334
Epoch: 28, Steps: 208 | Train Loss: 0.243 Vali Loss: 9.078 Vali Acc: 0.091 Test Loss: 9.078 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0324709
	speed: 0.6490s/iter; left time: 9655.5598s
	iters: 200, epoch: 29 | loss: 0.3912971
	speed: 0.2751s/iter; left time: 4064.9031s
Epoch: 29 cost time: 58.59344792366028
Epoch: 29, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.456 Vali Acc: 0.084 Test Loss: 9.456 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.2104651
	speed: 0.6568s/iter; left time: 9634.4735s
	iters: 200, epoch: 30 | loss: 0.2288004
	speed: 0.2853s/iter; left time: 4157.0515s
Epoch: 30 cost time: 59.72665882110596
Epoch: 30, Steps: 208 | Train Loss: 0.188 Vali Loss: 9.528 Vali Acc: 0.087 Test Loss: 9.528 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.7459882
	speed: 0.6435s/iter; left time: 9305.2283s
	iters: 200, epoch: 31 | loss: 0.1271545
	speed: 0.2694s/iter; left time: 3868.7097s
Epoch: 31 cost time: 57.26127338409424
Epoch: 31, Steps: 208 | Train Loss: 0.191 Vali Loss: 9.197 Vali Acc: 0.095 Test Loss: 9.197 Test Acc: 0.095
Validation loss decreased (-0.094158 --> -0.094748).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.1422186
	speed: 0.6414s/iter; left time: 9141.2780s
	iters: 200, epoch: 32 | loss: 0.0833926
	speed: 0.2763s/iter; left time: 3910.4406s
Epoch: 32 cost time: 58.53885793685913
Epoch: 32, Steps: 208 | Train Loss: 0.203 Vali Loss: 9.616 Vali Acc: 0.095 Test Loss: 9.616 Test Acc: 0.095
Validation loss decreased (-0.094748 --> -0.095341).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.4198159
	speed: 0.6653s/iter; left time: 9344.3797s
	iters: 200, epoch: 33 | loss: 0.1064193
	speed: 0.2747s/iter; left time: 3830.1739s
Epoch: 33 cost time: 57.93598198890686
Epoch: 33, Steps: 208 | Train Loss: 0.183 Vali Loss: 9.587 Vali Acc: 0.098 Test Loss: 9.587 Test Acc: 0.098
Validation loss decreased (-0.095341 --> -0.097727).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0890845
	speed: 0.6683s/iter; left time: 9247.4862s
	iters: 200, epoch: 34 | loss: 0.2119150
	speed: 0.3069s/iter; left time: 4216.3388s
Epoch: 34 cost time: 62.918957471847534
Epoch: 34, Steps: 208 | Train Loss: 0.171 Vali Loss: 9.879 Vali Acc: 0.092 Test Loss: 9.879 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.3633391
	speed: 0.6702s/iter; left time: 9134.3777s
	iters: 200, epoch: 35 | loss: 0.4471269
	speed: 0.2861s/iter; left time: 3870.5965s
Epoch: 35 cost time: 59.69236373901367
Epoch: 35, Steps: 208 | Train Loss: 0.152 Vali Loss: 9.771 Vali Acc: 0.098 Test Loss: 9.771 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0281745
	speed: 0.6171s/iter; left time: 8282.7683s
	iters: 200, epoch: 36 | loss: 0.0065998
	speed: 0.2725s/iter; left time: 3630.1815s
Epoch: 36 cost time: 55.42443585395813
Epoch: 36, Steps: 208 | Train Loss: 0.149 Vali Loss: 10.232 Vali Acc: 0.092 Test Loss: 10.232 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.2156937
	speed: 0.5983s/iter; left time: 7905.6158s
	iters: 200, epoch: 37 | loss: 0.0060955
	speed: 0.2751s/iter; left time: 3606.7511s
Epoch: 37 cost time: 56.02176523208618
Epoch: 37, Steps: 208 | Train Loss: 0.155 Vali Loss: 10.307 Vali Acc: 0.092 Test Loss: 10.307 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0662655
	speed: 0.6251s/iter; left time: 8129.0739s
	iters: 200, epoch: 38 | loss: 0.0888592
	speed: 0.2762s/iter; left time: 3563.9937s
Epoch: 38 cost time: 56.5521719455719
Epoch: 38, Steps: 208 | Train Loss: 0.203 Vali Loss: 10.367 Vali Acc: 0.097 Test Loss: 10.367 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0937927
	speed: 0.6599s/iter; left time: 8444.1436s
	iters: 200, epoch: 39 | loss: 0.2278280
	speed: 0.2822s/iter; left time: 3582.8050s
Epoch: 39 cost time: 59.50176000595093
Epoch: 39, Steps: 208 | Train Loss: 0.144 Vali Loss: 10.403 Vali Acc: 0.091 Test Loss: 10.403 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.2605487
	speed: 0.6429s/iter; left time: 8093.4366s
	iters: 200, epoch: 40 | loss: 0.0501949
	speed: 0.2720s/iter; left time: 3397.4594s
Epoch: 40 cost time: 57.14755129814148
Epoch: 40, Steps: 208 | Train Loss: 0.169 Vali Loss: 10.410 Vali Acc: 0.085 Test Loss: 10.410 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0869850
	speed: 0.6554s/iter; left time: 8114.0544s
	iters: 200, epoch: 41 | loss: 0.0349005
	speed: 0.2755s/iter; left time: 3383.2249s
Epoch: 41 cost time: 57.631051540374756
Epoch: 41, Steps: 208 | Train Loss: 0.138 Vali Loss: 10.528 Vali Acc: 0.096 Test Loss: 10.528 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0477944
	speed: 0.6690s/iter; left time: 8144.2091s
	iters: 200, epoch: 42 | loss: 0.1018973
	speed: 0.2627s/iter; left time: 3171.3614s
Epoch: 42 cost time: 56.726662158966064
Epoch: 42, Steps: 208 | Train Loss: 0.147 Vali Loss: 10.308 Vali Acc: 0.090 Test Loss: 10.308 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0470987
	speed: 0.6529s/iter; left time: 7812.1626s
	iters: 200, epoch: 43 | loss: 0.0119741
	speed: 0.2767s/iter; left time: 3283.2260s
Epoch: 43 cost time: 56.719239473342896
Epoch: 43, Steps: 208 | Train Loss: 0.129 Vali Loss: 10.555 Vali Acc: 0.094 Test Loss: 10.555 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09782284521324187
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2841103
	speed: 0.2930s/iter; left time: 6066.2018s
	iters: 200, epoch: 1 | loss: 3.7918625
	speed: 0.3101s/iter; left time: 6387.7884s
Epoch: 1 cost time: 63.240079402923584
Epoch: 1, Steps: 208 | Train Loss: 3.632 Vali Loss: 4.925 Vali Acc: 0.034 Test Loss: 4.925 Test Acc: 0.034
Validation loss decreased (inf --> -0.034248).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2598362
	speed: 0.6829s/iter; left time: 13995.6249s
	iters: 200, epoch: 2 | loss: 2.9405823
	speed: 0.3017s/iter; left time: 6153.5339s
Epoch: 2 cost time: 63.599791049957275
Epoch: 2, Steps: 208 | Train Loss: 3.230 Vali Loss: 4.817 Vali Acc: 0.047 Test Loss: 4.817 Test Acc: 0.047
Validation loss decreased (-0.034248 --> -0.047372).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1656458
	speed: 0.6705s/iter; left time: 13601.3844s
	iters: 200, epoch: 3 | loss: 3.2259493
	speed: 0.2886s/iter; left time: 5826.0937s
Epoch: 3 cost time: 61.47264099121094
Epoch: 3, Steps: 208 | Train Loss: 2.994 Vali Loss: 5.052 Vali Acc: 0.051 Test Loss: 5.052 Test Acc: 0.051
Validation loss decreased (-0.047372 --> -0.051247).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2452137
	speed: 0.6674s/iter; left time: 13399.9375s
	iters: 200, epoch: 4 | loss: 2.0516887
	speed: 0.2909s/iter; left time: 5811.0274s
Epoch: 4 cost time: 61.900306701660156
Epoch: 4, Steps: 208 | Train Loss: 2.737 Vali Loss: 5.187 Vali Acc: 0.049 Test Loss: 5.187 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3560884
	speed: 0.6905s/iter; left time: 13719.2814s
	iters: 200, epoch: 5 | loss: 2.7312374
	speed: 0.2825s/iter; left time: 5584.0291s
Epoch: 5 cost time: 62.13614535331726
Epoch: 5, Steps: 208 | Train Loss: 2.439 Vali Loss: 5.092 Vali Acc: 0.065 Test Loss: 5.092 Test Acc: 0.065
Validation loss decreased (-0.051247 --> -0.064965).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6317402
	speed: 0.7054s/iter; left time: 13869.7545s
	iters: 200, epoch: 6 | loss: 2.1219196
	speed: 0.2895s/iter; left time: 5662.2280s
Epoch: 6 cost time: 63.067152976989746
Epoch: 6, Steps: 208 | Train Loss: 2.090 Vali Loss: 5.546 Vali Acc: 0.061 Test Loss: 5.546 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8193314
	speed: 0.6958s/iter; left time: 13535.7072s
	iters: 200, epoch: 7 | loss: 1.3410299
	speed: 0.2844s/iter; left time: 5504.7180s
Epoch: 7 cost time: 60.84164214134216
Epoch: 7, Steps: 208 | Train Loss: 1.761 Vali Loss: 5.732 Vali Acc: 0.064 Test Loss: 5.732 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7177545
	speed: 0.6568s/iter; left time: 12639.7095s
	iters: 200, epoch: 8 | loss: 1.2356431
	speed: 0.3143s/iter; left time: 6016.4502s
Epoch: 8 cost time: 61.62050724029541
Epoch: 8, Steps: 208 | Train Loss: 1.423 Vali Loss: 6.184 Vali Acc: 0.062 Test Loss: 6.184 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6012925
	speed: 0.6894s/iter; left time: 13125.0084s
	iters: 200, epoch: 9 | loss: 2.0598712
	speed: 0.3075s/iter; left time: 5823.6855s
Epoch: 9 cost time: 62.576916456222534
Epoch: 9, Steps: 208 | Train Loss: 1.178 Vali Loss: 6.467 Vali Acc: 0.064 Test Loss: 6.467 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3534465
	speed: 0.6745s/iter; left time: 12700.7966s
	iters: 200, epoch: 10 | loss: 1.0010061
	speed: 0.3011s/iter; left time: 5639.1549s
Epoch: 10 cost time: 62.95127987861633
Epoch: 10, Steps: 208 | Train Loss: 0.991 Vali Loss: 6.642 Vali Acc: 0.070 Test Loss: 6.642 Test Acc: 0.070
Validation loss decreased (-0.064965 --> -0.069722).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5229274
	speed: 0.6666s/iter; left time: 12413.0408s
	iters: 200, epoch: 11 | loss: 0.9141661
	speed: 0.2967s/iter; left time: 5496.0133s
Epoch: 11 cost time: 61.64014911651611
Epoch: 11, Steps: 208 | Train Loss: 0.828 Vali Loss: 7.093 Vali Acc: 0.067 Test Loss: 7.093 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2622306
	speed: 0.6613s/iter; left time: 12175.7197s
	iters: 200, epoch: 12 | loss: 0.5480044
	speed: 0.3019s/iter; left time: 5528.6726s
Epoch: 12 cost time: 63.698272466659546
Epoch: 12, Steps: 208 | Train Loss: 0.709 Vali Loss: 7.406 Vali Acc: 0.081 Test Loss: 7.406 Test Acc: 0.081
Validation loss decreased (-0.069722 --> -0.081047).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5871637
	speed: 0.7037s/iter; left time: 12810.6537s
	iters: 200, epoch: 13 | loss: 0.6768863
	speed: 0.2973s/iter; left time: 5383.3076s
Epoch: 13 cost time: 63.37331533432007
Epoch: 13, Steps: 208 | Train Loss: 0.627 Vali Loss: 7.693 Vali Acc: 0.076 Test Loss: 7.693 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6641368
	speed: 0.6722s/iter; left time: 12097.9839s
	iters: 200, epoch: 14 | loss: 1.0128642
	speed: 0.2884s/iter; left time: 5160.9991s
Epoch: 14 cost time: 60.676008462905884
Epoch: 14, Steps: 208 | Train Loss: 0.526 Vali Loss: 8.155 Vali Acc: 0.078 Test Loss: 8.155 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3359915
	speed: 0.7078s/iter; left time: 12591.3994s
	iters: 200, epoch: 15 | loss: 1.0234503
	speed: 0.2803s/iter; left time: 4958.3047s
Epoch: 15 cost time: 61.06320285797119
Epoch: 15, Steps: 208 | Train Loss: 0.454 Vali Loss: 8.387 Vali Acc: 0.081 Test Loss: 8.387 Test Acc: 0.081
Validation loss decreased (-0.081047 --> -0.081336).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3644610
	speed: 0.7076s/iter; left time: 12439.7274s
	iters: 200, epoch: 16 | loss: 0.6184335
	speed: 0.2861s/iter; left time: 5001.4745s
Epoch: 16 cost time: 60.29594159126282
Epoch: 16, Steps: 208 | Train Loss: 0.401 Vali Loss: 8.918 Vali Acc: 0.086 Test Loss: 8.918 Test Acc: 0.086
Validation loss decreased (-0.081336 --> -0.086102).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4420416
	speed: 0.6961s/iter; left time: 12093.9240s
	iters: 200, epoch: 17 | loss: 0.9444909
	speed: 0.2815s/iter; left time: 4862.8084s
Epoch: 17 cost time: 59.760565519332886
Epoch: 17, Steps: 208 | Train Loss: 0.404 Vali Loss: 8.859 Vali Acc: 0.078 Test Loss: 8.859 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1991642
	speed: 0.6590s/iter; left time: 11311.6043s
	iters: 200, epoch: 18 | loss: 0.1051202
	speed: 0.2904s/iter; left time: 4956.3317s
Epoch: 18 cost time: 59.78347158432007
Epoch: 18, Steps: 208 | Train Loss: 0.350 Vali Loss: 9.251 Vali Acc: 0.087 Test Loss: 9.251 Test Acc: 0.087
Validation loss decreased (-0.086102 --> -0.087292).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5887918
	speed: 0.6575s/iter; left time: 11149.9509s
	iters: 200, epoch: 19 | loss: 0.2135658
	speed: 0.2970s/iter; left time: 5005.9270s
Epoch: 19 cost time: 60.823734998703
Epoch: 19, Steps: 208 | Train Loss: 0.314 Vali Loss: 9.048 Vali Acc: 0.079 Test Loss: 9.048 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1306841
	speed: 0.6635s/iter; left time: 11112.9279s
	iters: 200, epoch: 20 | loss: 0.4702007
	speed: 0.3028s/iter; left time: 5040.6460s
Epoch: 20 cost time: 61.212475299835205
Epoch: 20, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.503 Vali Acc: 0.078 Test Loss: 9.503 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.3639798
	speed: 0.6620s/iter; left time: 10950.5828s
	iters: 200, epoch: 21 | loss: 0.2391976
	speed: 0.2874s/iter; left time: 4725.2746s
Epoch: 21 cost time: 60.57904887199402
Epoch: 21, Steps: 208 | Train Loss: 0.267 Vali Loss: 9.932 Vali Acc: 0.073 Test Loss: 9.932 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1228966
	speed: 0.6576s/iter; left time: 10740.5310s
	iters: 200, epoch: 22 | loss: 0.4239933
	speed: 0.2871s/iter; left time: 4660.3475s
Epoch: 22 cost time: 60.157851219177246
Epoch: 22, Steps: 208 | Train Loss: 0.263 Vali Loss: 10.028 Vali Acc: 0.079 Test Loss: 10.028 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.3999705
	speed: 0.6431s/iter; left time: 10370.4779s
	iters: 200, epoch: 23 | loss: 0.3750560
	speed: 0.2905s/iter; left time: 4655.9545s
Epoch: 23 cost time: 60.90357208251953
Epoch: 23, Steps: 208 | Train Loss: 0.239 Vali Loss: 9.945 Vali Acc: 0.086 Test Loss: 9.945 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0286497
	speed: 0.6854s/iter; left time: 10909.8987s
	iters: 200, epoch: 24 | loss: 0.5475348
	speed: 0.3050s/iter; left time: 4824.4191s
Epoch: 24 cost time: 62.6477267742157
Epoch: 24, Steps: 208 | Train Loss: 0.222 Vali Loss: 9.943 Vali Acc: 0.086 Test Loss: 9.943 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1056851
	speed: 0.6699s/iter; left time: 10522.9930s
	iters: 200, epoch: 25 | loss: 0.0357921
	speed: 0.2885s/iter; left time: 4502.4871s
Epoch: 25 cost time: 60.08821153640747
Epoch: 25, Steps: 208 | Train Loss: 0.198 Vali Loss: 10.431 Vali Acc: 0.088 Test Loss: 10.431 Test Acc: 0.088
Validation loss decreased (-0.087292 --> -0.087578).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0434226
	speed: 0.6771s/iter; left time: 10496.3121s
	iters: 200, epoch: 26 | loss: 0.1469119
	speed: 0.2861s/iter; left time: 4406.7048s
Epoch: 26 cost time: 61.50439500808716
Epoch: 26, Steps: 208 | Train Loss: 0.212 Vali Loss: 10.223 Vali Acc: 0.086 Test Loss: 10.223 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.6044294
	speed: 0.7063s/iter; left time: 10802.0174s
	iters: 200, epoch: 27 | loss: 0.1610204
	speed: 0.2989s/iter; left time: 4541.7525s
Epoch: 27 cost time: 62.69835877418518
Epoch: 27, Steps: 208 | Train Loss: 0.213 Vali Loss: 10.121 Vali Acc: 0.086 Test Loss: 10.121 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0170369
	speed: 0.6838s/iter; left time: 10314.5940s
	iters: 200, epoch: 28 | loss: 0.5187898
	speed: 0.2772s/iter; left time: 4153.3015s
Epoch: 28 cost time: 59.92073845863342
Epoch: 28, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.414 Vali Acc: 0.088 Test Loss: 10.414 Test Acc: 0.088
Validation loss decreased (-0.087578 --> -0.087877).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1456473
	speed: 0.6828s/iter; left time: 10158.3168s
	iters: 200, epoch: 29 | loss: 0.1343637
	speed: 0.3078s/iter; left time: 4548.2753s
Epoch: 29 cost time: 63.50703024864197
Epoch: 29, Steps: 208 | Train Loss: 0.163 Vali Loss: 10.904 Vali Acc: 0.086 Test Loss: 10.904 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0256780
	speed: 0.6430s/iter; left time: 9431.7414s
	iters: 200, epoch: 30 | loss: 0.0534972
	speed: 0.2908s/iter; left time: 4236.2415s
Epoch: 30 cost time: 58.89892649650574
Epoch: 30, Steps: 208 | Train Loss: 0.166 Vali Loss: 10.864 Vali Acc: 0.083 Test Loss: 10.864 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.1699735
	speed: 0.6559s/iter; left time: 9484.9353s
	iters: 200, epoch: 31 | loss: 0.0523731
	speed: 0.2871s/iter; left time: 4123.3690s
Epoch: 31 cost time: 60.30318593978882
Epoch: 31, Steps: 208 | Train Loss: 0.136 Vali Loss: 10.574 Vali Acc: 0.090 Test Loss: 10.574 Test Acc: 0.090
Validation loss decreased (-0.087877 --> -0.089963).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.3594199
	speed: 0.6649s/iter; left time: 9476.2053s
	iters: 200, epoch: 32 | loss: 0.0569984
	speed: 0.2683s/iter; left time: 3797.5410s
Epoch: 32 cost time: 58.46468472480774
Epoch: 32, Steps: 208 | Train Loss: 0.128 Vali Loss: 11.005 Vali Acc: 0.085 Test Loss: 11.005 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.3647531
	speed: 0.6491s/iter; left time: 9116.9692s
	iters: 200, epoch: 33 | loss: 0.0528243
	speed: 0.2876s/iter; left time: 4010.3851s
Epoch: 33 cost time: 59.16486215591431
Epoch: 33, Steps: 208 | Train Loss: 0.121 Vali Loss: 11.151 Vali Acc: 0.084 Test Loss: 11.151 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.2940852
	speed: 0.6957s/iter; left time: 9625.8050s
	iters: 200, epoch: 34 | loss: 0.0027054
	speed: 0.2955s/iter; left time: 4059.3048s
Epoch: 34 cost time: 63.01257920265198
Epoch: 34, Steps: 208 | Train Loss: 0.110 Vali Loss: 11.724 Vali Acc: 0.089 Test Loss: 11.724 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.1396906
	speed: 0.6784s/iter; left time: 9245.4396s
	iters: 200, epoch: 35 | loss: 0.0048028
	speed: 0.2807s/iter; left time: 3797.4569s
Epoch: 35 cost time: 60.13504481315613
Epoch: 35, Steps: 208 | Train Loss: 0.137 Vali Loss: 11.346 Vali Acc: 0.086 Test Loss: 11.346 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0983546
	speed: 0.6815s/iter; left time: 9146.0127s
	iters: 200, epoch: 36 | loss: 0.0306072
	speed: 0.2989s/iter; left time: 3982.1041s
Epoch: 36 cost time: 62.68870544433594
Epoch: 36, Steps: 208 | Train Loss: 0.105 Vali Loss: 11.577 Vali Acc: 0.092 Test Loss: 11.577 Test Acc: 0.092
Validation loss decreased (-0.089963 --> -0.092339).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.1714618
	speed: 0.6799s/iter; left time: 8983.3969s
	iters: 200, epoch: 37 | loss: 0.0247539
	speed: 0.2961s/iter; left time: 3882.6220s
Epoch: 37 cost time: 61.60598921775818
Epoch: 37, Steps: 208 | Train Loss: 0.103 Vali Loss: 11.937 Vali Acc: 0.090 Test Loss: 11.937 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0328304
	speed: 0.6887s/iter; left time: 8956.4400s
	iters: 200, epoch: 38 | loss: 0.1318385
	speed: 0.2981s/iter; left time: 3846.3371s
Epoch: 38 cost time: 61.22529363632202
Epoch: 38, Steps: 208 | Train Loss: 0.138 Vali Loss: 11.970 Vali Acc: 0.074 Test Loss: 11.970 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.3044833
	speed: 0.6792s/iter; left time: 8691.8300s
	iters: 200, epoch: 39 | loss: 0.0645727
	speed: 0.2987s/iter; left time: 3792.5582s
Epoch: 39 cost time: 63.27804398536682
Epoch: 39, Steps: 208 | Train Loss: 0.147 Vali Loss: 11.366 Vali Acc: 0.089 Test Loss: 11.366 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0200793
	speed: 0.6595s/iter; left time: 8302.5679s
	iters: 200, epoch: 40 | loss: 0.0074841
	speed: 0.2813s/iter; left time: 3512.6944s
Epoch: 40 cost time: 59.92864441871643
Epoch: 40, Steps: 208 | Train Loss: 0.112 Vali Loss: 11.761 Vali Acc: 0.086 Test Loss: 11.761 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0944694
	speed: 0.6489s/iter; left time: 8034.4201s
	iters: 200, epoch: 41 | loss: 0.0227517
	speed: 0.3115s/iter; left time: 3825.1700s
Epoch: 41 cost time: 60.776949405670166
Epoch: 41, Steps: 208 | Train Loss: 0.127 Vali Loss: 11.559 Vali Acc: 0.092 Test Loss: 11.559 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0121363
	speed: 0.6912s/iter; left time: 8414.2651s
	iters: 200, epoch: 42 | loss: 0.3569584
	speed: 0.3093s/iter; left time: 3734.4004s
Epoch: 42 cost time: 64.04812788963318
Epoch: 42, Steps: 208 | Train Loss: 0.133 Vali Loss: 11.813 Vali Acc: 0.084 Test Loss: 11.813 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0052486
	speed: 0.6806s/iter; left time: 8143.9661s
	iters: 200, epoch: 43 | loss: 0.0018951
	speed: 0.2663s/iter; left time: 3159.0899s
Epoch: 43 cost time: 60.27760457992554
Epoch: 43, Steps: 208 | Train Loss: 0.116 Vali Loss: 11.764 Vali Acc: 0.089 Test Loss: 11.764 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0030578
	speed: 0.6767s/iter; left time: 7955.7340s
	iters: 200, epoch: 44 | loss: 0.0000855
	speed: 0.3054s/iter; left time: 3560.2990s
Epoch: 44 cost time: 62.843374252319336
Epoch: 44, Steps: 208 | Train Loss: 0.086 Vali Loss: 12.327 Vali Acc: 0.089 Test Loss: 12.327 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0836794
	speed: 0.6507s/iter; left time: 7515.1750s
	iters: 200, epoch: 45 | loss: 0.1678557
	speed: 0.2884s/iter; left time: 3302.1107s
Epoch: 45 cost time: 59.00747060775757
Epoch: 45, Steps: 208 | Train Loss: 0.104 Vali Loss: 11.594 Vali Acc: 0.083 Test Loss: 11.594 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0021581
	speed: 0.6273s/iter; left time: 7114.1003s
	iters: 200, epoch: 46 | loss: 0.0211144
	speed: 0.2742s/iter; left time: 3081.9616s
Epoch: 46 cost time: 58.44562315940857
Epoch: 46, Steps: 208 | Train Loss: 0.094 Vali Loss: 12.318 Vali Acc: 0.086 Test Loss: 12.318 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09245451834178348
model parameter : 1497191
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5213156
	speed: 0.2982s/iter; left time: 6172.4345s
	iters: 200, epoch: 1 | loss: 3.0731947
	speed: 0.2667s/iter; left time: 5493.4249s
Epoch: 1 cost time: 59.05859065055847
Epoch: 1, Steps: 208 | Train Loss: 3.675 Vali Loss: 3.607 Vali Acc: 0.084 Test Loss: 3.607 Test Acc: 0.084
Validation loss decreased (inf --> -0.084366).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3478503
	speed: 0.6554s/iter; left time: 13430.6031s
	iters: 200, epoch: 2 | loss: 2.5650146
	speed: 0.2759s/iter; left time: 5626.7203s
Epoch: 2 cost time: 58.719236850738525
Epoch: 2, Steps: 208 | Train Loss: 3.094 Vali Loss: 3.555 Vali Acc: 0.080 Test Loss: 3.555 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9439747
	speed: 0.6427s/iter; left time: 13037.3952s
	iters: 200, epoch: 3 | loss: 3.0944867
	speed: 0.2871s/iter; left time: 5794.3777s
Epoch: 3 cost time: 57.598464012145996
Epoch: 3, Steps: 208 | Train Loss: 2.518 Vali Loss: 4.040 Vali Acc: 0.088 Test Loss: 4.040 Test Acc: 0.088
Validation loss decreased (-0.084366 --> -0.087642).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2345475
	speed: 0.6306s/iter; left time: 12659.9801s
	iters: 200, epoch: 4 | loss: 1.9172353
	speed: 0.2736s/iter; left time: 5466.6476s
Epoch: 4 cost time: 57.235931396484375
Epoch: 4, Steps: 208 | Train Loss: 1.964 Vali Loss: 4.457 Vali Acc: 0.088 Test Loss: 4.457 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9055921
	speed: 0.6528s/iter; left time: 12970.9689s
	iters: 200, epoch: 5 | loss: 2.1162181
	speed: 0.2719s/iter; left time: 5375.4068s
Epoch: 5 cost time: 58.25760078430176
Epoch: 5, Steps: 208 | Train Loss: 1.382 Vali Loss: 5.028 Vali Acc: 0.098 Test Loss: 5.028 Test Acc: 0.098
Validation loss decreased (-0.087642 --> -0.097474).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2013233
	speed: 0.6574s/iter; left time: 12925.0091s
	iters: 200, epoch: 6 | loss: 0.5764599
	speed: 0.2789s/iter; left time: 5455.2822s
Epoch: 6 cost time: 57.26365637779236
Epoch: 6, Steps: 208 | Train Loss: 0.961 Vali Loss: 5.682 Vali Acc: 0.094 Test Loss: 5.682 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1724057
	speed: 0.6400s/iter; left time: 12450.0343s
	iters: 200, epoch: 7 | loss: 0.4265592
	speed: 0.2680s/iter; left time: 5187.4507s
Epoch: 7 cost time: 57.566224813461304
Epoch: 7, Steps: 208 | Train Loss: 0.744 Vali Loss: 6.398 Vali Acc: 0.092 Test Loss: 6.398 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7760065
	speed: 0.6511s/iter; left time: 12529.4678s
	iters: 200, epoch: 8 | loss: 0.4187434
	speed: 0.2995s/iter; left time: 5733.7859s
Epoch: 8 cost time: 60.428043842315674
Epoch: 8, Steps: 208 | Train Loss: 0.584 Vali Loss: 6.944 Vali Acc: 0.099 Test Loss: 6.944 Test Acc: 0.099
Validation loss decreased (-0.097474 --> -0.098946).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1442926
	speed: 0.6846s/iter; left time: 13032.8929s
	iters: 200, epoch: 9 | loss: 0.3519892
	speed: 0.3025s/iter; left time: 5729.3506s
Epoch: 9 cost time: 62.20079779624939
Epoch: 9, Steps: 208 | Train Loss: 0.480 Vali Loss: 7.193 Vali Acc: 0.088 Test Loss: 7.193 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5508390
	speed: 0.6882s/iter; left time: 12958.7961s
	iters: 200, epoch: 10 | loss: 0.7543893
	speed: 0.2813s/iter; left time: 5269.0028s
Epoch: 10 cost time: 60.8994402885437
Epoch: 10, Steps: 208 | Train Loss: 0.436 Vali Loss: 7.878 Vali Acc: 0.093 Test Loss: 7.878 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3586470
	speed: 0.6709s/iter; left time: 12492.4810s
	iters: 200, epoch: 11 | loss: 0.5916411
	speed: 0.2783s/iter; left time: 5154.4975s
Epoch: 11 cost time: 59.64174199104309
Epoch: 11, Steps: 208 | Train Loss: 0.364 Vali Loss: 8.153 Vali Acc: 0.088 Test Loss: 8.153 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1176616
	speed: 0.6526s/iter; left time: 12016.5403s
	iters: 200, epoch: 12 | loss: 0.1327862
	speed: 0.2875s/iter; left time: 5265.5231s
Epoch: 12 cost time: 59.86687350273132
Epoch: 12, Steps: 208 | Train Loss: 0.336 Vali Loss: 8.910 Vali Acc: 0.097 Test Loss: 8.910 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1773365
	speed: 0.6521s/iter; left time: 11870.9604s
	iters: 200, epoch: 13 | loss: 0.5535417
	speed: 0.2802s/iter; left time: 5072.4590s
Epoch: 13 cost time: 58.44897198677063
Epoch: 13, Steps: 208 | Train Loss: 0.238 Vali Loss: 9.308 Vali Acc: 0.089 Test Loss: 9.308 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6286915
	speed: 0.6403s/iter; left time: 11522.7756s
	iters: 200, epoch: 14 | loss: 0.0763060
	speed: 0.2826s/iter; left time: 5057.7483s
Epoch: 14 cost time: 57.16631889343262
Epoch: 14, Steps: 208 | Train Loss: 0.225 Vali Loss: 9.488 Vali Acc: 0.093 Test Loss: 9.488 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.7410671
	speed: 0.6468s/iter; left time: 11505.3443s
	iters: 200, epoch: 15 | loss: 0.2043112
	speed: 0.2777s/iter; left time: 4911.8788s
Epoch: 15 cost time: 57.764899492263794
Epoch: 15, Steps: 208 | Train Loss: 0.205 Vali Loss: 9.845 Vali Acc: 0.085 Test Loss: 9.845 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0840851
	speed: 0.6537s/iter; left time: 11492.3512s
	iters: 200, epoch: 16 | loss: 0.7443613
	speed: 0.2782s/iter; left time: 4863.7866s
Epoch: 16 cost time: 58.7352135181427
Epoch: 16, Steps: 208 | Train Loss: 0.207 Vali Loss: 10.154 Vali Acc: 0.094 Test Loss: 10.154 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.4024505
	speed: 0.6920s/iter; left time: 12022.9740s
	iters: 200, epoch: 17 | loss: 0.0455696
	speed: 0.2785s/iter; left time: 4810.6889s
Epoch: 17 cost time: 60.53707551956177
Epoch: 17, Steps: 208 | Train Loss: 0.192 Vali Loss: 10.317 Vali Acc: 0.091 Test Loss: 10.317 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0514618
	speed: 0.6127s/iter; left time: 10517.7798s
	iters: 200, epoch: 18 | loss: 0.0462005
	speed: 0.2813s/iter; left time: 4800.6397s
Epoch: 18 cost time: 56.92471766471863
Epoch: 18, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.683 Vali Acc: 0.092 Test Loss: 10.683 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09901580674023262
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4519110
	speed: 0.2947s/iter; left time: 6099.6754s
	iters: 200, epoch: 1 | loss: 3.1174827
	speed: 0.2662s/iter; left time: 5484.8618s
Epoch: 1 cost time: 58.636704206466675
Epoch: 1, Steps: 208 | Train Loss: 3.676 Vali Loss: 3.614 Vali Acc: 0.081 Test Loss: 3.614 Test Acc: 0.081
Validation loss decreased (inf --> -0.081085).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1215224
	speed: 0.6533s/iter; left time: 13387.7962s
	iters: 200, epoch: 2 | loss: 2.7404320
	speed: 0.2658s/iter; left time: 5419.4636s
Epoch: 2 cost time: 56.68990612030029
Epoch: 2, Steps: 208 | Train Loss: 3.085 Vali Loss: 3.566 Vali Acc: 0.091 Test Loss: 3.566 Test Acc: 0.091
Validation loss decreased (-0.081085 --> -0.091226).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1948535
	speed: 0.6629s/iter; left time: 13446.5438s
	iters: 200, epoch: 3 | loss: 2.9632423
	speed: 0.2766s/iter; left time: 5583.7283s
Epoch: 3 cost time: 57.42601466178894
Epoch: 3, Steps: 208 | Train Loss: 2.506 Vali Loss: 3.984 Vali Acc: 0.092 Test Loss: 3.984 Test Acc: 0.092
Validation loss decreased (-0.091226 --> -0.091520).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4093295
	speed: 0.6650s/iter; left time: 13350.6076s
	iters: 200, epoch: 4 | loss: 1.6891906
	speed: 0.2741s/iter; left time: 5474.7028s
Epoch: 4 cost time: 58.01811695098877
Epoch: 4, Steps: 208 | Train Loss: 1.947 Vali Loss: 4.551 Vali Acc: 0.092 Test Loss: 4.551 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1254945
	speed: 0.6504s/iter; left time: 12921.8262s
	iters: 200, epoch: 5 | loss: 1.9989915
	speed: 0.2937s/iter; left time: 5805.7207s
Epoch: 5 cost time: 59.88177418708801
Epoch: 5, Steps: 208 | Train Loss: 1.368 Vali Loss: 5.029 Vali Acc: 0.096 Test Loss: 5.029 Test Acc: 0.096
Validation loss decreased (-0.091520 --> -0.095685).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3278968
	speed: 0.6602s/iter; left time: 12979.6881s
	iters: 200, epoch: 6 | loss: 0.6587577
	speed: 0.3021s/iter; left time: 5909.0957s
Epoch: 6 cost time: 61.14186096191406
Epoch: 6, Steps: 208 | Train Loss: 0.974 Vali Loss: 5.913 Vali Acc: 0.098 Test Loss: 5.913 Test Acc: 0.098
Validation loss decreased (-0.095685 --> -0.098360).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4530734
	speed: 0.6636s/iter; left time: 12909.4371s
	iters: 200, epoch: 7 | loss: 0.4088317
	speed: 0.2869s/iter; left time: 5551.7530s
Epoch: 7 cost time: 59.771634101867676
Epoch: 7, Steps: 208 | Train Loss: 0.728 Vali Loss: 6.441 Vali Acc: 0.089 Test Loss: 6.441 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1640957
	speed: 0.6438s/iter; left time: 12390.4497s
	iters: 200, epoch: 8 | loss: 0.9256470
	speed: 0.2735s/iter; left time: 5235.7532s
Epoch: 8 cost time: 58.309930086135864
Epoch: 8, Steps: 208 | Train Loss: 0.587 Vali Loss: 6.993 Vali Acc: 0.093 Test Loss: 6.993 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1131546
	speed: 0.6408s/iter; left time: 12198.0488s
	iters: 200, epoch: 9 | loss: 0.3596668
	speed: 0.2778s/iter; left time: 5260.6408s
Epoch: 9 cost time: 59.047099113464355
Epoch: 9, Steps: 208 | Train Loss: 0.462 Vali Loss: 7.716 Vali Acc: 0.086 Test Loss: 7.716 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1026028
	speed: 0.6799s/iter; left time: 12802.0375s
	iters: 200, epoch: 10 | loss: 0.6605648
	speed: 0.2866s/iter; left time: 5367.4593s
Epoch: 10 cost time: 61.707698583602905
Epoch: 10, Steps: 208 | Train Loss: 0.425 Vali Loss: 7.754 Vali Acc: 0.090 Test Loss: 7.754 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2741804
	speed: 0.6653s/iter; left time: 12388.2210s
	iters: 200, epoch: 11 | loss: 0.3440602
	speed: 0.2766s/iter; left time: 5122.9628s
Epoch: 11 cost time: 59.40379858016968
Epoch: 11, Steps: 208 | Train Loss: 0.374 Vali Loss: 7.819 Vali Acc: 0.089 Test Loss: 7.819 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1349472
	speed: 0.6606s/iter; left time: 12164.4992s
	iters: 200, epoch: 12 | loss: 0.0426170
	speed: 0.2617s/iter; left time: 4791.6392s
Epoch: 12 cost time: 57.119216203689575
Epoch: 12, Steps: 208 | Train Loss: 0.325 Vali Loss: 8.588 Vali Acc: 0.095 Test Loss: 8.588 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0655573
	speed: 0.6757s/iter; left time: 12300.3923s
	iters: 200, epoch: 13 | loss: 0.2127118
	speed: 0.2749s/iter; left time: 4977.1083s
Epoch: 13 cost time: 59.32609295845032
Epoch: 13, Steps: 208 | Train Loss: 0.245 Vali Loss: 8.806 Vali Acc: 0.087 Test Loss: 8.806 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3996723
	speed: 0.6754s/iter; left time: 12155.6011s
	iters: 200, epoch: 14 | loss: 0.4012453
	speed: 0.2836s/iter; left time: 5075.5455s
Epoch: 14 cost time: 59.43078899383545
Epoch: 14, Steps: 208 | Train Loss: 0.218 Vali Loss: 9.331 Vali Acc: 0.087 Test Loss: 9.331 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7401742
	speed: 0.6477s/iter; left time: 11522.2340s
	iters: 200, epoch: 15 | loss: 0.0295490
	speed: 0.2818s/iter; left time: 4984.4355s
Epoch: 15 cost time: 58.319560050964355
Epoch: 15, Steps: 208 | Train Loss: 0.204 Vali Loss: 10.131 Vali Acc: 0.084 Test Loss: 10.131 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.6226581
	speed: 0.6480s/iter; left time: 11391.9959s
	iters: 200, epoch: 16 | loss: 0.7940744
	speed: 0.2947s/iter; left time: 5151.0298s
Epoch: 16 cost time: 59.37755990028381
Epoch: 16, Steps: 208 | Train Loss: 0.187 Vali Loss: 10.035 Vali Acc: 0.096 Test Loss: 10.035 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09841932597673725
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3907294
	speed: 0.3014s/iter; left time: 6239.5387s
	iters: 200, epoch: 1 | loss: 3.1585226
	speed: 0.2656s/iter; left time: 5470.9537s
Epoch: 1 cost time: 59.12478065490723
Epoch: 1, Steps: 208 | Train Loss: 3.670 Vali Loss: 3.594 Vali Acc: 0.078 Test Loss: 3.594 Test Acc: 0.078
Validation loss decreased (inf --> -0.078401).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1736033
	speed: 0.6424s/iter; left time: 13164.8243s
	iters: 200, epoch: 2 | loss: 2.5766306
	speed: 0.2669s/iter; left time: 5443.5457s
Epoch: 2 cost time: 56.64044141769409
Epoch: 2, Steps: 208 | Train Loss: 3.101 Vali Loss: 3.538 Vali Acc: 0.091 Test Loss: 3.538 Test Acc: 0.091
Validation loss decreased (-0.078401 --> -0.091226).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2758894
	speed: 0.6359s/iter; left time: 12898.7522s
	iters: 200, epoch: 3 | loss: 2.9480302
	speed: 0.2673s/iter; left time: 5395.3035s
Epoch: 3 cost time: 56.528058767318726
Epoch: 3, Steps: 208 | Train Loss: 2.521 Vali Loss: 4.030 Vali Acc: 0.092 Test Loss: 4.030 Test Acc: 0.092
Validation loss decreased (-0.091226 --> -0.091818).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8431674
	speed: 0.6366s/iter; left time: 12780.5705s
	iters: 200, epoch: 4 | loss: 1.6100864
	speed: 0.2717s/iter; left time: 5427.7866s
Epoch: 4 cost time: 56.995620250701904
Epoch: 4, Steps: 208 | Train Loss: 1.955 Vali Loss: 4.537 Vali Acc: 0.087 Test Loss: 4.537 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5683087
	speed: 0.6436s/iter; left time: 12787.2847s
	iters: 200, epoch: 5 | loss: 1.9176563
	speed: 0.2801s/iter; left time: 5536.3444s
Epoch: 5 cost time: 58.10460448265076
Epoch: 5, Steps: 208 | Train Loss: 1.423 Vali Loss: 4.833 Vali Acc: 0.104 Test Loss: 4.833 Test Acc: 0.104
Validation loss decreased (-0.091818 --> -0.104336).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5929559
	speed: 0.6428s/iter; left time: 12638.5988s
	iters: 200, epoch: 6 | loss: 0.8773419
	speed: 0.2655s/iter; left time: 5194.1789s
Epoch: 6 cost time: 55.56877064704895
Epoch: 6, Steps: 208 | Train Loss: 0.981 Vali Loss: 5.690 Vali Acc: 0.098 Test Loss: 5.690 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5450384
	speed: 0.6296s/iter; left time: 12246.7877s
	iters: 200, epoch: 7 | loss: 0.6286813
	speed: 0.2606s/iter; left time: 5042.4279s
Epoch: 7 cost time: 55.3183753490448
Epoch: 7, Steps: 208 | Train Loss: 0.757 Vali Loss: 6.421 Vali Acc: 0.094 Test Loss: 6.421 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7109795
	speed: 0.6242s/iter; left time: 12012.5436s
	iters: 200, epoch: 8 | loss: 0.7709766
	speed: 0.2762s/iter; left time: 5288.3998s
Epoch: 8 cost time: 56.07551097869873
Epoch: 8, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.906 Vali Acc: 0.098 Test Loss: 6.906 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5224499
	speed: 0.6491s/iter; left time: 12357.3472s
	iters: 200, epoch: 9 | loss: 0.1824179
	speed: 0.2731s/iter; left time: 5171.6657s
Epoch: 9 cost time: 57.52425575256348
Epoch: 9, Steps: 208 | Train Loss: 0.494 Vali Loss: 7.140 Vali Acc: 0.082 Test Loss: 7.140 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0518185
	speed: 0.6456s/iter; left time: 12155.4779s
	iters: 200, epoch: 10 | loss: 1.0388618
	speed: 0.2892s/iter; left time: 5415.8540s
Epoch: 10 cost time: 59.3657283782959
Epoch: 10, Steps: 208 | Train Loss: 0.426 Vali Loss: 7.702 Vali Acc: 0.093 Test Loss: 7.702 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1395305
	speed: 0.6540s/iter; left time: 12178.5830s
	iters: 200, epoch: 11 | loss: 0.4186181
	speed: 0.2483s/iter; left time: 4598.7038s
Epoch: 11 cost time: 55.25666522979736
Epoch: 11, Steps: 208 | Train Loss: 0.357 Vali Loss: 8.121 Vali Acc: 0.087 Test Loss: 8.121 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1470891
	speed: 0.6155s/iter; left time: 11333.3441s
	iters: 200, epoch: 12 | loss: 0.6707257
	speed: 0.2829s/iter; left time: 5181.1588s
Epoch: 12 cost time: 55.497514486312866
Epoch: 12, Steps: 208 | Train Loss: 0.315 Vali Loss: 8.641 Vali Acc: 0.089 Test Loss: 8.641 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1253327
	speed: 0.6475s/iter; left time: 11787.6279s
	iters: 200, epoch: 13 | loss: 0.9361917
	speed: 0.2758s/iter; left time: 4993.7442s
Epoch: 13 cost time: 58.1028037071228
Epoch: 13, Steps: 208 | Train Loss: 0.252 Vali Loss: 8.900 Vali Acc: 0.084 Test Loss: 8.900 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.5466602
	speed: 0.6484s/iter; left time: 11668.7003s
	iters: 200, epoch: 14 | loss: 0.1340112
	speed: 0.2557s/iter; left time: 4576.0301s
Epoch: 14 cost time: 56.526509523391724
Epoch: 14, Steps: 208 | Train Loss: 0.247 Vali Loss: 8.909 Vali Acc: 0.084 Test Loss: 8.909 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.7876880
	speed: 0.6185s/iter; left time: 11003.0873s
	iters: 200, epoch: 15 | loss: 0.3674277
	speed: 0.2437s/iter; left time: 4311.1393s
Epoch: 15 cost time: 52.376683712005615
Epoch: 15, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.427 Vali Acc: 0.084 Test Loss: 9.427 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10438413361169102
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4778807
	speed: 0.2868s/iter; left time: 5936.7031s
	iters: 200, epoch: 1 | loss: 3.1278112
	speed: 0.2690s/iter; left time: 5542.3901s
Epoch: 1 cost time: 58.13180756568909
Epoch: 1, Steps: 208 | Train Loss: 3.679 Vali Loss: 3.587 Vali Acc: 0.083 Test Loss: 3.587 Test Acc: 0.083
Validation loss decreased (inf --> -0.082577).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2514811
	speed: 0.6578s/iter; left time: 13480.5371s
	iters: 200, epoch: 2 | loss: 2.5654948
	speed: 0.2648s/iter; left time: 5399.8845s
Epoch: 2 cost time: 57.46099090576172
Epoch: 2, Steps: 208 | Train Loss: 3.104 Vali Loss: 3.569 Vali Acc: 0.093 Test Loss: 3.569 Test Acc: 0.093
Validation loss decreased (-0.082577 --> -0.093314).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1663690
	speed: 0.6372s/iter; left time: 12925.0819s
	iters: 200, epoch: 3 | loss: 3.0766995
	speed: 0.2750s/iter; left time: 5550.1307s
Epoch: 3 cost time: 56.42549777030945
Epoch: 3, Steps: 208 | Train Loss: 2.488 Vali Loss: 3.994 Vali Acc: 0.096 Test Loss: 3.994 Test Acc: 0.096
Validation loss decreased (-0.093314 --> -0.096292).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3100212
	speed: 0.6261s/iter; left time: 12570.2958s
	iters: 200, epoch: 4 | loss: 1.7415017
	speed: 0.2725s/iter; left time: 5442.8875s
Epoch: 4 cost time: 56.11883091926575
Epoch: 4, Steps: 208 | Train Loss: 1.924 Vali Loss: 4.361 Vali Acc: 0.101 Test Loss: 4.361 Test Acc: 0.101
Validation loss decreased (-0.096292 --> -0.101358).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9700663
	speed: 0.6170s/iter; left time: 12259.2750s
	iters: 200, epoch: 5 | loss: 2.0942550
	speed: 0.2644s/iter; left time: 5226.6902s
Epoch: 5 cost time: 57.82439160346985
Epoch: 5, Steps: 208 | Train Loss: 1.362 Vali Loss: 4.818 Vali Acc: 0.100 Test Loss: 4.818 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0469947
	speed: 0.6560s/iter; left time: 12898.2665s
	iters: 200, epoch: 6 | loss: 0.5763667
	speed: 0.2763s/iter; left time: 5405.3516s
Epoch: 6 cost time: 58.02679467201233
Epoch: 6, Steps: 208 | Train Loss: 0.949 Vali Loss: 5.531 Vali Acc: 0.095 Test Loss: 5.531 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1421679
	speed: 0.6636s/iter; left time: 12908.6698s
	iters: 200, epoch: 7 | loss: 0.7485864
	speed: 0.2774s/iter; left time: 5367.8701s
Epoch: 7 cost time: 57.95234799385071
Epoch: 7, Steps: 208 | Train Loss: 0.732 Vali Loss: 6.286 Vali Acc: 0.097 Test Loss: 6.286 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4244719
	speed: 0.6233s/iter; left time: 11994.4670s
	iters: 200, epoch: 8 | loss: 0.7696403
	speed: 0.2757s/iter; left time: 5278.5663s
Epoch: 8 cost time: 57.77015256881714
Epoch: 8, Steps: 208 | Train Loss: 0.572 Vali Loss: 6.842 Vali Acc: 0.102 Test Loss: 6.842 Test Acc: 0.102
Validation loss decreased (-0.101358 --> -0.102228).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3569372
	speed: 0.6266s/iter; left time: 11928.4063s
	iters: 200, epoch: 9 | loss: 0.5092157
	speed: 0.2605s/iter; left time: 4932.6594s
Epoch: 9 cost time: 55.43498659133911
Epoch: 9, Steps: 208 | Train Loss: 0.507 Vali Loss: 7.137 Vali Acc: 0.088 Test Loss: 7.137 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2024650
	speed: 0.6502s/iter; left time: 12241.7006s
	iters: 200, epoch: 10 | loss: 0.9081787
	speed: 0.2844s/iter; left time: 5326.3059s
Epoch: 10 cost time: 57.8004105091095
Epoch: 10, Steps: 208 | Train Loss: 0.421 Vali Loss: 7.778 Vali Acc: 0.096 Test Loss: 7.778 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3642797
	speed: 0.6504s/iter; left time: 12111.6039s
	iters: 200, epoch: 11 | loss: 0.3874255
	speed: 0.2811s/iter; left time: 5206.5636s
Epoch: 11 cost time: 59.380502223968506
Epoch: 11, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.128 Vali Acc: 0.093 Test Loss: 8.128 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1104917
	speed: 0.6271s/iter; left time: 11547.2792s
	iters: 200, epoch: 12 | loss: 0.7384698
	speed: 0.2645s/iter; left time: 4844.0982s
Epoch: 12 cost time: 56.099674224853516
Epoch: 12, Steps: 208 | Train Loss: 0.307 Vali Loss: 8.737 Vali Acc: 0.090 Test Loss: 8.737 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2404763
	speed: 0.6563s/iter; left time: 11947.2038s
	iters: 200, epoch: 13 | loss: 0.3131497
	speed: 0.2753s/iter; left time: 4984.2998s
Epoch: 13 cost time: 57.46044135093689
Epoch: 13, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.978 Vali Acc: 0.096 Test Loss: 8.978 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5448499
	speed: 0.6746s/iter; left time: 12140.3458s
	iters: 200, epoch: 14 | loss: 0.2410871
	speed: 0.2928s/iter; left time: 5240.6782s
Epoch: 14 cost time: 60.979235887527466
Epoch: 14, Steps: 208 | Train Loss: 0.246 Vali Loss: 9.310 Vali Acc: 0.087 Test Loss: 9.310 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1475832
	speed: 0.6939s/iter; left time: 12343.7921s
	iters: 200, epoch: 15 | loss: 0.0581725
	speed: 0.2680s/iter; left time: 4741.4977s
Epoch: 15 cost time: 59.16056966781616
Epoch: 15, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.320 Vali Acc: 0.092 Test Loss: 9.320 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3050887
	speed: 0.6688s/iter; left time: 11758.6891s
	iters: 200, epoch: 16 | loss: 0.0868257
	speed: 0.2915s/iter; left time: 5096.5659s
Epoch: 16 cost time: 59.863661766052246
Epoch: 16, Steps: 208 | Train Loss: 0.207 Vali Loss: 10.029 Vali Acc: 0.098 Test Loss: 10.029 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0084878
	speed: 0.6579s/iter; left time: 11430.3126s
	iters: 200, epoch: 17 | loss: 0.1824233
	speed: 0.2948s/iter; left time: 5092.3211s
Epoch: 17 cost time: 60.99285435676575
Epoch: 17, Steps: 208 | Train Loss: 0.213 Vali Loss: 9.895 Vali Acc: 0.091 Test Loss: 9.895 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0158391
	speed: 0.6942s/iter; left time: 11915.9907s
	iters: 200, epoch: 18 | loss: 0.1167039
	speed: 0.2946s/iter; left time: 5027.2697s
Epoch: 18 cost time: 61.22523498535156
Epoch: 18, Steps: 208 | Train Loss: 0.154 Vali Loss: 10.496 Vali Acc: 0.086 Test Loss: 10.496 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1022964509394572
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3472903
	speed: 0.2843s/iter; left time: 5885.1506s
	iters: 200, epoch: 1 | loss: 3.2702215
	speed: 0.2821s/iter; left time: 5811.7674s
Epoch: 1 cost time: 58.9038770198822
Epoch: 1, Steps: 208 | Train Loss: 3.650 Vali Loss: 3.709 Vali Acc: 0.066 Test Loss: 3.709 Test Acc: 0.066
Validation loss decreased (inf --> -0.065576).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0103374
	speed: 0.6287s/iter; left time: 12884.6993s
	iters: 200, epoch: 2 | loss: 2.9888771
	speed: 0.2701s/iter; left time: 5509.0694s
Epoch: 2 cost time: 57.52957487106323
Epoch: 2, Steps: 208 | Train Loss: 3.098 Vali Loss: 3.720 Vali Acc: 0.081 Test Loss: 3.720 Test Acc: 0.081
Validation loss decreased (-0.065576 --> -0.080786).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2348251
	speed: 0.6634s/iter; left time: 13456.3839s
	iters: 200, epoch: 3 | loss: 3.0954239
	speed: 0.2760s/iter; left time: 5571.1456s
Epoch: 3 cost time: 58.770134925842285
Epoch: 3, Steps: 208 | Train Loss: 2.515 Vali Loss: 4.023 Vali Acc: 0.089 Test Loss: 4.023 Test Acc: 0.089
Validation loss decreased (-0.080786 --> -0.088835).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2452466
	speed: 0.6502s/iter; left time: 13054.6361s
	iters: 200, epoch: 4 | loss: 1.7519109
	speed: 0.2834s/iter; left time: 5660.5661s
Epoch: 4 cost time: 58.09187602996826
Epoch: 4, Steps: 208 | Train Loss: 1.977 Vali Loss: 4.491 Vali Acc: 0.096 Test Loss: 4.491 Test Acc: 0.096
Validation loss decreased (-0.088835 --> -0.095690).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5876324
	speed: 0.6407s/iter; left time: 12730.2970s
	iters: 200, epoch: 5 | loss: 1.7430596
	speed: 0.2759s/iter; left time: 5453.7921s
Epoch: 5 cost time: 58.84446930885315
Epoch: 5, Steps: 208 | Train Loss: 1.420 Vali Loss: 4.660 Vali Acc: 0.102 Test Loss: 4.660 Test Acc: 0.102
Validation loss decreased (-0.095690 --> -0.102250).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7647773
	speed: 0.6717s/iter; left time: 13205.9898s
	iters: 200, epoch: 6 | loss: 0.6691766
	speed: 0.2936s/iter; left time: 5743.3656s
Epoch: 6 cost time: 60.80125570297241
Epoch: 6, Steps: 208 | Train Loss: 1.007 Vali Loss: 5.706 Vali Acc: 0.095 Test Loss: 5.706 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1485746
	speed: 0.6460s/iter; left time: 12567.3393s
	iters: 200, epoch: 7 | loss: 0.8290437
	speed: 0.2769s/iter; left time: 5358.6542s
Epoch: 7 cost time: 57.97238373756409
Epoch: 7, Steps: 208 | Train Loss: 0.775 Vali Loss: 6.133 Vali Acc: 0.103 Test Loss: 6.133 Test Acc: 0.103
Validation loss decreased (-0.102250 --> -0.102533).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2915548
	speed: 0.6395s/iter; left time: 12307.9553s
	iters: 200, epoch: 8 | loss: 0.4250729
	speed: 0.2647s/iter; left time: 5068.3077s
Epoch: 8 cost time: 57.2561891078949
Epoch: 8, Steps: 208 | Train Loss: 0.599 Vali Loss: 6.416 Vali Acc: 0.105 Test Loss: 6.416 Test Acc: 0.105
Validation loss decreased (-0.102533 --> -0.104916).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7528290
	speed: 0.6587s/iter; left time: 12538.7671s
	iters: 200, epoch: 9 | loss: 0.6220137
	speed: 0.2829s/iter; left time: 5356.3407s
Epoch: 9 cost time: 58.52251124382019
Epoch: 9, Steps: 208 | Train Loss: 0.518 Vali Loss: 7.228 Vali Acc: 0.093 Test Loss: 7.228 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0536841
	speed: 0.6302s/iter; left time: 11866.2152s
	iters: 200, epoch: 10 | loss: 0.8495424
	speed: 0.2806s/iter; left time: 5255.7711s
Epoch: 10 cost time: 60.09139132499695
Epoch: 10, Steps: 208 | Train Loss: 0.440 Vali Loss: 7.470 Vali Acc: 0.107 Test Loss: 7.470 Test Acc: 0.107
Validation loss decreased (-0.104916 --> -0.106994).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2780647
	speed: 0.6590s/iter; left time: 12272.0041s
	iters: 200, epoch: 11 | loss: 0.6733724
	speed: 0.2922s/iter; left time: 5411.9791s
Epoch: 11 cost time: 59.4176025390625
Epoch: 11, Steps: 208 | Train Loss: 0.406 Vali Loss: 7.890 Vali Acc: 0.104 Test Loss: 7.890 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1710817
	speed: 0.6340s/iter; left time: 11673.1804s
	iters: 200, epoch: 12 | loss: 0.2061488
	speed: 0.2687s/iter; left time: 4921.1348s
Epoch: 12 cost time: 56.754661321640015
Epoch: 12, Steps: 208 | Train Loss: 0.323 Vali Loss: 8.248 Vali Acc: 0.095 Test Loss: 8.248 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0308933
	speed: 0.6522s/iter; left time: 11873.0542s
	iters: 200, epoch: 13 | loss: 0.2316298
	speed: 0.2883s/iter; left time: 5219.8145s
Epoch: 13 cost time: 61.13007378578186
Epoch: 13, Steps: 208 | Train Loss: 0.286 Vali Loss: 8.471 Vali Acc: 0.097 Test Loss: 8.471 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5822780
	speed: 0.6571s/iter; left time: 11826.3562s
	iters: 200, epoch: 14 | loss: 0.3652028
	speed: 0.2932s/iter; left time: 5247.8894s
Epoch: 14 cost time: 60.09505653381348
Epoch: 14, Steps: 208 | Train Loss: 0.233 Vali Loss: 8.625 Vali Acc: 0.091 Test Loss: 8.625 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.9382836
	speed: 0.6648s/iter; left time: 11826.8715s
	iters: 200, epoch: 15 | loss: 0.3614896
	speed: 0.2741s/iter; left time: 4848.6210s
Epoch: 15 cost time: 59.60104203224182
Epoch: 15, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.158 Vali Acc: 0.098 Test Loss: 9.158 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0203554
	speed: 0.6657s/iter; left time: 11703.2543s
	iters: 200, epoch: 16 | loss: 0.5838932
	speed: 0.2909s/iter; left time: 5084.5610s
Epoch: 16 cost time: 60.32695817947388
Epoch: 16, Steps: 208 | Train Loss: 0.201 Vali Loss: 9.716 Vali Acc: 0.104 Test Loss: 9.716 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1964878
	speed: 0.6349s/iter; left time: 11030.5061s
	iters: 200, epoch: 17 | loss: 0.0325068
	speed: 0.2767s/iter; left time: 4780.0727s
Epoch: 17 cost time: 58.978293657302856
Epoch: 17, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.851 Vali Acc: 0.095 Test Loss: 9.851 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0894560
	speed: 0.6573s/iter; left time: 11281.8917s
	iters: 200, epoch: 18 | loss: 0.0337185
	speed: 0.2678s/iter; left time: 4570.6079s
Epoch: 18 cost time: 57.82259154319763
Epoch: 18, Steps: 208 | Train Loss: 0.165 Vali Loss: 9.558 Vali Acc: 0.095 Test Loss: 9.558 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1561393
	speed: 0.6206s/iter; left time: 10523.5086s
	iters: 200, epoch: 19 | loss: 0.0408616
	speed: 0.2684s/iter; left time: 4524.8543s
Epoch: 19 cost time: 56.412107944488525
Epoch: 19, Steps: 208 | Train Loss: 0.183 Vali Loss: 10.057 Vali Acc: 0.089 Test Loss: 10.057 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1714503
	speed: 0.6320s/iter; left time: 10585.0619s
	iters: 200, epoch: 20 | loss: 0.0424934
	speed: 0.2800s/iter; left time: 4662.0091s
Epoch: 20 cost time: 57.20679998397827
Epoch: 20, Steps: 208 | Train Loss: 0.160 Vali Loss: 10.158 Vali Acc: 0.103 Test Loss: 10.158 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10706829704742023
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4761050
	speed: 0.2930s/iter; left time: 6065.7880s
	iters: 200, epoch: 1 | loss: 3.2982292
	speed: 0.2849s/iter; left time: 5869.1558s
Epoch: 1 cost time: 60.4620246887207
Epoch: 1, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.762 Vali Acc: 0.070 Test Loss: 3.762 Test Acc: 0.070
Validation loss decreased (inf --> -0.070049).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2952297
	speed: 0.6538s/iter; left time: 13398.2793s
	iters: 200, epoch: 2 | loss: 2.7242355
	speed: 0.2937s/iter; left time: 5990.4364s
Epoch: 2 cost time: 59.9014937877655
Epoch: 2, Steps: 208 | Train Loss: 3.029 Vali Loss: 3.808 Vali Acc: 0.087 Test Loss: 3.808 Test Acc: 0.087
Validation loss decreased (-0.070049 --> -0.087346).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4142640
	speed: 0.6410s/iter; left time: 13002.8445s
	iters: 200, epoch: 3 | loss: 3.3344972
	speed: 0.2774s/iter; left time: 5600.3041s
Epoch: 3 cost time: 57.90808963775635
Epoch: 3, Steps: 208 | Train Loss: 2.573 Vali Loss: 4.193 Vali Acc: 0.098 Test Loss: 4.193 Test Acc: 0.098
Validation loss decreased (-0.087346 --> -0.097781).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6540388
	speed: 0.6953s/iter; left time: 13958.5383s
	iters: 200, epoch: 4 | loss: 2.0705576
	speed: 0.3000s/iter; left time: 5993.6816s
Epoch: 4 cost time: 62.36063361167908
Epoch: 4, Steps: 208 | Train Loss: 2.103 Vali Loss: 4.451 Vali Acc: 0.106 Test Loss: 4.451 Test Acc: 0.106
Validation loss decreased (-0.097781 --> -0.106427).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9322805
	speed: 0.7041s/iter; left time: 13990.5844s
	iters: 200, epoch: 5 | loss: 2.0394380
	speed: 0.2851s/iter; left time: 5635.6281s
Epoch: 5 cost time: 61.505008935928345
Epoch: 5, Steps: 208 | Train Loss: 1.639 Vali Loss: 4.810 Vali Acc: 0.095 Test Loss: 4.810 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1736817
	speed: 0.6707s/iter; left time: 13186.5997s
	iters: 200, epoch: 6 | loss: 1.3515970
	speed: 0.2824s/iter; left time: 5524.0808s
Epoch: 6 cost time: 60.168662786483765
Epoch: 6, Steps: 208 | Train Loss: 1.240 Vali Loss: 5.323 Vali Acc: 0.098 Test Loss: 5.323 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1890066
	speed: 0.6546s/iter; left time: 12733.3385s
	iters: 200, epoch: 7 | loss: 1.0658532
	speed: 0.2901s/iter; left time: 5613.7766s
Epoch: 7 cost time: 60.68114638328552
Epoch: 7, Steps: 208 | Train Loss: 1.002 Vali Loss: 5.934 Vali Acc: 0.093 Test Loss: 5.934 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4242024
	speed: 0.6658s/iter; left time: 12813.8950s
	iters: 200, epoch: 8 | loss: 0.8645056
	speed: 0.2887s/iter; left time: 5527.0285s
Epoch: 8 cost time: 59.259613275527954
Epoch: 8, Steps: 208 | Train Loss: 0.813 Vali Loss: 6.167 Vali Acc: 0.095 Test Loss: 6.167 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5218071
	speed: 0.6566s/iter; left time: 12499.2877s
	iters: 200, epoch: 9 | loss: 0.7339212
	speed: 0.2653s/iter; left time: 5024.1880s
Epoch: 9 cost time: 58.35716962814331
Epoch: 9, Steps: 208 | Train Loss: 0.658 Vali Loss: 6.558 Vali Acc: 0.092 Test Loss: 6.558 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6953987
	speed: 0.6499s/iter; left time: 12237.8249s
	iters: 200, epoch: 10 | loss: 0.8653386
	speed: 0.2781s/iter; left time: 5208.8528s
Epoch: 10 cost time: 59.32290959358215
Epoch: 10, Steps: 208 | Train Loss: 0.604 Vali Loss: 7.117 Vali Acc: 0.098 Test Loss: 7.117 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7275486
	speed: 0.6608s/iter; left time: 12305.2543s
	iters: 200, epoch: 11 | loss: 1.1616777
	speed: 0.2896s/iter; left time: 5364.4479s
Epoch: 11 cost time: 59.969277143478394
Epoch: 11, Steps: 208 | Train Loss: 0.527 Vali Loss: 7.597 Vali Acc: 0.098 Test Loss: 7.597 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0741403
	speed: 0.6550s/iter; left time: 12060.0418s
	iters: 200, epoch: 12 | loss: 0.4327866
	speed: 0.2621s/iter; left time: 4799.1466s
Epoch: 12 cost time: 57.15328860282898
Epoch: 12, Steps: 208 | Train Loss: 0.448 Vali Loss: 7.453 Vali Acc: 0.102 Test Loss: 7.453 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1507508
	speed: 0.6586s/iter; left time: 11989.3025s
	iters: 200, epoch: 13 | loss: 0.5341669
	speed: 0.2699s/iter; left time: 4886.7094s
Epoch: 13 cost time: 57.8650016784668
Epoch: 13, Steps: 208 | Train Loss: 0.409 Vali Loss: 8.128 Vali Acc: 0.104 Test Loss: 8.128 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0510443
	speed: 0.6274s/iter; left time: 11291.2729s
	iters: 200, epoch: 14 | loss: 0.3324759
	speed: 0.2847s/iter; left time: 5095.7841s
Epoch: 14 cost time: 58.12511324882507
Epoch: 14, Steps: 208 | Train Loss: 0.351 Vali Loss: 8.083 Vali Acc: 0.106 Test Loss: 8.083 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10647181628392484
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2531643
	speed: 0.2994s/iter; left time: 6198.6411s
	iters: 200, epoch: 1 | loss: 3.2335823
	speed: 0.2747s/iter; left time: 5660.0585s
Epoch: 1 cost time: 59.826186656951904
Epoch: 1, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.728 Vali Acc: 0.070 Test Loss: 3.728 Test Acc: 0.070
Validation loss decreased (inf --> -0.069751).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2074766
	speed: 0.6804s/iter; left time: 13943.3588s
	iters: 200, epoch: 2 | loss: 2.4495349
	speed: 0.2668s/iter; left time: 5439.8372s
Epoch: 2 cost time: 58.765239238739014
Epoch: 2, Steps: 208 | Train Loss: 3.122 Vali Loss: 4.037 Vali Acc: 0.067 Test Loss: 4.037 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4268050
	speed: 0.6344s/iter; left time: 12869.0445s
	iters: 200, epoch: 3 | loss: 3.4066148
	speed: 0.2644s/iter; left time: 5337.1105s
Epoch: 3 cost time: 56.54379057884216
Epoch: 3, Steps: 208 | Train Loss: 2.757 Vali Loss: 4.323 Vali Acc: 0.084 Test Loss: 4.323 Test Acc: 0.084
Validation loss decreased (-0.069751 --> -0.084359).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9136751
	speed: 0.6586s/iter; left time: 13221.9865s
	iters: 200, epoch: 4 | loss: 2.5472450
	speed: 0.2774s/iter; left time: 5541.6888s
Epoch: 4 cost time: 58.69049954414368
Epoch: 4, Steps: 208 | Train Loss: 2.391 Vali Loss: 4.415 Vali Acc: 0.081 Test Loss: 4.415 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4993198
	speed: 0.6488s/iter; left time: 12890.6537s
	iters: 200, epoch: 5 | loss: 2.6300313
	speed: 0.2619s/iter; left time: 5177.5216s
Epoch: 5 cost time: 55.127633571624756
Epoch: 5, Steps: 208 | Train Loss: 2.010 Vali Loss: 4.836 Vali Acc: 0.083 Test Loss: 4.836 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3640968
	speed: 0.6254s/iter; left time: 12296.2463s
	iters: 200, epoch: 6 | loss: 1.4316626
	speed: 0.2727s/iter; left time: 5333.6546s
Epoch: 6 cost time: 55.712241888046265
Epoch: 6, Steps: 208 | Train Loss: 1.623 Vali Loss: 5.170 Vali Acc: 0.089 Test Loss: 5.170 Test Acc: 0.089
Validation loss decreased (-0.084359 --> -0.088824).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5723822
	speed: 0.6426s/iter; left time: 12501.2677s
	iters: 200, epoch: 7 | loss: 1.4028586
	speed: 0.2781s/iter; left time: 5382.6586s
Epoch: 7 cost time: 57.538257122039795
Epoch: 7, Steps: 208 | Train Loss: 1.264 Vali Loss: 5.516 Vali Acc: 0.094 Test Loss: 5.516 Test Acc: 0.094
Validation loss decreased (-0.088824 --> -0.093592).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7952137
	speed: 0.6436s/iter; left time: 12385.9459s
	iters: 200, epoch: 8 | loss: 0.9809254
	speed: 0.2744s/iter; left time: 5253.6812s
Epoch: 8 cost time: 57.624037742614746
Epoch: 8, Steps: 208 | Train Loss: 1.052 Vali Loss: 5.809 Vali Acc: 0.091 Test Loss: 5.809 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4220200
	speed: 0.6118s/iter; left time: 11647.3165s
	iters: 200, epoch: 9 | loss: 0.5044333
	speed: 0.2783s/iter; left time: 5269.2539s
Epoch: 9 cost time: 56.452762603759766
Epoch: 9, Steps: 208 | Train Loss: 0.850 Vali Loss: 6.154 Vali Acc: 0.087 Test Loss: 6.154 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2950840
	speed: 0.6337s/iter; left time: 11931.6367s
	iters: 200, epoch: 10 | loss: 1.1749766
	speed: 0.2782s/iter; left time: 5210.8505s
Epoch: 10 cost time: 57.602226972579956
Epoch: 10, Steps: 208 | Train Loss: 0.731 Vali Loss: 6.593 Vali Acc: 0.086 Test Loss: 6.593 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4731426
	speed: 0.6466s/iter; left time: 12039.4671s
	iters: 200, epoch: 11 | loss: 1.3821880
	speed: 0.2806s/iter; left time: 5196.5505s
Epoch: 11 cost time: 58.63950181007385
Epoch: 11, Steps: 208 | Train Loss: 0.634 Vali Loss: 6.578 Vali Acc: 0.092 Test Loss: 6.578 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4892877
	speed: 0.6442s/iter; left time: 11862.4333s
	iters: 200, epoch: 12 | loss: 0.4179537
	speed: 0.2911s/iter; left time: 5331.3395s
Epoch: 12 cost time: 59.96851587295532
Epoch: 12, Steps: 208 | Train Loss: 0.583 Vali Loss: 7.230 Vali Acc: 0.086 Test Loss: 7.230 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7292839
	speed: 0.6362s/iter; left time: 11582.1658s
	iters: 200, epoch: 13 | loss: 0.5387292
	speed: 0.2828s/iter; left time: 5119.5275s
Epoch: 13 cost time: 58.21633839607239
Epoch: 13, Steps: 208 | Train Loss: 0.498 Vali Loss: 7.328 Vali Acc: 0.084 Test Loss: 7.328 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5100616
	speed: 0.6220s/iter; left time: 11194.2481s
	iters: 200, epoch: 14 | loss: 0.6586388
	speed: 0.2764s/iter; left time: 4947.0610s
Epoch: 14 cost time: 57.563236474990845
Epoch: 14, Steps: 208 | Train Loss: 0.445 Vali Loss: 7.644 Vali Acc: 0.097 Test Loss: 7.644 Test Acc: 0.097
Validation loss decreased (-0.093592 --> -0.097150).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5896198
	speed: 0.6319s/iter; left time: 11241.1955s
	iters: 200, epoch: 15 | loss: 0.1471807
	speed: 0.2814s/iter; left time: 4978.3607s
Epoch: 15 cost time: 58.47903490066528
Epoch: 15, Steps: 208 | Train Loss: 0.401 Vali Loss: 7.958 Vali Acc: 0.093 Test Loss: 7.958 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0325309
	speed: 0.6307s/iter; left time: 11087.7759s
	iters: 200, epoch: 16 | loss: 0.3644864
	speed: 0.2761s/iter; left time: 4827.2646s
Epoch: 16 cost time: 57.93357992172241
Epoch: 16, Steps: 208 | Train Loss: 0.366 Vali Loss: 7.868 Vali Acc: 0.098 Test Loss: 7.868 Test Acc: 0.098
Validation loss decreased (-0.097150 --> -0.098042).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5794545
	speed: 0.6172s/iter; left time: 10722.9220s
	iters: 200, epoch: 17 | loss: 0.9158695
	speed: 0.2750s/iter; left time: 4750.1219s
Epoch: 17 cost time: 57.96080017089844
Epoch: 17, Steps: 208 | Train Loss: 0.327 Vali Loss: 8.125 Vali Acc: 0.095 Test Loss: 8.125 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3677096
	speed: 0.6219s/iter; left time: 10674.2480s
	iters: 200, epoch: 18 | loss: 0.1562738
	speed: 0.2678s/iter; left time: 4570.8224s
Epoch: 18 cost time: 57.41563272476196
Epoch: 18, Steps: 208 | Train Loss: 0.285 Vali Loss: 8.554 Vali Acc: 0.097 Test Loss: 8.554 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2625995
	speed: 0.6356s/iter; left time: 10778.5634s
	iters: 200, epoch: 19 | loss: 0.1849242
	speed: 0.2690s/iter; left time: 4534.0720s
Epoch: 19 cost time: 58.015981674194336
Epoch: 19, Steps: 208 | Train Loss: 0.286 Vali Loss: 8.437 Vali Acc: 0.093 Test Loss: 8.437 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1962824
	speed: 0.6317s/iter; left time: 10579.9801s
	iters: 200, epoch: 20 | loss: 0.1828262
	speed: 0.2700s/iter; left time: 4495.7715s
Epoch: 20 cost time: 58.1681227684021
Epoch: 20, Steps: 208 | Train Loss: 0.263 Vali Loss: 8.780 Vali Acc: 0.095 Test Loss: 8.780 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.7349040
	speed: 0.5967s/iter; left time: 9870.7913s
	iters: 200, epoch: 21 | loss: 0.0976616
	speed: 0.2656s/iter; left time: 4366.1678s
Epoch: 21 cost time: 55.9758677482605
Epoch: 21, Steps: 208 | Train Loss: 0.248 Vali Loss: 9.305 Vali Acc: 0.092 Test Loss: 9.305 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0635755
	speed: 0.6311s/iter; left time: 10308.3425s
	iters: 200, epoch: 22 | loss: 0.3305204
	speed: 0.2708s/iter; left time: 4395.1564s
Epoch: 22 cost time: 58.343687534332275
Epoch: 22, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.400 Vali Acc: 0.095 Test Loss: 9.400 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0319211
	speed: 0.6633s/iter; left time: 10695.1363s
	iters: 200, epoch: 23 | loss: 0.2078970
	speed: 0.2843s/iter; left time: 4555.8036s
Epoch: 23 cost time: 60.718549966812134
Epoch: 23, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.025 Vali Acc: 0.097 Test Loss: 9.025 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0338947
	speed: 0.6625s/iter; left time: 10545.4807s
	iters: 200, epoch: 24 | loss: 0.0385162
	speed: 0.2781s/iter; left time: 4397.9674s
Epoch: 24 cost time: 58.87235736846924
Epoch: 24, Steps: 208 | Train Loss: 0.200 Vali Loss: 8.920 Vali Acc: 0.091 Test Loss: 8.920 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0395994
	speed: 0.6496s/iter; left time: 10204.2287s
	iters: 200, epoch: 25 | loss: 0.1240553
	speed: 0.2459s/iter; left time: 3838.7082s
Epoch: 25 cost time: 54.17325973510742
Epoch: 25, Steps: 208 | Train Loss: 0.179 Vali Loss: 9.567 Vali Acc: 0.094 Test Loss: 9.567 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1185518
	speed: 0.6433s/iter; left time: 9971.1781s
	iters: 200, epoch: 26 | loss: 0.0685966
	speed: 0.2536s/iter; left time: 3904.9498s
Epoch: 26 cost time: 54.78407597541809
Epoch: 26, Steps: 208 | Train Loss: 0.167 Vali Loss: 9.704 Vali Acc: 0.091 Test Loss: 9.704 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09812108559498957
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2316952
	speed: 0.2898s/iter; left time: 5999.6321s
	iters: 200, epoch: 1 | loss: 3.5017424
	speed: 0.2983s/iter; left time: 6144.3654s
Epoch: 1 cost time: 61.313393354415894
Epoch: 1, Steps: 208 | Train Loss: 3.649 Vali Loss: 4.285 Vali Acc: 0.035 Test Loss: 4.285 Test Acc: 0.035
Validation loss decreased (inf --> -0.034851).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2173731
	speed: 0.6367s/iter; left time: 13048.2136s
	iters: 200, epoch: 2 | loss: 2.9073827
	speed: 0.2703s/iter; left time: 5511.4069s
Epoch: 2 cost time: 56.95581603050232
Epoch: 2, Steps: 208 | Train Loss: 3.225 Vali Loss: 4.853 Vali Acc: 0.039 Test Loss: 4.853 Test Acc: 0.039
Validation loss decreased (-0.034851 --> -0.038723).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4139228
	speed: 0.6466s/iter; left time: 13116.3169s
	iters: 200, epoch: 3 | loss: 3.5561004
	speed: 0.2807s/iter; left time: 5665.2475s
Epoch: 3 cost time: 58.11935257911682
Epoch: 3, Steps: 208 | Train Loss: 2.976 Vali Loss: 4.872 Vali Acc: 0.043 Test Loss: 4.872 Test Acc: 0.043
Validation loss decreased (-0.038723 --> -0.042600).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4680223
	speed: 0.6121s/iter; left time: 12288.4228s
	iters: 200, epoch: 4 | loss: 2.6377370
	speed: 0.2657s/iter; left time: 5307.2819s
Epoch: 4 cost time: 56.11277508735657
Epoch: 4, Steps: 208 | Train Loss: 2.752 Vali Loss: 4.801 Vali Acc: 0.054 Test Loss: 4.801 Test Acc: 0.054
Validation loss decreased (-0.042600 --> -0.053933).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4721441
	speed: 0.6207s/iter; left time: 12332.8335s
	iters: 200, epoch: 5 | loss: 2.5189302
	speed: 0.2601s/iter; left time: 5142.7133s
Epoch: 5 cost time: 55.86168718338013
Epoch: 5, Steps: 208 | Train Loss: 2.465 Vali Loss: 5.026 Vali Acc: 0.049 Test Loss: 5.026 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0660186
	speed: 0.6525s/iter; left time: 12828.4594s
	iters: 200, epoch: 6 | loss: 2.2391348
	speed: 0.2677s/iter; left time: 5235.9387s
Epoch: 6 cost time: 57.12743544578552
Epoch: 6, Steps: 208 | Train Loss: 2.114 Vali Loss: 5.228 Vali Acc: 0.057 Test Loss: 5.228 Test Acc: 0.057
Validation loss decreased (-0.053933 --> -0.056613).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2126507
	speed: 0.6510s/iter; left time: 12663.3556s
	iters: 200, epoch: 7 | loss: 2.4561589
	speed: 0.2832s/iter; left time: 5479.8278s
Epoch: 7 cost time: 58.17700004577637
Epoch: 7, Steps: 208 | Train Loss: 1.746 Vali Loss: 5.565 Vali Acc: 0.070 Test Loss: 5.565 Test Acc: 0.070
Validation loss decreased (-0.056613 --> -0.069733).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9234416
	speed: 0.6233s/iter; left time: 11996.0292s
	iters: 200, epoch: 8 | loss: 1.2712467
	speed: 0.2769s/iter; left time: 5301.9318s
Epoch: 8 cost time: 57.27991008758545
Epoch: 8, Steps: 208 | Train Loss: 1.418 Vali Loss: 6.008 Vali Acc: 0.068 Test Loss: 6.008 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3494687
	speed: 0.6209s/iter; left time: 11820.7638s
	iters: 200, epoch: 9 | loss: 1.0256654
	speed: 0.2631s/iter; left time: 4981.7512s
Epoch: 9 cost time: 55.50271272659302
Epoch: 9, Steps: 208 | Train Loss: 1.135 Vali Loss: 6.327 Vali Acc: 0.074 Test Loss: 6.327 Test Acc: 0.074
Validation loss decreased (-0.069733 --> -0.074199).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9489121
	speed: 0.6697s/iter; left time: 12609.2073s
	iters: 200, epoch: 10 | loss: 1.1614567
	speed: 0.2786s/iter; left time: 5218.4917s
Epoch: 10 cost time: 58.661728382110596
Epoch: 10, Steps: 208 | Train Loss: 0.952 Vali Loss: 6.572 Vali Acc: 0.076 Test Loss: 6.572 Test Acc: 0.076
Validation loss decreased (-0.074199 --> -0.075687).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6215247
	speed: 0.6445s/iter; left time: 12000.3548s
	iters: 200, epoch: 11 | loss: 1.3145478
	speed: 0.2942s/iter; left time: 5448.0170s
Epoch: 11 cost time: 59.53194880485535
Epoch: 11, Steps: 208 | Train Loss: 0.785 Vali Loss: 6.713 Vali Acc: 0.083 Test Loss: 6.713 Test Acc: 0.083
Validation loss decreased (-0.075687 --> -0.082545).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8489200
	speed: 0.6480s/iter; left time: 11932.3611s
	iters: 200, epoch: 12 | loss: 0.5631356
	speed: 0.2615s/iter; left time: 4788.9237s
Epoch: 12 cost time: 57.733633518218994
Epoch: 12, Steps: 208 | Train Loss: 0.685 Vali Loss: 7.193 Vali Acc: 0.081 Test Loss: 7.193 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7382963
	speed: 0.6348s/iter; left time: 11556.7201s
	iters: 200, epoch: 13 | loss: 0.3734021
	speed: 0.2460s/iter; left time: 4454.0769s
Epoch: 13 cost time: 56.07169556617737
Epoch: 13, Steps: 208 | Train Loss: 0.602 Vali Loss: 7.503 Vali Acc: 0.080 Test Loss: 7.503 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6020745
	speed: 0.6422s/iter; left time: 11557.6140s
	iters: 200, epoch: 14 | loss: 0.5963208
	speed: 0.2773s/iter; left time: 4963.5940s
Epoch: 14 cost time: 56.728679895401
Epoch: 14, Steps: 208 | Train Loss: 0.564 Vali Loss: 7.776 Vali Acc: 0.078 Test Loss: 7.776 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7172803
	speed: 0.6262s/iter; left time: 11138.6589s
	iters: 200, epoch: 15 | loss: 0.7041551
	speed: 0.2851s/iter; left time: 5042.5442s
Epoch: 15 cost time: 57.553000688552856
Epoch: 15, Steps: 208 | Train Loss: 0.460 Vali Loss: 8.010 Vali Acc: 0.075 Test Loss: 8.010 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1652672
	speed: 0.6390s/iter; left time: 11234.2852s
	iters: 200, epoch: 16 | loss: 0.9416665
	speed: 0.2744s/iter; left time: 4796.7394s
Epoch: 16 cost time: 59.359015226364136
Epoch: 16, Steps: 208 | Train Loss: 0.381 Vali Loss: 8.217 Vali Acc: 0.083 Test Loss: 8.217 Test Acc: 0.083
Validation loss decreased (-0.082545 --> -0.082829).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2096199
	speed: 0.6429s/iter; left time: 11168.5671s
	iters: 200, epoch: 17 | loss: 0.4667294
	speed: 0.2719s/iter; left time: 4697.2978s
Epoch: 17 cost time: 56.83610534667969
Epoch: 17, Steps: 208 | Train Loss: 0.387 Vali Loss: 8.828 Vali Acc: 0.077 Test Loss: 8.828 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5031745
	speed: 0.6328s/iter; left time: 10861.1730s
	iters: 200, epoch: 18 | loss: 0.2113734
	speed: 0.2823s/iter; left time: 4816.6507s
Epoch: 18 cost time: 57.164467573165894
Epoch: 18, Steps: 208 | Train Loss: 0.332 Vali Loss: 8.396 Vali Acc: 0.079 Test Loss: 8.396 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1235523
	speed: 0.6268s/iter; left time: 10628.7383s
	iters: 200, epoch: 19 | loss: 0.4808210
	speed: 0.2727s/iter; left time: 4597.6272s
Epoch: 19 cost time: 56.450512409210205
Epoch: 19, Steps: 208 | Train Loss: 0.325 Vali Loss: 8.743 Vali Acc: 0.087 Test Loss: 8.743 Test Acc: 0.087
Validation loss decreased (-0.082829 --> -0.087297).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1388407
	speed: 0.6270s/iter; left time: 10502.2502s
	iters: 200, epoch: 20 | loss: 0.0708549
	speed: 0.2571s/iter; left time: 4280.7029s
Epoch: 20 cost time: 56.25332188606262
Epoch: 20, Steps: 208 | Train Loss: 0.268 Vali Loss: 8.921 Vali Acc: 0.080 Test Loss: 8.921 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.7491251
	speed: 0.6270s/iter; left time: 10370.9354s
	iters: 200, epoch: 21 | loss: 0.3311895
	speed: 0.2664s/iter; left time: 4380.3034s
Epoch: 21 cost time: 56.348939657211304
Epoch: 21, Steps: 208 | Train Loss: 0.277 Vali Loss: 9.255 Vali Acc: 0.082 Test Loss: 9.255 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0272092
	speed: 0.6287s/iter; left time: 10268.6070s
	iters: 200, epoch: 22 | loss: 0.8250245
	speed: 0.2698s/iter; left time: 4379.7511s
Epoch: 22 cost time: 55.47506260871887
Epoch: 22, Steps: 208 | Train Loss: 0.259 Vali Loss: 9.142 Vali Acc: 0.083 Test Loss: 9.142 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5193185
	speed: 0.6603s/iter; left time: 10647.2859s
	iters: 200, epoch: 23 | loss: 0.0544115
	speed: 0.2829s/iter; left time: 4533.3464s
Epoch: 23 cost time: 59.48626637458801
Epoch: 23, Steps: 208 | Train Loss: 0.218 Vali Loss: 9.450 Vali Acc: 0.087 Test Loss: 9.450 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1738061
	speed: 0.6291s/iter; left time: 10013.8422s
	iters: 200, epoch: 24 | loss: 0.0643746
	speed: 0.2673s/iter; left time: 4228.3378s
Epoch: 24 cost time: 57.24642992019653
Epoch: 24, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.824 Vali Acc: 0.090 Test Loss: 9.824 Test Acc: 0.090
Validation loss decreased (-0.087297 --> -0.090269).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.1478980
	speed: 0.6272s/iter; left time: 9852.2857s
	iters: 200, epoch: 25 | loss: 0.3768149
	speed: 0.2698s/iter; left time: 4211.6991s
Epoch: 25 cost time: 56.39230418205261
Epoch: 25, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.826 Vali Acc: 0.081 Test Loss: 9.826 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1210346
	speed: 0.6426s/iter; left time: 9961.5938s
	iters: 200, epoch: 26 | loss: 0.0839664
	speed: 0.2693s/iter; left time: 4147.9416s
Epoch: 26 cost time: 55.591663122177124
Epoch: 26, Steps: 208 | Train Loss: 0.199 Vali Loss: 9.506 Vali Acc: 0.074 Test Loss: 9.506 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.2080610
	speed: 0.6461s/iter; left time: 9880.9763s
	iters: 200, epoch: 27 | loss: 0.1541084
	speed: 0.2857s/iter; left time: 4340.9600s
Epoch: 27 cost time: 58.56370186805725
Epoch: 27, Steps: 208 | Train Loss: 0.171 Vali Loss: 10.189 Vali Acc: 0.083 Test Loss: 10.189 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0109656
	speed: 0.6390s/iter; left time: 9639.9177s
	iters: 200, epoch: 28 | loss: 0.0725964
	speed: 0.2618s/iter; left time: 3923.3401s
Epoch: 28 cost time: 57.74332284927368
Epoch: 28, Steps: 208 | Train Loss: 0.187 Vali Loss: 10.412 Vali Acc: 0.081 Test Loss: 10.412 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.5058988
	speed: 0.6445s/iter; left time: 9587.7015s
	iters: 200, epoch: 29 | loss: 0.0559895
	speed: 0.2810s/iter; left time: 4152.1823s
Epoch: 29 cost time: 57.76313233375549
Epoch: 29, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.361 Vali Acc: 0.087 Test Loss: 10.361 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0821075
	speed: 0.6419s/iter; left time: 9415.4317s
	iters: 200, epoch: 30 | loss: 0.0540483
	speed: 0.2751s/iter; left time: 4007.3258s
Epoch: 30 cost time: 58.04016852378845
Epoch: 30, Steps: 208 | Train Loss: 0.168 Vali Loss: 10.437 Vali Acc: 0.085 Test Loss: 10.437 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0406620
	speed: 0.6438s/iter; left time: 9310.6852s
	iters: 200, epoch: 31 | loss: 0.2769751
	speed: 0.2784s/iter; left time: 3998.1439s
Epoch: 31 cost time: 58.07215666770935
Epoch: 31, Steps: 208 | Train Loss: 0.132 Vali Loss: 10.734 Vali Acc: 0.086 Test Loss: 10.734 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0558822
	speed: 0.6482s/iter; left time: 9239.2306s
	iters: 200, epoch: 32 | loss: 0.3562306
	speed: 0.2900s/iter; left time: 4104.4027s
Epoch: 32 cost time: 59.31523084640503
Epoch: 32, Steps: 208 | Train Loss: 0.155 Vali Loss: 10.827 Vali Acc: 0.088 Test Loss: 10.827 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.2617317
	speed: 0.6463s/iter; left time: 9077.9293s
	iters: 200, epoch: 33 | loss: 0.2041191
	speed: 0.2917s/iter; left time: 4068.2133s
Epoch: 33 cost time: 61.29079723358154
Epoch: 33, Steps: 208 | Train Loss: 0.144 Vali Loss: 10.912 Vali Acc: 0.077 Test Loss: 10.912 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0496938
	speed: 0.6451s/iter; left time: 8925.8357s
	iters: 200, epoch: 34 | loss: 0.0152057
	speed: 0.2819s/iter; left time: 3872.1376s
Epoch: 34 cost time: 57.88127017021179
Epoch: 34, Steps: 208 | Train Loss: 0.119 Vali Loss: 10.795 Vali Acc: 0.088 Test Loss: 10.795 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09036683566954966
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3410840
	speed: 0.2778s/iter; left time: 5750.6554s
	iters: 200, epoch: 1 | loss: 3.4327960
	speed: 0.2703s/iter; left time: 5569.1401s
Epoch: 1 cost time: 57.24212574958801
Epoch: 1, Steps: 208 | Train Loss: 3.653 Vali Loss: 5.179 Vali Acc: 0.031 Test Loss: 5.179 Test Acc: 0.031
Validation loss decreased (inf --> -0.030965).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5244141
	speed: 0.6390s/iter; left time: 13094.8759s
	iters: 200, epoch: 2 | loss: 3.0300567
	speed: 0.2625s/iter; left time: 5354.0373s
Epoch: 2 cost time: 55.76090598106384
Epoch: 2, Steps: 208 | Train Loss: 3.296 Vali Loss: 5.623 Vali Acc: 0.036 Test Loss: 5.623 Test Acc: 0.036
Validation loss decreased (-0.030965 --> -0.036329).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9057240
	speed: 0.6317s/iter; left time: 12813.6495s
	iters: 200, epoch: 3 | loss: 3.5395815
	speed: 0.2687s/iter; left time: 5424.1380s
Epoch: 3 cost time: 56.65867567062378
Epoch: 3, Steps: 208 | Train Loss: 3.154 Vali Loss: 5.316 Vali Acc: 0.046 Test Loss: 5.316 Test Acc: 0.046
Validation loss decreased (-0.036329 --> -0.045578).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5322940
	speed: 0.6279s/iter; left time: 12605.6248s
	iters: 200, epoch: 4 | loss: 3.4638464
	speed: 0.2670s/iter; left time: 5333.6457s
Epoch: 4 cost time: 55.52847361564636
Epoch: 4, Steps: 208 | Train Loss: 3.003 Vali Loss: 5.190 Vali Acc: 0.044 Test Loss: 5.190 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0037949
	speed: 0.6198s/iter; left time: 12314.4007s
	iters: 200, epoch: 5 | loss: 3.8247111
	speed: 0.2533s/iter; left time: 5007.9452s
Epoch: 5 cost time: 55.428579330444336
Epoch: 5, Steps: 208 | Train Loss: 2.860 Vali Loss: 4.998 Vali Acc: 0.061 Test Loss: 4.998 Test Acc: 0.061
Validation loss decreased (-0.045578 --> -0.060791).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3318360
	speed: 0.6477s/iter; left time: 12734.2926s
	iters: 200, epoch: 6 | loss: 3.0506270
	speed: 0.2744s/iter; left time: 5368.1951s
Epoch: 6 cost time: 56.376638889312744
Epoch: 6, Steps: 208 | Train Loss: 2.561 Vali Loss: 5.369 Vali Acc: 0.064 Test Loss: 5.369 Test Acc: 0.064
Validation loss decreased (-0.060791 --> -0.064068).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6676340
	speed: 0.6325s/iter; left time: 12304.6658s
	iters: 200, epoch: 7 | loss: 2.5534260
	speed: 0.2739s/iter; left time: 5299.9726s
Epoch: 7 cost time: 57.825392961502075
Epoch: 7, Steps: 208 | Train Loss: 2.239 Vali Loss: 5.253 Vali Acc: 0.072 Test Loss: 5.253 Test Acc: 0.072
Validation loss decreased (-0.064068 --> -0.072122).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3606501
	speed: 0.6444s/iter; left time: 12400.7948s
	iters: 200, epoch: 8 | loss: 1.8057488
	speed: 0.2726s/iter; left time: 5218.6528s
Epoch: 8 cost time: 56.64186930656433
Epoch: 8, Steps: 208 | Train Loss: 1.907 Vali Loss: 5.744 Vali Acc: 0.074 Test Loss: 5.744 Test Acc: 0.074
Validation loss decreased (-0.072122 --> -0.073608).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5783181
	speed: 0.6222s/iter; left time: 11844.3753s
	iters: 200, epoch: 9 | loss: 1.7352818
	speed: 0.2513s/iter; left time: 4758.9366s
Epoch: 9 cost time: 54.358540773391724
Epoch: 9, Steps: 208 | Train Loss: 1.650 Vali Loss: 5.541 Vali Acc: 0.084 Test Loss: 5.541 Test Acc: 0.084
Validation loss decreased (-0.073608 --> -0.084048).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1161126
	speed: 0.6252s/iter; left time: 11771.2467s
	iters: 200, epoch: 10 | loss: 2.1225832
	speed: 0.2732s/iter; left time: 5116.5983s
Epoch: 10 cost time: 55.667248249053955
Epoch: 10, Steps: 208 | Train Loss: 1.414 Vali Loss: 5.902 Vali Acc: 0.078 Test Loss: 5.902 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7043036
	speed: 0.6361s/iter; left time: 11843.9782s
	iters: 200, epoch: 11 | loss: 1.5631723
	speed: 0.2586s/iter; left time: 4789.2554s
Epoch: 11 cost time: 56.25196146965027
Epoch: 11, Steps: 208 | Train Loss: 1.242 Vali Loss: 5.908 Vali Acc: 0.086 Test Loss: 5.908 Test Acc: 0.086
Validation loss decreased (-0.084048 --> -0.085834).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9702436
	speed: 0.6338s/iter; left time: 11670.0943s
	iters: 200, epoch: 12 | loss: 1.1352518
	speed: 0.2779s/iter; left time: 5088.6250s
Epoch: 12 cost time: 57.291008710861206
Epoch: 12, Steps: 208 | Train Loss: 1.038 Vali Loss: 6.557 Vali Acc: 0.076 Test Loss: 6.557 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5785766
	speed: 0.6644s/iter; left time: 12094.8300s
	iters: 200, epoch: 13 | loss: 1.0341709
	speed: 0.2732s/iter; left time: 4946.5889s
Epoch: 13 cost time: 58.2928307056427
Epoch: 13, Steps: 208 | Train Loss: 0.873 Vali Loss: 6.801 Vali Acc: 0.082 Test Loss: 6.801 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2274514
	speed: 0.6491s/iter; left time: 11681.8844s
	iters: 200, epoch: 14 | loss: 0.8697255
	speed: 0.2680s/iter; left time: 4795.8419s
Epoch: 14 cost time: 57.15743446350098
Epoch: 14, Steps: 208 | Train Loss: 0.785 Vali Loss: 6.798 Vali Acc: 0.085 Test Loss: 6.798 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0372698
	speed: 0.6473s/iter; left time: 11515.5229s
	iters: 200, epoch: 15 | loss: 0.5176011
	speed: 0.2899s/iter; left time: 5128.3508s
Epoch: 15 cost time: 60.33899211883545
Epoch: 15, Steps: 208 | Train Loss: 0.679 Vali Loss: 7.092 Vali Acc: 0.083 Test Loss: 7.092 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3635699
	speed: 0.6710s/iter; left time: 11796.6700s
	iters: 200, epoch: 16 | loss: 1.1207365
	speed: 0.2823s/iter; left time: 4934.9991s
Epoch: 16 cost time: 60.41932129859924
Epoch: 16, Steps: 208 | Train Loss: 0.613 Vali Loss: 7.387 Vali Acc: 0.087 Test Loss: 7.387 Test Acc: 0.087
Validation loss decreased (-0.085834 --> -0.087012).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5714186
	speed: 0.6692s/iter; left time: 11626.3998s
	iters: 200, epoch: 17 | loss: 0.6867623
	speed: 0.2683s/iter; left time: 4634.1245s
Epoch: 17 cost time: 56.99129557609558
Epoch: 17, Steps: 208 | Train Loss: 0.547 Vali Loss: 7.414 Vali Acc: 0.088 Test Loss: 7.414 Test Acc: 0.088
Validation loss decreased (-0.087012 --> -0.088205).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3920385
	speed: 0.6522s/iter; left time: 11195.0702s
	iters: 200, epoch: 18 | loss: 0.3897180
	speed: 0.2583s/iter; left time: 4407.7842s
Epoch: 18 cost time: 56.284343957901
Epoch: 18, Steps: 208 | Train Loss: 0.479 Vali Loss: 8.006 Vali Acc: 0.084 Test Loss: 8.006 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2401079
	speed: 0.6683s/iter; left time: 11332.6845s
	iters: 200, epoch: 19 | loss: 0.5301652
	speed: 0.2778s/iter; left time: 4683.5360s
Epoch: 19 cost time: 60.197372913360596
Epoch: 19, Steps: 208 | Train Loss: 0.446 Vali Loss: 8.179 Vali Acc: 0.091 Test Loss: 8.179 Test Acc: 0.091
Validation loss decreased (-0.088205 --> -0.090583).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3928598
	speed: 0.6731s/iter; left time: 11274.0192s
	iters: 200, epoch: 20 | loss: 0.2235636
	speed: 0.2785s/iter; left time: 4636.9991s
Epoch: 20 cost time: 59.91102743148804
Epoch: 20, Steps: 208 | Train Loss: 0.419 Vali Loss: 8.548 Vali Acc: 0.086 Test Loss: 8.548 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.6318198
	speed: 0.6645s/iter; left time: 10992.2696s
	iters: 200, epoch: 21 | loss: 0.0996474
	speed: 0.2903s/iter; left time: 4773.4738s
Epoch: 21 cost time: 59.64954614639282
Epoch: 21, Steps: 208 | Train Loss: 0.386 Vali Loss: 8.538 Vali Acc: 0.090 Test Loss: 8.538 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.3699262
	speed: 0.6274s/iter; left time: 10246.5820s
	iters: 200, epoch: 22 | loss: 0.4597637
	speed: 0.2813s/iter; left time: 4565.8928s
Epoch: 22 cost time: 57.62154483795166
Epoch: 22, Steps: 208 | Train Loss: 0.377 Vali Loss: 8.386 Vali Acc: 0.087 Test Loss: 8.386 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3665125
	speed: 0.6536s/iter; left time: 10539.5018s
	iters: 200, epoch: 23 | loss: 0.5147051
	speed: 0.2762s/iter; left time: 4426.6301s
Epoch: 23 cost time: 57.99538993835449
Epoch: 23, Steps: 208 | Train Loss: 0.360 Vali Loss: 8.694 Vali Acc: 0.087 Test Loss: 8.694 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1552101
	speed: 0.6848s/iter; left time: 10899.9821s
	iters: 200, epoch: 24 | loss: 0.2851247
	speed: 0.2735s/iter; left time: 4325.1776s
Epoch: 24 cost time: 58.82561755180359
Epoch: 24, Steps: 208 | Train Loss: 0.336 Vali Loss: 8.714 Vali Acc: 0.088 Test Loss: 8.714 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.4673080
	speed: 0.6499s/iter; left time: 10208.7339s
	iters: 200, epoch: 25 | loss: 0.5599762
	speed: 0.2638s/iter; left time: 4117.5760s
Epoch: 25 cost time: 57.282625913619995
Epoch: 25, Steps: 208 | Train Loss: 0.274 Vali Loss: 8.963 Vali Acc: 0.093 Test Loss: 8.963 Test Acc: 0.093
Validation loss decreased (-0.090583 --> -0.093260).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1815460
	speed: 0.6222s/iter; left time: 9644.2282s
	iters: 200, epoch: 26 | loss: 0.2405408
	speed: 0.2702s/iter; left time: 4160.8724s
Epoch: 26 cost time: 57.26349997520447
Epoch: 26, Steps: 208 | Train Loss: 0.270 Vali Loss: 9.616 Vali Acc: 0.094 Test Loss: 9.616 Test Acc: 0.094
Validation loss decreased (-0.093260 --> -0.093850).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.6440440
	speed: 0.6478s/iter; left time: 9907.5529s
	iters: 200, epoch: 27 | loss: 0.0658434
	speed: 0.2773s/iter; left time: 4213.0022s
Epoch: 27 cost time: 59.540836334228516
Epoch: 27, Steps: 208 | Train Loss: 0.267 Vali Loss: 9.515 Vali Acc: 0.084 Test Loss: 9.515 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0359650
	speed: 0.6724s/iter; left time: 10143.0032s
	iters: 200, epoch: 28 | loss: 0.5229662
	speed: 0.2708s/iter; left time: 4057.8819s
Epoch: 28 cost time: 58.393340826034546
Epoch: 28, Steps: 208 | Train Loss: 0.238 Vali Loss: 9.597 Vali Acc: 0.094 Test Loss: 9.597 Test Acc: 0.094
Validation loss decreased (-0.093850 --> -0.094148).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.5932682
	speed: 0.6381s/iter; left time: 9492.3035s
	iters: 200, epoch: 29 | loss: 0.1936121
	speed: 0.2663s/iter; left time: 3935.2775s
Epoch: 29 cost time: 56.316845417022705
Epoch: 29, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.650 Vali Acc: 0.094 Test Loss: 9.650 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0498081
	speed: 0.6381s/iter; left time: 9360.0327s
	iters: 200, epoch: 30 | loss: 0.0315585
	speed: 0.2658s/iter; left time: 3872.8294s
Epoch: 30 cost time: 55.14699602127075
Epoch: 30, Steps: 208 | Train Loss: 0.187 Vali Loss: 9.928 Vali Acc: 0.093 Test Loss: 9.928 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.2068008
	speed: 0.6600s/iter; left time: 9544.0829s
	iters: 200, epoch: 31 | loss: 0.2000354
	speed: 0.2674s/iter; left time: 3840.5061s
Epoch: 31 cost time: 57.30442833900452
Epoch: 31, Steps: 208 | Train Loss: 0.206 Vali Loss: 9.720 Vali Acc: 0.093 Test Loss: 9.720 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0265850
	speed: 0.6391s/iter; left time: 9108.7596s
	iters: 200, epoch: 32 | loss: 0.0380168
	speed: 0.2834s/iter; left time: 4011.4183s
Epoch: 32 cost time: 57.21064114570618
Epoch: 32, Steps: 208 | Train Loss: 0.194 Vali Loss: 10.365 Vali Acc: 0.096 Test Loss: 10.365 Test Acc: 0.096
Validation loss decreased (-0.094148 --> -0.096228).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.6799646
	speed: 0.6458s/iter; left time: 9070.2337s
	iters: 200, epoch: 33 | loss: 0.9720723
	speed: 0.2902s/iter; left time: 4047.0907s
Epoch: 33 cost time: 58.261247873306274
Epoch: 33, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.682 Vali Acc: 0.096 Test Loss: 9.682 Test Acc: 0.096
Validation loss decreased (-0.096228 --> -0.096235).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.7752469
	speed: 0.6282s/iter; left time: 8692.1831s
	iters: 200, epoch: 34 | loss: 0.2454606
	speed: 0.2784s/iter; left time: 3824.2214s
Epoch: 34 cost time: 57.14102077484131
Epoch: 34, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.391 Vali Acc: 0.088 Test Loss: 10.391 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0096583
	speed: 0.6384s/iter; left time: 8700.0898s
	iters: 200, epoch: 35 | loss: 0.5035531
	speed: 0.2805s/iter; left time: 3794.9587s
Epoch: 35 cost time: 58.22287106513977
Epoch: 35, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.251 Vali Acc: 0.093 Test Loss: 10.251 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.2592230
	speed: 0.6580s/iter; left time: 8830.8116s
	iters: 200, epoch: 36 | loss: 0.3351605
	speed: 0.2732s/iter; left time: 3639.0504s
Epoch: 36 cost time: 57.68977999687195
Epoch: 36, Steps: 208 | Train Loss: 0.175 Vali Loss: 10.398 Vali Acc: 0.096 Test Loss: 10.398 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0509669
	speed: 0.6334s/iter; left time: 8369.0833s
	iters: 200, epoch: 37 | loss: 0.3033140
	speed: 0.2599s/iter; left time: 3408.0254s
Epoch: 37 cost time: 56.09759974479675
Epoch: 37, Steps: 208 | Train Loss: 0.187 Vali Loss: 10.501 Vali Acc: 0.100 Test Loss: 10.501 Test Acc: 0.100
Validation loss decreased (-0.096235 --> -0.099507).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.3922158
	speed: 0.6246s/iter; left time: 8122.4845s
	iters: 200, epoch: 38 | loss: 0.2566440
	speed: 0.2721s/iter; left time: 3511.3780s
Epoch: 38 cost time: 57.32371926307678
Epoch: 38, Steps: 208 | Train Loss: 0.146 Vali Loss: 10.701 Vali Acc: 0.094 Test Loss: 10.701 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.2298208
	speed: 0.6610s/iter; left time: 8458.5658s
	iters: 200, epoch: 39 | loss: 0.0026231
	speed: 0.2744s/iter; left time: 3483.9618s
Epoch: 39 cost time: 58.47985291481018
Epoch: 39, Steps: 208 | Train Loss: 0.160 Vali Loss: 10.572 Vali Acc: 0.094 Test Loss: 10.572 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.2199654
	speed: 0.6799s/iter; left time: 8559.6076s
	iters: 200, epoch: 40 | loss: 0.1049514
	speed: 0.2708s/iter; left time: 3382.1080s
Epoch: 40 cost time: 58.613919734954834
Epoch: 40, Steps: 208 | Train Loss: 0.163 Vali Loss: 10.391 Vali Acc: 0.097 Test Loss: 10.391 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.5525286
	speed: 0.6404s/iter; left time: 7928.2524s
	iters: 200, epoch: 41 | loss: 0.0075896
	speed: 0.2631s/iter; left time: 3231.2460s
Epoch: 41 cost time: 56.01335549354553
Epoch: 41, Steps: 208 | Train Loss: 0.162 Vali Loss: 11.280 Vali Acc: 0.093 Test Loss: 11.280 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.2433142
	speed: 0.6784s/iter; left time: 8257.7348s
	iters: 200, epoch: 42 | loss: 0.0859510
	speed: 0.2792s/iter; left time: 3370.3073s
Epoch: 42 cost time: 59.566248655319214
Epoch: 42, Steps: 208 | Train Loss: 0.144 Vali Loss: 10.942 Vali Acc: 0.097 Test Loss: 10.942 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 0.6733506
	speed: 0.6835s/iter; left time: 8178.0355s
	iters: 200, epoch: 43 | loss: 0.0359609
	speed: 0.2802s/iter; left time: 3324.3791s
Epoch: 43 cost time: 58.829312562942505
Epoch: 43, Steps: 208 | Train Loss: 0.140 Vali Loss: 10.907 Vali Acc: 0.090 Test Loss: 10.907 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 0.0086483
	speed: 0.6408s/iter; left time: 7534.0914s
	iters: 200, epoch: 44 | loss: 0.0370775
	speed: 0.2735s/iter; left time: 3187.8024s
Epoch: 44 cost time: 56.49983263015747
Epoch: 44, Steps: 208 | Train Loss: 0.127 Vali Loss: 10.973 Vali Acc: 0.092 Test Loss: 10.973 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 45 | loss: 0.0881645
	speed: 0.6301s/iter; left time: 7277.2100s
	iters: 200, epoch: 45 | loss: 0.6745669
	speed: 0.2764s/iter; left time: 3164.6617s
Epoch: 45 cost time: 57.10811161994934
Epoch: 45, Steps: 208 | Train Loss: 0.153 Vali Loss: 10.868 Vali Acc: 0.092 Test Loss: 10.868 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 46 | loss: 0.0334962
	speed: 0.6520s/iter; left time: 7394.7388s
	iters: 200, epoch: 46 | loss: 0.2595342
	speed: 0.2696s/iter; left time: 3030.5410s
Epoch: 46 cost time: 57.391284227371216
Epoch: 46, Steps: 208 | Train Loss: 0.121 Vali Loss: 11.207 Vali Acc: 0.092 Test Loss: 11.207 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 47 | loss: 0.0040924
	speed: 0.6487s/iter; left time: 7221.8644s
	iters: 200, epoch: 47 | loss: 0.2546661
	speed: 0.2997s/iter; left time: 3306.3298s
Epoch: 47 cost time: 60.324333906173706
Epoch: 47, Steps: 208 | Train Loss: 0.149 Vali Loss: 11.269 Vali Acc: 0.090 Test Loss: 11.269 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09961228750372801
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3753498
	speed: 0.2936s/iter; left time: 6078.6264s
	iters: 200, epoch: 1 | loss: 3.2853796
	speed: 0.2858s/iter; left time: 5888.0432s
Epoch: 1 cost time: 60.141467809677124
Epoch: 1, Steps: 208 | Train Loss: 3.651 Vali Loss: 4.571 Vali Acc: 0.036 Test Loss: 4.571 Test Acc: 0.036
Validation loss decreased (inf --> -0.035743).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3162498
	speed: 0.6415s/iter; left time: 13145.8340s
	iters: 200, epoch: 2 | loss: 2.9449456
	speed: 0.2860s/iter; left time: 5833.1395s
Epoch: 2 cost time: 58.909239530563354
Epoch: 2, Steps: 208 | Train Loss: 3.215 Vali Loss: 5.124 Vali Acc: 0.037 Test Loss: 5.124 Test Acc: 0.037
Validation loss decreased (-0.035743 --> -0.037229).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5209970
	speed: 0.6789s/iter; left time: 13770.7202s
	iters: 200, epoch: 3 | loss: 3.3919892
	speed: 0.2793s/iter; left time: 5637.2604s
Epoch: 3 cost time: 58.17553782463074
Epoch: 3, Steps: 208 | Train Loss: 2.944 Vali Loss: 5.126 Vali Acc: 0.046 Test Loss: 5.126 Test Acc: 0.046
Validation loss decreased (-0.037229 --> -0.045580).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1917555
	speed: 0.6522s/iter; left time: 13094.6075s
	iters: 200, epoch: 4 | loss: 2.9905047
	speed: 0.2862s/iter; left time: 5717.4832s
Epoch: 4 cost time: 57.78549146652222
Epoch: 4, Steps: 208 | Train Loss: 2.722 Vali Loss: 5.235 Vali Acc: 0.047 Test Loss: 5.235 Test Acc: 0.047
Validation loss decreased (-0.045580 --> -0.046771).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2465911
	speed: 0.6652s/iter; left time: 13216.2413s
	iters: 200, epoch: 5 | loss: 3.4699519
	speed: 0.2852s/iter; left time: 5637.5843s
Epoch: 5 cost time: 59.964072465896606
Epoch: 5, Steps: 208 | Train Loss: 2.480 Vali Loss: 5.261 Vali Acc: 0.058 Test Loss: 5.261 Test Acc: 0.058
Validation loss decreased (-0.046771 --> -0.057508).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7889605
	speed: 0.6772s/iter; left time: 13313.7161s
	iters: 200, epoch: 6 | loss: 2.3997619
	speed: 0.2992s/iter; left time: 5851.8298s
Epoch: 6 cost time: 61.269816398620605
Epoch: 6, Steps: 208 | Train Loss: 2.122 Vali Loss: 5.668 Vali Acc: 0.062 Test Loss: 5.668 Test Acc: 0.062
Validation loss decreased (-0.057508 --> -0.062276).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2663890
	speed: 0.6854s/iter; left time: 13333.4794s
	iters: 200, epoch: 7 | loss: 2.1488383
	speed: 0.2944s/iter; left time: 5696.6572s
Epoch: 7 cost time: 62.08416533470154
Epoch: 7, Steps: 208 | Train Loss: 1.799 Vali Loss: 5.890 Vali Acc: 0.066 Test Loss: 5.890 Test Acc: 0.066
Validation loss decreased (-0.062276 --> -0.065852).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5033165
	speed: 0.6573s/iter; left time: 12649.5724s
	iters: 200, epoch: 8 | loss: 1.3916394
	speed: 0.2925s/iter; left time: 5599.6698s
Epoch: 8 cost time: 60.46152925491333
Epoch: 8, Steps: 208 | Train Loss: 1.480 Vali Loss: 6.725 Vali Acc: 0.061 Test Loss: 6.725 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0939611
	speed: 0.6694s/iter; left time: 12743.0749s
	iters: 200, epoch: 9 | loss: 1.3199853
	speed: 0.2738s/iter; left time: 5184.1344s
Epoch: 9 cost time: 58.96590256690979
Epoch: 9, Steps: 208 | Train Loss: 1.253 Vali Loss: 6.740 Vali Acc: 0.071 Test Loss: 6.740 Test Acc: 0.071
Validation loss decreased (-0.065852 --> -0.071212).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8975484
	speed: 0.6839s/iter; left time: 12876.6672s
	iters: 200, epoch: 10 | loss: 2.2217238
	speed: 0.2957s/iter; left time: 5537.2991s
Epoch: 10 cost time: 60.79356360435486
Epoch: 10, Steps: 208 | Train Loss: 1.022 Vali Loss: 7.109 Vali Acc: 0.070 Test Loss: 7.109 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5971010
	speed: 0.6629s/iter; left time: 12343.4370s
	iters: 200, epoch: 11 | loss: 1.4731033
	speed: 0.2952s/iter; left time: 5467.9627s
Epoch: 11 cost time: 60.13237690925598
Epoch: 11, Steps: 208 | Train Loss: 0.868 Vali Loss: 7.413 Vali Acc: 0.082 Test Loss: 7.413 Test Acc: 0.082
Validation loss decreased (-0.071212 --> -0.081644).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1741028
	speed: 0.6564s/iter; left time: 12086.3147s
	iters: 200, epoch: 12 | loss: 0.8676960
	speed: 0.2797s/iter; left time: 5121.4923s
Epoch: 12 cost time: 59.20002031326294
Epoch: 12, Steps: 208 | Train Loss: 0.769 Vali Loss: 7.805 Vali Acc: 0.068 Test Loss: 7.805 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7474285
	speed: 0.6463s/iter; left time: 11765.4176s
	iters: 200, epoch: 13 | loss: 0.4232989
	speed: 0.2827s/iter; left time: 5118.6687s
Epoch: 13 cost time: 58.10929274559021
Epoch: 13, Steps: 208 | Train Loss: 0.643 Vali Loss: 8.266 Vali Acc: 0.075 Test Loss: 8.266 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6995441
	speed: 0.6609s/iter; left time: 11894.9930s
	iters: 200, epoch: 14 | loss: 0.5921739
	speed: 0.2820s/iter; left time: 5047.6762s
Epoch: 14 cost time: 59.0436315536499
Epoch: 14, Steps: 208 | Train Loss: 0.555 Vali Loss: 8.610 Vali Acc: 0.079 Test Loss: 8.610 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5279853
	speed: 0.6729s/iter; left time: 11969.4272s
	iters: 200, epoch: 15 | loss: 0.4751761
	speed: 0.2759s/iter; left time: 4879.8244s
Epoch: 15 cost time: 60.08020544052124
Epoch: 15, Steps: 208 | Train Loss: 0.501 Vali Loss: 8.859 Vali Acc: 0.075 Test Loss: 8.859 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.2768515
	speed: 0.6429s/iter; left time: 11302.5210s
	iters: 200, epoch: 16 | loss: 0.3481762
	speed: 0.2622s/iter; left time: 4583.4320s
Epoch: 16 cost time: 56.349029541015625
Epoch: 16, Steps: 208 | Train Loss: 0.454 Vali Loss: 8.946 Vali Acc: 0.081 Test Loss: 8.946 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6006392
	speed: 0.6533s/iter; left time: 11349.7440s
	iters: 200, epoch: 17 | loss: 0.2997342
	speed: 0.2949s/iter; left time: 5092.9521s
Epoch: 17 cost time: 60.46313762664795
Epoch: 17, Steps: 208 | Train Loss: 0.418 Vali Loss: 9.230 Vali Acc: 0.078 Test Loss: 9.230 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3146169
	speed: 0.6579s/iter; left time: 11293.5896s
	iters: 200, epoch: 18 | loss: 0.1420031
	speed: 0.2792s/iter; left time: 4764.5991s
Epoch: 18 cost time: 58.9265718460083
Epoch: 18, Steps: 208 | Train Loss: 0.385 Vali Loss: 9.462 Vali Acc: 0.084 Test Loss: 9.462 Test Acc: 0.084
Validation loss decreased (-0.081644 --> -0.084009).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4853104
	speed: 0.6410s/iter; left time: 10868.8445s
	iters: 200, epoch: 19 | loss: 0.2959767
	speed: 0.2580s/iter; left time: 4349.4662s
Epoch: 19 cost time: 56.34327983856201
Epoch: 19, Steps: 208 | Train Loss: 0.342 Vali Loss: 9.604 Vali Acc: 0.086 Test Loss: 9.604 Test Acc: 0.086
Validation loss decreased (-0.084009 --> -0.086095).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1270729
	speed: 0.6434s/iter; left time: 10776.5386s
	iters: 200, epoch: 20 | loss: 0.1083225
	speed: 0.2754s/iter; left time: 4585.1922s
Epoch: 20 cost time: 57.63900685310364
Epoch: 20, Steps: 208 | Train Loss: 0.317 Vali Loss: 9.800 Vali Acc: 0.087 Test Loss: 9.800 Test Acc: 0.087
Validation loss decreased (-0.086095 --> -0.086988).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0868107
	speed: 0.6637s/iter; left time: 10978.2239s
	iters: 200, epoch: 21 | loss: 0.5672247
	speed: 0.2872s/iter; left time: 4721.8054s
Epoch: 21 cost time: 59.71991539001465
Epoch: 21, Steps: 208 | Train Loss: 0.274 Vali Loss: 10.471 Vali Acc: 0.081 Test Loss: 10.471 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2475037
	speed: 0.6404s/iter; left time: 10458.9889s
	iters: 200, epoch: 22 | loss: 0.4265106
	speed: 0.2743s/iter; left time: 4452.8607s
Epoch: 22 cost time: 57.22631359100342
Epoch: 22, Steps: 208 | Train Loss: 0.263 Vali Loss: 10.530 Vali Acc: 0.084 Test Loss: 10.530 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2508627
	speed: 0.6254s/iter; left time: 10085.2286s
	iters: 200, epoch: 23 | loss: 0.0999375
	speed: 0.2688s/iter; left time: 4307.6409s
Epoch: 23 cost time: 57.08799433708191
Epoch: 23, Steps: 208 | Train Loss: 0.251 Vali Loss: 10.269 Vali Acc: 0.084 Test Loss: 10.269 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0546073
	speed: 0.6517s/iter; left time: 10373.4023s
	iters: 200, epoch: 24 | loss: 0.0379558
	speed: 0.2602s/iter; left time: 4115.4394s
Epoch: 24 cost time: 56.30569624900818
Epoch: 24, Steps: 208 | Train Loss: 0.226 Vali Loss: 10.719 Vali Acc: 0.085 Test Loss: 10.719 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.5274676
	speed: 0.6706s/iter; left time: 10534.7622s
	iters: 200, epoch: 25 | loss: 0.4188489
	speed: 0.2738s/iter; left time: 4274.3232s
Epoch: 25 cost time: 57.86981701850891
Epoch: 25, Steps: 208 | Train Loss: 0.190 Vali Loss: 10.677 Vali Acc: 0.082 Test Loss: 10.677 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0704844
	speed: 0.6429s/iter; left time: 9964.9692s
	iters: 200, epoch: 26 | loss: 0.2674580
	speed: 0.2848s/iter; left time: 4385.5901s
Epoch: 26 cost time: 59.68233323097229
Epoch: 26, Steps: 208 | Train Loss: 0.199 Vali Loss: 10.901 Vali Acc: 0.081 Test Loss: 10.901 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0407970
	speed: 0.6239s/iter; left time: 9541.3402s
	iters: 200, epoch: 27 | loss: 0.0323031
	speed: 0.2625s/iter; left time: 3988.6741s
Epoch: 27 cost time: 56.37336802482605
Epoch: 27, Steps: 208 | Train Loss: 0.195 Vali Loss: 11.516 Vali Acc: 0.076 Test Loss: 11.516 Test Acc: 0.076
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0587180
	speed: 0.6442s/iter; left time: 9717.1295s
	iters: 200, epoch: 28 | loss: 0.4093802
	speed: 0.2745s/iter; left time: 4113.1968s
Epoch: 28 cost time: 57.39966797828674
Epoch: 28, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.259 Vali Acc: 0.081 Test Loss: 11.259 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.5799959
	speed: 0.6551s/iter; left time: 9745.5340s
	iters: 200, epoch: 29 | loss: 0.2675433
	speed: 0.2888s/iter; left time: 4267.5768s
Epoch: 29 cost time: 59.85927677154541
Epoch: 29, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.335 Vali Acc: 0.092 Test Loss: 11.335 Test Acc: 0.092
Validation loss decreased (-0.086988 --> -0.091745).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0772156
	speed: 0.6677s/iter; left time: 9794.9170s
	iters: 200, epoch: 30 | loss: 0.2990241
	speed: 0.2673s/iter; left time: 3893.8989s
Epoch: 30 cost time: 59.062580585479736
Epoch: 30, Steps: 208 | Train Loss: 0.194 Vali Loss: 11.153 Vali Acc: 0.088 Test Loss: 11.153 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.4950443
	speed: 0.6561s/iter; left time: 9488.4567s
	iters: 200, epoch: 31 | loss: 0.2938901
	speed: 0.2940s/iter; left time: 4221.7781s
Epoch: 31 cost time: 59.74615287780762
Epoch: 31, Steps: 208 | Train Loss: 0.160 Vali Loss: 11.361 Vali Acc: 0.082 Test Loss: 11.361 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.1111035
	speed: 0.6618s/iter; left time: 9433.0853s
	iters: 200, epoch: 32 | loss: 0.0796991
	speed: 0.2756s/iter; left time: 3900.9236s
Epoch: 32 cost time: 59.35186958312988
Epoch: 32, Steps: 208 | Train Loss: 0.160 Vali Loss: 11.727 Vali Acc: 0.092 Test Loss: 11.727 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.4680319
	speed: 0.6480s/iter; left time: 9101.8526s
	iters: 200, epoch: 33 | loss: 0.2921724
	speed: 0.2902s/iter; left time: 4046.7199s
Epoch: 33 cost time: 59.69082522392273
Epoch: 33, Steps: 208 | Train Loss: 0.161 Vali Loss: 11.684 Vali Acc: 0.089 Test Loss: 11.684 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.3188900
	speed: 0.6776s/iter; left time: 9375.7876s
	iters: 200, epoch: 34 | loss: 0.0815091
	speed: 0.2932s/iter; left time: 4028.2196s
Epoch: 34 cost time: 60.685542345047
Epoch: 34, Steps: 208 | Train Loss: 0.158 Vali Loss: 11.405 Vali Acc: 0.092 Test Loss: 11.405 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0535862
	speed: 0.6362s/iter; left time: 8671.0482s
	iters: 200, epoch: 35 | loss: 0.5127917
	speed: 0.2552s/iter; left time: 3452.9163s
Epoch: 35 cost time: 56.06539440155029
Epoch: 35, Steps: 208 | Train Loss: 0.146 Vali Loss: 11.853 Vali Acc: 0.088 Test Loss: 11.853 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0272180
	speed: 0.6496s/iter; left time: 8718.0359s
	iters: 200, epoch: 36 | loss: 0.1059195
	speed: 0.2884s/iter; left time: 3842.4193s
Epoch: 36 cost time: 59.22330713272095
Epoch: 36, Steps: 208 | Train Loss: 0.132 Vali Loss: 12.067 Vali Acc: 0.089 Test Loss: 12.067 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0298043
	speed: 0.6512s/iter; left time: 8604.9116s
	iters: 200, epoch: 37 | loss: 0.0611178
	speed: 0.2592s/iter; left time: 3399.0781s
Epoch: 37 cost time: 56.82493185997009
Epoch: 37, Steps: 208 | Train Loss: 0.126 Vali Loss: 11.932 Vali Acc: 0.087 Test Loss: 11.932 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.1427159
	speed: 0.6587s/iter; left time: 8566.5471s
	iters: 200, epoch: 38 | loss: 0.0421375
	speed: 0.3055s/iter; left time: 3942.3249s
Epoch: 38 cost time: 61.70485067367554
Epoch: 38, Steps: 208 | Train Loss: 0.121 Vali Loss: 11.826 Vali Acc: 0.092 Test Loss: 11.826 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0206642
	speed: 0.6676s/iter; left time: 8543.1335s
	iters: 200, epoch: 39 | loss: 0.0769040
	speed: 0.2903s/iter; left time: 3686.4213s
Epoch: 39 cost time: 61.11444425582886
Epoch: 39, Steps: 208 | Train Loss: 0.118 Vali Loss: 12.025 Vali Acc: 0.089 Test Loss: 12.025 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0918580375782881
model parameter : 1103975
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6238620
	speed: 0.2923s/iter; left time: 6050.2793s
	iters: 200, epoch: 1 | loss: 3.3787735
	speed: 0.2795s/iter; left time: 5758.7118s
Epoch: 1 cost time: 59.84501051902771
Epoch: 1, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.649 Vali Acc: 0.073 Test Loss: 3.649 Test Acc: 0.073
Validation loss decreased (inf --> -0.072734).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5629730
	speed: 0.6644s/iter; left time: 13616.2181s
	iters: 200, epoch: 2 | loss: 2.8174627
	speed: 0.2755s/iter; left time: 5617.6043s
Epoch: 2 cost time: 58.818954944610596
Epoch: 2, Steps: 208 | Train Loss: 3.138 Vali Loss: 3.950 Vali Acc: 0.085 Test Loss: 3.950 Test Acc: 0.085
Validation loss decreased (-0.072734 --> -0.085257).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9803425
	speed: 0.6612s/iter; left time: 13411.5244s
	iters: 200, epoch: 3 | loss: 2.5930820
	speed: 0.2933s/iter; left time: 5920.5617s
Epoch: 3 cost time: 60.130544662475586
Epoch: 3, Steps: 208 | Train Loss: 2.591 Vali Loss: 4.039 Vali Acc: 0.089 Test Loss: 4.039 Test Acc: 0.089
Validation loss decreased (-0.085257 --> -0.089133).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7364962
	speed: 0.6714s/iter; left time: 13479.1818s
	iters: 200, epoch: 4 | loss: 2.0893283
	speed: 0.2638s/iter; left time: 5270.7123s
Epoch: 4 cost time: 58.6236515045166
Epoch: 4, Steps: 208 | Train Loss: 2.009 Vali Loss: 4.492 Vali Acc: 0.093 Test Loss: 4.492 Test Acc: 0.093
Validation loss decreased (-0.089133 --> -0.093006).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6932259
	speed: 0.6578s/iter; left time: 13069.3519s
	iters: 200, epoch: 5 | loss: 1.8096458
	speed: 0.2938s/iter; left time: 5808.0744s
Epoch: 5 cost time: 59.95965504646301
Epoch: 5, Steps: 208 | Train Loss: 1.464 Vali Loss: 5.095 Vali Acc: 0.098 Test Loss: 5.095 Test Acc: 0.098
Validation loss decreased (-0.093006 --> -0.098070).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1536657
	speed: 0.6622s/iter; left time: 13018.7406s
	iters: 200, epoch: 6 | loss: 1.7785947
	speed: 0.2880s/iter; left time: 5633.3662s
Epoch: 6 cost time: 59.435280561447144
Epoch: 6, Steps: 208 | Train Loss: 1.038 Vali Loss: 5.879 Vali Acc: 0.092 Test Loss: 5.879 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.2457170
	speed: 0.6700s/iter; left time: 13033.0657s
	iters: 200, epoch: 7 | loss: 0.4968269
	speed: 0.2918s/iter; left time: 5648.0034s
Epoch: 7 cost time: 61.85012698173523
Epoch: 7, Steps: 208 | Train Loss: 0.778 Vali Loss: 6.296 Vali Acc: 0.089 Test Loss: 6.296 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9713043
	speed: 0.6619s/iter; left time: 12738.4337s
	iters: 200, epoch: 8 | loss: 0.6370276
	speed: 0.2681s/iter; left time: 5132.9256s
Epoch: 8 cost time: 57.56081414222717
Epoch: 8, Steps: 208 | Train Loss: 0.582 Vali Loss: 7.053 Vali Acc: 0.092 Test Loss: 7.053 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1999395
	speed: 0.6488s/iter; left time: 12351.8888s
	iters: 200, epoch: 9 | loss: 0.1444862
	speed: 0.2824s/iter; left time: 5347.8858s
Epoch: 9 cost time: 59.23661184310913
Epoch: 9, Steps: 208 | Train Loss: 0.510 Vali Loss: 7.374 Vali Acc: 0.091 Test Loss: 7.374 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5200006
	speed: 0.6650s/iter; left time: 12522.2167s
	iters: 200, epoch: 10 | loss: 0.3349344
	speed: 0.2929s/iter; left time: 5485.9489s
Epoch: 10 cost time: 60.30362010002136
Epoch: 10, Steps: 208 | Train Loss: 0.415 Vali Loss: 7.953 Vali Acc: 0.082 Test Loss: 7.953 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7267061
	speed: 0.6752s/iter; left time: 12572.1327s
	iters: 200, epoch: 11 | loss: 0.1386116
	speed: 0.2856s/iter; left time: 5288.6758s
Epoch: 11 cost time: 59.416207790374756
Epoch: 11, Steps: 208 | Train Loss: 0.353 Vali Loss: 8.525 Vali Acc: 0.093 Test Loss: 8.525 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1292651
	speed: 0.6509s/iter; left time: 11985.1820s
	iters: 200, epoch: 12 | loss: 0.2239291
	speed: 0.2691s/iter; left time: 4927.2602s
Epoch: 12 cost time: 57.008365869522095
Epoch: 12, Steps: 208 | Train Loss: 0.306 Vali Loss: 8.828 Vali Acc: 0.086 Test Loss: 8.828 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0819192
	speed: 0.6523s/iter; left time: 11875.9412s
	iters: 200, epoch: 13 | loss: 0.4405832
	speed: 0.2835s/iter; left time: 5132.1646s
Epoch: 13 cost time: 59.795074701309204
Epoch: 13, Steps: 208 | Train Loss: 0.271 Vali Loss: 8.858 Vali Acc: 0.088 Test Loss: 8.858 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1674833
	speed: 0.6623s/iter; left time: 11920.0693s
	iters: 200, epoch: 14 | loss: 0.0257567
	speed: 0.2763s/iter; left time: 4944.8647s
Epoch: 14 cost time: 58.686869621276855
Epoch: 14, Steps: 208 | Train Loss: 0.233 Vali Loss: 9.266 Vali Acc: 0.090 Test Loss: 9.266 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0804914
	speed: 0.6431s/iter; left time: 11439.6455s
	iters: 200, epoch: 15 | loss: 0.0451590
	speed: 0.2713s/iter; left time: 4799.4156s
Epoch: 15 cost time: 57.612818479537964
Epoch: 15, Steps: 208 | Train Loss: 0.224 Vali Loss: 9.877 Vali Acc: 0.089 Test Loss: 9.877 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09812108559498957
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5703988
	speed: 0.2866s/iter; left time: 5931.9281s
	iters: 200, epoch: 1 | loss: 3.3487861
	speed: 0.2713s/iter; left time: 5589.3243s
Epoch: 1 cost time: 58.270649671554565
Epoch: 1, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.655 Vali Acc: 0.072 Test Loss: 3.655 Test Acc: 0.072
Validation loss decreased (inf --> -0.071839).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3337665
	speed: 0.6484s/iter; left time: 13287.5942s
	iters: 200, epoch: 2 | loss: 2.9306455
	speed: 0.2650s/iter; left time: 5404.1522s
Epoch: 2 cost time: 57.29159498214722
Epoch: 2, Steps: 208 | Train Loss: 3.136 Vali Loss: 3.974 Vali Acc: 0.083 Test Loss: 3.974 Test Acc: 0.083
Validation loss decreased (-0.071839 --> -0.082573).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8181223
	speed: 0.6430s/iter; left time: 13042.9326s
	iters: 200, epoch: 3 | loss: 2.9496937
	speed: 0.2714s/iter; left time: 5479.1210s
Epoch: 3 cost time: 57.21733474731445
Epoch: 3, Steps: 208 | Train Loss: 2.585 Vali Loss: 4.089 Vali Acc: 0.083 Test Loss: 4.089 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.4571590
	speed: 0.6160s/iter; left time: 12366.5781s
	iters: 200, epoch: 4 | loss: 1.7093898
	speed: 0.2732s/iter; left time: 5458.2130s
Epoch: 4 cost time: 56.45972800254822
Epoch: 4, Steps: 208 | Train Loss: 2.018 Vali Loss: 4.520 Vali Acc: 0.092 Test Loss: 4.520 Test Acc: 0.092
Validation loss decreased (-0.082573 --> -0.091813).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6196548
	speed: 0.6335s/iter; left time: 12587.1592s
	iters: 200, epoch: 5 | loss: 1.9307718
	speed: 0.2783s/iter; left time: 5501.7725s
Epoch: 5 cost time: 57.98682618141174
Epoch: 5, Steps: 208 | Train Loss: 1.467 Vali Loss: 5.099 Vali Acc: 0.098 Test Loss: 5.099 Test Acc: 0.098
Validation loss decreased (-0.091813 --> -0.098070).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0953363
	speed: 0.6464s/iter; left time: 12708.5118s
	iters: 200, epoch: 6 | loss: 1.2701583
	speed: 0.2803s/iter; left time: 5483.6357s
Epoch: 6 cost time: 57.710872173309326
Epoch: 6, Steps: 208 | Train Loss: 1.034 Vali Loss: 5.877 Vali Acc: 0.095 Test Loss: 5.877 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3060005
	speed: 0.6272s/iter; left time: 12200.6702s
	iters: 200, epoch: 7 | loss: 1.2714330
	speed: 0.2613s/iter; left time: 5057.0799s
Epoch: 7 cost time: 54.78178381919861
Epoch: 7, Steps: 208 | Train Loss: 0.784 Vali Loss: 6.547 Vali Acc: 0.090 Test Loss: 6.547 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7586497
	speed: 0.6321s/iter; left time: 12165.3451s
	iters: 200, epoch: 8 | loss: 0.9261889
	speed: 0.2562s/iter; left time: 4904.1747s
Epoch: 8 cost time: 54.8403058052063
Epoch: 8, Steps: 208 | Train Loss: 0.575 Vali Loss: 6.935 Vali Acc: 0.084 Test Loss: 6.935 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3727765
	speed: 0.6464s/iter; left time: 12304.9286s
	iters: 200, epoch: 9 | loss: 0.6114372
	speed: 0.2647s/iter; left time: 5012.4667s
Epoch: 9 cost time: 56.54751658439636
Epoch: 9, Steps: 208 | Train Loss: 0.490 Vali Loss: 7.470 Vali Acc: 0.092 Test Loss: 7.470 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3774321
	speed: 0.6414s/iter; left time: 12077.2053s
	iters: 200, epoch: 10 | loss: 0.3509768
	speed: 0.2684s/iter; left time: 5026.3198s
Epoch: 10 cost time: 57.64809775352478
Epoch: 10, Steps: 208 | Train Loss: 0.424 Vali Loss: 8.207 Vali Acc: 0.093 Test Loss: 8.207 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.5383872
	speed: 0.6254s/iter; left time: 11646.0714s
	iters: 200, epoch: 11 | loss: 0.2130163
	speed: 0.2630s/iter; left time: 4871.7653s
Epoch: 11 cost time: 55.22785758972168
Epoch: 11, Steps: 208 | Train Loss: 0.371 Vali Loss: 8.266 Vali Acc: 0.099 Test Loss: 8.266 Test Acc: 0.099
Validation loss decreased (-0.098070 --> -0.099231).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0898456
	speed: 0.6507s/iter; left time: 11982.0501s
	iters: 200, epoch: 12 | loss: 0.3239744
	speed: 0.2697s/iter; left time: 4938.7007s
Epoch: 12 cost time: 57.7792181968689
Epoch: 12, Steps: 208 | Train Loss: 0.306 Vali Loss: 8.731 Vali Acc: 0.089 Test Loss: 8.731 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3129669
	speed: 0.6405s/iter; left time: 11660.9131s
	iters: 200, epoch: 13 | loss: 0.9758104
	speed: 0.2724s/iter; left time: 4932.4704s
Epoch: 13 cost time: 56.78646206855774
Epoch: 13, Steps: 208 | Train Loss: 0.265 Vali Loss: 9.051 Vali Acc: 0.088 Test Loss: 9.051 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0641746
	speed: 0.6241s/iter; left time: 11232.0887s
	iters: 200, epoch: 14 | loss: 0.0883910
	speed: 0.2675s/iter; left time: 4787.9405s
Epoch: 14 cost time: 55.252132177352905
Epoch: 14, Steps: 208 | Train Loss: 0.237 Vali Loss: 9.609 Vali Acc: 0.089 Test Loss: 9.609 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0544147
	speed: 0.6215s/iter; left time: 11055.4368s
	iters: 200, epoch: 15 | loss: 0.3018817
	speed: 0.2731s/iter; left time: 4830.9322s
Epoch: 15 cost time: 56.763347864151
Epoch: 15, Steps: 208 | Train Loss: 0.226 Vali Loss: 9.735 Vali Acc: 0.091 Test Loss: 9.735 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0042798
	speed: 0.6404s/iter; left time: 11259.5471s
	iters: 200, epoch: 16 | loss: 0.0676157
	speed: 0.2853s/iter; left time: 4986.8850s
Epoch: 16 cost time: 58.7493314743042
Epoch: 16, Steps: 208 | Train Loss: 0.199 Vali Loss: 10.015 Vali Acc: 0.096 Test Loss: 10.015 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3497804
	speed: 0.6341s/iter; left time: 11015.6894s
	iters: 200, epoch: 17 | loss: 0.8004895
	speed: 0.2769s/iter; left time: 4782.2964s
Epoch: 17 cost time: 57.610146284103394
Epoch: 17, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.348 Vali Acc: 0.089 Test Loss: 10.348 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1890468
	speed: 0.6541s/iter; left time: 11227.7023s
	iters: 200, epoch: 18 | loss: 0.2749128
	speed: 0.2749s/iter; left time: 4691.4257s
Epoch: 18 cost time: 59.48754954338074
Epoch: 18, Steps: 208 | Train Loss: 0.178 Vali Loss: 10.121 Vali Acc: 0.089 Test Loss: 10.121 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0585002
	speed: 0.6798s/iter; left time: 11527.2691s
	iters: 200, epoch: 19 | loss: 0.3708148
	speed: 0.2828s/iter; left time: 4766.9398s
Epoch: 19 cost time: 61.201432943344116
Epoch: 19, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.346 Vali Acc: 0.090 Test Loss: 10.346 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0894353
	speed: 0.6707s/iter; left time: 11232.7393s
	iters: 200, epoch: 20 | loss: 0.0194081
	speed: 0.2712s/iter; left time: 4515.1923s
Epoch: 20 cost time: 58.921056032180786
Epoch: 20, Steps: 208 | Train Loss: 0.126 Vali Loss: 10.426 Vali Acc: 0.089 Test Loss: 10.426 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0582333
	speed: 0.6741s/iter; left time: 11150.3649s
	iters: 200, epoch: 21 | loss: 0.1106523
	speed: 0.2993s/iter; left time: 4920.9363s
Epoch: 21 cost time: 61.68862819671631
Epoch: 21, Steps: 208 | Train Loss: 0.136 Vali Loss: 10.992 Vali Acc: 0.089 Test Loss: 10.992 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09931404712198032
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5267754
	speed: 0.2897s/iter; left time: 5996.0846s
	iters: 200, epoch: 1 | loss: 3.3496399
	speed: 0.2908s/iter; left time: 5990.2828s
Epoch: 1 cost time: 60.44052076339722
Epoch: 1, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.636 Vali Acc: 0.079 Test Loss: 3.636 Test Acc: 0.079
Validation loss decreased (inf --> -0.079296).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5403237
	speed: 0.6566s/iter; left time: 13455.4608s
	iters: 200, epoch: 2 | loss: 3.1216719
	speed: 0.2742s/iter; left time: 5592.4645s
Epoch: 2 cost time: 59.30371403694153
Epoch: 2, Steps: 208 | Train Loss: 3.127 Vali Loss: 3.896 Vali Acc: 0.084 Test Loss: 3.896 Test Acc: 0.084
Validation loss decreased (-0.079296 --> -0.084065).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9796470
	speed: 0.6463s/iter; left time: 13109.4430s
	iters: 200, epoch: 3 | loss: 2.9440999
	speed: 0.2601s/iter; left time: 5250.1931s
Epoch: 3 cost time: 55.8379602432251
Epoch: 3, Steps: 208 | Train Loss: 2.564 Vali Loss: 4.020 Vali Acc: 0.090 Test Loss: 4.020 Test Acc: 0.090
Validation loss decreased (-0.084065 --> -0.090028).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9895464
	speed: 0.6343s/iter; left time: 12734.3481s
	iters: 200, epoch: 4 | loss: 2.1809821
	speed: 0.2636s/iter; left time: 5265.6492s
Epoch: 4 cost time: 56.70988988876343
Epoch: 4, Steps: 208 | Train Loss: 1.973 Vali Loss: 4.517 Vali Acc: 0.100 Test Loss: 4.517 Test Acc: 0.100
Validation loss decreased (-0.090028 --> -0.099567).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4904625
	speed: 0.6764s/iter; left time: 13439.9481s
	iters: 200, epoch: 5 | loss: 1.3685522
	speed: 0.2664s/iter; left time: 5267.1998s
Epoch: 5 cost time: 58.222484827041626
Epoch: 5, Steps: 208 | Train Loss: 1.441 Vali Loss: 5.073 Vali Acc: 0.093 Test Loss: 5.073 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6427460
	speed: 0.6650s/iter; left time: 13075.1182s
	iters: 200, epoch: 6 | loss: 1.5182254
	speed: 0.2561s/iter; left time: 5009.4636s
Epoch: 6 cost time: 55.43425512313843
Epoch: 6, Steps: 208 | Train Loss: 1.028 Vali Loss: 5.769 Vali Acc: 0.094 Test Loss: 5.769 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5918353
	speed: 0.6741s/iter; left time: 13113.7199s
	iters: 200, epoch: 7 | loss: 0.7779354
	speed: 0.2759s/iter; left time: 5339.6306s
Epoch: 7 cost time: 58.47447466850281
Epoch: 7, Steps: 208 | Train Loss: 0.799 Vali Loss: 6.479 Vali Acc: 0.084 Test Loss: 6.479 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4309193
	speed: 0.6553s/iter; left time: 12611.1517s
	iters: 200, epoch: 8 | loss: 0.7463437
	speed: 0.2884s/iter; left time: 5522.1316s
Epoch: 8 cost time: 58.35497832298279
Epoch: 8, Steps: 208 | Train Loss: 0.580 Vali Loss: 7.053 Vali Acc: 0.084 Test Loss: 7.053 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3976660
	speed: 0.6284s/iter; left time: 11962.9926s
	iters: 200, epoch: 9 | loss: 0.3186350
	speed: 0.2928s/iter; left time: 5545.3495s
Epoch: 9 cost time: 57.537171363830566
Epoch: 9, Steps: 208 | Train Loss: 0.476 Vali Loss: 7.028 Vali Acc: 0.089 Test Loss: 7.028 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2689490
	speed: 0.6402s/iter; left time: 12055.2060s
	iters: 200, epoch: 10 | loss: 0.8097865
	speed: 0.3036s/iter; left time: 5686.9968s
Epoch: 10 cost time: 60.431228160858154
Epoch: 10, Steps: 208 | Train Loss: 0.415 Vali Loss: 7.764 Vali Acc: 0.095 Test Loss: 7.764 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7703611
	speed: 0.6322s/iter; left time: 11772.7789s
	iters: 200, epoch: 11 | loss: 0.3945817
	speed: 0.2679s/iter; left time: 4962.6524s
Epoch: 11 cost time: 57.05370569229126
Epoch: 11, Steps: 208 | Train Loss: 0.397 Vali Loss: 8.517 Vali Acc: 0.085 Test Loss: 8.517 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4904480
	speed: 0.6191s/iter; left time: 11398.9990s
	iters: 200, epoch: 12 | loss: 0.4777023
	speed: 0.2696s/iter; left time: 4936.7895s
Epoch: 12 cost time: 56.68876624107361
Epoch: 12, Steps: 208 | Train Loss: 0.301 Vali Loss: 8.707 Vali Acc: 0.089 Test Loss: 8.707 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.4560908
	speed: 0.6396s/iter; left time: 11644.0622s
	iters: 200, epoch: 13 | loss: 0.0924920
	speed: 0.2693s/iter; left time: 4875.2982s
Epoch: 13 cost time: 57.111980676651
Epoch: 13, Steps: 208 | Train Loss: 0.261 Vali Loss: 8.928 Vali Acc: 0.088 Test Loss: 8.928 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1495118
	speed: 0.5962s/iter; left time: 10730.3426s
	iters: 200, epoch: 14 | loss: 0.2302880
	speed: 0.2708s/iter; left time: 4846.0506s
Epoch: 14 cost time: 55.12344765663147
Epoch: 14, Steps: 208 | Train Loss: 0.273 Vali Loss: 9.486 Vali Acc: 0.078 Test Loss: 9.486 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09961228750372801
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7876170
	speed: 0.3076s/iter; left time: 6366.9397s
	iters: 200, epoch: 1 | loss: 3.3104844
	speed: 0.2853s/iter; left time: 5877.6090s
Epoch: 1 cost time: 61.94153189659119
Epoch: 1, Steps: 208 | Train Loss: 3.689 Vali Loss: 3.637 Vali Acc: 0.070 Test Loss: 3.637 Test Acc: 0.070
Validation loss decreased (inf --> -0.070050).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7332382
	speed: 0.6792s/iter; left time: 13918.0343s
	iters: 200, epoch: 2 | loss: 3.0999608
	speed: 0.2862s/iter; left time: 5835.5725s
Epoch: 2 cost time: 60.07778072357178
Epoch: 2, Steps: 208 | Train Loss: 3.136 Vali Loss: 3.904 Vali Acc: 0.083 Test Loss: 3.904 Test Acc: 0.083
Validation loss decreased (-0.070050 --> -0.083170).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3891838
	speed: 0.6553s/iter; left time: 13292.4947s
	iters: 200, epoch: 3 | loss: 2.5789211
	speed: 0.2810s/iter; left time: 5672.8830s
Epoch: 3 cost time: 59.778393030166626
Epoch: 3, Steps: 208 | Train Loss: 2.566 Vali Loss: 3.967 Vali Acc: 0.090 Test Loss: 3.967 Test Acc: 0.090
Validation loss decreased (-0.083170 --> -0.089731).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7085820
	speed: 0.6724s/iter; left time: 13499.6291s
	iters: 200, epoch: 4 | loss: 2.5991242
	speed: 0.2925s/iter; left time: 5843.7372s
Epoch: 4 cost time: 59.81365513801575
Epoch: 4, Steps: 208 | Train Loss: 1.960 Vali Loss: 4.545 Vali Acc: 0.095 Test Loss: 4.545 Test Acc: 0.095
Validation loss decreased (-0.089731 --> -0.094497).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3170663
	speed: 0.6655s/iter; left time: 13223.6733s
	iters: 200, epoch: 5 | loss: 2.1986721
	speed: 0.2791s/iter; left time: 5518.4712s
Epoch: 5 cost time: 58.98744511604309
Epoch: 5, Steps: 208 | Train Loss: 1.397 Vali Loss: 5.061 Vali Acc: 0.093 Test Loss: 5.061 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9829862
	speed: 0.6588s/iter; left time: 12952.5822s
	iters: 200, epoch: 6 | loss: 1.1252435
	speed: 0.2602s/iter; left time: 5089.9058s
Epoch: 6 cost time: 57.707539081573486
Epoch: 6, Steps: 208 | Train Loss: 1.008 Vali Loss: 5.697 Vali Acc: 0.096 Test Loss: 5.697 Test Acc: 0.096
Validation loss decreased (-0.094497 --> -0.096275).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8508475
	speed: 0.6492s/iter; left time: 12628.1090s
	iters: 200, epoch: 7 | loss: 0.9278295
	speed: 0.2834s/iter; left time: 5485.0441s
Epoch: 7 cost time: 57.26168155670166
Epoch: 7, Steps: 208 | Train Loss: 0.741 Vali Loss: 6.414 Vali Acc: 0.094 Test Loss: 6.414 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7036731
	speed: 0.6302s/iter; left time: 12128.1392s
	iters: 200, epoch: 8 | loss: 0.7716584
	speed: 0.2741s/iter; left time: 5247.0291s
Epoch: 8 cost time: 58.45080494880676
Epoch: 8, Steps: 208 | Train Loss: 0.606 Vali Loss: 7.126 Vali Acc: 0.091 Test Loss: 7.126 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4528152
	speed: 0.6524s/iter; left time: 12419.1642s
	iters: 200, epoch: 9 | loss: 0.0541356
	speed: 0.2702s/iter; left time: 5117.5425s
Epoch: 9 cost time: 58.613325119018555
Epoch: 9, Steps: 208 | Train Loss: 0.468 Vali Loss: 7.402 Vali Acc: 0.097 Test Loss: 7.402 Test Acc: 0.097
Validation loss decreased (-0.096275 --> -0.097152).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3370395
	speed: 0.6336s/iter; left time: 11930.3862s
	iters: 200, epoch: 10 | loss: 0.7023615
	speed: 0.2788s/iter; left time: 5221.8853s
Epoch: 10 cost time: 56.34636855125427
Epoch: 10, Steps: 208 | Train Loss: 0.422 Vali Loss: 7.923 Vali Acc: 0.095 Test Loss: 7.923 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7100886
	speed: 0.6267s/iter; left time: 11669.0527s
	iters: 200, epoch: 11 | loss: 0.8444051
	speed: 0.2915s/iter; left time: 5398.2341s
Epoch: 11 cost time: 59.93728280067444
Epoch: 11, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.296 Vali Acc: 0.090 Test Loss: 8.296 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0764688
	speed: 0.6683s/iter; left time: 12305.1199s
	iters: 200, epoch: 12 | loss: 0.5287537
	speed: 0.2849s/iter; left time: 5217.9609s
Epoch: 12 cost time: 60.21884036064148
Epoch: 12, Steps: 208 | Train Loss: 0.339 Vali Loss: 8.073 Vali Acc: 0.095 Test Loss: 8.073 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1115979
	speed: 0.6557s/iter; left time: 11936.2802s
	iters: 200, epoch: 13 | loss: 0.6818398
	speed: 0.2895s/iter; left time: 5241.6186s
Epoch: 13 cost time: 58.06324648857117
Epoch: 13, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.806 Vali Acc: 0.094 Test Loss: 8.806 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1457004
	speed: 0.6414s/iter; left time: 11543.0803s
	iters: 200, epoch: 14 | loss: 0.1766112
	speed: 0.2825s/iter; left time: 5056.1756s
Epoch: 14 cost time: 58.53650259971619
Epoch: 14, Steps: 208 | Train Loss: 0.287 Vali Loss: 9.198 Vali Acc: 0.095 Test Loss: 9.198 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0291035
	speed: 0.6490s/iter; left time: 11544.8102s
	iters: 200, epoch: 15 | loss: 0.0205392
	speed: 0.2769s/iter; left time: 4898.3212s
Epoch: 15 cost time: 58.319502115249634
Epoch: 15, Steps: 208 | Train Loss: 0.200 Vali Loss: 9.194 Vali Acc: 0.093 Test Loss: 9.194 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0358111
	speed: 0.6558s/iter; left time: 11529.6342s
	iters: 200, epoch: 16 | loss: 0.1584512
	speed: 0.2788s/iter; left time: 4873.2746s
Epoch: 16 cost time: 57.91258454322815
Epoch: 16, Steps: 208 | Train Loss: 0.200 Vali Loss: 9.502 Vali Acc: 0.096 Test Loss: 9.502 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.1140734
	speed: 0.6613s/iter; left time: 11488.3294s
	iters: 200, epoch: 17 | loss: 0.2497360
	speed: 0.2908s/iter; left time: 5022.4738s
Epoch: 17 cost time: 60.27907085418701
Epoch: 17, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.034 Vali Acc: 0.095 Test Loss: 10.034 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0692284
	speed: 0.6459s/iter; left time: 11087.2944s
	iters: 200, epoch: 18 | loss: 0.0284155
	speed: 0.2678s/iter; left time: 4569.4313s
Epoch: 18 cost time: 58.06034278869629
Epoch: 18, Steps: 208 | Train Loss: 0.171 Vali Loss: 10.248 Vali Acc: 0.094 Test Loss: 10.248 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1632192
	speed: 0.6599s/iter; left time: 11189.6622s
	iters: 200, epoch: 19 | loss: 0.1536230
	speed: 0.2938s/iter; left time: 4951.9236s
Epoch: 19 cost time: 60.303242444992065
Epoch: 19, Steps: 208 | Train Loss: 0.168 Vali Loss: 10.512 Vali Acc: 0.090 Test Loss: 10.512 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0972263644497465
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7290828
	speed: 0.2866s/iter; left time: 5933.0040s
	iters: 200, epoch: 1 | loss: 3.4428267
	speed: 0.2655s/iter; left time: 5469.2105s
Epoch: 1 cost time: 57.781797885894775
Epoch: 1, Steps: 208 | Train Loss: 3.660 Vali Loss: 3.696 Vali Acc: 0.074 Test Loss: 3.696 Test Acc: 0.074
Validation loss decreased (inf --> -0.073927).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5476761
	speed: 0.6452s/iter; left time: 13222.9609s
	iters: 200, epoch: 2 | loss: 2.4040298
	speed: 0.2821s/iter; left time: 5752.9807s
Epoch: 2 cost time: 57.65750026702881
Epoch: 2, Steps: 208 | Train Loss: 3.123 Vali Loss: 3.944 Vali Acc: 0.072 Test Loss: 3.944 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2916536
	speed: 0.6365s/iter; left time: 12910.8424s
	iters: 200, epoch: 3 | loss: 2.5054598
	speed: 0.2848s/iter; left time: 5749.3980s
Epoch: 3 cost time: 58.26349449157715
Epoch: 3, Steps: 208 | Train Loss: 2.592 Vali Loss: 4.121 Vali Acc: 0.085 Test Loss: 4.121 Test Acc: 0.085
Validation loss decreased (-0.073927 --> -0.085256).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5359204
	speed: 0.6704s/iter; left time: 13458.8524s
	iters: 200, epoch: 4 | loss: 2.1317630
	speed: 0.2768s/iter; left time: 5530.0305s
Epoch: 4 cost time: 60.07105565071106
Epoch: 4, Steps: 208 | Train Loss: 2.013 Vali Loss: 4.488 Vali Acc: 0.089 Test Loss: 4.488 Test Acc: 0.089
Validation loss decreased (-0.085256 --> -0.088533).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7567937
	speed: 0.6653s/iter; left time: 13219.4352s
	iters: 200, epoch: 5 | loss: 2.2720535
	speed: 0.2758s/iter; left time: 5451.3531s
Epoch: 5 cost time: 58.6527943611145
Epoch: 5, Steps: 208 | Train Loss: 1.479 Vali Loss: 5.187 Vali Acc: 0.083 Test Loss: 5.187 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4845452
	speed: 0.6605s/iter; left time: 12986.1237s
	iters: 200, epoch: 6 | loss: 1.7360286
	speed: 0.2982s/iter; left time: 5832.4984s
Epoch: 6 cost time: 60.313485860824585
Epoch: 6, Steps: 208 | Train Loss: 1.102 Vali Loss: 5.785 Vali Acc: 0.096 Test Loss: 5.785 Test Acc: 0.096
Validation loss decreased (-0.088533 --> -0.096274).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8657565
	speed: 0.6752s/iter; left time: 13134.3160s
	iters: 200, epoch: 7 | loss: 1.5953716
	speed: 0.2840s/iter; left time: 5496.9883s
Epoch: 7 cost time: 60.605679512023926
Epoch: 7, Steps: 208 | Train Loss: 0.818 Vali Loss: 6.383 Vali Acc: 0.086 Test Loss: 6.383 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1523634
	speed: 0.6656s/iter; left time: 12809.2255s
	iters: 200, epoch: 8 | loss: 0.7056999
	speed: 0.2778s/iter; left time: 5318.9137s
Epoch: 8 cost time: 59.59902906417847
Epoch: 8, Steps: 208 | Train Loss: 0.629 Vali Loss: 6.627 Vali Acc: 0.103 Test Loss: 6.627 Test Acc: 0.103
Validation loss decreased (-0.096274 --> -0.103125).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3755524
	speed: 0.6569s/iter; left time: 12505.7767s
	iters: 200, epoch: 9 | loss: 0.6377095
	speed: 0.2926s/iter; left time: 5541.0244s
Epoch: 9 cost time: 59.212523221969604
Epoch: 9, Steps: 208 | Train Loss: 0.514 Vali Loss: 7.107 Vali Acc: 0.105 Test Loss: 7.107 Test Acc: 0.105
Validation loss decreased (-0.103125 --> -0.104611).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8418381
	speed: 0.6699s/iter; left time: 12613.6357s
	iters: 200, epoch: 10 | loss: 0.5994072
	speed: 0.2943s/iter; left time: 5511.2210s
Epoch: 10 cost time: 61.34455919265747
Epoch: 10, Steps: 208 | Train Loss: 0.461 Vali Loss: 7.489 Vali Acc: 0.106 Test Loss: 7.489 Test Acc: 0.106
Validation loss decreased (-0.104611 --> -0.106397).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4243872
	speed: 0.6697s/iter; left time: 12470.3103s
	iters: 200, epoch: 11 | loss: 0.4806981
	speed: 0.2642s/iter; left time: 4893.5583s
Epoch: 11 cost time: 57.80629110336304
Epoch: 11, Steps: 208 | Train Loss: 0.426 Vali Loss: 7.854 Vali Acc: 0.102 Test Loss: 7.854 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7014393
	speed: 0.6519s/iter; left time: 12002.9058s
	iters: 200, epoch: 12 | loss: 0.6593678
	speed: 0.2912s/iter; left time: 5332.2254s
Epoch: 12 cost time: 59.5247757434845
Epoch: 12, Steps: 208 | Train Loss: 0.360 Vali Loss: 8.749 Vali Acc: 0.098 Test Loss: 8.749 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4239330
	speed: 0.6727s/iter; left time: 12246.1335s
	iters: 200, epoch: 13 | loss: 0.3295393
	speed: 0.2873s/iter; left time: 5201.7047s
Epoch: 13 cost time: 60.87458419799805
Epoch: 13, Steps: 208 | Train Loss: 0.312 Vali Loss: 8.553 Vali Acc: 0.097 Test Loss: 8.553 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2153930
	speed: 0.6894s/iter; left time: 12407.8674s
	iters: 200, epoch: 14 | loss: 0.2238942
	speed: 0.2840s/iter; left time: 5082.1665s
Epoch: 14 cost time: 61.084789752960205
Epoch: 14, Steps: 208 | Train Loss: 0.270 Vali Loss: 9.015 Vali Acc: 0.094 Test Loss: 9.015 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0292931
	speed: 0.6376s/iter; left time: 11341.7043s
	iters: 200, epoch: 15 | loss: 0.1517422
	speed: 0.2777s/iter; left time: 4911.5972s
Epoch: 15 cost time: 56.76175379753113
Epoch: 15, Steps: 208 | Train Loss: 0.270 Vali Loss: 8.682 Vali Acc: 0.092 Test Loss: 8.682 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1087105
	speed: 0.6584s/iter; left time: 11575.0549s
	iters: 200, epoch: 16 | loss: 0.0733315
	speed: 0.3051s/iter; left time: 5333.7666s
Epoch: 16 cost time: 60.601446866989136
Epoch: 16, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.336 Vali Acc: 0.097 Test Loss: 9.336 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0247392
	speed: 0.6504s/iter; left time: 11299.7332s
	iters: 200, epoch: 17 | loss: 0.6054537
	speed: 0.2834s/iter; left time: 4895.4453s
Epoch: 17 cost time: 60.162107944488525
Epoch: 17, Steps: 208 | Train Loss: 0.195 Vali Loss: 9.865 Vali Acc: 0.093 Test Loss: 9.865 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.2216778
	speed: 0.6827s/iter; left time: 11717.8104s
	iters: 200, epoch: 18 | loss: 0.1117807
	speed: 0.2905s/iter; left time: 4956.6674s
Epoch: 18 cost time: 61.25471019744873
Epoch: 18, Steps: 208 | Train Loss: 0.199 Vali Loss: 9.883 Vali Acc: 0.090 Test Loss: 9.883 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.4607723
	speed: 0.6272s/iter; left time: 10635.6466s
	iters: 200, epoch: 19 | loss: 0.1673942
	speed: 0.2883s/iter; left time: 4860.4179s
Epoch: 19 cost time: 57.75280570983887
Epoch: 19, Steps: 208 | Train Loss: 0.165 Vali Loss: 9.260 Vali Acc: 0.103 Test Loss: 9.260 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.5993165
	speed: 0.6628s/iter; left time: 11101.7669s
	iters: 200, epoch: 20 | loss: 0.0825071
	speed: 0.2829s/iter; left time: 4709.1955s
Epoch: 20 cost time: 59.77615714073181
Epoch: 20, Steps: 208 | Train Loss: 0.144 Vali Loss: 10.406 Vali Acc: 0.101 Test Loss: 10.406 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10647181628392484
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6425719
	speed: 0.2981s/iter; left time: 6171.5575s
	iters: 200, epoch: 1 | loss: 3.5264509
	speed: 0.2635s/iter; left time: 5427.8955s
Epoch: 1 cost time: 58.91232466697693
Epoch: 1, Steps: 208 | Train Loss: 3.615 Vali Loss: 3.725 Vali Acc: 0.073 Test Loss: 3.725 Test Acc: 0.073
Validation loss decreased (inf --> -0.073330).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6204011
	speed: 0.6509s/iter; left time: 13338.6248s
	iters: 200, epoch: 2 | loss: 2.8289230
	speed: 0.2721s/iter; left time: 5549.5480s
Epoch: 2 cost time: 58.28240942955017
Epoch: 2, Steps: 208 | Train Loss: 3.054 Vali Loss: 4.007 Vali Acc: 0.077 Test Loss: 4.007 Test Acc: 0.077
Validation loss decreased (-0.073330 --> -0.076906).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2001982
	speed: 0.6217s/iter; left time: 12611.0542s
	iters: 200, epoch: 3 | loss: 3.2091913
	speed: 0.2673s/iter; left time: 5396.2350s
Epoch: 3 cost time: 56.40101170539856
Epoch: 3, Steps: 208 | Train Loss: 2.607 Vali Loss: 4.095 Vali Acc: 0.094 Test Loss: 4.095 Test Acc: 0.094
Validation loss decreased (-0.076906 --> -0.093905).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5628891
	speed: 0.6313s/iter; left time: 12673.6529s
	iters: 200, epoch: 4 | loss: 2.4902453
	speed: 0.2786s/iter; left time: 5565.6057s
Epoch: 4 cost time: 57.4673969745636
Epoch: 4, Steps: 208 | Train Loss: 2.118 Vali Loss: 4.554 Vali Acc: 0.093 Test Loss: 4.554 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6381062
	speed: 0.6172s/iter; left time: 12263.6133s
	iters: 200, epoch: 5 | loss: 2.5606332
	speed: 0.2764s/iter; left time: 5464.2015s
Epoch: 5 cost time: 57.07248306274414
Epoch: 5, Steps: 208 | Train Loss: 1.667 Vali Loss: 5.118 Vali Acc: 0.099 Test Loss: 5.118 Test Acc: 0.099
Validation loss decreased (-0.093905 --> -0.098666).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6247786
	speed: 0.6550s/iter; left time: 12877.4290s
	iters: 200, epoch: 6 | loss: 1.7181410
	speed: 0.2941s/iter; left time: 5752.8734s
Epoch: 6 cost time: 60.73251986503601
Epoch: 6, Steps: 208 | Train Loss: 1.239 Vali Loss: 5.559 Vali Acc: 0.093 Test Loss: 5.559 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8052487
	speed: 0.6789s/iter; left time: 13207.2295s
	iters: 200, epoch: 7 | loss: 1.6603653
	speed: 0.2723s/iter; left time: 5270.6270s
Epoch: 7 cost time: 59.270402908325195
Epoch: 7, Steps: 208 | Train Loss: 1.006 Vali Loss: 5.994 Vali Acc: 0.090 Test Loss: 5.994 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2963800
	speed: 0.6418s/iter; left time: 12351.0699s
	iters: 200, epoch: 8 | loss: 1.0456342
	speed: 0.2870s/iter; left time: 5494.7090s
Epoch: 8 cost time: 59.64654779434204
Epoch: 8, Steps: 208 | Train Loss: 0.762 Vali Loss: 6.231 Vali Acc: 0.096 Test Loss: 6.231 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4226214
	speed: 0.6386s/iter; left time: 12157.8097s
	iters: 200, epoch: 9 | loss: 0.9497849
	speed: 0.2707s/iter; left time: 5126.5999s
Epoch: 9 cost time: 57.23832583427429
Epoch: 9, Steps: 208 | Train Loss: 0.642 Vali Loss: 6.896 Vali Acc: 0.100 Test Loss: 6.896 Test Acc: 0.100
Validation loss decreased (-0.098666 --> -0.099842).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5401928
	speed: 0.6366s/iter; left time: 11985.8339s
	iters: 200, epoch: 10 | loss: 0.2837374
	speed: 0.2867s/iter; left time: 5369.2388s
Epoch: 10 cost time: 59.28130888938904
Epoch: 10, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.724 Vali Acc: 0.092 Test Loss: 6.724 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6977602
	speed: 0.6778s/iter; left time: 12621.6694s
	iters: 200, epoch: 11 | loss: 0.3046886
	speed: 0.2869s/iter; left time: 5313.6961s
Epoch: 11 cost time: 60.335275411605835
Epoch: 11, Steps: 208 | Train Loss: 0.502 Vali Loss: 7.633 Vali Acc: 0.093 Test Loss: 7.633 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5155278
	speed: 0.6544s/iter; left time: 12049.6274s
	iters: 200, epoch: 12 | loss: 1.0368423
	speed: 0.2722s/iter; left time: 4984.4435s
Epoch: 12 cost time: 57.691558837890625
Epoch: 12, Steps: 208 | Train Loss: 0.446 Vali Loss: 7.810 Vali Acc: 0.097 Test Loss: 7.810 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3222211
	speed: 0.6792s/iter; left time: 12365.5489s
	iters: 200, epoch: 13 | loss: 0.7894855
	speed: 0.2770s/iter; left time: 5014.3472s
Epoch: 13 cost time: 60.73093557357788
Epoch: 13, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.135 Vali Acc: 0.102 Test Loss: 8.135 Test Acc: 0.102
Validation loss decreased (-0.099842 --> -0.102215).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3483979
	speed: 0.6324s/iter; left time: 11381.6686s
	iters: 200, epoch: 14 | loss: 0.3932068
	speed: 0.2717s/iter; left time: 4863.0316s
Epoch: 14 cost time: 56.8662474155426
Epoch: 14, Steps: 208 | Train Loss: 0.364 Vali Loss: 8.375 Vali Acc: 0.092 Test Loss: 8.375 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0777854
	speed: 0.6221s/iter; left time: 11065.9996s
	iters: 200, epoch: 15 | loss: 0.1486617
	speed: 0.2645s/iter; left time: 4679.5011s
Epoch: 15 cost time: 55.53331542015076
Epoch: 15, Steps: 208 | Train Loss: 0.324 Vali Loss: 8.420 Vali Acc: 0.098 Test Loss: 8.420 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.2584497
	speed: 0.6218s/iter; left time: 10931.3969s
	iters: 200, epoch: 16 | loss: 0.2734157
	speed: 0.2605s/iter; left time: 4553.5934s
Epoch: 16 cost time: 54.68285393714905
Epoch: 16, Steps: 208 | Train Loss: 0.295 Vali Loss: 8.898 Vali Acc: 0.103 Test Loss: 8.898 Test Acc: 0.103
Validation loss decreased (-0.102215 --> -0.103400).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0499563
	speed: 0.6534s/iter; left time: 11352.0074s
	iters: 200, epoch: 17 | loss: 0.2487022
	speed: 0.2689s/iter; left time: 4644.9783s
Epoch: 17 cost time: 57.13139629364014
Epoch: 17, Steps: 208 | Train Loss: 0.269 Vali Loss: 8.836 Vali Acc: 0.098 Test Loss: 8.836 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3293188
	speed: 0.6379s/iter; left time: 10948.7903s
	iters: 200, epoch: 18 | loss: 0.0903465
	speed: 0.2800s/iter; left time: 4778.3590s
Epoch: 18 cost time: 56.92933392524719
Epoch: 18, Steps: 208 | Train Loss: 0.265 Vali Loss: 9.254 Vali Acc: 0.099 Test Loss: 9.254 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3470874
	speed: 0.6260s/iter; left time: 10614.4409s
	iters: 200, epoch: 19 | loss: 0.0805159
	speed: 0.2757s/iter; left time: 4647.5780s
Epoch: 19 cost time: 56.831154108047485
Epoch: 19, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.353 Vali Acc: 0.106 Test Loss: 9.353 Test Acc: 0.106
Validation loss decreased (-0.103400 --> -0.106378).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.8919520
	speed: 0.6328s/iter; left time: 10598.2963s
	iters: 200, epoch: 20 | loss: 0.1766924
	speed: 0.2806s/iter; left time: 4671.8737s
Epoch: 20 cost time: 57.941606283187866
Epoch: 20, Steps: 208 | Train Loss: 0.204 Vali Loss: 9.551 Vali Acc: 0.103 Test Loss: 9.551 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0239915
	speed: 0.6447s/iter; left time: 10664.7682s
	iters: 200, epoch: 21 | loss: 0.1591952
	speed: 0.2674s/iter; left time: 4396.0692s
Epoch: 21 cost time: 56.80083966255188
Epoch: 21, Steps: 208 | Train Loss: 0.208 Vali Loss: 10.281 Vali Acc: 0.099 Test Loss: 10.281 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0367769
	speed: 0.6133s/iter; left time: 10016.6644s
	iters: 200, epoch: 22 | loss: 0.5592815
	speed: 0.2674s/iter; left time: 4341.4210s
Epoch: 22 cost time: 56.40281653404236
Epoch: 22, Steps: 208 | Train Loss: 0.189 Vali Loss: 10.250 Vali Acc: 0.098 Test Loss: 10.250 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0051304
	speed: 0.6188s/iter; left time: 9978.4061s
	iters: 200, epoch: 23 | loss: 0.6519949
	speed: 0.2703s/iter; left time: 4331.1785s
Epoch: 23 cost time: 56.63427996635437
Epoch: 23, Steps: 208 | Train Loss: 0.173 Vali Loss: 9.969 Vali Acc: 0.107 Test Loss: 9.969 Test Acc: 0.107
Validation loss decreased (-0.106378 --> -0.107267).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.6205989
	speed: 0.6406s/iter; left time: 10197.0061s
	iters: 200, epoch: 24 | loss: 0.0706248
	speed: 0.2796s/iter; left time: 4422.3854s
Epoch: 24 cost time: 58.79976773262024
Epoch: 24, Steps: 208 | Train Loss: 0.158 Vali Loss: 10.472 Vali Acc: 0.109 Test Loss: 10.472 Test Acc: 0.109
Validation loss decreased (-0.107267 --> -0.108455).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6879430
	speed: 0.6470s/iter; left time: 10162.9607s
	iters: 200, epoch: 25 | loss: 0.5457779
	speed: 0.2598s/iter; left time: 4055.2152s
Epoch: 25 cost time: 56.01764225959778
Epoch: 25, Steps: 208 | Train Loss: 0.154 Vali Loss: 10.244 Vali Acc: 0.100 Test Loss: 10.244 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0447720
	speed: 0.6138s/iter; left time: 9514.1433s
	iters: 200, epoch: 26 | loss: 0.4344572
	speed: 0.2636s/iter; left time: 4059.2404s
Epoch: 26 cost time: 55.185667753219604
Epoch: 26, Steps: 208 | Train Loss: 0.150 Vali Loss: 10.978 Vali Acc: 0.105 Test Loss: 10.978 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0016951
	speed: 0.6397s/iter; left time: 9783.0553s
	iters: 200, epoch: 27 | loss: 0.0063448
	speed: 0.2693s/iter; left time: 4092.2301s
Epoch: 27 cost time: 56.74976134300232
Epoch: 27, Steps: 208 | Train Loss: 0.138 Vali Loss: 11.194 Vali Acc: 0.096 Test Loss: 11.194 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1023209
	speed: 0.6476s/iter; left time: 9768.6489s
	iters: 200, epoch: 28 | loss: 0.5387281
	speed: 0.2738s/iter; left time: 4103.1793s
Epoch: 28 cost time: 56.970197439193726
Epoch: 28, Steps: 208 | Train Loss: 0.147 Vali Loss: 10.455 Vali Acc: 0.108 Test Loss: 10.455 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.3576920
	speed: 0.6293s/iter; left time: 9362.7577s
	iters: 200, epoch: 29 | loss: 0.0119978
	speed: 0.2697s/iter; left time: 3984.6358s
Epoch: 29 cost time: 56.124380111694336
Epoch: 29, Steps: 208 | Train Loss: 0.161 Vali Loss: 11.207 Vali Acc: 0.104 Test Loss: 11.207 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.4344122
	speed: 0.5964s/iter; left time: 8749.0195s
	iters: 200, epoch: 30 | loss: 0.3663938
	speed: 0.2597s/iter; left time: 3783.2810s
Epoch: 30 cost time: 54.01357960700989
Epoch: 30, Steps: 208 | Train Loss: 0.135 Vali Loss: 11.042 Vali Acc: 0.097 Test Loss: 11.042 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0032800
	speed: 0.6244s/iter; left time: 9030.0142s
	iters: 200, epoch: 31 | loss: 0.0429742
	speed: 0.2780s/iter; left time: 3992.5565s
Epoch: 31 cost time: 57.50528025627136
Epoch: 31, Steps: 208 | Train Loss: 0.116 Vali Loss: 11.289 Vali Acc: 0.095 Test Loss: 11.289 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.4167871
	speed: 0.6448s/iter; left time: 9190.0643s
	iters: 200, epoch: 32 | loss: 0.0500249
	speed: 0.2884s/iter; left time: 4081.8559s
Epoch: 32 cost time: 59.56445550918579
Epoch: 32, Steps: 208 | Train Loss: 0.134 Vali Loss: 11.901 Vali Acc: 0.099 Test Loss: 11.901 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.3883652
	speed: 0.6075s/iter; left time: 8533.0355s
	iters: 200, epoch: 33 | loss: 0.2533659
	speed: 0.2938s/iter; left time: 4096.9062s
Epoch: 33 cost time: 58.574880838394165
Epoch: 33, Steps: 208 | Train Loss: 0.144 Vali Loss: 11.380 Vali Acc: 0.093 Test Loss: 11.380 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000887
	speed: 0.6414s/iter; left time: 8874.9102s
	iters: 200, epoch: 34 | loss: 0.1635127
	speed: 0.2704s/iter; left time: 3714.2157s
Epoch: 34 cost time: 57.68128490447998
Epoch: 34, Steps: 208 | Train Loss: 0.130 Vali Loss: 11.707 Vali Acc: 0.090 Test Loss: 11.707 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10855949895615867
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6419435
	speed: 0.2942s/iter; left time: 6090.1094s
	iters: 200, epoch: 1 | loss: 3.3965590
	speed: 0.2683s/iter; left time: 5527.8205s
Epoch: 1 cost time: 58.671470403671265
Epoch: 1, Steps: 208 | Train Loss: 3.614 Vali Loss: 3.755 Vali Acc: 0.075 Test Loss: 3.755 Test Acc: 0.075
Validation loss decreased (inf --> -0.074523).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6503944
	speed: 0.6119s/iter; left time: 12539.2978s
	iters: 200, epoch: 2 | loss: 2.8167949
	speed: 0.2662s/iter; left time: 5429.4674s
Epoch: 2 cost time: 54.83178925514221
Epoch: 2, Steps: 208 | Train Loss: 3.137 Vali Loss: 4.109 Vali Acc: 0.068 Test Loss: 4.109 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4338276
	speed: 0.6529s/iter; left time: 13244.7584s
	iters: 200, epoch: 3 | loss: 2.8504961
	speed: 0.2522s/iter; left time: 5091.3684s
Epoch: 3 cost time: 55.67190885543823
Epoch: 3, Steps: 208 | Train Loss: 2.821 Vali Loss: 4.177 Vali Acc: 0.081 Test Loss: 4.177 Test Acc: 0.081
Validation loss decreased (-0.074523 --> -0.080483).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0491683
	speed: 0.6447s/iter; left time: 12943.1692s
	iters: 200, epoch: 4 | loss: 2.6818280
	speed: 0.2687s/iter; left time: 5368.5413s
Epoch: 4 cost time: 56.79509401321411
Epoch: 4, Steps: 208 | Train Loss: 2.465 Vali Loss: 4.710 Vali Acc: 0.079 Test Loss: 4.710 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9274607
	speed: 0.6311s/iter; left time: 12539.4494s
	iters: 200, epoch: 5 | loss: 2.4955668
	speed: 0.2810s/iter; left time: 5554.4542s
Epoch: 5 cost time: 58.53925681114197
Epoch: 5, Steps: 208 | Train Loss: 2.088 Vali Loss: 4.968 Vali Acc: 0.085 Test Loss: 4.968 Test Acc: 0.085
Validation loss decreased (-0.080483 --> -0.085247).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9297179
	speed: 0.6504s/iter; left time: 12787.3568s
	iters: 200, epoch: 6 | loss: 2.4985349
	speed: 0.2987s/iter; left time: 5842.8499s
Epoch: 6 cost time: 60.77581572532654
Epoch: 6, Steps: 208 | Train Loss: 1.669 Vali Loss: 5.438 Vali Acc: 0.084 Test Loss: 5.438 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7995851
	speed: 0.6194s/iter; left time: 12050.0682s
	iters: 200, epoch: 7 | loss: 2.2761328
	speed: 0.3052s/iter; left time: 5906.5592s
Epoch: 7 cost time: 61.25108480453491
Epoch: 7, Steps: 208 | Train Loss: 1.377 Vali Loss: 5.858 Vali Acc: 0.080 Test Loss: 5.858 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5494001
	speed: 0.6394s/iter; left time: 12305.9229s
	iters: 200, epoch: 8 | loss: 1.2532593
	speed: 0.2850s/iter; left time: 5456.9790s
Epoch: 8 cost time: 60.141109466552734
Epoch: 8, Steps: 208 | Train Loss: 1.081 Vali Loss: 6.171 Vali Acc: 0.077 Test Loss: 6.171 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6951469
	speed: 0.5972s/iter; left time: 11368.9035s
	iters: 200, epoch: 9 | loss: 0.8532839
	speed: 0.2691s/iter; left time: 5096.1014s
Epoch: 9 cost time: 55.261176347732544
Epoch: 9, Steps: 208 | Train Loss: 0.893 Vali Loss: 6.258 Vali Acc: 0.097 Test Loss: 6.258 Test Acc: 0.097
Validation loss decreased (-0.085247 --> -0.096866).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9694168
	speed: 0.6171s/iter; left time: 11619.4756s
	iters: 200, epoch: 10 | loss: 0.9463135
	speed: 0.2926s/iter; left time: 5480.8662s
Epoch: 10 cost time: 60.62052655220032
Epoch: 10, Steps: 208 | Train Loss: 0.810 Vali Loss: 6.722 Vali Acc: 0.091 Test Loss: 6.722 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7981101
	speed: 0.6319s/iter; left time: 11766.3104s
	iters: 200, epoch: 11 | loss: 0.7880412
	speed: 0.2831s/iter; left time: 5243.9541s
Epoch: 11 cost time: 59.34300136566162
Epoch: 11, Steps: 208 | Train Loss: 0.698 Vali Loss: 7.353 Vali Acc: 0.085 Test Loss: 7.353 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4819416
	speed: 0.6575s/iter; left time: 12106.6556s
	iters: 200, epoch: 12 | loss: 0.6751738
	speed: 0.2831s/iter; left time: 5185.1821s
Epoch: 12 cost time: 58.63705492019653
Epoch: 12, Steps: 208 | Train Loss: 0.618 Vali Loss: 7.397 Vali Acc: 0.087 Test Loss: 7.397 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2280034
	speed: 0.6584s/iter; left time: 11986.9410s
	iters: 200, epoch: 13 | loss: 1.2245673
	speed: 0.2743s/iter; left time: 4965.4804s
Epoch: 13 cost time: 60.21873116493225
Epoch: 13, Steps: 208 | Train Loss: 0.540 Vali Loss: 7.741 Vali Acc: 0.089 Test Loss: 7.741 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1158215
	speed: 0.6540s/iter; left time: 11769.1434s
	iters: 200, epoch: 14 | loss: 0.2425910
	speed: 0.2885s/iter; left time: 5163.1637s
Epoch: 14 cost time: 59.77404499053955
Epoch: 14, Steps: 208 | Train Loss: 0.504 Vali Loss: 7.759 Vali Acc: 0.084 Test Loss: 7.759 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2090567
	speed: 0.6629s/iter; left time: 11792.5078s
	iters: 200, epoch: 15 | loss: 0.3478999
	speed: 0.2995s/iter; left time: 5297.2849s
Epoch: 15 cost time: 61.50970149040222
Epoch: 15, Steps: 208 | Train Loss: 0.450 Vali Loss: 7.939 Vali Acc: 0.100 Test Loss: 7.939 Test Acc: 0.100
Validation loss decreased (-0.096866 --> -0.099533).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9900947
	speed: 0.6674s/iter; left time: 11732.8018s
	iters: 200, epoch: 16 | loss: 0.3266208
	speed: 0.2866s/iter; left time: 5010.0799s
Epoch: 16 cost time: 61.987183570861816
Epoch: 16, Steps: 208 | Train Loss: 0.399 Vali Loss: 8.014 Vali Acc: 0.089 Test Loss: 8.014 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4156625
	speed: 0.6813s/iter; left time: 11836.0466s
	iters: 200, epoch: 17 | loss: 0.5078961
	speed: 0.2970s/iter; left time: 5130.5315s
Epoch: 17 cost time: 61.90295696258545
Epoch: 17, Steps: 208 | Train Loss: 0.363 Vali Loss: 8.322 Vali Acc: 0.093 Test Loss: 8.322 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4853922
	speed: 0.6555s/iter; left time: 11250.9387s
	iters: 200, epoch: 18 | loss: 0.1027906
	speed: 0.2815s/iter; left time: 4804.3447s
Epoch: 18 cost time: 60.43313717842102
Epoch: 18, Steps: 208 | Train Loss: 0.337 Vali Loss: 8.667 Vali Acc: 0.092 Test Loss: 8.667 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2916185
	speed: 0.6811s/iter; left time: 11550.1602s
	iters: 200, epoch: 19 | loss: 0.2610173
	speed: 0.2863s/iter; left time: 4825.3669s
Epoch: 19 cost time: 61.92411994934082
Epoch: 19, Steps: 208 | Train Loss: 0.303 Vali Loss: 8.735 Vali Acc: 0.097 Test Loss: 8.735 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.0023774
	speed: 0.6496s/iter; left time: 10880.3408s
	iters: 200, epoch: 20 | loss: 0.2087477
	speed: 0.2875s/iter; left time: 4786.9928s
Epoch: 20 cost time: 57.90254235267639
Epoch: 20, Steps: 208 | Train Loss: 0.288 Vali Loss: 9.066 Vali Acc: 0.094 Test Loss: 9.066 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3866154
	speed: 0.6382s/iter; left time: 10555.7564s
	iters: 200, epoch: 21 | loss: 0.2464058
	speed: 0.2864s/iter; left time: 4708.1940s
Epoch: 21 cost time: 60.8819363117218
Epoch: 21, Steps: 208 | Train Loss: 0.263 Vali Loss: 8.871 Vali Acc: 0.099 Test Loss: 8.871 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3960802
	speed: 0.7034s/iter; left time: 11488.2719s
	iters: 200, epoch: 22 | loss: 0.7258552
	speed: 0.2876s/iter; left time: 4667.9221s
Epoch: 22 cost time: 62.17428112030029
Epoch: 22, Steps: 208 | Train Loss: 0.246 Vali Loss: 9.601 Vali Acc: 0.098 Test Loss: 9.601 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7577931
	speed: 0.6580s/iter; left time: 10610.0607s
	iters: 200, epoch: 23 | loss: 0.3737665
	speed: 0.2852s/iter; left time: 4571.1155s
Epoch: 23 cost time: 59.71074652671814
Epoch: 23, Steps: 208 | Train Loss: 0.240 Vali Loss: 9.498 Vali Acc: 0.102 Test Loss: 9.498 Test Acc: 0.102
Validation loss decreased (-0.099533 --> -0.101605).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2840165
	speed: 0.6623s/iter; left time: 10541.5955s
	iters: 200, epoch: 24 | loss: 0.1700110
	speed: 0.2954s/iter; left time: 4672.1372s
Epoch: 24 cost time: 61.45504546165466
Epoch: 24, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.704 Vali Acc: 0.098 Test Loss: 9.704 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.9140804
	speed: 0.6899s/iter; left time: 10838.3054s
	iters: 200, epoch: 25 | loss: 0.5060753
	speed: 0.2878s/iter; left time: 4492.2728s
Epoch: 25 cost time: 61.1077663898468
Epoch: 25, Steps: 208 | Train Loss: 0.193 Vali Loss: 9.929 Vali Acc: 0.100 Test Loss: 9.929 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.2846423
	speed: 0.6533s/iter; left time: 10126.8914s
	iters: 200, epoch: 26 | loss: 0.1149605
	speed: 0.2940s/iter; left time: 4527.7477s
Epoch: 26 cost time: 62.2575843334198
Epoch: 26, Steps: 208 | Train Loss: 0.215 Vali Loss: 9.826 Vali Acc: 0.100 Test Loss: 9.826 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0286638
	speed: 0.6752s/iter; left time: 10325.6564s
	iters: 200, epoch: 27 | loss: 0.1341645
	speed: 0.2854s/iter; left time: 4335.9069s
Epoch: 27 cost time: 59.634602785110474
Epoch: 27, Steps: 208 | Train Loss: 0.185 Vali Loss: 10.221 Vali Acc: 0.095 Test Loss: 10.221 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1755694
	speed: 0.6693s/iter; left time: 10095.8875s
	iters: 200, epoch: 28 | loss: 0.2004779
	speed: 0.3147s/iter; left time: 4716.0553s
Epoch: 28 cost time: 63.381646394729614
Epoch: 28, Steps: 208 | Train Loss: 0.193 Vali Loss: 10.037 Vali Acc: 0.098 Test Loss: 10.037 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2068641
	speed: 0.6579s/iter; left time: 9787.3435s
	iters: 200, epoch: 29 | loss: 0.2080616
	speed: 0.2778s/iter; left time: 4105.0951s
Epoch: 29 cost time: 59.1192524433136
Epoch: 29, Steps: 208 | Train Loss: 0.187 Vali Loss: 10.482 Vali Acc: 0.097 Test Loss: 10.482 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.6189678
	speed: 0.6716s/iter; left time: 9851.4914s
	iters: 200, epoch: 30 | loss: 0.4778560
	speed: 0.2948s/iter; left time: 4294.4299s
Epoch: 30 cost time: 61.127259969711304
Epoch: 30, Steps: 208 | Train Loss: 0.172 Vali Loss: 10.611 Vali Acc: 0.099 Test Loss: 10.611 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0105098
	speed: 0.6850s/iter; left time: 9905.1684s
	iters: 200, epoch: 31 | loss: 0.2505692
	speed: 0.3032s/iter; left time: 4353.8475s
Epoch: 31 cost time: 62.238436222076416
Epoch: 31, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.581 Vali Acc: 0.093 Test Loss: 10.581 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.2457087
	speed: 0.6732s/iter; left time: 9595.1922s
	iters: 200, epoch: 32 | loss: 0.0164380
	speed: 0.2693s/iter; left time: 3811.6142s
Epoch: 32 cost time: 59.30833029747009
Epoch: 32, Steps: 208 | Train Loss: 0.159 Vali Loss: 10.714 Vali Acc: 0.095 Test Loss: 10.714 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.4048744
	speed: 0.6755s/iter; left time: 9487.2069s
	iters: 200, epoch: 33 | loss: 0.0124419
	speed: 0.3001s/iter; left time: 4185.1794s
Epoch: 33 cost time: 62.080527782440186
Epoch: 33, Steps: 208 | Train Loss: 0.153 Vali Loss: 10.680 Vali Acc: 0.099 Test Loss: 10.680 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10169997017596183
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6791275
	speed: 0.2902s/iter; left time: 6007.9175s
	iters: 200, epoch: 1 | loss: 3.3081064
	speed: 0.2757s/iter; left time: 5680.3951s
Epoch: 1 cost time: 59.020864963531494
Epoch: 1, Steps: 208 | Train Loss: 3.637 Vali Loss: 4.276 Vali Acc: 0.028 Test Loss: 4.276 Test Acc: 0.028
Validation loss decreased (inf --> -0.028290).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7354765
	speed: 0.6814s/iter; left time: 13964.5750s
	iters: 200, epoch: 2 | loss: 3.0503964
	speed: 0.2809s/iter; left time: 5728.0293s
Epoch: 2 cost time: 60.00938534736633
Epoch: 2, Steps: 208 | Train Loss: 3.229 Vali Loss: 4.478 Vali Acc: 0.047 Test Loss: 4.478 Test Acc: 0.047
Validation loss decreased (-0.028290 --> -0.047375).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7583771
	speed: 0.6276s/iter; left time: 12731.2725s
	iters: 200, epoch: 3 | loss: 3.0248187
	speed: 0.2717s/iter; left time: 5483.7957s
Epoch: 3 cost time: 56.43698596954346
Epoch: 3, Steps: 208 | Train Loss: 3.013 Vali Loss: 5.138 Vali Acc: 0.049 Test Loss: 5.138 Test Acc: 0.049
Validation loss decreased (-0.047375 --> -0.049158).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2214556
	speed: 0.6046s/iter; left time: 12137.8907s
	iters: 200, epoch: 4 | loss: 2.8302891
	speed: 0.2648s/iter; left time: 5290.0179s
Epoch: 4 cost time: 55.461764097213745
Epoch: 4, Steps: 208 | Train Loss: 2.761 Vali Loss: 5.179 Vali Acc: 0.048 Test Loss: 5.179 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.7537341
	speed: 0.6246s/iter; left time: 12410.9903s
	iters: 200, epoch: 5 | loss: 2.7561984
	speed: 0.2823s/iter; left time: 5581.3415s
Epoch: 5 cost time: 56.71493411064148
Epoch: 5, Steps: 208 | Train Loss: 2.472 Vali Loss: 5.135 Vali Acc: 0.067 Test Loss: 5.135 Test Acc: 0.067
Validation loss decreased (-0.049158 --> -0.067351).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2188027
	speed: 0.6285s/iter; left time: 12356.2346s
	iters: 200, epoch: 6 | loss: 2.9311051
	speed: 0.2680s/iter; left time: 5243.1529s
Epoch: 6 cost time: 57.103821992874146
Epoch: 6, Steps: 208 | Train Loss: 2.122 Vali Loss: 5.657 Vali Acc: 0.061 Test Loss: 5.657 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1006303
	speed: 0.6259s/iter; left time: 12176.0688s
	iters: 200, epoch: 7 | loss: 1.9647698
	speed: 0.2684s/iter; left time: 5193.5563s
Epoch: 7 cost time: 55.53276991844177
Epoch: 7, Steps: 208 | Train Loss: 1.768 Vali Loss: 5.707 Vali Acc: 0.071 Test Loss: 5.707 Test Acc: 0.071
Validation loss decreased (-0.067351 --> -0.071222).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8891108
	speed: 0.6158s/iter; left time: 11850.9778s
	iters: 200, epoch: 8 | loss: 1.2056192
	speed: 0.2808s/iter; left time: 5375.3986s
Epoch: 8 cost time: 57.803444623947144
Epoch: 8, Steps: 208 | Train Loss: 1.433 Vali Loss: 5.982 Vali Acc: 0.074 Test Loss: 5.982 Test Acc: 0.074
Validation loss decreased (-0.071222 --> -0.073904).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0684823
	speed: 0.6217s/iter; left time: 11835.0735s
	iters: 200, epoch: 9 | loss: 0.8949255
	speed: 0.2511s/iter; left time: 4754.7212s
Epoch: 9 cost time: 54.96748423576355
Epoch: 9, Steps: 208 | Train Loss: 1.189 Vali Loss: 6.374 Vali Acc: 0.078 Test Loss: 6.374 Test Acc: 0.078
Validation loss decreased (-0.073904 --> -0.077479).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2016376
	speed: 0.5795s/iter; left time: 10911.0017s
	iters: 200, epoch: 10 | loss: 1.2751036
	speed: 0.2737s/iter; left time: 5126.6520s
Epoch: 10 cost time: 53.46570563316345
Epoch: 10, Steps: 208 | Train Loss: 0.975 Vali Loss: 6.659 Vali Acc: 0.065 Test Loss: 6.659 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4734486
	speed: 0.6517s/iter; left time: 12136.1139s
	iters: 200, epoch: 11 | loss: 0.6612596
	speed: 0.2698s/iter; left time: 4997.8683s
Epoch: 11 cost time: 59.05248308181763
Epoch: 11, Steps: 208 | Train Loss: 0.801 Vali Loss: 7.178 Vali Acc: 0.072 Test Loss: 7.178 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8878351
	speed: 0.6377s/iter; left time: 11742.4746s
	iters: 200, epoch: 12 | loss: 0.7706274
	speed: 0.2819s/iter; left time: 5163.0593s
Epoch: 12 cost time: 57.728371381759644
Epoch: 12, Steps: 208 | Train Loss: 0.742 Vali Loss: 7.414 Vali Acc: 0.085 Test Loss: 7.414 Test Acc: 0.085
Validation loss decreased (-0.077479 --> -0.084626).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9508076
	speed: 0.6298s/iter; left time: 11465.1263s
	iters: 200, epoch: 13 | loss: 0.7020801
	speed: 0.2645s/iter; left time: 4789.0070s
Epoch: 13 cost time: 56.24529528617859
Epoch: 13, Steps: 208 | Train Loss: 0.635 Vali Loss: 7.523 Vali Acc: 0.087 Test Loss: 7.523 Test Acc: 0.087
Validation loss decreased (-0.084626 --> -0.086713).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1513335
	speed: 0.6168s/iter; left time: 11100.6658s
	iters: 200, epoch: 14 | loss: 0.4200166
	speed: 0.2653s/iter; left time: 4747.6123s
Epoch: 14 cost time: 57.225177526474
Epoch: 14, Steps: 208 | Train Loss: 0.566 Vali Loss: 7.912 Vali Acc: 0.079 Test Loss: 7.912 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1655981
	speed: 0.6305s/iter; left time: 11215.9390s
	iters: 200, epoch: 15 | loss: 0.3458700
	speed: 0.2819s/iter; left time: 4985.9470s
Epoch: 15 cost time: 57.65867280960083
Epoch: 15, Steps: 208 | Train Loss: 0.483 Vali Loss: 8.217 Vali Acc: 0.088 Test Loss: 8.217 Test Acc: 0.088
Validation loss decreased (-0.086713 --> -0.087601).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6969683
	speed: 0.6395s/iter; left time: 11242.7957s
	iters: 200, epoch: 16 | loss: 0.3831166
	speed: 0.2587s/iter; left time: 4522.2749s
Epoch: 16 cost time: 56.11581325531006
Epoch: 16, Steps: 208 | Train Loss: 0.415 Vali Loss: 8.608 Vali Acc: 0.084 Test Loss: 8.608 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0378562
	speed: 0.5885s/iter; left time: 10223.4554s
	iters: 200, epoch: 17 | loss: 0.5633281
	speed: 0.2734s/iter; left time: 4722.5028s
Epoch: 17 cost time: 53.98676562309265
Epoch: 17, Steps: 208 | Train Loss: 0.392 Vali Loss: 8.374 Vali Acc: 0.082 Test Loss: 8.374 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2776507
	speed: 0.6316s/iter; left time: 10841.3228s
	iters: 200, epoch: 18 | loss: 0.2048254
	speed: 0.2936s/iter; left time: 5010.2239s
Epoch: 18 cost time: 58.66713094711304
Epoch: 18, Steps: 208 | Train Loss: 0.359 Vali Loss: 8.896 Vali Acc: 0.083 Test Loss: 8.896 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.9567273
	speed: 0.6527s/iter; left time: 11068.3338s
	iters: 200, epoch: 19 | loss: 0.7967362
	speed: 0.2862s/iter; left time: 4825.1127s
Epoch: 19 cost time: 59.942503690719604
Epoch: 19, Steps: 208 | Train Loss: 0.330 Vali Loss: 9.086 Vali Acc: 0.086 Test Loss: 9.086 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5107453
	speed: 0.6736s/iter; left time: 11282.7727s
	iters: 200, epoch: 20 | loss: 0.1491191
	speed: 0.2835s/iter; left time: 4719.8936s
Epoch: 20 cost time: 60.371554374694824
Epoch: 20, Steps: 208 | Train Loss: 0.281 Vali Loss: 9.452 Vali Acc: 0.081 Test Loss: 9.452 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1948065
	speed: 0.6368s/iter; left time: 10533.1380s
	iters: 200, epoch: 21 | loss: 0.7744573
	speed: 0.2766s/iter; left time: 4547.1773s
Epoch: 21 cost time: 57.55482029914856
Epoch: 21, Steps: 208 | Train Loss: 0.275 Vali Loss: 9.488 Vali Acc: 0.084 Test Loss: 9.488 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1864942
	speed: 0.6072s/iter; left time: 9916.7148s
	iters: 200, epoch: 22 | loss: 0.7327628
	speed: 0.2735s/iter; left time: 4439.7120s
Epoch: 22 cost time: 55.981608867645264
Epoch: 22, Steps: 208 | Train Loss: 0.256 Vali Loss: 9.452 Vali Acc: 0.081 Test Loss: 9.452 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.5027556
	speed: 0.6589s/iter; left time: 10625.1605s
	iters: 200, epoch: 23 | loss: 0.6100343
	speed: 0.2845s/iter; left time: 4558.9342s
Epoch: 23 cost time: 59.91687083244324
Epoch: 23, Steps: 208 | Train Loss: 0.231 Vali Loss: 9.877 Vali Acc: 0.081 Test Loss: 9.877 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2375450
	speed: 0.6628s/iter; left time: 10549.9326s
	iters: 200, epoch: 24 | loss: 0.1565555
	speed: 0.2662s/iter; left time: 4210.1557s
Epoch: 24 cost time: 57.26825785636902
Epoch: 24, Steps: 208 | Train Loss: 0.245 Vali Loss: 9.792 Vali Acc: 0.081 Test Loss: 9.792 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.8944961
	speed: 0.6505s/iter; left time: 10219.4736s
	iters: 200, epoch: 25 | loss: 0.6667534
	speed: 0.2706s/iter; left time: 4223.8368s
Epoch: 25 cost time: 57.941410541534424
Epoch: 25, Steps: 208 | Train Loss: 0.224 Vali Loss: 9.912 Vali Acc: 0.077 Test Loss: 9.912 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08768267223382047
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3878298
	speed: 0.3076s/iter; left time: 6366.9732s
	iters: 200, epoch: 1 | loss: 3.3076713
	speed: 0.2914s/iter; left time: 6003.8026s
Epoch: 1 cost time: 62.5548460483551
Epoch: 1, Steps: 208 | Train Loss: 3.643 Vali Loss: 5.301 Vali Acc: 0.028 Test Loss: 5.301 Test Acc: 0.028
Validation loss decreased (inf --> -0.027982).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0754552
	speed: 0.6779s/iter; left time: 13892.1785s
	iters: 200, epoch: 2 | loss: 3.3364224
	speed: 0.2924s/iter; left time: 5961.9384s
Epoch: 2 cost time: 60.677613973617554
Epoch: 2, Steps: 208 | Train Loss: 3.279 Vali Loss: 5.378 Vali Acc: 0.032 Test Loss: 5.378 Test Acc: 0.032
Validation loss decreased (-0.027982 --> -0.032156).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6754076
	speed: 0.6768s/iter; left time: 13728.5856s
	iters: 200, epoch: 3 | loss: 3.1598587
	speed: 0.2840s/iter; left time: 5731.8450s
Epoch: 3 cost time: 60.43183970451355
Epoch: 3, Steps: 208 | Train Loss: 3.125 Vali Loss: 5.994 Vali Acc: 0.038 Test Loss: 5.994 Test Acc: 0.038
Validation loss decreased (-0.032156 --> -0.037518).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8715618
	speed: 0.6784s/iter; left time: 13620.4961s
	iters: 200, epoch: 4 | loss: 2.8522427
	speed: 0.2809s/iter; left time: 5611.6984s
Epoch: 4 cost time: 59.451287508010864
Epoch: 4, Steps: 208 | Train Loss: 2.956 Vali Loss: 5.787 Vali Acc: 0.041 Test Loss: 5.787 Test Acc: 0.041
Validation loss decreased (-0.037518 --> -0.040801).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1415057
	speed: 0.6576s/iter; left time: 13065.0014s
	iters: 200, epoch: 5 | loss: 2.8787980
	speed: 0.2870s/iter; left time: 5674.6715s
Epoch: 5 cost time: 59.78739380836487
Epoch: 5, Steps: 208 | Train Loss: 2.799 Vali Loss: 5.529 Vali Acc: 0.050 Test Loss: 5.529 Test Acc: 0.050
Validation loss decreased (-0.040801 --> -0.049453).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6775445
	speed: 0.6775s/iter; left time: 13319.9599s
	iters: 200, epoch: 6 | loss: 3.3503370
	speed: 0.2791s/iter; left time: 5458.8875s
Epoch: 6 cost time: 59.30117392539978
Epoch: 6, Steps: 208 | Train Loss: 2.542 Vali Loss: 5.722 Vali Acc: 0.053 Test Loss: 5.722 Test Acc: 0.053
Validation loss decreased (-0.049453 --> -0.052731).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8843868
	speed: 0.6352s/iter; left time: 12356.2331s
	iters: 200, epoch: 7 | loss: 2.3116884
	speed: 0.2827s/iter; left time: 5471.6590s
Epoch: 7 cost time: 57.87754702568054
Epoch: 7, Steps: 208 | Train Loss: 2.286 Vali Loss: 5.645 Vali Acc: 0.055 Test Loss: 5.645 Test Acc: 0.055
Validation loss decreased (-0.052731 --> -0.055118).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9900637
	speed: 0.6543s/iter; left time: 12591.2650s
	iters: 200, epoch: 8 | loss: 1.5816389
	speed: 0.2848s/iter; left time: 5451.7334s
Epoch: 8 cost time: 58.964521408081055
Epoch: 8, Steps: 208 | Train Loss: 1.907 Vali Loss: 6.052 Vali Acc: 0.055 Test Loss: 6.052 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1358788
	speed: 0.6606s/iter; left time: 12576.5010s
	iters: 200, epoch: 9 | loss: 1.0775812
	speed: 0.2835s/iter; left time: 5368.1423s
Epoch: 9 cost time: 59.2631676197052
Epoch: 9, Steps: 208 | Train Loss: 1.647 Vali Loss: 5.853 Vali Acc: 0.070 Test Loss: 5.853 Test Acc: 0.070
Validation loss decreased (-0.055118 --> -0.070028).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7442330
	speed: 0.6323s/iter; left time: 11905.2511s
	iters: 200, epoch: 10 | loss: 1.7287371
	speed: 0.2841s/iter; left time: 5320.4986s
Epoch: 10 cost time: 57.70399498939514
Epoch: 10, Steps: 208 | Train Loss: 1.406 Vali Loss: 6.457 Vali Acc: 0.064 Test Loss: 6.457 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7691633
	speed: 0.6647s/iter; left time: 12376.8877s
	iters: 200, epoch: 11 | loss: 1.4305186
	speed: 0.2802s/iter; left time: 5189.3031s
Epoch: 11 cost time: 59.523348808288574
Epoch: 11, Steps: 208 | Train Loss: 1.171 Vali Loss: 6.749 Vali Acc: 0.079 Test Loss: 6.749 Test Acc: 0.079
Validation loss decreased (-0.070028 --> -0.078966).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5450211
	speed: 0.6516s/iter; left time: 11997.0997s
	iters: 200, epoch: 12 | loss: 2.0538108
	speed: 0.2840s/iter; left time: 5201.5029s
Epoch: 12 cost time: 58.953171491622925
Epoch: 12, Steps: 208 | Train Loss: 1.027 Vali Loss: 6.933 Vali Acc: 0.073 Test Loss: 6.933 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6961484
	speed: 0.6559s/iter; left time: 11941.2079s
	iters: 200, epoch: 13 | loss: 0.9632962
	speed: 0.2823s/iter; left time: 5110.7892s
Epoch: 13 cost time: 59.99794816970825
Epoch: 13, Steps: 208 | Train Loss: 0.860 Vali Loss: 7.454 Vali Acc: 0.075 Test Loss: 7.454 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1240594
	speed: 0.6434s/iter; left time: 11579.7950s
	iters: 200, epoch: 14 | loss: 0.8865854
	speed: 0.2772s/iter; left time: 4960.2306s
Epoch: 14 cost time: 58.80142116546631
Epoch: 14, Steps: 208 | Train Loss: 0.778 Vali Loss: 7.712 Vali Acc: 0.071 Test Loss: 7.712 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8985033
	speed: 0.6630s/iter; left time: 11794.0946s
	iters: 200, epoch: 15 | loss: 0.4132192
	speed: 0.2830s/iter; left time: 5005.5687s
Epoch: 15 cost time: 60.42687439918518
Epoch: 15, Steps: 208 | Train Loss: 0.672 Vali Loss: 7.634 Vali Acc: 0.084 Test Loss: 7.634 Test Acc: 0.084
Validation loss decreased (-0.078966 --> -0.083729).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5269418
	speed: 0.6687s/iter; left time: 11756.1047s
	iters: 200, epoch: 16 | loss: 0.8411704
	speed: 0.2711s/iter; left time: 4738.5071s
Epoch: 16 cost time: 58.39184236526489
Epoch: 16, Steps: 208 | Train Loss: 0.577 Vali Loss: 8.052 Vali Acc: 0.079 Test Loss: 8.052 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8184916
	speed: 0.6820s/iter; left time: 11848.5664s
	iters: 200, epoch: 17 | loss: 0.1999073
	speed: 0.2609s/iter; left time: 4506.1758s
Epoch: 17 cost time: 58.94128441810608
Epoch: 17, Steps: 208 | Train Loss: 0.542 Vali Loss: 8.618 Vali Acc: 0.075 Test Loss: 8.618 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.6330103
	speed: 0.6420s/iter; left time: 11020.1434s
	iters: 200, epoch: 18 | loss: 0.4404280
	speed: 0.2715s/iter; left time: 4632.5949s
Epoch: 18 cost time: 58.078240633010864
Epoch: 18, Steps: 208 | Train Loss: 0.485 Vali Loss: 8.516 Vali Acc: 0.079 Test Loss: 8.516 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.5176474
	speed: 0.6531s/iter; left time: 11074.4249s
	iters: 200, epoch: 19 | loss: 1.1680682
	speed: 0.2814s/iter; left time: 4743.8912s
Epoch: 19 cost time: 59.50089883804321
Epoch: 19, Steps: 208 | Train Loss: 0.451 Vali Loss: 8.959 Vali Acc: 0.078 Test Loss: 8.959 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.0176867
	speed: 0.6539s/iter; left time: 10952.2828s
	iters: 200, epoch: 20 | loss: 0.4635615
	speed: 0.2606s/iter; left time: 4338.3463s
Epoch: 20 cost time: 55.14240789413452
Epoch: 20, Steps: 208 | Train Loss: 0.439 Vali Loss: 8.882 Vali Acc: 0.082 Test Loss: 8.882 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2725699
	speed: 0.6273s/iter; left time: 10376.8817s
	iters: 200, epoch: 21 | loss: 1.0419861
	speed: 0.2532s/iter; left time: 4163.1018s
Epoch: 21 cost time: 54.499773025512695
Epoch: 21, Steps: 208 | Train Loss: 0.394 Vali Loss: 9.003 Vali Acc: 0.082 Test Loss: 9.003 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4736184
	speed: 0.6426s/iter; left time: 10494.8662s
	iters: 200, epoch: 22 | loss: 0.6418487
	speed: 0.2711s/iter; left time: 4400.8312s
Epoch: 22 cost time: 58.1218147277832
Epoch: 22, Steps: 208 | Train Loss: 0.379 Vali Loss: 9.138 Vali Acc: 0.085 Test Loss: 9.138 Test Acc: 0.085
Validation loss decreased (-0.083729 --> -0.085205).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.6204375
	speed: 0.6654s/iter; left time: 10729.5805s
	iters: 200, epoch: 23 | loss: 0.8034630
	speed: 0.2650s/iter; left time: 4246.7642s
Epoch: 23 cost time: 57.52988147735596
Epoch: 23, Steps: 208 | Train Loss: 0.325 Vali Loss: 9.462 Vali Acc: 0.076 Test Loss: 9.462 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.5807452
	speed: 0.6231s/iter; left time: 9918.2286s
	iters: 200, epoch: 24 | loss: 0.5088563
	speed: 0.2580s/iter; left time: 4080.8269s
Epoch: 24 cost time: 53.84787893295288
Epoch: 24, Steps: 208 | Train Loss: 0.329 Vali Loss: 9.566 Vali Acc: 0.079 Test Loss: 9.566 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.9288605
	speed: 0.6671s/iter; left time: 10479.5350s
	iters: 200, epoch: 25 | loss: 0.4425967
	speed: 0.3018s/iter; left time: 4710.2032s
Epoch: 25 cost time: 61.646209716796875
Epoch: 25, Steps: 208 | Train Loss: 0.298 Vali Loss: 9.380 Vali Acc: 0.079 Test Loss: 9.380 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1613344
	speed: 0.6737s/iter; left time: 10443.5071s
	iters: 200, epoch: 26 | loss: 0.2705236
	speed: 0.2801s/iter; left time: 4314.1216s
Epoch: 26 cost time: 58.63628911972046
Epoch: 26, Steps: 208 | Train Loss: 0.271 Vali Loss: 9.878 Vali Acc: 0.094 Test Loss: 9.878 Test Acc: 0.094
Validation loss decreased (-0.085205 --> -0.094145).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.1094064
	speed: 0.6585s/iter; left time: 10071.1677s
	iters: 200, epoch: 27 | loss: 0.1075603
	speed: 0.2844s/iter; left time: 4320.5935s
Epoch: 27 cost time: 58.28037881851196
Epoch: 27, Steps: 208 | Train Loss: 0.292 Vali Loss: 9.827 Vali Acc: 0.088 Test Loss: 9.827 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.3345507
	speed: 0.6776s/iter; left time: 10221.9549s
	iters: 200, epoch: 28 | loss: 0.3785247
	speed: 0.2893s/iter; left time: 4334.8729s
Epoch: 28 cost time: 60.460137128829956
Epoch: 28, Steps: 208 | Train Loss: 0.267 Vali Loss: 9.838 Vali Acc: 0.084 Test Loss: 9.838 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0973808
	speed: 0.6227s/iter; left time: 9263.7110s
	iters: 200, epoch: 29 | loss: 0.1783008
	speed: 0.3028s/iter; left time: 4474.1340s
Epoch: 29 cost time: 60.58311676979065
Epoch: 29, Steps: 208 | Train Loss: 0.254 Vali Loss: 10.121 Vali Acc: 0.096 Test Loss: 10.121 Test Acc: 0.096
Validation loss decreased (-0.094145 --> -0.096230).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.2065152
	speed: 0.6611s/iter; left time: 9698.0101s
	iters: 200, epoch: 30 | loss: 0.4133270
	speed: 0.3011s/iter; left time: 4386.2081s
Epoch: 30 cost time: 62.127421617507935
Epoch: 30, Steps: 208 | Train Loss: 0.230 Vali Loss: 9.922 Vali Acc: 0.084 Test Loss: 9.922 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0746050
	speed: 0.6439s/iter; left time: 9311.1485s
	iters: 200, epoch: 31 | loss: 0.4686236
	speed: 0.2950s/iter; left time: 4236.4227s
Epoch: 31 cost time: 58.372974157333374
Epoch: 31, Steps: 208 | Train Loss: 0.244 Vali Loss: 10.215 Vali Acc: 0.089 Test Loss: 10.215 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.4740740
	speed: 0.6567s/iter; left time: 9359.9491s
	iters: 200, epoch: 32 | loss: 0.3297564
	speed: 0.2966s/iter; left time: 4197.8846s
Epoch: 32 cost time: 63.106478214263916
Epoch: 32, Steps: 208 | Train Loss: 0.233 Vali Loss: 9.873 Vali Acc: 0.080 Test Loss: 9.873 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.3328076
	speed: 0.6916s/iter; left time: 9713.4581s
	iters: 200, epoch: 33 | loss: 0.1566325
	speed: 0.2897s/iter; left time: 4039.5327s
Epoch: 33 cost time: 62.11740517616272
Epoch: 33, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.467 Vali Acc: 0.096 Test Loss: 10.467 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0059151
	speed: 0.6048s/iter; left time: 8368.6533s
	iters: 200, epoch: 34 | loss: 0.1619964
	speed: 0.2969s/iter; left time: 4078.2488s
Epoch: 34 cost time: 58.24904656410217
Epoch: 34, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.536 Vali Acc: 0.099 Test Loss: 10.536 Test Acc: 0.099
Validation loss decreased (-0.096230 --> -0.099209).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0727016
	speed: 0.6555s/iter; left time: 8933.9614s
	iters: 200, epoch: 35 | loss: 0.3815263
	speed: 0.2984s/iter; left time: 4036.7634s
Epoch: 35 cost time: 63.55661749839783
Epoch: 35, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.334 Vali Acc: 0.095 Test Loss: 10.334 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.1072142
	speed: 0.6869s/iter; left time: 9218.2305s
	iters: 200, epoch: 36 | loss: 0.0772923
	speed: 0.2787s/iter; left time: 3712.6422s
Epoch: 36 cost time: 59.36721754074097
Epoch: 36, Steps: 208 | Train Loss: 0.186 Vali Loss: 10.715 Vali Acc: 0.095 Test Loss: 10.715 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.2185660
	speed: 0.6737s/iter; left time: 8901.1086s
	iters: 200, epoch: 37 | loss: 0.0066444
	speed: 0.3060s/iter; left time: 4012.9808s
Epoch: 37 cost time: 62.23972964286804
Epoch: 37, Steps: 208 | Train Loss: 0.178 Vali Loss: 10.671 Vali Acc: 0.099 Test Loss: 10.671 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.2711423
	speed: 0.6650s/iter; left time: 8647.8537s
	iters: 200, epoch: 38 | loss: 0.2772153
	speed: 0.2710s/iter; left time: 3497.7356s
Epoch: 38 cost time: 59.13916516304016
Epoch: 38, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.193 Vali Acc: 0.096 Test Loss: 11.193 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0334800
	speed: 0.6861s/iter; left time: 8780.5228s
	iters: 200, epoch: 39 | loss: 0.4947527
	speed: 0.2909s/iter; left time: 3694.0783s
Epoch: 39 cost time: 62.02301549911499
Epoch: 39, Steps: 208 | Train Loss: 0.165 Vali Loss: 11.184 Vali Acc: 0.092 Test Loss: 11.184 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.2743007
	speed: 0.6730s/iter; left time: 8472.3108s
	iters: 200, epoch: 40 | loss: 0.2467893
	speed: 0.2895s/iter; left time: 3615.3786s
Epoch: 40 cost time: 60.309786796569824
Epoch: 40, Steps: 208 | Train Loss: 0.203 Vali Loss: 11.136 Vali Acc: 0.097 Test Loss: 11.136 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.3326531
	speed: 0.6526s/iter; left time: 8079.7036s
	iters: 200, epoch: 41 | loss: 0.5251774
	speed: 0.2803s/iter; left time: 3442.1410s
Epoch: 41 cost time: 59.711222410202026
Epoch: 41, Steps: 208 | Train Loss: 0.165 Vali Loss: 11.128 Vali Acc: 0.092 Test Loss: 11.128 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0556719
	speed: 0.6494s/iter; left time: 7904.6769s
	iters: 200, epoch: 42 | loss: 0.0055630
	speed: 0.2763s/iter; left time: 3335.7502s
Epoch: 42 cost time: 57.27411079406738
Epoch: 42, Steps: 208 | Train Loss: 0.160 Vali Loss: 11.355 Vali Acc: 0.098 Test Loss: 11.355 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.2576391
	speed: 0.6652s/iter; left time: 7959.4478s
	iters: 200, epoch: 43 | loss: 0.4400675
	speed: 0.2901s/iter; left time: 3441.6835s
Epoch: 43 cost time: 59.83231449127197
Epoch: 43, Steps: 208 | Train Loss: 0.164 Vali Loss: 11.466 Vali Acc: 0.101 Test Loss: 11.466 Test Acc: 0.101
Validation loss decreased (-0.099209 --> -0.100392).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.1553908
	speed: 0.6475s/iter; left time: 7612.4809s
	iters: 200, epoch: 44 | loss: 0.0478535
	speed: 0.2763s/iter; left time: 3220.3165s
Epoch: 44 cost time: 58.28416728973389
Epoch: 44, Steps: 208 | Train Loss: 0.145 Vali Loss: 11.654 Vali Acc: 0.093 Test Loss: 11.654 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.1529689
	speed: 0.6547s/iter; left time: 7560.7496s
	iters: 200, epoch: 45 | loss: 0.0586811
	speed: 0.2789s/iter; left time: 3193.1914s
Epoch: 45 cost time: 58.87102937698364
Epoch: 45, Steps: 208 | Train Loss: 0.157 Vali Loss: 11.555 Vali Acc: 0.088 Test Loss: 11.555 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.0038562
	speed: 0.6734s/iter; left time: 7637.0018s
	iters: 200, epoch: 46 | loss: 0.6541516
	speed: 0.2851s/iter; left time: 3205.0648s
Epoch: 46 cost time: 59.10516405105591
Epoch: 46, Steps: 208 | Train Loss: 0.145 Vali Loss: 11.989 Vali Acc: 0.093 Test Loss: 11.989 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.1640566
	speed: 0.6689s/iter; left time: 7446.5843s
	iters: 200, epoch: 47 | loss: 0.5072774
	speed: 0.2786s/iter; left time: 3073.2717s
Epoch: 47 cost time: 59.01322102546692
Epoch: 47, Steps: 208 | Train Loss: 0.152 Vali Loss: 11.766 Vali Acc: 0.097 Test Loss: 11.766 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.1418375
	speed: 0.6593s/iter; left time: 7202.3949s
	iters: 200, epoch: 48 | loss: 0.0696513
	speed: 0.2759s/iter; left time: 2986.4134s
Epoch: 48 cost time: 58.88491868972778
Epoch: 48, Steps: 208 | Train Loss: 0.149 Vali Loss: 11.721 Vali Acc: 0.092 Test Loss: 11.721 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.0055098
	speed: 0.6936s/iter; left time: 7433.1804s
	iters: 200, epoch: 49 | loss: 0.2549020
	speed: 0.2857s/iter; left time: 3033.3902s
Epoch: 49 cost time: 59.775607109069824
Epoch: 49, Steps: 208 | Train Loss: 0.113 Vali Loss: 12.467 Vali Acc: 0.087 Test Loss: 12.467 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.0128557
	speed: 0.6910s/iter; left time: 7261.9508s
	iters: 200, epoch: 50 | loss: 0.0726908
	speed: 0.3075s/iter; left time: 3200.4366s
Epoch: 50 cost time: 64.12474727630615
Epoch: 50, Steps: 208 | Train Loss: 0.124 Vali Loss: 11.981 Vali Acc: 0.094 Test Loss: 11.981 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 0.0518910
	speed: 0.6649s/iter; left time: 6849.4598s
	iters: 200, epoch: 51 | loss: 0.0154476
	speed: 0.2587s/iter; left time: 2639.4223s
Epoch: 51 cost time: 56.91803312301636
Epoch: 51, Steps: 208 | Train Loss: 0.146 Vali Loss: 11.868 Vali Acc: 0.091 Test Loss: 11.868 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 0.0048048
	speed: 0.6474s/iter; left time: 6534.0959s
	iters: 200, epoch: 52 | loss: 1.0404061
	speed: 0.2817s/iter; left time: 2815.4922s
Epoch: 52 cost time: 59.00513243675232
Epoch: 52, Steps: 208 | Train Loss: 0.141 Vali Loss: 12.127 Vali Acc: 0.091 Test Loss: 12.127 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 0.1044864
	speed: 0.6651s/iter; left time: 6574.3572s
	iters: 200, epoch: 53 | loss: 0.0696813
	speed: 0.2863s/iter; left time: 2801.7291s
Epoch: 53 cost time: 59.66055226325989
Epoch: 53, Steps: 208 | Train Loss: 0.141 Vali Loss: 11.925 Vali Acc: 0.094 Test Loss: 11.925 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10050700864897107
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5835648
	speed: 0.3065s/iter; left time: 6343.8712s
	iters: 200, epoch: 1 | loss: 3.3903525
	speed: 0.2913s/iter; left time: 6000.9119s
Epoch: 1 cost time: 62.22949481010437
Epoch: 1, Steps: 208 | Train Loss: 3.634 Vali Loss: 4.699 Vali Acc: 0.027 Test Loss: 4.699 Test Acc: 0.027
Validation loss decreased (inf --> -0.027391).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8093784
	speed: 0.6652s/iter; left time: 13631.5102s
	iters: 200, epoch: 2 | loss: 3.1376405
	speed: 0.2865s/iter; left time: 5841.8372s
Epoch: 2 cost time: 60.9719717502594
Epoch: 2, Steps: 208 | Train Loss: 3.193 Vali Loss: 4.876 Vali Acc: 0.043 Test Loss: 4.876 Test Acc: 0.043
Validation loss decreased (-0.027391 --> -0.042898).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5478151
	speed: 0.6552s/iter; left time: 13290.6002s
	iters: 200, epoch: 3 | loss: 3.2028842
	speed: 0.2923s/iter; left time: 5901.0176s
Epoch: 3 cost time: 62.35789155960083
Epoch: 3, Steps: 208 | Train Loss: 2.967 Vali Loss: 5.525 Vali Acc: 0.043 Test Loss: 5.525 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1766925
	speed: 0.6720s/iter; left time: 13492.0392s
	iters: 200, epoch: 4 | loss: 2.5189233
	speed: 0.2930s/iter; left time: 5853.0371s
Epoch: 4 cost time: 62.2002649307251
Epoch: 4, Steps: 208 | Train Loss: 2.692 Vali Loss: 5.597 Vali Acc: 0.050 Test Loss: 5.597 Test Acc: 0.050
Validation loss decreased (-0.042898 --> -0.049452).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4555519
	speed: 0.6767s/iter; left time: 13445.5299s
	iters: 200, epoch: 5 | loss: 2.8240004
	speed: 0.2857s/iter; left time: 5648.7366s
Epoch: 5 cost time: 61.019086599349976
Epoch: 5, Steps: 208 | Train Loss: 2.414 Vali Loss: 5.594 Vali Acc: 0.053 Test Loss: 5.594 Test Acc: 0.053
Validation loss decreased (-0.049452 --> -0.053031).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5889132
	speed: 0.6740s/iter; left time: 13252.3968s
	iters: 200, epoch: 6 | loss: 3.3003716
	speed: 0.2991s/iter; left time: 5850.0102s
Epoch: 6 cost time: 62.99502110481262
Epoch: 6, Steps: 208 | Train Loss: 2.108 Vali Loss: 6.188 Vali Acc: 0.054 Test Loss: 6.188 Test Acc: 0.054
Validation loss decreased (-0.053031 --> -0.053920).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8544703
	speed: 0.6849s/iter; left time: 13324.0902s
	iters: 200, epoch: 7 | loss: 1.7079031
	speed: 0.2777s/iter; left time: 5374.3883s
Epoch: 7 cost time: 60.07554244995117
Epoch: 7, Steps: 208 | Train Loss: 1.832 Vali Loss: 6.160 Vali Acc: 0.058 Test Loss: 6.160 Test Acc: 0.058
Validation loss decreased (-0.053920 --> -0.058394).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2749020
	speed: 0.6477s/iter; left time: 12465.1546s
	iters: 200, epoch: 8 | loss: 1.1572562
	speed: 0.2812s/iter; left time: 5384.3331s
Epoch: 8 cost time: 58.91935682296753
Epoch: 8, Steps: 208 | Train Loss: 1.456 Vali Loss: 6.762 Vali Acc: 0.060 Test Loss: 6.762 Test Acc: 0.060
Validation loss decreased (-0.058394 --> -0.060177).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3966675
	speed: 0.6409s/iter; left time: 12201.7616s
	iters: 200, epoch: 9 | loss: 1.2262254
	speed: 0.2657s/iter; left time: 5032.3805s
Epoch: 9 cost time: 56.76579999923706
Epoch: 9, Steps: 208 | Train Loss: 1.253 Vali Loss: 6.771 Vali Acc: 0.065 Test Loss: 6.771 Test Acc: 0.065
Validation loss decreased (-0.060177 --> -0.064650).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0571969
	speed: 0.6294s/iter; left time: 11851.8434s
	iters: 200, epoch: 10 | loss: 1.1061170
	speed: 0.2798s/iter; left time: 5241.1004s
Epoch: 10 cost time: 57.35459089279175
Epoch: 10, Steps: 208 | Train Loss: 1.079 Vali Loss: 7.465 Vali Acc: 0.064 Test Loss: 7.465 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3869720
	speed: 0.6739s/iter; left time: 12548.7944s
	iters: 200, epoch: 11 | loss: 0.7453170
	speed: 0.2806s/iter; left time: 5197.6485s
Epoch: 11 cost time: 59.60004115104675
Epoch: 11, Steps: 208 | Train Loss: 0.881 Vali Loss: 7.771 Vali Acc: 0.065 Test Loss: 7.771 Test Acc: 0.065
Validation loss decreased (-0.064650 --> -0.064939).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9103664
	speed: 0.6382s/iter; left time: 11751.3520s
	iters: 200, epoch: 12 | loss: 0.6214482
	speed: 0.2703s/iter; left time: 4949.8310s
Epoch: 12 cost time: 56.460888624191284
Epoch: 12, Steps: 208 | Train Loss: 0.760 Vali Loss: 7.933 Vali Acc: 0.074 Test Loss: 7.933 Test Acc: 0.074
Validation loss decreased (-0.064939 --> -0.074183).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5636936
	speed: 0.6293s/iter; left time: 11457.1170s
	iters: 200, epoch: 13 | loss: 0.8056851
	speed: 0.2855s/iter; left time: 5169.5929s
Epoch: 13 cost time: 59.00745463371277
Epoch: 13, Steps: 208 | Train Loss: 0.645 Vali Loss: 8.360 Vali Acc: 0.076 Test Loss: 8.360 Test Acc: 0.076
Validation loss decreased (-0.074183 --> -0.075669).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0890664
	speed: 0.7065s/iter; left time: 12715.3565s
	iters: 200, epoch: 14 | loss: 0.4116012
	speed: 0.2848s/iter; left time: 5096.6290s
Epoch: 14 cost time: 61.42815923690796
Epoch: 14, Steps: 208 | Train Loss: 0.577 Vali Loss: 8.730 Vali Acc: 0.071 Test Loss: 8.730 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2144882
	speed: 0.6417s/iter; left time: 11414.8177s
	iters: 200, epoch: 15 | loss: 0.3698654
	speed: 0.2906s/iter; left time: 5141.2751s
Epoch: 15 cost time: 59.61196970939636
Epoch: 15, Steps: 208 | Train Loss: 0.556 Vali Loss: 8.710 Vali Acc: 0.080 Test Loss: 8.710 Test Acc: 0.080
Validation loss decreased (-0.075669 --> -0.080140).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5973164
	speed: 0.6849s/iter; left time: 12040.7934s
	iters: 200, epoch: 16 | loss: 0.8635989
	speed: 0.2762s/iter; left time: 4828.9383s
Epoch: 16 cost time: 60.9176230430603
Epoch: 16, Steps: 208 | Train Loss: 0.467 Vali Loss: 9.163 Vali Acc: 0.085 Test Loss: 9.163 Test Acc: 0.085
Validation loss decreased (-0.080140 --> -0.084609).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7897490
	speed: 0.6921s/iter; left time: 12024.4130s
	iters: 200, epoch: 17 | loss: 0.4364589
	speed: 0.2891s/iter; left time: 4993.5342s
Epoch: 17 cost time: 61.901774644851685
Epoch: 17, Steps: 208 | Train Loss: 0.454 Vali Loss: 9.483 Vali Acc: 0.077 Test Loss: 9.483 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8710772
	speed: 0.6877s/iter; left time: 11804.2570s
	iters: 200, epoch: 18 | loss: 0.1592596
	speed: 0.2952s/iter; left time: 5037.2127s
Epoch: 18 cost time: 61.71131443977356
Epoch: 18, Steps: 208 | Train Loss: 0.386 Vali Loss: 9.824 Vali Acc: 0.080 Test Loss: 9.824 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3992519
	speed: 0.6527s/iter; left time: 11067.9593s
	iters: 200, epoch: 19 | loss: 0.4363082
	speed: 0.2812s/iter; left time: 4739.6322s
Epoch: 19 cost time: 61.098188400268555
Epoch: 19, Steps: 208 | Train Loss: 0.366 Vali Loss: 9.795 Vali Acc: 0.079 Test Loss: 9.795 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.0384443
	speed: 0.6811s/iter; left time: 11408.1909s
	iters: 200, epoch: 20 | loss: 0.3159271
	speed: 0.3006s/iter; left time: 5004.9612s
Epoch: 20 cost time: 61.69790458679199
Epoch: 20, Steps: 208 | Train Loss: 0.364 Vali Loss: 9.871 Vali Acc: 0.077 Test Loss: 9.871 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.5405455
	speed: 0.6807s/iter; left time: 11259.2597s
	iters: 200, epoch: 21 | loss: 0.7883875
	speed: 0.3064s/iter; left time: 5038.1727s
Epoch: 21 cost time: 62.821616888046265
Epoch: 21, Steps: 208 | Train Loss: 0.309 Vali Loss: 10.210 Vali Acc: 0.085 Test Loss: 10.210 Test Acc: 0.085
Validation loss decreased (-0.084609 --> -0.084896).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5794788
	speed: 0.6557s/iter; left time: 10709.9496s
	iters: 200, epoch: 22 | loss: 0.7053787
	speed: 0.3030s/iter; left time: 4917.8083s
Epoch: 22 cost time: 62.189844369888306
Epoch: 22, Steps: 208 | Train Loss: 0.275 Vali Loss: 10.668 Vali Acc: 0.079 Test Loss: 10.668 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.7921316
	speed: 0.6860s/iter; left time: 11061.2955s
	iters: 200, epoch: 23 | loss: 0.6298852
	speed: 0.2945s/iter; left time: 4718.7759s
Epoch: 23 cost time: 62.68998336791992
Epoch: 23, Steps: 208 | Train Loss: 0.274 Vali Loss: 10.901 Vali Acc: 0.075 Test Loss: 10.901 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2400054
	speed: 0.6671s/iter; left time: 10618.7400s
	iters: 200, epoch: 24 | loss: 0.2141158
	speed: 0.3074s/iter; left time: 4862.0378s
Epoch: 24 cost time: 62.06894540786743
Epoch: 24, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.873 Vali Acc: 0.082 Test Loss: 10.873 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8494174
	speed: 0.7009s/iter; left time: 11010.6269s
	iters: 200, epoch: 25 | loss: 0.5056850
	speed: 0.3017s/iter; left time: 4709.0003s
Epoch: 25 cost time: 62.96458029747009
Epoch: 25, Steps: 208 | Train Loss: 0.261 Vali Loss: 10.658 Vali Acc: 0.082 Test Loss: 10.658 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.3592469
	speed: 0.6712s/iter; left time: 10404.2791s
	iters: 200, epoch: 26 | loss: 0.2058941
	speed: 0.3121s/iter; left time: 4806.5887s
Epoch: 26 cost time: 63.07438087463379
Epoch: 26, Steps: 208 | Train Loss: 0.234 Vali Loss: 11.104 Vali Acc: 0.078 Test Loss: 11.104 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0389663
	speed: 0.7218s/iter; left time: 11038.4707s
	iters: 200, epoch: 27 | loss: 0.0822631
	speed: 0.2936s/iter; left time: 4460.7330s
Epoch: 27 cost time: 62.77384400367737
Epoch: 27, Steps: 208 | Train Loss: 0.220 Vali Loss: 11.055 Vali Acc: 0.088 Test Loss: 11.055 Test Acc: 0.088
Validation loss decreased (-0.084896 --> -0.088169).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0420147
	speed: 0.6763s/iter; left time: 10201.7313s
	iters: 200, epoch: 28 | loss: 0.3309750
	speed: 0.3139s/iter; left time: 4703.8281s
Epoch: 28 cost time: 64.90517902374268
Epoch: 28, Steps: 208 | Train Loss: 0.204 Vali Loss: 11.133 Vali Acc: 0.090 Test Loss: 11.133 Test Acc: 0.090
Validation loss decreased (-0.088169 --> -0.089659).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0842719
	speed: 0.6661s/iter; left time: 9909.8571s
	iters: 200, epoch: 29 | loss: 0.2031679
	speed: 0.2715s/iter; left time: 4011.7270s
Epoch: 29 cost time: 57.581438302993774
Epoch: 29, Steps: 208 | Train Loss: 0.212 Vali Loss: 11.259 Vali Acc: 0.085 Test Loss: 11.259 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.1221353
	speed: 0.6444s/iter; left time: 9453.0907s
	iters: 200, epoch: 30 | loss: 0.4274563
	speed: 0.2732s/iter; left time: 3979.9363s
Epoch: 30 cost time: 57.81335806846619
Epoch: 30, Steps: 208 | Train Loss: 0.178 Vali Loss: 11.298 Vali Acc: 0.087 Test Loss: 11.298 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0652573
	speed: 0.6589s/iter; left time: 9528.0866s
	iters: 200, epoch: 31 | loss: 0.0425195
	speed: 0.2802s/iter; left time: 4023.9405s
Epoch: 31 cost time: 58.734050273895264
Epoch: 31, Steps: 208 | Train Loss: 0.182 Vali Loss: 11.485 Vali Acc: 0.085 Test Loss: 11.485 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.5258613
	speed: 0.6516s/iter; left time: 9286.9719s
	iters: 200, epoch: 32 | loss: 0.1204632
	speed: 0.2584s/iter; left time: 3657.6429s
Epoch: 32 cost time: 56.922443866729736
Epoch: 32, Steps: 208 | Train Loss: 0.166 Vali Loss: 11.479 Vali Acc: 0.087 Test Loss: 11.479 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.3706000
	speed: 0.6707s/iter; left time: 9420.0026s
	iters: 200, epoch: 33 | loss: 0.2103480
	speed: 0.2889s/iter; left time: 4029.4010s
Epoch: 33 cost time: 60.975337505340576
Epoch: 33, Steps: 208 | Train Loss: 0.159 Vali Loss: 12.015 Vali Acc: 0.085 Test Loss: 12.015 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.1225226
	speed: 0.6711s/iter; left time: 9286.3749s
	iters: 200, epoch: 34 | loss: 0.2245076
	speed: 0.2777s/iter; left time: 3814.4708s
Epoch: 34 cost time: 58.84832406044006
Epoch: 34, Steps: 208 | Train Loss: 0.144 Vali Loss: 11.945 Vali Acc: 0.088 Test Loss: 11.945 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0103410
	speed: 0.6300s/iter; left time: 8586.2582s
	iters: 200, epoch: 35 | loss: 0.0914209
	speed: 0.2816s/iter; left time: 3810.0818s
Epoch: 35 cost time: 58.20449686050415
Epoch: 35, Steps: 208 | Train Loss: 0.158 Vali Loss: 12.127 Vali Acc: 0.086 Test Loss: 12.127 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0295263
	speed: 0.6594s/iter; left time: 8849.1979s
	iters: 200, epoch: 36 | loss: 0.0416753
	speed: 0.2875s/iter; left time: 3829.9024s
Epoch: 36 cost time: 59.25878310203552
Epoch: 36, Steps: 208 | Train Loss: 0.157 Vali Loss: 12.119 Vali Acc: 0.088 Test Loss: 12.119 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0549293
	speed: 0.6704s/iter; left time: 8857.8503s
	iters: 200, epoch: 37 | loss: 0.0560725
	speed: 0.2837s/iter; left time: 3720.2016s
Epoch: 37 cost time: 60.07903981208801
Epoch: 37, Steps: 208 | Train Loss: 0.150 Vali Loss: 12.336 Vali Acc: 0.085 Test Loss: 12.336 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.1003789
	speed: 0.6645s/iter; left time: 8641.3965s
	iters: 200, epoch: 38 | loss: 0.0702213
	speed: 0.2755s/iter; left time: 3555.6876s
Epoch: 38 cost time: 58.431978940963745
Epoch: 38, Steps: 208 | Train Loss: 0.150 Vali Loss: 12.175 Vali Acc: 0.079 Test Loss: 12.175 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08977035490605428
model parameter : 907367
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0849733
	speed: 0.3161s/iter; left time: 6544.4628s
	iters: 200, epoch: 1 | loss: 3.4665241
	speed: 0.3005s/iter; left time: 6189.9995s
Epoch: 1 cost time: 64.23431611061096
Epoch: 1, Steps: 208 | Train Loss: 3.712 Vali Loss: 3.697 Vali Acc: 0.069 Test Loss: 3.697 Test Acc: 0.069
Validation loss decreased (inf --> -0.069453).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0351593
	speed: 0.6816s/iter; left time: 13967.9526s
	iters: 200, epoch: 2 | loss: 3.1097419
	speed: 0.2946s/iter; left time: 6007.6233s
Epoch: 2 cost time: 62.6077082157135
Epoch: 2, Steps: 208 | Train Loss: 3.148 Vali Loss: 3.907 Vali Acc: 0.077 Test Loss: 3.907 Test Acc: 0.077
Validation loss decreased (-0.069453 --> -0.076907).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0372689
	speed: 0.7015s/iter; left time: 14229.6298s
	iters: 200, epoch: 3 | loss: 2.9448752
	speed: 0.2938s/iter; left time: 5929.6941s
Epoch: 3 cost time: 62.172954082489014
Epoch: 3, Steps: 208 | Train Loss: 2.575 Vali Loss: 4.141 Vali Acc: 0.096 Test Loss: 4.141 Test Acc: 0.096
Validation loss decreased (-0.076907 --> -0.096290).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3973352
	speed: 0.6822s/iter; left time: 13697.3065s
	iters: 200, epoch: 4 | loss: 2.0199060
	speed: 0.3005s/iter; left time: 6003.0373s
Epoch: 4 cost time: 62.838456869125366
Epoch: 4, Steps: 208 | Train Loss: 2.029 Vali Loss: 4.610 Vali Acc: 0.091 Test Loss: 4.610 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8598503
	speed: 0.6798s/iter; left time: 13507.2892s
	iters: 200, epoch: 5 | loss: 2.3365934
	speed: 0.3022s/iter; left time: 5973.7855s
Epoch: 5 cost time: 61.240349531173706
Epoch: 5, Steps: 208 | Train Loss: 1.480 Vali Loss: 5.231 Vali Acc: 0.095 Test Loss: 5.231 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1152855
	speed: 0.7031s/iter; left time: 13822.7643s
	iters: 200, epoch: 6 | loss: 1.2291561
	speed: 0.2918s/iter; left time: 5708.8118s
Epoch: 6 cost time: 60.56330132484436
Epoch: 6, Steps: 208 | Train Loss: 1.101 Vali Loss: 5.933 Vali Acc: 0.089 Test Loss: 5.933 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2027626
	speed: 0.6880s/iter; left time: 13383.0570s
	iters: 200, epoch: 7 | loss: 0.8043587
	speed: 0.3010s/iter; left time: 5825.1903s
Epoch: 7 cost time: 63.65777587890625
Epoch: 7, Steps: 208 | Train Loss: 0.793 Vali Loss: 6.437 Vali Acc: 0.101 Test Loss: 6.437 Test Acc: 0.101
Validation loss decreased (-0.096290 --> -0.100443).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4400125
	speed: 0.6561s/iter; left time: 12626.9332s
	iters: 200, epoch: 8 | loss: 1.0145668
	speed: 0.2906s/iter; left time: 5564.2426s
Epoch: 8 cost time: 58.93342876434326
Epoch: 8, Steps: 208 | Train Loss: 0.633 Vali Loss: 6.993 Vali Acc: 0.088 Test Loss: 6.993 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6005579
	speed: 0.6666s/iter; left time: 12690.0024s
	iters: 200, epoch: 9 | loss: 1.5639248
	speed: 0.2772s/iter; left time: 5248.7650s
Epoch: 9 cost time: 58.78415536880493
Epoch: 9, Steps: 208 | Train Loss: 0.533 Vali Loss: 7.466 Vali Acc: 0.097 Test Loss: 7.466 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0837205
	speed: 0.6538s/iter; left time: 12309.9968s
	iters: 200, epoch: 10 | loss: 0.1173771
	speed: 0.3047s/iter; left time: 5706.8142s
Epoch: 10 cost time: 62.52078580856323
Epoch: 10, Steps: 208 | Train Loss: 0.414 Vali Loss: 7.932 Vali Acc: 0.094 Test Loss: 7.932 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0613065
	speed: 0.6850s/iter; left time: 12755.3119s
	iters: 200, epoch: 11 | loss: 0.4128169
	speed: 0.3081s/iter; left time: 5706.9380s
Epoch: 11 cost time: 63.844610929489136
Epoch: 11, Steps: 208 | Train Loss: 0.376 Vali Loss: 8.528 Vali Acc: 0.095 Test Loss: 8.528 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2660581
	speed: 0.6844s/iter; left time: 12602.2950s
	iters: 200, epoch: 12 | loss: 0.4154355
	speed: 0.2821s/iter; left time: 5166.0164s
Epoch: 12 cost time: 59.228434562683105
Epoch: 12, Steps: 208 | Train Loss: 0.344 Vali Loss: 8.658 Vali Acc: 0.098 Test Loss: 8.658 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2571902
	speed: 0.6248s/iter; left time: 11374.6448s
	iters: 200, epoch: 13 | loss: 0.3452247
	speed: 0.2716s/iter; left time: 4916.7137s
Epoch: 13 cost time: 58.022465467453
Epoch: 13, Steps: 208 | Train Loss: 0.295 Vali Loss: 9.061 Vali Acc: 0.082 Test Loss: 9.061 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1744380
	speed: 0.6307s/iter; left time: 11350.9273s
	iters: 200, epoch: 14 | loss: 0.0234196
	speed: 0.2885s/iter; left time: 5163.2016s
Epoch: 14 cost time: 60.36268591880798
Epoch: 14, Steps: 208 | Train Loss: 0.262 Vali Loss: 9.081 Vali Acc: 0.084 Test Loss: 9.081 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0939313
	speed: 0.6529s/iter; left time: 11614.0458s
	iters: 200, epoch: 15 | loss: 0.0775369
	speed: 0.2427s/iter; left time: 4293.9198s
Epoch: 15 cost time: 55.65594434738159
Epoch: 15, Steps: 208 | Train Loss: 0.226 Vali Loss: 9.848 Vali Acc: 0.094 Test Loss: 9.848 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.6319816
	speed: 0.6230s/iter; left time: 10952.9270s
	iters: 200, epoch: 16 | loss: 0.1812913
	speed: 0.2687s/iter; left time: 4697.9453s
Epoch: 16 cost time: 57.93375849723816
Epoch: 16, Steps: 208 | Train Loss: 0.222 Vali Loss: 9.578 Vali Acc: 0.092 Test Loss: 9.578 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0100261
	speed: 0.6473s/iter; left time: 11245.0422s
	iters: 200, epoch: 17 | loss: 0.4641085
	speed: 0.2594s/iter; left time: 4480.9860s
Epoch: 17 cost time: 57.35611152648926
Epoch: 17, Steps: 208 | Train Loss: 0.176 Vali Loss: 10.120 Vali Acc: 0.091 Test Loss: 10.120 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10050700864897107
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0930672
	speed: 0.2963s/iter; left time: 6132.8986s
	iters: 200, epoch: 1 | loss: 3.4311652
	speed: 0.2842s/iter; left time: 5855.6260s
Epoch: 1 cost time: 60.72879648208618
Epoch: 1, Steps: 208 | Train Loss: 3.704 Vali Loss: 3.710 Vali Acc: 0.065 Test Loss: 3.710 Test Acc: 0.065
Validation loss decreased (inf --> -0.064979).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9885347
	speed: 0.6408s/iter; left time: 13132.4799s
	iters: 200, epoch: 2 | loss: 2.9936066
	speed: 0.2859s/iter; left time: 5829.8569s
Epoch: 2 cost time: 58.22494029998779
Epoch: 2, Steps: 208 | Train Loss: 3.149 Vali Loss: 3.896 Vali Acc: 0.080 Test Loss: 3.896 Test Acc: 0.080
Validation loss decreased (-0.064979 --> -0.079591).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0950844
	speed: 0.6032s/iter; left time: 12236.4612s
	iters: 200, epoch: 3 | loss: 2.9666078
	speed: 0.2720s/iter; left time: 5490.9445s
Epoch: 3 cost time: 55.466763734817505
Epoch: 3, Steps: 208 | Train Loss: 2.581 Vali Loss: 4.135 Vali Acc: 0.096 Test Loss: 4.135 Test Acc: 0.096
Validation loss decreased (-0.079591 --> -0.095992).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8345257
	speed: 0.6812s/iter; left time: 13676.6070s
	iters: 200, epoch: 4 | loss: 2.2525535
	speed: 0.2939s/iter; left time: 5870.4244s
Epoch: 4 cost time: 61.43760704994202
Epoch: 4, Steps: 208 | Train Loss: 2.054 Vali Loss: 4.571 Vali Acc: 0.094 Test Loss: 4.571 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9207745
	speed: 0.6358s/iter; left time: 12631.7477s
	iters: 200, epoch: 5 | loss: 2.2139680
	speed: 0.2895s/iter; left time: 5723.3028s
Epoch: 5 cost time: 59.3985161781311
Epoch: 5, Steps: 208 | Train Loss: 1.492 Vali Loss: 5.169 Vali Acc: 0.093 Test Loss: 5.169 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0193676
	speed: 0.6022s/iter; left time: 11839.5332s
	iters: 200, epoch: 6 | loss: 1.5392959
	speed: 0.2974s/iter; left time: 5817.2935s
Epoch: 6 cost time: 58.33755803108215
Epoch: 6, Steps: 208 | Train Loss: 1.091 Vali Loss: 5.955 Vali Acc: 0.085 Test Loss: 5.955 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8401052
	speed: 0.6603s/iter; left time: 12845.1803s
	iters: 200, epoch: 7 | loss: 0.8499219
	speed: 0.2910s/iter; left time: 5631.0161s
Epoch: 7 cost time: 60.465131521224976
Epoch: 7, Steps: 208 | Train Loss: 0.793 Vali Loss: 6.330 Vali Acc: 0.096 Test Loss: 6.330 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2600934
	speed: 0.6734s/iter; left time: 12959.7019s
	iters: 200, epoch: 8 | loss: 0.8431381
	speed: 0.2718s/iter; left time: 5202.9843s
Epoch: 8 cost time: 59.32345104217529
Epoch: 8, Steps: 208 | Train Loss: 0.657 Vali Loss: 6.885 Vali Acc: 0.096 Test Loss: 6.885 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.9660846
	speed: 0.6787s/iter; left time: 12919.4811s
	iters: 200, epoch: 9 | loss: 1.1085393
	speed: 0.2860s/iter; left time: 5416.1075s
Epoch: 9 cost time: 60.978519916534424
Epoch: 9, Steps: 208 | Train Loss: 0.550 Vali Loss: 7.477 Vali Acc: 0.088 Test Loss: 7.477 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0405584
	speed: 0.6429s/iter; left time: 12105.6461s
	iters: 200, epoch: 10 | loss: 0.6162006
	speed: 0.2876s/iter; left time: 5387.0937s
Epoch: 10 cost time: 60.51148533821106
Epoch: 10, Steps: 208 | Train Loss: 0.449 Vali Loss: 7.902 Vali Acc: 0.090 Test Loss: 7.902 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.2437619
	speed: 0.7112s/iter; left time: 13242.9702s
	iters: 200, epoch: 11 | loss: 0.3816416
	speed: 0.2752s/iter; left time: 5097.1839s
Epoch: 11 cost time: 60.886122703552246
Epoch: 11, Steps: 208 | Train Loss: 0.369 Vali Loss: 8.180 Vali Acc: 0.109 Test Loss: 8.180 Test Acc: 0.109
Validation loss decreased (-0.095992 --> -0.108776).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4516063
	speed: 0.6523s/iter; left time: 12011.3231s
	iters: 200, epoch: 12 | loss: 0.0795863
	speed: 0.2977s/iter; left time: 5452.4681s
Epoch: 12 cost time: 60.417508602142334
Epoch: 12, Steps: 208 | Train Loss: 0.342 Vali Loss: 8.916 Vali Acc: 0.101 Test Loss: 8.916 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5700117
	speed: 0.6570s/iter; left time: 11960.2115s
	iters: 200, epoch: 13 | loss: 0.7586623
	speed: 0.2793s/iter; left time: 5056.5921s
Epoch: 13 cost time: 57.502697467803955
Epoch: 13, Steps: 208 | Train Loss: 0.286 Vali Loss: 9.197 Vali Acc: 0.097 Test Loss: 9.197 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1589796
	speed: 0.6690s/iter; left time: 12039.6011s
	iters: 200, epoch: 14 | loss: 0.0644394
	speed: 0.2829s/iter; left time: 5063.4480s
Epoch: 14 cost time: 60.40586519241333
Epoch: 14, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.438 Vali Acc: 0.089 Test Loss: 9.438 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1164882
	speed: 0.6346s/iter; left time: 11288.9981s
	iters: 200, epoch: 15 | loss: 0.1834285
	speed: 0.2757s/iter; left time: 4877.6232s
Epoch: 15 cost time: 57.449960708618164
Epoch: 15, Steps: 208 | Train Loss: 0.238 Vali Loss: 10.103 Vali Acc: 0.089 Test Loss: 10.103 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0163549
	speed: 0.6785s/iter; left time: 11929.4361s
	iters: 200, epoch: 16 | loss: 0.0894439
	speed: 0.2767s/iter; left time: 4836.3794s
Epoch: 16 cost time: 57.895265340805054
Epoch: 16, Steps: 208 | Train Loss: 0.231 Vali Loss: 9.734 Vali Acc: 0.092 Test Loss: 9.734 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0514230
	speed: 0.6870s/iter; left time: 11934.4726s
	iters: 200, epoch: 17 | loss: 0.7034107
	speed: 0.3040s/iter; left time: 5250.9910s
Epoch: 17 cost time: 64.31051874160767
Epoch: 17, Steps: 208 | Train Loss: 0.192 Vali Loss: 10.196 Vali Acc: 0.097 Test Loss: 10.196 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.6188926
	speed: 0.6650s/iter; left time: 11414.0215s
	iters: 200, epoch: 18 | loss: 0.8843936
	speed: 0.3019s/iter; left time: 5152.5989s
Epoch: 18 cost time: 62.97526240348816
Epoch: 18, Steps: 208 | Train Loss: 0.182 Vali Loss: 10.137 Vali Acc: 0.091 Test Loss: 10.137 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0277355
	speed: 0.6883s/iter; left time: 11671.8935s
	iters: 200, epoch: 19 | loss: 0.0374429
	speed: 0.2716s/iter; left time: 4578.4745s
Epoch: 19 cost time: 58.12982511520386
Epoch: 19, Steps: 208 | Train Loss: 0.152 Vali Loss: 10.801 Vali Acc: 0.095 Test Loss: 10.801 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1421561
	speed: 0.7127s/iter; left time: 11937.8306s
	iters: 200, epoch: 20 | loss: 0.3011129
	speed: 0.3065s/iter; left time: 5102.7143s
Epoch: 20 cost time: 65.24885869026184
Epoch: 20, Steps: 208 | Train Loss: 0.186 Vali Loss: 10.585 Vali Acc: 0.084 Test Loss: 10.585 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0022352
	speed: 0.6745s/iter; left time: 11156.2856s
	iters: 200, epoch: 21 | loss: 0.0410897
	speed: 0.3112s/iter; left time: 5116.1447s
Epoch: 21 cost time: 63.21737337112427
Epoch: 21, Steps: 208 | Train Loss: 0.150 Vali Loss: 11.081 Vali Acc: 0.096 Test Loss: 11.081 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10885773933790635
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0911770
	speed: 0.3061s/iter; left time: 6336.7566s
	iters: 200, epoch: 1 | loss: 3.1393890
	speed: 0.3131s/iter; left time: 6450.6179s
Epoch: 1 cost time: 64.81209778785706
Epoch: 1, Steps: 208 | Train Loss: 3.717 Vali Loss: 3.660 Vali Acc: 0.072 Test Loss: 3.660 Test Acc: 0.072
Validation loss decreased (inf --> -0.071839).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9829242
	speed: 0.7178s/iter; left time: 14710.5241s
	iters: 200, epoch: 2 | loss: 3.0354710
	speed: 0.2967s/iter; left time: 6050.4660s
Epoch: 2 cost time: 64.50016975402832
Epoch: 2, Steps: 208 | Train Loss: 3.171 Vali Loss: 3.893 Vali Acc: 0.081 Test Loss: 3.893 Test Acc: 0.081
Validation loss decreased (-0.071839 --> -0.080784).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0346448
	speed: 0.7002s/iter; left time: 14203.9084s
	iters: 200, epoch: 3 | loss: 2.8464212
	speed: 0.2974s/iter; left time: 6003.2510s
Epoch: 3 cost time: 62.64291572570801
Epoch: 3, Steps: 208 | Train Loss: 2.574 Vali Loss: 4.114 Vali Acc: 0.096 Test Loss: 4.114 Test Acc: 0.096
Validation loss decreased (-0.080784 --> -0.095694).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7233583
	speed: 0.6962s/iter; left time: 13976.8278s
	iters: 200, epoch: 4 | loss: 2.3267958
	speed: 0.3118s/iter; left time: 6228.5676s
Epoch: 4 cost time: 63.43547582626343
Epoch: 4, Steps: 208 | Train Loss: 2.043 Vali Loss: 4.455 Vali Acc: 0.097 Test Loss: 4.455 Test Acc: 0.097
Validation loss decreased (-0.095694 --> -0.097182).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7738346
	speed: 0.7084s/iter; left time: 14075.4000s
	iters: 200, epoch: 5 | loss: 2.3592782
	speed: 0.2893s/iter; left time: 5719.7962s
Epoch: 5 cost time: 62.49668598175049
Epoch: 5, Steps: 208 | Train Loss: 1.488 Vali Loss: 5.232 Vali Acc: 0.094 Test Loss: 5.232 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3431022
	speed: 0.6896s/iter; left time: 13558.5237s
	iters: 200, epoch: 6 | loss: 1.3396280
	speed: 0.3070s/iter; left time: 6006.1219s
Epoch: 6 cost time: 63.1034095287323
Epoch: 6, Steps: 208 | Train Loss: 1.112 Vali Loss: 5.781 Vali Acc: 0.095 Test Loss: 5.781 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9554757
	speed: 0.6692s/iter; left time: 13018.3087s
	iters: 200, epoch: 7 | loss: 0.6743785
	speed: 0.2955s/iter; left time: 5718.3108s
Epoch: 7 cost time: 61.48397755622864
Epoch: 7, Steps: 208 | Train Loss: 0.815 Vali Loss: 6.278 Vali Acc: 0.099 Test Loss: 6.278 Test Acc: 0.099
Validation loss decreased (-0.097182 --> -0.098953).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3847376
	speed: 0.6534s/iter; left time: 12573.9568s
	iters: 200, epoch: 8 | loss: 0.7539050
	speed: 0.2803s/iter; left time: 5367.0796s
Epoch: 8 cost time: 59.20353150367737
Epoch: 8, Steps: 208 | Train Loss: 0.626 Vali Loss: 6.956 Vali Acc: 0.092 Test Loss: 6.956 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1870335
	speed: 0.6852s/iter; left time: 13044.3014s
	iters: 200, epoch: 9 | loss: 0.9994394
	speed: 0.2920s/iter; left time: 5529.5999s
Epoch: 9 cost time: 61.14292812347412
Epoch: 9, Steps: 208 | Train Loss: 0.522 Vali Loss: 7.392 Vali Acc: 0.091 Test Loss: 7.392 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1468335
	speed: 0.6593s/iter; left time: 12413.7028s
	iters: 200, epoch: 10 | loss: 0.5257760
	speed: 0.2800s/iter; left time: 5244.4840s
Epoch: 10 cost time: 59.194340229034424
Epoch: 10, Steps: 208 | Train Loss: 0.436 Vali Loss: 7.749 Vali Acc: 0.090 Test Loss: 7.749 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6619800
	speed: 0.6562s/iter; left time: 12218.5368s
	iters: 200, epoch: 11 | loss: 0.4270101
	speed: 0.2741s/iter; left time: 5076.2712s
Epoch: 11 cost time: 59.01342248916626
Epoch: 11, Steps: 208 | Train Loss: 0.397 Vali Loss: 8.213 Vali Acc: 0.088 Test Loss: 8.213 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1588141
	speed: 0.6938s/iter; left time: 12775.1111s
	iters: 200, epoch: 12 | loss: 0.6976731
	speed: 0.2906s/iter; left time: 5320.8477s
Epoch: 12 cost time: 61.82409381866455
Epoch: 12, Steps: 208 | Train Loss: 0.320 Vali Loss: 8.326 Vali Acc: 0.094 Test Loss: 8.326 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2284888
	speed: 0.6800s/iter; left time: 12378.7208s
	iters: 200, epoch: 13 | loss: 1.0484953
	speed: 0.2818s/iter; left time: 5101.5062s
Epoch: 13 cost time: 60.726760387420654
Epoch: 13, Steps: 208 | Train Loss: 0.292 Vali Loss: 8.938 Vali Acc: 0.092 Test Loss: 8.938 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3212492
	speed: 0.6613s/iter; left time: 11902.1066s
	iters: 200, epoch: 14 | loss: 0.0453682
	speed: 0.2889s/iter; left time: 5169.9245s
Epoch: 14 cost time: 59.667102336883545
Epoch: 14, Steps: 208 | Train Loss: 0.253 Vali Loss: 9.465 Vali Acc: 0.091 Test Loss: 9.465 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1506491
	speed: 0.6516s/iter; left time: 11591.6713s
	iters: 200, epoch: 15 | loss: 0.0090855
	speed: 0.2929s/iter; left time: 5181.3019s
Epoch: 15 cost time: 61.319913148880005
Epoch: 15, Steps: 208 | Train Loss: 0.228 Vali Loss: 9.590 Vali Acc: 0.087 Test Loss: 9.590 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7291088
	speed: 0.6949s/iter; left time: 12217.0874s
	iters: 200, epoch: 16 | loss: 0.1095513
	speed: 0.2826s/iter; left time: 4940.5545s
Epoch: 16 cost time: 61.226338148117065
Epoch: 16, Steps: 208 | Train Loss: 0.247 Vali Loss: 9.666 Vali Acc: 0.088 Test Loss: 9.666 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0181750
	speed: 0.6628s/iter; left time: 11515.2282s
	iters: 200, epoch: 17 | loss: 0.7229047
	speed: 0.2913s/iter; left time: 5031.0031s
Epoch: 17 cost time: 59.49359893798828
Epoch: 17, Steps: 208 | Train Loss: 0.185 Vali Loss: 10.271 Vali Acc: 0.092 Test Loss: 10.271 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09901580674023262
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0452037
	speed: 0.3065s/iter; left time: 6345.0085s
	iters: 200, epoch: 1 | loss: 3.3537068
	speed: 0.2888s/iter; left time: 5950.1115s
Epoch: 1 cost time: 62.32026290893555
Epoch: 1, Steps: 208 | Train Loss: 3.718 Vali Loss: 3.695 Vali Acc: 0.067 Test Loss: 3.695 Test Acc: 0.067
Validation loss decreased (inf --> -0.066471).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9160569
	speed: 0.6868s/iter; left time: 14074.3463s
	iters: 200, epoch: 2 | loss: 2.9650030
	speed: 0.3034s/iter; left time: 6187.5381s
Epoch: 2 cost time: 61.6853814125061
Epoch: 2, Steps: 208 | Train Loss: 3.165 Vali Loss: 3.872 Vali Acc: 0.078 Test Loss: 3.872 Test Acc: 0.078
Validation loss decreased (-0.066471 --> -0.078100).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9714360
	speed: 0.6788s/iter; left time: 13769.1092s
	iters: 200, epoch: 3 | loss: 3.1037173
	speed: 0.3054s/iter; left time: 6164.7413s
Epoch: 3 cost time: 63.16789102554321
Epoch: 3, Steps: 208 | Train Loss: 2.565 Vali Loss: 4.092 Vali Acc: 0.106 Test Loss: 4.092 Test Acc: 0.106
Validation loss decreased (-0.078100 --> -0.106133).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5325379
	speed: 0.6581s/iter; left time: 13213.5624s
	iters: 200, epoch: 4 | loss: 2.4579206
	speed: 0.2737s/iter; left time: 5467.6251s
Epoch: 4 cost time: 60.24055576324463
Epoch: 4, Steps: 208 | Train Loss: 2.028 Vali Loss: 4.609 Vali Acc: 0.101 Test Loss: 4.609 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9963025
	speed: 0.6821s/iter; left time: 13552.9631s
	iters: 200, epoch: 5 | loss: 2.3687100
	speed: 0.2937s/iter; left time: 5805.2752s
Epoch: 5 cost time: 61.076282262802124
Epoch: 5, Steps: 208 | Train Loss: 1.491 Vali Loss: 5.122 Vali Acc: 0.101 Test Loss: 5.122 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1650137
	speed: 0.6745s/iter; left time: 13261.9603s
	iters: 200, epoch: 6 | loss: 1.1218792
	speed: 0.2923s/iter; left time: 5717.2502s
Epoch: 6 cost time: 60.11137366294861
Epoch: 6, Steps: 208 | Train Loss: 1.100 Vali Loss: 5.817 Vali Acc: 0.095 Test Loss: 5.817 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9589787
	speed: 0.6509s/iter; left time: 12661.1695s
	iters: 200, epoch: 7 | loss: 0.5120835
	speed: 0.2898s/iter; left time: 5608.4301s
Epoch: 7 cost time: 60.12898564338684
Epoch: 7, Steps: 208 | Train Loss: 0.796 Vali Loss: 6.322 Vali Acc: 0.107 Test Loss: 6.322 Test Acc: 0.107
Validation loss decreased (-0.106133 --> -0.107005).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3656013
	speed: 0.6846s/iter; left time: 13175.5979s
	iters: 200, epoch: 8 | loss: 0.8182336
	speed: 0.2762s/iter; left time: 5287.4680s
Epoch: 8 cost time: 59.28595519065857
Epoch: 8, Steps: 208 | Train Loss: 0.618 Vali Loss: 6.936 Vali Acc: 0.103 Test Loss: 6.936 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1547231
	speed: 0.6660s/iter; left time: 12678.4101s
	iters: 200, epoch: 9 | loss: 0.6516407
	speed: 0.2900s/iter; left time: 5491.0304s
Epoch: 9 cost time: 59.40873718261719
Epoch: 9, Steps: 208 | Train Loss: 0.504 Vali Loss: 7.316 Vali Acc: 0.103 Test Loss: 7.316 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0353894
	speed: 0.6613s/iter; left time: 12451.7882s
	iters: 200, epoch: 10 | loss: 0.4753528
	speed: 0.2828s/iter; left time: 5297.0057s
Epoch: 10 cost time: 59.56856155395508
Epoch: 10, Steps: 208 | Train Loss: 0.421 Vali Loss: 7.925 Vali Acc: 0.092 Test Loss: 7.925 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0858626
	speed: 0.6711s/iter; left time: 12496.1868s
	iters: 200, epoch: 11 | loss: 0.6105926
	speed: 0.2951s/iter; left time: 5465.7614s
Epoch: 11 cost time: 62.00753664970398
Epoch: 11, Steps: 208 | Train Loss: 0.379 Vali Loss: 8.164 Vali Acc: 0.096 Test Loss: 8.164 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5057252
	speed: 0.6799s/iter; left time: 12519.1427s
	iters: 200, epoch: 12 | loss: 0.3686183
	speed: 0.2690s/iter; left time: 4926.1773s
Epoch: 12 cost time: 58.317012548446655
Epoch: 12, Steps: 208 | Train Loss: 0.333 Vali Loss: 8.913 Vali Acc: 0.097 Test Loss: 8.913 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.5048849
	speed: 0.6496s/iter; left time: 11826.1666s
	iters: 200, epoch: 13 | loss: 1.0892900
	speed: 0.2767s/iter; left time: 5009.4848s
Epoch: 13 cost time: 58.41225075721741
Epoch: 13, Steps: 208 | Train Loss: 0.267 Vali Loss: 9.080 Vali Acc: 0.098 Test Loss: 9.080 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2264214
	speed: 0.6651s/iter; left time: 11968.9890s
	iters: 200, epoch: 14 | loss: 0.1975535
	speed: 0.3022s/iter; left time: 5408.1319s
Epoch: 14 cost time: 61.31101155281067
Epoch: 14, Steps: 208 | Train Loss: 0.241 Vali Loss: 9.875 Vali Acc: 0.092 Test Loss: 9.875 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2264985
	speed: 0.6612s/iter; left time: 11762.2155s
	iters: 200, epoch: 15 | loss: 0.1642423
	speed: 0.2837s/iter; left time: 5019.1523s
Epoch: 15 cost time: 59.01798892021179
Epoch: 15, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.732 Vali Acc: 0.093 Test Loss: 9.732 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.3604054
	speed: 0.6958s/iter; left time: 12232.5119s
	iters: 200, epoch: 16 | loss: 0.1312436
	speed: 0.2950s/iter; left time: 5157.2446s
Epoch: 16 cost time: 62.71265769004822
Epoch: 16, Steps: 208 | Train Loss: 0.223 Vali Loss: 9.793 Vali Acc: 0.098 Test Loss: 9.793 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0740009
	speed: 0.6833s/iter; left time: 11871.2427s
	iters: 200, epoch: 17 | loss: 0.8837306
	speed: 0.2811s/iter; left time: 4855.9021s
Epoch: 17 cost time: 60.68304204940796
Epoch: 17, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.305 Vali Acc: 0.095 Test Loss: 10.305 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10706829704742023
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6807640
	speed: 0.3018s/iter; left time: 6247.9524s
	iters: 200, epoch: 1 | loss: 3.3215024
	speed: 0.2884s/iter; left time: 5941.9193s
Epoch: 1 cost time: 61.652812480926514
Epoch: 1, Steps: 208 | Train Loss: 3.680 Vali Loss: 3.792 Vali Acc: 0.062 Test Loss: 3.792 Test Acc: 0.062
Validation loss decreased (inf --> -0.061698).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9022632
	speed: 0.6526s/iter; left time: 13374.0637s
	iters: 200, epoch: 2 | loss: 3.2486041
	speed: 0.2759s/iter; left time: 5627.4451s
Epoch: 2 cost time: 58.292166233062744
Epoch: 2, Steps: 208 | Train Loss: 3.143 Vali Loss: 4.034 Vali Acc: 0.068 Test Loss: 4.034 Test Acc: 0.068
Validation loss decreased (-0.061698 --> -0.067660).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9998547
	speed: 0.6286s/iter; left time: 12751.5718s
	iters: 200, epoch: 3 | loss: 3.0363195
	speed: 0.2778s/iter; left time: 5607.8528s
Epoch: 3 cost time: 57.27423548698425
Epoch: 3, Steps: 208 | Train Loss: 2.611 Vali Loss: 4.310 Vali Acc: 0.082 Test Loss: 4.310 Test Acc: 0.082
Validation loss decreased (-0.067660 --> -0.081973).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6588898
	speed: 0.6843s/iter; left time: 13739.2900s
	iters: 200, epoch: 4 | loss: 2.4317620
	speed: 0.2763s/iter; left time: 5519.7459s
Epoch: 4 cost time: 60.65432095527649
Epoch: 4, Steps: 208 | Train Loss: 2.080 Vali Loss: 4.722 Vali Acc: 0.086 Test Loss: 4.722 Test Acc: 0.086
Validation loss decreased (-0.081973 --> -0.085548).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4328423
	speed: 0.6776s/iter; left time: 13463.8905s
	iters: 200, epoch: 5 | loss: 2.4556451
	speed: 0.2836s/iter; left time: 5605.9336s
Epoch: 5 cost time: 61.41938614845276
Epoch: 5, Steps: 208 | Train Loss: 1.542 Vali Loss: 5.077 Vali Acc: 0.088 Test Loss: 5.077 Test Acc: 0.088
Validation loss decreased (-0.085548 --> -0.087930).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1622672
	speed: 0.6739s/iter; left time: 13249.8236s
	iters: 200, epoch: 6 | loss: 1.2669134
	speed: 0.2977s/iter; left time: 5824.0902s
Epoch: 6 cost time: 61.40790843963623
Epoch: 6, Steps: 208 | Train Loss: 1.156 Vali Loss: 5.812 Vali Acc: 0.082 Test Loss: 5.812 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8414011
	speed: 0.6421s/iter; left time: 12490.1123s
	iters: 200, epoch: 7 | loss: 0.7870924
	speed: 0.2662s/iter; left time: 5152.1476s
Epoch: 7 cost time: 55.718154430389404
Epoch: 7, Steps: 208 | Train Loss: 0.833 Vali Loss: 6.357 Vali Acc: 0.099 Test Loss: 6.357 Test Acc: 0.099
Validation loss decreased (-0.087930 --> -0.098952).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4286471
	speed: 0.6868s/iter; left time: 13217.3796s
	iters: 200, epoch: 8 | loss: 0.8061806
	speed: 0.3027s/iter; left time: 5794.7128s
Epoch: 8 cost time: 63.5377414226532
Epoch: 8, Steps: 208 | Train Loss: 0.683 Vali Loss: 6.629 Vali Acc: 0.093 Test Loss: 6.629 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7713824
	speed: 0.6818s/iter; left time: 12979.5736s
	iters: 200, epoch: 9 | loss: 0.9135897
	speed: 0.2804s/iter; left time: 5309.9405s
Epoch: 9 cost time: 59.9211151599884
Epoch: 9, Steps: 208 | Train Loss: 0.543 Vali Loss: 7.130 Vali Acc: 0.098 Test Loss: 7.130 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1923835
	speed: 0.6573s/iter; left time: 12376.1503s
	iters: 200, epoch: 10 | loss: 0.5978379
	speed: 0.2817s/iter; left time: 5275.4649s
Epoch: 10 cost time: 60.52798795700073
Epoch: 10, Steps: 208 | Train Loss: 0.459 Vali Loss: 7.746 Vali Acc: 0.093 Test Loss: 7.746 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2256886
	speed: 0.6675s/iter; left time: 12428.7064s
	iters: 200, epoch: 11 | loss: 0.6600433
	speed: 0.2853s/iter; left time: 5284.2136s
Epoch: 11 cost time: 60.57634949684143
Epoch: 11, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.855 Vali Acc: 0.096 Test Loss: 7.855 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5537214
	speed: 0.6902s/iter; left time: 12707.8431s
	iters: 200, epoch: 12 | loss: 0.4346872
	speed: 0.2777s/iter; left time: 5086.0089s
Epoch: 12 cost time: 60.36138701438904
Epoch: 12, Steps: 208 | Train Loss: 0.330 Vali Loss: 8.159 Vali Acc: 0.104 Test Loss: 8.159 Test Acc: 0.104
Validation loss decreased (-0.098952 --> -0.104303).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6509765
	speed: 0.6598s/iter; left time: 12012.3325s
	iters: 200, epoch: 13 | loss: 1.0361402
	speed: 0.2673s/iter; left time: 4840.2818s
Epoch: 13 cost time: 56.93963313102722
Epoch: 13, Steps: 208 | Train Loss: 0.288 Vali Loss: 8.692 Vali Acc: 0.100 Test Loss: 8.692 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5183574
	speed: 0.6503s/iter; left time: 11703.8395s
	iters: 200, epoch: 14 | loss: 0.0516714
	speed: 0.2846s/iter; left time: 5092.8587s
Epoch: 14 cost time: 58.89662551879883
Epoch: 14, Steps: 208 | Train Loss: 0.253 Vali Loss: 8.798 Vali Acc: 0.096 Test Loss: 8.798 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0302538
	speed: 0.6811s/iter; left time: 12115.7117s
	iters: 200, epoch: 15 | loss: 0.0802719
	speed: 0.2797s/iter; left time: 4947.0369s
Epoch: 15 cost time: 58.95941948890686
Epoch: 15, Steps: 208 | Train Loss: 0.216 Vali Loss: 9.355 Vali Acc: 0.095 Test Loss: 9.355 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3116242
	speed: 0.6348s/iter; left time: 11161.1738s
	iters: 200, epoch: 16 | loss: 0.6530277
	speed: 0.2812s/iter; left time: 4915.0735s
Epoch: 16 cost time: 58.42094540596008
Epoch: 16, Steps: 208 | Train Loss: 0.202 Vali Loss: 9.285 Vali Acc: 0.095 Test Loss: 9.285 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0660671
	speed: 0.6440s/iter; left time: 11187.5421s
	iters: 200, epoch: 17 | loss: 0.2899555
	speed: 0.2827s/iter; left time: 4882.8332s
Epoch: 17 cost time: 57.84350371360779
Epoch: 17, Steps: 208 | Train Loss: 0.198 Vali Loss: 9.918 Vali Acc: 0.096 Test Loss: 9.918 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.5282573
	speed: 0.6561s/iter; left time: 11262.3560s
	iters: 200, epoch: 18 | loss: 0.0287330
	speed: 0.2808s/iter; left time: 4791.9791s
Epoch: 18 cost time: 58.99115228652954
Epoch: 18, Steps: 208 | Train Loss: 0.194 Vali Loss: 9.844 Vali Acc: 0.101 Test Loss: 9.844 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4004643
	speed: 0.6473s/iter; left time: 10976.2891s
	iters: 200, epoch: 19 | loss: 0.1878334
	speed: 0.2738s/iter; left time: 4615.5902s
Epoch: 19 cost time: 56.90674901008606
Epoch: 19, Steps: 208 | Train Loss: 0.185 Vali Loss: 9.986 Vali Acc: 0.097 Test Loss: 9.986 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0944630
	speed: 0.6371s/iter; left time: 10671.4002s
	iters: 200, epoch: 20 | loss: 0.6495553
	speed: 0.2784s/iter; left time: 4635.7862s
Epoch: 20 cost time: 58.66138172149658
Epoch: 20, Steps: 208 | Train Loss: 0.142 Vali Loss: 10.140 Vali Acc: 0.100 Test Loss: 10.140 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0130466
	speed: 0.6468s/iter; left time: 10699.0358s
	iters: 200, epoch: 21 | loss: 0.1554128
	speed: 0.2760s/iter; left time: 4538.0354s
Epoch: 21 cost time: 58.73832130432129
Epoch: 21, Steps: 208 | Train Loss: 0.152 Vali Loss: 10.212 Vali Acc: 0.094 Test Loss: 10.212 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0080832
	speed: 0.6544s/iter; left time: 10688.2397s
	iters: 200, epoch: 22 | loss: 0.1464583
	speed: 0.2750s/iter; left time: 4463.8534s
Epoch: 22 cost time: 58.87118673324585
Epoch: 22, Steps: 208 | Train Loss: 0.135 Vali Loss: 10.621 Vali Acc: 0.088 Test Loss: 10.621 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10438413361169102
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0019016
	speed: 0.2704s/iter; left time: 5596.8656s
	iters: 200, epoch: 1 | loss: 3.2003317
	speed: 0.2932s/iter; left time: 6040.8672s
Epoch: 1 cost time: 58.940584659576416
Epoch: 1, Steps: 208 | Train Loss: 3.613 Vali Loss: 3.825 Vali Acc: 0.071 Test Loss: 3.825 Test Acc: 0.071
Validation loss decreased (inf --> -0.070943).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9345512
	speed: 0.6740s/iter; left time: 13812.1546s
	iters: 200, epoch: 2 | loss: 3.1053915
	speed: 0.2984s/iter; left time: 6085.1090s
Epoch: 2 cost time: 60.99997019767761
Epoch: 2, Steps: 208 | Train Loss: 3.046 Vali Loss: 4.153 Vali Acc: 0.073 Test Loss: 4.153 Test Acc: 0.073
Validation loss decreased (-0.070943 --> -0.073027).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1781688
	speed: 0.6344s/iter; left time: 12869.7492s
	iters: 200, epoch: 3 | loss: 2.9732704
	speed: 0.2841s/iter; left time: 5733.9972s
Epoch: 3 cost time: 58.524245738983154
Epoch: 3, Steps: 208 | Train Loss: 2.630 Vali Loss: 4.343 Vali Acc: 0.082 Test Loss: 4.343 Test Acc: 0.082
Validation loss decreased (-0.073027 --> -0.081973).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9536774
	speed: 0.6297s/iter; left time: 12643.0710s
	iters: 200, epoch: 4 | loss: 1.9986280
	speed: 0.2903s/iter; left time: 5798.6053s
Epoch: 4 cost time: 59.0430953502655
Epoch: 4, Steps: 208 | Train Loss: 2.220 Vali Loss: 4.800 Vali Acc: 0.092 Test Loss: 4.800 Test Acc: 0.092
Validation loss decreased (-0.081973 --> -0.091810).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2695556
	speed: 0.6241s/iter; left time: 12400.6847s
	iters: 200, epoch: 5 | loss: 2.5789669
	speed: 0.2844s/iter; left time: 5621.9789s
Epoch: 5 cost time: 59.47283387184143
Epoch: 5, Steps: 208 | Train Loss: 1.755 Vali Loss: 5.164 Vali Acc: 0.095 Test Loss: 5.164 Test Acc: 0.095
Validation loss decreased (-0.091810 --> -0.094491).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2629458
	speed: 0.6247s/iter; left time: 12282.4771s
	iters: 200, epoch: 6 | loss: 1.3907738
	speed: 0.2604s/iter; left time: 5093.7519s
Epoch: 6 cost time: 57.24298024177551
Epoch: 6, Steps: 208 | Train Loss: 1.351 Vali Loss: 5.933 Vali Acc: 0.100 Test Loss: 5.933 Test Acc: 0.100
Validation loss decreased (-0.094491 --> -0.099553).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8421996
	speed: 0.6394s/iter; left time: 12437.7767s
	iters: 200, epoch: 7 | loss: 1.4791012
	speed: 0.2541s/iter; left time: 4916.7759s
Epoch: 7 cost time: 56.35678505897522
Epoch: 7, Steps: 208 | Train Loss: 1.040 Vali Loss: 6.249 Vali Acc: 0.104 Test Loss: 6.249 Test Acc: 0.104
Validation loss decreased (-0.099553 --> -0.104322).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1489887
	speed: 0.6261s/iter; left time: 12049.2511s
	iters: 200, epoch: 8 | loss: 1.2560065
	speed: 0.2797s/iter; left time: 5354.9177s
Epoch: 8 cost time: 58.42498207092285
Epoch: 8, Steps: 208 | Train Loss: 0.859 Vali Loss: 6.724 Vali Acc: 0.083 Test Loss: 6.724 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9685436
	speed: 0.6201s/iter; left time: 11804.4015s
	iters: 200, epoch: 9 | loss: 1.3968148
	speed: 0.2545s/iter; left time: 4820.1596s
Epoch: 9 cost time: 56.29877424240112
Epoch: 9, Steps: 208 | Train Loss: 0.700 Vali Loss: 7.317 Vali Acc: 0.083 Test Loss: 7.317 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0801228
	speed: 0.6424s/iter; left time: 12096.6053s
	iters: 200, epoch: 10 | loss: 1.1982232
	speed: 0.2693s/iter; left time: 5044.5111s
Epoch: 10 cost time: 57.4282386302948
Epoch: 10, Steps: 208 | Train Loss: 0.637 Vali Loss: 7.148 Vali Acc: 0.097 Test Loss: 7.148 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0134733
	speed: 0.6221s/iter; left time: 11584.0994s
	iters: 200, epoch: 11 | loss: 0.3311437
	speed: 0.2616s/iter; left time: 4845.1821s
Epoch: 11 cost time: 55.4087028503418
Epoch: 11, Steps: 208 | Train Loss: 0.510 Vali Loss: 7.727 Vali Acc: 0.100 Test Loss: 7.727 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3089751
	speed: 0.6244s/iter; left time: 11496.3672s
	iters: 200, epoch: 12 | loss: 0.5871594
	speed: 0.2444s/iter; left time: 4475.3572s
Epoch: 12 cost time: 52.850268840789795
Epoch: 12, Steps: 208 | Train Loss: 0.469 Vali Loss: 8.006 Vali Acc: 0.100 Test Loss: 8.006 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6243021
	speed: 0.6354s/iter; left time: 11568.2751s
	iters: 200, epoch: 13 | loss: 1.5029827
	speed: 0.2654s/iter; left time: 4804.5490s
Epoch: 13 cost time: 57.73590087890625
Epoch: 13, Steps: 208 | Train Loss: 0.448 Vali Loss: 8.614 Vali Acc: 0.101 Test Loss: 8.614 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5146069
	speed: 0.6799s/iter; left time: 12235.5426s
	iters: 200, epoch: 14 | loss: 0.3265411
	speed: 0.2707s/iter; left time: 4845.2661s
Epoch: 14 cost time: 59.4199755191803
Epoch: 14, Steps: 208 | Train Loss: 0.379 Vali Loss: 8.486 Vali Acc: 0.097 Test Loss: 8.486 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1942917
	speed: 0.6375s/iter; left time: 11339.8146s
	iters: 200, epoch: 15 | loss: 0.2826667
	speed: 0.2592s/iter; left time: 4585.5392s
Epoch: 15 cost time: 57.297242403030396
Epoch: 15, Steps: 208 | Train Loss: 0.350 Vali Loss: 8.910 Vali Acc: 0.097 Test Loss: 8.910 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.3863316
	speed: 0.6178s/iter; left time: 10861.2443s
	iters: 200, epoch: 16 | loss: 0.0792108
	speed: 0.2731s/iter; left time: 4774.9003s
Epoch: 16 cost time: 55.109824657440186
Epoch: 16, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.914 Vali Acc: 0.095 Test Loss: 8.914 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.3089887
	speed: 0.6639s/iter; left time: 11533.4510s
	iters: 200, epoch: 17 | loss: 1.3359888
	speed: 0.2847s/iter; left time: 4918.0119s
Epoch: 17 cost time: 59.938966274261475
Epoch: 17, Steps: 208 | Train Loss: 0.278 Vali Loss: 9.030 Vali Acc: 0.100 Test Loss: 9.030 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10438413361169102
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8675096
	speed: 0.2612s/iter; left time: 5407.8227s
	iters: 200, epoch: 1 | loss: 3.0928273
	speed: 0.2616s/iter; left time: 5388.9860s
Epoch: 1 cost time: 54.661170959472656
Epoch: 1, Steps: 208 | Train Loss: 3.633 Vali Loss: 3.779 Vali Acc: 0.075 Test Loss: 3.779 Test Acc: 0.075
Validation loss decreased (inf --> -0.074821).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1028957
	speed: 0.6027s/iter; left time: 12351.6976s
	iters: 200, epoch: 2 | loss: 3.3042789
	speed: 0.2828s/iter; left time: 5766.5235s
Epoch: 2 cost time: 55.91520166397095
Epoch: 2, Steps: 208 | Train Loss: 3.138 Vali Loss: 4.262 Vali Acc: 0.060 Test Loss: 4.262 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5517755
	speed: 0.6393s/iter; left time: 12968.2017s
	iters: 200, epoch: 3 | loss: 2.5636883
	speed: 0.2711s/iter; left time: 5471.6590s
Epoch: 3 cost time: 58.61560297012329
Epoch: 3, Steps: 208 | Train Loss: 2.813 Vali Loss: 4.557 Vali Acc: 0.078 Test Loss: 4.557 Test Acc: 0.078
Validation loss decreased (-0.074821 --> -0.077795).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0929301
	speed: 0.6433s/iter; left time: 12915.6015s
	iters: 200, epoch: 4 | loss: 1.9039382
	speed: 0.2583s/iter; left time: 5159.3098s
Epoch: 4 cost time: 56.33734846115112
Epoch: 4, Steps: 208 | Train Loss: 2.500 Vali Loss: 4.966 Vali Acc: 0.081 Test Loss: 4.966 Test Acc: 0.081
Validation loss decreased (-0.077795 --> -0.081370).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7055938
	speed: 0.6205s/iter; left time: 12328.7533s
	iters: 200, epoch: 5 | loss: 2.3417127
	speed: 0.2772s/iter; left time: 5480.6942s
Epoch: 5 cost time: 56.76081132888794
Epoch: 5, Steps: 208 | Train Loss: 2.137 Vali Loss: 5.131 Vali Acc: 0.077 Test Loss: 5.131 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4088430
	speed: 0.6290s/iter; left time: 12367.5397s
	iters: 200, epoch: 6 | loss: 2.6256909
	speed: 0.2774s/iter; left time: 5426.0952s
Epoch: 6 cost time: 57.99265217781067
Epoch: 6, Steps: 208 | Train Loss: 1.772 Vali Loss: 5.750 Vali Acc: 0.077 Test Loss: 5.750 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7249757
	speed: 0.6574s/iter; left time: 12787.7368s
	iters: 200, epoch: 7 | loss: 1.7557687
	speed: 0.2709s/iter; left time: 5242.8979s
Epoch: 7 cost time: 58.02696990966797
Epoch: 7, Steps: 208 | Train Loss: 1.402 Vali Loss: 5.983 Vali Acc: 0.092 Test Loss: 5.983 Test Acc: 0.092
Validation loss decreased (-0.081370 --> -0.092096).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7556071
	speed: 0.6272s/iter; left time: 12070.1503s
	iters: 200, epoch: 8 | loss: 1.7020005
	speed: 0.2842s/iter; left time: 5441.8099s
Epoch: 8 cost time: 56.935848236083984
Epoch: 8, Steps: 208 | Train Loss: 1.166 Vali Loss: 6.312 Vali Acc: 0.089 Test Loss: 6.312 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7326797
	speed: 0.6222s/iter; left time: 11845.5126s
	iters: 200, epoch: 9 | loss: 1.6257480
	speed: 0.2754s/iter; left time: 5215.6583s
Epoch: 9 cost time: 57.34336996078491
Epoch: 9, Steps: 208 | Train Loss: 0.939 Vali Loss: 6.730 Vali Acc: 0.082 Test Loss: 6.730 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4981535
	speed: 0.6481s/iter; left time: 12203.8552s
	iters: 200, epoch: 10 | loss: 0.9805244
	speed: 0.2672s/iter; left time: 5005.1647s
Epoch: 10 cost time: 58.18322944641113
Epoch: 10, Steps: 208 | Train Loss: 0.795 Vali Loss: 7.047 Vali Acc: 0.089 Test Loss: 7.047 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2432688
	speed: 0.6645s/iter; left time: 12374.3566s
	iters: 200, epoch: 11 | loss: 0.2772337
	speed: 0.2909s/iter; left time: 5387.3844s
Epoch: 11 cost time: 59.83154487609863
Epoch: 11, Steps: 208 | Train Loss: 0.665 Vali Loss: 7.174 Vali Acc: 0.086 Test Loss: 7.174 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3220889
	speed: 0.6373s/iter; left time: 11733.9244s
	iters: 200, epoch: 12 | loss: 0.5571268
	speed: 0.2835s/iter; left time: 5192.5451s
Epoch: 12 cost time: 58.654147148132324
Epoch: 12, Steps: 208 | Train Loss: 0.620 Vali Loss: 7.736 Vali Acc: 0.088 Test Loss: 7.736 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.4458399
	speed: 0.6218s/iter; left time: 11319.8433s
	iters: 200, epoch: 13 | loss: 1.8226093
	speed: 0.2543s/iter; left time: 4603.5340s
Epoch: 13 cost time: 55.220619678497314
Epoch: 13, Steps: 208 | Train Loss: 0.549 Vali Loss: 7.802 Vali Acc: 0.092 Test Loss: 7.802 Test Acc: 0.092
Validation loss decreased (-0.092096 --> -0.092376).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8484101
	speed: 0.6411s/iter; left time: 11538.6749s
	iters: 200, epoch: 14 | loss: 0.1897638
	speed: 0.2716s/iter; left time: 4861.6667s
Epoch: 14 cost time: 57.52307343482971
Epoch: 14, Steps: 208 | Train Loss: 0.484 Vali Loss: 8.291 Vali Acc: 0.092 Test Loss: 8.291 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1208419
	speed: 0.6486s/iter; left time: 11537.4253s
	iters: 200, epoch: 15 | loss: 0.3541637
	speed: 0.2836s/iter; left time: 5017.0384s
Epoch: 15 cost time: 58.61549615859985
Epoch: 15, Steps: 208 | Train Loss: 0.457 Vali Loss: 8.015 Vali Acc: 0.086 Test Loss: 8.015 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2903609
	speed: 0.6154s/iter; left time: 10819.1078s
	iters: 200, epoch: 16 | loss: 0.5423897
	speed: 0.2656s/iter; left time: 4642.3117s
Epoch: 16 cost time: 56.924601554870605
Epoch: 16, Steps: 208 | Train Loss: 0.383 Vali Loss: 8.517 Vali Acc: 0.084 Test Loss: 8.517 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0580168
	speed: 0.6205s/iter; left time: 10780.1697s
	iters: 200, epoch: 17 | loss: 1.1049449
	speed: 0.2792s/iter; left time: 4822.6126s
Epoch: 17 cost time: 58.149630546569824
Epoch: 17, Steps: 208 | Train Loss: 0.374 Vali Loss: 8.557 Vali Acc: 0.089 Test Loss: 8.557 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6153596
	speed: 0.6747s/iter; left time: 11580.5954s
	iters: 200, epoch: 18 | loss: 0.8877130
	speed: 0.2884s/iter; left time: 4922.1983s
Epoch: 18 cost time: 60.28276562690735
Epoch: 18, Steps: 208 | Train Loss: 0.324 Vali Loss: 8.661 Vali Acc: 0.097 Test Loss: 8.661 Test Acc: 0.097
Validation loss decreased (-0.092376 --> -0.096543).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5948916
	speed: 0.6155s/iter; left time: 10436.7600s
	iters: 200, epoch: 19 | loss: 0.3104688
	speed: 0.2690s/iter; left time: 4534.1077s
Epoch: 19 cost time: 57.02827072143555
Epoch: 19, Steps: 208 | Train Loss: 0.311 Vali Loss: 9.059 Vali Acc: 0.093 Test Loss: 9.059 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0892851
	speed: 0.6318s/iter; left time: 10582.2211s
	iters: 200, epoch: 20 | loss: 0.0292792
	speed: 0.2672s/iter; left time: 4448.5916s
Epoch: 20 cost time: 56.42695593833923
Epoch: 20, Steps: 208 | Train Loss: 0.283 Vali Loss: 9.504 Vali Acc: 0.098 Test Loss: 9.504 Test Acc: 0.098
Validation loss decreased (-0.096543 --> -0.097430).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2062350
	speed: 0.6314s/iter; left time: 10444.6378s
	iters: 200, epoch: 21 | loss: 0.1764150
	speed: 0.2714s/iter; left time: 4461.8975s
Epoch: 21 cost time: 57.554890632629395
Epoch: 21, Steps: 208 | Train Loss: 0.277 Vali Loss: 9.309 Vali Acc: 0.095 Test Loss: 9.309 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0808152
	speed: 0.6474s/iter; left time: 10574.7305s
	iters: 200, epoch: 22 | loss: 0.1828179
	speed: 0.2749s/iter; left time: 4462.9495s
Epoch: 22 cost time: 58.015331983566284
Epoch: 22, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.792 Vali Acc: 0.090 Test Loss: 9.792 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.1404793
	speed: 0.6329s/iter; left time: 10205.9944s
	iters: 200, epoch: 23 | loss: 0.3559757
	speed: 0.2831s/iter; left time: 4536.8741s
Epoch: 23 cost time: 58.226335525512695
Epoch: 23, Steps: 208 | Train Loss: 0.238 Vali Loss: 9.820 Vali Acc: 0.092 Test Loss: 9.820 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.4328240
	speed: 0.6361s/iter; left time: 10125.0634s
	iters: 200, epoch: 24 | loss: 0.0413695
	speed: 0.2606s/iter; left time: 4121.2000s
Epoch: 24 cost time: 56.7647979259491
Epoch: 24, Steps: 208 | Train Loss: 0.201 Vali Loss: 9.617 Vali Acc: 0.096 Test Loss: 9.617 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1739061
	speed: 0.6408s/iter; left time: 10066.7729s
	iters: 200, epoch: 25 | loss: 0.2109581
	speed: 0.2851s/iter; left time: 4450.0514s
Epoch: 25 cost time: 58.10641050338745
Epoch: 25, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.601 Vali Acc: 0.095 Test Loss: 9.601 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1823413
	speed: 0.6330s/iter; left time: 9812.8989s
	iters: 200, epoch: 26 | loss: 0.2524517
	speed: 0.2688s/iter; left time: 4139.5154s
Epoch: 26 cost time: 57.530163526535034
Epoch: 26, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.822 Vali Acc: 0.097 Test Loss: 9.822 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.2511871
	speed: 0.6141s/iter; left time: 9391.6529s
	iters: 200, epoch: 27 | loss: 0.6774931
	speed: 0.2612s/iter; left time: 3968.4699s
Epoch: 27 cost time: 54.9461350440979
Epoch: 27, Steps: 208 | Train Loss: 0.190 Vali Loss: 9.960 Vali Acc: 0.095 Test Loss: 9.960 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0038372
	speed: 0.6475s/iter; left time: 9768.0579s
	iters: 200, epoch: 28 | loss: 0.0204458
	speed: 0.2865s/iter; left time: 4293.4804s
Epoch: 28 cost time: 59.189722299575806
Epoch: 28, Steps: 208 | Train Loss: 0.200 Vali Loss: 10.246 Vali Acc: 0.096 Test Loss: 10.246 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.3047520
	speed: 0.6356s/iter; left time: 9456.3025s
	iters: 200, epoch: 29 | loss: 0.1586505
	speed: 0.2572s/iter; left time: 3799.9500s
Epoch: 29 cost time: 55.95995092391968
Epoch: 29, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.506 Vali Acc: 0.089 Test Loss: 10.506 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.2179603
	speed: 0.6094s/iter; left time: 8939.6338s
	iters: 200, epoch: 30 | loss: 0.0423802
	speed: 0.2727s/iter; left time: 3973.6892s
Epoch: 30 cost time: 54.94737410545349
Epoch: 30, Steps: 208 | Train Loss: 0.167 Vali Loss: 10.766 Vali Acc: 0.094 Test Loss: 10.766 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09752460483149418
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8870883
	speed: 0.2601s/iter; left time: 5384.1504s
	iters: 200, epoch: 1 | loss: 3.5006919
	speed: 0.2825s/iter; left time: 5820.4230s
Epoch: 1 cost time: 56.46663808822632
Epoch: 1, Steps: 208 | Train Loss: 3.653 Vali Loss: 4.191 Vali Acc: 0.037 Test Loss: 4.191 Test Acc: 0.037
Validation loss decreased (inf --> -0.037238).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0298190
	speed: 0.6237s/iter; left time: 12781.5772s
	iters: 200, epoch: 2 | loss: 2.9743705
	speed: 0.2470s/iter; left time: 5037.7171s
Epoch: 2 cost time: 54.47136306762695
Epoch: 2, Steps: 208 | Train Loss: 3.233 Vali Loss: 4.753 Vali Acc: 0.036 Test Loss: 4.753 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2362571
	speed: 0.6358s/iter; left time: 12897.0458s
	iters: 200, epoch: 3 | loss: 2.7165346
	speed: 0.2772s/iter; left time: 5595.0599s
Epoch: 3 cost time: 57.39437532424927
Epoch: 3, Steps: 208 | Train Loss: 2.985 Vali Loss: 5.089 Vali Acc: 0.049 Test Loss: 5.089 Test Acc: 0.049
Validation loss decreased (-0.037238 --> -0.048861).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6249461
	speed: 0.6903s/iter; left time: 13860.0042s
	iters: 200, epoch: 4 | loss: 2.7832685
	speed: 0.3086s/iter; left time: 6165.8740s
Epoch: 4 cost time: 64.65920448303223
Epoch: 4, Steps: 208 | Train Loss: 2.782 Vali Loss: 5.483 Vali Acc: 0.050 Test Loss: 5.483 Test Acc: 0.050
Validation loss decreased (-0.048861 --> -0.050348).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8756227
	speed: 0.7127s/iter; left time: 14160.1818s
	iters: 200, epoch: 5 | loss: 2.9881206
	speed: 0.3191s/iter; left time: 6307.5730s
Epoch: 5 cost time: 66.32500576972961
Epoch: 5, Steps: 208 | Train Loss: 2.479 Vali Loss: 5.284 Vali Acc: 0.059 Test Loss: 5.284 Test Acc: 0.059
Validation loss decreased (-0.050348 --> -0.058999).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0565994
	speed: 0.7083s/iter; left time: 13925.2028s
	iters: 200, epoch: 6 | loss: 3.5907688
	speed: 0.3014s/iter; left time: 5894.8649s
Epoch: 6 cost time: 63.36937141418457
Epoch: 6, Steps: 208 | Train Loss: 2.147 Vali Loss: 5.911 Vali Acc: 0.060 Test Loss: 5.911 Test Acc: 0.060
Validation loss decreased (-0.058999 --> -0.059887).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7754421
	speed: 0.7500s/iter; left time: 14589.2409s
	iters: 200, epoch: 7 | loss: 2.1684854
	speed: 0.3230s/iter; left time: 6250.4234s
Epoch: 7 cost time: 68.71913194656372
Epoch: 7, Steps: 208 | Train Loss: 1.782 Vali Loss: 5.995 Vali Acc: 0.073 Test Loss: 5.995 Test Acc: 0.073
Validation loss decreased (-0.059887 --> -0.072711).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1394778
	speed: 0.6913s/iter; left time: 13304.6992s
	iters: 200, epoch: 8 | loss: 2.4377539
	speed: 0.3181s/iter; left time: 6090.3816s
Epoch: 8 cost time: 62.65267467498779
Epoch: 8, Steps: 208 | Train Loss: 1.465 Vali Loss: 6.399 Vali Acc: 0.077 Test Loss: 6.399 Test Acc: 0.077
Validation loss decreased (-0.072711 --> -0.077180).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2292759
	speed: 0.7395s/iter; left time: 14077.1774s
	iters: 200, epoch: 9 | loss: 1.6852504
	speed: 0.3100s/iter; left time: 5870.7730s
Epoch: 9 cost time: 66.25288081169128
Epoch: 9, Steps: 208 | Train Loss: 1.217 Vali Loss: 6.690 Vali Acc: 0.084 Test Loss: 6.690 Test Acc: 0.084
Validation loss decreased (-0.077180 --> -0.084335).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7085316
	speed: 0.7946s/iter; left time: 14962.3803s
	iters: 200, epoch: 10 | loss: 1.2787598
	speed: 0.3400s/iter; left time: 6368.1547s
Epoch: 10 cost time: 72.40745759010315
Epoch: 10, Steps: 208 | Train Loss: 1.006 Vali Loss: 7.265 Vali Acc: 0.076 Test Loss: 7.265 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2353574
	speed: 0.8748s/iter; left time: 16289.6481s
	iters: 200, epoch: 11 | loss: 0.8193039
	speed: 0.3850s/iter; left time: 7130.4850s
Epoch: 11 cost time: 79.42698836326599
Epoch: 11, Steps: 208 | Train Loss: 0.864 Vali Loss: 7.615 Vali Acc: 0.077 Test Loss: 7.615 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6303699
	speed: 0.8158s/iter; left time: 15022.0045s
	iters: 200, epoch: 12 | loss: 0.9196808
	speed: 0.3401s/iter; left time: 6228.6601s
Epoch: 12 cost time: 69.49878430366516
Epoch: 12, Steps: 208 | Train Loss: 0.749 Vali Loss: 7.613 Vali Acc: 0.085 Test Loss: 7.613 Test Acc: 0.085
Validation loss decreased (-0.084335 --> -0.084922).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4195545
	speed: 0.8273s/iter; left time: 15060.2207s
	iters: 200, epoch: 13 | loss: 1.3294430
	speed: 0.3277s/iter; left time: 5933.8618s
Epoch: 13 cost time: 71.53243374824524
Epoch: 13, Steps: 208 | Train Loss: 0.658 Vali Loss: 8.235 Vali Acc: 0.082 Test Loss: 8.235 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9941776
	speed: 0.8109s/iter; left time: 14593.9274s
	iters: 200, epoch: 14 | loss: 0.8363383
	speed: 0.3384s/iter; left time: 6056.5181s
Epoch: 14 cost time: 71.22726535797119
Epoch: 14, Steps: 208 | Train Loss: 0.565 Vali Loss: 8.258 Vali Acc: 0.091 Test Loss: 8.258 Test Acc: 0.091
Validation loss decreased (-0.084922 --> -0.091179).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0942212
	speed: 0.8136s/iter; left time: 14473.4367s
	iters: 200, epoch: 15 | loss: 1.0908552
	speed: 0.3577s/iter; left time: 6327.5493s
Epoch: 15 cost time: 71.47068309783936
Epoch: 15, Steps: 208 | Train Loss: 0.491 Vali Loss: 8.762 Vali Acc: 0.074 Test Loss: 8.762 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4592968
	speed: 0.7986s/iter; left time: 14039.6156s
	iters: 200, epoch: 16 | loss: 0.2829497
	speed: 0.3424s/iter; left time: 5985.5552s
Epoch: 16 cost time: 71.58585619926453
Epoch: 16, Steps: 208 | Train Loss: 0.444 Vali Loss: 9.195 Vali Acc: 0.075 Test Loss: 9.195 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3192711
	speed: 0.8256s/iter; left time: 14343.3612s
	iters: 200, epoch: 17 | loss: 0.9020640
	speed: 0.3184s/iter; left time: 5499.8400s
Epoch: 17 cost time: 70.50356960296631
Epoch: 17, Steps: 208 | Train Loss: 0.424 Vali Loss: 9.415 Vali Acc: 0.085 Test Loss: 9.415 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7288735
	speed: 0.8327s/iter; left time: 14293.4079s
	iters: 200, epoch: 18 | loss: 0.5093431
	speed: 0.3447s/iter; left time: 5881.6321s
Epoch: 18 cost time: 72.20675420761108
Epoch: 18, Steps: 208 | Train Loss: 0.392 Vali Loss: 9.275 Vali Acc: 0.087 Test Loss: 9.275 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5717189
	speed: 0.8500s/iter; left time: 14412.6924s
	iters: 200, epoch: 19 | loss: 0.5152512
	speed: 0.3693s/iter; left time: 6225.2023s
Epoch: 19 cost time: 74.82511520385742
Epoch: 19, Steps: 208 | Train Loss: 0.369 Vali Loss: 9.723 Vali Acc: 0.087 Test Loss: 9.723 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1364153
	speed: 0.8654s/iter; left time: 14494.1225s
	iters: 200, epoch: 20 | loss: 0.4588589
	speed: 0.3241s/iter; left time: 5395.3810s
Epoch: 20 cost time: 73.23491835594177
Epoch: 20, Steps: 208 | Train Loss: 0.321 Vali Loss: 9.787 Vali Acc: 0.084 Test Loss: 9.787 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2169642
	speed: 0.8192s/iter; left time: 13550.1133s
	iters: 200, epoch: 21 | loss: 0.0495470
	speed: 0.3369s/iter; left time: 5539.2042s
Epoch: 21 cost time: 70.33570456504822
Epoch: 21, Steps: 208 | Train Loss: 0.324 Vali Loss: 9.773 Vali Acc: 0.091 Test Loss: 9.773 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0417755
	speed: 0.8428s/iter; left time: 13765.3723s
	iters: 200, epoch: 22 | loss: 0.1523822
	speed: 0.3764s/iter; left time: 6110.5742s
Epoch: 22 cost time: 74.29365229606628
Epoch: 22, Steps: 208 | Train Loss: 0.274 Vali Loss: 9.978 Vali Acc: 0.085 Test Loss: 9.978 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.4014398
	speed: 0.8709s/iter; left time: 14043.4295s
	iters: 200, epoch: 23 | loss: 0.4624267
	speed: 0.3590s/iter; left time: 5753.5183s
Epoch: 23 cost time: 77.10436749458313
Epoch: 23, Steps: 208 | Train Loss: 0.264 Vali Loss: 10.031 Vali Acc: 0.090 Test Loss: 10.031 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.3501645
	speed: 0.8831s/iter; left time: 14056.9817s
	iters: 200, epoch: 24 | loss: 0.0360038
	speed: 0.3420s/iter; left time: 5409.3150s
Epoch: 24 cost time: 74.91340517997742
Epoch: 24, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.103 Vali Acc: 0.086 Test Loss: 10.103 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09126155681479273
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9775627
	speed: 0.3603s/iter; left time: 7457.6842s
	iters: 200, epoch: 1 | loss: 3.4124703
	speed: 0.3265s/iter; left time: 6727.1474s
Epoch: 1 cost time: 71.84247469902039
Epoch: 1, Steps: 208 | Train Loss: 3.628 Vali Loss: 5.287 Vali Acc: 0.029 Test Loss: 5.287 Test Acc: 0.029
Validation loss decreased (inf --> -0.028876).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3048506
	speed: 0.8192s/iter; left time: 16788.3007s
	iters: 200, epoch: 2 | loss: 3.5068212
	speed: 0.3632s/iter; left time: 7406.1959s
Epoch: 2 cost time: 72.36104583740234
Epoch: 2, Steps: 208 | Train Loss: 3.253 Vali Loss: 5.606 Vali Acc: 0.040 Test Loss: 5.606 Test Acc: 0.040
Validation loss decreased (-0.028876 --> -0.040206).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8287480
	speed: 0.8848s/iter; left time: 17947.4127s
	iters: 200, epoch: 3 | loss: 3.0788550
	speed: 0.3521s/iter; left time: 7106.8838s
Epoch: 3 cost time: 77.67377257347107
Epoch: 3, Steps: 208 | Train Loss: 3.119 Vali Loss: 5.757 Vali Acc: 0.041 Test Loss: 5.757 Test Acc: 0.041
Validation loss decreased (-0.040206 --> -0.040801).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4627144
	speed: 0.8175s/iter; left time: 16413.6389s
	iters: 200, epoch: 4 | loss: 2.8466306
	speed: 0.3449s/iter; left time: 6890.3381s
Epoch: 4 cost time: 74.36185097694397
Epoch: 4, Steps: 208 | Train Loss: 2.988 Vali Loss: 5.933 Vali Acc: 0.047 Test Loss: 5.933 Test Acc: 0.047
Validation loss decreased (-0.040801 --> -0.047361).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.1036916
	speed: 0.8411s/iter; left time: 16711.2232s
	iters: 200, epoch: 5 | loss: 3.6364639
	speed: 0.3413s/iter; left time: 6746.3285s
Epoch: 5 cost time: 73.00046706199646
Epoch: 5, Steps: 208 | Train Loss: 2.826 Vali Loss: 5.722 Vali Acc: 0.050 Test Loss: 5.722 Test Acc: 0.050
Validation loss decreased (-0.047361 --> -0.050047).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8867091
	speed: 0.8452s/iter; left time: 16617.1149s
	iters: 200, epoch: 6 | loss: 3.4303973
	speed: 0.3578s/iter; left time: 6998.2955s
Epoch: 6 cost time: 76.48388862609863
Epoch: 6, Steps: 208 | Train Loss: 2.574 Vali Loss: 5.890 Vali Acc: 0.051 Test Loss: 5.890 Test Acc: 0.051
Validation loss decreased (-0.050047 --> -0.050642).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2216678
	speed: 0.8215s/iter; left time: 15980.1488s
	iters: 200, epoch: 7 | loss: 2.8688672
	speed: 0.3557s/iter; left time: 6883.1643s
Epoch: 7 cost time: 73.24714517593384
Epoch: 7, Steps: 208 | Train Loss: 2.261 Vali Loss: 5.951 Vali Acc: 0.064 Test Loss: 5.951 Test Acc: 0.064
Validation loss decreased (-0.050642 --> -0.063466).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3012599
	speed: 0.8274s/iter; left time: 15923.7604s
	iters: 200, epoch: 8 | loss: 2.7118700
	speed: 0.3511s/iter; left time: 6721.4700s
Epoch: 8 cost time: 72.25763607025146
Epoch: 8, Steps: 208 | Train Loss: 1.983 Vali Loss: 6.149 Vali Acc: 0.063 Test Loss: 6.149 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3506000
	speed: 0.8365s/iter; left time: 15924.2111s
	iters: 200, epoch: 9 | loss: 2.0642316
	speed: 0.3492s/iter; left time: 6611.9872s
Epoch: 9 cost time: 72.2013909816742
Epoch: 9, Steps: 208 | Train Loss: 1.700 Vali Loss: 6.318 Vali Acc: 0.075 Test Loss: 6.318 Test Acc: 0.075
Validation loss decreased (-0.063466 --> -0.074795).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5252573
	speed: 0.8355s/iter; left time: 15731.7505s
	iters: 200, epoch: 10 | loss: 1.4271318
	speed: 0.3694s/iter; left time: 6919.1397s
Epoch: 10 cost time: 74.96316599845886
Epoch: 10, Steps: 208 | Train Loss: 1.461 Vali Loss: 6.851 Vali Acc: 0.081 Test Loss: 6.851 Test Acc: 0.081
Validation loss decreased (-0.074795 --> -0.080456).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7370254
	speed: 0.8601s/iter; left time: 16016.7966s
	iters: 200, epoch: 11 | loss: 1.1971625
	speed: 0.3652s/iter; left time: 6764.1981s
Epoch: 11 cost time: 76.12807726860046
Epoch: 11, Steps: 208 | Train Loss: 1.265 Vali Loss: 6.959 Vali Acc: 0.079 Test Loss: 6.959 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7643422
	speed: 0.8444s/iter; left time: 15547.1087s
	iters: 200, epoch: 12 | loss: 1.5186977
	speed: 0.3489s/iter; left time: 6389.6223s
Epoch: 12 cost time: 72.45599150657654
Epoch: 12, Steps: 208 | Train Loss: 1.124 Vali Loss: 7.074 Vali Acc: 0.074 Test Loss: 7.074 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4854523
	speed: 0.8270s/iter; left time: 15055.0442s
	iters: 200, epoch: 13 | loss: 1.2220128
	speed: 0.3359s/iter; left time: 6081.1323s
Epoch: 13 cost time: 71.44006419181824
Epoch: 13, Steps: 208 | Train Loss: 0.946 Vali Loss: 7.760 Vali Acc: 0.078 Test Loss: 7.760 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8904769
	speed: 0.8006s/iter; left time: 14407.6354s
	iters: 200, epoch: 14 | loss: 0.9597686
	speed: 0.3398s/iter; left time: 6081.4011s
Epoch: 14 cost time: 70.97733449935913
Epoch: 14, Steps: 208 | Train Loss: 0.826 Vali Loss: 8.224 Vali Acc: 0.089 Test Loss: 8.224 Test Acc: 0.089
Validation loss decreased (-0.080456 --> -0.089390).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4228402
	speed: 0.8235s/iter; left time: 14649.9923s
	iters: 200, epoch: 15 | loss: 0.5765553
	speed: 0.3462s/iter; left time: 6124.7243s
Epoch: 15 cost time: 71.95976161956787
Epoch: 15, Steps: 208 | Train Loss: 0.774 Vali Loss: 8.109 Vali Acc: 0.083 Test Loss: 8.109 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1143078
	speed: 0.8198s/iter; left time: 14413.0796s
	iters: 200, epoch: 16 | loss: 0.6489032
	speed: 0.3479s/iter; left time: 6082.2300s
Epoch: 16 cost time: 71.66586017608643
Epoch: 16, Steps: 208 | Train Loss: 0.665 Vali Loss: 8.762 Vali Acc: 0.076 Test Loss: 8.762 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4255272
	speed: 0.8388s/iter; left time: 14571.7625s
	iters: 200, epoch: 17 | loss: 0.6729195
	speed: 0.3427s/iter; left time: 5919.5957s
Epoch: 17 cost time: 71.82182383537292
Epoch: 17, Steps: 208 | Train Loss: 0.641 Vali Loss: 9.029 Vali Acc: 0.078 Test Loss: 9.029 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2975734
	speed: 0.8723s/iter; left time: 14973.2408s
	iters: 200, epoch: 18 | loss: 0.7632739
	speed: 0.3491s/iter; left time: 5957.0589s
Epoch: 18 cost time: 73.5684745311737
Epoch: 18, Steps: 208 | Train Loss: 0.595 Vali Loss: 8.953 Vali Acc: 0.083 Test Loss: 8.953 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6242341
	speed: 0.8655s/iter; left time: 14677.0595s
	iters: 200, epoch: 19 | loss: 0.4818647
	speed: 0.3525s/iter; left time: 5942.8922s
Epoch: 19 cost time: 73.93167042732239
Epoch: 19, Steps: 208 | Train Loss: 0.515 Vali Loss: 9.736 Vali Acc: 0.087 Test Loss: 9.736 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3405573
	speed: 0.8430s/iter; left time: 14119.2006s
	iters: 200, epoch: 20 | loss: 0.5367105
	speed: 0.3288s/iter; left time: 5474.0560s
Epoch: 20 cost time: 71.44449877738953
Epoch: 20, Steps: 208 | Train Loss: 0.487 Vali Loss: 9.662 Vali Acc: 0.089 Test Loss: 9.662 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.7977638
	speed: 0.8732s/iter; left time: 14443.1104s
	iters: 200, epoch: 21 | loss: 0.4510196
	speed: 0.3380s/iter; left time: 5557.8022s
Epoch: 21 cost time: 73.58578300476074
Epoch: 21, Steps: 208 | Train Loss: 0.448 Vali Loss: 9.937 Vali Acc: 0.081 Test Loss: 9.937 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2348391
	speed: 0.8933s/iter; left time: 14590.8951s
	iters: 200, epoch: 22 | loss: 0.4161926
	speed: 0.3564s/iter; left time: 5784.7101s
Epoch: 22 cost time: 75.93041658401489
Epoch: 22, Steps: 208 | Train Loss: 0.433 Vali Loss: 10.052 Vali Acc: 0.082 Test Loss: 10.052 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.6362331
	speed: 0.8109s/iter; left time: 13075.0532s
	iters: 200, epoch: 23 | loss: 0.5541595
	speed: 0.3417s/iter; left time: 5475.0762s
Epoch: 23 cost time: 72.46062636375427
Epoch: 23, Steps: 208 | Train Loss: 0.392 Vali Loss: 10.031 Vali Acc: 0.083 Test Loss: 10.031 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.7988313
	speed: 0.8052s/iter; left time: 12816.3435s
	iters: 200, epoch: 24 | loss: 0.3038326
	speed: 0.3398s/iter; left time: 5374.6344s
Epoch: 24 cost time: 72.59410214424133
Epoch: 24, Steps: 208 | Train Loss: 0.369 Vali Loss: 10.285 Vali Acc: 0.086 Test Loss: 10.285 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08947211452430659
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8324704
	speed: 0.4008s/iter; left time: 8296.9717s
	iters: 200, epoch: 1 | loss: 3.5119383
	speed: 0.3730s/iter; left time: 7684.0866s
Epoch: 1 cost time: 80.36094760894775
Epoch: 1, Steps: 208 | Train Loss: 3.633 Vali Loss: 4.615 Vali Acc: 0.031 Test Loss: 4.615 Test Acc: 0.031
Validation loss decreased (inf --> -0.030971).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2875657
	speed: 0.8850s/iter; left time: 18136.7987s
	iters: 200, epoch: 2 | loss: 3.2930532
	speed: 0.3597s/iter; left time: 7335.7958s
Epoch: 2 cost time: 77.50652742385864
Epoch: 2, Steps: 208 | Train Loss: 3.187 Vali Loss: 5.161 Vali Acc: 0.042 Test Loss: 5.161 Test Acc: 0.042
Validation loss decreased (-0.030971 --> -0.041702).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7417300
	speed: 0.8836s/iter; left time: 17922.9400s
	iters: 200, epoch: 3 | loss: 3.0040307
	speed: 0.3553s/iter; left time: 7171.4383s
Epoch: 3 cost time: 76.06972217559814
Epoch: 3, Steps: 208 | Train Loss: 2.951 Vali Loss: 5.428 Vali Acc: 0.045 Test Loss: 5.428 Test Acc: 0.045
Validation loss decreased (-0.041702 --> -0.044980).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2263491
	speed: 0.8775s/iter; left time: 17617.1360s
	iters: 200, epoch: 4 | loss: 2.5144985
	speed: 0.3757s/iter; left time: 7505.8092s
Epoch: 4 cost time: 77.50469994544983
Epoch: 4, Steps: 208 | Train Loss: 2.731 Vali Loss: 5.864 Vali Acc: 0.050 Test Loss: 5.864 Test Acc: 0.050
Validation loss decreased (-0.044980 --> -0.050344).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4707658
	speed: 0.8963s/iter; left time: 17808.6254s
	iters: 200, epoch: 5 | loss: 3.3253000
	speed: 0.3794s/iter; left time: 7499.7779s
Epoch: 5 cost time: 80.14135217666626
Epoch: 5, Steps: 208 | Train Loss: 2.484 Vali Loss: 5.771 Vali Acc: 0.051 Test Loss: 5.771 Test Acc: 0.051
Validation loss decreased (-0.050344 --> -0.051240).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9923855
	speed: 0.9169s/iter; left time: 18027.0392s
	iters: 200, epoch: 6 | loss: 3.2025173
	speed: 0.3852s/iter; left time: 7534.5275s
Epoch: 6 cost time: 80.91105699539185
Epoch: 6, Steps: 208 | Train Loss: 2.201 Vali Loss: 6.308 Vali Acc: 0.058 Test Loss: 6.308 Test Acc: 0.058
Validation loss decreased (-0.051240 --> -0.057796).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0109112
	speed: 0.9184s/iter; left time: 17864.8039s
	iters: 200, epoch: 7 | loss: 2.6694553
	speed: 0.3883s/iter; left time: 7514.8965s
Epoch: 7 cost time: 82.44422769546509
Epoch: 7, Steps: 208 | Train Loss: 1.845 Vali Loss: 6.617 Vali Acc: 0.062 Test Loss: 6.617 Test Acc: 0.062
Validation loss decreased (-0.057796 --> -0.061670).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7496560
	speed: 0.9202s/iter; left time: 17709.2768s
	iters: 200, epoch: 8 | loss: 2.0355270
	speed: 0.3795s/iter; left time: 7265.4196s
Epoch: 8 cost time: 80.66578483581543
Epoch: 8, Steps: 208 | Train Loss: 1.516 Vali Loss: 6.879 Vali Acc: 0.063 Test Loss: 6.879 Test Acc: 0.063
Validation loss decreased (-0.061670 --> -0.062860).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9795856
	speed: 0.9342s/iter; left time: 17783.6039s
	iters: 200, epoch: 9 | loss: 1.7436018
	speed: 0.3925s/iter; left time: 7432.9768s
Epoch: 9 cost time: 82.3845067024231
Epoch: 9, Steps: 208 | Train Loss: 1.276 Vali Loss: 7.147 Vali Acc: 0.072 Test Loss: 7.147 Test Acc: 0.072
Validation loss decreased (-0.062860 --> -0.072103).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2283111
	speed: 0.9123s/iter; left time: 17177.4117s
	iters: 200, epoch: 10 | loss: 1.0612057
	speed: 0.3739s/iter; left time: 7002.3598s
Epoch: 10 cost time: 79.39249014854431
Epoch: 10, Steps: 208 | Train Loss: 1.052 Vali Loss: 7.676 Vali Acc: 0.067 Test Loss: 7.676 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1617392
	speed: 0.8499s/iter; left time: 15825.3587s
	iters: 200, epoch: 11 | loss: 0.3191827
	speed: 0.3733s/iter; left time: 6913.5628s
Epoch: 11 cost time: 76.45662021636963
Epoch: 11, Steps: 208 | Train Loss: 0.902 Vali Loss: 7.892 Vali Acc: 0.073 Test Loss: 7.892 Test Acc: 0.073
Validation loss decreased (-0.072103 --> -0.073288).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8035960
	speed: 0.9327s/iter; left time: 17174.0298s
	iters: 200, epoch: 12 | loss: 0.9585719
	speed: 0.3905s/iter; left time: 7151.9966s
Epoch: 12 cost time: 80.91333174705505
Epoch: 12, Steps: 208 | Train Loss: 0.777 Vali Loss: 8.222 Vali Acc: 0.069 Test Loss: 8.222 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4162333
	speed: 0.9103s/iter; left time: 16572.3348s
	iters: 200, epoch: 13 | loss: 1.7029626
	speed: 0.3700s/iter; left time: 6699.1820s
Epoch: 13 cost time: 78.39606714248657
Epoch: 13, Steps: 208 | Train Loss: 0.701 Vali Loss: 8.565 Vali Acc: 0.076 Test Loss: 8.565 Test Acc: 0.076
Validation loss decreased (-0.073288 --> -0.075966).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8757802
	speed: 0.8853s/iter; left time: 15932.2696s
	iters: 200, epoch: 14 | loss: 0.5017496
	speed: 0.3870s/iter; left time: 6925.4196s
Epoch: 14 cost time: 80.52792716026306
Epoch: 14, Steps: 208 | Train Loss: 0.622 Vali Loss: 8.906 Vali Acc: 0.080 Test Loss: 8.906 Test Acc: 0.080
Validation loss decreased (-0.075966 --> -0.079541).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0483832
	speed: 0.9034s/iter; left time: 16070.4497s
	iters: 200, epoch: 15 | loss: 1.0826716
	speed: 0.3672s/iter; left time: 6495.1625s
Epoch: 15 cost time: 77.95572924613953
Epoch: 15, Steps: 208 | Train Loss: 0.557 Vali Loss: 9.068 Vali Acc: 0.070 Test Loss: 9.068 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3365858
	speed: 0.9166s/iter; left time: 16115.0921s
	iters: 200, epoch: 16 | loss: 0.0487139
	speed: 0.3946s/iter; left time: 6897.8376s
Epoch: 16 cost time: 82.37628269195557
Epoch: 16, Steps: 208 | Train Loss: 0.493 Vali Loss: 9.360 Vali Acc: 0.075 Test Loss: 9.360 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2303672
	speed: 0.8843s/iter; left time: 15363.7253s
	iters: 200, epoch: 17 | loss: 0.3865521
	speed: 0.3674s/iter; left time: 6345.5976s
Epoch: 17 cost time: 77.600426197052
Epoch: 17, Steps: 208 | Train Loss: 0.442 Vali Loss: 9.450 Vali Acc: 0.076 Test Loss: 9.450 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.9925370
	speed: 0.9392s/iter; left time: 16121.7218s
	iters: 200, epoch: 18 | loss: 0.6564937
	speed: 0.3743s/iter; left time: 6386.7409s
Epoch: 18 cost time: 80.40354537963867
Epoch: 18, Steps: 208 | Train Loss: 0.412 Vali Loss: 9.729 Vali Acc: 0.082 Test Loss: 9.729 Test Acc: 0.082
Validation loss decreased (-0.079541 --> -0.082217).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6495888
	speed: 0.9655s/iter; left time: 16371.2540s
	iters: 200, epoch: 19 | loss: 0.6770374
	speed: 0.3640s/iter; left time: 6136.1583s
Epoch: 19 cost time: 81.09542894363403
Epoch: 19, Steps: 208 | Train Loss: 0.379 Vali Loss: 10.197 Vali Acc: 0.078 Test Loss: 10.197 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.5922330
	speed: 0.9475s/iter; left time: 15869.9847s
	iters: 200, epoch: 20 | loss: 0.1878382
	speed: 0.3958s/iter; left time: 6589.1161s
Epoch: 20 cost time: 82.62748908996582
Epoch: 20, Steps: 208 | Train Loss: 0.368 Vali Loss: 10.067 Vali Acc: 0.080 Test Loss: 10.067 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2758467
	speed: 0.9460s/iter; left time: 15648.3282s
	iters: 200, epoch: 21 | loss: 0.2003931
	speed: 0.3794s/iter; left time: 6236.9630s
Epoch: 21 cost time: 81.06468725204468
Epoch: 21, Steps: 208 | Train Loss: 0.334 Vali Loss: 10.633 Vali Acc: 0.081 Test Loss: 10.633 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0894433
	speed: 0.9053s/iter; left time: 14785.6264s
	iters: 200, epoch: 22 | loss: 0.2594676
	speed: 0.3586s/iter; left time: 5820.7381s
Epoch: 22 cost time: 77.61208939552307
Epoch: 22, Steps: 208 | Train Loss: 0.278 Vali Loss: 10.795 Vali Acc: 0.088 Test Loss: 10.795 Test Acc: 0.088
Validation loss decreased (-0.082217 --> -0.088171).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.4172533
	speed: 0.8971s/iter; left time: 14465.0853s
	iters: 200, epoch: 23 | loss: 0.6672449
	speed: 0.3512s/iter; left time: 5628.2951s
Epoch: 23 cost time: 75.51770067214966
Epoch: 23, Steps: 208 | Train Loss: 0.297 Vali Loss: 10.626 Vali Acc: 0.089 Test Loss: 10.626 Test Acc: 0.089
Validation loss decreased (-0.088171 --> -0.088769).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.3254881
	speed: 0.9147s/iter; left time: 14558.8619s
	iters: 200, epoch: 24 | loss: 0.0429985
	speed: 0.3510s/iter; left time: 5551.0638s
Epoch: 24 cost time: 76.20954251289368
Epoch: 24, Steps: 208 | Train Loss: 0.296 Vali Loss: 10.730 Vali Acc: 0.086 Test Loss: 10.730 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0676285
	speed: 0.8922s/iter; left time: 14014.9319s
	iters: 200, epoch: 25 | loss: 0.3785650
	speed: 0.3599s/iter; left time: 5618.4538s
Epoch: 25 cost time: 76.18107652664185
Epoch: 25, Steps: 208 | Train Loss: 0.267 Vali Loss: 11.021 Vali Acc: 0.088 Test Loss: 11.021 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.2717680
	speed: 0.8975s/iter; left time: 13912.3983s
	iters: 200, epoch: 26 | loss: 0.9716682
	speed: 0.3664s/iter; left time: 5643.5588s
Epoch: 26 cost time: 77.61126661300659
Epoch: 26, Steps: 208 | Train Loss: 0.247 Vali Loss: 11.176 Vali Acc: 0.095 Test Loss: 11.176 Test Acc: 0.095
Validation loss decreased (-0.088769 --> -0.095325).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0138979
	speed: 0.9322s/iter; left time: 14256.3876s
	iters: 200, epoch: 27 | loss: 0.0757687
	speed: 0.3667s/iter; left time: 5570.7232s
Epoch: 27 cost time: 79.47845840454102
Epoch: 27, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.116 Vali Acc: 0.084 Test Loss: 11.116 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.1779238
	speed: 0.9317s/iter; left time: 14055.3662s
	iters: 200, epoch: 28 | loss: 0.3590896
	speed: 0.3543s/iter; left time: 5309.2024s
Epoch: 28 cost time: 77.92880201339722
Epoch: 28, Steps: 208 | Train Loss: 0.250 Vali Loss: 11.491 Vali Acc: 0.090 Test Loss: 11.491 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.1092211
	speed: 0.9369s/iter; left time: 13937.9238s
	iters: 200, epoch: 29 | loss: 0.1306585
	speed: 0.3647s/iter; left time: 5389.0659s
Epoch: 29 cost time: 79.13164377212524
Epoch: 29, Steps: 208 | Train Loss: 0.213 Vali Loss: 11.294 Vali Acc: 0.091 Test Loss: 11.294 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0762431
	speed: 0.9517s/iter; left time: 13960.8459s
	iters: 200, epoch: 30 | loss: 0.4331795
	speed: 0.3618s/iter; left time: 5270.8676s
Epoch: 30 cost time: 79.60248255729675
Epoch: 30, Steps: 208 | Train Loss: 0.210 Vali Loss: 11.454 Vali Acc: 0.092 Test Loss: 11.454 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.6364388
	speed: 0.9413s/iter; left time: 13611.9965s
	iters: 200, epoch: 31 | loss: 0.6105806
	speed: 0.3852s/iter; left time: 5531.9787s
Epoch: 31 cost time: 81.8786473274231
Epoch: 31, Steps: 208 | Train Loss: 0.198 Vali Loss: 11.451 Vali Acc: 0.091 Test Loss: 11.451 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.3094461
	speed: 0.9314s/iter; left time: 13275.5085s
	iters: 200, epoch: 32 | loss: 0.1506655
	speed: 0.3730s/iter; left time: 5278.7763s
Epoch: 32 cost time: 79.17356085777283
Epoch: 32, Steps: 208 | Train Loss: 0.190 Vali Loss: 11.696 Vali Acc: 0.090 Test Loss: 11.696 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.1216298
	speed: 0.9058s/iter; left time: 12722.3369s
	iters: 200, epoch: 33 | loss: 0.0935116
	speed: 0.3487s/iter; left time: 4863.1444s
Epoch: 33 cost time: 76.26055932044983
Epoch: 33, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.388 Vali Acc: 0.089 Test Loss: 11.388 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.4341352
	speed: 0.9273s/iter; left time: 12831.5128s
	iters: 200, epoch: 34 | loss: 0.2494285
	speed: 0.3617s/iter; left time: 4969.1307s
Epoch: 34 cost time: 78.17638850212097
Epoch: 34, Steps: 208 | Train Loss: 0.183 Vali Loss: 11.596 Vali Acc: 0.085 Test Loss: 11.596 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0951541
	speed: 0.9001s/iter; left time: 12267.8457s
	iters: 200, epoch: 35 | loss: 0.1051629
	speed: 0.3587s/iter; left time: 4852.7595s
Epoch: 35 cost time: 77.58255910873413
Epoch: 35, Steps: 208 | Train Loss: 0.169 Vali Loss: 11.833 Vali Acc: 0.093 Test Loss: 11.833 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.1340632
	speed: 0.8781s/iter; left time: 11785.6280s
	iters: 200, epoch: 36 | loss: 0.1076567
	speed: 0.3583s/iter; left time: 4772.9208s
Epoch: 36 cost time: 76.73103499412537
Epoch: 36, Steps: 208 | Train Loss: 0.153 Vali Loss: 11.711 Vali Acc: 0.092 Test Loss: 11.711 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09543692215926036
model parameter : 809063
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3841560
	speed: 0.3780s/iter; left time: 7824.8396s
	iters: 200, epoch: 1 | loss: 3.6959779
	speed: 0.3951s/iter; left time: 8139.4796s
Epoch: 1 cost time: 80.61077833175659
Epoch: 1, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.641 Vali Acc: 0.074 Test Loss: 3.641 Test Acc: 0.074
Validation loss decreased (inf --> -0.073629).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9522228
	speed: 0.8728s/iter; left time: 17885.9477s
	iters: 200, epoch: 2 | loss: 3.1558654
	speed: 0.3700s/iter; left time: 7546.1831s
Epoch: 2 cost time: 76.04049682617188
Epoch: 2, Steps: 208 | Train Loss: 3.196 Vali Loss: 3.834 Vali Acc: 0.073 Test Loss: 3.834 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4038544
	speed: 0.9520s/iter; left time: 19311.9924s
	iters: 200, epoch: 3 | loss: 2.6121278
	speed: 0.3980s/iter; left time: 8032.8772s
Epoch: 3 cost time: 84.21336388587952
Epoch: 3, Steps: 208 | Train Loss: 2.658 Vali Loss: 4.435 Vali Acc: 0.091 Test Loss: 4.435 Test Acc: 0.091
Validation loss decreased (-0.073629 --> -0.090919).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9079872
	speed: 0.9457s/iter; left time: 18987.3297s
	iters: 200, epoch: 4 | loss: 2.8236961
	speed: 0.4013s/iter; left time: 8017.6685s
Epoch: 4 cost time: 83.11053729057312
Epoch: 4, Steps: 208 | Train Loss: 2.117 Vali Loss: 4.565 Vali Acc: 0.091 Test Loss: 4.565 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3443179
	speed: 0.9530s/iter; left time: 18934.8365s
	iters: 200, epoch: 5 | loss: 2.5112443
	speed: 0.4104s/iter; left time: 8113.6446s
Epoch: 5 cost time: 83.35429501533508
Epoch: 5, Steps: 208 | Train Loss: 1.565 Vali Loss: 5.147 Vali Acc: 0.091 Test Loss: 5.147 Test Acc: 0.091
Validation loss decreased (-0.090919 --> -0.091210).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8465720
	speed: 0.9480s/iter; left time: 18638.6610s
	iters: 200, epoch: 6 | loss: 0.9286062
	speed: 0.3822s/iter; left time: 7477.0051s
Epoch: 6 cost time: 82.26038384437561
Epoch: 6, Steps: 208 | Train Loss: 1.180 Vali Loss: 5.762 Vali Acc: 0.092 Test Loss: 5.762 Test Acc: 0.092
Validation loss decreased (-0.091210 --> -0.091502).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4787020
	speed: 0.9062s/iter; left time: 17627.3810s
	iters: 200, epoch: 7 | loss: 1.2963126
	speed: 0.3710s/iter; left time: 7180.6283s
Epoch: 7 cost time: 78.04297423362732
Epoch: 7, Steps: 208 | Train Loss: 0.821 Vali Loss: 6.273 Vali Acc: 0.092 Test Loss: 6.273 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4190637
	speed: 0.9199s/iter; left time: 17703.3606s
	iters: 200, epoch: 8 | loss: 0.7412942
	speed: 0.3924s/iter; left time: 7511.6131s
Epoch: 8 cost time: 80.21949410438538
Epoch: 8, Steps: 208 | Train Loss: 0.662 Vali Loss: 7.063 Vali Acc: 0.092 Test Loss: 7.063 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7389758
	speed: 0.9236s/iter; left time: 17581.9176s
	iters: 200, epoch: 9 | loss: 0.2387973
	speed: 0.3948s/iter; left time: 7475.6220s
Epoch: 9 cost time: 84.07226705551147
Epoch: 9, Steps: 208 | Train Loss: 0.538 Vali Loss: 7.617 Vali Acc: 0.093 Test Loss: 7.617 Test Acc: 0.093
Validation loss decreased (-0.091502 --> -0.092975).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2050634
	speed: 0.9310s/iter; left time: 17529.1436s
	iters: 200, epoch: 10 | loss: 0.3510567
	speed: 0.3637s/iter; left time: 6812.4137s
Epoch: 10 cost time: 79.4322726726532
Epoch: 10, Steps: 208 | Train Loss: 0.453 Vali Loss: 8.081 Vali Acc: 0.095 Test Loss: 8.081 Test Acc: 0.095
Validation loss decreased (-0.092975 --> -0.094461).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5226600
	speed: 0.9445s/iter; left time: 17587.1681s
	iters: 200, epoch: 11 | loss: 0.3102845
	speed: 0.3942s/iter; left time: 7301.5309s
Epoch: 11 cost time: 81.01050877571106
Epoch: 11, Steps: 208 | Train Loss: 0.393 Vali Loss: 8.587 Vali Acc: 0.090 Test Loss: 8.587 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0971343
	speed: 0.9423s/iter; left time: 17350.1229s
	iters: 200, epoch: 12 | loss: 0.1059571
	speed: 0.4124s/iter; left time: 7551.7876s
Epoch: 12 cost time: 85.94785904884338
Epoch: 12, Steps: 208 | Train Loss: 0.312 Vali Loss: 8.966 Vali Acc: 0.098 Test Loss: 8.966 Test Acc: 0.098
Validation loss decreased (-0.094461 --> -0.098031).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1923011
	speed: 0.9244s/iter; left time: 16828.0671s
	iters: 200, epoch: 13 | loss: 0.0723990
	speed: 0.3782s/iter; left time: 6847.6864s
Epoch: 13 cost time: 79.99817824363708
Epoch: 13, Steps: 208 | Train Loss: 0.274 Vali Loss: 9.349 Vali Acc: 0.086 Test Loss: 9.349 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1069252
	speed: 0.9492s/iter; left time: 17082.8468s
	iters: 200, epoch: 14 | loss: 0.1798602
	speed: 0.3925s/iter; left time: 7025.0912s
Epoch: 14 cost time: 81.10329937934875
Epoch: 14, Steps: 208 | Train Loss: 0.266 Vali Loss: 9.585 Vali Acc: 0.095 Test Loss: 9.585 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1007791
	speed: 0.9549s/iter; left time: 16986.9000s
	iters: 200, epoch: 15 | loss: 0.2547578
	speed: 0.3753s/iter; left time: 6637.8849s
Epoch: 15 cost time: 78.6615560054779
Epoch: 15, Steps: 208 | Train Loss: 0.249 Vali Loss: 9.708 Vali Acc: 0.094 Test Loss: 9.708 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0364659
	speed: 0.8625s/iter; left time: 15162.7931s
	iters: 200, epoch: 16 | loss: 0.2831516
	speed: 0.3997s/iter; left time: 6987.1358s
Epoch: 16 cost time: 80.5735354423523
Epoch: 16, Steps: 208 | Train Loss: 0.222 Vali Loss: 9.968 Vali Acc: 0.100 Test Loss: 9.968 Test Acc: 0.100
Validation loss decreased (-0.098031 --> -0.099811).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0784589
	speed: 0.9330s/iter; left time: 16208.6122s
	iters: 200, epoch: 17 | loss: 0.1892242
	speed: 0.3587s/iter; left time: 6195.3804s
Epoch: 17 cost time: 79.13694071769714
Epoch: 17, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.046 Vali Acc: 0.092 Test Loss: 10.046 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1020456
	speed: 0.8956s/iter; left time: 15373.6122s
	iters: 200, epoch: 18 | loss: 0.3431296
	speed: 0.3581s/iter; left time: 6111.1548s
Epoch: 18 cost time: 75.56970119476318
Epoch: 18, Steps: 208 | Train Loss: 0.173 Vali Loss: 10.471 Vali Acc: 0.097 Test Loss: 10.471 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1062203
	speed: 0.8311s/iter; left time: 14093.0678s
	iters: 200, epoch: 19 | loss: 0.0209979
	speed: 0.3575s/iter; left time: 6026.3839s
Epoch: 19 cost time: 74.65320420265198
Epoch: 19, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.818 Vali Acc: 0.089 Test Loss: 10.818 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1488791
	speed: 0.8736s/iter; left time: 14632.5161s
	iters: 200, epoch: 20 | loss: 1.0413404
	speed: 0.3487s/iter; left time: 5806.0714s
Epoch: 20 cost time: 76.03915977478027
Epoch: 20, Steps: 208 | Train Loss: 0.162 Vali Loss: 10.898 Vali Acc: 0.086 Test Loss: 10.898 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6062963
	speed: 0.9234s/iter; left time: 15274.0676s
	iters: 200, epoch: 21 | loss: 0.2395385
	speed: 0.3813s/iter; left time: 6269.3322s
Epoch: 21 cost time: 78.991366147995
Epoch: 21, Steps: 208 | Train Loss: 0.152 Vali Loss: 11.618 Vali Acc: 0.091 Test Loss: 11.618 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0349016
	speed: 0.8842s/iter; left time: 14442.1767s
	iters: 200, epoch: 22 | loss: 0.0166267
	speed: 0.3658s/iter; left time: 5937.7348s
Epoch: 22 cost time: 76.28679990768433
Epoch: 22, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.494 Vali Acc: 0.098 Test Loss: 11.494 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0833190
	speed: 0.8838s/iter; left time: 14251.3027s
	iters: 200, epoch: 23 | loss: 0.0077480
	speed: 0.3732s/iter; left time: 5981.2355s
Epoch: 23 cost time: 78.6723952293396
Epoch: 23, Steps: 208 | Train Loss: 0.157 Vali Loss: 11.684 Vali Acc: 0.089 Test Loss: 11.684 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0143992
	speed: 0.9096s/iter; left time: 14478.0924s
	iters: 200, epoch: 24 | loss: 0.1022210
	speed: 0.3842s/iter; left time: 6076.4876s
Epoch: 24 cost time: 79.88048887252808
Epoch: 24, Steps: 208 | Train Loss: 0.123 Vali Loss: 11.424 Vali Acc: 0.091 Test Loss: 11.424 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.3281042
	speed: 0.9171s/iter; left time: 14407.2782s
	iters: 200, epoch: 25 | loss: 0.0318843
	speed: 0.3706s/iter; left time: 5785.2174s
Epoch: 25 cost time: 78.48462843894958
Epoch: 25, Steps: 208 | Train Loss: 0.130 Vali Loss: 11.591 Vali Acc: 0.095 Test Loss: 11.591 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0238863
	speed: 0.9090s/iter; left time: 14090.3744s
	iters: 200, epoch: 26 | loss: 0.1202527
	speed: 0.3667s/iter; left time: 5647.9874s
Epoch: 26 cost time: 78.61232399940491
Epoch: 26, Steps: 208 | Train Loss: 0.149 Vali Loss: 12.317 Vali Acc: 0.091 Test Loss: 12.317 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09991052788547569
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3226271
	speed: 0.3930s/iter; left time: 8136.2191s
	iters: 200, epoch: 1 | loss: 3.7269576
	speed: 0.3784s/iter; left time: 7794.7081s
Epoch: 1 cost time: 80.81999945640564
Epoch: 1, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.645 Vali Acc: 0.078 Test Loss: 3.645 Test Acc: 0.078
Validation loss decreased (inf --> -0.078103).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7397697
	speed: 0.9335s/iter; left time: 19130.1242s
	iters: 200, epoch: 2 | loss: 3.1986208
	speed: 0.3952s/iter; left time: 8058.3641s
Epoch: 2 cost time: 82.49892950057983
Epoch: 2, Steps: 208 | Train Loss: 3.194 Vali Loss: 3.830 Vali Acc: 0.076 Test Loss: 3.830 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4860036
	speed: 0.9250s/iter; left time: 18762.9773s
	iters: 200, epoch: 3 | loss: 2.6910651
	speed: 0.3893s/iter; left time: 7857.0303s
Epoch: 3 cost time: 80.41927218437195
Epoch: 3, Steps: 208 | Train Loss: 2.656 Vali Loss: 4.413 Vali Acc: 0.089 Test Loss: 4.413 Test Acc: 0.089
Validation loss decreased (-0.078103 --> -0.089428).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6637924
	speed: 0.9086s/iter; left time: 18241.9726s
	iters: 200, epoch: 4 | loss: 2.5018425
	speed: 0.3716s/iter; left time: 7422.9984s
Epoch: 4 cost time: 78.94006323814392
Epoch: 4, Steps: 208 | Train Loss: 2.092 Vali Loss: 4.529 Vali Acc: 0.088 Test Loss: 4.529 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1756756
	speed: 0.9146s/iter; left time: 18171.6045s
	iters: 200, epoch: 5 | loss: 2.2507219
	speed: 0.3914s/iter; left time: 7737.7327s
Epoch: 5 cost time: 81.83145713806152
Epoch: 5, Steps: 208 | Train Loss: 1.550 Vali Loss: 5.167 Vali Acc: 0.096 Test Loss: 5.167 Test Acc: 0.096
Validation loss decreased (-0.089428 --> -0.096280).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7366095
	speed: 0.9188s/iter; left time: 18065.2796s
	iters: 200, epoch: 6 | loss: 0.8240787
	speed: 0.3948s/iter; left time: 7723.5154s
Epoch: 6 cost time: 79.85175776481628
Epoch: 6, Steps: 208 | Train Loss: 1.146 Vali Loss: 5.752 Vali Acc: 0.094 Test Loss: 5.752 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8053883
	speed: 0.9068s/iter; left time: 17639.8079s
	iters: 200, epoch: 7 | loss: 1.3231633
	speed: 0.3712s/iter; left time: 7183.2487s
Epoch: 7 cost time: 80.18392753601074
Epoch: 7, Steps: 208 | Train Loss: 0.828 Vali Loss: 6.363 Vali Acc: 0.097 Test Loss: 6.363 Test Acc: 0.097
Validation loss decreased (-0.096280 --> -0.096566).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5230668
	speed: 0.9095s/iter; left time: 17503.2162s
	iters: 200, epoch: 8 | loss: 1.0966398
	speed: 0.4070s/iter; left time: 7791.1024s
Epoch: 8 cost time: 82.79036664962769
Epoch: 8, Steps: 208 | Train Loss: 0.675 Vali Loss: 7.063 Vali Acc: 0.089 Test Loss: 7.063 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1435046
	speed: 0.9280s/iter; left time: 17666.4556s
	iters: 200, epoch: 9 | loss: 0.7179696
	speed: 0.4093s/iter; left time: 7750.1581s
Epoch: 9 cost time: 83.36448931694031
Epoch: 9, Steps: 208 | Train Loss: 0.533 Vali Loss: 7.453 Vali Acc: 0.096 Test Loss: 7.453 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3503220
	speed: 0.9412s/iter; left time: 17722.7601s
	iters: 200, epoch: 10 | loss: 0.2182975
	speed: 0.3791s/iter; left time: 7099.5311s
Epoch: 10 cost time: 82.49285507202148
Epoch: 10, Steps: 208 | Train Loss: 0.438 Vali Loss: 7.951 Vali Acc: 0.092 Test Loss: 7.951 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5193668
	speed: 0.9663s/iter; left time: 17994.0326s
	iters: 200, epoch: 11 | loss: 0.4823761
	speed: 0.4158s/iter; left time: 7700.5476s
Epoch: 11 cost time: 84.20202255249023
Epoch: 11, Steps: 208 | Train Loss: 0.356 Vali Loss: 8.435 Vali Acc: 0.087 Test Loss: 8.435 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0828500
	speed: 0.9269s/iter; left time: 17066.9742s
	iters: 200, epoch: 12 | loss: 0.1005277
	speed: 0.4013s/iter; left time: 7349.1353s
Epoch: 12 cost time: 82.23097705841064
Epoch: 12, Steps: 208 | Train Loss: 0.324 Vali Loss: 9.021 Vali Acc: 0.090 Test Loss: 9.021 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0312748
	speed: 0.9717s/iter; left time: 17690.3307s
	iters: 200, epoch: 13 | loss: 0.4233827
	speed: 0.3978s/iter; left time: 7202.1155s
Epoch: 13 cost time: 84.11066603660583
Epoch: 13, Steps: 208 | Train Loss: 0.301 Vali Loss: 9.160 Vali Acc: 0.093 Test Loss: 9.160 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1333296
	speed: 0.9756s/iter; left time: 17557.9304s
	iters: 200, epoch: 14 | loss: 0.6098882
	speed: 0.3996s/iter; left time: 7151.6193s
Epoch: 14 cost time: 83.29778671264648
Epoch: 14, Steps: 208 | Train Loss: 0.273 Vali Loss: 9.500 Vali Acc: 0.090 Test Loss: 9.500 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2096515
	speed: 0.9290s/iter; left time: 16525.7589s
	iters: 200, epoch: 15 | loss: 0.3211454
	speed: 0.4015s/iter; left time: 7101.9901s
Epoch: 15 cost time: 84.89968132972717
Epoch: 15, Steps: 208 | Train Loss: 0.273 Vali Loss: 10.179 Vali Acc: 0.092 Test Loss: 10.179 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1534610
	speed: 0.9814s/iter; left time: 17253.5038s
	iters: 200, epoch: 16 | loss: 0.1438340
	speed: 0.4011s/iter; left time: 7011.0014s
Epoch: 16 cost time: 84.59924983978271
Epoch: 16, Steps: 208 | Train Loss: 0.238 Vali Loss: 10.320 Vali Acc: 0.090 Test Loss: 10.320 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1843195
	speed: 0.9410s/iter; left time: 16348.3024s
	iters: 200, epoch: 17 | loss: 0.0991100
	speed: 0.3997s/iter; left time: 6904.8517s
Epoch: 17 cost time: 82.35137438774109
Epoch: 17, Steps: 208 | Train Loss: 0.230 Vali Loss: 10.379 Vali Acc: 0.092 Test Loss: 10.379 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09662988368625113
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.1763086
	speed: 0.3975s/iter; left time: 8227.6935s
	iters: 200, epoch: 1 | loss: 3.6352210
	speed: 0.3833s/iter; left time: 7897.0082s
Epoch: 1 cost time: 81.56926131248474
Epoch: 1, Steps: 208 | Train Loss: 3.721 Vali Loss: 3.611 Vali Acc: 0.078 Test Loss: 3.611 Test Acc: 0.078
Validation loss decreased (inf --> -0.078103).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7916293
	speed: 0.9228s/iter; left time: 18910.9679s
	iters: 200, epoch: 2 | loss: 3.1053054
	speed: 0.3767s/iter; left time: 7682.5399s
Epoch: 2 cost time: 80.67764019966125
Epoch: 2, Steps: 208 | Train Loss: 3.203 Vali Loss: 3.778 Vali Acc: 0.084 Test Loss: 3.778 Test Acc: 0.084
Validation loss decreased (-0.078103 --> -0.084364).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2194388
	speed: 0.8264s/iter; left time: 16763.2901s
	iters: 200, epoch: 3 | loss: 2.5471776
	speed: 0.3515s/iter; left time: 7094.7755s
Epoch: 3 cost time: 72.92736625671387
Epoch: 3, Steps: 208 | Train Loss: 2.659 Vali Loss: 4.270 Vali Acc: 0.095 Test Loss: 4.270 Test Acc: 0.095
Validation loss decreased (-0.084364 --> -0.094798).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7926948
	speed: 0.8481s/iter; left time: 17027.4342s
	iters: 200, epoch: 4 | loss: 2.4101999
	speed: 0.3454s/iter; left time: 6899.5613s
Epoch: 4 cost time: 73.05485773086548
Epoch: 4, Steps: 208 | Train Loss: 2.074 Vali Loss: 4.501 Vali Acc: 0.094 Test Loss: 4.501 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2304735
	speed: 0.8826s/iter; left time: 17536.2427s
	iters: 200, epoch: 5 | loss: 2.1941204
	speed: 0.3886s/iter; left time: 7682.2847s
Epoch: 5 cost time: 80.07707142829895
Epoch: 5, Steps: 208 | Train Loss: 1.535 Vali Loss: 5.148 Vali Acc: 0.096 Test Loss: 5.148 Test Acc: 0.096
Validation loss decreased (-0.094798 --> -0.096280).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8003758
	speed: 0.9110s/iter; left time: 17910.4847s
	iters: 200, epoch: 6 | loss: 0.8015571
	speed: 0.3957s/iter; left time: 7740.9700s
Epoch: 6 cost time: 80.00795841217041
Epoch: 6, Steps: 208 | Train Loss: 1.139 Vali Loss: 5.601 Vali Acc: 0.093 Test Loss: 5.601 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5132726
	speed: 0.8898s/iter; left time: 17308.7969s
	iters: 200, epoch: 7 | loss: 1.0864725
	speed: 0.3838s/iter; left time: 7426.7880s
Epoch: 7 cost time: 80.09658646583557
Epoch: 7, Steps: 208 | Train Loss: 0.806 Vali Loss: 6.242 Vali Acc: 0.102 Test Loss: 6.242 Test Acc: 0.102
Validation loss decreased (-0.096280 --> -0.101936).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5306823
	speed: 0.9075s/iter; left time: 17464.8702s
	iters: 200, epoch: 8 | loss: 0.4212032
	speed: 0.3921s/iter; left time: 7506.9506s
Epoch: 8 cost time: 80.88500046730042
Epoch: 8, Steps: 208 | Train Loss: 0.631 Vali Loss: 6.986 Vali Acc: 0.095 Test Loss: 6.986 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2875474
	speed: 0.9563s/iter; left time: 18205.3553s
	iters: 200, epoch: 9 | loss: 0.3976844
	speed: 0.3812s/iter; left time: 7218.8835s
Epoch: 9 cost time: 80.8348503112793
Epoch: 9, Steps: 208 | Train Loss: 0.543 Vali Loss: 7.627 Vali Acc: 0.101 Test Loss: 7.627 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1665728
	speed: 0.9173s/iter; left time: 17271.7654s
	iters: 200, epoch: 10 | loss: 0.4819576
	speed: 0.3794s/iter; left time: 7105.7229s
Epoch: 10 cost time: 79.7290723323822
Epoch: 10, Steps: 208 | Train Loss: 0.462 Vali Loss: 8.074 Vali Acc: 0.092 Test Loss: 8.074 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3923412
	speed: 0.8788s/iter; left time: 16364.5455s
	iters: 200, epoch: 11 | loss: 0.3094816
	speed: 0.3599s/iter; left time: 6666.3881s
Epoch: 11 cost time: 74.56855988502502
Epoch: 11, Steps: 208 | Train Loss: 0.386 Vali Loss: 8.579 Vali Acc: 0.097 Test Loss: 8.579 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0744238
	speed: 0.8965s/iter; left time: 16507.4663s
	iters: 200, epoch: 12 | loss: 0.4437104
	speed: 0.3710s/iter; left time: 6793.4467s
Epoch: 12 cost time: 77.57475256919861
Epoch: 12, Steps: 208 | Train Loss: 0.336 Vali Loss: 8.663 Vali Acc: 0.098 Test Loss: 8.663 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2549388
	speed: 0.8733s/iter; left time: 15898.5154s
	iters: 200, epoch: 13 | loss: 0.3864628
	speed: 0.3783s/iter; left time: 6849.0651s
Epoch: 13 cost time: 76.92900490760803
Epoch: 13, Steps: 208 | Train Loss: 0.283 Vali Loss: 9.319 Vali Acc: 0.093 Test Loss: 9.319 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2807228
	speed: 0.8645s/iter; left time: 15558.2985s
	iters: 200, epoch: 14 | loss: 0.0698002
	speed: 0.3622s/iter; left time: 6482.6321s
Epoch: 14 cost time: 75.6123275756836
Epoch: 14, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.566 Vali Acc: 0.090 Test Loss: 9.566 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0059031
	speed: 0.8923s/iter; left time: 15873.7579s
	iters: 200, epoch: 15 | loss: 0.1185941
	speed: 0.3685s/iter; left time: 6518.0063s
Epoch: 15 cost time: 76.9050977230072
Epoch: 15, Steps: 208 | Train Loss: 0.222 Vali Loss: 10.301 Vali Acc: 0.086 Test Loss: 10.301 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0080285
	speed: 0.9526s/iter; left time: 16748.3640s
	iters: 200, epoch: 16 | loss: 0.1411676
	speed: 0.3760s/iter; left time: 6572.5850s
Epoch: 16 cost time: 80.33255648612976
Epoch: 16, Steps: 208 | Train Loss: 0.240 Vali Loss: 10.028 Vali Acc: 0.086 Test Loss: 10.028 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.4342199
	speed: 0.9193s/iter; left time: 15971.8130s
	iters: 200, epoch: 17 | loss: 0.0190581
	speed: 0.3700s/iter; left time: 6391.3525s
Epoch: 17 cost time: 79.18663263320923
Epoch: 17, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.387 Vali Acc: 0.087 Test Loss: 10.387 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10199821055770951
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3582332
	speed: 0.4107s/iter; left time: 8501.7471s
	iters: 200, epoch: 1 | loss: 3.7621508
	speed: 0.3699s/iter; left time: 7620.5027s
Epoch: 1 cost time: 81.28776264190674
Epoch: 1, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.610 Vali Acc: 0.079 Test Loss: 3.610 Test Acc: 0.079
Validation loss decreased (inf --> -0.078998).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0188966
	speed: 0.8977s/iter; left time: 18397.5291s
	iters: 200, epoch: 2 | loss: 3.1451440
	speed: 0.3743s/iter; left time: 7633.0836s
Epoch: 2 cost time: 78.85672855377197
Epoch: 2, Steps: 208 | Train Loss: 3.189 Vali Loss: 3.755 Vali Acc: 0.088 Test Loss: 3.755 Test Acc: 0.088
Validation loss decreased (-0.078998 --> -0.087645).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4366872
	speed: 0.9207s/iter; left time: 18676.5114s
	iters: 200, epoch: 3 | loss: 2.7215009
	speed: 0.3872s/iter; left time: 7814.9867s
Epoch: 3 cost time: 80.43888592720032
Epoch: 3, Steps: 208 | Train Loss: 2.646 Vali Loss: 4.258 Vali Acc: 0.101 Test Loss: 4.258 Test Acc: 0.101
Validation loss decreased (-0.087645 --> -0.100763).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3998922
	speed: 0.9073s/iter; left time: 18215.5999s
	iters: 200, epoch: 4 | loss: 2.5716760
	speed: 0.3587s/iter; left time: 7165.4616s
Epoch: 4 cost time: 77.63388586044312
Epoch: 4, Steps: 208 | Train Loss: 2.063 Vali Loss: 4.530 Vali Acc: 0.099 Test Loss: 4.530 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6155610
	speed: 0.8739s/iter; left time: 17363.9322s
	iters: 200, epoch: 5 | loss: 2.0384293
	speed: 0.3800s/iter; left time: 7511.5096s
Epoch: 5 cost time: 76.08150720596313
Epoch: 5, Steps: 208 | Train Loss: 1.547 Vali Loss: 5.132 Vali Acc: 0.093 Test Loss: 5.132 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1768489
	speed: 0.9413s/iter; left time: 18507.2800s
	iters: 200, epoch: 6 | loss: 0.8706726
	speed: 0.3596s/iter; left time: 7033.8222s
Epoch: 6 cost time: 78.56307554244995
Epoch: 6, Steps: 208 | Train Loss: 1.161 Vali Loss: 5.458 Vali Acc: 0.104 Test Loss: 5.458 Test Acc: 0.104
Validation loss decreased (-0.100763 --> -0.104330).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3518191
	speed: 0.9055s/iter; left time: 17614.5586s
	iters: 200, epoch: 7 | loss: 1.2806637
	speed: 0.3650s/iter; left time: 7063.8401s
Epoch: 7 cost time: 77.79903936386108
Epoch: 7, Steps: 208 | Train Loss: 0.823 Vali Loss: 6.222 Vali Acc: 0.104 Test Loss: 6.222 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2767832
	speed: 0.8647s/iter; left time: 16641.7214s
	iters: 200, epoch: 8 | loss: 0.7932020
	speed: 0.3386s/iter; left time: 6482.4759s
Epoch: 8 cost time: 73.79979348182678
Epoch: 8, Steps: 208 | Train Loss: 0.653 Vali Loss: 6.732 Vali Acc: 0.099 Test Loss: 6.732 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4881702
	speed: 0.8846s/iter; left time: 16840.2941s
	iters: 200, epoch: 9 | loss: 0.4324930
	speed: 0.3862s/iter; left time: 7314.3685s
Epoch: 9 cost time: 79.89848685264587
Epoch: 9, Steps: 208 | Train Loss: 0.543 Vali Loss: 7.431 Vali Acc: 0.102 Test Loss: 7.431 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4940409
	speed: 0.9288s/iter; left time: 17487.4671s
	iters: 200, epoch: 10 | loss: 0.4932404
	speed: 0.3873s/iter; left time: 7253.2820s
Epoch: 10 cost time: 80.51409578323364
Epoch: 10, Steps: 208 | Train Loss: 0.452 Vali Loss: 7.780 Vali Acc: 0.105 Test Loss: 7.780 Test Acc: 0.105
Validation loss decreased (-0.104330 --> -0.104903).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1444227
	speed: 0.9198s/iter; left time: 17128.2466s
	iters: 200, epoch: 11 | loss: 0.3233566
	speed: 0.3984s/iter; left time: 7378.7147s
Epoch: 11 cost time: 80.57753729820251
Epoch: 11, Steps: 208 | Train Loss: 0.381 Vali Loss: 8.326 Vali Acc: 0.093 Test Loss: 8.326 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2692188
	speed: 0.9342s/iter; left time: 17200.8058s
	iters: 200, epoch: 12 | loss: 0.4330701
	speed: 0.3920s/iter; left time: 7179.3139s
Epoch: 12 cost time: 81.32434749603271
Epoch: 12, Steps: 208 | Train Loss: 0.348 Vali Loss: 8.605 Vali Acc: 0.100 Test Loss: 8.605 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5409568
	speed: 0.9789s/iter; left time: 17820.2169s
	iters: 200, epoch: 13 | loss: 0.2454633
	speed: 0.3789s/iter; left time: 6860.2073s
Epoch: 13 cost time: 81.729731798172
Epoch: 13, Steps: 208 | Train Loss: 0.253 Vali Loss: 9.234 Vali Acc: 0.093 Test Loss: 9.234 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0303177
	speed: 0.9400s/iter; left time: 16916.4003s
	iters: 200, epoch: 14 | loss: 0.1459483
	speed: 0.3751s/iter; left time: 6713.9063s
Epoch: 14 cost time: 77.42765879631042
Epoch: 14, Steps: 208 | Train Loss: 0.234 Vali Loss: 9.259 Vali Acc: 0.091 Test Loss: 9.259 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1759821
	speed: 0.8891s/iter; left time: 15815.3723s
	iters: 200, epoch: 15 | loss: 0.0269310
	speed: 0.3596s/iter; left time: 6360.5002s
Epoch: 15 cost time: 76.60069251060486
Epoch: 15, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.775 Vali Acc: 0.092 Test Loss: 9.775 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1975715
	speed: 0.9226s/iter; left time: 16220.6727s
	iters: 200, epoch: 16 | loss: 0.1478539
	speed: 0.3882s/iter; left time: 6785.7646s
Epoch: 16 cost time: 80.6239595413208
Epoch: 16, Steps: 208 | Train Loss: 0.212 Vali Loss: 10.078 Vali Acc: 0.095 Test Loss: 10.078 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0860917
	speed: 0.9165s/iter; left time: 15922.8445s
	iters: 200, epoch: 17 | loss: 0.1575078
	speed: 0.3784s/iter; left time: 6536.2154s
Epoch: 17 cost time: 79.3168671131134
Epoch: 17, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.706 Vali Acc: 0.099 Test Loss: 10.706 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0696400
	speed: 0.9039s/iter; left time: 15514.5858s
	iters: 200, epoch: 18 | loss: 0.0611158
	speed: 0.3574s/iter; left time: 6099.8343s
Epoch: 18 cost time: 75.59529662132263
Epoch: 18, Steps: 208 | Train Loss: 0.206 Vali Loss: 10.211 Vali Acc: 0.095 Test Loss: 10.211 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7141662
	speed: 0.9097s/iter; left time: 15426.0389s
	iters: 200, epoch: 19 | loss: 0.1477332
	speed: 0.3910s/iter; left time: 6591.7846s
Epoch: 19 cost time: 80.1640350818634
Epoch: 19, Steps: 208 | Train Loss: 0.197 Vali Loss: 10.679 Vali Acc: 0.092 Test Loss: 10.679 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1495564
	speed: 0.9706s/iter; left time: 16257.1563s
	iters: 200, epoch: 20 | loss: 0.7670994
	speed: 0.4044s/iter; left time: 6732.9951s
Epoch: 20 cost time: 84.34000539779663
Epoch: 20, Steps: 208 | Train Loss: 0.167 Vali Loss: 11.012 Vali Acc: 0.094 Test Loss: 11.012 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1049806143751864
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5348203
	speed: 0.4031s/iter; left time: 8344.2431s
	iters: 200, epoch: 1 | loss: 3.7030249
	speed: 0.4000s/iter; left time: 8240.3207s
Epoch: 1 cost time: 83.94515109062195
Epoch: 1, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.739 Vali Acc: 0.058 Test Loss: 3.739 Test Acc: 0.058
Validation loss decreased (inf --> -0.058418).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7275863
	speed: 0.9211s/iter; left time: 18875.7879s
	iters: 200, epoch: 2 | loss: 3.2608120
	speed: 0.4014s/iter; left time: 8186.6859s
Epoch: 2 cost time: 81.36053681373596
Epoch: 2, Steps: 208 | Train Loss: 3.171 Vali Loss: 4.094 Vali Acc: 0.078 Test Loss: 4.094 Test Acc: 0.078
Validation loss decreased (-0.058418 --> -0.078098).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7052846
	speed: 0.9380s/iter; left time: 19028.0048s
	iters: 200, epoch: 3 | loss: 3.0091159
	speed: 0.3830s/iter; left time: 7730.1485s
Epoch: 3 cost time: 80.75373458862305
Epoch: 3, Steps: 208 | Train Loss: 2.667 Vali Loss: 4.413 Vali Acc: 0.089 Test Loss: 4.413 Test Acc: 0.089
Validation loss decreased (-0.078098 --> -0.088533).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9718711
	speed: 0.9541s/iter; left time: 19155.2749s
	iters: 200, epoch: 4 | loss: 1.7848634
	speed: 0.3699s/iter; left time: 7390.2797s
Epoch: 4 cost time: 79.54101777076721
Epoch: 4, Steps: 208 | Train Loss: 2.136 Vali Loss: 4.916 Vali Acc: 0.084 Test Loss: 4.916 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0783422
	speed: 0.8909s/iter; left time: 17700.7196s
	iters: 200, epoch: 5 | loss: 1.8352735
	speed: 0.3773s/iter; left time: 7459.1855s
Epoch: 5 cost time: 78.0391013622284
Epoch: 5, Steps: 208 | Train Loss: 1.625 Vali Loss: 5.214 Vali Acc: 0.088 Test Loss: 5.214 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1591531
	speed: 0.9239s/iter; left time: 18163.9498s
	iters: 200, epoch: 6 | loss: 0.5763370
	speed: 0.3702s/iter; left time: 7242.0390s
Epoch: 6 cost time: 80.04874920845032
Epoch: 6, Steps: 208 | Train Loss: 1.240 Vali Loss: 5.621 Vali Acc: 0.089 Test Loss: 5.621 Test Acc: 0.089
Validation loss decreased (-0.088533 --> -0.088819).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5482731
	speed: 0.8726s/iter; left time: 16975.2962s
	iters: 200, epoch: 7 | loss: 1.0790904
	speed: 0.3514s/iter; left time: 6800.4837s
Epoch: 7 cost time: 75.07173728942871
Epoch: 7, Steps: 208 | Train Loss: 0.918 Vali Loss: 6.324 Vali Acc: 0.083 Test Loss: 6.324 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4743993
	speed: 0.8585s/iter; left time: 16522.7191s
	iters: 200, epoch: 8 | loss: 0.4915696
	speed: 0.3406s/iter; left time: 6520.6927s
Epoch: 8 cost time: 73.6281054019928
Epoch: 8, Steps: 208 | Train Loss: 0.744 Vali Loss: 6.694 Vali Acc: 0.093 Test Loss: 6.694 Test Acc: 0.093
Validation loss decreased (-0.088819 --> -0.092686).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3240633
	speed: 0.8169s/iter; left time: 15552.2546s
	iters: 200, epoch: 9 | loss: 0.8002430
	speed: 0.3569s/iter; left time: 6758.0889s
Epoch: 9 cost time: 73.12112808227539
Epoch: 9, Steps: 208 | Train Loss: 0.622 Vali Loss: 7.085 Vali Acc: 0.097 Test Loss: 7.085 Test Acc: 0.097
Validation loss decreased (-0.092686 --> -0.096559).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2234276
	speed: 0.8381s/iter; left time: 15780.5550s
	iters: 200, epoch: 10 | loss: 0.7895051
	speed: 0.3491s/iter; left time: 6537.6479s
Epoch: 10 cost time: 72.66852712631226
Epoch: 10, Steps: 208 | Train Loss: 0.514 Vali Loss: 7.713 Vali Acc: 0.083 Test Loss: 7.713 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4273440
	speed: 0.8268s/iter; left time: 15396.1006s
	iters: 200, epoch: 11 | loss: 0.2069908
	speed: 0.3409s/iter; left time: 6313.0804s
Epoch: 11 cost time: 71.93792057037354
Epoch: 11, Steps: 208 | Train Loss: 0.443 Vali Loss: 8.070 Vali Acc: 0.095 Test Loss: 8.070 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3574072
	speed: 0.8357s/iter; left time: 15388.6465s
	iters: 200, epoch: 12 | loss: 0.3711118
	speed: 0.3504s/iter; left time: 6416.4554s
Epoch: 12 cost time: 73.54906010627747
Epoch: 12, Steps: 208 | Train Loss: 0.350 Vali Loss: 8.446 Vali Acc: 0.102 Test Loss: 8.446 Test Acc: 0.102
Validation loss decreased (-0.096559 --> -0.101616).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0247720
	speed: 0.8406s/iter; left time: 15302.2519s
	iters: 200, epoch: 13 | loss: 0.2701570
	speed: 0.3503s/iter; left time: 6342.0531s
Epoch: 13 cost time: 74.61785173416138
Epoch: 13, Steps: 208 | Train Loss: 0.307 Vali Loss: 9.174 Vali Acc: 0.102 Test Loss: 9.174 Test Acc: 0.102
Validation loss decreased (-0.101616 --> -0.102205).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4285550
	speed: 0.8052s/iter; left time: 14490.9956s
	iters: 200, epoch: 14 | loss: 0.0730599
	speed: 0.3324s/iter; left time: 5948.4095s
Epoch: 14 cost time: 70.08564567565918
Epoch: 14, Steps: 208 | Train Loss: 0.316 Vali Loss: 9.328 Vali Acc: 0.101 Test Loss: 9.328 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2164618
	speed: 0.7915s/iter; left time: 14080.5530s
	iters: 200, epoch: 15 | loss: 0.1787066
	speed: 0.3323s/iter; left time: 5878.6391s
Epoch: 15 cost time: 69.26695227622986
Epoch: 15, Steps: 208 | Train Loss: 0.230 Vali Loss: 9.415 Vali Acc: 0.102 Test Loss: 9.415 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0363368
	speed: 0.7818s/iter; left time: 13745.6407s
	iters: 200, epoch: 16 | loss: 0.5586507
	speed: 0.3256s/iter; left time: 5691.9585s
Epoch: 16 cost time: 68.82384204864502
Epoch: 16, Steps: 208 | Train Loss: 0.290 Vali Loss: 9.725 Vali Acc: 0.108 Test Loss: 9.725 Test Acc: 0.108
Validation loss decreased (-0.102205 --> -0.107866).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1030512
	speed: 0.8372s/iter; left time: 14543.9979s
	iters: 200, epoch: 17 | loss: 0.1030653
	speed: 0.3454s/iter; left time: 5966.1176s
Epoch: 17 cost time: 71.87096548080444
Epoch: 17, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.884 Vali Acc: 0.093 Test Loss: 9.884 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0367908
	speed: 0.8199s/iter; left time: 14074.3900s
	iters: 200, epoch: 18 | loss: 0.4728131
	speed: 0.3318s/iter; left time: 5661.7694s
Epoch: 18 cost time: 70.30682349205017
Epoch: 18, Steps: 208 | Train Loss: 0.192 Vali Loss: 10.025 Vali Acc: 0.099 Test Loss: 10.025 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0104480
	speed: 0.7975s/iter; left time: 13522.4911s
	iters: 200, epoch: 19 | loss: 0.0176363
	speed: 0.3265s/iter; left time: 5504.1222s
Epoch: 19 cost time: 70.34537816047668
Epoch: 19, Steps: 208 | Train Loss: 0.183 Vali Loss: 10.832 Vali Acc: 0.086 Test Loss: 10.832 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2191033
	speed: 0.8127s/iter; left time: 13611.9805s
	iters: 200, epoch: 20 | loss: 0.5818462
	speed: 0.3399s/iter; left time: 5658.7887s
Epoch: 20 cost time: 72.12067246437073
Epoch: 20, Steps: 208 | Train Loss: 0.168 Vali Loss: 10.646 Vali Acc: 0.096 Test Loss: 10.646 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.0636115
	speed: 0.8486s/iter; left time: 14036.1710s
	iters: 200, epoch: 21 | loss: 0.1389098
	speed: 0.3590s/iter; left time: 5902.8162s
Epoch: 21 cost time: 74.65775346755981
Epoch: 21, Steps: 208 | Train Loss: 0.169 Vali Loss: 11.423 Vali Acc: 0.095 Test Loss: 11.423 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.1018367
	speed: 0.8505s/iter; left time: 13891.2221s
	iters: 200, epoch: 22 | loss: 0.1209587
	speed: 0.3349s/iter; left time: 5435.9392s
Epoch: 22 cost time: 72.36594700813293
Epoch: 22, Steps: 208 | Train Loss: 0.147 Vali Loss: 10.829 Vali Acc: 0.100 Test Loss: 10.829 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1667468
	speed: 0.8020s/iter; left time: 12931.7906s
	iters: 200, epoch: 23 | loss: 0.0290839
	speed: 0.3420s/iter; left time: 5480.6100s
Epoch: 23 cost time: 71.19900918006897
Epoch: 23, Steps: 208 | Train Loss: 0.150 Vali Loss: 11.213 Vali Acc: 0.097 Test Loss: 11.213 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0110051
	speed: 0.8186s/iter; left time: 13029.8141s
	iters: 200, epoch: 24 | loss: 0.3678324
	speed: 0.3603s/iter; left time: 5699.3019s
Epoch: 24 cost time: 74.68732762336731
Epoch: 24, Steps: 208 | Train Loss: 0.132 Vali Loss: 11.015 Vali Acc: 0.095 Test Loss: 11.015 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.4290583
	speed: 0.8513s/iter; left time: 13372.7207s
	iters: 200, epoch: 25 | loss: 0.3290294
	speed: 0.3508s/iter; left time: 5476.2603s
Epoch: 25 cost time: 73.63258600234985
Epoch: 25, Steps: 208 | Train Loss: 0.141 Vali Loss: 11.481 Vali Acc: 0.095 Test Loss: 11.481 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0059133
	speed: 0.8040s/iter; left time: 12462.2397s
	iters: 200, epoch: 26 | loss: 0.0671193
	speed: 0.3245s/iter; left time: 4997.5928s
Epoch: 26 cost time: 69.76628947257996
Epoch: 26, Steps: 208 | Train Loss: 0.122 Vali Loss: 11.726 Vali Acc: 0.095 Test Loss: 11.726 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10796301819266328
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4709749
	speed: 0.3512s/iter; left time: 7271.0790s
	iters: 200, epoch: 1 | loss: 3.5926650
	speed: 0.3301s/iter; left time: 6801.1617s
Epoch: 1 cost time: 70.88555264472961
Epoch: 1, Steps: 208 | Train Loss: 3.626 Vali Loss: 3.812 Vali Acc: 0.064 Test Loss: 3.812 Test Acc: 0.064
Validation loss decreased (inf --> -0.063785).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6840556
	speed: 0.7989s/iter; left time: 16371.1103s
	iters: 200, epoch: 2 | loss: 3.1927192
	speed: 0.3348s/iter; left time: 6828.5450s
Epoch: 2 cost time: 70.39536690711975
Epoch: 2, Steps: 208 | Train Loss: 3.090 Vali Loss: 4.356 Vali Acc: 0.081 Test Loss: 4.356 Test Acc: 0.081
Validation loss decreased (-0.063785 --> -0.080481).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3402801
	speed: 0.8195s/iter; left time: 16623.0763s
	iters: 200, epoch: 3 | loss: 2.6970675
	speed: 0.3413s/iter; left time: 6890.1155s
Epoch: 3 cost time: 71.638498544693
Epoch: 3, Steps: 208 | Train Loss: 2.678 Vali Loss: 4.452 Vali Acc: 0.096 Test Loss: 4.452 Test Acc: 0.096
Validation loss decreased (-0.080481 --> -0.095989).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9527988
	speed: 0.8014s/iter; left time: 16089.9064s
	iters: 200, epoch: 4 | loss: 2.5747383
	speed: 0.3417s/iter; left time: 6825.7650s
Epoch: 4 cost time: 71.14721488952637
Epoch: 4, Steps: 208 | Train Loss: 2.265 Vali Loss: 5.082 Vali Acc: 0.086 Test Loss: 5.082 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3510704
	speed: 0.8402s/iter; left time: 16693.2489s
	iters: 200, epoch: 5 | loss: 1.6427850
	speed: 0.3565s/iter; left time: 7046.9291s
Epoch: 5 cost time: 74.95395112037659
Epoch: 5, Steps: 208 | Train Loss: 1.834 Vali Loss: 5.234 Vali Acc: 0.097 Test Loss: 5.234 Test Acc: 0.097
Validation loss decreased (-0.095989 --> -0.097174).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4818008
	speed: 0.8351s/iter; left time: 16419.8333s
	iters: 200, epoch: 6 | loss: 1.0357468
	speed: 0.3458s/iter; left time: 6764.3658s
Epoch: 6 cost time: 73.15990924835205
Epoch: 6, Steps: 208 | Train Loss: 1.465 Vali Loss: 5.843 Vali Acc: 0.097 Test Loss: 5.843 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8013910
	speed: 0.8002s/iter; left time: 15566.8555s
	iters: 200, epoch: 7 | loss: 1.7618573
	speed: 0.3349s/iter; left time: 6481.6033s
Epoch: 7 cost time: 69.2578353881836
Epoch: 7, Steps: 208 | Train Loss: 1.116 Vali Loss: 6.282 Vali Acc: 0.090 Test Loss: 6.282 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1913847
	speed: 0.7854s/iter; left time: 15114.8875s
	iters: 200, epoch: 8 | loss: 0.5524954
	speed: 0.3209s/iter; left time: 6143.3604s
Epoch: 8 cost time: 67.32247948646545
Epoch: 8, Steps: 208 | Train Loss: 0.908 Vali Loss: 6.727 Vali Acc: 0.102 Test Loss: 6.727 Test Acc: 0.102
Validation loss decreased (-0.097174 --> -0.101633).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2000664
	speed: 0.8215s/iter; left time: 15639.3622s
	iters: 200, epoch: 9 | loss: 0.8451858
	speed: 0.3393s/iter; left time: 6425.5773s
Epoch: 9 cost time: 71.72871685028076
Epoch: 9, Steps: 208 | Train Loss: 0.765 Vali Loss: 7.198 Vali Acc: 0.099 Test Loss: 7.198 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9735280
	speed: 0.8133s/iter; left time: 15312.9414s
	iters: 200, epoch: 10 | loss: 0.5685354
	speed: 0.3339s/iter; left time: 6253.6619s
Epoch: 10 cost time: 70.70576310157776
Epoch: 10, Steps: 208 | Train Loss: 0.642 Vali Loss: 7.876 Vali Acc: 0.084 Test Loss: 7.876 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3573790
	speed: 0.7991s/iter; left time: 14880.8992s
	iters: 200, epoch: 11 | loss: 0.1730007
	speed: 0.3474s/iter; left time: 6434.5340s
Epoch: 11 cost time: 71.64981007575989
Epoch: 11, Steps: 208 | Train Loss: 0.581 Vali Loss: 8.098 Vali Acc: 0.086 Test Loss: 8.098 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3138115
	speed: 0.7975s/iter; left time: 14683.9040s
	iters: 200, epoch: 12 | loss: 0.2687654
	speed: 0.3336s/iter; left time: 6109.9238s
Epoch: 12 cost time: 69.61468982696533
Epoch: 12, Steps: 208 | Train Loss: 0.506 Vali Loss: 8.307 Vali Acc: 0.099 Test Loss: 8.307 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0394156
	speed: 0.7837s/iter; left time: 14266.7235s
	iters: 200, epoch: 13 | loss: 0.2448481
	speed: 0.3263s/iter; left time: 5908.2588s
Epoch: 13 cost time: 68.48545718193054
Epoch: 13, Steps: 208 | Train Loss: 0.433 Vali Loss: 8.603 Vali Acc: 0.089 Test Loss: 8.603 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5827485
	speed: 0.7909s/iter; left time: 14233.3125s
	iters: 200, epoch: 14 | loss: 0.8410803
	speed: 0.3182s/iter; left time: 5694.0296s
Epoch: 14 cost time: 67.34245657920837
Epoch: 14, Steps: 208 | Train Loss: 0.457 Vali Loss: 8.631 Vali Acc: 0.094 Test Loss: 8.631 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3015795
	speed: 0.7949s/iter; left time: 14140.7504s
	iters: 200, epoch: 15 | loss: 0.6278287
	speed: 0.3289s/iter; left time: 5818.7497s
Epoch: 15 cost time: 69.0701322555542
Epoch: 15, Steps: 208 | Train Loss: 0.362 Vali Loss: 8.839 Vali Acc: 0.086 Test Loss: 8.839 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0079432
	speed: 0.7932s/iter; left time: 13946.0899s
	iters: 200, epoch: 16 | loss: 0.4442242
	speed: 0.3357s/iter; left time: 5867.5155s
Epoch: 16 cost time: 70.18845653533936
Epoch: 16, Steps: 208 | Train Loss: 0.334 Vali Loss: 9.018 Vali Acc: 0.092 Test Loss: 9.018 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.6059651
	speed: 0.8315s/iter; left time: 14445.9046s
	iters: 200, epoch: 17 | loss: 0.2618314
	speed: 0.3445s/iter; left time: 5950.7512s
Epoch: 17 cost time: 72.5912218093872
Epoch: 17, Steps: 208 | Train Loss: 0.266 Vali Loss: 9.372 Vali Acc: 0.094 Test Loss: 9.372 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3250392
	speed: 0.7869s/iter; left time: 13507.6611s
	iters: 200, epoch: 18 | loss: 0.1108811
	speed: 0.3201s/iter; left time: 5462.8514s
Epoch: 18 cost time: 67.93920135498047
Epoch: 18, Steps: 208 | Train Loss: 0.265 Vali Loss: 9.499 Vali Acc: 0.093 Test Loss: 9.499 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10169997017596183
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4741101
	speed: 0.3574s/iter; left time: 7399.4905s
	iters: 200, epoch: 1 | loss: 3.5945561
	speed: 0.3389s/iter; left time: 6980.7321s
Epoch: 1 cost time: 72.54307723045349
Epoch: 1, Steps: 208 | Train Loss: 3.629 Vali Loss: 3.842 Vali Acc: 0.058 Test Loss: 3.842 Test Acc: 0.058
Validation loss decreased (inf --> -0.058417).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5176241
	speed: 0.7948s/iter; left time: 16287.9656s
	iters: 200, epoch: 2 | loss: 3.4039524
	speed: 0.3351s/iter; left time: 6832.8131s
Epoch: 2 cost time: 70.83295488357544
Epoch: 2, Steps: 208 | Train Loss: 3.159 Vali Loss: 4.355 Vali Acc: 0.074 Test Loss: 4.355 Test Acc: 0.074
Validation loss decreased (-0.058417 --> -0.073622).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0760796
	speed: 0.7779s/iter; left time: 15779.4456s
	iters: 200, epoch: 3 | loss: 2.8128355
	speed: 0.3242s/iter; left time: 6543.6046s
Epoch: 3 cost time: 68.31302523612976
Epoch: 3, Steps: 208 | Train Loss: 2.857 Vali Loss: 4.694 Vali Acc: 0.082 Test Loss: 4.694 Test Acc: 0.082
Validation loss decreased (-0.073622 --> -0.081671).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9139053
	speed: 0.7889s/iter; left time: 15839.7160s
	iters: 200, epoch: 4 | loss: 2.6535850
	speed: 0.3372s/iter; left time: 6735.3454s
Epoch: 4 cost time: 70.3399965763092
Epoch: 4, Steps: 208 | Train Loss: 2.498 Vali Loss: 4.924 Vali Acc: 0.075 Test Loss: 4.924 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3685942
	speed: 0.8173s/iter; left time: 16239.0498s
	iters: 200, epoch: 5 | loss: 2.2651732
	speed: 0.3429s/iter; left time: 6778.3976s
Epoch: 5 cost time: 72.10684084892273
Epoch: 5, Steps: 208 | Train Loss: 2.187 Vali Loss: 5.326 Vali Acc: 0.084 Test Loss: 5.326 Test Acc: 0.084
Validation loss decreased (-0.081671 --> -0.084051).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4940875
	speed: 0.8343s/iter; left time: 16403.5399s
	iters: 200, epoch: 6 | loss: 1.5670704
	speed: 0.3341s/iter; left time: 6535.0641s
Epoch: 6 cost time: 71.93531131744385
Epoch: 6, Steps: 208 | Train Loss: 1.860 Vali Loss: 5.597 Vali Acc: 0.085 Test Loss: 5.597 Test Acc: 0.085
Validation loss decreased (-0.084051 --> -0.084644).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8650958
	speed: 0.7769s/iter; left time: 15113.7287s
	iters: 200, epoch: 7 | loss: 2.4076128
	speed: 0.3195s/iter; left time: 6183.2765s
Epoch: 7 cost time: 67.27418231964111
Epoch: 7, Steps: 208 | Train Loss: 1.450 Vali Loss: 6.023 Vali Acc: 0.081 Test Loss: 6.023 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4880795
	speed: 0.8038s/iter; left time: 15468.3189s
	iters: 200, epoch: 8 | loss: 1.4597001
	speed: 0.3463s/iter; left time: 6630.4058s
Epoch: 8 cost time: 73.24168300628662
Epoch: 8, Steps: 208 | Train Loss: 1.217 Vali Loss: 6.320 Vali Acc: 0.078 Test Loss: 6.320 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5340599
	speed: 0.8223s/iter; left time: 15653.7216s
	iters: 200, epoch: 9 | loss: 1.4590162
	speed: 0.3481s/iter; left time: 6592.3066s
Epoch: 9 cost time: 73.71144127845764
Epoch: 9, Steps: 208 | Train Loss: 1.004 Vali Loss: 6.709 Vali Acc: 0.084 Test Loss: 6.709 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3584030
	speed: 0.8229s/iter; left time: 15494.9423s
	iters: 200, epoch: 10 | loss: 0.2696472
	speed: 0.3355s/iter; left time: 6284.1315s
Epoch: 10 cost time: 71.14315342903137
Epoch: 10, Steps: 208 | Train Loss: 0.861 Vali Loss: 7.348 Vali Acc: 0.080 Test Loss: 7.348 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9184865
	speed: 0.8063s/iter; left time: 15014.4100s
	iters: 200, epoch: 11 | loss: 0.4961608
	speed: 0.3532s/iter; left time: 6542.3414s
Epoch: 11 cost time: 72.43273711204529
Epoch: 11, Steps: 208 | Train Loss: 0.736 Vali Loss: 7.532 Vali Acc: 0.087 Test Loss: 7.532 Test Acc: 0.087
Validation loss decreased (-0.084644 --> -0.087011).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3475446
	speed: 0.8456s/iter; left time: 15570.6707s
	iters: 200, epoch: 12 | loss: 0.8093481
	speed: 0.3306s/iter; left time: 6054.3747s
Epoch: 12 cost time: 71.57498526573181
Epoch: 12, Steps: 208 | Train Loss: 0.667 Vali Loss: 7.803 Vali Acc: 0.081 Test Loss: 7.803 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2634363
	speed: 0.7940s/iter; left time: 14454.8396s
	iters: 200, epoch: 13 | loss: 0.6030001
	speed: 0.3356s/iter; left time: 6075.6323s
Epoch: 13 cost time: 68.90702748298645
Epoch: 13, Steps: 208 | Train Loss: 0.574 Vali Loss: 8.115 Vali Acc: 0.083 Test Loss: 8.115 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1978855
	speed: 0.8019s/iter; left time: 14432.3322s
	iters: 200, epoch: 14 | loss: 0.2505699
	speed: 0.3406s/iter; left time: 6095.7535s
Epoch: 14 cost time: 72.17232322692871
Epoch: 14, Steps: 208 | Train Loss: 0.561 Vali Loss: 8.313 Vali Acc: 0.084 Test Loss: 8.313 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7296597
	speed: 0.8007s/iter; left time: 14243.6522s
	iters: 200, epoch: 15 | loss: 0.5857414
	speed: 0.3321s/iter; left time: 5873.8272s
Epoch: 15 cost time: 70.83099126815796
Epoch: 15, Steps: 208 | Train Loss: 0.455 Vali Loss: 8.515 Vali Acc: 0.092 Test Loss: 8.515 Test Acc: 0.092
Validation loss decreased (-0.087011 --> -0.091475).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0224596
	speed: 0.8236s/iter; left time: 14480.0306s
	iters: 200, epoch: 16 | loss: 0.7762360
	speed: 0.3523s/iter; left time: 6158.9518s
Epoch: 16 cost time: 73.5194833278656
Epoch: 16, Steps: 208 | Train Loss: 0.421 Vali Loss: 9.093 Vali Acc: 0.085 Test Loss: 9.093 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6635780
	speed: 0.8528s/iter; left time: 14815.7749s
	iters: 200, epoch: 17 | loss: 0.6344081
	speed: 0.3428s/iter; left time: 5920.6014s
Epoch: 17 cost time: 74.02541613578796
Epoch: 17, Steps: 208 | Train Loss: 0.378 Vali Loss: 9.227 Vali Acc: 0.086 Test Loss: 9.227 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8267468
	speed: 0.8233s/iter; left time: 14131.7473s
	iters: 200, epoch: 18 | loss: 0.3014637
	speed: 0.3709s/iter; left time: 6329.9654s
Epoch: 18 cost time: 76.2510769367218
Epoch: 18, Steps: 208 | Train Loss: 0.395 Vali Loss: 9.101 Vali Acc: 0.086 Test Loss: 9.101 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3171054
	speed: 0.9072s/iter; left time: 15382.9054s
	iters: 200, epoch: 19 | loss: 0.2210026
	speed: 0.3506s/iter; left time: 5909.7253s
Epoch: 19 cost time: 76.93541526794434
Epoch: 19, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.362 Vali Acc: 0.083 Test Loss: 9.362 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3319915
	speed: 0.8131s/iter; left time: 13618.2235s
	iters: 200, epoch: 20 | loss: 0.8363663
	speed: 0.3236s/iter; left time: 5387.2522s
Epoch: 20 cost time: 68.67317938804626
Epoch: 20, Steps: 208 | Train Loss: 0.318 Vali Loss: 9.477 Vali Acc: 0.086 Test Loss: 9.477 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.7883534
	speed: 0.7948s/iter; left time: 13146.4642s
	iters: 200, epoch: 21 | loss: 0.3440653
	speed: 0.3454s/iter; left time: 5679.2965s
Epoch: 21 cost time: 71.20519185066223
Epoch: 21, Steps: 208 | Train Loss: 0.261 Vali Loss: 9.909 Vali Acc: 0.094 Test Loss: 9.909 Test Acc: 0.094
Validation loss decreased (-0.091475 --> -0.094145).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1340093
	speed: 0.8613s/iter; left time: 14068.4056s
	iters: 200, epoch: 22 | loss: 0.0951575
	speed: 0.3549s/iter; left time: 5760.3497s
Epoch: 22 cost time: 74.92147707939148
Epoch: 22, Steps: 208 | Train Loss: 0.248 Vali Loss: 10.055 Vali Acc: 0.090 Test Loss: 10.055 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2651992
	speed: 0.8706s/iter; left time: 14038.2046s
	iters: 200, epoch: 23 | loss: 0.1240963
	speed: 0.3612s/iter; left time: 5788.5651s
Epoch: 23 cost time: 76.28396010398865
Epoch: 23, Steps: 208 | Train Loss: 0.248 Vali Loss: 9.935 Vali Acc: 0.102 Test Loss: 9.935 Test Acc: 0.102
Validation loss decreased (-0.094145 --> -0.101601).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0567792
	speed: 0.8529s/iter; left time: 13575.1597s
	iters: 200, epoch: 24 | loss: 0.1000196
	speed: 0.3746s/iter; left time: 5925.3876s
Epoch: 24 cost time: 78.27527165412903
Epoch: 24, Steps: 208 | Train Loss: 0.234 Vali Loss: 10.173 Vali Acc: 0.087 Test Loss: 10.173 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0986768
	speed: 0.8931s/iter; left time: 14029.6697s
	iters: 200, epoch: 25 | loss: 0.1882908
	speed: 0.3736s/iter; left time: 5830.9196s
Epoch: 25 cost time: 77.58428406715393
Epoch: 25, Steps: 208 | Train Loss: 0.220 Vali Loss: 10.519 Vali Acc: 0.091 Test Loss: 10.519 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0081601
	speed: 0.9320s/iter; left time: 14447.5830s
	iters: 200, epoch: 26 | loss: 0.1128109
	speed: 0.3638s/iter; left time: 5602.8877s
Epoch: 26 cost time: 78.4840989112854
Epoch: 26, Steps: 208 | Train Loss: 0.235 Vali Loss: 10.488 Vali Acc: 0.096 Test Loss: 10.488 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3904130
	speed: 0.8657s/iter; left time: 13239.3983s
	iters: 200, epoch: 27 | loss: 0.1522620
	speed: 0.3427s/iter; left time: 5207.0568s
Epoch: 27 cost time: 73.14644622802734
Epoch: 27, Steps: 208 | Train Loss: 0.201 Vali Loss: 10.369 Vali Acc: 0.087 Test Loss: 10.369 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3988275
	speed: 0.8449s/iter; left time: 12745.2781s
	iters: 200, epoch: 28 | loss: 0.0738262
	speed: 0.3718s/iter; left time: 5570.8378s
Epoch: 28 cost time: 76.78148818016052
Epoch: 28, Steps: 208 | Train Loss: 0.171 Vali Loss: 10.633 Vali Acc: 0.086 Test Loss: 10.633 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0343107
	speed: 0.8627s/iter; left time: 12833.7083s
	iters: 200, epoch: 29 | loss: 0.1452091
	speed: 0.3471s/iter; left time: 5128.9803s
Epoch: 29 cost time: 73.46106219291687
Epoch: 29, Steps: 208 | Train Loss: 0.185 Vali Loss: 10.745 Vali Acc: 0.090 Test Loss: 10.745 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0147496
	speed: 0.8284s/iter; left time: 12151.4904s
	iters: 200, epoch: 30 | loss: 0.0530864
	speed: 0.3241s/iter; left time: 4721.1576s
Epoch: 30 cost time: 70.92720103263855
Epoch: 30, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.131 Vali Acc: 0.098 Test Loss: 11.131 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.3987427
	speed: 0.8235s/iter; left time: 11909.1548s
	iters: 200, epoch: 31 | loss: 0.2071248
	speed: 0.3311s/iter; left time: 4755.6254s
Epoch: 31 cost time: 71.0059814453125
Epoch: 31, Steps: 208 | Train Loss: 0.174 Vali Loss: 10.880 Vali Acc: 0.096 Test Loss: 10.880 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0287926
	speed: 0.8749s/iter; left time: 12470.0356s
	iters: 200, epoch: 32 | loss: 0.0885625
	speed: 0.4002s/iter; left time: 5664.6326s
Epoch: 32 cost time: 80.13408970832825
Epoch: 32, Steps: 208 | Train Loss: 0.159 Vali Loss: 10.913 Vali Acc: 0.093 Test Loss: 10.913 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0583612
	speed: 0.8222s/iter; left time: 11547.5917s
	iters: 200, epoch: 33 | loss: 0.0739975
	speed: 0.3275s/iter; left time: 4566.4085s
Epoch: 33 cost time: 70.07319784164429
Epoch: 33, Steps: 208 | Train Loss: 0.131 Vali Loss: 11.393 Vali Acc: 0.092 Test Loss: 11.393 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10169997017596183
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5382433
	speed: 0.3545s/iter; left time: 7338.9901s
	iters: 200, epoch: 1 | loss: 3.4874616
	speed: 0.3356s/iter; left time: 6914.0190s
Epoch: 1 cost time: 72.08699488639832
Epoch: 1, Steps: 208 | Train Loss: 3.641 Vali Loss: 4.396 Vali Acc: 0.034 Test Loss: 4.396 Test Acc: 0.034
Validation loss decreased (inf --> -0.033955).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0318737
	speed: 0.8250s/iter; left time: 16906.1205s
	iters: 200, epoch: 2 | loss: 3.4748492
	speed: 0.3491s/iter; left time: 7119.1627s
Epoch: 2 cost time: 73.24827742576599
Epoch: 2, Steps: 208 | Train Loss: 3.224 Vali Loss: 4.573 Vali Acc: 0.050 Test Loss: 4.573 Test Acc: 0.050
Validation loss decreased (-0.033955 --> -0.050357).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9984958
	speed: 0.8530s/iter; left time: 17303.8285s
	iters: 200, epoch: 3 | loss: 2.9390092
	speed: 0.3547s/iter; left time: 7160.3724s
Epoch: 3 cost time: 74.33901166915894
Epoch: 3, Steps: 208 | Train Loss: 3.005 Vali Loss: 5.381 Vali Acc: 0.046 Test Loss: 5.381 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.4128339
	speed: 0.8481s/iter; left time: 17026.9148s
	iters: 200, epoch: 4 | loss: 3.0623956
	speed: 0.3461s/iter; left time: 6914.6348s
Epoch: 4 cost time: 73.0114278793335
Epoch: 4, Steps: 208 | Train Loss: 2.783 Vali Loss: 5.400 Vali Acc: 0.051 Test Loss: 5.400 Test Acc: 0.051
Validation loss decreased (-0.050357 --> -0.051243).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1061416
	speed: 0.8181s/iter; left time: 16255.6913s
	iters: 200, epoch: 5 | loss: 2.7669950
	speed: 0.3372s/iter; left time: 6665.7673s
Epoch: 5 cost time: 70.59184169769287
Epoch: 5, Steps: 208 | Train Loss: 2.561 Vali Loss: 5.524 Vali Acc: 0.062 Test Loss: 5.524 Test Acc: 0.062
Validation loss decreased (-0.051243 --> -0.062277).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9431372
	speed: 0.8534s/iter; left time: 16778.8921s
	iters: 200, epoch: 6 | loss: 2.0447924
	speed: 0.3700s/iter; left time: 7236.8082s
Epoch: 6 cost time: 77.02560067176819
Epoch: 6, Steps: 208 | Train Loss: 2.241 Vali Loss: 5.658 Vali Acc: 0.074 Test Loss: 5.658 Test Acc: 0.074
Validation loss decreased (-0.062277 --> -0.073907).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3045053
	speed: 0.8839s/iter; left time: 17194.7008s
	iters: 200, epoch: 7 | loss: 2.7526784
	speed: 0.3361s/iter; left time: 6505.3006s
Epoch: 7 cost time: 72.8413143157959
Epoch: 7, Steps: 208 | Train Loss: 1.864 Vali Loss: 5.888 Vali Acc: 0.078 Test Loss: 5.888 Test Acc: 0.078
Validation loss decreased (-0.073907 --> -0.077782).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5877081
	speed: 0.7898s/iter; left time: 15200.5546s
	iters: 200, epoch: 8 | loss: 1.4740522
	speed: 0.3276s/iter; left time: 6271.2531s
Epoch: 8 cost time: 67.99029850959778
Epoch: 8, Steps: 208 | Train Loss: 1.576 Vali Loss: 6.466 Vali Acc: 0.066 Test Loss: 6.466 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1944311
	speed: 0.7617s/iter; left time: 14500.2011s
	iters: 200, epoch: 9 | loss: 1.1677107
	speed: 0.3338s/iter; left time: 6320.7300s
Epoch: 9 cost time: 69.58018755912781
Epoch: 9, Steps: 208 | Train Loss: 1.292 Vali Loss: 6.528 Vali Acc: 0.081 Test Loss: 6.528 Test Acc: 0.081
Validation loss decreased (-0.077782 --> -0.080460).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8525986
	speed: 0.7846s/iter; left time: 14772.8265s
	iters: 200, epoch: 10 | loss: 1.4703684
	speed: 0.3355s/iter; left time: 6282.9968s
Epoch: 10 cost time: 69.91295027732849
Epoch: 10, Steps: 208 | Train Loss: 1.069 Vali Loss: 7.105 Vali Acc: 0.071 Test Loss: 7.105 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9379675
	speed: 0.7942s/iter; left time: 14789.1485s
	iters: 200, epoch: 11 | loss: 1.3816186
	speed: 0.3329s/iter; left time: 6165.9329s
Epoch: 11 cost time: 69.80688643455505
Epoch: 11, Steps: 208 | Train Loss: 0.925 Vali Loss: 7.528 Vali Acc: 0.078 Test Loss: 7.528 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3953080
	speed: 0.7853s/iter; left time: 14459.4676s
	iters: 200, epoch: 12 | loss: 0.8967445
	speed: 0.3196s/iter; left time: 5852.1498s
Epoch: 12 cost time: 67.86257195472717
Epoch: 12, Steps: 208 | Train Loss: 0.781 Vali Loss: 7.908 Vali Acc: 0.083 Test Loss: 7.908 Test Acc: 0.083
Validation loss decreased (-0.080460 --> -0.082832).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6369395
	speed: 0.7651s/iter; left time: 13928.0086s
	iters: 200, epoch: 13 | loss: 0.5075920
	speed: 0.3217s/iter; left time: 5824.5118s
Epoch: 13 cost time: 66.24210357666016
Epoch: 13, Steps: 208 | Train Loss: 0.672 Vali Loss: 8.173 Vali Acc: 0.088 Test Loss: 8.173 Test Acc: 0.088
Validation loss decreased (-0.082832 --> -0.087601).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5857585
	speed: 0.8123s/iter; left time: 14618.6565s
	iters: 200, epoch: 14 | loss: 0.4659004
	speed: 0.3370s/iter; left time: 6030.4009s
Epoch: 14 cost time: 70.26082038879395
Epoch: 14, Steps: 208 | Train Loss: 0.627 Vali Loss: 8.224 Vali Acc: 0.084 Test Loss: 8.224 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7810765
	speed: 0.8224s/iter; left time: 14629.6066s
	iters: 200, epoch: 15 | loss: 0.4281756
	speed: 0.3399s/iter; left time: 6011.6369s
Epoch: 15 cost time: 70.75111174583435
Epoch: 15, Steps: 208 | Train Loss: 0.520 Vali Loss: 8.396 Vali Acc: 0.084 Test Loss: 8.396 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1188345
	speed: 0.7917s/iter; left time: 13919.2474s
	iters: 200, epoch: 16 | loss: 0.3682435
	speed: 0.3177s/iter; left time: 5553.3674s
Epoch: 16 cost time: 67.50754427909851
Epoch: 16, Steps: 208 | Train Loss: 0.452 Vali Loss: 8.922 Vali Acc: 0.081 Test Loss: 8.922 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2834774
	speed: 0.7878s/iter; left time: 13687.2282s
	iters: 200, epoch: 17 | loss: 0.3168599
	speed: 0.3199s/iter; left time: 5525.3052s
Epoch: 17 cost time: 67.74562168121338
Epoch: 17, Steps: 208 | Train Loss: 0.432 Vali Loss: 9.275 Vali Acc: 0.086 Test Loss: 9.275 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4813375
	speed: 0.7996s/iter; left time: 13725.7564s
	iters: 200, epoch: 18 | loss: 0.3682640
	speed: 0.3298s/iter; left time: 5628.1435s
Epoch: 18 cost time: 69.24295115470886
Epoch: 18, Steps: 208 | Train Loss: 0.390 Vali Loss: 9.165 Vali Acc: 0.083 Test Loss: 9.165 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0960403
	speed: 0.8058s/iter; left time: 13663.2514s
	iters: 200, epoch: 19 | loss: 0.5675000
	speed: 0.3309s/iter; left time: 5578.5011s
Epoch: 19 cost time: 69.65866327285767
Epoch: 19, Steps: 208 | Train Loss: 0.356 Vali Loss: 9.536 Vali Acc: 0.075 Test Loss: 9.536 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8527989
	speed: 0.7888s/iter; left time: 13212.2271s
	iters: 200, epoch: 20 | loss: 0.7741185
	speed: 0.3276s/iter; left time: 5454.6068s
Epoch: 20 cost time: 70.48764300346375
Epoch: 20, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.612 Vali Acc: 0.091 Test Loss: 9.612 Test Acc: 0.091
Validation loss decreased (-0.087601 --> -0.090867).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8257837
	speed: 0.7834s/iter; left time: 12957.4122s
	iters: 200, epoch: 21 | loss: 0.2664756
	speed: 0.3278s/iter; left time: 5389.1064s
Epoch: 21 cost time: 68.30310821533203
Epoch: 21, Steps: 208 | Train Loss: 0.274 Vali Loss: 10.076 Vali Acc: 0.081 Test Loss: 10.076 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5450417
	speed: 0.8044s/iter; left time: 13138.5355s
	iters: 200, epoch: 22 | loss: 0.2415120
	speed: 0.3304s/iter; left time: 5362.7712s
Epoch: 22 cost time: 69.81255769729614
Epoch: 22, Steps: 208 | Train Loss: 0.282 Vali Loss: 10.031 Vali Acc: 0.086 Test Loss: 10.031 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.0162983
	speed: 0.8202s/iter; left time: 13225.1536s
	iters: 200, epoch: 23 | loss: 0.1269400
	speed: 0.3435s/iter; left time: 5503.7868s
Epoch: 23 cost time: 71.27432227134705
Epoch: 23, Steps: 208 | Train Loss: 0.259 Vali Loss: 10.372 Vali Acc: 0.089 Test Loss: 10.372 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.6558290
	speed: 0.7904s/iter; left time: 12581.4482s
	iters: 200, epoch: 24 | loss: 0.4474134
	speed: 0.3270s/iter; left time: 5171.8038s
Epoch: 24 cost time: 67.92171931266785
Epoch: 24, Steps: 208 | Train Loss: 0.225 Vali Loss: 10.535 Vali Acc: 0.088 Test Loss: 10.535 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1730616
	speed: 0.7604s/iter; left time: 11944.9360s
	iters: 200, epoch: 25 | loss: 0.0338571
	speed: 0.3295s/iter; left time: 5142.4696s
Epoch: 25 cost time: 68.34625315666199
Epoch: 25, Steps: 208 | Train Loss: 0.198 Vali Loss: 10.806 Vali Acc: 0.084 Test Loss: 10.806 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1578003
	speed: 0.7873s/iter; left time: 12204.3647s
	iters: 200, epoch: 26 | loss: 0.1552623
	speed: 0.3359s/iter; left time: 5172.8560s
Epoch: 26 cost time: 71.11957454681396
Epoch: 26, Steps: 208 | Train Loss: 0.241 Vali Loss: 10.344 Vali Acc: 0.089 Test Loss: 10.344 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6389500
	speed: 0.8200s/iter; left time: 12540.3179s
	iters: 200, epoch: 27 | loss: 0.0491679
	speed: 0.3360s/iter; left time: 5104.2096s
Epoch: 27 cost time: 70.9891619682312
Epoch: 27, Steps: 208 | Train Loss: 0.226 Vali Loss: 10.545 Vali Acc: 0.085 Test Loss: 10.545 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0839654
	speed: 0.7949s/iter; left time: 11991.6025s
	iters: 200, epoch: 28 | loss: 0.7421802
	speed: 0.3295s/iter; left time: 4936.8627s
Epoch: 28 cost time: 68.68527030944824
Epoch: 28, Steps: 208 | Train Loss: 0.192 Vali Loss: 10.781 Vali Acc: 0.095 Test Loss: 10.781 Test Acc: 0.095
Validation loss decreased (-0.090867 --> -0.095329).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0141181
	speed: 0.8001s/iter; left time: 11903.0324s
	iters: 200, epoch: 29 | loss: 0.1953078
	speed: 0.3196s/iter; left time: 4723.0546s
Epoch: 29 cost time: 68.33339643478394
Epoch: 29, Steps: 208 | Train Loss: 0.211 Vali Loss: 10.602 Vali Acc: 0.106 Test Loss: 10.602 Test Acc: 0.106
Validation loss decreased (-0.095329 --> -0.105471).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.1131605
	speed: 0.7623s/iter; left time: 11181.4542s
	iters: 200, epoch: 30 | loss: 0.0426079
	speed: 0.3328s/iter; left time: 4849.1344s
Epoch: 30 cost time: 68.40017485618591
Epoch: 30, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.212 Vali Acc: 0.096 Test Loss: 11.212 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.8272392
	speed: 0.7881s/iter; left time: 11396.4503s
	iters: 200, epoch: 31 | loss: 0.0456129
	speed: 0.3185s/iter; left time: 4573.5226s
Epoch: 31 cost time: 67.2082371711731
Epoch: 31, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.103 Vali Acc: 0.094 Test Loss: 11.103 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.3823538
	speed: 0.7851s/iter; left time: 11190.5502s
	iters: 200, epoch: 32 | loss: 0.2137246
	speed: 0.3295s/iter; left time: 4662.8992s
Epoch: 32 cost time: 68.62642765045166
Epoch: 32, Steps: 208 | Train Loss: 0.174 Vali Loss: 10.885 Vali Acc: 0.093 Test Loss: 10.885 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0101174
	speed: 0.8207s/iter; left time: 11527.2542s
	iters: 200, epoch: 33 | loss: 0.1325853
	speed: 0.3315s/iter; left time: 4622.6193s
Epoch: 33 cost time: 70.11965084075928
Epoch: 33, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.128 Vali Acc: 0.095 Test Loss: 11.128 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.1675096
	speed: 0.7779s/iter; left time: 10764.1553s
	iters: 200, epoch: 34 | loss: 0.0223069
	speed: 0.3149s/iter; left time: 4325.9685s
Epoch: 34 cost time: 66.47462034225464
Epoch: 34, Steps: 208 | Train Loss: 0.166 Vali Loss: 11.409 Vali Acc: 0.089 Test Loss: 11.409 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.2432481
	speed: 0.8649s/iter; left time: 11788.0906s
	iters: 200, epoch: 35 | loss: 0.2408741
	speed: 0.3455s/iter; left time: 4673.9383s
Epoch: 35 cost time: 73.34936857223511
Epoch: 35, Steps: 208 | Train Loss: 0.154 Vali Loss: 11.317 Vali Acc: 0.108 Test Loss: 11.317 Test Acc: 0.108
Validation loss decreased (-0.105471 --> -0.107552).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0081944
	speed: 0.7740s/iter; left time: 10387.5742s
	iters: 200, epoch: 36 | loss: 0.1981518
	speed: 0.3222s/iter; left time: 4291.3745s
Epoch: 36 cost time: 68.1139817237854
Epoch: 36, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.403 Vali Acc: 0.097 Test Loss: 11.403 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0532104
	speed: 0.7775s/iter; left time: 10272.5811s
	iters: 200, epoch: 37 | loss: 0.3190315
	speed: 0.3188s/iter; left time: 4180.2105s
Epoch: 37 cost time: 67.26028895378113
Epoch: 37, Steps: 208 | Train Loss: 0.172 Vali Loss: 11.466 Vali Acc: 0.099 Test Loss: 11.466 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.1889739
	speed: 0.8331s/iter; left time: 10833.8461s
	iters: 200, epoch: 38 | loss: 0.4205078
	speed: 0.3326s/iter; left time: 4291.7813s
Epoch: 38 cost time: 71.94263625144958
Epoch: 38, Steps: 208 | Train Loss: 0.139 Vali Loss: 11.589 Vali Acc: 0.101 Test Loss: 11.589 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0321202
	speed: 0.8250s/iter; left time: 10556.9209s
	iters: 200, epoch: 39 | loss: 0.0034516
	speed: 0.3406s/iter; left time: 4325.2309s
Epoch: 39 cost time: 72.13561677932739
Epoch: 39, Steps: 208 | Train Loss: 0.132 Vali Loss: 11.499 Vali Acc: 0.098 Test Loss: 11.499 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.2900686
	speed: 0.8029s/iter; left time: 10107.5188s
	iters: 200, epoch: 40 | loss: 0.1221047
	speed: 0.3464s/iter; left time: 4326.7516s
Epoch: 40 cost time: 71.36371684074402
Epoch: 40, Steps: 208 | Train Loss: 0.141 Vali Loss: 11.682 Vali Acc: 0.096 Test Loss: 11.682 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.2252061
	speed: 0.8183s/iter; left time: 10131.7158s
	iters: 200, epoch: 41 | loss: 0.2083095
	speed: 0.3455s/iter; left time: 4243.3695s
Epoch: 41 cost time: 72.05023431777954
Epoch: 41, Steps: 208 | Train Loss: 0.115 Vali Loss: 11.965 Vali Acc: 0.095 Test Loss: 11.965 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0033609
	speed: 0.8231s/iter; left time: 10020.1034s
	iters: 200, epoch: 42 | loss: 0.1008209
	speed: 0.3409s/iter; left time: 4115.8171s
Epoch: 42 cost time: 70.93100309371948
Epoch: 42, Steps: 208 | Train Loss: 0.108 Vali Loss: 12.239 Vali Acc: 0.096 Test Loss: 12.239 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0493076
	speed: 0.8346s/iter; left time: 9986.4955s
	iters: 200, epoch: 43 | loss: 0.0230692
	speed: 0.3426s/iter; left time: 4064.5708s
Epoch: 43 cost time: 71.34644818305969
Epoch: 43, Steps: 208 | Train Loss: 0.132 Vali Loss: 12.456 Vali Acc: 0.092 Test Loss: 12.456 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0247448
	speed: 0.8338s/iter; left time: 9802.8116s
	iters: 200, epoch: 44 | loss: 0.2725911
	speed: 0.3567s/iter; left time: 4157.5327s
Epoch: 44 cost time: 73.59950160980225
Epoch: 44, Steps: 208 | Train Loss: 0.116 Vali Loss: 12.137 Vali Acc: 0.097 Test Loss: 12.137 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0315111
	speed: 0.8462s/iter; left time: 9773.1495s
	iters: 200, epoch: 45 | loss: 0.0133540
	speed: 0.3443s/iter; left time: 3941.8067s
Epoch: 45 cost time: 72.97737860679626
Epoch: 45, Steps: 208 | Train Loss: 0.109 Vali Loss: 12.117 Vali Acc: 0.098 Test Loss: 12.117 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1076647778109156
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5262547
	speed: 0.3711s/iter; left time: 7681.1635s
	iters: 200, epoch: 1 | loss: 3.4053102
	speed: 0.3455s/iter; left time: 7117.5243s
Epoch: 1 cost time: 74.82755994796753
Epoch: 1, Steps: 208 | Train Loss: 3.643 Vali Loss: 5.245 Vali Acc: 0.032 Test Loss: 5.245 Test Acc: 0.032
Validation loss decreased (inf --> -0.032158).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7868826
	speed: 0.8751s/iter; left time: 17933.9270s
	iters: 200, epoch: 2 | loss: 3.3513486
	speed: 0.3458s/iter; left time: 7052.1048s
Epoch: 2 cost time: 73.80039191246033
Epoch: 2, Steps: 208 | Train Loss: 3.278 Vali Loss: 5.412 Vali Acc: 0.038 Test Loss: 5.412 Test Acc: 0.038
Validation loss decreased (-0.032158 --> -0.037822).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4791136
	speed: 0.8661s/iter; left time: 17569.6831s
	iters: 200, epoch: 3 | loss: 3.0228055
	speed: 0.3953s/iter; left time: 7979.7723s
Epoch: 3 cost time: 80.74140357971191
Epoch: 3, Steps: 208 | Train Loss: 3.096 Vali Loss: 6.421 Vali Acc: 0.036 Test Loss: 6.421 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2541468
	speed: 0.9037s/iter; left time: 18143.2027s
	iters: 200, epoch: 4 | loss: 2.9121614
	speed: 0.3692s/iter; left time: 7376.4001s
Epoch: 4 cost time: 77.44729232788086
Epoch: 4, Steps: 208 | Train Loss: 2.959 Vali Loss: 5.974 Vali Acc: 0.048 Test Loss: 5.974 Test Acc: 0.048
Validation loss decreased (-0.037822 --> -0.048255).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6050272
	speed: 0.8689s/iter; left time: 17264.0616s
	iters: 200, epoch: 5 | loss: 2.2156482
	speed: 0.3326s/iter; left time: 6574.5561s
Epoch: 5 cost time: 72.5056700706482
Epoch: 5, Steps: 208 | Train Loss: 2.791 Vali Loss: 6.095 Vali Acc: 0.053 Test Loss: 6.095 Test Acc: 0.053
Validation loss decreased (-0.048255 --> -0.053026).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3647447
	speed: 0.8110s/iter; left time: 15944.2346s
	iters: 200, epoch: 6 | loss: 2.6511989
	speed: 0.3443s/iter; left time: 6734.9499s
Epoch: 6 cost time: 71.0424337387085
Epoch: 6, Steps: 208 | Train Loss: 2.557 Vali Loss: 6.047 Vali Acc: 0.054 Test Loss: 6.047 Test Acc: 0.054
Validation loss decreased (-0.053026 --> -0.053623).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8266987
	speed: 0.8223s/iter; left time: 15996.3489s
	iters: 200, epoch: 7 | loss: 2.8354239
	speed: 0.3486s/iter; left time: 6746.8648s
Epoch: 7 cost time: 73.41754531860352
Epoch: 7, Steps: 208 | Train Loss: 2.253 Vali Loss: 6.296 Vali Acc: 0.062 Test Loss: 6.296 Test Acc: 0.062
Validation loss decreased (-0.053623 --> -0.061673).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8100145
	speed: 0.8631s/iter; left time: 16610.8119s
	iters: 200, epoch: 8 | loss: 2.1179380
	speed: 0.3894s/iter; left time: 7454.6654s
Epoch: 8 cost time: 79.64706254005432
Epoch: 8, Steps: 208 | Train Loss: 2.038 Vali Loss: 6.668 Vali Acc: 0.058 Test Loss: 6.668 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6858424
	speed: 0.8778s/iter; left time: 16711.3365s
	iters: 200, epoch: 9 | loss: 1.8662292
	speed: 0.3629s/iter; left time: 6873.0670s
Epoch: 9 cost time: 75.91223216056824
Epoch: 9, Steps: 208 | Train Loss: 1.756 Vali Loss: 6.465 Vali Acc: 0.068 Test Loss: 6.465 Test Acc: 0.068
Validation loss decreased (-0.061673 --> -0.067636).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6507691
	speed: 0.8481s/iter; left time: 15968.3109s
	iters: 200, epoch: 10 | loss: 1.7227958
	speed: 0.3325s/iter; left time: 6226.5405s
Epoch: 10 cost time: 71.75042080879211
Epoch: 10, Steps: 208 | Train Loss: 1.504 Vali Loss: 6.962 Vali Acc: 0.069 Test Loss: 6.962 Test Acc: 0.069
Validation loss decreased (-0.067636 --> -0.069122).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2281660
	speed: 0.8569s/iter; left time: 15955.7498s
	iters: 200, epoch: 11 | loss: 2.1781924
	speed: 0.3485s/iter; left time: 6454.7796s
Epoch: 11 cost time: 73.8795714378357
Epoch: 11, Steps: 208 | Train Loss: 1.350 Vali Loss: 7.204 Vali Acc: 0.081 Test Loss: 7.204 Test Acc: 0.081
Validation loss decreased (-0.069122 --> -0.081348).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6075545
	speed: 0.8434s/iter; left time: 15529.5479s
	iters: 200, epoch: 12 | loss: 1.3356934
	speed: 0.3474s/iter; left time: 6361.8907s
Epoch: 12 cost time: 73.06248641014099
Epoch: 12, Steps: 208 | Train Loss: 1.149 Vali Loss: 7.479 Vali Acc: 0.071 Test Loss: 7.479 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9333248
	speed: 0.8310s/iter; left time: 15128.5777s
	iters: 200, epoch: 13 | loss: 1.1214310
	speed: 0.3373s/iter; left time: 6106.3206s
Epoch: 13 cost time: 72.37605261802673
Epoch: 13, Steps: 208 | Train Loss: 1.014 Vali Loss: 7.537 Vali Acc: 0.074 Test Loss: 7.537 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3637649
	speed: 0.8149s/iter; left time: 14665.0170s
	iters: 200, epoch: 14 | loss: 0.4326941
	speed: 0.3552s/iter; left time: 6356.2555s
Epoch: 14 cost time: 72.84268045425415
Epoch: 14, Steps: 208 | Train Loss: 0.904 Vali Loss: 7.887 Vali Acc: 0.084 Test Loss: 7.887 Test Acc: 0.084
Validation loss decreased (-0.081348 --> -0.083727).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9712101
	speed: 0.8544s/iter; left time: 15199.7568s
	iters: 200, epoch: 15 | loss: 1.1487802
	speed: 0.3430s/iter; left time: 6067.3489s
Epoch: 15 cost time: 73.14203929901123
Epoch: 15, Steps: 208 | Train Loss: 0.796 Vali Loss: 8.580 Vali Acc: 0.071 Test Loss: 8.580 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2897585
	speed: 0.8244s/iter; left time: 14494.1376s
	iters: 200, epoch: 16 | loss: 0.3407555
	speed: 0.3659s/iter; left time: 6395.4761s
Epoch: 16 cost time: 75.6225733757019
Epoch: 16, Steps: 208 | Train Loss: 0.740 Vali Loss: 8.656 Vali Acc: 0.080 Test Loss: 8.656 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6736348
	speed: 0.8289s/iter; left time: 14400.1622s
	iters: 200, epoch: 17 | loss: 0.5741331
	speed: 0.3441s/iter; left time: 5944.3897s
Epoch: 17 cost time: 72.18534588813782
Epoch: 17, Steps: 208 | Train Loss: 0.662 Vali Loss: 8.792 Vali Acc: 0.077 Test Loss: 8.792 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1408951
	speed: 0.8310s/iter; left time: 14264.7541s
	iters: 200, epoch: 18 | loss: 1.1169002
	speed: 0.3661s/iter; left time: 6247.9618s
Epoch: 18 cost time: 74.48878931999207
Epoch: 18, Steps: 208 | Train Loss: 0.583 Vali Loss: 9.183 Vali Acc: 0.080 Test Loss: 9.183 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5770327
	speed: 0.8510s/iter; left time: 14431.0842s
	iters: 200, epoch: 19 | loss: 0.2983656
	speed: 0.3444s/iter; left time: 5805.8967s
Epoch: 19 cost time: 73.22395372390747
Epoch: 19, Steps: 208 | Train Loss: 0.523 Vali Loss: 9.578 Vali Acc: 0.079 Test Loss: 9.578 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2618357
	speed: 0.8291s/iter; left time: 13885.8778s
	iters: 200, epoch: 20 | loss: 0.9389948
	speed: 0.3490s/iter; left time: 5810.6613s
Epoch: 20 cost time: 72.64264726638794
Epoch: 20, Steps: 208 | Train Loss: 0.510 Vali Loss: 9.536 Vali Acc: 0.083 Test Loss: 9.536 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.0215228
	speed: 0.8013s/iter; left time: 13254.1839s
	iters: 200, epoch: 21 | loss: 0.2837787
	speed: 0.3511s/iter; left time: 5772.3346s
Epoch: 21 cost time: 72.45321488380432
Epoch: 21, Steps: 208 | Train Loss: 0.450 Vali Loss: 9.865 Vali Acc: 0.084 Test Loss: 9.865 Test Acc: 0.084
Validation loss decreased (-0.083727 --> -0.084303).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5247704
	speed: 0.8587s/iter; left time: 14025.0143s
	iters: 200, epoch: 22 | loss: 0.3081681
	speed: 0.3523s/iter; left time: 5718.6744s
Epoch: 22 cost time: 74.91078853607178
Epoch: 22, Steps: 208 | Train Loss: 0.430 Vali Loss: 10.347 Vali Acc: 0.088 Test Loss: 10.347 Test Acc: 0.088
Validation loss decreased (-0.084303 --> -0.088176).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.4714929
	speed: 0.8242s/iter; left time: 13290.2289s
	iters: 200, epoch: 23 | loss: 0.2867459
	speed: 0.3356s/iter; left time: 5377.3478s
Epoch: 23 cost time: 71.13710165023804
Epoch: 23, Steps: 208 | Train Loss: 0.397 Vali Loss: 10.175 Vali Acc: 0.081 Test Loss: 10.175 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.2746112
	speed: 0.7964s/iter; left time: 12676.4799s
	iters: 200, epoch: 24 | loss: 0.6081096
	speed: 0.3170s/iter; left time: 5014.2782s
Epoch: 24 cost time: 68.37986898422241
Epoch: 24, Steps: 208 | Train Loss: 0.368 Vali Loss: 10.622 Vali Acc: 0.086 Test Loss: 10.622 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2079302
	speed: 0.7879s/iter; left time: 12377.5676s
	iters: 200, epoch: 25 | loss: 0.2033411
	speed: 0.3355s/iter; left time: 5237.1193s
Epoch: 25 cost time: 69.88254523277283
Epoch: 25, Steps: 208 | Train Loss: 0.390 Vali Loss: 10.655 Vali Acc: 0.086 Test Loss: 10.655 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.2159230
	speed: 0.8258s/iter; left time: 12800.4905s
	iters: 200, epoch: 26 | loss: 0.4351874
	speed: 0.3567s/iter; left time: 5494.2441s
Epoch: 26 cost time: 75.02203869819641
Epoch: 26, Steps: 208 | Train Loss: 0.358 Vali Loss: 10.889 Vali Acc: 0.089 Test Loss: 10.889 Test Acc: 0.089
Validation loss decreased (-0.088176 --> -0.088767).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.1616313
	speed: 0.8065s/iter; left time: 12333.3871s
	iters: 200, epoch: 27 | loss: 0.0869772
	speed: 0.3366s/iter; left time: 5113.8386s
Epoch: 27 cost time: 70.00609087944031
Epoch: 27, Steps: 208 | Train Loss: 0.323 Vali Loss: 10.927 Vali Acc: 0.091 Test Loss: 10.927 Test Acc: 0.091
Validation loss decreased (-0.088767 --> -0.090854).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.4226884
	speed: 0.7614s/iter; left time: 11485.7305s
	iters: 200, epoch: 28 | loss: 0.2267385
	speed: 0.3161s/iter; left time: 4737.1955s
Epoch: 28 cost time: 67.04169702529907
Epoch: 28, Steps: 208 | Train Loss: 0.289 Vali Loss: 11.205 Vali Acc: 0.093 Test Loss: 11.205 Test Acc: 0.093
Validation loss decreased (-0.090854 --> -0.092939).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1365268
	speed: 0.7751s/iter; left time: 11530.9670s
	iters: 200, epoch: 29 | loss: 0.2676131
	speed: 0.3153s/iter; left time: 4659.0373s
Epoch: 29 cost time: 66.13478565216064
Epoch: 29, Steps: 208 | Train Loss: 0.311 Vali Loss: 11.480 Vali Acc: 0.087 Test Loss: 11.480 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.4239118
	speed: 0.7520s/iter; left time: 11030.4916s
	iters: 200, epoch: 30 | loss: 0.1187946
	speed: 0.3202s/iter; left time: 4664.7191s
Epoch: 30 cost time: 66.49761581420898
Epoch: 30, Steps: 208 | Train Loss: 0.283 Vali Loss: 11.126 Vali Acc: 0.100 Test Loss: 11.126 Test Acc: 0.100
Validation loss decreased (-0.092939 --> -0.099799).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.5487673
	speed: 0.7807s/iter; left time: 11289.4581s
	iters: 200, epoch: 31 | loss: 0.3537064
	speed: 0.3241s/iter; left time: 4654.9315s
Epoch: 31 cost time: 69.2958734035492
Epoch: 31, Steps: 208 | Train Loss: 0.277 Vali Loss: 11.481 Vali Acc: 0.097 Test Loss: 11.481 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0894738
	speed: 0.7935s/iter; left time: 11310.3907s
	iters: 200, epoch: 32 | loss: 0.4884539
	speed: 0.3396s/iter; left time: 4806.1915s
Epoch: 32 cost time: 70.63610649108887
Epoch: 32, Steps: 208 | Train Loss: 0.249 Vali Loss: 11.315 Vali Acc: 0.091 Test Loss: 11.315 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0353932
	speed: 0.8591s/iter; left time: 12065.4312s
	iters: 200, epoch: 33 | loss: 0.0316631
	speed: 0.3384s/iter; left time: 4719.3999s
Epoch: 33 cost time: 72.70872354507446
Epoch: 33, Steps: 208 | Train Loss: 0.231 Vali Loss: 11.828 Vali Acc: 0.086 Test Loss: 11.828 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.1752324
	speed: 0.8080s/iter; left time: 11180.4228s
	iters: 200, epoch: 34 | loss: 0.0652082
	speed: 0.3485s/iter; left time: 4787.7566s
Epoch: 34 cost time: 72.69235587120056
Epoch: 34, Steps: 208 | Train Loss: 0.260 Vali Loss: 11.633 Vali Acc: 0.084 Test Loss: 11.633 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.1204236
	speed: 0.8195s/iter; left time: 11169.3888s
	iters: 200, epoch: 35 | loss: 0.0717231
	speed: 0.3444s/iter; left time: 4659.5032s
Epoch: 35 cost time: 72.01076292991638
Epoch: 35, Steps: 208 | Train Loss: 0.242 Vali Loss: 11.858 Vali Acc: 0.088 Test Loss: 11.858 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.5338379
	speed: 0.7898s/iter; left time: 10600.1284s
	iters: 200, epoch: 36 | loss: 0.0566757
	speed: 0.3343s/iter; left time: 4452.7151s
Epoch: 36 cost time: 69.23155045509338
Epoch: 36, Steps: 208 | Train Loss: 0.240 Vali Loss: 12.244 Vali Acc: 0.091 Test Loss: 12.244 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.1794820
	speed: 0.7805s/iter; left time: 10312.4129s
	iters: 200, epoch: 37 | loss: 0.5031545
	speed: 0.3142s/iter; left time: 4119.8537s
Epoch: 37 cost time: 66.90482544898987
Epoch: 37, Steps: 208 | Train Loss: 0.214 Vali Loss: 12.527 Vali Acc: 0.098 Test Loss: 12.527 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0957290
	speed: 0.7511s/iter; left time: 9767.8528s
	iters: 200, epoch: 38 | loss: 0.0061271
	speed: 0.3143s/iter; left time: 4055.4756s
Epoch: 38 cost time: 66.83348846435547
Epoch: 38, Steps: 208 | Train Loss: 0.220 Vali Loss: 12.384 Vali Acc: 0.092 Test Loss: 12.384 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0054940
	speed: 0.7910s/iter; left time: 10122.9312s
	iters: 200, epoch: 39 | loss: 0.0630872
	speed: 0.3252s/iter; left time: 4128.8685s
Epoch: 39 cost time: 69.47218465805054
Epoch: 39, Steps: 208 | Train Loss: 0.208 Vali Loss: 11.906 Vali Acc: 0.092 Test Loss: 11.906 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0052530
	speed: 0.8026s/iter; left time: 10103.8800s
	iters: 200, epoch: 40 | loss: 0.0752802
	speed: 0.3226s/iter; left time: 4028.5610s
Epoch: 40 cost time: 69.46816611289978
Epoch: 40, Steps: 208 | Train Loss: 0.199 Vali Loss: 12.272 Vali Acc: 0.090 Test Loss: 12.272 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09991052788547569
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4351392
	speed: 0.3038s/iter; left time: 6288.3131s
	iters: 200, epoch: 1 | loss: 3.4964507
	speed: 0.2903s/iter; left time: 5980.5069s
Epoch: 1 cost time: 61.89454364776611
Epoch: 1, Steps: 208 | Train Loss: 3.645 Vali Loss: 4.680 Vali Acc: 0.030 Test Loss: 4.680 Test Acc: 0.030
Validation loss decreased (inf --> -0.030075).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6703367
	speed: 0.6871s/iter; left time: 14080.2451s
	iters: 200, epoch: 2 | loss: 3.1161203
	speed: 0.3017s/iter; left time: 6152.8156s
Epoch: 2 cost time: 62.15775108337402
Epoch: 2, Steps: 208 | Train Loss: 3.186 Vali Loss: 4.768 Vali Acc: 0.048 Test Loss: 4.768 Test Acc: 0.048
Validation loss decreased (-0.030075 --> -0.047671).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1842105
	speed: 0.7290s/iter; left time: 14787.1711s
	iters: 200, epoch: 3 | loss: 3.0867152
	speed: 0.2996s/iter; left time: 6048.3484s
Epoch: 3 cost time: 62.86468505859375
Epoch: 3, Steps: 208 | Train Loss: 2.941 Vali Loss: 5.823 Vali Acc: 0.042 Test Loss: 5.823 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1632166
	speed: 0.6943s/iter; left time: 13938.5046s
	iters: 200, epoch: 4 | loss: 2.5064716
	speed: 0.2758s/iter; left time: 5508.7168s
Epoch: 4 cost time: 59.64122700691223
Epoch: 4, Steps: 208 | Train Loss: 2.717 Vali Loss: 5.720 Vali Acc: 0.052 Test Loss: 5.720 Test Acc: 0.052
Validation loss decreased (-0.047671 --> -0.051538).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0490251
	speed: 0.6830s/iter; left time: 13571.2207s
	iters: 200, epoch: 5 | loss: 2.1795604
	speed: 0.2829s/iter; left time: 5592.4297s
Epoch: 5 cost time: 59.09599280357361
Epoch: 5, Steps: 208 | Train Loss: 2.485 Vali Loss: 6.008 Vali Acc: 0.058 Test Loss: 6.008 Test Acc: 0.058
Validation loss decreased (-0.051538 --> -0.058395).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9092640
	speed: 0.7152s/iter; left time: 14061.3253s
	iters: 200, epoch: 6 | loss: 1.9132384
	speed: 0.3023s/iter; left time: 5913.8795s
Epoch: 6 cost time: 64.07448077201843
Epoch: 6, Steps: 208 | Train Loss: 2.230 Vali Loss: 6.143 Vali Acc: 0.056 Test Loss: 6.143 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4701943
	speed: 0.7275s/iter; left time: 14151.0909s
	iters: 200, epoch: 7 | loss: 2.3886149
	speed: 0.3109s/iter; left time: 6017.6442s
Epoch: 7 cost time: 64.53144359588623
Epoch: 7, Steps: 208 | Train Loss: 1.859 Vali Loss: 6.616 Vali Acc: 0.065 Test Loss: 6.616 Test Acc: 0.065
Validation loss decreased (-0.058395 --> -0.064950).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4472318
	speed: 0.7722s/iter; left time: 14860.3394s
	iters: 200, epoch: 8 | loss: 1.9561725
	speed: 0.3011s/iter; left time: 5763.8018s
Epoch: 8 cost time: 64.7883849143982
Epoch: 8, Steps: 208 | Train Loss: 1.613 Vali Loss: 6.855 Vali Acc: 0.065 Test Loss: 6.855 Test Acc: 0.065
Validation loss decreased (-0.064950 --> -0.065246).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4064614
	speed: 0.7472s/iter; left time: 14225.2298s
	iters: 200, epoch: 9 | loss: 1.8041418
	speed: 0.3145s/iter; left time: 5956.6076s
Epoch: 9 cost time: 65.99548101425171
Epoch: 9, Steps: 208 | Train Loss: 1.357 Vali Loss: 6.950 Vali Acc: 0.065 Test Loss: 6.950 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0434041
	speed: 0.7692s/iter; left time: 14483.8321s
	iters: 200, epoch: 10 | loss: 0.6860132
	speed: 0.3096s/iter; left time: 5798.9081s
Epoch: 10 cost time: 65.55573987960815
Epoch: 10, Steps: 208 | Train Loss: 1.134 Vali Loss: 7.519 Vali Acc: 0.064 Test Loss: 7.519 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2701014
	speed: 0.7373s/iter; left time: 13729.9984s
	iters: 200, epoch: 11 | loss: 1.9516516
	speed: 0.3175s/iter; left time: 5880.1819s
Epoch: 11 cost time: 65.60700297355652
Epoch: 11, Steps: 208 | Train Loss: 0.983 Vali Loss: 7.964 Vali Acc: 0.081 Test Loss: 7.964 Test Acc: 0.081
Validation loss decreased (-0.065246 --> -0.080445).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4665993
	speed: 0.7573s/iter; left time: 13943.3592s
	iters: 200, epoch: 12 | loss: 0.5299709
	speed: 0.3077s/iter; left time: 5635.6465s
Epoch: 12 cost time: 65.90967655181885
Epoch: 12, Steps: 208 | Train Loss: 0.841 Vali Loss: 8.247 Vali Acc: 0.071 Test Loss: 8.247 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4076887
	speed: 0.7251s/iter; left time: 13201.2059s
	iters: 200, epoch: 13 | loss: 0.2270369
	speed: 0.3027s/iter; left time: 5480.6746s
Epoch: 13 cost time: 62.459781885147095
Epoch: 13, Steps: 208 | Train Loss: 0.735 Vali Loss: 8.284 Vali Acc: 0.079 Test Loss: 8.284 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2304436
	speed: 0.7642s/iter; left time: 13753.6593s
	iters: 200, epoch: 14 | loss: 0.8237923
	speed: 0.3048s/iter; left time: 5454.7634s
Epoch: 14 cost time: 65.08165836334229
Epoch: 14, Steps: 208 | Train Loss: 0.690 Vali Loss: 8.669 Vali Acc: 0.081 Test Loss: 8.669 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2915786
	speed: 0.7411s/iter; left time: 13182.6602s
	iters: 200, epoch: 15 | loss: 0.6994423
	speed: 0.3110s/iter; left time: 5501.9553s
Epoch: 15 cost time: 65.56250166893005
Epoch: 15, Steps: 208 | Train Loss: 0.585 Vali Loss: 9.460 Vali Acc: 0.077 Test Loss: 9.460 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0863840
	speed: 0.7443s/iter; left time: 13085.9576s
	iters: 200, epoch: 16 | loss: 0.5926412
	speed: 0.2980s/iter; left time: 5208.4844s
Epoch: 16 cost time: 63.50086712837219
Epoch: 16, Steps: 208 | Train Loss: 0.534 Vali Loss: 9.479 Vali Acc: 0.077 Test Loss: 9.479 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6307259
	speed: 0.6976s/iter; left time: 12118.6070s
	iters: 200, epoch: 17 | loss: 0.2771219
	speed: 0.2988s/iter; left time: 5160.7701s
Epoch: 17 cost time: 62.16213393211365
Epoch: 17, Steps: 208 | Train Loss: 0.483 Vali Loss: 9.967 Vali Acc: 0.077 Test Loss: 9.967 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1978044
	speed: 0.7283s/iter; left time: 12501.4554s
	iters: 200, epoch: 18 | loss: 1.0542572
	speed: 0.2982s/iter; left time: 5088.1106s
Epoch: 18 cost time: 63.298001289367676
Epoch: 18, Steps: 208 | Train Loss: 0.456 Vali Loss: 10.158 Vali Acc: 0.070 Test Loss: 10.158 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.4263104
	speed: 0.7163s/iter; left time: 12146.7648s
	iters: 200, epoch: 19 | loss: 0.2619912
	speed: 0.2925s/iter; left time: 4930.7101s
Epoch: 19 cost time: 62.746158838272095
Epoch: 19, Steps: 208 | Train Loss: 0.403 Vali Loss: 10.157 Vali Acc: 0.084 Test Loss: 10.157 Test Acc: 0.084
Validation loss decreased (-0.080445 --> -0.084300).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3357845
	speed: 0.6945s/iter; left time: 11631.6116s
	iters: 200, epoch: 20 | loss: 0.8041226
	speed: 0.2944s/iter; left time: 4900.8661s
Epoch: 20 cost time: 61.64518451690674
Epoch: 20, Steps: 208 | Train Loss: 0.384 Vali Loss: 10.536 Vali Acc: 0.080 Test Loss: 10.536 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.7222674
	speed: 0.7029s/iter; left time: 11626.9159s
	iters: 200, epoch: 21 | loss: 0.1418197
	speed: 0.2949s/iter; left time: 4848.0502s
Epoch: 21 cost time: 61.369285583496094
Epoch: 21, Steps: 208 | Train Loss: 0.341 Vali Loss: 10.956 Vali Acc: 0.090 Test Loss: 10.956 Test Acc: 0.090
Validation loss decreased (-0.084300 --> -0.089661).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5603504
	speed: 0.7099s/iter; left time: 11595.6111s
	iters: 200, epoch: 22 | loss: 0.1108378
	speed: 0.3030s/iter; left time: 4917.9087s
Epoch: 22 cost time: 63.483731746673584
Epoch: 22, Steps: 208 | Train Loss: 0.346 Vali Loss: 10.847 Vali Acc: 0.084 Test Loss: 10.847 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.6033807
	speed: 0.7161s/iter; left time: 11547.6859s
	iters: 200, epoch: 23 | loss: 0.1975776
	speed: 0.3042s/iter; left time: 4874.0192s
Epoch: 23 cost time: 63.041011333465576
Epoch: 23, Steps: 208 | Train Loss: 0.306 Vali Loss: 11.203 Vali Acc: 0.089 Test Loss: 11.203 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.3990340
	speed: 0.6984s/iter; left time: 11115.9782s
	iters: 200, epoch: 24 | loss: 0.5140646
	speed: 0.3080s/iter; left time: 4872.3691s
Epoch: 24 cost time: 63.169928789138794
Epoch: 24, Steps: 208 | Train Loss: 0.305 Vali Loss: 11.358 Vali Acc: 0.086 Test Loss: 11.358 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0152191
	speed: 0.8019s/iter; left time: 12597.6113s
	iters: 200, epoch: 25 | loss: 0.1590983
	speed: 0.3399s/iter; left time: 5305.0293s
Epoch: 25 cost time: 71.84900069236755
Epoch: 25, Steps: 208 | Train Loss: 0.286 Vali Loss: 11.212 Vali Acc: 0.081 Test Loss: 11.212 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0258150
	speed: 0.7326s/iter; left time: 11356.2058s
	iters: 200, epoch: 26 | loss: 0.2171890
	speed: 0.2975s/iter; left time: 4581.4133s
Epoch: 26 cost time: 62.35088229179382
Epoch: 26, Steps: 208 | Train Loss: 0.260 Vali Loss: 11.812 Vali Acc: 0.080 Test Loss: 11.812 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.3548975
	speed: 0.7248s/iter; left time: 11083.7296s
	iters: 200, epoch: 27 | loss: 0.3110782
	speed: 0.2914s/iter; left time: 4427.3651s
Epoch: 27 cost time: 62.50182580947876
Epoch: 27, Steps: 208 | Train Loss: 0.237 Vali Loss: 11.985 Vali Acc: 0.081 Test Loss: 11.985 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.4915286
	speed: 0.6937s/iter; left time: 10463.8626s
	iters: 200, epoch: 28 | loss: 0.2602068
	speed: 0.2955s/iter; left time: 4428.6269s
Epoch: 28 cost time: 61.816089391708374
Epoch: 28, Steps: 208 | Train Loss: 0.255 Vali Loss: 11.870 Vali Acc: 0.088 Test Loss: 11.870 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1762639
	speed: 0.6881s/iter; left time: 10237.4042s
	iters: 200, epoch: 29 | loss: 0.2277554
	speed: 0.2891s/iter; left time: 4271.4263s
Epoch: 29 cost time: 60.421783447265625
Epoch: 29, Steps: 208 | Train Loss: 0.214 Vali Loss: 12.190 Vali Acc: 0.088 Test Loss: 12.190 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0015726
	speed: 0.6911s/iter; left time: 10137.2041s
	iters: 200, epoch: 30 | loss: 0.0946641
	speed: 0.2971s/iter; left time: 4328.7071s
Epoch: 30 cost time: 61.52830648422241
Epoch: 30, Steps: 208 | Train Loss: 0.231 Vali Loss: 12.066 Vali Acc: 0.088 Test Loss: 12.066 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.3348017
	speed: 0.6974s/iter; left time: 10085.2584s
	iters: 200, epoch: 31 | loss: 0.5312448
	speed: 0.3001s/iter; left time: 4310.1060s
Epoch: 31 cost time: 62.281108140945435
Epoch: 31, Steps: 208 | Train Loss: 0.199 Vali Loss: 12.885 Vali Acc: 0.089 Test Loss: 12.885 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08977035490605428
model parameter : 759911
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0773973
	speed: 0.3256s/iter; left time: 6740.6476s
	iters: 200, epoch: 1 | loss: 3.6940215
	speed: 0.3158s/iter; left time: 6505.0316s
Epoch: 1 cost time: 66.81867933273315
Epoch: 1, Steps: 208 | Train Loss: 3.631 Vali Loss: 3.512 Vali Acc: 0.071 Test Loss: 3.512 Test Acc: 0.071
Validation loss decreased (inf --> -0.070648).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6670518
	speed: 0.7256s/iter; left time: 14869.7426s
	iters: 200, epoch: 2 | loss: 3.0138800
	speed: 0.3214s/iter; left time: 6553.8863s
Epoch: 2 cost time: 65.19655704498291
Epoch: 2, Steps: 208 | Train Loss: 3.134 Vali Loss: 3.530 Vali Acc: 0.096 Test Loss: 3.530 Test Acc: 0.096
Validation loss decreased (-0.070648 --> -0.095998).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1747794
	speed: 0.7244s/iter; left time: 14693.8111s
	iters: 200, epoch: 3 | loss: 2.3041677
	speed: 0.3022s/iter; left time: 6099.9777s
Epoch: 3 cost time: 64.19691514968872
Epoch: 3, Steps: 208 | Train Loss: 2.623 Vali Loss: 3.772 Vali Acc: 0.096 Test Loss: 3.772 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9905257
	speed: 0.7265s/iter; left time: 14585.3926s
	iters: 200, epoch: 4 | loss: 1.9871640
	speed: 0.3107s/iter; left time: 6205.9026s
Epoch: 4 cost time: 65.3887710571289
Epoch: 4, Steps: 208 | Train Loss: 2.086 Vali Loss: 3.966 Vali Acc: 0.095 Test Loss: 3.966 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4204792
	speed: 0.7567s/iter; left time: 15034.0778s
	iters: 200, epoch: 5 | loss: 1.7528477
	speed: 0.3172s/iter; left time: 6271.2152s
Epoch: 5 cost time: 67.06362342834473
Epoch: 5, Steps: 208 | Train Loss: 1.577 Vali Loss: 4.264 Vali Acc: 0.103 Test Loss: 4.264 Test Acc: 0.103
Validation loss decreased (-0.095998 --> -0.102850).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9251158
	speed: 0.7259s/iter; left time: 14271.2233s
	iters: 200, epoch: 6 | loss: 0.9856001
	speed: 0.3093s/iter; left time: 6049.5300s
Epoch: 6 cost time: 64.85469079017639
Epoch: 6, Steps: 208 | Train Loss: 1.132 Vali Loss: 4.708 Vali Acc: 0.105 Test Loss: 4.708 Test Acc: 0.105
Validation loss decreased (-0.102850 --> -0.105232).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9432014
	speed: 0.7480s/iter; left time: 14551.0681s
	iters: 200, epoch: 7 | loss: 0.8282956
	speed: 0.3153s/iter; left time: 6101.8423s
Epoch: 7 cost time: 66.67636013031006
Epoch: 7, Steps: 208 | Train Loss: 0.833 Vali Loss: 5.513 Vali Acc: 0.097 Test Loss: 5.513 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5508165
	speed: 0.7522s/iter; left time: 14476.3997s
	iters: 200, epoch: 8 | loss: 0.7832542
	speed: 0.3190s/iter; left time: 6107.9460s
Epoch: 8 cost time: 66.51240992546082
Epoch: 8, Steps: 208 | Train Loss: 0.610 Vali Loss: 5.873 Vali Acc: 0.093 Test Loss: 5.873 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0404916
	speed: 0.7178s/iter; left time: 13664.7005s
	iters: 200, epoch: 9 | loss: 0.4000729
	speed: 0.3134s/iter; left time: 5934.7353s
Epoch: 9 cost time: 64.71738576889038
Epoch: 9, Steps: 208 | Train Loss: 0.501 Vali Loss: 6.564 Vali Acc: 0.098 Test Loss: 6.564 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3143620
	speed: 0.7330s/iter; left time: 13801.8936s
	iters: 200, epoch: 10 | loss: 0.4721645
	speed: 0.3035s/iter; left time: 5684.5102s
Epoch: 10 cost time: 63.863779067993164
Epoch: 10, Steps: 208 | Train Loss: 0.418 Vali Loss: 6.869 Vali Acc: 0.094 Test Loss: 6.869 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1003579
	speed: 0.7300s/iter; left time: 13593.2106s
	iters: 200, epoch: 11 | loss: 0.5291409
	speed: 0.3046s/iter; left time: 5641.8914s
Epoch: 11 cost time: 64.68723893165588
Epoch: 11, Steps: 208 | Train Loss: 0.348 Vali Loss: 7.159 Vali Acc: 0.094 Test Loss: 7.159 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0816193
	speed: 0.7811s/iter; left time: 14381.6212s
	iters: 200, epoch: 12 | loss: 0.3586322
	speed: 0.3330s/iter; left time: 6098.5598s
Epoch: 12 cost time: 70.25516653060913
Epoch: 12, Steps: 208 | Train Loss: 0.299 Vali Loss: 7.783 Vali Acc: 0.090 Test Loss: 7.783 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6400613
	speed: 0.7826s/iter; left time: 14246.6700s
	iters: 200, epoch: 13 | loss: 0.2248367
	speed: 0.3142s/iter; left time: 5688.5264s
Epoch: 13 cost time: 66.71042895317078
Epoch: 13, Steps: 208 | Train Loss: 0.283 Vali Loss: 7.962 Vali Acc: 0.092 Test Loss: 7.962 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0915207
	speed: 0.7467s/iter; left time: 13437.4661s
	iters: 200, epoch: 14 | loss: 0.8228644
	speed: 0.3355s/iter; left time: 6005.0185s
Epoch: 14 cost time: 69.98278594017029
Epoch: 14, Steps: 208 | Train Loss: 0.246 Vali Loss: 8.094 Vali Acc: 0.090 Test Loss: 8.094 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0849453
	speed: 0.7532s/iter; left time: 13398.8661s
	iters: 200, epoch: 15 | loss: 0.1803890
	speed: 0.3159s/iter; left time: 5588.5507s
Epoch: 15 cost time: 66.8087477684021
Epoch: 15, Steps: 208 | Train Loss: 0.235 Vali Loss: 8.277 Vali Acc: 0.090 Test Loss: 8.277 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0509047
	speed: 0.7474s/iter; left time: 13140.1215s
	iters: 200, epoch: 16 | loss: 1.3187145
	speed: 0.3257s/iter; left time: 5694.1293s
Epoch: 16 cost time: 67.54890441894531
Epoch: 16, Steps: 208 | Train Loss: 0.220 Vali Loss: 8.853 Vali Acc: 0.088 Test Loss: 8.853 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10527885475693409
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0532985
	speed: 0.3429s/iter; left time: 7098.4456s
	iters: 200, epoch: 1 | loss: 3.8428571
	speed: 0.3276s/iter; left time: 6748.8723s
Epoch: 1 cost time: 69.85205817222595
Epoch: 1, Steps: 208 | Train Loss: 3.634 Vali Loss: 3.511 Vali Acc: 0.073 Test Loss: 3.511 Test Acc: 0.073
Validation loss decreased (inf --> -0.072736).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7161057
	speed: 0.7529s/iter; left time: 15429.5697s
	iters: 200, epoch: 2 | loss: 3.1643457
	speed: 0.3080s/iter; left time: 6281.0986s
Epoch: 2 cost time: 65.85714626312256
Epoch: 2, Steps: 208 | Train Loss: 3.134 Vali Loss: 3.508 Vali Acc: 0.097 Test Loss: 3.508 Test Acc: 0.097
Validation loss decreased (-0.072736 --> -0.097191).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0753434
	speed: 0.7316s/iter; left time: 14841.3550s
	iters: 200, epoch: 3 | loss: 2.5225956
	speed: 0.3026s/iter; left time: 6107.5911s
Epoch: 3 cost time: 63.18694996833801
Epoch: 3, Steps: 208 | Train Loss: 2.620 Vali Loss: 3.776 Vali Acc: 0.092 Test Loss: 3.776 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9608262
	speed: 0.6865s/iter; left time: 13782.2052s
	iters: 200, epoch: 4 | loss: 1.9715136
	speed: 0.2866s/iter; left time: 5724.4215s
Epoch: 4 cost time: 61.01886582374573
Epoch: 4, Steps: 208 | Train Loss: 2.056 Vali Loss: 4.035 Vali Acc: 0.103 Test Loss: 4.035 Test Acc: 0.103
Validation loss decreased (-0.097191 --> -0.102554).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4159770
	speed: 0.7174s/iter; left time: 14254.7446s
	iters: 200, epoch: 5 | loss: 1.4728158
	speed: 0.3078s/iter; left time: 6085.2705s
Epoch: 5 cost time: 64.63737154006958
Epoch: 5, Steps: 208 | Train Loss: 1.548 Vali Loss: 4.330 Vali Acc: 0.096 Test Loss: 4.330 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8484379
	speed: 0.7479s/iter; left time: 14705.4367s
	iters: 200, epoch: 6 | loss: 0.7870442
	speed: 0.3104s/iter; left time: 6072.0427s
Epoch: 6 cost time: 65.94502544403076
Epoch: 6, Steps: 208 | Train Loss: 1.087 Vali Loss: 4.842 Vali Acc: 0.103 Test Loss: 4.842 Test Acc: 0.103
Validation loss decreased (-0.102554 --> -0.103441).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0548729
	speed: 0.7340s/iter; left time: 14278.6737s
	iters: 200, epoch: 7 | loss: 1.4260108
	speed: 0.2998s/iter; left time: 5802.9495s
Epoch: 7 cost time: 63.79992604255676
Epoch: 7, Steps: 208 | Train Loss: 0.782 Vali Loss: 5.485 Vali Acc: 0.093 Test Loss: 5.485 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8122459
	speed: 0.7109s/iter; left time: 13680.6149s
	iters: 200, epoch: 8 | loss: 0.7026528
	speed: 0.2978s/iter; left time: 5700.8252s
Epoch: 8 cost time: 62.03385305404663
Epoch: 8, Steps: 208 | Train Loss: 0.589 Vali Loss: 6.040 Vali Acc: 0.090 Test Loss: 6.040 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9615715
	speed: 0.7100s/iter; left time: 13516.2110s
	iters: 200, epoch: 9 | loss: 0.3453478
	speed: 0.2933s/iter; left time: 5554.3960s
Epoch: 9 cost time: 62.18251347541809
Epoch: 9, Steps: 208 | Train Loss: 0.470 Vali Loss: 6.492 Vali Acc: 0.092 Test Loss: 6.492 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6743162
	speed: 0.7152s/iter; left time: 13465.7526s
	iters: 200, epoch: 10 | loss: 0.5000380
	speed: 0.3088s/iter; left time: 5783.9010s
Epoch: 10 cost time: 63.707884073257446
Epoch: 10, Steps: 208 | Train Loss: 0.406 Vali Loss: 6.843 Vali Acc: 0.097 Test Loss: 6.843 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1100501
	speed: 0.7209s/iter; left time: 13424.7756s
	iters: 200, epoch: 11 | loss: 0.9466997
	speed: 0.3037s/iter; left time: 5624.2154s
Epoch: 11 cost time: 62.84536099433899
Epoch: 11, Steps: 208 | Train Loss: 0.342 Vali Loss: 7.362 Vali Acc: 0.089 Test Loss: 7.362 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1797978
	speed: 0.7044s/iter; left time: 12970.3397s
	iters: 200, epoch: 12 | loss: 0.5880756
	speed: 0.2845s/iter; left time: 5209.2750s
Epoch: 12 cost time: 60.402353286743164
Epoch: 12, Steps: 208 | Train Loss: 0.299 Vali Loss: 7.648 Vali Acc: 0.094 Test Loss: 7.648 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.8387687
	speed: 0.6964s/iter; left time: 12678.7130s
	iters: 200, epoch: 13 | loss: 0.2472111
	speed: 0.2958s/iter; left time: 5355.3231s
Epoch: 13 cost time: 62.40675640106201
Epoch: 13, Steps: 208 | Train Loss: 0.288 Vali Loss: 7.766 Vali Acc: 0.092 Test Loss: 7.766 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1510350
	speed: 0.7134s/iter; left time: 12839.7182s
	iters: 200, epoch: 14 | loss: 0.3377707
	speed: 0.2944s/iter; left time: 5268.2116s
Epoch: 14 cost time: 62.60202193260193
Epoch: 14, Steps: 208 | Train Loss: 0.223 Vali Loss: 8.310 Vali Acc: 0.088 Test Loss: 8.310 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2451478
	speed: 0.6980s/iter; left time: 12416.1492s
	iters: 200, epoch: 15 | loss: 0.2038370
	speed: 0.2905s/iter; left time: 5138.9799s
Epoch: 15 cost time: 60.904205083847046
Epoch: 15, Steps: 208 | Train Loss: 0.231 Vali Loss: 8.506 Vali Acc: 0.092 Test Loss: 8.506 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0336779
	speed: 0.6957s/iter; left time: 12230.5970s
	iters: 200, epoch: 16 | loss: 0.6817409
	speed: 0.3009s/iter; left time: 5259.8803s
Epoch: 16 cost time: 63.485026121139526
Epoch: 16, Steps: 208 | Train Loss: 0.223 Vali Loss: 8.642 Vali Acc: 0.090 Test Loss: 8.642 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10348941246644795
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9229178
	speed: 0.3233s/iter; left time: 6693.0859s
	iters: 200, epoch: 1 | loss: 3.9363191
	speed: 0.3054s/iter; left time: 6292.3076s
Epoch: 1 cost time: 65.50419735908508
Epoch: 1, Steps: 208 | Train Loss: 3.635 Vali Loss: 3.504 Vali Acc: 0.075 Test Loss: 3.504 Test Acc: 0.075
Validation loss decreased (inf --> -0.075122).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7172246
	speed: 0.6814s/iter; left time: 13964.1061s
	iters: 200, epoch: 2 | loss: 3.1066780
	speed: 0.2817s/iter; left time: 5743.9386s
Epoch: 2 cost time: 59.274757862091064
Epoch: 2, Steps: 208 | Train Loss: 3.130 Vali Loss: 3.486 Vali Acc: 0.093 Test Loss: 3.486 Test Acc: 0.093
Validation loss decreased (-0.075122 --> -0.093314).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2494190
	speed: 0.7194s/iter; left time: 14592.6339s
	iters: 200, epoch: 3 | loss: 2.4930325
	speed: 0.3093s/iter; left time: 6243.2309s
Epoch: 3 cost time: 65.45974087715149
Epoch: 3, Steps: 208 | Train Loss: 2.617 Vali Loss: 3.741 Vali Acc: 0.093 Test Loss: 3.741 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0771787
	speed: 0.7515s/iter; left time: 15088.8580s
	iters: 200, epoch: 4 | loss: 1.8964192
	speed: 0.3194s/iter; left time: 6380.9570s
Epoch: 4 cost time: 67.62320232391357
Epoch: 4, Steps: 208 | Train Loss: 2.071 Vali Loss: 4.001 Vali Acc: 0.097 Test Loss: 4.001 Test Acc: 0.097
Validation loss decreased (-0.093314 --> -0.096590).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6843313
	speed: 0.7566s/iter; left time: 15032.0491s
	iters: 200, epoch: 5 | loss: 1.5980797
	speed: 0.3249s/iter; left time: 6422.8016s
Epoch: 5 cost time: 68.30666017532349
Epoch: 5, Steps: 208 | Train Loss: 1.594 Vali Loss: 4.302 Vali Acc: 0.103 Test Loss: 4.302 Test Acc: 0.103
Validation loss decreased (-0.096590 --> -0.102552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8418203
	speed: 0.7552s/iter; left time: 14847.2676s
	iters: 200, epoch: 6 | loss: 0.8155977
	speed: 0.3217s/iter; left time: 6293.0590s
Epoch: 6 cost time: 67.06614899635315
Epoch: 6, Steps: 208 | Train Loss: 1.150 Vali Loss: 4.757 Vali Acc: 0.096 Test Loss: 4.757 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9698516
	speed: 0.7141s/iter; left time: 13892.1934s
	iters: 200, epoch: 7 | loss: 1.8279808
	speed: 0.3029s/iter; left time: 5862.2051s
Epoch: 7 cost time: 64.27111172676086
Epoch: 7, Steps: 208 | Train Loss: 0.853 Vali Loss: 5.289 Vali Acc: 0.100 Test Loss: 5.289 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6384407
	speed: 0.7495s/iter; left time: 14425.0190s
	iters: 200, epoch: 8 | loss: 0.7955429
	speed: 0.3160s/iter; left time: 6050.1511s
Epoch: 8 cost time: 66.77048444747925
Epoch: 8, Steps: 208 | Train Loss: 0.639 Vali Loss: 6.041 Vali Acc: 0.093 Test Loss: 6.041 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6218768
	speed: 0.7492s/iter; left time: 14262.1727s
	iters: 200, epoch: 9 | loss: 0.5161667
	speed: 0.3171s/iter; left time: 6005.0623s
Epoch: 9 cost time: 65.41685843467712
Epoch: 9, Steps: 208 | Train Loss: 0.520 Vali Loss: 6.297 Vali Acc: 0.094 Test Loss: 6.297 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2736903
	speed: 0.7397s/iter; left time: 13927.5857s
	iters: 200, epoch: 10 | loss: 0.5281515
	speed: 0.3171s/iter; left time: 5939.6529s
Epoch: 10 cost time: 66.1314651966095
Epoch: 10, Steps: 208 | Train Loss: 0.436 Vali Loss: 6.714 Vali Acc: 0.094 Test Loss: 6.714 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0677973
	speed: 0.7775s/iter; left time: 14477.5236s
	iters: 200, epoch: 11 | loss: 1.0318660
	speed: 0.3226s/iter; left time: 5975.1221s
Epoch: 11 cost time: 68.27374815940857
Epoch: 11, Steps: 208 | Train Loss: 0.367 Vali Loss: 7.120 Vali Acc: 0.094 Test Loss: 7.120 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0788660
	speed: 0.7098s/iter; left time: 13068.8102s
	iters: 200, epoch: 12 | loss: 0.3568438
	speed: 0.2954s/iter; left time: 5410.3653s
Epoch: 12 cost time: 61.73404312133789
Epoch: 12, Steps: 208 | Train Loss: 0.319 Vali Loss: 7.646 Vali Acc: 0.091 Test Loss: 7.646 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.4817845
	speed: 0.7083s/iter; left time: 12894.2401s
	iters: 200, epoch: 13 | loss: 0.5547646
	speed: 0.3205s/iter; left time: 5802.9721s
Epoch: 13 cost time: 65.80549049377441
Epoch: 13, Steps: 208 | Train Loss: 0.315 Vali Loss: 7.769 Vali Acc: 0.093 Test Loss: 7.769 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3396102
	speed: 0.7590s/iter; left time: 13660.3886s
	iters: 200, epoch: 14 | loss: 0.2565589
	speed: 0.3304s/iter; left time: 5913.1749s
Epoch: 14 cost time: 69.24113726615906
Epoch: 14, Steps: 208 | Train Loss: 0.214 Vali Loss: 8.046 Vali Acc: 0.104 Test Loss: 8.046 Test Acc: 0.104
Validation loss decreased (-0.102552 --> -0.104304).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3016927
	speed: 0.7818s/iter; left time: 13907.8253s
	iters: 200, epoch: 15 | loss: 0.3447239
	speed: 0.3363s/iter; left time: 5948.8801s
Epoch: 15 cost time: 70.6410140991211
Epoch: 15, Steps: 208 | Train Loss: 0.235 Vali Loss: 8.437 Vali Acc: 0.103 Test Loss: 8.437 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3815543
	speed: 0.7482s/iter; left time: 13153.7494s
	iters: 200, epoch: 16 | loss: 0.4845549
	speed: 0.3103s/iter; left time: 5424.0918s
Epoch: 16 cost time: 65.23486137390137
Epoch: 16, Steps: 208 | Train Loss: 0.215 Vali Loss: 8.649 Vali Acc: 0.101 Test Loss: 8.649 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1054411
	speed: 0.7290s/iter; left time: 12665.1452s
	iters: 200, epoch: 17 | loss: 0.2043811
	speed: 0.3201s/iter; left time: 5528.5981s
Epoch: 17 cost time: 66.50541114807129
Epoch: 17, Steps: 208 | Train Loss: 0.233 Vali Loss: 9.372 Vali Acc: 0.094 Test Loss: 9.372 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3061929
	speed: 0.7794s/iter; left time: 13377.9022s
	iters: 200, epoch: 18 | loss: 0.0796767
	speed: 0.3463s/iter; left time: 5909.1189s
Epoch: 18 cost time: 71.82410550117493
Epoch: 18, Steps: 208 | Train Loss: 0.205 Vali Loss: 8.886 Vali Acc: 0.102 Test Loss: 8.886 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.9750517
	speed: 0.7865s/iter; left time: 13336.2438s
	iters: 200, epoch: 19 | loss: 0.3075356
	speed: 0.3258s/iter; left time: 5492.3053s
Epoch: 19 cost time: 68.49236631393433
Epoch: 19, Steps: 208 | Train Loss: 0.202 Vali Loss: 9.378 Vali Acc: 0.094 Test Loss: 9.378 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0249267
	speed: 0.7480s/iter; left time: 12527.7123s
	iters: 200, epoch: 20 | loss: 0.0335659
	speed: 0.3115s/iter; left time: 5186.4998s
Epoch: 20 cost time: 67.15340185165405
Epoch: 20, Steps: 208 | Train Loss: 0.167 Vali Loss: 9.573 Vali Acc: 0.099 Test Loss: 9.573 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0450392
	speed: 0.7669s/iter; left time: 12684.8890s
	iters: 200, epoch: 21 | loss: 0.1688329
	speed: 0.3259s/iter; left time: 5357.7322s
Epoch: 21 cost time: 67.6164801120758
Epoch: 21, Steps: 208 | Train Loss: 0.156 Vali Loss: 9.552 Vali Acc: 0.098 Test Loss: 9.552 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1436728
	speed: 0.7486s/iter; left time: 12226.8337s
	iters: 200, epoch: 22 | loss: 0.0624313
	speed: 0.3338s/iter; left time: 5419.1074s
Epoch: 22 cost time: 67.73731398582458
Epoch: 22, Steps: 208 | Train Loss: 0.171 Vali Loss: 9.820 Vali Acc: 0.092 Test Loss: 9.820 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1049452
	speed: 0.7897s/iter; left time: 12733.6497s
	iters: 200, epoch: 23 | loss: 0.0608099
	speed: 0.3347s/iter; left time: 5363.9031s
Epoch: 23 cost time: 69.7987892627716
Epoch: 23, Steps: 208 | Train Loss: 0.163 Vali Loss: 9.991 Vali Acc: 0.092 Test Loss: 9.991 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1147384
	speed: 0.7406s/iter; left time: 11788.4660s
	iters: 200, epoch: 24 | loss: 0.0069762
	speed: 0.3182s/iter; left time: 5032.8158s
Epoch: 24 cost time: 66.65256381034851
Epoch: 24, Steps: 208 | Train Loss: 0.141 Vali Loss: 10.268 Vali Acc: 0.093 Test Loss: 10.268 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10438413361169102
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8994169
	speed: 0.3245s/iter; left time: 6716.6586s
	iters: 200, epoch: 1 | loss: 3.8054309
	speed: 0.3121s/iter; left time: 6430.1362s
Epoch: 1 cost time: 66.40431094169617
Epoch: 1, Steps: 208 | Train Loss: 3.647 Vali Loss: 3.518 Vali Acc: 0.073 Test Loss: 3.518 Test Acc: 0.073
Validation loss decreased (inf --> -0.073332).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8359792
	speed: 0.7712s/iter; left time: 15804.6835s
	iters: 200, epoch: 2 | loss: 3.1539490
	speed: 0.3408s/iter; left time: 6949.9116s
Epoch: 2 cost time: 71.23795104026794
Epoch: 2, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.467 Vali Acc: 0.106 Test Loss: 3.467 Test Acc: 0.106
Validation loss decreased (-0.073332 --> -0.105841).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2477312
	speed: 0.8134s/iter; left time: 16500.0637s
	iters: 200, epoch: 3 | loss: 2.4073491
	speed: 0.3411s/iter; left time: 6885.3807s
Epoch: 3 cost time: 71.5947117805481
Epoch: 3, Steps: 208 | Train Loss: 2.641 Vali Loss: 3.725 Vali Acc: 0.095 Test Loss: 3.725 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9176348
	speed: 0.7962s/iter; left time: 15986.0468s
	iters: 200, epoch: 4 | loss: 2.2724538
	speed: 0.3358s/iter; left time: 6708.3047s
Epoch: 4 cost time: 71.69808721542358
Epoch: 4, Steps: 208 | Train Loss: 2.088 Vali Loss: 3.919 Vali Acc: 0.099 Test Loss: 3.919 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5939173
	speed: 0.7939s/iter; left time: 15773.6211s
	iters: 200, epoch: 5 | loss: 1.5649114
	speed: 0.3307s/iter; left time: 6537.9638s
Epoch: 5 cost time: 70.2305212020874
Epoch: 5, Steps: 208 | Train Loss: 1.584 Vali Loss: 4.303 Vali Acc: 0.102 Test Loss: 4.303 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0911903
	speed: 0.7975s/iter; left time: 15680.0099s
	iters: 200, epoch: 6 | loss: 0.8095142
	speed: 0.3478s/iter; left time: 6803.6506s
Epoch: 6 cost time: 72.09431529045105
Epoch: 6, Steps: 208 | Train Loss: 1.133 Vali Loss: 4.759 Vali Acc: 0.103 Test Loss: 4.759 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.1018713
	speed: 0.7940s/iter; left time: 15446.1287s
	iters: 200, epoch: 7 | loss: 1.3637908
	speed: 0.3221s/iter; left time: 6233.4124s
Epoch: 7 cost time: 67.6276273727417
Epoch: 7, Steps: 208 | Train Loss: 0.839 Vali Loss: 5.377 Vali Acc: 0.100 Test Loss: 5.377 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7274695
	speed: 0.7493s/iter; left time: 14421.0414s
	iters: 200, epoch: 8 | loss: 0.5080149
	speed: 0.3153s/iter; left time: 6035.6706s
Epoch: 8 cost time: 67.57762789726257
Epoch: 8, Steps: 208 | Train Loss: 0.622 Vali Loss: 5.827 Vali Acc: 0.098 Test Loss: 5.827 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.9220010
	speed: 0.7247s/iter; left time: 13795.8926s
	iters: 200, epoch: 9 | loss: 0.2960076
	speed: 0.3188s/iter; left time: 6036.2180s
Epoch: 9 cost time: 66.1885073184967
Epoch: 9, Steps: 208 | Train Loss: 0.493 Vali Loss: 6.393 Vali Acc: 0.098 Test Loss: 6.393 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6310286
	speed: 0.7224s/iter; left time: 13601.7257s
	iters: 200, epoch: 10 | loss: 0.5503926
	speed: 0.2843s/iter; left time: 5324.3030s
Epoch: 10 cost time: 62.21896839141846
Epoch: 10, Steps: 208 | Train Loss: 0.424 Vali Loss: 6.554 Vali Acc: 0.102 Test Loss: 6.554 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0946923
	speed: 0.6909s/iter; left time: 12865.5745s
	iters: 200, epoch: 11 | loss: 1.0348191
	speed: 0.3075s/iter; left time: 5694.3263s
Epoch: 11 cost time: 64.17526340484619
Epoch: 11, Steps: 208 | Train Loss: 0.377 Vali Loss: 6.958 Vali Acc: 0.092 Test Loss: 6.958 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1956311
	speed: 0.7244s/iter; left time: 13339.1117s
	iters: 200, epoch: 12 | loss: 0.3501132
	speed: 0.3152s/iter; left time: 5772.4280s
Epoch: 12 cost time: 66.27178168296814
Epoch: 12, Steps: 208 | Train Loss: 0.328 Vali Loss: 7.342 Vali Acc: 0.098 Test Loss: 7.342 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10587533552042946
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9136143
	speed: 0.3048s/iter; left time: 6308.7219s
	iters: 200, epoch: 1 | loss: 3.7221818
	speed: 0.2940s/iter; left time: 6056.3255s
Epoch: 1 cost time: 62.48502707481384
Epoch: 1, Steps: 208 | Train Loss: 3.621 Vali Loss: 3.533 Vali Acc: 0.067 Test Loss: 3.533 Test Acc: 0.067
Validation loss decreased (inf --> -0.066472).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9796002
	speed: 0.7211s/iter; left time: 14777.4308s
	iters: 200, epoch: 2 | loss: 3.3481402
	speed: 0.3149s/iter; left time: 6420.8407s
Epoch: 2 cost time: 66.76467514038086
Epoch: 2, Steps: 208 | Train Loss: 3.152 Vali Loss: 3.518 Vali Acc: 0.086 Test Loss: 3.518 Test Acc: 0.086
Validation loss decreased (-0.066472 --> -0.085560).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7578597
	speed: 0.7334s/iter; left time: 14877.1518s
	iters: 200, epoch: 3 | loss: 2.6924679
	speed: 0.3074s/iter; left time: 6205.2140s
Epoch: 3 cost time: 64.86121606826782
Epoch: 3, Steps: 208 | Train Loss: 2.654 Vali Loss: 3.686 Vali Acc: 0.099 Test Loss: 3.686 Test Acc: 0.099
Validation loss decreased (-0.085560 --> -0.098979).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2770369
	speed: 0.7245s/iter; left time: 14546.2529s
	iters: 200, epoch: 4 | loss: 2.2299075
	speed: 0.2903s/iter; left time: 5799.9036s
Epoch: 4 cost time: 62.57543396949768
Epoch: 4, Steps: 208 | Train Loss: 2.108 Vali Loss: 3.987 Vali Acc: 0.099 Test Loss: 3.987 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5925680
	speed: 0.7182s/iter; left time: 14270.8506s
	iters: 200, epoch: 5 | loss: 1.4086192
	speed: 0.2928s/iter; left time: 5787.7601s
Epoch: 5 cost time: 62.110427141189575
Epoch: 5, Steps: 208 | Train Loss: 1.632 Vali Loss: 4.251 Vali Acc: 0.088 Test Loss: 4.251 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2295095
	speed: 0.6962s/iter; left time: 13688.7344s
	iters: 200, epoch: 6 | loss: 1.1053560
	speed: 0.3006s/iter; left time: 5880.0186s
Epoch: 6 cost time: 63.157052516937256
Epoch: 6, Steps: 208 | Train Loss: 1.169 Vali Loss: 4.665 Vali Acc: 0.103 Test Loss: 4.665 Test Acc: 0.103
Validation loss decreased (-0.098979 --> -0.102846).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4404808
	speed: 0.7713s/iter; left time: 15003.5331s
	iters: 200, epoch: 7 | loss: 0.9420763
	speed: 0.3115s/iter; left time: 6027.6292s
Epoch: 7 cost time: 66.90459704399109
Epoch: 7, Steps: 208 | Train Loss: 0.868 Vali Loss: 5.276 Vali Acc: 0.096 Test Loss: 5.276 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5200823
	speed: 0.7322s/iter; left time: 14090.3493s
	iters: 200, epoch: 8 | loss: 0.6784298
	speed: 0.2964s/iter; left time: 5673.6654s
Epoch: 8 cost time: 63.326355934143066
Epoch: 8, Steps: 208 | Train Loss: 0.680 Vali Loss: 5.711 Vali Acc: 0.098 Test Loss: 5.711 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7596205
	speed: 0.7003s/iter; left time: 13331.3870s
	iters: 200, epoch: 9 | loss: 0.6358525
	speed: 0.2908s/iter; left time: 5506.6436s
Epoch: 9 cost time: 60.816431283950806
Epoch: 9, Steps: 208 | Train Loss: 0.542 Vali Loss: 6.142 Vali Acc: 0.109 Test Loss: 6.142 Test Acc: 0.109
Validation loss decreased (-0.102846 --> -0.109095).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2992091
	speed: 0.6960s/iter; left time: 13105.6650s
	iters: 200, epoch: 10 | loss: 0.2204125
	speed: 0.2832s/iter; left time: 5303.6405s
Epoch: 10 cost time: 60.429558992385864
Epoch: 10, Steps: 208 | Train Loss: 0.449 Vali Loss: 6.482 Vali Acc: 0.105 Test Loss: 6.482 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2256870
	speed: 0.7022s/iter; left time: 13075.1910s
	iters: 200, epoch: 11 | loss: 1.1896287
	speed: 0.2928s/iter; left time: 5423.3305s
Epoch: 11 cost time: 61.97172141075134
Epoch: 11, Steps: 208 | Train Loss: 0.402 Vali Loss: 6.944 Vali Acc: 0.103 Test Loss: 6.944 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1290463
	speed: 0.6877s/iter; left time: 12662.3671s
	iters: 200, epoch: 12 | loss: 0.4057852
	speed: 0.2822s/iter; left time: 5167.2630s
Epoch: 12 cost time: 59.98593854904175
Epoch: 12, Steps: 208 | Train Loss: 0.339 Vali Loss: 7.365 Vali Acc: 0.103 Test Loss: 7.365 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5803833
	speed: 0.6905s/iter; left time: 12570.3706s
	iters: 200, epoch: 13 | loss: 0.3504502
	speed: 0.2900s/iter; left time: 5250.1836s
Epoch: 13 cost time: 62.03657031059265
Epoch: 13, Steps: 208 | Train Loss: 0.322 Vali Loss: 8.024 Vali Acc: 0.097 Test Loss: 8.024 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0239884
	speed: 0.6863s/iter; left time: 12351.2225s
	iters: 200, epoch: 14 | loss: 0.2888293
	speed: 0.2870s/iter; left time: 5136.0623s
Epoch: 14 cost time: 60.91053295135498
Epoch: 14, Steps: 208 | Train Loss: 0.273 Vali Loss: 7.981 Vali Acc: 0.103 Test Loss: 7.981 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4175969
	speed: 0.6807s/iter; left time: 12109.8533s
	iters: 200, epoch: 15 | loss: 0.1766186
	speed: 0.2880s/iter; left time: 5094.5173s
Epoch: 15 cost time: 60.58211302757263
Epoch: 15, Steps: 208 | Train Loss: 0.230 Vali Loss: 8.362 Vali Acc: 0.096 Test Loss: 8.362 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0999569
	speed: 0.6450s/iter; left time: 11340.0765s
	iters: 200, epoch: 16 | loss: 0.1256665
	speed: 0.2857s/iter; left time: 4993.4530s
Epoch: 16 cost time: 59.02778887748718
Epoch: 16, Steps: 208 | Train Loss: 0.254 Vali Loss: 8.550 Vali Acc: 0.097 Test Loss: 8.550 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2477026
	speed: 0.7079s/iter; left time: 12298.8465s
	iters: 200, epoch: 17 | loss: 0.3504588
	speed: 0.3005s/iter; left time: 5190.0349s
Epoch: 17 cost time: 62.375388383865356
Epoch: 17, Steps: 208 | Train Loss: 0.217 Vali Loss: 8.662 Vali Acc: 0.096 Test Loss: 8.662 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2095716
	speed: 0.7000s/iter; left time: 12014.7436s
	iters: 200, epoch: 18 | loss: 0.0929803
	speed: 0.2766s/iter; left time: 4719.3819s
Epoch: 18 cost time: 60.040703535079956
Epoch: 18, Steps: 208 | Train Loss: 0.222 Vali Loss: 8.740 Vali Acc: 0.092 Test Loss: 8.740 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9086375
	speed: 0.6910s/iter; left time: 11717.6045s
	iters: 200, epoch: 19 | loss: 0.4198233
	speed: 0.2920s/iter; left time: 4921.7623s
Epoch: 19 cost time: 62.06304907798767
Epoch: 19, Steps: 208 | Train Loss: 0.205 Vali Loss: 9.279 Vali Acc: 0.097 Test Loss: 9.279 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10915597971965404
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9960697
	speed: 0.3135s/iter; left time: 6489.4170s
	iters: 200, epoch: 1 | loss: 3.5968404
	speed: 0.3048s/iter; left time: 6280.1379s
Epoch: 1 cost time: 64.62676453590393
Epoch: 1, Steps: 208 | Train Loss: 3.606 Vali Loss: 3.551 Vali Acc: 0.066 Test Loss: 3.551 Test Acc: 0.066
Validation loss decreased (inf --> -0.066174).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9613070
	speed: 0.7361s/iter; left time: 15084.0360s
	iters: 200, epoch: 2 | loss: 3.1186583
	speed: 0.3234s/iter; left time: 6594.7245s
Epoch: 2 cost time: 67.09360957145691
Epoch: 2, Steps: 208 | Train Loss: 3.091 Vali Loss: 3.544 Vali Acc: 0.087 Test Loss: 3.544 Test Acc: 0.087
Validation loss decreased (-0.066174 --> -0.087349).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1307995
	speed: 0.7324s/iter; left time: 14856.7897s
	iters: 200, epoch: 3 | loss: 2.8158369
	speed: 0.3056s/iter; left time: 6169.0008s
Epoch: 3 cost time: 64.68612051010132
Epoch: 3, Steps: 208 | Train Loss: 2.679 Vali Loss: 3.774 Vali Acc: 0.085 Test Loss: 3.774 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6400630
	speed: 0.7088s/iter; left time: 14231.4478s
	iters: 200, epoch: 4 | loss: 2.1152768
	speed: 0.3098s/iter; left time: 6188.7131s
Epoch: 4 cost time: 64.94689202308655
Epoch: 4, Steps: 208 | Train Loss: 2.262 Vali Loss: 3.945 Vali Acc: 0.099 Test Loss: 3.945 Test Acc: 0.099
Validation loss decreased (-0.087349 --> -0.099275).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8868593
	speed: 0.7337s/iter; left time: 14576.9350s
	iters: 200, epoch: 5 | loss: 1.6261948
	speed: 0.3019s/iter; left time: 5968.2604s
Epoch: 5 cost time: 64.9509437084198
Epoch: 5, Steps: 208 | Train Loss: 1.836 Vali Loss: 4.161 Vali Acc: 0.093 Test Loss: 4.161 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3219764
	speed: 0.7149s/iter; left time: 14055.9848s
	iters: 200, epoch: 6 | loss: 1.1017152
	speed: 0.3068s/iter; left time: 6001.0945s
Epoch: 6 cost time: 64.12685418128967
Epoch: 6, Steps: 208 | Train Loss: 1.435 Vali Loss: 4.726 Vali Acc: 0.095 Test Loss: 4.726 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8027949
	speed: 0.7174s/iter; left time: 13955.3832s
	iters: 200, epoch: 7 | loss: 1.7038587
	speed: 0.3071s/iter; left time: 5943.0066s
Epoch: 7 cost time: 64.04177761077881
Epoch: 7, Steps: 208 | Train Loss: 1.126 Vali Loss: 5.023 Vali Acc: 0.108 Test Loss: 5.023 Test Acc: 0.108
Validation loss decreased (-0.099275 --> -0.107913).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0226529
	speed: 0.7036s/iter; left time: 13540.3255s
	iters: 200, epoch: 8 | loss: 0.7232090
	speed: 0.3015s/iter; left time: 5772.7380s
Epoch: 8 cost time: 63.968223571777344
Epoch: 8, Steps: 208 | Train Loss: 0.905 Vali Loss: 5.592 Vali Acc: 0.082 Test Loss: 5.592 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8067960
	speed: 0.7150s/iter; left time: 13611.6718s
	iters: 200, epoch: 9 | loss: 0.9541233
	speed: 0.3020s/iter; left time: 5719.2692s
Epoch: 9 cost time: 63.563743114471436
Epoch: 9, Steps: 208 | Train Loss: 0.734 Vali Loss: 5.953 Vali Acc: 0.095 Test Loss: 5.953 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4838692
	speed: 0.6964s/iter; left time: 13111.7182s
	iters: 200, epoch: 10 | loss: 0.6371142
	speed: 0.3114s/iter; left time: 5832.3167s
Epoch: 10 cost time: 65.6379942893982
Epoch: 10, Steps: 208 | Train Loss: 0.655 Vali Loss: 6.283 Vali Acc: 0.094 Test Loss: 6.283 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1637592
	speed: 0.7500s/iter; left time: 13965.4074s
	iters: 200, epoch: 11 | loss: 1.0934807
	speed: 0.3242s/iter; left time: 6004.4335s
Epoch: 11 cost time: 68.38310670852661
Epoch: 11, Steps: 208 | Train Loss: 0.556 Vali Loss: 6.404 Vali Acc: 0.106 Test Loss: 6.404 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2548659
	speed: 0.7462s/iter; left time: 13740.3457s
	iters: 200, epoch: 12 | loss: 0.7731311
	speed: 0.3050s/iter; left time: 5585.0041s
Epoch: 12 cost time: 65.93278932571411
Epoch: 12, Steps: 208 | Train Loss: 0.485 Vali Loss: 6.785 Vali Acc: 0.099 Test Loss: 6.785 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2691055
	speed: 0.6932s/iter; left time: 12618.8777s
	iters: 200, epoch: 13 | loss: 1.3706182
	speed: 0.3142s/iter; left time: 5688.4085s
Epoch: 13 cost time: 63.594085931777954
Epoch: 13, Steps: 208 | Train Loss: 0.453 Vali Loss: 7.003 Vali Acc: 0.096 Test Loss: 7.003 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1945898
	speed: 0.6855s/iter; left time: 12337.2699s
	iters: 200, epoch: 14 | loss: 0.7308184
	speed: 0.2905s/iter; left time: 5199.0996s
Epoch: 14 cost time: 61.05600070953369
Epoch: 14, Steps: 208 | Train Loss: 0.390 Vali Loss: 7.290 Vali Acc: 0.098 Test Loss: 7.290 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2182042
	speed: 0.7119s/iter; left time: 12663.1135s
	iters: 200, epoch: 15 | loss: 0.3084731
	speed: 0.3052s/iter; left time: 5399.2863s
Epoch: 15 cost time: 64.71955633163452
Epoch: 15, Steps: 208 | Train Loss: 0.357 Vali Loss: 7.687 Vali Acc: 0.095 Test Loss: 7.687 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1547720
	speed: 0.6959s/iter; left time: 12234.7941s
	iters: 200, epoch: 16 | loss: 0.2708888
	speed: 0.2869s/iter; left time: 5015.6134s
Epoch: 16 cost time: 59.98960280418396
Epoch: 16, Steps: 208 | Train Loss: 0.337 Vali Loss: 7.842 Vali Acc: 0.096 Test Loss: 7.842 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5036130
	speed: 0.6854s/iter; left time: 11907.0583s
	iters: 200, epoch: 17 | loss: 0.8419357
	speed: 0.2984s/iter; left time: 5153.8374s
Epoch: 17 cost time: 62.79641103744507
Epoch: 17, Steps: 208 | Train Loss: 0.307 Vali Loss: 7.971 Vali Acc: 0.106 Test Loss: 7.971 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10796301819266328
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9862130
	speed: 0.3010s/iter; left time: 6231.4803s
	iters: 200, epoch: 1 | loss: 3.7387538
	speed: 0.2893s/iter; left time: 5958.8403s
Epoch: 1 cost time: 61.49512052536011
Epoch: 1, Steps: 208 | Train Loss: 3.637 Vali Loss: 3.622 Vali Acc: 0.061 Test Loss: 3.622 Test Acc: 0.061
Validation loss decreased (inf --> -0.061103).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1488030
	speed: 0.6849s/iter; left time: 14036.5258s
	iters: 200, epoch: 2 | loss: 3.0025988
	speed: 0.2818s/iter; left time: 5745.7714s
Epoch: 2 cost time: 60.189428091049194
Epoch: 2, Steps: 208 | Train Loss: 3.220 Vali Loss: 3.650 Vali Acc: 0.082 Test Loss: 3.650 Test Acc: 0.082
Validation loss decreased (-0.061103 --> -0.081681).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6004210
	speed: 0.6970s/iter; left time: 14138.5925s
	iters: 200, epoch: 3 | loss: 2.5821762
	speed: 0.2985s/iter; left time: 6024.4418s
Epoch: 3 cost time: 62.227394580841064
Epoch: 3, Steps: 208 | Train Loss: 2.907 Vali Loss: 3.861 Vali Acc: 0.071 Test Loss: 3.861 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.0444312
	speed: 0.7232s/iter; left time: 14520.2915s
	iters: 200, epoch: 4 | loss: 2.6851759
	speed: 0.3236s/iter; left time: 6464.0449s
Epoch: 4 cost time: 66.48947358131409
Epoch: 4, Steps: 208 | Train Loss: 2.598 Vali Loss: 3.918 Vali Acc: 0.077 Test Loss: 3.918 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.9002950
	speed: 0.7290s/iter; left time: 14485.3677s
	iters: 200, epoch: 5 | loss: 2.0900269
	speed: 0.2784s/iter; left time: 5503.2611s
Epoch: 5 cost time: 59.5033438205719
Epoch: 5, Steps: 208 | Train Loss: 2.268 Vali Loss: 4.165 Vali Acc: 0.084 Test Loss: 4.165 Test Acc: 0.084
Validation loss decreased (-0.081681 --> -0.083466).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9911083
	speed: 0.6919s/iter; left time: 13603.2470s
	iters: 200, epoch: 6 | loss: 1.6191342
	speed: 0.2865s/iter; left time: 5604.5242s
Epoch: 6 cost time: 61.176480531692505
Epoch: 6, Steps: 208 | Train Loss: 1.950 Vali Loss: 4.397 Vali Acc: 0.086 Test Loss: 4.397 Test Acc: 0.086
Validation loss decreased (-0.083466 --> -0.086446).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3658376
	speed: 0.6962s/iter; left time: 13543.7394s
	iters: 200, epoch: 7 | loss: 2.1848288
	speed: 0.2976s/iter; left time: 5758.9713s
Epoch: 7 cost time: 62.56431555747986
Epoch: 7, Steps: 208 | Train Loss: 1.617 Vali Loss: 4.747 Vali Acc: 0.084 Test Loss: 4.747 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6673576
	speed: 0.7226s/iter; left time: 13906.2215s
	iters: 200, epoch: 8 | loss: 1.1569606
	speed: 0.3138s/iter; left time: 6006.7512s
Epoch: 8 cost time: 65.08728742599487
Epoch: 8, Steps: 208 | Train Loss: 1.327 Vali Loss: 5.056 Vali Acc: 0.081 Test Loss: 5.056 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1051657
	speed: 0.7283s/iter; left time: 13864.7209s
	iters: 200, epoch: 9 | loss: 1.1451137
	speed: 0.2900s/iter; left time: 5492.2279s
Epoch: 9 cost time: 61.65856623649597
Epoch: 9, Steps: 208 | Train Loss: 1.090 Vali Loss: 5.246 Vali Acc: 0.101 Test Loss: 5.246 Test Acc: 0.101
Validation loss decreased (-0.086446 --> -0.100455).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7707116
	speed: 0.7004s/iter; left time: 13188.6694s
	iters: 200, epoch: 10 | loss: 0.6400554
	speed: 0.2969s/iter; left time: 5561.2668s
Epoch: 10 cost time: 62.542250633239746
Epoch: 10, Steps: 208 | Train Loss: 0.893 Vali Loss: 5.927 Vali Acc: 0.090 Test Loss: 5.927 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5935847
	speed: 0.7063s/iter; left time: 13152.3432s
	iters: 200, epoch: 11 | loss: 1.2635075
	speed: 0.3095s/iter; left time: 5731.4578s
Epoch: 11 cost time: 64.37812161445618
Epoch: 11, Steps: 208 | Train Loss: 0.802 Vali Loss: 6.070 Vali Acc: 0.086 Test Loss: 6.070 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4046016
	speed: 0.7472s/iter; left time: 13758.7334s
	iters: 200, epoch: 12 | loss: 0.6468546
	speed: 0.3092s/iter; left time: 5661.7700s
Epoch: 12 cost time: 66.03613996505737
Epoch: 12, Steps: 208 | Train Loss: 0.686 Vali Loss: 6.243 Vali Acc: 0.092 Test Loss: 6.243 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4072083
	speed: 0.7024s/iter; left time: 12787.1070s
	iters: 200, epoch: 13 | loss: 0.7428569
	speed: 0.2777s/iter; left time: 5028.1706s
Epoch: 13 cost time: 60.01195406913757
Epoch: 13, Steps: 208 | Train Loss: 0.579 Vali Loss: 6.674 Vali Acc: 0.103 Test Loss: 6.674 Test Acc: 0.103
Validation loss decreased (-0.100455 --> -0.102528).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7518617
	speed: 0.6419s/iter; left time: 11551.5670s
	iters: 200, epoch: 14 | loss: 1.2138152
	speed: 0.2877s/iter; left time: 5149.6060s
Epoch: 14 cost time: 59.397905588150024
Epoch: 14, Steps: 208 | Train Loss: 0.552 Vali Loss: 6.781 Vali Acc: 0.089 Test Loss: 6.781 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0972168
	speed: 0.7230s/iter; left time: 12861.0462s
	iters: 200, epoch: 15 | loss: 0.4766416
	speed: 0.3006s/iter; left time: 5317.3774s
Epoch: 15 cost time: 63.21509408950806
Epoch: 15, Steps: 208 | Train Loss: 0.497 Vali Loss: 7.368 Vali Acc: 0.093 Test Loss: 7.368 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1987163
	speed: 0.7052s/iter; left time: 12398.1921s
	iters: 200, epoch: 16 | loss: 0.7481229
	speed: 0.3100s/iter; left time: 5419.0677s
Epoch: 16 cost time: 64.48239517211914
Epoch: 16, Steps: 208 | Train Loss: 0.447 Vali Loss: 7.464 Vali Acc: 0.087 Test Loss: 7.464 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2217065
	speed: 0.6959s/iter; left time: 12090.7001s
	iters: 200, epoch: 17 | loss: 0.3676607
	speed: 0.2893s/iter; left time: 4997.2739s
Epoch: 17 cost time: 61.317047119140625
Epoch: 17, Steps: 208 | Train Loss: 0.416 Vali Loss: 8.012 Vali Acc: 0.095 Test Loss: 8.012 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5118713
	speed: 0.6559s/iter; left time: 11258.3366s
	iters: 200, epoch: 18 | loss: 0.1058822
	speed: 0.2875s/iter; left time: 4906.5728s
Epoch: 18 cost time: 58.75817155838013
Epoch: 18, Steps: 208 | Train Loss: 0.395 Vali Loss: 7.869 Vali Acc: 0.098 Test Loss: 7.869 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4823906
	speed: 0.7030s/iter; left time: 11919.9283s
	iters: 200, epoch: 19 | loss: 0.7665500
	speed: 0.2866s/iter; left time: 4831.9300s
Epoch: 19 cost time: 61.33506512641907
Epoch: 19, Steps: 208 | Train Loss: 0.358 Vali Loss: 8.028 Vali Acc: 0.109 Test Loss: 8.028 Test Acc: 0.109
Validation loss decreased (-0.102528 --> -0.108777).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0351824
	speed: 0.6478s/iter; left time: 10850.2993s
	iters: 200, epoch: 20 | loss: 0.3796795
	speed: 0.2713s/iter; left time: 4516.7147s
Epoch: 20 cost time: 56.22432518005371
Epoch: 20, Steps: 208 | Train Loss: 0.316 Vali Loss: 8.242 Vali Acc: 0.098 Test Loss: 8.242 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8564495
	speed: 0.6375s/iter; left time: 10545.0285s
	iters: 200, epoch: 21 | loss: 0.1463149
	speed: 0.2766s/iter; left time: 4547.1997s
Epoch: 21 cost time: 58.09172463417053
Epoch: 21, Steps: 208 | Train Loss: 0.293 Vali Loss: 8.634 Vali Acc: 0.101 Test Loss: 8.634 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0728239
	speed: 0.6707s/iter; left time: 10953.7864s
	iters: 200, epoch: 22 | loss: 0.7095141
	speed: 0.3008s/iter; left time: 4882.9703s
Epoch: 22 cost time: 61.59207797050476
Epoch: 22, Steps: 208 | Train Loss: 0.283 Vali Loss: 8.795 Vali Acc: 0.101 Test Loss: 8.795 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4902205
	speed: 0.7157s/iter; left time: 11540.4286s
	iters: 200, epoch: 23 | loss: 0.1104375
	speed: 0.3074s/iter; left time: 4926.0124s
Epoch: 23 cost time: 64.71056652069092
Epoch: 23, Steps: 208 | Train Loss: 0.248 Vali Loss: 9.205 Vali Acc: 0.102 Test Loss: 9.205 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4426754
	speed: 0.6978s/iter; left time: 11107.6526s
	iters: 200, epoch: 24 | loss: 0.4069319
	speed: 0.2840s/iter; left time: 4491.9822s
Epoch: 24 cost time: 61.704036712646484
Epoch: 24, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.251 Vali Acc: 0.101 Test Loss: 9.251 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3131583
	speed: 0.6679s/iter; left time: 10492.4451s
	iters: 200, epoch: 25 | loss: 0.4055125
	speed: 0.2846s/iter; left time: 4442.0822s
Epoch: 25 cost time: 60.14757561683655
Epoch: 25, Steps: 208 | Train Loss: 0.230 Vali Loss: 9.267 Vali Acc: 0.094 Test Loss: 9.267 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.5935729
	speed: 0.7599s/iter; left time: 11778.9103s
	iters: 200, epoch: 26 | loss: 0.4345272
	speed: 0.3034s/iter; left time: 4672.5295s
Epoch: 26 cost time: 65.74559020996094
Epoch: 26, Steps: 208 | Train Loss: 0.243 Vali Loss: 9.430 Vali Acc: 0.098 Test Loss: 9.430 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1451145
	speed: 0.7004s/iter; left time: 10710.5197s
	iters: 200, epoch: 27 | loss: 0.2258289
	speed: 0.3079s/iter; left time: 4677.7703s
Epoch: 27 cost time: 63.68717694282532
Epoch: 27, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.640 Vali Acc: 0.102 Test Loss: 9.640 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1939350
	speed: 0.7093s/iter; left time: 10699.4387s
	iters: 200, epoch: 28 | loss: 0.0182068
	speed: 0.3016s/iter; left time: 4519.4375s
Epoch: 28 cost time: 62.803369998931885
Epoch: 28, Steps: 208 | Train Loss: 0.202 Vali Loss: 9.606 Vali Acc: 0.099 Test Loss: 9.606 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0169459
	speed: 0.7295s/iter; left time: 10852.3909s
	iters: 200, epoch: 29 | loss: 0.4955564
	speed: 0.3291s/iter; left time: 4862.6853s
Epoch: 29 cost time: 67.44517636299133
Epoch: 29, Steps: 208 | Train Loss: 0.193 Vali Loss: 9.680 Vali Acc: 0.098 Test Loss: 9.680 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10885773933790635
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8098311
	speed: 0.3014s/iter; left time: 6239.3727s
	iters: 200, epoch: 1 | loss: 3.7493296
	speed: 0.2821s/iter; left time: 5812.0287s
Epoch: 1 cost time: 60.832271575927734
Epoch: 1, Steps: 208 | Train Loss: 3.669 Vali Loss: 3.693 Vali Acc: 0.043 Test Loss: 3.693 Test Acc: 0.043
Validation loss decreased (inf --> -0.043208).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1738007
	speed: 0.6764s/iter; left time: 13861.0230s
	iters: 200, epoch: 2 | loss: 2.9864585
	speed: 0.2962s/iter; left time: 6039.9177s
Epoch: 2 cost time: 61.64146018028259
Epoch: 2, Steps: 208 | Train Loss: 3.296 Vali Loss: 4.406 Vali Acc: 0.033 Test Loss: 4.406 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5025611
	speed: 0.7289s/iter; left time: 14785.2641s
	iters: 200, epoch: 3 | loss: 3.0562453
	speed: 0.3034s/iter; left time: 6124.9732s
Epoch: 3 cost time: 64.30155944824219
Epoch: 3, Steps: 208 | Train Loss: 3.072 Vali Loss: 4.357 Vali Acc: 0.046 Test Loss: 4.357 Test Acc: 0.046
Validation loss decreased (-0.043208 --> -0.045587).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1532257
	speed: 0.7290s/iter; left time: 14636.1486s
	iters: 200, epoch: 4 | loss: 2.9609079
	speed: 0.2873s/iter; left time: 5739.0657s
Epoch: 4 cost time: 62.62695360183716
Epoch: 4, Steps: 208 | Train Loss: 2.808 Vali Loss: 4.312 Vali Acc: 0.054 Test Loss: 4.312 Test Acc: 0.054
Validation loss decreased (-0.045587 --> -0.053938).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6561978
	speed: 0.6769s/iter; left time: 13449.0972s
	iters: 200, epoch: 5 | loss: 2.4760354
	speed: 0.2796s/iter; left time: 5527.6814s
Epoch: 5 cost time: 59.857630491256714
Epoch: 5, Steps: 208 | Train Loss: 2.542 Vali Loss: 4.450 Vali Acc: 0.054 Test Loss: 4.450 Test Acc: 0.054
Validation loss decreased (-0.053938 --> -0.054235).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1628556
	speed: 0.6940s/iter; left time: 13644.7411s
	iters: 200, epoch: 6 | loss: 2.2033665
	speed: 0.3174s/iter; left time: 6209.3451s
Epoch: 6 cost time: 64.8763689994812
Epoch: 6, Steps: 208 | Train Loss: 2.277 Vali Loss: 4.719 Vali Acc: 0.057 Test Loss: 4.719 Test Acc: 0.057
Validation loss decreased (-0.054235 --> -0.056618).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5218585
	speed: 0.7365s/iter; left time: 14326.9091s
	iters: 200, epoch: 7 | loss: 2.7618973
	speed: 0.2714s/iter; left time: 5252.3738s
Epoch: 7 cost time: 60.03649091720581
Epoch: 7, Steps: 208 | Train Loss: 1.987 Vali Loss: 4.931 Vali Acc: 0.066 Test Loss: 4.931 Test Acc: 0.066
Validation loss decreased (-0.056618 --> -0.065862).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5442510
	speed: 0.6380s/iter; left time: 12278.7971s
	iters: 200, epoch: 8 | loss: 2.0883541
	speed: 0.2800s/iter; left time: 5359.7820s
Epoch: 8 cost time: 57.68076801300049
Epoch: 8, Steps: 208 | Train Loss: 1.757 Vali Loss: 5.129 Vali Acc: 0.064 Test Loss: 5.129 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6678319
	speed: 0.6735s/iter; left time: 12821.8338s
	iters: 200, epoch: 9 | loss: 1.8742170
	speed: 0.2879s/iter; left time: 5451.4700s
Epoch: 9 cost time: 60.14283084869385
Epoch: 9, Steps: 208 | Train Loss: 1.481 Vali Loss: 5.372 Vali Acc: 0.069 Test Loss: 5.372 Test Acc: 0.069
Validation loss decreased (-0.065862 --> -0.068840).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2973057
	speed: 0.6891s/iter; left time: 12975.3656s
	iters: 200, epoch: 10 | loss: 1.6592903
	speed: 0.2992s/iter; left time: 5603.4841s
Epoch: 10 cost time: 61.69813084602356
Epoch: 10, Steps: 208 | Train Loss: 1.207 Vali Loss: 5.789 Vali Acc: 0.070 Test Loss: 5.789 Test Acc: 0.070
Validation loss decreased (-0.068840 --> -0.070029).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3690469
	speed: 0.7594s/iter; left time: 14140.5808s
	iters: 200, epoch: 11 | loss: 1.1156226
	speed: 0.3002s/iter; left time: 5560.6058s
Epoch: 11 cost time: 65.50128960609436
Epoch: 11, Steps: 208 | Train Loss: 1.048 Vali Loss: 6.161 Vali Acc: 0.064 Test Loss: 6.161 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2290972
	speed: 0.7274s/iter; left time: 13393.1855s
	iters: 200, epoch: 12 | loss: 1.2308255
	speed: 0.3001s/iter; left time: 5495.8932s
Epoch: 12 cost time: 64.23237919807434
Epoch: 12, Steps: 208 | Train Loss: 0.871 Vali Loss: 6.347 Vali Acc: 0.065 Test Loss: 6.347 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5972575
	speed: 0.7354s/iter; left time: 13388.0732s
	iters: 200, epoch: 13 | loss: 1.2685996
	speed: 0.3201s/iter; left time: 5795.5567s
Epoch: 13 cost time: 67.17295789718628
Epoch: 13, Steps: 208 | Train Loss: 0.766 Vali Loss: 6.745 Vali Acc: 0.074 Test Loss: 6.745 Test Acc: 0.074
Validation loss decreased (-0.070029 --> -0.073896).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9032081
	speed: 0.7634s/iter; left time: 13738.3192s
	iters: 200, epoch: 14 | loss: 2.1683815
	speed: 0.3091s/iter; left time: 5532.5312s
Epoch: 14 cost time: 65.93176984786987
Epoch: 14, Steps: 208 | Train Loss: 0.665 Vali Loss: 7.089 Vali Acc: 0.077 Test Loss: 7.089 Test Acc: 0.077
Validation loss decreased (-0.073896 --> -0.076875).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3040703
	speed: 0.7362s/iter; left time: 13096.3693s
	iters: 200, epoch: 15 | loss: 0.6623008
	speed: 0.3117s/iter; left time: 5512.8458s
Epoch: 15 cost time: 65.19997191429138
Epoch: 15, Steps: 208 | Train Loss: 0.554 Vali Loss: 7.531 Vali Acc: 0.078 Test Loss: 7.531 Test Acc: 0.078
Validation loss decreased (-0.076875 --> -0.077765).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2482149
	speed: 0.7410s/iter; left time: 13027.7988s
	iters: 200, epoch: 16 | loss: 0.5821568
	speed: 0.3252s/iter; left time: 5685.0336s
Epoch: 16 cost time: 68.87876582145691
Epoch: 16, Steps: 208 | Train Loss: 0.496 Vali Loss: 7.467 Vali Acc: 0.075 Test Loss: 7.467 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3296481
	speed: 0.7404s/iter; left time: 12863.3162s
	iters: 200, epoch: 17 | loss: 0.1956312
	speed: 0.3146s/iter; left time: 5434.5973s
Epoch: 17 cost time: 66.15353512763977
Epoch: 17, Steps: 208 | Train Loss: 0.447 Vali Loss: 7.661 Vali Acc: 0.079 Test Loss: 7.661 Test Acc: 0.079
Validation loss decreased (-0.077765 --> -0.079255).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2254153
	speed: 0.7369s/iter; left time: 12649.2533s
	iters: 200, epoch: 18 | loss: 0.1801258
	speed: 0.2899s/iter; left time: 4947.4019s
Epoch: 18 cost time: 62.933135986328125
Epoch: 18, Steps: 208 | Train Loss: 0.437 Vali Loss: 7.990 Vali Acc: 0.083 Test Loss: 7.990 Test Acc: 0.083
Validation loss decreased (-0.079255 --> -0.082831).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9018295
	speed: 0.6865s/iter; left time: 11640.7061s
	iters: 200, epoch: 19 | loss: 0.7502603
	speed: 0.3007s/iter; left time: 5069.0387s
Epoch: 19 cost time: 62.480486154556274
Epoch: 19, Steps: 208 | Train Loss: 0.394 Vali Loss: 8.101 Vali Acc: 0.085 Test Loss: 8.101 Test Acc: 0.085
Validation loss decreased (-0.082831 --> -0.085216).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1193861
	speed: 0.7544s/iter; left time: 12636.2372s
	iters: 200, epoch: 20 | loss: 0.6911653
	speed: 0.3382s/iter; left time: 5631.0907s
Epoch: 20 cost time: 69.46747779846191
Epoch: 20, Steps: 208 | Train Loss: 0.336 Vali Loss: 8.422 Vali Acc: 0.085 Test Loss: 8.422 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2823611
	speed: 0.7581s/iter; left time: 12539.1609s
	iters: 200, epoch: 21 | loss: 0.4773816
	speed: 0.2988s/iter; left time: 4913.0412s
Epoch: 21 cost time: 66.04976272583008
Epoch: 21, Steps: 208 | Train Loss: 0.291 Vali Loss: 8.552 Vali Acc: 0.086 Test Loss: 8.552 Test Acc: 0.086
Validation loss decreased (-0.085216 --> -0.085808).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.7070023
	speed: 0.6899s/iter; left time: 11268.2333s
	iters: 200, epoch: 22 | loss: 0.4077581
	speed: 0.2877s/iter; left time: 4670.6976s
Epoch: 22 cost time: 59.99085712432861
Epoch: 22, Steps: 208 | Train Loss: 0.287 Vali Loss: 8.922 Vali Acc: 0.084 Test Loss: 8.922 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1725306
	speed: 0.6944s/iter; left time: 11197.2729s
	iters: 200, epoch: 23 | loss: 0.3111565
	speed: 0.3175s/iter; left time: 5088.4844s
Epoch: 23 cost time: 64.79854559898376
Epoch: 23, Steps: 208 | Train Loss: 0.272 Vali Loss: 9.237 Vali Acc: 0.081 Test Loss: 9.237 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4098553
	speed: 0.7581s/iter; left time: 12066.0480s
	iters: 200, epoch: 24 | loss: 0.4858204
	speed: 0.2869s/iter; left time: 4537.6396s
Epoch: 24 cost time: 63.27776861190796
Epoch: 24, Steps: 208 | Train Loss: 0.266 Vali Loss: 9.300 Vali Acc: 0.081 Test Loss: 9.300 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.2674621
	speed: 0.6910s/iter; left time: 10854.6683s
	iters: 200, epoch: 25 | loss: 0.1491838
	speed: 0.2825s/iter; left time: 4410.1198s
Epoch: 25 cost time: 60.31291389465332
Epoch: 25, Steps: 208 | Train Loss: 0.230 Vali Loss: 9.247 Vali Acc: 0.078 Test Loss: 9.247 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2213591
	speed: 0.6858s/iter; left time: 10631.1797s
	iters: 200, epoch: 26 | loss: 0.2105536
	speed: 0.2998s/iter; left time: 4616.6271s
Epoch: 26 cost time: 63.20689558982849
Epoch: 26, Steps: 208 | Train Loss: 0.216 Vali Loss: 9.412 Vali Acc: 0.081 Test Loss: 9.412 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2077564
	speed: 0.7179s/iter; left time: 10979.1637s
	iters: 200, epoch: 27 | loss: 0.0502909
	speed: 0.3135s/iter; left time: 4762.4921s
Epoch: 27 cost time: 65.71632957458496
Epoch: 27, Steps: 208 | Train Loss: 0.227 Vali Loss: 10.064 Vali Acc: 0.082 Test Loss: 10.064 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0679647
	speed: 0.6890s/iter; left time: 10393.8911s
	iters: 200, epoch: 28 | loss: 0.2391503
	speed: 0.2821s/iter; left time: 4227.5837s
Epoch: 28 cost time: 61.67780685424805
Epoch: 28, Steps: 208 | Train Loss: 0.213 Vali Loss: 9.768 Vali Acc: 0.090 Test Loss: 9.768 Test Acc: 0.090
Validation loss decreased (-0.085808 --> -0.090269).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1272343
	speed: 0.6951s/iter; left time: 10340.7278s
	iters: 200, epoch: 29 | loss: 0.1813701
	speed: 0.3051s/iter; left time: 4508.1731s
Epoch: 29 cost time: 63.993409395217896
Epoch: 29, Steps: 208 | Train Loss: 0.192 Vali Loss: 9.586 Vali Acc: 0.084 Test Loss: 9.586 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0765779
	speed: 0.7376s/iter; left time: 10820.1694s
	iters: 200, epoch: 30 | loss: 0.0191551
	speed: 0.3234s/iter; left time: 4711.7493s
Epoch: 30 cost time: 67.78966021537781
Epoch: 30, Steps: 208 | Train Loss: 0.185 Vali Loss: 10.014 Vali Acc: 0.090 Test Loss: 10.014 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0112078
	speed: 0.7169s/iter; left time: 10366.8580s
	iters: 200, epoch: 31 | loss: 0.1075580
	speed: 0.2978s/iter; left time: 4276.5171s
Epoch: 31 cost time: 63.633193492889404
Epoch: 31, Steps: 208 | Train Loss: 0.186 Vali Loss: 10.117 Vali Acc: 0.084 Test Loss: 10.117 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.4643058
	speed: 0.7040s/iter; left time: 10034.2831s
	iters: 200, epoch: 32 | loss: 0.2174024
	speed: 0.2994s/iter; left time: 4237.9925s
Epoch: 32 cost time: 61.85998272895813
Epoch: 32, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.199 Vali Acc: 0.090 Test Loss: 10.199 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0995081
	speed: 0.7565s/iter; left time: 10625.6480s
	iters: 200, epoch: 33 | loss: 0.2002710
	speed: 0.3001s/iter; left time: 4184.3389s
Epoch: 33 cost time: 65.73827505111694
Epoch: 33, Steps: 208 | Train Loss: 0.169 Vali Loss: 10.535 Vali Acc: 0.092 Test Loss: 10.535 Test Acc: 0.092
Validation loss decreased (-0.090269 --> -0.091454).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0270692
	speed: 0.6559s/iter; left time: 9075.2050s
	iters: 200, epoch: 34 | loss: 0.2080626
	speed: 0.2679s/iter; left time: 3679.9718s
Epoch: 34 cost time: 56.77802491188049
Epoch: 34, Steps: 208 | Train Loss: 0.163 Vali Loss: 10.504 Vali Acc: 0.089 Test Loss: 10.504 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.2348186
	speed: 0.6371s/iter; left time: 8683.7131s
	iters: 200, epoch: 35 | loss: 0.2662462
	speed: 0.2836s/iter; left time: 3836.7116s
Epoch: 35 cost time: 58.833322525024414
Epoch: 35, Steps: 208 | Train Loss: 0.152 Vali Loss: 10.569 Vali Acc: 0.088 Test Loss: 10.569 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0452238
	speed: 0.7544s/iter; left time: 10124.2515s
	iters: 200, epoch: 36 | loss: 0.0131286
	speed: 0.2957s/iter; left time: 3938.5436s
Epoch: 36 cost time: 65.28143572807312
Epoch: 36, Steps: 208 | Train Loss: 0.145 Vali Loss: 10.969 Vali Acc: 0.084 Test Loss: 10.969 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.1729957
	speed: 0.7010s/iter; left time: 9262.7574s
	iters: 200, epoch: 37 | loss: 0.1356387
	speed: 0.3036s/iter; left time: 3980.9173s
Epoch: 37 cost time: 63.76266145706177
Epoch: 37, Steps: 208 | Train Loss: 0.154 Vali Loss: 10.748 Vali Acc: 0.086 Test Loss: 10.748 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.5821840
	speed: 0.7140s/iter; left time: 9285.2248s
	iters: 200, epoch: 38 | loss: 0.0472937
	speed: 0.3259s/iter; left time: 4206.0506s
Epoch: 38 cost time: 66.66607236862183
Epoch: 38, Steps: 208 | Train Loss: 0.144 Vali Loss: 10.962 Vali Acc: 0.085 Test Loss: 10.962 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.8255116
	speed: 0.7370s/iter; left time: 9431.9615s
	iters: 200, epoch: 39 | loss: 0.0261628
	speed: 0.3117s/iter; left time: 3957.6212s
Epoch: 39 cost time: 65.8486545085907
Epoch: 39, Steps: 208 | Train Loss: 0.150 Vali Loss: 11.040 Vali Acc: 0.090 Test Loss: 11.040 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.1667082
	speed: 0.7307s/iter; left time: 9199.3320s
	iters: 200, epoch: 40 | loss: 0.0774182
	speed: 0.3058s/iter; left time: 3818.7392s
Epoch: 40 cost time: 64.9206235408783
Epoch: 40, Steps: 208 | Train Loss: 0.130 Vali Loss: 10.883 Vali Acc: 0.086 Test Loss: 10.883 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0753800
	speed: 0.7414s/iter; left time: 9179.6289s
	iters: 200, epoch: 41 | loss: 0.0859881
	speed: 0.3109s/iter; left time: 3817.6532s
Epoch: 41 cost time: 65.27344703674316
Epoch: 41, Steps: 208 | Train Loss: 0.136 Vali Loss: 10.964 Vali Acc: 0.090 Test Loss: 10.964 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0297417
	speed: 0.6798s/iter; left time: 8275.1950s
	iters: 200, epoch: 42 | loss: 0.0768242
	speed: 0.2956s/iter; left time: 3568.2704s
Epoch: 42 cost time: 61.3550238609314
Epoch: 42, Steps: 208 | Train Loss: 0.139 Vali Loss: 11.007 Vali Acc: 0.088 Test Loss: 11.007 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0503389
	speed: 0.7406s/iter; left time: 8860.8869s
	iters: 200, epoch: 43 | loss: 0.0428115
	speed: 0.3291s/iter; left time: 3904.7030s
Epoch: 43 cost time: 68.83595776557922
Epoch: 43, Steps: 208 | Train Loss: 0.096 Vali Loss: 11.073 Vali Acc: 0.087 Test Loss: 11.073 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09155979719654041
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9860160
	speed: 0.2828s/iter; left time: 5854.7936s
	iters: 200, epoch: 1 | loss: 4.0098629
	speed: 0.2720s/iter; left time: 5603.7906s
Epoch: 1 cost time: 57.67045497894287
Epoch: 1, Steps: 208 | Train Loss: 3.680 Vali Loss: 4.296 Vali Acc: 0.028 Test Loss: 4.296 Test Acc: 0.028
Validation loss decreased (inf --> -0.028290).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0595529
	speed: 0.6479s/iter; left time: 13276.6548s
	iters: 200, epoch: 2 | loss: 3.5442901
	speed: 0.2771s/iter; left time: 5650.3959s
Epoch: 2 cost time: 58.743896484375
Epoch: 2, Steps: 208 | Train Loss: 3.365 Vali Loss: 5.089 Vali Acc: 0.031 Test Loss: 5.089 Test Acc: 0.031
Validation loss decreased (-0.028290 --> -0.030668).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5007949
	speed: 0.6722s/iter; left time: 13636.1830s
	iters: 200, epoch: 3 | loss: 3.2057900
	speed: 0.2865s/iter; left time: 5782.7784s
Epoch: 3 cost time: 60.43520164489746
Epoch: 3, Steps: 208 | Train Loss: 3.170 Vali Loss: 5.084 Vali Acc: 0.039 Test Loss: 5.084 Test Acc: 0.039
Validation loss decreased (-0.030668 --> -0.039019).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6865454
	speed: 0.6854s/iter; left time: 13761.0039s
	iters: 200, epoch: 4 | loss: 3.5417943
	speed: 0.2669s/iter; left time: 5331.8891s
Epoch: 4 cost time: 58.609610080718994
Epoch: 4, Steps: 208 | Train Loss: 3.009 Vali Loss: 5.075 Vali Acc: 0.038 Test Loss: 5.075 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3355961
	speed: 0.6042s/iter; left time: 12004.2227s
	iters: 200, epoch: 5 | loss: 2.8744507
	speed: 0.2600s/iter; left time: 5139.9232s
Epoch: 5 cost time: 54.471986055374146
Epoch: 5, Steps: 208 | Train Loss: 2.893 Vali Loss: 4.846 Vali Acc: 0.044 Test Loss: 4.846 Test Acc: 0.044
Validation loss decreased (-0.039019 --> -0.043793).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0553823
	speed: 0.6560s/iter; left time: 12897.1024s
	iters: 200, epoch: 6 | loss: 2.3634996
	speed: 0.2889s/iter; left time: 5650.2039s
Epoch: 6 cost time: 60.806973457336426
Epoch: 6, Steps: 208 | Train Loss: 2.697 Vali Loss: 4.878 Vali Acc: 0.049 Test Loss: 4.878 Test Acc: 0.049
Validation loss decreased (-0.043793 --> -0.048564).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8372087
	speed: 0.7078s/iter; left time: 13768.5999s
	iters: 200, epoch: 7 | loss: 2.9517744
	speed: 0.3003s/iter; left time: 5812.2899s
Epoch: 7 cost time: 62.74753427505493
Epoch: 7, Steps: 208 | Train Loss: 2.482 Vali Loss: 4.822 Vali Acc: 0.055 Test Loss: 4.822 Test Acc: 0.055
Validation loss decreased (-0.048564 --> -0.054530).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0984783
	speed: 0.6762s/iter; left time: 13012.7431s
	iters: 200, epoch: 8 | loss: 2.7860553
	speed: 0.2838s/iter; left time: 5432.7413s
Epoch: 8 cost time: 59.97238039970398
Epoch: 8, Steps: 208 | Train Loss: 2.252 Vali Loss: 4.904 Vali Acc: 0.064 Test Loss: 4.904 Test Acc: 0.064
Validation loss decreased (-0.054530 --> -0.063476).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2601662
	speed: 0.7040s/iter; left time: 13402.8731s
	iters: 200, epoch: 9 | loss: 2.1712980
	speed: 0.2963s/iter; left time: 5610.4785s
Epoch: 9 cost time: 63.458495140075684
Epoch: 9, Steps: 208 | Train Loss: 2.010 Vali Loss: 5.092 Vali Acc: 0.059 Test Loss: 5.092 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7469659
	speed: 0.7169s/iter; left time: 13499.2011s
	iters: 200, epoch: 10 | loss: 1.5838614
	speed: 0.3030s/iter; left time: 5675.5291s
Epoch: 10 cost time: 64.35365152359009
Epoch: 10, Steps: 208 | Train Loss: 1.779 Vali Loss: 5.402 Vali Acc: 0.066 Test Loss: 5.402 Test Acc: 0.066
Validation loss decreased (-0.063476 --> -0.065857).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0843965
	speed: 0.7048s/iter; left time: 13123.6923s
	iters: 200, epoch: 11 | loss: 2.3594475
	speed: 0.3022s/iter; left time: 5597.5434s
Epoch: 11 cost time: 63.656585931777954
Epoch: 11, Steps: 208 | Train Loss: 1.587 Vali Loss: 5.574 Vali Acc: 0.058 Test Loss: 5.574 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5985570
	speed: 0.7348s/iter; left time: 13530.7018s
	iters: 200, epoch: 12 | loss: 2.1008458
	speed: 0.2848s/iter; left time: 5215.7281s
Epoch: 12 cost time: 61.61520791053772
Epoch: 12, Steps: 208 | Train Loss: 1.377 Vali Loss: 5.776 Vali Acc: 0.061 Test Loss: 5.776 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8243101
	speed: 0.6845s/iter; left time: 12462.0884s
	iters: 200, epoch: 13 | loss: 2.0943816
	speed: 0.2935s/iter; left time: 5313.4064s
Epoch: 13 cost time: 62.71234893798828
Epoch: 13, Steps: 208 | Train Loss: 1.203 Vali Loss: 5.989 Vali Acc: 0.073 Test Loss: 5.989 Test Acc: 0.073
Validation loss decreased (-0.065857 --> -0.072711).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0460050
	speed: 0.7306s/iter; left time: 13147.8514s
	iters: 200, epoch: 14 | loss: 2.6893888
	speed: 0.3092s/iter; left time: 5533.0768s
Epoch: 14 cost time: 66.21645140647888
Epoch: 14, Steps: 208 | Train Loss: 1.070 Vali Loss: 6.263 Vali Acc: 0.072 Test Loss: 6.263 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4400765
	speed: 0.6920s/iter; left time: 12309.4374s
	iters: 200, epoch: 15 | loss: 1.3883528
	speed: 0.2886s/iter; left time: 5105.6246s
Epoch: 15 cost time: 60.13449764251709
Epoch: 15, Steps: 208 | Train Loss: 0.947 Vali Loss: 6.544 Vali Acc: 0.069 Test Loss: 6.544 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3868489
	speed: 0.6858s/iter; left time: 12057.0245s
	iters: 200, epoch: 16 | loss: 1.6046143
	speed: 0.2939s/iter; left time: 5137.0836s
Epoch: 16 cost time: 62.58349823951721
Epoch: 16, Steps: 208 | Train Loss: 0.847 Vali Loss: 6.863 Vali Acc: 0.073 Test Loss: 6.863 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3311588
	speed: 0.7300s/iter; left time: 12682.6387s
	iters: 200, epoch: 17 | loss: 0.3734103
	speed: 0.2972s/iter; left time: 5133.2877s
Epoch: 17 cost time: 64.3125216960907
Epoch: 17, Steps: 208 | Train Loss: 0.757 Vali Loss: 7.025 Vali Acc: 0.072 Test Loss: 7.025 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6908416
	speed: 0.6738s/iter; left time: 11565.4704s
	iters: 200, epoch: 18 | loss: 1.1385255
	speed: 0.2811s/iter; left time: 4797.7723s
Epoch: 18 cost time: 59.461411476135254
Epoch: 18, Steps: 208 | Train Loss: 0.668 Vali Loss: 7.177 Vali Acc: 0.075 Test Loss: 7.177 Test Acc: 0.075
Validation loss decreased (-0.072711 --> -0.075085).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.2260650
	speed: 0.6564s/iter; left time: 11131.0925s
	iters: 200, epoch: 19 | loss: 0.7216581
	speed: 0.2898s/iter; left time: 4884.8778s
Epoch: 19 cost time: 60.441949129104614
Epoch: 19, Steps: 208 | Train Loss: 0.602 Vali Loss: 7.333 Vali Acc: 0.077 Test Loss: 7.333 Test Acc: 0.077
Validation loss decreased (-0.075085 --> -0.077171).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3722219
	speed: 0.7473s/iter; left time: 12517.3075s
	iters: 200, epoch: 20 | loss: 0.9928328
	speed: 0.2953s/iter; left time: 4916.3440s
Epoch: 20 cost time: 63.687097787857056
Epoch: 20, Steps: 208 | Train Loss: 0.544 Vali Loss: 7.766 Vali Acc: 0.081 Test Loss: 7.766 Test Acc: 0.081
Validation loss decreased (-0.077171 --> -0.081342).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5364717
	speed: 0.6647s/iter; left time: 10995.3381s
	iters: 200, epoch: 21 | loss: 0.8075646
	speed: 0.2889s/iter; left time: 4749.8595s
Epoch: 21 cost time: 60.63020968437195
Epoch: 21, Steps: 208 | Train Loss: 0.507 Vali Loss: 7.577 Vali Acc: 0.077 Test Loss: 7.577 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.2597458
	speed: 0.6542s/iter; left time: 10685.1281s
	iters: 200, epoch: 22 | loss: 0.8150020
	speed: 0.2843s/iter; left time: 4615.1419s
Epoch: 22 cost time: 60.017316579818726
Epoch: 22, Steps: 208 | Train Loss: 0.469 Vali Loss: 8.188 Vali Acc: 0.089 Test Loss: 8.188 Test Acc: 0.089
Validation loss decreased (-0.081342 --> -0.088794).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.6418470
	speed: 0.6514s/iter; left time: 10503.5487s
	iters: 200, epoch: 23 | loss: 0.5931149
	speed: 0.2721s/iter; left time: 4360.5603s
Epoch: 23 cost time: 57.07985210418701
Epoch: 23, Steps: 208 | Train Loss: 0.422 Vali Loss: 8.210 Vali Acc: 0.083 Test Loss: 8.210 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.5730661
	speed: 0.6787s/iter; left time: 10803.3314s
	iters: 200, epoch: 24 | loss: 0.3267390
	speed: 0.2832s/iter; left time: 4479.9026s
Epoch: 24 cost time: 60.09520888328552
Epoch: 24, Steps: 208 | Train Loss: 0.380 Vali Loss: 8.304 Vali Acc: 0.084 Test Loss: 8.304 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.7257780
	speed: 0.6760s/iter; left time: 10619.2293s
	iters: 200, epoch: 25 | loss: 0.1245305
	speed: 0.3165s/iter; left time: 4940.0797s
Epoch: 25 cost time: 64.00483298301697
Epoch: 25, Steps: 208 | Train Loss: 0.371 Vali Loss: 8.802 Vali Acc: 0.080 Test Loss: 8.802 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.2667086
	speed: 0.6929s/iter; left time: 10740.0427s
	iters: 200, epoch: 26 | loss: 0.3963131
	speed: 0.2834s/iter; left time: 4364.8002s
Epoch: 26 cost time: 61.35633158683777
Epoch: 26, Steps: 208 | Train Loss: 0.383 Vali Loss: 8.610 Vali Acc: 0.080 Test Loss: 8.610 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.3910065
	speed: 0.6705s/iter; left time: 10253.8003s
	iters: 200, epoch: 27 | loss: 0.3285105
	speed: 0.2864s/iter; left time: 4351.7774s
Epoch: 27 cost time: 60.62628674507141
Epoch: 27, Steps: 208 | Train Loss: 0.346 Vali Loss: 8.722 Vali Acc: 0.092 Test Loss: 8.722 Test Acc: 0.092
Validation loss decreased (-0.088794 --> -0.091771).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0238610
	speed: 0.6915s/iter; left time: 10431.1959s
	iters: 200, epoch: 28 | loss: 0.0491092
	speed: 0.2660s/iter; left time: 3985.8963s
Epoch: 28 cost time: 58.53369688987732
Epoch: 28, Steps: 208 | Train Loss: 0.326 Vali Loss: 9.254 Vali Acc: 0.090 Test Loss: 9.254 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0605966
	speed: 0.6181s/iter; left time: 9196.0019s
	iters: 200, epoch: 29 | loss: 0.3567652
	speed: 0.2657s/iter; left time: 3926.4070s
Epoch: 29 cost time: 56.07086777687073
Epoch: 29, Steps: 208 | Train Loss: 0.323 Vali Loss: 9.128 Vali Acc: 0.086 Test Loss: 9.128 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.1518170
	speed: 0.6573s/iter; left time: 9642.4344s
	iters: 200, epoch: 30 | loss: 0.1191302
	speed: 0.2718s/iter; left time: 3959.3162s
Epoch: 30 cost time: 57.98897957801819
Epoch: 30, Steps: 208 | Train Loss: 0.287 Vali Loss: 9.131 Vali Acc: 0.091 Test Loss: 9.131 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0892236
	speed: 0.6686s/iter; left time: 9668.1514s
	iters: 200, epoch: 31 | loss: 0.0629730
	speed: 0.2717s/iter; left time: 3901.2398s
Epoch: 31 cost time: 58.0580096244812
Epoch: 31, Steps: 208 | Train Loss: 0.275 Vali Loss: 9.322 Vali Acc: 0.089 Test Loss: 9.322 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.7380594
	speed: 0.6241s/iter; left time: 8895.2080s
	iters: 200, epoch: 32 | loss: 0.1752877
	speed: 0.2596s/iter; left time: 3674.5902s
Epoch: 32 cost time: 54.220850467681885
Epoch: 32, Steps: 208 | Train Loss: 0.243 Vali Loss: 9.470 Vali Acc: 0.086 Test Loss: 9.470 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0965538
	speed: 0.6946s/iter; left time: 9755.1497s
	iters: 200, epoch: 33 | loss: 0.1784690
	speed: 0.2941s/iter; left time: 4100.6228s
Epoch: 33 cost time: 62.889530420303345
Epoch: 33, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.803 Vali Acc: 0.086 Test Loss: 9.803 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.3661042
	speed: 0.6386s/iter; left time: 8836.6053s
	iters: 200, epoch: 34 | loss: 0.3120980
	speed: 0.2622s/iter; left time: 3601.4919s
Epoch: 34 cost time: 55.50771641731262
Epoch: 34, Steps: 208 | Train Loss: 0.225 Vali Loss: 9.713 Vali Acc: 0.085 Test Loss: 9.713 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.1174288
	speed: 0.6551s/iter; left time: 8928.5359s
	iters: 200, epoch: 35 | loss: 0.9759686
	speed: 0.2749s/iter; left time: 3718.7680s
Epoch: 35 cost time: 58.63460159301758
Epoch: 35, Steps: 208 | Train Loss: 0.226 Vali Loss: 9.768 Vali Acc: 0.088 Test Loss: 9.768 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0858879
	speed: 0.6805s/iter; left time: 9133.4859s
	iters: 200, epoch: 36 | loss: 0.0378491
	speed: 0.2843s/iter; left time: 3787.4007s
Epoch: 36 cost time: 60.63938903808594
Epoch: 36, Steps: 208 | Train Loss: 0.233 Vali Loss: 9.691 Vali Acc: 0.089 Test Loss: 9.691 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.1892541
	speed: 0.6232s/iter; left time: 8234.7505s
	iters: 200, epoch: 37 | loss: 0.1465089
	speed: 0.2691s/iter; left time: 3529.2490s
Epoch: 37 cost time: 56.00994372367859
Epoch: 37, Steps: 208 | Train Loss: 0.218 Vali Loss: 10.055 Vali Acc: 0.092 Test Loss: 10.055 Test Acc: 0.092
Validation loss decreased (-0.091771 --> -0.092056).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0908072
	speed: 0.6350s/iter; left time: 8258.6697s
	iters: 200, epoch: 38 | loss: 0.1251240
	speed: 0.2632s/iter; left time: 3396.8159s
Epoch: 38 cost time: 55.7057409286499
Epoch: 38, Steps: 208 | Train Loss: 0.194 Vali Loss: 10.062 Vali Acc: 0.089 Test Loss: 10.062 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0839906
	speed: 0.6011s/iter; left time: 7692.0191s
	iters: 200, epoch: 39 | loss: 0.3905224
	speed: 0.2693s/iter; left time: 3419.6758s
Epoch: 39 cost time: 55.34734058380127
Epoch: 39, Steps: 208 | Train Loss: 0.207 Vali Loss: 10.354 Vali Acc: 0.095 Test Loss: 10.354 Test Acc: 0.095
Validation loss decreased (-0.092056 --> -0.094439).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0856989
	speed: 0.6556s/iter; left time: 8253.4784s
	iters: 200, epoch: 40 | loss: 0.2421842
	speed: 0.2792s/iter; left time: 3486.6755s
Epoch: 40 cost time: 58.964510679244995
Epoch: 40, Steps: 208 | Train Loss: 0.229 Vali Loss: 10.714 Vali Acc: 0.091 Test Loss: 10.714 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.3133378
	speed: 0.6744s/iter; left time: 8349.9083s
	iters: 200, epoch: 41 | loss: 0.0813377
	speed: 0.2563s/iter; left time: 3148.1556s
Epoch: 41 cost time: 56.08050274848938
Epoch: 41, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.359 Vali Acc: 0.086 Test Loss: 10.359 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.1969657
	speed: 0.6080s/iter; left time: 7401.4503s
	iters: 200, epoch: 42 | loss: 0.2958816
	speed: 0.2701s/iter; left time: 3261.0188s
Epoch: 42 cost time: 55.95654892921448
Epoch: 42, Steps: 208 | Train Loss: 0.196 Vali Loss: 10.199 Vali Acc: 0.086 Test Loss: 10.199 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.0430186
	speed: 0.6784s/iter; left time: 8116.7120s
	iters: 200, epoch: 43 | loss: 0.0185517
	speed: 0.2775s/iter; left time: 3292.1358s
Epoch: 43 cost time: 59.27698540687561
Epoch: 43, Steps: 208 | Train Loss: 0.193 Vali Loss: 10.605 Vali Acc: 0.087 Test Loss: 10.605 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.0920377
	speed: 0.6238s/iter; left time: 7334.0060s
	iters: 200, epoch: 44 | loss: 0.1397641
	speed: 0.2722s/iter; left time: 3172.9915s
Epoch: 44 cost time: 56.61824440956116
Epoch: 44, Steps: 208 | Train Loss: 0.169 Vali Loss: 10.353 Vali Acc: 0.095 Test Loss: 10.353 Test Acc: 0.095
Validation loss decreased (-0.094439 --> -0.094439).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0241145
	speed: 0.6346s/iter; left time: 7328.6883s
	iters: 200, epoch: 45 | loss: 0.2537513
	speed: 0.2705s/iter; left time: 3097.1824s
Epoch: 45 cost time: 56.72887563705444
Epoch: 45, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.837 Vali Acc: 0.092 Test Loss: 10.837 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.2130407
	speed: 0.6495s/iter; left time: 7365.8403s
	iters: 200, epoch: 46 | loss: 0.3986088
	speed: 0.2754s/iter; left time: 3096.1253s
Epoch: 46 cost time: 57.85074472427368
Epoch: 46, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.593 Vali Acc: 0.085 Test Loss: 10.593 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0198888
	speed: 0.6498s/iter; left time: 7234.6545s
	iters: 200, epoch: 47 | loss: 0.1721820
	speed: 0.2772s/iter; left time: 3058.4382s
Epoch: 47 cost time: 58.28511333465576
Epoch: 47, Steps: 208 | Train Loss: 0.164 Vali Loss: 10.530 Vali Acc: 0.092 Test Loss: 10.530 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.0122040
	speed: 0.6154s/iter; left time: 6722.8319s
	iters: 200, epoch: 48 | loss: 0.3906259
	speed: 0.2804s/iter; left time: 3034.9535s
Epoch: 48 cost time: 56.76983618736267
Epoch: 48, Steps: 208 | Train Loss: 0.136 Vali Loss: 10.913 Vali Acc: 0.088 Test Loss: 10.913 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.9664804
	speed: 0.6666s/iter; left time: 7143.4631s
	iters: 200, epoch: 49 | loss: 0.1615803
	speed: 0.2809s/iter; left time: 2982.3842s
Epoch: 49 cost time: 58.48595881462097
Epoch: 49, Steps: 208 | Train Loss: 0.148 Vali Loss: 10.965 Vali Acc: 0.090 Test Loss: 10.965 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 0.0521040
	speed: 0.6418s/iter; left time: 6745.1531s
	iters: 200, epoch: 50 | loss: 0.0689179
	speed: 0.2784s/iter; left time: 2897.4035s
Epoch: 50 cost time: 58.40265464782715
Epoch: 50, Steps: 208 | Train Loss: 0.149 Vali Loss: 10.943 Vali Acc: 0.089 Test Loss: 10.943 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.0671589
	speed: 0.6633s/iter; left time: 6832.2039s
	iters: 200, epoch: 51 | loss: 0.0700656
	speed: 0.2924s/iter; left time: 2982.4664s
Epoch: 51 cost time: 61.13455581665039
Epoch: 51, Steps: 208 | Train Loss: 0.158 Vali Loss: 10.897 Vali Acc: 0.088 Test Loss: 10.897 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.0315964
	speed: 0.6869s/iter; left time: 6933.3629s
	iters: 200, epoch: 52 | loss: 0.0077898
	speed: 0.2964s/iter; left time: 2961.6725s
Epoch: 52 cost time: 62.06063199043274
Epoch: 52, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.043 Vali Acc: 0.088 Test Loss: 11.043 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.3308446
	speed: 0.6626s/iter; left time: 6549.8043s
	iters: 200, epoch: 53 | loss: 0.0470855
	speed: 0.2915s/iter; left time: 2852.7000s
Epoch: 53 cost time: 59.68232607841492
Epoch: 53, Steps: 208 | Train Loss: 0.147 Vali Loss: 11.260 Vali Acc: 0.090 Test Loss: 11.260 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 0.0768221
	speed: 0.7146s/iter; left time: 6914.9748s
	iters: 200, epoch: 54 | loss: 0.1617796
	speed: 0.2988s/iter; left time: 2861.4678s
Epoch: 54 cost time: 64.00578093528748
Epoch: 54, Steps: 208 | Train Loss: 0.148 Vali Loss: 11.077 Vali Acc: 0.094 Test Loss: 11.077 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0945422010140173
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9578826
	speed: 0.2917s/iter; left time: 6038.3380s
	iters: 200, epoch: 1 | loss: 4.0457816
	speed: 0.2836s/iter; left time: 5841.4457s
Epoch: 1 cost time: 59.858622789382935
Epoch: 1, Steps: 208 | Train Loss: 3.680 Vali Loss: 3.924 Vali Acc: 0.037 Test Loss: 3.924 Test Acc: 0.037
Validation loss decreased (inf --> -0.037241).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0707557
	speed: 0.7022s/iter; left time: 14390.7741s
	iters: 200, epoch: 2 | loss: 3.5093551
	speed: 0.3037s/iter; left time: 6194.2298s
Epoch: 2 cost time: 65.28928804397583
Epoch: 2, Steps: 208 | Train Loss: 3.321 Vali Loss: 4.706 Vali Acc: 0.032 Test Loss: 4.706 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4679255
	speed: 0.6791s/iter; left time: 13776.5528s
	iters: 200, epoch: 3 | loss: 3.0821562
	speed: 0.2867s/iter; left time: 5787.3664s
Epoch: 3 cost time: 60.73150897026062
Epoch: 3, Steps: 208 | Train Loss: 3.064 Vali Loss: 4.750 Vali Acc: 0.041 Test Loss: 4.750 Test Acc: 0.041
Validation loss decreased (-0.037241 --> -0.041110).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4345698
	speed: 0.6847s/iter; left time: 13747.6527s
	iters: 200, epoch: 4 | loss: 3.5392206
	speed: 0.2997s/iter; left time: 5987.4208s
Epoch: 4 cost time: 64.00465250015259
Epoch: 4, Steps: 208 | Train Loss: 2.828 Vali Loss: 4.805 Vali Acc: 0.045 Test Loss: 4.805 Test Acc: 0.045
Validation loss decreased (-0.041110 --> -0.044688).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6222627
	speed: 0.6545s/iter; left time: 13004.1960s
	iters: 200, epoch: 5 | loss: 2.7850189
	speed: 0.2905s/iter; left time: 5743.6390s
Epoch: 5 cost time: 59.97225069999695
Epoch: 5, Steps: 208 | Train Loss: 2.650 Vali Loss: 5.042 Vali Acc: 0.047 Test Loss: 5.042 Test Acc: 0.047
Validation loss decreased (-0.044688 --> -0.047370).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4417615
	speed: 0.6681s/iter; left time: 13134.6164s
	iters: 200, epoch: 6 | loss: 2.1444008
	speed: 0.2905s/iter; left time: 5682.9407s
Epoch: 6 cost time: 59.87664437294006
Epoch: 6, Steps: 208 | Train Loss: 2.367 Vali Loss: 4.835 Vali Acc: 0.053 Test Loss: 4.835 Test Acc: 0.053
Validation loss decreased (-0.047370 --> -0.053337).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0518360
	speed: 0.6852s/iter; left time: 13328.2415s
	iters: 200, epoch: 7 | loss: 2.6090446
	speed: 0.2840s/iter; left time: 5496.0272s
Epoch: 7 cost time: 60.737332582473755
Epoch: 7, Steps: 208 | Train Loss: 2.072 Vali Loss: 5.005 Vali Acc: 0.064 Test Loss: 5.005 Test Acc: 0.064
Validation loss decreased (-0.053337 --> -0.063773).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6343753
	speed: 0.6430s/iter; left time: 12374.7310s
	iters: 200, epoch: 8 | loss: 2.9007142
	speed: 0.2667s/iter; left time: 5105.1910s
Epoch: 8 cost time: 56.521979331970215
Epoch: 8, Steps: 208 | Train Loss: 1.798 Vali Loss: 5.450 Vali Acc: 0.067 Test Loss: 5.450 Test Acc: 0.067
Validation loss decreased (-0.063773 --> -0.066751).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9934932
	speed: 0.6976s/iter; left time: 13280.1175s
	iters: 200, epoch: 9 | loss: 1.3074607
	speed: 0.2787s/iter; left time: 5278.4994s
Epoch: 9 cost time: 60.98289966583252
Epoch: 9, Steps: 208 | Train Loss: 1.552 Vali Loss: 5.386 Vali Acc: 0.072 Test Loss: 5.386 Test Acc: 0.072
Validation loss decreased (-0.066751 --> -0.072419).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1497897
	speed: 0.6415s/iter; left time: 12077.8818s
	iters: 200, epoch: 10 | loss: 1.1129079
	speed: 0.2655s/iter; left time: 4972.6947s
Epoch: 10 cost time: 56.232011795043945
Epoch: 10, Steps: 208 | Train Loss: 1.279 Vali Loss: 5.854 Vali Acc: 0.070 Test Loss: 5.854 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6204548
	speed: 0.6774s/iter; left time: 12614.5955s
	iters: 200, epoch: 11 | loss: 1.5990763
	speed: 0.2938s/iter; left time: 5442.2591s
Epoch: 11 cost time: 62.04405999183655
Epoch: 11, Steps: 208 | Train Loss: 1.090 Vali Loss: 6.254 Vali Acc: 0.070 Test Loss: 6.254 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4883256
	speed: 0.6615s/iter; left time: 12180.6998s
	iters: 200, epoch: 12 | loss: 1.5084302
	speed: 0.2769s/iter; left time: 5071.4268s
Epoch: 12 cost time: 58.85632371902466
Epoch: 12, Steps: 208 | Train Loss: 0.922 Vali Loss: 6.485 Vali Acc: 0.064 Test Loss: 6.485 Test Acc: 0.064
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4988339
	speed: 0.6560s/iter; left time: 11942.1472s
	iters: 200, epoch: 13 | loss: 1.0520753
	speed: 0.2940s/iter; left time: 5322.4879s
Epoch: 13 cost time: 60.327088832855225
Epoch: 13, Steps: 208 | Train Loss: 0.818 Vali Loss: 6.671 Vali Acc: 0.079 Test Loss: 6.671 Test Acc: 0.079
Validation loss decreased (-0.072419 --> -0.078669).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7646010
	speed: 0.6584s/iter; left time: 11848.9310s
	iters: 200, epoch: 14 | loss: 1.7092781
	speed: 0.2742s/iter; left time: 4907.1584s
Epoch: 14 cost time: 57.59499669075012
Epoch: 14, Steps: 208 | Train Loss: 0.685 Vali Loss: 6.917 Vali Acc: 0.087 Test Loss: 6.917 Test Acc: 0.087
Validation loss decreased (-0.078669 --> -0.087017).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3724675
	speed: 0.6590s/iter; left time: 11723.3047s
	iters: 200, epoch: 15 | loss: 0.8560134
	speed: 0.2805s/iter; left time: 4961.3675s
Epoch: 15 cost time: 58.49387860298157
Epoch: 15, Steps: 208 | Train Loss: 0.623 Vali Loss: 7.151 Vali Acc: 0.084 Test Loss: 7.151 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3085347
	speed: 0.7090s/iter; left time: 12464.3481s
	iters: 200, epoch: 16 | loss: 1.0008730
	speed: 0.2778s/iter; left time: 4856.7427s
Epoch: 16 cost time: 60.16504240036011
Epoch: 16, Steps: 208 | Train Loss: 0.553 Vali Loss: 7.626 Vali Acc: 0.091 Test Loss: 7.626 Test Acc: 0.091
Validation loss decreased (-0.087017 --> -0.090589).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5034884
	speed: 0.6255s/iter; left time: 10866.8339s
	iters: 200, epoch: 17 | loss: 0.6486509
	speed: 0.2694s/iter; left time: 4653.9093s
Epoch: 17 cost time: 55.67230463027954
Epoch: 17, Steps: 208 | Train Loss: 0.514 Vali Loss: 7.761 Vali Acc: 0.091 Test Loss: 7.761 Test Acc: 0.091
Validation loss decreased (-0.090589 --> -0.091184).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.8674258
	speed: 0.6756s/iter; left time: 11595.9623s
	iters: 200, epoch: 18 | loss: 0.7829315
	speed: 0.3018s/iter; left time: 5150.4648s
Epoch: 18 cost time: 63.24547004699707
Epoch: 18, Steps: 208 | Train Loss: 0.447 Vali Loss: 8.074 Vali Acc: 0.087 Test Loss: 8.074 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.9950203
	speed: 0.6918s/iter; left time: 11731.1725s
	iters: 200, epoch: 19 | loss: 0.4991745
	speed: 0.2904s/iter; left time: 4894.9749s
Epoch: 19 cost time: 60.58735156059265
Epoch: 19, Steps: 208 | Train Loss: 0.435 Vali Loss: 8.243 Vali Acc: 0.081 Test Loss: 8.243 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2515413
	speed: 0.6746s/iter; left time: 11299.3457s
	iters: 200, epoch: 20 | loss: 0.8052405
	speed: 0.3039s/iter; left time: 5059.1836s
Epoch: 20 cost time: 60.9472553730011
Epoch: 20, Steps: 208 | Train Loss: 0.375 Vali Loss: 8.419 Vali Acc: 0.081 Test Loss: 8.419 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2624114
	speed: 0.6739s/iter; left time: 11146.8950s
	iters: 200, epoch: 21 | loss: 0.2813803
	speed: 0.3065s/iter; left time: 5038.6958s
Epoch: 21 cost time: 62.51854729652405
Epoch: 21, Steps: 208 | Train Loss: 0.390 Vali Loss: 8.676 Vali Acc: 0.084 Test Loss: 8.676 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.5935971
	speed: 0.6889s/iter; left time: 11251.2639s
	iters: 200, epoch: 22 | loss: 0.9825212
	speed: 0.3060s/iter; left time: 4967.3535s
Epoch: 22 cost time: 63.211533546447754
Epoch: 22, Steps: 208 | Train Loss: 0.325 Vali Loss: 8.919 Vali Acc: 0.094 Test Loss: 8.919 Test Acc: 0.094
Validation loss decreased (-0.091184 --> -0.093857).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0634449
	speed: 0.6676s/iter; left time: 10764.3701s
	iters: 200, epoch: 23 | loss: 0.6253560
	speed: 0.2916s/iter; left time: 4672.3465s
Epoch: 23 cost time: 61.44186472892761
Epoch: 23, Steps: 208 | Train Loss: 0.308 Vali Loss: 9.275 Vali Acc: 0.082 Test Loss: 9.275 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0700906
	speed: 0.6558s/iter; left time: 10439.0120s
	iters: 200, epoch: 24 | loss: 0.1929217
	speed: 0.2680s/iter; left time: 4238.8565s
Epoch: 24 cost time: 55.995095014572144
Epoch: 24, Steps: 208 | Train Loss: 0.272 Vali Loss: 9.152 Vali Acc: 0.086 Test Loss: 9.152 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.4669705
	speed: 0.6468s/iter; left time: 10159.8831s
	iters: 200, epoch: 25 | loss: 0.2823448
	speed: 0.2861s/iter; left time: 4465.1800s
Epoch: 25 cost time: 60.4275107383728
Epoch: 25, Steps: 208 | Train Loss: 0.279 Vali Loss: 9.041 Vali Acc: 0.089 Test Loss: 9.041 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1080575
	speed: 0.7001s/iter; left time: 10851.7817s
	iters: 200, epoch: 26 | loss: 0.4733306
	speed: 0.2677s/iter; left time: 4123.2392s
Epoch: 26 cost time: 58.45120596885681
Epoch: 26, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.534 Vali Acc: 0.090 Test Loss: 9.534 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0938659
	speed: 0.6714s/iter; left time: 10268.0033s
	iters: 200, epoch: 27 | loss: 0.0317919
	speed: 0.2933s/iter; left time: 4455.8250s
Epoch: 27 cost time: 61.07309007644653
Epoch: 27, Steps: 208 | Train Loss: 0.243 Vali Loss: 9.419 Vali Acc: 0.093 Test Loss: 9.419 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2613115
	speed: 0.6734s/iter; left time: 10157.5329s
	iters: 200, epoch: 28 | loss: 0.1258093
	speed: 0.3088s/iter; left time: 4626.6712s
Epoch: 28 cost time: 63.90038752555847
Epoch: 28, Steps: 208 | Train Loss: 0.235 Vali Loss: 9.754 Vali Acc: 0.089 Test Loss: 9.754 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.5306057
	speed: 0.6972s/iter; left time: 10372.1702s
	iters: 200, epoch: 29 | loss: 0.2163284
	speed: 0.2935s/iter; left time: 4336.6324s
Epoch: 29 cost time: 62.82893395423889
Epoch: 29, Steps: 208 | Train Loss: 0.209 Vali Loss: 9.837 Vali Acc: 0.092 Test Loss: 9.837 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0313527
	speed: 0.6679s/iter; left time: 9797.7734s
	iters: 200, epoch: 30 | loss: 0.0370437
	speed: 0.3116s/iter; left time: 4540.2185s
Epoch: 30 cost time: 63.199702739715576
Epoch: 30, Steps: 208 | Train Loss: 0.181 Vali Loss: 9.889 Vali Acc: 0.089 Test Loss: 9.889 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0757228
	speed: 0.6754s/iter; left time: 9766.9744s
	iters: 200, epoch: 31 | loss: 0.0705442
	speed: 0.2819s/iter; left time: 4048.1782s
Epoch: 31 cost time: 58.498833894729614
Epoch: 31, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.348 Vali Acc: 0.092 Test Loss: 10.348 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.3351972
	speed: 0.6888s/iter; left time: 9817.7532s
	iters: 200, epoch: 32 | loss: 1.8152891
	speed: 0.3186s/iter; left time: 4509.5783s
Epoch: 32 cost time: 64.03238153457642
Epoch: 32, Steps: 208 | Train Loss: 0.228 Vali Loss: 10.108 Vali Acc: 0.086 Test Loss: 10.108 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09394572025052192
model parameter : 707655
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4616692
	speed: 0.2922s/iter; left time: 6048.0327s
	iters: 200, epoch: 1 | loss: 3.3948858
	speed: 0.2774s/iter; left time: 5714.7529s
Epoch: 1 cost time: 59.367840051651
Epoch: 1, Steps: 208 | Train Loss: 3.613 Vali Loss: 3.471 Vali Acc: 0.067 Test Loss: 3.471 Test Acc: 0.067
Validation loss decreased (inf --> -0.067368).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6632295
	speed: 0.6386s/iter; left time: 13085.8941s
	iters: 200, epoch: 2 | loss: 2.5691321
	speed: 0.2878s/iter; left time: 5869.6712s
Epoch: 2 cost time: 59.717175245285034
Epoch: 2, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.590 Vali Acc: 0.084 Test Loss: 3.590 Test Acc: 0.084
Validation loss decreased (-0.067368 --> -0.084366).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3912246
	speed: 0.6836s/iter; left time: 13866.2766s
	iters: 200, epoch: 3 | loss: 2.9180400
	speed: 0.2754s/iter; left time: 5559.5276s
Epoch: 3 cost time: 58.40278959274292
Epoch: 3, Steps: 208 | Train Loss: 2.575 Vali Loss: 3.725 Vali Acc: 0.103 Test Loss: 3.725 Test Acc: 0.103
Validation loss decreased (-0.084366 --> -0.102856).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3052382
	speed: 0.6636s/iter; left time: 13323.4873s
	iters: 200, epoch: 4 | loss: 2.4791236
	speed: 0.2765s/iter; left time: 5523.3944s
Epoch: 4 cost time: 58.92009401321411
Epoch: 4, Steps: 208 | Train Loss: 2.075 Vali Loss: 4.036 Vali Acc: 0.095 Test Loss: 4.036 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0523442
	speed: 0.6821s/iter; left time: 13553.4466s
	iters: 200, epoch: 5 | loss: 2.4986343
	speed: 0.3004s/iter; left time: 5939.3651s
Epoch: 5 cost time: 63.00884413719177
Epoch: 5, Steps: 208 | Train Loss: 1.545 Vali Loss: 4.366 Vali Acc: 0.103 Test Loss: 4.366 Test Acc: 0.103
Validation loss decreased (-0.102856 --> -0.103446).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7508904
	speed: 0.6838s/iter; left time: 13444.7183s
	iters: 200, epoch: 6 | loss: 1.0806967
	speed: 0.3001s/iter; left time: 5870.7074s
Epoch: 6 cost time: 61.60948634147644
Epoch: 6, Steps: 208 | Train Loss: 1.154 Vali Loss: 5.051 Vali Acc: 0.091 Test Loss: 5.051 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3836081
	speed: 0.7060s/iter; left time: 13734.1837s
	iters: 200, epoch: 7 | loss: 0.7867083
	speed: 0.2950s/iter; left time: 5708.2062s
Epoch: 7 cost time: 62.456294775009155
Epoch: 7, Steps: 208 | Train Loss: 0.816 Vali Loss: 5.488 Vali Acc: 0.093 Test Loss: 5.488 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5972523
	speed: 0.6949s/iter; left time: 13373.0522s
	iters: 200, epoch: 8 | loss: 0.5465055
	speed: 0.2995s/iter; left time: 5733.1202s
Epoch: 8 cost time: 61.665294885635376
Epoch: 8, Steps: 208 | Train Loss: 0.623 Vali Loss: 5.861 Vali Acc: 0.099 Test Loss: 5.861 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.9954125
	speed: 0.6727s/iter; left time: 12806.5951s
	iters: 200, epoch: 9 | loss: 0.9513900
	speed: 0.2850s/iter; left time: 5396.6804s
Epoch: 9 cost time: 60.196285247802734
Epoch: 9, Steps: 208 | Train Loss: 0.496 Vali Loss: 6.459 Vali Acc: 0.095 Test Loss: 6.459 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3341566
	speed: 0.7068s/iter; left time: 13308.5307s
	iters: 200, epoch: 10 | loss: 0.3421836
	speed: 0.3106s/iter; left time: 5816.8016s
Epoch: 10 cost time: 66.06645774841309
Epoch: 10, Steps: 208 | Train Loss: 0.392 Vali Loss: 6.773 Vali Acc: 0.100 Test Loss: 6.773 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1830747
	speed: 0.6855s/iter; left time: 12763.8359s
	iters: 200, epoch: 11 | loss: 0.2741103
	speed: 0.2840s/iter; left time: 5260.0317s
Epoch: 11 cost time: 60.010239124298096
Epoch: 11, Steps: 208 | Train Loss: 0.353 Vali Loss: 7.222 Vali Acc: 0.089 Test Loss: 7.222 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1069450
	speed: 0.6865s/iter; left time: 12639.6878s
	iters: 200, epoch: 12 | loss: 0.5999766
	speed: 0.3184s/iter; left time: 5830.3497s
Epoch: 12 cost time: 64.86684823036194
Epoch: 12, Steps: 208 | Train Loss: 0.321 Vali Loss: 7.619 Vali Acc: 0.098 Test Loss: 7.619 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3076582
	speed: 0.6718s/iter; left time: 12230.9407s
	iters: 200, epoch: 13 | loss: 1.0248578
	speed: 0.2863s/iter; left time: 5182.7013s
Epoch: 13 cost time: 60.01442527770996
Epoch: 13, Steps: 208 | Train Loss: 0.281 Vali Loss: 7.835 Vali Acc: 0.097 Test Loss: 7.835 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1632638
	speed: 0.6985s/iter; left time: 12571.1512s
	iters: 200, epoch: 14 | loss: 0.5231184
	speed: 0.3169s/iter; left time: 5671.6583s
Epoch: 14 cost time: 64.72473645210266
Epoch: 14, Steps: 208 | Train Loss: 0.259 Vali Loss: 8.318 Vali Acc: 0.093 Test Loss: 8.318 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1082014
	speed: 0.7312s/iter; left time: 13007.6487s
	iters: 200, epoch: 15 | loss: 0.0651389
	speed: 0.2934s/iter; left time: 5189.9091s
Epoch: 15 cost time: 62.349823236465454
Epoch: 15, Steps: 208 | Train Loss: 0.239 Vali Loss: 8.684 Vali Acc: 0.097 Test Loss: 8.684 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10348941246644795
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3686404
	speed: 0.2995s/iter; left time: 6200.1517s
	iters: 200, epoch: 1 | loss: 3.3948379
	speed: 0.2978s/iter; left time: 6134.7352s
Epoch: 1 cost time: 62.475682973861694
Epoch: 1, Steps: 208 | Train Loss: 3.611 Vali Loss: 3.460 Vali Acc: 0.069 Test Loss: 3.460 Test Acc: 0.069
Validation loss decreased (inf --> -0.068859).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7633035
	speed: 0.7352s/iter; left time: 15065.8907s
	iters: 200, epoch: 2 | loss: 2.4935107
	speed: 0.3203s/iter; left time: 6531.8935s
Epoch: 2 cost time: 67.65121746063232
Epoch: 2, Steps: 208 | Train Loss: 3.110 Vali Loss: 3.569 Vali Acc: 0.088 Test Loss: 3.569 Test Acc: 0.088
Validation loss decreased (-0.068859 --> -0.087647).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3627965
	speed: 0.7525s/iter; left time: 15264.5880s
	iters: 200, epoch: 3 | loss: 2.9179304
	speed: 0.3278s/iter; left time: 6617.1366s
Epoch: 3 cost time: 68.86462497711182
Epoch: 3, Steps: 208 | Train Loss: 2.559 Vali Loss: 3.710 Vali Acc: 0.101 Test Loss: 3.710 Test Acc: 0.101
Validation loss decreased (-0.087647 --> -0.100470).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2879391
	speed: 0.7518s/iter; left time: 15094.0973s
	iters: 200, epoch: 4 | loss: 2.3890610
	speed: 0.3143s/iter; left time: 6279.5661s
Epoch: 4 cost time: 65.65977144241333
Epoch: 4, Steps: 208 | Train Loss: 2.061 Vali Loss: 4.018 Vali Acc: 0.100 Test Loss: 4.018 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9487238
	speed: 0.7380s/iter; left time: 14663.5966s
	iters: 200, epoch: 5 | loss: 2.5952435
	speed: 0.3328s/iter; left time: 6578.1898s
Epoch: 5 cost time: 67.25003004074097
Epoch: 5, Steps: 208 | Train Loss: 1.524 Vali Loss: 4.327 Vali Acc: 0.099 Test Loss: 4.327 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5614026
	speed: 0.7504s/iter; left time: 14753.2685s
	iters: 200, epoch: 6 | loss: 1.2191943
	speed: 0.3449s/iter; left time: 6747.0072s
Epoch: 6 cost time: 69.98854541778564
Epoch: 6, Steps: 208 | Train Loss: 1.121 Vali Loss: 4.963 Vali Acc: 0.099 Test Loss: 4.963 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4071516
	speed: 0.7803s/iter; left time: 15178.8108s
	iters: 200, epoch: 7 | loss: 0.9186794
	speed: 0.3136s/iter; left time: 6069.3634s
Epoch: 7 cost time: 66.85366725921631
Epoch: 7, Steps: 208 | Train Loss: 0.791 Vali Loss: 5.462 Vali Acc: 0.093 Test Loss: 5.462 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4652108
	speed: 0.7553s/iter; left time: 14536.6633s
	iters: 200, epoch: 8 | loss: 0.9313748
	speed: 0.3105s/iter; left time: 5944.0628s
Epoch: 8 cost time: 65.45313167572021
Epoch: 8, Steps: 208 | Train Loss: 0.609 Vali Loss: 5.850 Vali Acc: 0.086 Test Loss: 5.850 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2955381
	speed: 0.7706s/iter; left time: 14669.3121s
	iters: 200, epoch: 9 | loss: 0.3103667
	speed: 0.3599s/iter; left time: 6816.2233s
Epoch: 9 cost time: 73.24476766586304
Epoch: 9, Steps: 208 | Train Loss: 0.467 Vali Loss: 6.525 Vali Acc: 0.096 Test Loss: 6.525 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.4487389
	speed: 0.7786s/iter; left time: 14660.5274s
	iters: 200, epoch: 10 | loss: 0.3706811
	speed: 0.3109s/iter; left time: 5822.9228s
Epoch: 10 cost time: 65.6801118850708
Epoch: 10, Steps: 208 | Train Loss: 0.389 Vali Loss: 6.898 Vali Acc: 0.097 Test Loss: 6.898 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2201901
	speed: 0.7354s/iter; left time: 13693.2951s
	iters: 200, epoch: 11 | loss: 0.4122095
	speed: 0.3133s/iter; left time: 5801.7339s
Epoch: 11 cost time: 66.15471172332764
Epoch: 11, Steps: 208 | Train Loss: 0.321 Vali Loss: 7.357 Vali Acc: 0.095 Test Loss: 7.357 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0475768
	speed: 0.6959s/iter; left time: 12813.3427s
	iters: 200, epoch: 12 | loss: 0.2962361
	speed: 0.3194s/iter; left time: 5848.3760s
Epoch: 12 cost time: 64.69598150253296
Epoch: 12, Steps: 208 | Train Loss: 0.274 Vali Loss: 7.674 Vali Acc: 0.099 Test Loss: 7.674 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1606542
	speed: 0.7694s/iter; left time: 14006.7499s
	iters: 200, epoch: 13 | loss: 0.5065327
	speed: 0.3063s/iter; left time: 5546.1252s
Epoch: 13 cost time: 65.00655174255371
Epoch: 13, Steps: 208 | Train Loss: 0.268 Vali Loss: 8.281 Vali Acc: 0.098 Test Loss: 8.281 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10050700864897107
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5184755
	speed: 0.2985s/iter; left time: 6179.6174s
	iters: 200, epoch: 1 | loss: 3.3382664
	speed: 0.2854s/iter; left time: 5880.1831s
Epoch: 1 cost time: 60.943763256073
Epoch: 1, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.453 Vali Acc: 0.068 Test Loss: 3.453 Test Acc: 0.068
Validation loss decreased (inf --> -0.068263).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7395086
	speed: 0.7125s/iter; left time: 14601.5809s
	iters: 200, epoch: 2 | loss: 2.6499429
	speed: 0.3644s/iter; left time: 7430.5412s
Epoch: 2 cost time: 70.01371741294861
Epoch: 2, Steps: 208 | Train Loss: 3.129 Vali Loss: 3.581 Vali Acc: 0.088 Test Loss: 3.581 Test Acc: 0.088
Validation loss decreased (-0.068263 --> -0.088243).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6865950
	speed: 0.8127s/iter; left time: 16486.4393s
	iters: 200, epoch: 3 | loss: 3.1107776
	speed: 0.3213s/iter; left time: 6485.5301s
Epoch: 3 cost time: 66.97195506095886
Epoch: 3, Steps: 208 | Train Loss: 2.566 Vali Loss: 3.717 Vali Acc: 0.099 Test Loss: 3.717 Test Acc: 0.099
Validation loss decreased (-0.088243 --> -0.098979).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2134652
	speed: 0.7645s/iter; left time: 15349.7527s
	iters: 200, epoch: 4 | loss: 2.5362306
	speed: 0.3182s/iter; left time: 6355.7955s
Epoch: 4 cost time: 67.14239931106567
Epoch: 4, Steps: 208 | Train Loss: 2.071 Vali Loss: 4.057 Vali Acc: 0.097 Test Loss: 4.057 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8492457
	speed: 0.7901s/iter; left time: 15698.3502s
	iters: 200, epoch: 5 | loss: 2.4256086
	speed: 0.3327s/iter; left time: 6577.8741s
Epoch: 5 cost time: 70.45523643493652
Epoch: 5, Steps: 208 | Train Loss: 1.558 Vali Loss: 4.408 Vali Acc: 0.100 Test Loss: 4.408 Test Acc: 0.100
Validation loss decreased (-0.098979 --> -0.099866).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5675920
	speed: 0.7739s/iter; left time: 15215.9700s
	iters: 200, epoch: 6 | loss: 1.5125886
	speed: 0.3395s/iter; left time: 6640.9170s
Epoch: 6 cost time: 70.38536167144775
Epoch: 6, Steps: 208 | Train Loss: 1.152 Vali Loss: 4.990 Vali Acc: 0.096 Test Loss: 4.990 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5417765
	speed: 0.7223s/iter; left time: 14049.9999s
	iters: 200, epoch: 7 | loss: 1.1957648
	speed: 0.2977s/iter; left time: 5761.9541s
Epoch: 7 cost time: 62.1851372718811
Epoch: 7, Steps: 208 | Train Loss: 0.814 Vali Loss: 5.436 Vali Acc: 0.091 Test Loss: 5.436 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4794884
	speed: 0.6805s/iter; left time: 13096.5168s
	iters: 200, epoch: 8 | loss: 0.4444286
	speed: 0.2976s/iter; left time: 5698.1244s
Epoch: 8 cost time: 62.0625786781311
Epoch: 8, Steps: 208 | Train Loss: 0.612 Vali Loss: 5.848 Vali Acc: 0.096 Test Loss: 5.848 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7920988
	speed: 0.7020s/iter; left time: 13363.9414s
	iters: 200, epoch: 9 | loss: 0.6379969
	speed: 0.2941s/iter; left time: 5569.7466s
Epoch: 9 cost time: 62.46596574783325
Epoch: 9, Steps: 208 | Train Loss: 0.495 Vali Loss: 6.471 Vali Acc: 0.100 Test Loss: 6.471 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2883227
	speed: 0.6981s/iter; left time: 13144.7104s
	iters: 200, epoch: 10 | loss: 0.3373666
	speed: 0.2836s/iter; left time: 5311.7129s
Epoch: 10 cost time: 60.50567388534546
Epoch: 10, Steps: 208 | Train Loss: 0.396 Vali Loss: 6.694 Vali Acc: 0.097 Test Loss: 6.694 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1095172
	speed: 0.7166s/iter; left time: 13343.6516s
	iters: 200, epoch: 11 | loss: 0.1344693
	speed: 0.2948s/iter; left time: 5460.5471s
Epoch: 11 cost time: 62.68788766860962
Epoch: 11, Steps: 208 | Train Loss: 0.340 Vali Loss: 7.204 Vali Acc: 0.094 Test Loss: 7.204 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3211086
	speed: 0.7428s/iter; left time: 13677.5035s
	iters: 200, epoch: 12 | loss: 0.9582193
	speed: 0.3064s/iter; left time: 5610.4748s
Epoch: 12 cost time: 63.855265378952026
Epoch: 12, Steps: 208 | Train Loss: 0.316 Vali Loss: 7.801 Vali Acc: 0.099 Test Loss: 7.801 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1910273
	speed: 0.6939s/iter; left time: 12632.6668s
	iters: 200, epoch: 13 | loss: 0.6350302
	speed: 0.3007s/iter; left time: 5444.0821s
Epoch: 13 cost time: 61.97016930580139
Epoch: 13, Steps: 208 | Train Loss: 0.281 Vali Loss: 8.018 Vali Acc: 0.094 Test Loss: 8.018 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3499549
	speed: 0.7624s/iter; left time: 13721.4260s
	iters: 200, epoch: 14 | loss: 0.2883103
	speed: 0.3062s/iter; left time: 5480.0135s
Epoch: 14 cost time: 66.42062997817993
Epoch: 14, Steps: 208 | Train Loss: 0.273 Vali Loss: 8.118 Vali Acc: 0.095 Test Loss: 8.118 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2984823
	speed: 0.8082s/iter; left time: 14376.7258s
	iters: 200, epoch: 15 | loss: 0.0542461
	speed: 0.3314s/iter; left time: 5862.2959s
Epoch: 15 cost time: 69.98429870605469
Epoch: 15, Steps: 208 | Train Loss: 0.235 Vali Loss: 8.658 Vali Acc: 0.089 Test Loss: 8.658 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09991052788547569
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5762935
	speed: 0.3235s/iter; left time: 6696.3866s
	iters: 200, epoch: 1 | loss: 3.4597518
	speed: 0.2984s/iter; left time: 6147.9286s
Epoch: 1 cost time: 64.63030886650085
Epoch: 1, Steps: 208 | Train Loss: 3.626 Vali Loss: 3.447 Vali Acc: 0.070 Test Loss: 3.447 Test Acc: 0.070
Validation loss decreased (inf --> -0.070052).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8230677
	speed: 0.7043s/iter; left time: 14432.8354s
	iters: 200, epoch: 2 | loss: 2.7150717
	speed: 0.2894s/iter; left time: 5902.4313s
Epoch: 2 cost time: 62.12979769706726
Epoch: 2, Steps: 208 | Train Loss: 3.120 Vali Loss: 3.521 Vali Acc: 0.088 Test Loss: 3.521 Test Acc: 0.088
Validation loss decreased (-0.070052 --> -0.087946).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4853518
	speed: 0.7522s/iter; left time: 15257.8090s
	iters: 200, epoch: 3 | loss: 3.0212481
	speed: 0.3229s/iter; left time: 6518.4861s
Epoch: 3 cost time: 67.27536749839783
Epoch: 3, Steps: 208 | Train Loss: 2.576 Vali Loss: 3.636 Vali Acc: 0.102 Test Loss: 3.636 Test Acc: 0.102
Validation loss decreased (-0.087946 --> -0.101962).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3394141
	speed: 0.7232s/iter; left time: 14519.8876s
	iters: 200, epoch: 4 | loss: 2.2498045
	speed: 0.2973s/iter; left time: 5938.3326s
Epoch: 4 cost time: 62.30629253387451
Epoch: 4, Steps: 208 | Train Loss: 2.061 Vali Loss: 3.943 Vali Acc: 0.107 Test Loss: 3.943 Test Acc: 0.107
Validation loss decreased (-0.101962 --> -0.106731).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1076026
	speed: 0.7484s/iter; left time: 14869.2516s
	iters: 200, epoch: 5 | loss: 2.4916365
	speed: 0.3358s/iter; left time: 6637.6884s
Epoch: 5 cost time: 69.1251072883606
Epoch: 5, Steps: 208 | Train Loss: 1.550 Vali Loss: 4.248 Vali Acc: 0.102 Test Loss: 4.248 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8436589
	speed: 0.8183s/iter; left time: 16087.6258s
	iters: 200, epoch: 6 | loss: 1.4924759
	speed: 0.3313s/iter; left time: 6481.4045s
Epoch: 6 cost time: 70.72689461708069
Epoch: 6, Steps: 208 | Train Loss: 1.157 Vali Loss: 4.918 Vali Acc: 0.100 Test Loss: 4.918 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6766537
	speed: 0.7760s/iter; left time: 15095.6917s
	iters: 200, epoch: 7 | loss: 1.3366760
	speed: 0.3316s/iter; left time: 6416.9697s
Epoch: 7 cost time: 68.42786049842834
Epoch: 7, Steps: 208 | Train Loss: 0.839 Vali Loss: 5.398 Vali Acc: 0.096 Test Loss: 5.398 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5839429
	speed: 0.7805s/iter; left time: 15019.9877s
	iters: 200, epoch: 8 | loss: 0.5483271
	speed: 0.3412s/iter; left time: 6531.4192s
Epoch: 8 cost time: 70.71706533432007
Epoch: 8, Steps: 208 | Train Loss: 0.624 Vali Loss: 5.768 Vali Acc: 0.103 Test Loss: 5.768 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7642359
	speed: 0.7869s/iter; left time: 14979.4649s
	iters: 200, epoch: 9 | loss: 0.7495664
	speed: 0.3347s/iter; left time: 6337.7948s
Epoch: 9 cost time: 70.28227305412292
Epoch: 9, Steps: 208 | Train Loss: 0.503 Vali Loss: 6.321 Vali Acc: 0.102 Test Loss: 6.321 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5986195
	speed: 0.7590s/iter; left time: 14291.6748s
	iters: 200, epoch: 10 | loss: 0.6320456
	speed: 0.3227s/iter; left time: 6043.8759s
Epoch: 10 cost time: 66.7944552898407
Epoch: 10, Steps: 208 | Train Loss: 0.424 Vali Loss: 6.711 Vali Acc: 0.100 Test Loss: 6.711 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4710053
	speed: 0.7642s/iter; left time: 14229.7031s
	iters: 200, epoch: 11 | loss: 0.5098273
	speed: 0.3354s/iter; left time: 6211.7527s
Epoch: 11 cost time: 69.03121519088745
Epoch: 11, Steps: 208 | Train Loss: 0.374 Vali Loss: 7.113 Vali Acc: 0.099 Test Loss: 7.113 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1256896
	speed: 0.7606s/iter; left time: 14005.3405s
	iters: 200, epoch: 12 | loss: 0.6480937
	speed: 0.3206s/iter; left time: 5871.5735s
Epoch: 12 cost time: 68.56819176673889
Epoch: 12, Steps: 208 | Train Loss: 0.312 Vali Loss: 7.497 Vali Acc: 0.106 Test Loss: 7.497 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1264789
	speed: 0.7887s/iter; left time: 14358.4373s
	iters: 200, epoch: 13 | loss: 0.6585953
	speed: 0.3500s/iter; left time: 6336.4743s
Epoch: 13 cost time: 72.52923536300659
Epoch: 13, Steps: 208 | Train Loss: 0.293 Vali Loss: 7.935 Vali Acc: 0.105 Test Loss: 7.935 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0349750
	speed: 0.7825s/iter; left time: 14082.3111s
	iters: 200, epoch: 14 | loss: 0.2269722
	speed: 0.3099s/iter; left time: 5545.7756s
Epoch: 14 cost time: 66.26057434082031
Epoch: 14, Steps: 208 | Train Loss: 0.247 Vali Loss: 8.070 Vali Acc: 0.093 Test Loss: 8.070 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10677005666567253
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5565557
	speed: 0.3226s/iter; left time: 6677.8527s
	iters: 200, epoch: 1 | loss: 3.5528669
	speed: 0.3367s/iter; left time: 6935.3835s
Epoch: 1 cost time: 69.33454751968384
Epoch: 1, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.485 Vali Acc: 0.055 Test Loss: 3.485 Test Acc: 0.055
Validation loss decreased (inf --> -0.054543).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0377297
	speed: 0.8314s/iter; left time: 17038.2935s
	iters: 200, epoch: 2 | loss: 2.7983689
	speed: 0.3188s/iter; left time: 6502.0709s
Epoch: 2 cost time: 69.05013823509216
Epoch: 2, Steps: 208 | Train Loss: 3.131 Vali Loss: 3.608 Vali Acc: 0.076 Test Loss: 3.608 Test Acc: 0.076
Validation loss decreased (-0.054543 --> -0.075717).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1932390
	speed: 0.7560s/iter; left time: 15335.8667s
	iters: 200, epoch: 3 | loss: 2.9987841
	speed: 0.3098s/iter; left time: 6254.0252s
Epoch: 3 cost time: 65.65404868125916
Epoch: 3, Steps: 208 | Train Loss: 2.616 Vali Loss: 3.744 Vali Acc: 0.093 Test Loss: 3.744 Test Acc: 0.093
Validation loss decreased (-0.075717 --> -0.093014).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3606238
	speed: 0.7581s/iter; left time: 15220.6994s
	iters: 200, epoch: 4 | loss: 2.2162247
	speed: 0.3230s/iter; left time: 6452.5044s
Epoch: 4 cost time: 68.39466047286987
Epoch: 4, Steps: 208 | Train Loss: 2.094 Vali Loss: 3.925 Vali Acc: 0.093 Test Loss: 3.925 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9859375
	speed: 0.7578s/iter; left time: 15056.9881s
	iters: 200, epoch: 5 | loss: 2.5886893
	speed: 0.3160s/iter; left time: 6246.9991s
Epoch: 5 cost time: 65.67960333824158
Epoch: 5, Steps: 208 | Train Loss: 1.583 Vali Loss: 4.254 Vali Acc: 0.109 Test Loss: 4.254 Test Acc: 0.109
Validation loss decreased (-0.093014 --> -0.108517).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8082336
	speed: 0.7505s/iter; left time: 14756.4995s
	iters: 200, epoch: 6 | loss: 1.4125443
	speed: 0.3183s/iter; left time: 6225.4858s
Epoch: 6 cost time: 67.58128190040588
Epoch: 6, Steps: 208 | Train Loss: 1.202 Vali Loss: 4.791 Vali Acc: 0.097 Test Loss: 4.791 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4743345
	speed: 0.8000s/iter; left time: 15561.8431s
	iters: 200, epoch: 7 | loss: 0.9226729
	speed: 0.3007s/iter; left time: 5818.7341s
Epoch: 7 cost time: 66.0004951953888
Epoch: 7, Steps: 208 | Train Loss: 0.841 Vali Loss: 5.331 Vali Acc: 0.101 Test Loss: 5.331 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4247574
	speed: 0.7458s/iter; left time: 14352.9002s
	iters: 200, epoch: 8 | loss: 0.6055700
	speed: 0.3143s/iter; left time: 6016.8423s
Epoch: 8 cost time: 65.96065139770508
Epoch: 8, Steps: 208 | Train Loss: 0.664 Vali Loss: 5.618 Vali Acc: 0.104 Test Loss: 5.618 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.9066479
	speed: 0.7465s/iter; left time: 14210.1833s
	iters: 200, epoch: 9 | loss: 1.4287943
	speed: 0.3168s/iter; left time: 5999.6100s
Epoch: 9 cost time: 67.8632504940033
Epoch: 9, Steps: 208 | Train Loss: 0.553 Vali Loss: 6.050 Vali Acc: 0.107 Test Loss: 6.050 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5503002
	speed: 0.7201s/iter; left time: 13559.1160s
	iters: 200, epoch: 10 | loss: 0.9718245
	speed: 0.2897s/iter; left time: 5426.3526s
Epoch: 10 cost time: 61.98412895202637
Epoch: 10, Steps: 208 | Train Loss: 0.457 Vali Loss: 6.472 Vali Acc: 0.099 Test Loss: 6.472 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2187100
	speed: 0.6987s/iter; left time: 13010.8209s
	iters: 200, epoch: 11 | loss: 0.3308314
	speed: 0.2956s/iter; left time: 5475.0072s
Epoch: 11 cost time: 61.7361958026886
Epoch: 11, Steps: 208 | Train Loss: 0.393 Vali Loss: 7.118 Vali Acc: 0.100 Test Loss: 7.118 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3279145
	speed: 0.6888s/iter; left time: 12682.5201s
	iters: 200, epoch: 12 | loss: 0.5782071
	speed: 0.2951s/iter; left time: 5404.2644s
Epoch: 12 cost time: 61.41497588157654
Epoch: 12, Steps: 208 | Train Loss: 0.343 Vali Loss: 7.393 Vali Acc: 0.103 Test Loss: 7.393 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3067905
	speed: 0.6921s/iter; left time: 12599.2039s
	iters: 200, epoch: 13 | loss: 1.0995034
	speed: 0.3195s/iter; left time: 5784.0779s
Epoch: 13 cost time: 65.40655946731567
Epoch: 13, Steps: 208 | Train Loss: 0.341 Vali Loss: 7.591 Vali Acc: 0.106 Test Loss: 7.591 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1687313
	speed: 0.7340s/iter; left time: 13209.7138s
	iters: 200, epoch: 14 | loss: 0.6395576
	speed: 0.2977s/iter; left time: 5328.5498s
Epoch: 14 cost time: 64.18528866767883
Epoch: 14, Steps: 208 | Train Loss: 0.297 Vali Loss: 7.892 Vali Acc: 0.102 Test Loss: 7.892 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0358433
	speed: 0.7123s/iter; left time: 12671.1044s
	iters: 200, epoch: 15 | loss: 0.2525841
	speed: 0.3159s/iter; left time: 5587.6997s
Epoch: 15 cost time: 64.61086082458496
Epoch: 15, Steps: 208 | Train Loss: 0.273 Vali Loss: 8.230 Vali Acc: 0.097 Test Loss: 8.230 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10855949895615867
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3984816
	speed: 0.3183s/iter; left time: 6588.7477s
	iters: 200, epoch: 1 | loss: 3.4380355
	speed: 0.3267s/iter; left time: 6729.9184s
Epoch: 1 cost time: 67.52381825447083
Epoch: 1, Steps: 208 | Train Loss: 3.601 Vali Loss: 3.462 Vali Acc: 0.061 Test Loss: 3.462 Test Acc: 0.061
Validation loss decreased (inf --> -0.061105).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8877103
	speed: 0.7645s/iter; left time: 15665.9509s
	iters: 200, epoch: 2 | loss: 2.8181820
	speed: 0.3200s/iter; left time: 6526.0243s
Epoch: 2 cost time: 67.5481379032135
Epoch: 2, Steps: 208 | Train Loss: 3.104 Vali Loss: 3.620 Vali Acc: 0.081 Test Loss: 3.620 Test Acc: 0.081
Validation loss decreased (-0.061105 --> -0.080787).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4645588
	speed: 0.7581s/iter; left time: 15377.9208s
	iters: 200, epoch: 3 | loss: 2.3047287
	speed: 0.2890s/iter; left time: 5833.0548s
Epoch: 3 cost time: 64.24891519546509
Epoch: 3, Steps: 208 | Train Loss: 2.661 Vali Loss: 3.755 Vali Acc: 0.091 Test Loss: 3.755 Test Acc: 0.091
Validation loss decreased (-0.080787 --> -0.090628).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1772795
	speed: 0.7185s/iter; left time: 14425.3729s
	iters: 200, epoch: 4 | loss: 2.7312999
	speed: 0.3094s/iter; left time: 6181.7272s
Epoch: 4 cost time: 64.64895272254944
Epoch: 4, Steps: 208 | Train Loss: 2.263 Vali Loss: 3.993 Vali Acc: 0.091 Test Loss: 3.993 Test Acc: 0.091
Validation loss decreased (-0.090628 --> -0.091222).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2255200
	speed: 0.7338s/iter; left time: 14579.1910s
	iters: 200, epoch: 5 | loss: 2.0318348
	speed: 0.2984s/iter; left time: 5898.7695s
Epoch: 5 cost time: 64.49048638343811
Epoch: 5, Steps: 208 | Train Loss: 1.808 Vali Loss: 4.197 Vali Acc: 0.099 Test Loss: 4.197 Test Acc: 0.099
Validation loss decreased (-0.091222 --> -0.098974).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2661846
	speed: 0.7158s/iter; left time: 14072.8573s
	iters: 200, epoch: 6 | loss: 1.8268715
	speed: 0.3011s/iter; left time: 5889.6665s
Epoch: 6 cost time: 63.86578416824341
Epoch: 6, Steps: 208 | Train Loss: 1.459 Vali Loss: 4.718 Vali Acc: 0.092 Test Loss: 4.718 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4442987
	speed: 0.7111s/iter; left time: 13833.3675s
	iters: 200, epoch: 7 | loss: 1.1980455
	speed: 0.3034s/iter; left time: 5871.6929s
Epoch: 7 cost time: 63.40458130836487
Epoch: 7, Steps: 208 | Train Loss: 1.095 Vali Loss: 5.028 Vali Acc: 0.094 Test Loss: 5.028 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7442769
	speed: 0.7081s/iter; left time: 13628.0632s
	iters: 200, epoch: 8 | loss: 0.5713332
	speed: 0.2907s/iter; left time: 5565.8424s
Epoch: 8 cost time: 61.359811305999756
Epoch: 8, Steps: 208 | Train Loss: 0.873 Vali Loss: 5.324 Vali Acc: 0.096 Test Loss: 5.324 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3786796
	speed: 0.6908s/iter; left time: 13151.0136s
	iters: 200, epoch: 9 | loss: 1.5455234
	speed: 0.2950s/iter; left time: 5585.6384s
Epoch: 9 cost time: 61.10368084907532
Epoch: 9, Steps: 208 | Train Loss: 0.707 Vali Loss: 5.899 Vali Acc: 0.098 Test Loss: 5.899 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5747200
	speed: 0.6944s/iter; left time: 13074.0916s
	iters: 200, epoch: 10 | loss: 0.8524047
	speed: 0.2982s/iter; left time: 5585.7516s
Epoch: 10 cost time: 61.2282133102417
Epoch: 10, Steps: 208 | Train Loss: 0.671 Vali Loss: 6.177 Vali Acc: 0.095 Test Loss: 6.177 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3559946
	speed: 0.7221s/iter; left time: 13446.4585s
	iters: 200, epoch: 11 | loss: 0.5654274
	speed: 0.2976s/iter; left time: 5511.6870s
Epoch: 11 cost time: 63.10660457611084
Epoch: 11, Steps: 208 | Train Loss: 0.541 Vali Loss: 6.502 Vali Acc: 0.098 Test Loss: 6.502 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2757814
	speed: 0.7209s/iter; left time: 13273.0403s
	iters: 200, epoch: 12 | loss: 0.6630979
	speed: 0.2964s/iter; left time: 5428.0562s
Epoch: 12 cost time: 63.32052969932556
Epoch: 12, Steps: 208 | Train Loss: 0.462 Vali Loss: 6.884 Vali Acc: 0.101 Test Loss: 6.884 Test Acc: 0.101
Validation loss decreased (-0.098974 --> -0.100438).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2326191
	speed: 0.7112s/iter; left time: 12946.7501s
	iters: 200, epoch: 13 | loss: 0.6721362
	speed: 0.3040s/iter; left time: 5503.9314s
Epoch: 13 cost time: 63.80983066558838
Epoch: 13, Steps: 208 | Train Loss: 0.462 Vali Loss: 7.047 Vali Acc: 0.098 Test Loss: 7.047 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3263713
	speed: 0.7199s/iter; left time: 12956.6479s
	iters: 200, epoch: 14 | loss: 0.6345642
	speed: 0.2968s/iter; left time: 5312.4045s
Epoch: 14 cost time: 62.301557302474976
Epoch: 14, Steps: 208 | Train Loss: 0.400 Vali Loss: 7.492 Vali Acc: 0.091 Test Loss: 7.492 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1767025
	speed: 0.7279s/iter; left time: 12948.6631s
	iters: 200, epoch: 15 | loss: 0.3675108
	speed: 0.3181s/iter; left time: 5626.1256s
Epoch: 15 cost time: 66.04415702819824
Epoch: 15, Steps: 208 | Train Loss: 0.345 Vali Loss: 7.654 Vali Acc: 0.105 Test Loss: 7.654 Test Acc: 0.105
Validation loss decreased (-0.100438 --> -0.104606).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3781930
	speed: 0.7504s/iter; left time: 13192.6520s
	iters: 200, epoch: 16 | loss: 0.3640813
	speed: 0.3025s/iter; left time: 5288.6442s
Epoch: 16 cost time: 64.42921662330627
Epoch: 16, Steps: 208 | Train Loss: 0.329 Vali Loss: 7.973 Vali Acc: 0.092 Test Loss: 7.973 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4064336
	speed: 0.7418s/iter; left time: 12886.4432s
	iters: 200, epoch: 17 | loss: 0.5045342
	speed: 0.2919s/iter; left time: 5041.4429s
Epoch: 17 cost time: 63.43939924240112
Epoch: 17, Steps: 208 | Train Loss: 0.299 Vali Loss: 8.226 Vali Acc: 0.094 Test Loss: 8.226 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4005525
	speed: 0.7320s/iter; left time: 12564.1580s
	iters: 200, epoch: 18 | loss: 0.2249961
	speed: 0.3257s/iter; left time: 5557.7034s
Epoch: 18 cost time: 66.81749439239502
Epoch: 18, Steps: 208 | Train Loss: 0.263 Vali Loss: 8.403 Vali Acc: 0.099 Test Loss: 8.403 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0197159
	speed: 0.7827s/iter; left time: 13271.9508s
	iters: 200, epoch: 19 | loss: 0.2572567
	speed: 0.3149s/iter; left time: 5307.8541s
Epoch: 19 cost time: 66.07827281951904
Epoch: 19, Steps: 208 | Train Loss: 0.264 Vali Loss: 8.486 Vali Acc: 0.096 Test Loss: 8.486 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1662065
	speed: 0.7212s/iter; left time: 12080.0129s
	iters: 200, epoch: 20 | loss: 0.1720789
	speed: 0.2912s/iter; left time: 4848.9387s
Epoch: 20 cost time: 61.70805788040161
Epoch: 20, Steps: 208 | Train Loss: 0.255 Vali Loss: 8.696 Vali Acc: 0.106 Test Loss: 8.696 Test Acc: 0.106
Validation loss decreased (-0.104606 --> -0.106385).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3557685
	speed: 0.7180s/iter; left time: 11876.8559s
	iters: 200, epoch: 21 | loss: 0.7429378
	speed: 0.3197s/iter; left time: 5255.8553s
Epoch: 21 cost time: 66.33466029167175
Epoch: 21, Steps: 208 | Train Loss: 0.260 Vali Loss: 8.917 Vali Acc: 0.105 Test Loss: 8.917 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1087056
	speed: 0.7416s/iter; left time: 12112.9587s
	iters: 200, epoch: 22 | loss: 0.4076291
	speed: 0.3328s/iter; left time: 5402.0604s
Epoch: 22 cost time: 67.91435289382935
Epoch: 22, Steps: 208 | Train Loss: 0.212 Vali Loss: 9.242 Vali Acc: 0.098 Test Loss: 9.242 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.3208438
	speed: 0.7721s/iter; left time: 12450.5060s
	iters: 200, epoch: 23 | loss: 0.3176079
	speed: 0.3269s/iter; left time: 5238.6681s
Epoch: 23 cost time: 68.98749613761902
Epoch: 23, Steps: 208 | Train Loss: 0.202 Vali Loss: 9.441 Vali Acc: 0.100 Test Loss: 9.441 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0505725
	speed: 0.7986s/iter; left time: 12711.9108s
	iters: 200, epoch: 24 | loss: 0.4363135
	speed: 0.3477s/iter; left time: 5499.2195s
Epoch: 24 cost time: 72.77829313278198
Epoch: 24, Steps: 208 | Train Loss: 0.203 Vali Loss: 9.600 Vali Acc: 0.099 Test Loss: 9.600 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1561842
	speed: 0.8099s/iter; left time: 12723.0707s
	iters: 200, epoch: 25 | loss: 0.1869928
	speed: 0.3427s/iter; left time: 5349.4386s
Epoch: 25 cost time: 71.77751231193542
Epoch: 25, Steps: 208 | Train Loss: 0.195 Vali Loss: 9.610 Vali Acc: 0.102 Test Loss: 9.610 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0037434
	speed: 0.8230s/iter; left time: 12756.7403s
	iters: 200, epoch: 26 | loss: 0.4495485
	speed: 0.3413s/iter; left time: 5257.1101s
Epoch: 26 cost time: 72.4182608127594
Epoch: 26, Steps: 208 | Train Loss: 0.171 Vali Loss: 10.033 Vali Acc: 0.102 Test Loss: 10.033 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1165192
	speed: 0.7833s/iter; left time: 11979.0446s
	iters: 200, epoch: 27 | loss: 0.7610112
	speed: 0.3161s/iter; left time: 4802.7606s
Epoch: 27 cost time: 65.92288160324097
Epoch: 27, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.022 Vali Acc: 0.098 Test Loss: 10.022 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0343476
	speed: 0.7283s/iter; left time: 10987.0315s
	iters: 200, epoch: 28 | loss: 0.0674721
	speed: 0.3001s/iter; left time: 4496.5803s
Epoch: 28 cost time: 64.24822735786438
Epoch: 28, Steps: 208 | Train Loss: 0.182 Vali Loss: 10.072 Vali Acc: 0.098 Test Loss: 10.072 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.5059811
	speed: 0.7660s/iter; left time: 11395.5061s
	iters: 200, epoch: 29 | loss: 0.1186449
	speed: 0.3339s/iter; left time: 4933.3347s
Epoch: 29 cost time: 69.4210684299469
Epoch: 29, Steps: 208 | Train Loss: 0.146 Vali Loss: 10.235 Vali Acc: 0.096 Test Loss: 10.235 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1600439
	speed: 0.8064s/iter; left time: 11828.4851s
	iters: 200, epoch: 30 | loss: 0.0035015
	speed: 0.3431s/iter; left time: 4998.1644s
Epoch: 30 cost time: 71.94615960121155
Epoch: 30, Steps: 208 | Train Loss: 0.153 Vali Loss: 10.544 Vali Acc: 0.095 Test Loss: 10.544 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10647181628392484
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3316042
	speed: 0.3374s/iter; left time: 6983.9565s
	iters: 200, epoch: 1 | loss: 3.4636769
	speed: 0.3283s/iter; left time: 6763.0648s
Epoch: 1 cost time: 69.52152943611145
Epoch: 1, Steps: 208 | Train Loss: 3.606 Vali Loss: 3.520 Vali Acc: 0.049 Test Loss: 3.520 Test Acc: 0.049
Validation loss decreased (inf --> -0.048578).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0195179
	speed: 0.8375s/iter; left time: 17161.8786s
	iters: 200, epoch: 2 | loss: 2.9927447
	speed: 0.3547s/iter; left time: 7233.7904s
Epoch: 2 cost time: 74.3808524608612
Epoch: 2, Steps: 208 | Train Loss: 3.190 Vali Loss: 3.608 Vali Acc: 0.073 Test Loss: 3.608 Test Acc: 0.073
Validation loss decreased (-0.048578 --> -0.073331).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8318772
	speed: 0.8547s/iter; left time: 17337.3075s
	iters: 200, epoch: 3 | loss: 3.1250670
	speed: 0.3472s/iter; left time: 7007.5033s
Epoch: 3 cost time: 74.08973050117493
Epoch: 3, Steps: 208 | Train Loss: 2.831 Vali Loss: 3.864 Vali Acc: 0.074 Test Loss: 3.864 Test Acc: 0.074
Validation loss decreased (-0.073331 --> -0.074223).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7939892
	speed: 0.8827s/iter; left time: 17722.5706s
	iters: 200, epoch: 4 | loss: 2.5625803
	speed: 0.3711s/iter; left time: 7412.9440s
Epoch: 4 cost time: 77.92126035690308
Epoch: 4, Steps: 208 | Train Loss: 2.546 Vali Loss: 3.881 Vali Acc: 0.078 Test Loss: 3.881 Test Acc: 0.078
Validation loss decreased (-0.074223 --> -0.077504).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8566999
	speed: 0.8654s/iter; left time: 17194.9227s
	iters: 200, epoch: 5 | loss: 3.1508791
	speed: 0.3535s/iter; left time: 6988.4014s
Epoch: 5 cost time: 75.38775134086609
Epoch: 5, Steps: 208 | Train Loss: 2.173 Vali Loss: 4.214 Vali Acc: 0.079 Test Loss: 4.214 Test Acc: 0.079
Validation loss decreased (-0.077504 --> -0.078693).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0842583
	speed: 0.8508s/iter; left time: 16728.1325s
	iters: 200, epoch: 6 | loss: 2.6068623
	speed: 0.3728s/iter; left time: 7293.1788s
Epoch: 6 cost time: 78.10475611686707
Epoch: 6, Steps: 208 | Train Loss: 1.829 Vali Loss: 4.566 Vali Acc: 0.077 Test Loss: 4.566 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4404876
	speed: 0.8814s/iter; left time: 17145.9151s
	iters: 200, epoch: 7 | loss: 2.1541610
	speed: 0.3762s/iter; left time: 7280.3175s
Epoch: 7 cost time: 77.25637698173523
Epoch: 7, Steps: 208 | Train Loss: 1.494 Vali Loss: 4.748 Vali Acc: 0.084 Test Loss: 4.748 Test Acc: 0.084
Validation loss decreased (-0.078693 --> -0.083460).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1190218
	speed: 0.8482s/iter; left time: 16323.6357s
	iters: 200, epoch: 8 | loss: 1.1302958
	speed: 0.3645s/iter; left time: 6977.7745s
Epoch: 8 cost time: 75.91577744483948
Epoch: 8, Steps: 208 | Train Loss: 1.217 Vali Loss: 5.024 Vali Acc: 0.080 Test Loss: 5.024 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6782737
	speed: 0.8735s/iter; left time: 16629.7045s
	iters: 200, epoch: 9 | loss: 1.7672719
	speed: 0.3559s/iter; left time: 6740.2529s
Epoch: 9 cost time: 74.60166049003601
Epoch: 9, Steps: 208 | Train Loss: 0.964 Vali Loss: 5.570 Vali Acc: 0.083 Test Loss: 5.570 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0587993
	speed: 0.8227s/iter; left time: 15490.3780s
	iters: 200, epoch: 10 | loss: 0.9201033
	speed: 0.3128s/iter; left time: 5857.7710s
Epoch: 10 cost time: 68.68194842338562
Epoch: 10, Steps: 208 | Train Loss: 0.841 Vali Loss: 5.751 Vali Acc: 0.088 Test Loss: 5.751 Test Acc: 0.088
Validation loss decreased (-0.083460 --> -0.087625).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7659135
	speed: 0.7500s/iter; left time: 13965.6098s
	iters: 200, epoch: 11 | loss: 0.7802496
	speed: 0.3272s/iter; left time: 6060.8190s
Epoch: 11 cost time: 67.77060914039612
Epoch: 11, Steps: 208 | Train Loss: 0.695 Vali Loss: 6.171 Vali Acc: 0.084 Test Loss: 6.171 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4453419
	speed: 0.8196s/iter; left time: 15091.1268s
	iters: 200, epoch: 12 | loss: 1.0986031
	speed: 0.3415s/iter; left time: 6254.3370s
Epoch: 12 cost time: 71.87464475631714
Epoch: 12, Steps: 208 | Train Loss: 0.637 Vali Loss: 6.514 Vali Acc: 0.083 Test Loss: 6.514 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6199061
	speed: 0.8236s/iter; left time: 14993.5157s
	iters: 200, epoch: 13 | loss: 1.0298227
	speed: 0.3595s/iter; left time: 6507.8436s
Epoch: 13 cost time: 74.54500722885132
Epoch: 13, Steps: 208 | Train Loss: 0.552 Vali Loss: 6.905 Vali Acc: 0.088 Test Loss: 6.905 Test Acc: 0.088
Validation loss decreased (-0.087625 --> -0.087912).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1315698
	speed: 0.8236s/iter; left time: 14823.0685s
	iters: 200, epoch: 14 | loss: 1.0745974
	speed: 0.3741s/iter; left time: 6695.2739s
Epoch: 14 cost time: 76.44903254508972
Epoch: 14, Steps: 208 | Train Loss: 0.501 Vali Loss: 7.136 Vali Acc: 0.083 Test Loss: 7.136 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5194765
	speed: 0.8639s/iter; left time: 15368.4200s
	iters: 200, epoch: 15 | loss: 0.6238698
	speed: 0.3504s/iter; left time: 6198.6738s
Epoch: 15 cost time: 74.36940407752991
Epoch: 15, Steps: 208 | Train Loss: 0.476 Vali Loss: 7.312 Vali Acc: 0.093 Test Loss: 7.312 Test Acc: 0.093
Validation loss decreased (-0.087912 --> -0.093276).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4706734
	speed: 0.7926s/iter; left time: 13935.1437s
	iters: 200, epoch: 16 | loss: 0.4809473
	speed: 0.3317s/iter; left time: 5799.3080s
Epoch: 16 cost time: 69.32851910591125
Epoch: 16, Steps: 208 | Train Loss: 0.432 Vali Loss: 7.536 Vali Acc: 0.097 Test Loss: 7.536 Test Acc: 0.097
Validation loss decreased (-0.093276 --> -0.096555).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7855349
	speed: 0.8194s/iter; left time: 14235.2630s
	iters: 200, epoch: 17 | loss: 0.2611763
	speed: 0.3417s/iter; left time: 5902.6018s
Epoch: 17 cost time: 71.98577046394348
Epoch: 17, Steps: 208 | Train Loss: 0.401 Vali Loss: 8.039 Vali Acc: 0.088 Test Loss: 8.039 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3131373
	speed: 0.8287s/iter; left time: 14224.8877s
	iters: 200, epoch: 18 | loss: 0.4061306
	speed: 0.3506s/iter; left time: 5982.9020s
Epoch: 18 cost time: 73.26731896400452
Epoch: 18, Steps: 208 | Train Loss: 0.353 Vali Loss: 7.831 Vali Acc: 0.095 Test Loss: 7.831 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5145984
	speed: 0.8186s/iter; left time: 13881.5601s
	iters: 200, epoch: 19 | loss: 0.1994072
	speed: 0.3385s/iter; left time: 5706.0316s
Epoch: 19 cost time: 71.13204216957092
Epoch: 19, Steps: 208 | Train Loss: 0.342 Vali Loss: 8.354 Vali Acc: 0.095 Test Loss: 8.354 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1972965
	speed: 0.7412s/iter; left time: 12414.2403s
	iters: 200, epoch: 20 | loss: 0.1496662
	speed: 0.3149s/iter; left time: 5242.7721s
Epoch: 20 cost time: 64.73151063919067
Epoch: 20, Steps: 208 | Train Loss: 0.279 Vali Loss: 8.441 Vali Acc: 0.099 Test Loss: 8.441 Test Acc: 0.099
Validation loss decreased (-0.096555 --> -0.098931).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0315556
	speed: 0.7766s/iter; left time: 12846.4498s
	iters: 200, epoch: 21 | loss: 0.5326577
	speed: 0.3468s/iter; left time: 5701.0319s
Epoch: 21 cost time: 71.80720782279968
Epoch: 21, Steps: 208 | Train Loss: 0.302 Vali Loss: 8.458 Vali Acc: 0.097 Test Loss: 8.458 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1012227
	speed: 0.8356s/iter; left time: 13647.5268s
	iters: 200, epoch: 22 | loss: 0.2609617
	speed: 0.3422s/iter; left time: 5555.2173s
Epoch: 22 cost time: 73.06244230270386
Epoch: 22, Steps: 208 | Train Loss: 0.260 Vali Loss: 8.580 Vali Acc: 0.100 Test Loss: 8.580 Test Acc: 0.100
Validation loss decreased (-0.098931 --> -0.099526).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.4620008
	speed: 0.7911s/iter; left time: 12756.3976s
	iters: 200, epoch: 23 | loss: 0.6554899
	speed: 0.3235s/iter; left time: 5183.8374s
Epoch: 23 cost time: 68.13178563117981
Epoch: 23, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.075 Vali Acc: 0.103 Test Loss: 9.075 Test Acc: 0.103
Validation loss decreased (-0.099526 --> -0.103399).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2164761
	speed: 0.7655s/iter; left time: 12184.9459s
	iters: 200, epoch: 24 | loss: 0.4664170
	speed: 0.3327s/iter; left time: 5262.0953s
Epoch: 24 cost time: 67.52033400535583
Epoch: 24, Steps: 208 | Train Loss: 0.255 Vali Loss: 9.138 Vali Acc: 0.091 Test Loss: 9.138 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1868371
	speed: 0.8054s/iter; left time: 12652.7989s
	iters: 200, epoch: 25 | loss: 0.1336094
	speed: 0.3316s/iter; left time: 5176.5966s
Epoch: 25 cost time: 71.97690653800964
Epoch: 25, Steps: 208 | Train Loss: 0.228 Vali Loss: 9.236 Vali Acc: 0.089 Test Loss: 9.236 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0184883
	speed: 0.8481s/iter; left time: 13146.9181s
	iters: 200, epoch: 26 | loss: 0.5438995
	speed: 0.3491s/iter; left time: 5376.4446s
Epoch: 26 cost time: 73.8972270488739
Epoch: 26, Steps: 208 | Train Loss: 0.201 Vali Loss: 9.275 Vali Acc: 0.093 Test Loss: 9.275 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.2626021
	speed: 0.8327s/iter; left time: 12735.1185s
	iters: 200, epoch: 27 | loss: 0.1391829
	speed: 0.3421s/iter; left time: 5197.5053s
Epoch: 27 cost time: 72.0916006565094
Epoch: 27, Steps: 208 | Train Loss: 0.219 Vali Loss: 9.280 Vali Acc: 0.098 Test Loss: 9.280 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0420583
	speed: 0.8106s/iter; left time: 12227.8392s
	iters: 200, epoch: 28 | loss: 0.0886096
	speed: 0.3204s/iter; left time: 4800.5209s
Epoch: 28 cost time: 68.07909750938416
Epoch: 28, Steps: 208 | Train Loss: 0.214 Vali Loss: 9.424 Vali Acc: 0.097 Test Loss: 9.424 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.3358622
	speed: 0.8003s/iter; left time: 11906.5921s
	iters: 200, epoch: 29 | loss: 0.1321859
	speed: 0.3481s/iter; left time: 5144.3039s
Epoch: 29 cost time: 73.19065618515015
Epoch: 29, Steps: 208 | Train Loss: 0.189 Vali Loss: 9.801 Vali Acc: 0.095 Test Loss: 9.801 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1677449
	speed: 0.8427s/iter; left time: 12362.1912s
	iters: 200, epoch: 30 | loss: 0.0018313
	speed: 0.3585s/iter; left time: 5222.6000s
Epoch: 30 cost time: 75.67805671691895
Epoch: 30, Steps: 208 | Train Loss: 0.175 Vali Loss: 9.852 Vali Acc: 0.100 Test Loss: 9.852 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.1082964
	speed: 0.8069s/iter; left time: 11668.3850s
	iters: 200, epoch: 31 | loss: 0.4439422
	speed: 0.3404s/iter; left time: 4887.7829s
Epoch: 31 cost time: 70.62444877624512
Epoch: 31, Steps: 208 | Train Loss: 0.186 Vali Loss: 9.921 Vali Acc: 0.098 Test Loss: 9.921 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.2603799
	speed: 0.8253s/iter; left time: 11763.5950s
	iters: 200, epoch: 32 | loss: 0.0840355
	speed: 0.3405s/iter; left time: 4818.4126s
Epoch: 32 cost time: 72.43593287467957
Epoch: 32, Steps: 208 | Train Loss: 0.178 Vali Loss: 10.515 Vali Acc: 0.091 Test Loss: 10.515 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0605424
	speed: 0.8354s/iter; left time: 11733.3541s
	iters: 200, epoch: 33 | loss: 0.3210144
	speed: 0.3527s/iter; left time: 4918.8580s
Epoch: 33 cost time: 74.38663458824158
Epoch: 33, Steps: 208 | Train Loss: 0.158 Vali Loss: 10.225 Vali Acc: 0.091 Test Loss: 10.225 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10348941246644795
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4337833
	speed: 0.3466s/iter; left time: 7175.7893s
	iters: 200, epoch: 1 | loss: 3.5388861
	speed: 0.3149s/iter; left time: 6487.4336s
Epoch: 1 cost time: 69.35549426078796
Epoch: 1, Steps: 208 | Train Loss: 3.644 Vali Loss: 3.820 Vali Acc: 0.042 Test Loss: 3.820 Test Acc: 0.042
Validation loss decreased (inf --> -0.041715).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4178472
	speed: 0.8277s/iter; left time: 16962.4667s
	iters: 200, epoch: 2 | loss: 3.0183163
	speed: 0.3630s/iter; left time: 7402.7661s
Epoch: 2 cost time: 74.76606798171997
Epoch: 2, Steps: 208 | Train Loss: 3.269 Vali Loss: 4.459 Vali Acc: 0.037 Test Loss: 4.459 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3079543
	speed: 0.8211s/iter; left time: 16655.7350s
	iters: 200, epoch: 3 | loss: 2.9771926
	speed: 0.3501s/iter; left time: 7066.5723s
Epoch: 3 cost time: 71.6358551979065
Epoch: 3, Steps: 208 | Train Loss: 3.017 Vali Loss: 4.376 Vali Acc: 0.039 Test Loss: 4.376 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.7782543
	speed: 0.8244s/iter; left time: 16552.1906s
	iters: 200, epoch: 4 | loss: 2.5926516
	speed: 0.3430s/iter; left time: 6852.2753s
Epoch: 4 cost time: 72.02282524108887
Epoch: 4, Steps: 208 | Train Loss: 2.815 Vali Loss: 4.480 Vali Acc: 0.044 Test Loss: 4.480 Test Acc: 0.044
Validation loss decreased (-0.041715 --> -0.043797).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9390782
	speed: 0.8196s/iter; left time: 16284.5840s
	iters: 200, epoch: 5 | loss: 3.7482529
	speed: 0.3334s/iter; left time: 6591.0820s
Epoch: 5 cost time: 71.43580341339111
Epoch: 5, Steps: 208 | Train Loss: 2.552 Vali Loss: 4.682 Vali Acc: 0.053 Test Loss: 4.682 Test Acc: 0.053
Validation loss decreased (-0.043797 --> -0.053040).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2222512
	speed: 0.8040s/iter; left time: 15808.3889s
	iters: 200, epoch: 6 | loss: 2.6362076
	speed: 0.3241s/iter; left time: 6340.0507s
Epoch: 6 cost time: 69.2118787765503
Epoch: 6, Steps: 208 | Train Loss: 2.328 Vali Loss: 4.712 Vali Acc: 0.054 Test Loss: 4.712 Test Acc: 0.054
Validation loss decreased (-0.053040 --> -0.053636).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4784291
	speed: 0.7723s/iter; left time: 15024.2062s
	iters: 200, epoch: 7 | loss: 2.1570294
	speed: 0.3374s/iter; left time: 6530.4199s
Epoch: 7 cost time: 69.64486026763916
Epoch: 7, Steps: 208 | Train Loss: 2.047 Vali Loss: 4.836 Vali Acc: 0.061 Test Loss: 4.836 Test Acc: 0.061
Validation loss decreased (-0.053636 --> -0.061091).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4084021
	speed: 0.8016s/iter; left time: 15426.9383s
	iters: 200, epoch: 8 | loss: 1.6877857
	speed: 0.3501s/iter; left time: 6702.2479s
Epoch: 8 cost time: 72.99005913734436
Epoch: 8, Steps: 208 | Train Loss: 1.762 Vali Loss: 4.932 Vali Acc: 0.055 Test Loss: 4.932 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9314086
	speed: 0.8266s/iter; left time: 15735.1290s
	iters: 200, epoch: 9 | loss: 2.2033668
	speed: 0.3281s/iter; left time: 6213.9546s
Epoch: 9 cost time: 71.3105673789978
Epoch: 9, Steps: 208 | Train Loss: 1.485 Vali Loss: 5.273 Vali Acc: 0.070 Test Loss: 5.273 Test Acc: 0.070
Validation loss decreased (-0.061091 --> -0.069736).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2902663
	speed: 0.8211s/iter; left time: 15459.7146s
	iters: 200, epoch: 10 | loss: 1.1380229
	speed: 0.3402s/iter; left time: 6370.6968s
Epoch: 10 cost time: 71.30004525184631
Epoch: 10, Steps: 208 | Train Loss: 1.260 Vali Loss: 5.567 Vali Acc: 0.072 Test Loss: 5.567 Test Acc: 0.072
Validation loss decreased (-0.069736 --> -0.072119).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9007732
	speed: 0.8110s/iter; left time: 15101.1419s
	iters: 200, epoch: 11 | loss: 0.9406264
	speed: 0.3293s/iter; left time: 6098.1361s
Epoch: 11 cost time: 70.14048457145691
Epoch: 11, Steps: 208 | Train Loss: 1.057 Vali Loss: 6.110 Vali Acc: 0.067 Test Loss: 6.110 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4816719
	speed: 0.7934s/iter; left time: 14609.6318s
	iters: 200, epoch: 12 | loss: 0.7531757
	speed: 0.3369s/iter; left time: 6168.9644s
Epoch: 12 cost time: 69.75306582450867
Epoch: 12, Steps: 208 | Train Loss: 0.879 Vali Loss: 6.584 Vali Acc: 0.070 Test Loss: 6.584 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2985618
	speed: 0.7736s/iter; left time: 14083.4475s
	iters: 200, epoch: 13 | loss: 1.1809337
	speed: 0.3249s/iter; left time: 5881.6056s
Epoch: 13 cost time: 67.94241881370544
Epoch: 13, Steps: 208 | Train Loss: 0.752 Vali Loss: 6.431 Vali Acc: 0.086 Test Loss: 6.431 Test Acc: 0.086
Validation loss decreased (-0.072119 --> -0.085531).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2118377
	speed: 0.7469s/iter; left time: 13442.2913s
	iters: 200, epoch: 14 | loss: 0.8323077
	speed: 0.3255s/iter; left time: 5824.6053s
Epoch: 14 cost time: 67.12418413162231
Epoch: 14, Steps: 208 | Train Loss: 0.638 Vali Loss: 7.020 Vali Acc: 0.077 Test Loss: 7.020 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4832774
	speed: 0.8375s/iter; left time: 14897.6889s
	iters: 200, epoch: 15 | loss: 0.7210892
	speed: 0.3609s/iter; left time: 6383.1253s
Epoch: 15 cost time: 74.91600203514099
Epoch: 15, Steps: 208 | Train Loss: 0.557 Vali Loss: 7.366 Vali Acc: 0.081 Test Loss: 7.366 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5121441
	speed: 0.8069s/iter; left time: 14185.6599s
	iters: 200, epoch: 16 | loss: 0.8837214
	speed: 0.3380s/iter; left time: 5909.3785s
Epoch: 16 cost time: 70.57312226295471
Epoch: 16, Steps: 208 | Train Loss: 0.509 Vali Loss: 8.003 Vali Acc: 0.079 Test Loss: 8.003 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4057391
	speed: 0.7922s/iter; left time: 13763.5463s
	iters: 200, epoch: 17 | loss: 0.5302801
	speed: 0.3334s/iter; left time: 5759.5561s
Epoch: 17 cost time: 70.94052791595459
Epoch: 17, Steps: 208 | Train Loss: 0.447 Vali Loss: 7.983 Vali Acc: 0.086 Test Loss: 7.983 Test Acc: 0.086
Validation loss decreased (-0.085531 --> -0.085813).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5186604
	speed: 0.8132s/iter; left time: 13958.1713s
	iters: 200, epoch: 18 | loss: 0.3045448
	speed: 0.3462s/iter; left time: 5907.5334s
Epoch: 18 cost time: 72.23272395133972
Epoch: 18, Steps: 208 | Train Loss: 0.416 Vali Loss: 8.004 Vali Acc: 0.084 Test Loss: 8.004 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3604378
	speed: 0.8287s/iter; left time: 14052.0307s
	iters: 200, epoch: 19 | loss: 0.2251182
	speed: 0.3398s/iter; left time: 5727.2042s
Epoch: 19 cost time: 72.096834897995
Epoch: 19, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.209 Vali Acc: 0.091 Test Loss: 8.209 Test Acc: 0.091
Validation loss decreased (-0.085813 --> -0.091179).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3256907
	speed: 0.8273s/iter; left time: 13855.7946s
	iters: 200, epoch: 20 | loss: 0.1803076
	speed: 0.3479s/iter; left time: 5792.3475s
Epoch: 20 cost time: 72.15282440185547
Epoch: 20, Steps: 208 | Train Loss: 0.328 Vali Loss: 8.540 Vali Acc: 0.086 Test Loss: 8.540 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1218117
	speed: 0.8412s/iter; left time: 13913.8466s
	iters: 200, epoch: 21 | loss: 0.5871119
	speed: 0.3448s/iter; left time: 5668.9584s
Epoch: 21 cost time: 72.1663966178894
Epoch: 21, Steps: 208 | Train Loss: 0.322 Vali Loss: 8.813 Vali Acc: 0.085 Test Loss: 8.813 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0364176
	speed: 0.8357s/iter; left time: 13648.9005s
	iters: 200, epoch: 22 | loss: 0.4584534
	speed: 0.3724s/iter; left time: 6044.8162s
Epoch: 22 cost time: 74.7428207397461
Epoch: 22, Steps: 208 | Train Loss: 0.297 Vali Loss: 9.088 Vali Acc: 0.085 Test Loss: 9.088 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1370147
	speed: 0.8457s/iter; left time: 13636.8236s
	iters: 200, epoch: 23 | loss: 0.1073160
	speed: 0.3410s/iter; left time: 5464.1816s
Epoch: 23 cost time: 73.46274471282959
Epoch: 23, Steps: 208 | Train Loss: 0.278 Vali Loss: 9.008 Vali Acc: 0.090 Test Loss: 9.008 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0867271
	speed: 0.8759s/iter; left time: 13941.7427s
	iters: 200, epoch: 24 | loss: 0.6832983
	speed: 0.3652s/iter; left time: 5776.0971s
Epoch: 24 cost time: 76.60607719421387
Epoch: 24, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.383 Vali Acc: 0.085 Test Loss: 9.383 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1288873
	speed: 0.8925s/iter; left time: 14020.0503s
	iters: 200, epoch: 25 | loss: 0.3281801
	speed: 0.3560s/iter; left time: 5556.8654s
Epoch: 25 cost time: 75.24448800086975
Epoch: 25, Steps: 208 | Train Loss: 0.255 Vali Loss: 9.338 Vali Acc: 0.090 Test Loss: 9.338 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0099052
	speed: 0.8864s/iter; left time: 13740.5891s
	iters: 200, epoch: 26 | loss: 0.5985155
	speed: 0.4039s/iter; left time: 6220.5754s
Epoch: 26 cost time: 82.80037832260132
Epoch: 26, Steps: 208 | Train Loss: 0.227 Vali Loss: 9.109 Vali Acc: 0.087 Test Loss: 9.109 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1180321
	speed: 0.9803s/iter; left time: 14991.1587s
	iters: 200, epoch: 27 | loss: 0.1163781
	speed: 0.4260s/iter; left time: 6472.6910s
Epoch: 27 cost time: 89.49695801734924
Epoch: 27, Steps: 208 | Train Loss: 0.190 Vali Loss: 9.593 Vali Acc: 0.091 Test Loss: 9.593 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2061166
	speed: 1.0497s/iter; left time: 15834.8014s
	iters: 200, epoch: 28 | loss: 0.4657250
	speed: 0.4417s/iter; left time: 6619.3720s
Epoch: 28 cost time: 90.55145788192749
Epoch: 28, Steps: 208 | Train Loss: 0.187 Vali Loss: 9.733 Vali Acc: 0.089 Test Loss: 9.733 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.6086401
	speed: 1.0875s/iter; left time: 16178.7521s
	iters: 200, epoch: 29 | loss: 0.0282765
	speed: 0.4642s/iter; left time: 6860.1379s
Epoch: 29 cost time: 95.48054671287537
Epoch: 29, Steps: 208 | Train Loss: 0.188 Vali Loss: 9.987 Vali Acc: 0.093 Test Loss: 9.987 Test Acc: 0.093
Validation loss decreased (-0.091179 --> -0.093249).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.1150885
	speed: 1.2874s/iter; left time: 18884.6855s
	iters: 200, epoch: 30 | loss: 0.1874043
	speed: 0.5406s/iter; left time: 7876.0212s
Epoch: 30 cost time: 115.36222696304321
Epoch: 30, Steps: 208 | Train Loss: 0.209 Vali Loss: 9.720 Vali Acc: 0.092 Test Loss: 9.720 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.3395800
	speed: 1.3231s/iter; left time: 19133.2779s
	iters: 200, epoch: 31 | loss: 0.0766271
	speed: 0.5082s/iter; left time: 7298.5505s
Epoch: 31 cost time: 109.7718997001648
Epoch: 31, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.168 Vali Acc: 0.085 Test Loss: 10.168 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.2676167
	speed: 1.2683s/iter; left time: 18077.4046s
	iters: 200, epoch: 32 | loss: 0.4235967
	speed: 0.5113s/iter; left time: 7236.2353s
Epoch: 32 cost time: 107.10252475738525
Epoch: 32, Steps: 208 | Train Loss: 0.176 Vali Loss: 10.316 Vali Acc: 0.089 Test Loss: 10.316 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.4212196
	speed: 1.2734s/iter; left time: 17884.2813s
	iters: 200, epoch: 33 | loss: 0.2269722
	speed: 0.4919s/iter; left time: 6859.3542s
Epoch: 33 cost time: 103.35327005386353
Epoch: 33, Steps: 208 | Train Loss: 0.164 Vali Loss: 10.484 Vali Acc: 0.094 Test Loss: 10.484 Test Acc: 0.094
Validation loss decreased (-0.093249 --> -0.094139).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.2834515
	speed: 1.2320s/iter; left time: 17047.2456s
	iters: 200, epoch: 34 | loss: 0.1702397
	speed: 0.4845s/iter; left time: 6656.1068s
Epoch: 34 cost time: 103.42059016227722
Epoch: 34, Steps: 208 | Train Loss: 0.154 Vali Loss: 10.156 Vali Acc: 0.092 Test Loss: 10.156 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.2022411
	speed: 1.3157s/iter; left time: 17932.2691s
	iters: 200, epoch: 35 | loss: 0.0926113
	speed: 0.5174s/iter; left time: 7000.1312s
Epoch: 35 cost time: 109.36004638671875
Epoch: 35, Steps: 208 | Train Loss: 0.160 Vali Loss: 10.331 Vali Acc: 0.091 Test Loss: 10.331 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0950421
	speed: 1.2677s/iter; left time: 17013.6784s
	iters: 200, epoch: 36 | loss: 0.0903582
	speed: 0.5467s/iter; left time: 7282.3917s
Epoch: 36 cost time: 113.07776093482971
Epoch: 36, Steps: 208 | Train Loss: 0.153 Vali Loss: 10.684 Vali Acc: 0.093 Test Loss: 10.684 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.1427145
	speed: 1.2824s/iter; left time: 16944.1912s
	iters: 200, epoch: 37 | loss: 0.0767925
	speed: 0.4887s/iter; left time: 6408.8177s
Epoch: 37 cost time: 104.15207719802856
Epoch: 37, Steps: 208 | Train Loss: 0.135 Vali Loss: 10.644 Vali Acc: 0.101 Test Loss: 10.644 Test Acc: 0.101
Validation loss decreased (-0.094139 --> -0.100997).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0022230
	speed: 1.2321s/iter; left time: 16023.5573s
	iters: 200, epoch: 38 | loss: 0.0393633
	speed: 0.5226s/iter; left time: 6743.7290s
Epoch: 38 cost time: 108.64646196365356
Epoch: 38, Steps: 208 | Train Loss: 0.136 Vali Loss: 10.555 Vali Acc: 0.098 Test Loss: 10.555 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0487616
	speed: 1.2521s/iter; left time: 16023.6807s
	iters: 200, epoch: 39 | loss: 0.1837173
	speed: 0.4875s/iter; left time: 6189.8965s
Epoch: 39 cost time: 103.31588578224182
Epoch: 39, Steps: 208 | Train Loss: 0.134 Vali Loss: 10.728 Vali Acc: 0.096 Test Loss: 10.728 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0031914
	speed: 1.2899s/iter; left time: 16238.6717s
	iters: 200, epoch: 40 | loss: 0.0665699
	speed: 0.5305s/iter; left time: 6625.8889s
Epoch: 40 cost time: 109.24620461463928
Epoch: 40, Steps: 208 | Train Loss: 0.124 Vali Loss: 10.594 Vali Acc: 0.102 Test Loss: 10.594 Test Acc: 0.102
Validation loss decreased (-0.100997 --> -0.102191).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.1077354
	speed: 1.3219s/iter; left time: 16366.4768s
	iters: 200, epoch: 41 | loss: 0.2674517
	speed: 0.5489s/iter; left time: 6741.0665s
Epoch: 41 cost time: 113.7929048538208
Epoch: 41, Steps: 208 | Train Loss: 0.136 Vali Loss: 11.163 Vali Acc: 0.100 Test Loss: 11.163 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.1790230
	speed: 1.2950s/iter; left time: 15764.3324s
	iters: 200, epoch: 42 | loss: 0.1890574
	speed: 0.5488s/iter; left time: 6626.0861s
Epoch: 42 cost time: 111.50262832641602
Epoch: 42, Steps: 208 | Train Loss: 0.131 Vali Loss: 10.936 Vali Acc: 0.100 Test Loss: 10.936 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.1822498
	speed: 1.4839s/iter; left time: 17754.8900s
	iters: 200, epoch: 43 | loss: 0.0069792
	speed: 0.5781s/iter; left time: 6858.7903s
Epoch: 43 cost time: 121.09989523887634
Epoch: 43, Steps: 208 | Train Loss: 0.114 Vali Loss: 11.538 Vali Acc: 0.092 Test Loss: 11.538 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0113677
	speed: 1.4565s/iter; left time: 17124.0308s
	iters: 200, epoch: 44 | loss: 0.0213600
	speed: 0.5761s/iter; left time: 6715.9913s
Epoch: 44 cost time: 121.08356738090515
Epoch: 44, Steps: 208 | Train Loss: 0.112 Vali Loss: 11.262 Vali Acc: 0.092 Test Loss: 11.262 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.1262876
	speed: 1.4118s/iter; left time: 16304.6609s
	iters: 200, epoch: 45 | loss: 0.0215083
	speed: 0.5527s/iter; left time: 6327.8717s
Epoch: 45 cost time: 116.28779125213623
Epoch: 45, Steps: 208 | Train Loss: 0.112 Vali Loss: 11.170 Vali Acc: 0.095 Test Loss: 11.170 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0159958
	speed: 1.3966s/iter; left time: 15838.5560s
	iters: 200, epoch: 46 | loss: 0.0010304
	speed: 0.5363s/iter; left time: 6028.1934s
Epoch: 46 cost time: 111.2941403388977
Epoch: 46, Steps: 208 | Train Loss: 0.113 Vali Loss: 11.286 Vali Acc: 0.087 Test Loss: 11.286 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.2430675
	speed: 1.4406s/iter; left time: 16038.1395s
	iters: 200, epoch: 47 | loss: 0.2272047
	speed: 0.5594s/iter; left time: 6171.3834s
Epoch: 47 cost time: 118.10111713409424
Epoch: 47, Steps: 208 | Train Loss: 0.118 Vali Loss: 11.124 Vali Acc: 0.093 Test Loss: 11.124 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0084390
	speed: 1.4329s/iter; left time: 15654.2925s
	iters: 200, epoch: 48 | loss: 0.0186353
	speed: 0.5621s/iter; left time: 6085.2369s
Epoch: 48 cost time: 117.41182160377502
Epoch: 48, Steps: 208 | Train Loss: 0.113 Vali Loss: 11.118 Vali Acc: 0.093 Test Loss: 11.118 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.1866569
	speed: 1.5371s/iter; left time: 16473.6112s
	iters: 200, epoch: 49 | loss: 0.0797913
	speed: 0.5654s/iter; left time: 6003.3454s
Epoch: 49 cost time: 121.8788378238678
Epoch: 49, Steps: 208 | Train Loss: 0.098 Vali Loss: 11.532 Vali Acc: 0.091 Test Loss: 11.532 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.1784850
	speed: 1.4465s/iter; left time: 15200.9173s
	iters: 200, epoch: 50 | loss: 0.0192444
	speed: 0.5570s/iter; left time: 5797.4608s
Epoch: 50 cost time: 119.4343433380127
Epoch: 50, Steps: 208 | Train Loss: 0.102 Vali Loss: 11.322 Vali Acc: 0.085 Test Loss: 11.322 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1022964509394572
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4999709
	speed: 0.3028s/iter; left time: 6267.8237s
	iters: 200, epoch: 1 | loss: 3.5965593
	speed: 0.3138s/iter; left time: 6464.0128s
Epoch: 1 cost time: 64.29044556617737
Epoch: 1, Steps: 208 | Train Loss: 3.670 Vali Loss: 4.352 Vali Acc: 0.026 Test Loss: 4.352 Test Acc: 0.026
Validation loss decreased (inf --> -0.026202).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0463042
	speed: 0.7192s/iter; left time: 14738.1279s
	iters: 200, epoch: 2 | loss: 3.2896686
	speed: 0.3102s/iter; left time: 6325.6400s
Epoch: 2 cost time: 63.24520754814148
Epoch: 2, Steps: 208 | Train Loss: 3.330 Vali Loss: 5.223 Vali Acc: 0.032 Test Loss: 5.223 Test Acc: 0.032
Validation loss decreased (-0.026202 --> -0.031859).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9485731
	speed: 0.7028s/iter; left time: 14255.5237s
	iters: 200, epoch: 3 | loss: 3.2781882
	speed: 0.3011s/iter; left time: 6076.8801s
Epoch: 3 cost time: 63.51901149749756
Epoch: 3, Steps: 208 | Train Loss: 3.154 Vali Loss: 5.035 Vali Acc: 0.037 Test Loss: 5.035 Test Acc: 0.037
Validation loss decreased (-0.031859 --> -0.036931).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8975074
	speed: 0.6955s/iter; left time: 13963.1212s
	iters: 200, epoch: 4 | loss: 2.6659338
	speed: 0.3081s/iter; left time: 6155.2691s
Epoch: 4 cost time: 62.79949951171875
Epoch: 4, Steps: 208 | Train Loss: 3.024 Vali Loss: 4.961 Vali Acc: 0.037 Test Loss: 4.961 Test Acc: 0.037
Validation loss decreased (-0.036931 --> -0.036932).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8700416
	speed: 0.7156s/iter; left time: 14217.7216s
	iters: 200, epoch: 5 | loss: 3.4361534
	speed: 0.3026s/iter; left time: 5981.2589s
Epoch: 5 cost time: 64.81124520301819
Epoch: 5, Steps: 208 | Train Loss: 2.861 Vali Loss: 5.120 Vali Acc: 0.044 Test Loss: 5.120 Test Acc: 0.044
Validation loss decreased (-0.036932 --> -0.043790).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6798019
	speed: 0.7038s/iter; left time: 13837.7835s
	iters: 200, epoch: 6 | loss: 3.1320765
	speed: 0.2872s/iter; left time: 5618.6817s
Epoch: 6 cost time: 62.553452014923096
Epoch: 6, Steps: 208 | Train Loss: 2.716 Vali Loss: 5.017 Vali Acc: 0.048 Test Loss: 5.017 Test Acc: 0.048
Validation loss decreased (-0.043790 --> -0.047668).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4415772
	speed: 0.6855s/iter; left time: 13334.3082s
	iters: 200, epoch: 7 | loss: 2.1121874
	speed: 0.3148s/iter; left time: 6092.2557s
Epoch: 7 cost time: 63.645819425582886
Epoch: 7, Steps: 208 | Train Loss: 2.493 Vali Loss: 4.981 Vali Acc: 0.058 Test Loss: 4.981 Test Acc: 0.058
Validation loss decreased (-0.047668 --> -0.058107).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0937130
	speed: 0.7022s/iter; left time: 13513.9143s
	iters: 200, epoch: 8 | loss: 1.8734601
	speed: 0.2804s/iter; left time: 5369.1517s
Epoch: 8 cost time: 61.372665882110596
Epoch: 8, Steps: 208 | Train Loss: 2.270 Vali Loss: 4.916 Vali Acc: 0.059 Test Loss: 4.916 Test Acc: 0.059
Validation loss decreased (-0.058107 --> -0.058704).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7704391
	speed: 0.6944s/iter; left time: 13219.3851s
	iters: 200, epoch: 9 | loss: 2.2784865
	speed: 0.2977s/iter; left time: 5637.4264s
Epoch: 9 cost time: 61.47357630729675
Epoch: 9, Steps: 208 | Train Loss: 2.039 Vali Loss: 5.084 Vali Acc: 0.068 Test Loss: 5.084 Test Acc: 0.068
Validation loss decreased (-0.058704 --> -0.067650).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6009784
	speed: 0.6927s/iter; left time: 13043.5241s
	iters: 200, epoch: 10 | loss: 2.0147805
	speed: 0.2923s/iter; left time: 5474.8843s
Epoch: 10 cost time: 63.00933527946472
Epoch: 10, Steps: 208 | Train Loss: 1.751 Vali Loss: 5.212 Vali Acc: 0.073 Test Loss: 5.212 Test Acc: 0.073
Validation loss decreased (-0.067650 --> -0.073315).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6482723
	speed: 0.6943s/iter; left time: 12928.7621s
	iters: 200, epoch: 11 | loss: 1.3086237
	speed: 0.2921s/iter; left time: 5409.1827s
Epoch: 11 cost time: 62.362953901290894
Epoch: 11, Steps: 208 | Train Loss: 1.507 Vali Loss: 5.650 Vali Acc: 0.065 Test Loss: 5.650 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2668473
	speed: 0.7190s/iter; left time: 13239.0771s
	iters: 200, epoch: 12 | loss: 1.5288471
	speed: 0.2902s/iter; left time: 5313.7950s
Epoch: 12 cost time: 62.25422501564026
Epoch: 12, Steps: 208 | Train Loss: 1.314 Vali Loss: 5.885 Vali Acc: 0.069 Test Loss: 5.885 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7543294
	speed: 0.6941s/iter; left time: 12636.6877s
	iters: 200, epoch: 13 | loss: 1.6548612
	speed: 0.3089s/iter; left time: 5593.3623s
Epoch: 13 cost time: 62.1549232006073
Epoch: 13, Steps: 208 | Train Loss: 1.143 Vali Loss: 5.721 Vali Acc: 0.080 Test Loss: 5.721 Test Acc: 0.080
Validation loss decreased (-0.073315 --> -0.079871).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9465868
	speed: 0.7150s/iter; left time: 12867.9871s
	iters: 200, epoch: 14 | loss: 1.2875903
	speed: 0.3109s/iter; left time: 5564.1972s
Epoch: 14 cost time: 63.701685667037964
Epoch: 14, Steps: 208 | Train Loss: 0.998 Vali Loss: 6.099 Vali Acc: 0.077 Test Loss: 6.099 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9553151
	speed: 0.6926s/iter; left time: 12321.2234s
	iters: 200, epoch: 15 | loss: 1.2408235
	speed: 0.2895s/iter; left time: 5121.7641s
Epoch: 15 cost time: 62.24757957458496
Epoch: 15, Steps: 208 | Train Loss: 0.868 Vali Loss: 6.542 Vali Acc: 0.086 Test Loss: 6.542 Test Acc: 0.086
Validation loss decreased (-0.079871 --> -0.085828).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3888079
	speed: 0.6964s/iter; left time: 12244.2163s
	iters: 200, epoch: 16 | loss: 0.9722300
	speed: 0.3057s/iter; left time: 5343.1928s
Epoch: 16 cost time: 63.70584511756897
Epoch: 16, Steps: 208 | Train Loss: 0.785 Vali Loss: 6.838 Vali Acc: 0.089 Test Loss: 6.838 Test Acc: 0.089
Validation loss decreased (-0.085828 --> -0.089105).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0371373
	speed: 0.7143s/iter; left time: 12408.8621s
	iters: 200, epoch: 17 | loss: 0.8029584
	speed: 0.2948s/iter; left time: 5092.7149s
Epoch: 17 cost time: 62.74040985107422
Epoch: 17, Steps: 208 | Train Loss: 0.710 Vali Loss: 6.896 Vali Acc: 0.093 Test Loss: 6.896 Test Acc: 0.093
Validation loss decreased (-0.089105 --> -0.093280).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.7185868
	speed: 0.6566s/iter; left time: 11271.1320s
	iters: 200, epoch: 18 | loss: 1.2160548
	speed: 0.2739s/iter; left time: 4674.8441s
Epoch: 18 cost time: 59.188819885253906
Epoch: 18, Steps: 208 | Train Loss: 0.613 Vali Loss: 7.333 Vali Acc: 0.087 Test Loss: 7.333 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3287537
	speed: 0.7023s/iter; left time: 11909.7206s
	iters: 200, epoch: 19 | loss: 0.5832881
	speed: 0.2944s/iter; left time: 4963.4991s
Epoch: 19 cost time: 62.76577568054199
Epoch: 19, Steps: 208 | Train Loss: 0.586 Vali Loss: 7.459 Vali Acc: 0.098 Test Loss: 7.459 Test Acc: 0.098
Validation loss decreased (-0.093280 --> -0.098345).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5100316
	speed: 0.7170s/iter; left time: 12009.7599s
	iters: 200, epoch: 20 | loss: 0.4472756
	speed: 0.2863s/iter; left time: 4765.9959s
Epoch: 20 cost time: 61.39124870300293
Epoch: 20, Steps: 208 | Train Loss: 0.513 Vali Loss: 7.819 Vali Acc: 0.094 Test Loss: 7.819 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.6733978
	speed: 0.7118s/iter; left time: 11773.7561s
	iters: 200, epoch: 21 | loss: 0.7245122
	speed: 0.2979s/iter; left time: 4898.1174s
Epoch: 21 cost time: 62.741456031799316
Epoch: 21, Steps: 208 | Train Loss: 0.494 Vali Loss: 8.050 Vali Acc: 0.089 Test Loss: 8.050 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.3938264
	speed: 0.7044s/iter; left time: 11504.3988s
	iters: 200, epoch: 22 | loss: 0.8738471
	speed: 0.3134s/iter; left time: 5087.4702s
Epoch: 22 cost time: 64.19151282310486
Epoch: 22, Steps: 208 | Train Loss: 0.467 Vali Loss: 7.940 Vali Acc: 0.097 Test Loss: 7.940 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4203418
	speed: 0.6990s/iter; left time: 11271.7659s
	iters: 200, epoch: 23 | loss: 0.5579326
	speed: 0.2918s/iter; left time: 4676.4446s
Epoch: 23 cost time: 61.572044134140015
Epoch: 23, Steps: 208 | Train Loss: 0.434 Vali Loss: 8.132 Vali Acc: 0.094 Test Loss: 8.132 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3546816
	speed: 0.6981s/iter; left time: 11111.8924s
	iters: 200, epoch: 24 | loss: 0.8908042
	speed: 0.2876s/iter; left time: 4548.5055s
Epoch: 24 cost time: 61.64719605445862
Epoch: 24, Steps: 208 | Train Loss: 0.411 Vali Loss: 8.434 Vali Acc: 0.093 Test Loss: 8.434 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3947899
	speed: 0.6809s/iter; left time: 10696.2728s
	iters: 200, epoch: 25 | loss: 0.3338906
	speed: 0.2846s/iter; left time: 4442.0427s
Epoch: 25 cost time: 61.754398822784424
Epoch: 25, Steps: 208 | Train Loss: 0.420 Vali Loss: 8.265 Vali Acc: 0.100 Test Loss: 8.265 Test Acc: 0.100
Validation loss decreased (-0.098345 --> -0.100126).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1651644
	speed: 0.7226s/iter; left time: 11201.5820s
	iters: 200, epoch: 26 | loss: 0.7160900
	speed: 0.2830s/iter; left time: 4358.2032s
Epoch: 26 cost time: 62.692991733551025
Epoch: 26, Steps: 208 | Train Loss: 0.362 Vali Loss: 8.823 Vali Acc: 0.086 Test Loss: 8.823 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.3555222
	speed: 0.7102s/iter; left time: 10861.1439s
	iters: 200, epoch: 27 | loss: 0.2235947
	speed: 0.2982s/iter; left time: 4530.6922s
Epoch: 27 cost time: 62.1280562877655
Epoch: 27, Steps: 208 | Train Loss: 0.342 Vali Loss: 8.991 Vali Acc: 0.097 Test Loss: 8.991 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.2215213
	speed: 0.6900s/iter; left time: 10408.0778s
	iters: 200, epoch: 28 | loss: 0.1796421
	speed: 0.3150s/iter; left time: 4720.0481s
Epoch: 28 cost time: 62.682788133621216
Epoch: 28, Steps: 208 | Train Loss: 0.316 Vali Loss: 8.952 Vali Acc: 0.094 Test Loss: 8.952 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.3579884
	speed: 0.7078s/iter; left time: 10530.2714s
	iters: 200, epoch: 29 | loss: 0.2275646
	speed: 0.3028s/iter; left time: 4473.7990s
Epoch: 29 cost time: 63.196906089782715
Epoch: 29, Steps: 208 | Train Loss: 0.312 Vali Loss: 9.202 Vali Acc: 0.089 Test Loss: 9.202 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1109586
	speed: 0.6800s/iter; left time: 9974.9905s
	iters: 200, epoch: 30 | loss: 0.2784891
	speed: 0.3025s/iter; left time: 4406.6905s
Epoch: 30 cost time: 62.48010611534119
Epoch: 30, Steps: 208 | Train Loss: 0.305 Vali Loss: 9.476 Vali Acc: 0.094 Test Loss: 9.476 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0690618
	speed: 0.7070s/iter; left time: 10223.3419s
	iters: 200, epoch: 31 | loss: 0.1575007
	speed: 0.2982s/iter; left time: 4282.9672s
Epoch: 31 cost time: 63.3281786441803
Epoch: 31, Steps: 208 | Train Loss: 0.294 Vali Loss: 9.230 Vali Acc: 0.094 Test Loss: 9.230 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.1797401
	speed: 0.7026s/iter; left time: 10014.1479s
	iters: 200, epoch: 32 | loss: 0.2925951
	speed: 0.2968s/iter; left time: 4201.1778s
Epoch: 32 cost time: 61.93490409851074
Epoch: 32, Steps: 208 | Train Loss: 0.285 Vali Loss: 9.468 Vali Acc: 0.091 Test Loss: 9.468 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.2336247
	speed: 0.6788s/iter; left time: 9533.9629s
	iters: 200, epoch: 33 | loss: 0.1261472
	speed: 0.3012s/iter; left time: 4200.2252s
Epoch: 33 cost time: 61.200486183166504
Epoch: 33, Steps: 208 | Train Loss: 0.261 Vali Loss: 9.499 Vali Acc: 0.095 Test Loss: 9.499 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.1567914
	speed: 0.6758s/iter; left time: 9351.5176s
	iters: 200, epoch: 34 | loss: 0.1869783
	speed: 0.2936s/iter; left time: 4033.2562s
Epoch: 34 cost time: 62.0151104927063
Epoch: 34, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.584 Vali Acc: 0.089 Test Loss: 9.584 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.3753402
	speed: 0.7039s/iter; left time: 9593.3099s
	iters: 200, epoch: 35 | loss: 0.0678410
	speed: 0.2895s/iter; left time: 3916.1929s
Epoch: 35 cost time: 60.71766400337219
Epoch: 35, Steps: 208 | Train Loss: 0.262 Vali Loss: 9.705 Vali Acc: 0.098 Test Loss: 9.705 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10020876826722339
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4911597
	speed: 0.5524s/iter; left time: 11434.5582s
	iters: 200, epoch: 1 | loss: 3.5764351
	speed: 0.5142s/iter; left time: 10593.0447s
Epoch: 1 cost time: 110.95927858352661
Epoch: 1, Steps: 208 | Train Loss: 3.674 Vali Loss: 3.979 Vali Acc: 0.035 Test Loss: 3.979 Test Acc: 0.035
Validation loss decreased (inf --> -0.034556).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0626895
	speed: 1.3559s/iter; left time: 27787.2219s
	iters: 200, epoch: 2 | loss: 3.1096823
	speed: 0.5164s/iter; left time: 10531.2436s
Epoch: 2 cost time: 107.7586100101471
Epoch: 2, Steps: 208 | Train Loss: 3.294 Vali Loss: 4.761 Vali Acc: 0.037 Test Loss: 4.761 Test Acc: 0.037
Validation loss decreased (-0.034556 --> -0.036934).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1015234
	speed: 1.2919s/iter; left time: 26205.2185s
	iters: 200, epoch: 3 | loss: 3.2329311
	speed: 0.5132s/iter; left time: 10358.4782s
Epoch: 3 cost time: 106.85985350608826
Epoch: 3, Steps: 208 | Train Loss: 3.018 Vali Loss: 4.774 Vali Acc: 0.041 Test Loss: 4.774 Test Acc: 0.041
Validation loss decreased (-0.036934 --> -0.040513).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8604290
	speed: 1.3410s/iter; left time: 26923.0726s
	iters: 200, epoch: 4 | loss: 2.4878385
	speed: 0.4851s/iter; left time: 9691.0717s
Epoch: 4 cost time: 105.91889691352844
Epoch: 4, Steps: 208 | Train Loss: 2.827 Vali Loss: 4.693 Vali Acc: 0.049 Test Loss: 4.693 Test Acc: 0.049
Validation loss decreased (-0.040513 --> -0.048864).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0853031
	speed: 1.2467s/iter; left time: 24770.8957s
	iters: 200, epoch: 5 | loss: 3.1349092
	speed: 0.4715s/iter; left time: 9321.6787s
Epoch: 5 cost time: 99.86787557601929
Epoch: 5, Steps: 208 | Train Loss: 2.612 Vali Loss: 4.910 Vali Acc: 0.052 Test Loss: 4.910 Test Acc: 0.052
Validation loss decreased (-0.048864 --> -0.051546).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1683753
	speed: 1.2737s/iter; left time: 25041.7018s
	iters: 200, epoch: 6 | loss: 2.9274230
	speed: 0.4833s/iter; left time: 9454.5284s
Epoch: 6 cost time: 102.23315811157227
Epoch: 6, Steps: 208 | Train Loss: 2.355 Vali Loss: 4.834 Vali Acc: 0.060 Test Loss: 4.834 Test Acc: 0.060
Validation loss decreased (-0.051546 --> -0.059898).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0762208
	speed: 1.2704s/iter; left time: 24713.8771s
	iters: 200, epoch: 7 | loss: 1.8711009
	speed: 0.5239s/iter; left time: 10139.8983s
Epoch: 7 cost time: 109.06781244277954
Epoch: 7, Steps: 208 | Train Loss: 2.048 Vali Loss: 5.125 Vali Acc: 0.055 Test Loss: 5.125 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6538290
	speed: 1.3613s/iter; left time: 26198.3103s
	iters: 200, epoch: 8 | loss: 1.4906772
	speed: 0.5601s/iter; left time: 10723.0127s
Epoch: 8 cost time: 116.06148505210876
Epoch: 8, Steps: 208 | Train Loss: 1.793 Vali Loss: 5.292 Vali Acc: 0.067 Test Loss: 5.292 Test Acc: 0.067
Validation loss decreased (-0.059898 --> -0.066753).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0853710
	speed: 1.3392s/iter; left time: 25494.6034s
	iters: 200, epoch: 9 | loss: 2.3081560
	speed: 0.5020s/iter; left time: 9506.5644s
Epoch: 9 cost time: 107.49491715431213
Epoch: 9, Steps: 208 | Train Loss: 1.548 Vali Loss: 5.549 Vali Acc: 0.066 Test Loss: 5.549 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1194178
	speed: 1.3030s/iter; left time: 24533.9562s
	iters: 200, epoch: 10 | loss: 1.2770501
	speed: 0.4895s/iter; left time: 9167.5554s
Epoch: 10 cost time: 104.85476446151733
Epoch: 10, Steps: 208 | Train Loss: 1.312 Vali Loss: 5.783 Vali Acc: 0.064 Test Loss: 5.783 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5271420
	speed: 1.3231s/iter; left time: 24636.8764s
	iters: 200, epoch: 11 | loss: 1.8437122
	speed: 0.5197s/iter; left time: 9625.2787s
Epoch: 11 cost time: 109.61165809631348
Epoch: 11, Steps: 208 | Train Loss: 1.134 Vali Loss: 6.217 Vali Acc: 0.069 Test Loss: 6.217 Test Acc: 0.069
Validation loss decreased (-0.066753 --> -0.069130).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7197793
	speed: 1.3701s/iter; left time: 25226.9357s
	iters: 200, epoch: 12 | loss: 1.3458526
	speed: 0.5361s/iter; left time: 9817.6352s
Epoch: 12 cost time: 112.45867490768433
Epoch: 12, Steps: 208 | Train Loss: 0.983 Vali Loss: 6.565 Vali Acc: 0.073 Test Loss: 6.565 Test Acc: 0.073
Validation loss decreased (-0.069130 --> -0.072705).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7852190
	speed: 1.3809s/iter; left time: 25139.5914s
	iters: 200, epoch: 13 | loss: 0.7918571
	speed: 0.5278s/iter; left time: 9555.2656s
Epoch: 13 cost time: 112.21226215362549
Epoch: 13, Steps: 208 | Train Loss: 0.824 Vali Loss: 6.613 Vali Acc: 0.078 Test Loss: 6.613 Test Acc: 0.078
Validation loss decreased (-0.072705 --> -0.077775).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4404600
	speed: 1.3871s/iter; left time: 24963.0809s
	iters: 200, epoch: 14 | loss: 1.3678956
	speed: 0.5611s/iter; left time: 10042.8805s
Epoch: 14 cost time: 116.74953603744507
Epoch: 14, Steps: 208 | Train Loss: 0.730 Vali Loss: 7.091 Vali Acc: 0.068 Test Loss: 7.091 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3360899
	speed: 1.3923s/iter; left time: 24768.0170s
	iters: 200, epoch: 15 | loss: 1.0770025
	speed: 0.5251s/iter; left time: 9289.1928s
Epoch: 15 cost time: 115.29194974899292
Epoch: 15, Steps: 208 | Train Loss: 0.641 Vali Loss: 7.357 Vali Acc: 0.071 Test Loss: 7.357 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4460706
	speed: 1.3946s/iter; left time: 24517.9046s
	iters: 200, epoch: 16 | loss: 0.8824648
	speed: 0.5309s/iter; left time: 9281.3745s
Epoch: 16 cost time: 112.24270296096802
Epoch: 16, Steps: 208 | Train Loss: 0.596 Vali Loss: 7.554 Vali Acc: 0.082 Test Loss: 7.554 Test Acc: 0.082
Validation loss decreased (-0.077775 --> -0.082239).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5726130
	speed: 1.3546s/iter; left time: 23533.9164s
	iters: 200, epoch: 17 | loss: 0.2422762
	speed: 0.5215s/iter; left time: 9008.0919s
Epoch: 17 cost time: 110.20575284957886
Epoch: 17, Steps: 208 | Train Loss: 0.526 Vali Loss: 7.901 Vali Acc: 0.075 Test Loss: 7.901 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.4588522
	speed: 1.2997s/iter; left time: 22310.0707s
	iters: 200, epoch: 18 | loss: 0.2897682
	speed: 0.5419s/iter; left time: 9248.2880s
Epoch: 18 cost time: 110.40928912162781
Epoch: 18, Steps: 208 | Train Loss: 0.477 Vali Loss: 8.097 Vali Acc: 0.078 Test Loss: 8.097 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2121617
	speed: 1.3327s/iter; left time: 22599.1018s
	iters: 200, epoch: 19 | loss: 0.5202661
	speed: 0.4950s/iter; left time: 8343.4767s
Epoch: 19 cost time: 102.68626403808594
Epoch: 19, Steps: 208 | Train Loss: 0.446 Vali Loss: 8.344 Vali Acc: 0.088 Test Loss: 8.344 Test Acc: 0.088
Validation loss decreased (-0.082239 --> -0.087599).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3509732
	speed: 1.3778s/iter; left time: 23077.6093s
	iters: 200, epoch: 20 | loss: 0.1116531
	speed: 0.5276s/iter; left time: 8783.7309s
Epoch: 20 cost time: 112.75828075408936
Epoch: 20, Steps: 208 | Train Loss: 0.395 Vali Loss: 8.533 Vali Acc: 0.081 Test Loss: 8.533 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.7854084
	speed: 1.3240s/iter; left time: 21900.5200s
	iters: 200, epoch: 21 | loss: 0.7497615
	speed: 0.5342s/iter; left time: 8783.3805s
Epoch: 21 cost time: 108.58815169334412
Epoch: 21, Steps: 208 | Train Loss: 0.367 Vali Loss: 8.749 Vali Acc: 0.085 Test Loss: 8.749 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.3362578
	speed: 1.3779s/iter; left time: 22504.7478s
	iters: 200, epoch: 22 | loss: 0.6010497
	speed: 0.5594s/iter; left time: 9081.0896s
Epoch: 22 cost time: 115.72955012321472
Epoch: 22, Steps: 208 | Train Loss: 0.351 Vali Loss: 9.041 Vali Acc: 0.084 Test Loss: 9.041 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4839818
	speed: 1.3432s/iter; left time: 21658.9678s
	iters: 200, epoch: 23 | loss: 0.5086066
	speed: 0.5163s/iter; left time: 8274.3615s
Epoch: 23 cost time: 106.10120368003845
Epoch: 23, Steps: 208 | Train Loss: 0.319 Vali Loss: 8.979 Vali Acc: 0.083 Test Loss: 8.979 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2548032
	speed: 1.3600s/iter; left time: 21646.5047s
	iters: 200, epoch: 24 | loss: 0.1824598
	speed: 0.5195s/iter; left time: 8217.4960s
Epoch: 24 cost time: 110.87696504592896
Epoch: 24, Steps: 208 | Train Loss: 0.318 Vali Loss: 9.347 Vali Acc: 0.084 Test Loss: 9.347 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1742029
	speed: 1.3766s/iter; left time: 21625.4509s
	iters: 200, epoch: 25 | loss: 0.6888588
	speed: 0.5001s/iter; left time: 7805.8565s
Epoch: 25 cost time: 108.22491884231567
Epoch: 25, Steps: 208 | Train Loss: 0.289 Vali Loss: 9.390 Vali Acc: 0.085 Test Loss: 9.390 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0109851
	speed: 1.4001s/iter; left time: 21703.0382s
	iters: 200, epoch: 26 | loss: 0.8621362
	speed: 0.5207s/iter; left time: 8019.8902s
Epoch: 26 cost time: 112.07687449455261
Epoch: 26, Steps: 208 | Train Loss: 0.265 Vali Loss: 9.591 Vali Acc: 0.088 Test Loss: 9.591 Test Acc: 0.088
Validation loss decreased (-0.087599 --> -0.087885).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.2629282
	speed: 1.2686s/iter; left time: 19401.2901s
	iters: 200, epoch: 27 | loss: 0.0618076
	speed: 0.5423s/iter; left time: 8239.3851s
Epoch: 27 cost time: 111.50702118873596
Epoch: 27, Steps: 208 | Train Loss: 0.245 Vali Loss: 9.746 Vali Acc: 0.088 Test Loss: 9.746 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0732385
	speed: 1.3209s/iter; left time: 19926.0034s
	iters: 200, epoch: 28 | loss: 0.0346462
	speed: 0.4591s/iter; left time: 6879.6827s
Epoch: 28 cost time: 100.37159419059753
Epoch: 28, Steps: 208 | Train Loss: 0.253 Vali Loss: 9.957 Vali Acc: 0.087 Test Loss: 9.957 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.1180651
	speed: 1.2013s/iter; left time: 17871.8399s
	iters: 200, epoch: 29 | loss: 0.0381146
	speed: 0.4735s/iter; left time: 6996.9470s
Epoch: 29 cost time: 98.13147950172424
Epoch: 29, Steps: 208 | Train Loss: 0.240 Vali Loss: 10.340 Vali Acc: 0.084 Test Loss: 10.340 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0621480
	speed: 1.2092s/iter; left time: 17737.2784s
	iters: 200, epoch: 30 | loss: 0.0457392
	speed: 0.4856s/iter; left time: 7074.2022s
Epoch: 30 cost time: 100.06199193000793
Epoch: 30, Steps: 208 | Train Loss: 0.227 Vali Loss: 10.199 Vali Acc: 0.083 Test Loss: 10.199 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0901511
	speed: 1.2899s/iter; left time: 18653.7886s
	iters: 200, epoch: 31 | loss: 0.3103532
	speed: 0.5704s/iter; left time: 8191.6955s
Epoch: 31 cost time: 114.50659418106079
Epoch: 31, Steps: 208 | Train Loss: 0.220 Vali Loss: 10.502 Vali Acc: 0.084 Test Loss: 10.502 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0151689
	speed: 1.3795s/iter; left time: 19662.2249s
	iters: 200, epoch: 32 | loss: 0.1862779
	speed: 0.5250s/iter; left time: 7430.9406s
Epoch: 32 cost time: 111.67411875724792
Epoch: 32, Steps: 208 | Train Loss: 0.207 Vali Loss: 10.532 Vali Acc: 0.086 Test Loss: 10.532 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.1719359
	speed: 1.3289s/iter; left time: 18664.5553s
	iters: 200, epoch: 33 | loss: 0.2020776
	speed: 0.5409s/iter; left time: 7542.6861s
Epoch: 33 cost time: 113.41000461578369
Epoch: 33, Steps: 208 | Train Loss: 0.201 Vali Loss: 10.723 Vali Acc: 0.088 Test Loss: 10.723 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.1130742
	speed: 1.3599s/iter; left time: 18817.1121s
	iters: 200, epoch: 34 | loss: 0.3238355
	speed: 0.5554s/iter; left time: 7630.2147s
Epoch: 34 cost time: 114.80657267570496
Epoch: 34, Steps: 208 | Train Loss: 0.197 Vali Loss: 10.637 Vali Acc: 0.086 Test Loss: 10.637 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0135125
	speed: 1.4050s/iter; left time: 19148.9754s
	iters: 200, epoch: 35 | loss: 0.0578155
	speed: 0.5917s/iter; left time: 8005.5291s
Epoch: 35 cost time: 124.27838397026062
Epoch: 35, Steps: 208 | Train Loss: 0.178 Vali Loss: 10.678 Vali Acc: 0.091 Test Loss: 10.678 Test Acc: 0.091
Validation loss decreased (-0.087885 --> -0.090857).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.2704208
	speed: 1.2890s/iter; left time: 17299.4636s
	iters: 200, epoch: 36 | loss: 0.1781246
	speed: 0.5121s/iter; left time: 6821.5916s
Epoch: 36 cost time: 104.80476570129395
Epoch: 36, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.909 Vali Acc: 0.084 Test Loss: 10.909 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0464535
	speed: 1.2711s/iter; left time: 16795.0997s
	iters: 200, epoch: 37 | loss: 0.0568079
	speed: 0.4964s/iter; left time: 6509.1511s
Epoch: 37 cost time: 104.29150605201721
Epoch: 37, Steps: 208 | Train Loss: 0.181 Vali Loss: 11.236 Vali Acc: 0.093 Test Loss: 11.236 Test Acc: 0.093
Validation loss decreased (-0.090857 --> -0.092939).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0709695
	speed: 1.2849s/iter; left time: 16709.6658s
	iters: 200, epoch: 38 | loss: 0.0141014
	speed: 0.5277s/iter; left time: 6810.2777s
Epoch: 38 cost time: 110.0636477470398
Epoch: 38, Steps: 208 | Train Loss: 0.160 Vali Loss: 10.967 Vali Acc: 0.087 Test Loss: 10.967 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0320084
	speed: 1.2814s/iter; left time: 16398.3006s
	iters: 200, epoch: 39 | loss: 0.2377160
	speed: 0.4892s/iter; left time: 6211.8087s
Epoch: 39 cost time: 103.7904920578003
Epoch: 39, Steps: 208 | Train Loss: 0.171 Vali Loss: 11.119 Vali Acc: 0.089 Test Loss: 11.119 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.1297777
	speed: 1.2375s/iter; left time: 15579.0578s
	iters: 200, epoch: 40 | loss: 0.2043506
	speed: 0.4812s/iter; left time: 6009.9714s
Epoch: 40 cost time: 100.90337371826172
Epoch: 40, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.310 Vali Acc: 0.095 Test Loss: 11.310 Test Acc: 0.095
Validation loss decreased (-0.092939 --> -0.094429).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0727366
	speed: 1.2145s/iter; left time: 15036.2519s
	iters: 200, epoch: 41 | loss: 0.2706563
	speed: 0.5123s/iter; left time: 6291.2222s
Epoch: 41 cost time: 104.98179292678833
Epoch: 41, Steps: 208 | Train Loss: 0.150 Vali Loss: 11.233 Vali Acc: 0.089 Test Loss: 11.233 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.2477310
	speed: 1.3095s/iter; left time: 15940.8308s
	iters: 200, epoch: 42 | loss: 0.1741502
	speed: 0.5326s/iter; left time: 6429.5232s
Epoch: 42 cost time: 108.08796834945679
Epoch: 42, Steps: 208 | Train Loss: 0.145 Vali Loss: 11.415 Vali Acc: 0.091 Test Loss: 11.415 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0298772
	speed: 1.2813s/iter; left time: 15331.1761s
	iters: 200, epoch: 43 | loss: 0.0282495
	speed: 0.4742s/iter; left time: 5626.6072s
Epoch: 43 cost time: 103.41781854629517
Epoch: 43, Steps: 208 | Train Loss: 0.142 Vali Loss: 11.268 Vali Acc: 0.088 Test Loss: 11.268 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.6460789
	speed: 1.1858s/iter; left time: 13941.0605s
	iters: 200, epoch: 44 | loss: 0.0441068
	speed: 0.4799s/iter; left time: 5594.2063s
Epoch: 44 cost time: 98.75996661186218
Epoch: 44, Steps: 208 | Train Loss: 0.123 Vali Loss: 11.926 Vali Acc: 0.089 Test Loss: 11.926 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.1583807
	speed: 1.2618s/iter; left time: 14572.7208s
	iters: 200, epoch: 45 | loss: 0.0098570
	speed: 0.5372s/iter; left time: 6150.1999s
Epoch: 45 cost time: 109.3849823474884
Epoch: 45, Steps: 208 | Train Loss: 0.136 Vali Loss: 11.785 Vali Acc: 0.089 Test Loss: 11.785 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.1686657
	speed: 1.3033s/iter; left time: 14780.5979s
	iters: 200, epoch: 46 | loss: 0.0825760
	speed: 0.5640s/iter; left time: 6340.4691s
Epoch: 46 cost time: 113.77644276618958
Epoch: 46, Steps: 208 | Train Loss: 0.125 Vali Loss: 11.736 Vali Acc: 0.092 Test Loss: 11.736 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.1585764
	speed: 1.3359s/iter; left time: 14873.1003s
	iters: 200, epoch: 47 | loss: 0.1051399
	speed: 0.4805s/iter; left time: 5301.7363s
Epoch: 47 cost time: 106.28504014015198
Epoch: 47, Steps: 208 | Train Loss: 0.144 Vali Loss: 11.808 Vali Acc: 0.089 Test Loss: 11.808 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.1761537
	speed: 1.2664s/iter; left time: 13835.0079s
	iters: 200, epoch: 48 | loss: 0.7215466
	speed: 0.5728s/iter; left time: 6201.1011s
Epoch: 48 cost time: 115.4906907081604
Epoch: 48, Steps: 208 | Train Loss: 0.140 Vali Loss: 11.827 Vali Acc: 0.088 Test Loss: 11.827 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0247023
	speed: 1.3785s/iter; left time: 14773.5137s
	iters: 200, epoch: 49 | loss: 0.1851244
	speed: 0.5055s/iter; left time: 5366.5826s
Epoch: 49 cost time: 110.24425792694092
Epoch: 49, Steps: 208 | Train Loss: 0.099 Vali Loss: 12.074 Vali Acc: 0.092 Test Loss: 12.074 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.3151794
	speed: 1.2784s/iter; left time: 13434.2576s
	iters: 200, epoch: 50 | loss: 0.0308792
	speed: 0.5176s/iter; left time: 5387.5622s
Epoch: 50 cost time: 109.2319769859314
Epoch: 50, Steps: 208 | Train Loss: 0.127 Vali Loss: 12.029 Vali Acc: 0.084 Test Loss: 12.029 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0945422010140173
model parameter : 511047
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7815547
	speed: 0.6327s/iter; left time: 13097.2539s
	iters: 200, epoch: 1 | loss: 3.6440392
	speed: 0.6163s/iter; left time: 12697.0598s
Epoch: 1 cost time: 131.00986695289612
Epoch: 1, Steps: 208 | Train Loss: 3.655 Vali Loss: 3.439 Vali Acc: 0.078 Test Loss: 3.439 Test Acc: 0.078
Validation loss decreased (inf --> -0.077508).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0248194
	speed: 1.5972s/iter; left time: 32732.2920s
	iters: 200, epoch: 2 | loss: 3.1213412
	speed: 0.6054s/iter; left time: 12346.5754s
Epoch: 2 cost time: 128.0541377067566
Epoch: 2, Steps: 208 | Train Loss: 3.147 Vali Loss: 3.503 Vali Acc: 0.092 Test Loss: 3.503 Test Acc: 0.092
Validation loss decreased (-0.077508 --> -0.092121).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3645246
	speed: 1.4944s/iter; left time: 30314.4880s
	iters: 200, epoch: 3 | loss: 2.0718007
	speed: 0.6147s/iter; left time: 12407.2525s
Epoch: 3 cost time: 126.89689898490906
Epoch: 3, Steps: 208 | Train Loss: 2.599 Vali Loss: 3.738 Vali Acc: 0.086 Test Loss: 3.738 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8918390
	speed: 1.5641s/iter; left time: 31403.2701s
	iters: 200, epoch: 4 | loss: 1.6695275
	speed: 0.6482s/iter; left time: 12948.9498s
Epoch: 4 cost time: 132.86032485961914
Epoch: 4, Steps: 208 | Train Loss: 2.094 Vali Loss: 4.014 Vali Acc: 0.103 Test Loss: 4.014 Test Acc: 0.103
Validation loss decreased (-0.092121 --> -0.102555).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7603515
	speed: 1.6176s/iter; left time: 32139.3351s
	iters: 200, epoch: 5 | loss: 1.4211278
	speed: 0.6235s/iter; left time: 12326.7726s
Epoch: 5 cost time: 132.9078085422516
Epoch: 5, Steps: 208 | Train Loss: 1.579 Vali Loss: 4.332 Vali Acc: 0.099 Test Loss: 4.332 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6675543
	speed: 1.6052s/iter; left time: 31560.4246s
	iters: 200, epoch: 6 | loss: 1.7969011
	speed: 0.6056s/iter; left time: 11846.2307s
Epoch: 6 cost time: 132.90092301368713
Epoch: 6, Steps: 208 | Train Loss: 1.162 Vali Loss: 4.865 Vali Acc: 0.100 Test Loss: 4.865 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1415340
	speed: 1.4868s/iter; left time: 28922.9433s
	iters: 200, epoch: 7 | loss: 0.7064225
	speed: 0.5586s/iter; left time: 10810.2680s
Epoch: 7 cost time: 117.05085706710815
Epoch: 7, Steps: 208 | Train Loss: 0.859 Vali Loss: 5.466 Vali Acc: 0.095 Test Loss: 5.466 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2802736
	speed: 1.4758s/iter; left time: 28401.4356s
	iters: 200, epoch: 8 | loss: 0.5439574
	speed: 0.5749s/iter; left time: 11007.2403s
Epoch: 8 cost time: 122.18836855888367
Epoch: 8, Steps: 208 | Train Loss: 0.651 Vali Loss: 6.068 Vali Acc: 0.101 Test Loss: 6.068 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2381847
	speed: 1.5132s/iter; left time: 28807.1468s
	iters: 200, epoch: 9 | loss: 1.4415900
	speed: 0.5916s/iter; left time: 11203.1159s
Epoch: 9 cost time: 123.1109938621521
Epoch: 9, Steps: 208 | Train Loss: 0.512 Vali Loss: 6.552 Vali Acc: 0.096 Test Loss: 6.552 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4872144
	speed: 1.5007s/iter; left time: 28257.5600s
	iters: 200, epoch: 10 | loss: 0.2889610
	speed: 0.5852s/iter; left time: 10959.7628s
Epoch: 10 cost time: 122.26147794723511
Epoch: 10, Steps: 208 | Train Loss: 0.442 Vali Loss: 7.095 Vali Acc: 0.090 Test Loss: 7.095 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.5995454
	speed: 1.5578s/iter; left time: 29007.3781s
	iters: 200, epoch: 11 | loss: 0.3812889
	speed: 0.5994s/iter; left time: 11100.7482s
Epoch: 11 cost time: 125.4431505203247
Epoch: 11, Steps: 208 | Train Loss: 0.382 Vali Loss: 7.196 Vali Acc: 0.092 Test Loss: 7.196 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1545328
	speed: 1.5689s/iter; left time: 28888.4900s
	iters: 200, epoch: 12 | loss: 0.4336435
	speed: 0.6419s/iter; left time: 11755.7965s
Epoch: 12 cost time: 134.77975153923035
Epoch: 12, Steps: 208 | Train Loss: 0.286 Vali Loss: 7.755 Vali Acc: 0.094 Test Loss: 7.755 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3049529
	speed: 1.5360s/iter; left time: 27962.9862s
	iters: 200, epoch: 13 | loss: 0.6336029
	speed: 0.6136s/iter; left time: 11108.3333s
Epoch: 13 cost time: 128.80415630340576
Epoch: 13, Steps: 208 | Train Loss: 0.289 Vali Loss: 8.237 Vali Acc: 0.097 Test Loss: 8.237 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7566691
	speed: 1.6515s/iter; left time: 29722.9070s
	iters: 200, epoch: 14 | loss: 0.2534525
	speed: 0.6243s/iter; left time: 11173.6793s
Epoch: 14 cost time: 136.54863929748535
Epoch: 14, Steps: 208 | Train Loss: 0.266 Vali Loss: 8.739 Vali Acc: 0.092 Test Loss: 8.739 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1025946913212049
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6971610
	speed: 0.6349s/iter; left time: 13142.1616s
	iters: 200, epoch: 1 | loss: 3.6524048
	speed: 0.6006s/iter; left time: 12372.2365s
Epoch: 1 cost time: 128.89142370224
Epoch: 1, Steps: 208 | Train Loss: 3.646 Vali Loss: 3.442 Vali Acc: 0.077 Test Loss: 3.442 Test Acc: 0.077
Validation loss decreased (inf --> -0.076912).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9358933
	speed: 1.6227s/iter; left time: 33254.8754s
	iters: 200, epoch: 2 | loss: 2.9562178
	speed: 0.7036s/iter; left time: 14349.1096s
Epoch: 2 cost time: 145.56047916412354
Epoch: 2, Steps: 208 | Train Loss: 3.133 Vali Loss: 3.515 Vali Acc: 0.098 Test Loss: 3.515 Test Acc: 0.098
Validation loss decreased (-0.076912 --> -0.097788).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2997439
	speed: 1.6305s/iter; left time: 33074.8524s
	iters: 200, epoch: 3 | loss: 1.9201096
	speed: 0.6598s/iter; left time: 13318.4509s
Epoch: 3 cost time: 137.60320115089417
Epoch: 3, Steps: 208 | Train Loss: 2.582 Vali Loss: 3.714 Vali Acc: 0.086 Test Loss: 3.714 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8171312
	speed: 1.6327s/iter; left time: 32780.4664s
	iters: 200, epoch: 4 | loss: 1.9493115
	speed: 0.6288s/iter; left time: 12561.1958s
Epoch: 4 cost time: 132.55787754058838
Epoch: 4, Steps: 208 | Train Loss: 2.079 Vali Loss: 4.077 Vali Acc: 0.093 Test Loss: 4.077 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7324321
	speed: 1.6900s/iter; left time: 33578.2910s
	iters: 200, epoch: 5 | loss: 1.4046832
	speed: 0.6530s/iter; left time: 12909.3733s
Epoch: 5 cost time: 142.18401193618774
Epoch: 5, Steps: 208 | Train Loss: 1.571 Vali Loss: 4.311 Vali Acc: 0.102 Test Loss: 4.311 Test Acc: 0.102
Validation loss decreased (-0.097788 --> -0.101955).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7286412
	speed: 1.5988s/iter; left time: 31434.7640s
	iters: 200, epoch: 6 | loss: 1.9015982
	speed: 0.6486s/iter; left time: 12686.8940s
Epoch: 6 cost time: 133.724760055542
Epoch: 6, Steps: 208 | Train Loss: 1.158 Vali Loss: 4.886 Vali Acc: 0.097 Test Loss: 4.886 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2719014
	speed: 1.7846s/iter; left time: 34715.8184s
	iters: 200, epoch: 7 | loss: 0.6847931
	speed: 0.6491s/iter; left time: 12561.8841s
Epoch: 7 cost time: 140.35635948181152
Epoch: 7, Steps: 208 | Train Loss: 0.850 Vali Loss: 5.438 Vali Acc: 0.097 Test Loss: 5.438 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1743718
	speed: 1.6636s/iter; left time: 32016.8398s
	iters: 200, epoch: 8 | loss: 0.6725438
	speed: 0.5911s/iter; left time: 11316.2434s
Epoch: 8 cost time: 129.984628200531
Epoch: 8, Steps: 208 | Train Loss: 0.659 Vali Loss: 6.106 Vali Acc: 0.092 Test Loss: 6.106 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1714804
	speed: 1.6014s/iter; left time: 30486.0919s
	iters: 200, epoch: 9 | loss: 1.2600696
	speed: 0.6639s/iter; left time: 12571.3609s
Epoch: 9 cost time: 138.42133235931396
Epoch: 9, Steps: 208 | Train Loss: 0.522 Vali Loss: 6.530 Vali Acc: 0.089 Test Loss: 6.530 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4032606
	speed: 1.6962s/iter; left time: 31936.9592s
	iters: 200, epoch: 10 | loss: 0.2491849
	speed: 0.6673s/iter; left time: 12498.4682s
Epoch: 10 cost time: 133.60083103179932
Epoch: 10, Steps: 208 | Train Loss: 0.428 Vali Loss: 7.118 Vali Acc: 0.089 Test Loss: 7.118 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.5355522
	speed: 1.6876s/iter; left time: 31424.9180s
	iters: 200, epoch: 11 | loss: 0.4456351
	speed: 0.6638s/iter; left time: 12293.9618s
Epoch: 11 cost time: 142.08569145202637
Epoch: 11, Steps: 208 | Train Loss: 0.412 Vali Loss: 7.330 Vali Acc: 0.091 Test Loss: 7.330 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2555572
	speed: 1.6608s/iter; left time: 30580.6158s
	iters: 200, epoch: 12 | loss: 1.0580630
	speed: 0.6378s/iter; left time: 11679.7935s
Epoch: 12 cost time: 133.6524088382721
Epoch: 12, Steps: 208 | Train Loss: 0.299 Vali Loss: 7.782 Vali Acc: 0.091 Test Loss: 7.782 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2950754
	speed: 1.6690s/iter; left time: 30384.3208s
	iters: 200, epoch: 13 | loss: 0.7010772
	speed: 0.6901s/iter; left time: 12494.5006s
Epoch: 13 cost time: 142.35092663764954
Epoch: 13, Steps: 208 | Train Loss: 0.273 Vali Loss: 8.519 Vali Acc: 0.088 Test Loss: 8.519 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0179904
	speed: 1.6928s/iter; left time: 30466.2034s
	iters: 200, epoch: 14 | loss: 0.5819315
	speed: 0.6234s/iter; left time: 11156.8176s
Epoch: 14 cost time: 136.16546201705933
Epoch: 14, Steps: 208 | Train Loss: 0.255 Vali Loss: 8.551 Vali Acc: 0.093 Test Loss: 8.551 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0289716
	speed: 1.6908s/iter; left time: 30077.1550s
	iters: 200, epoch: 15 | loss: 0.1345595
	speed: 0.6970s/iter; left time: 12329.8073s
Epoch: 15 cost time: 148.61821675300598
Epoch: 15, Steps: 208 | Train Loss: 0.240 Vali Loss: 8.707 Vali Acc: 0.096 Test Loss: 8.707 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10199821055770951
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7772107
	speed: 0.6725s/iter; left time: 13921.9652s
	iters: 200, epoch: 1 | loss: 3.5350666
	speed: 0.6995s/iter; left time: 14410.1648s
Epoch: 1 cost time: 142.7084732055664
Epoch: 1, Steps: 208 | Train Loss: 3.660 Vali Loss: 3.440 Vali Acc: 0.073 Test Loss: 3.440 Test Acc: 0.073
Validation loss decreased (inf --> -0.073034).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9154482
	speed: 1.7263s/iter; left time: 35377.2486s
	iters: 200, epoch: 2 | loss: 2.9620352
	speed: 0.6807s/iter; left time: 13882.5114s
Epoch: 2 cost time: 147.5038948059082
Epoch: 2, Steps: 208 | Train Loss: 3.146 Vali Loss: 3.513 Vali Acc: 0.102 Test Loss: 3.513 Test Acc: 0.102
Validation loss decreased (-0.073034 --> -0.101665).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4463019
	speed: 1.6231s/iter; left time: 32923.9150s
	iters: 200, epoch: 3 | loss: 1.9963951
	speed: 0.6845s/iter; left time: 13817.4520s
Epoch: 3 cost time: 135.72540283203125
Epoch: 3, Steps: 208 | Train Loss: 2.594 Vali Loss: 3.720 Vali Acc: 0.084 Test Loss: 3.720 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8099165
	speed: 1.7859s/iter; left time: 35855.6555s
	iters: 200, epoch: 4 | loss: 1.8278481
	speed: 0.6646s/iter; left time: 13276.8438s
Epoch: 4 cost time: 144.17360544204712
Epoch: 4, Steps: 208 | Train Loss: 2.106 Vali Loss: 4.044 Vali Acc: 0.094 Test Loss: 4.044 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7411784
	speed: 1.7121s/iter; left time: 34016.7317s
	iters: 200, epoch: 5 | loss: 1.7060879
	speed: 0.7087s/iter; left time: 14010.8611s
Epoch: 5 cost time: 147.57658910751343
Epoch: 5, Steps: 208 | Train Loss: 1.599 Vali Loss: 4.371 Vali Acc: 0.097 Test Loss: 4.371 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6568715
	speed: 1.6894s/iter; left time: 33215.9250s
	iters: 200, epoch: 6 | loss: 2.0767939
	speed: 0.6144s/iter; left time: 12018.0752s
Epoch: 6 cost time: 131.99034786224365
Epoch: 6, Steps: 208 | Train Loss: 1.188 Vali Loss: 4.862 Vali Acc: 0.099 Test Loss: 4.862 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3522412
	speed: 1.4677s/iter; left time: 28550.6189s
	iters: 200, epoch: 7 | loss: 0.9387295
	speed: 0.6367s/iter; left time: 12322.1948s
Epoch: 7 cost time: 127.09843897819519
Epoch: 7, Steps: 208 | Train Loss: 0.881 Vali Loss: 5.330 Vali Acc: 0.097 Test Loss: 5.330 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.4863911
	speed: 1.6137s/iter; left time: 31055.5977s
	iters: 200, epoch: 8 | loss: 0.8985128
	speed: 0.6183s/iter; left time: 11837.8017s
Epoch: 8 cost time: 130.66752314567566
Epoch: 8, Steps: 208 | Train Loss: 0.675 Vali Loss: 6.000 Vali Acc: 0.086 Test Loss: 6.000 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0513631
	speed: 1.5639s/iter; left time: 29772.3425s
	iters: 200, epoch: 9 | loss: 1.5606449
	speed: 0.5978s/iter; left time: 11320.9930s
Epoch: 9 cost time: 128.29127144813538
Epoch: 9, Steps: 208 | Train Loss: 0.543 Vali Loss: 6.371 Vali Acc: 0.088 Test Loss: 6.371 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.4297919
	speed: 1.5122s/iter; left time: 28473.3935s
	iters: 200, epoch: 10 | loss: 0.3249097
	speed: 0.6327s/iter; left time: 11850.1399s
Epoch: 10 cost time: 128.24072742462158
Epoch: 10, Steps: 208 | Train Loss: 0.446 Vali Loss: 6.907 Vali Acc: 0.095 Test Loss: 6.907 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6707487
	speed: 1.4899s/iter; left time: 27744.1106s
	iters: 200, epoch: 11 | loss: 0.7508898
	speed: 0.6603s/iter; left time: 12229.6368s
Epoch: 11 cost time: 128.48007988929749
Epoch: 11, Steps: 208 | Train Loss: 0.392 Vali Loss: 7.581 Vali Acc: 0.094 Test Loss: 7.581 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1551047
	speed: 1.5682s/iter; left time: 28875.3906s
	iters: 200, epoch: 12 | loss: 0.8559949
	speed: 0.6280s/iter; left time: 11501.3981s
Epoch: 12 cost time: 129.2418987751007
Epoch: 12, Steps: 208 | Train Loss: 0.327 Vali Loss: 7.854 Vali Acc: 0.101 Test Loss: 7.854 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10169997017596183
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7839286
	speed: 0.6742s/iter; left time: 13957.0305s
	iters: 200, epoch: 1 | loss: 3.4635463
	speed: 0.5984s/iter; left time: 12327.8450s
Epoch: 1 cost time: 132.5522425174713
Epoch: 1, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.436 Vali Acc: 0.075 Test Loss: 3.436 Test Acc: 0.075
Validation loss decreased (inf --> -0.075420).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0606704
	speed: 1.4495s/iter; left time: 29704.1483s
	iters: 200, epoch: 2 | loss: 2.9141195
	speed: 0.5386s/iter; left time: 10984.2836s
Epoch: 2 cost time: 115.89863562583923
Epoch: 2, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.488 Vali Acc: 0.099 Test Loss: 3.488 Test Acc: 0.099
Validation loss decreased (-0.075420 --> -0.098981).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2124083
	speed: 1.4433s/iter; left time: 29277.4465s
	iters: 200, epoch: 3 | loss: 2.0877140
	speed: 0.6168s/iter; left time: 12449.5810s
Epoch: 3 cost time: 124.00144410133362
Epoch: 3, Steps: 208 | Train Loss: 2.597 Vali Loss: 3.720 Vali Acc: 0.091 Test Loss: 3.720 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9335625
	speed: 1.3806s/iter; left time: 27717.9548s
	iters: 200, epoch: 4 | loss: 1.7576127
	speed: 0.5474s/iter; left time: 10934.9895s
Epoch: 4 cost time: 114.93378281593323
Epoch: 4, Steps: 208 | Train Loss: 2.071 Vali Loss: 3.956 Vali Acc: 0.096 Test Loss: 3.956 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.6183937
	speed: 1.4332s/iter; left time: 28475.9095s
	iters: 200, epoch: 5 | loss: 1.3355494
	speed: 0.5542s/iter; left time: 10956.2873s
Epoch: 5 cost time: 118.3494701385498
Epoch: 5, Steps: 208 | Train Loss: 1.548 Vali Loss: 4.322 Vali Acc: 0.106 Test Loss: 4.322 Test Acc: 0.106
Validation loss decreased (-0.098981 --> -0.106429).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8032767
	speed: 1.4155s/iter; left time: 27829.7948s
	iters: 200, epoch: 6 | loss: 1.6108271
	speed: 0.5500s/iter; left time: 10758.5066s
Epoch: 6 cost time: 113.80519723892212
Epoch: 6, Steps: 208 | Train Loss: 1.156 Vali Loss: 4.855 Vali Acc: 0.108 Test Loss: 4.855 Test Acc: 0.108
Validation loss decreased (-0.106429 --> -0.107616).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1232673
	speed: 1.4402s/iter; left time: 28017.1132s
	iters: 200, epoch: 7 | loss: 1.1183592
	speed: 0.6220s/iter; left time: 12037.7772s
Epoch: 7 cost time: 129.33993291854858
Epoch: 7, Steps: 208 | Train Loss: 0.857 Vali Loss: 5.495 Vali Acc: 0.101 Test Loss: 5.495 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2668274
	speed: 1.4832s/iter; left time: 28544.0360s
	iters: 200, epoch: 8 | loss: 1.1744003
	speed: 0.6314s/iter; left time: 12087.5526s
Epoch: 8 cost time: 126.46355485916138
Epoch: 8, Steps: 208 | Train Loss: 0.661 Vali Loss: 5.980 Vali Acc: 0.100 Test Loss: 5.980 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0448972
	speed: 1.5826s/iter; left time: 30128.0327s
	iters: 200, epoch: 9 | loss: 1.2260519
	speed: 0.7014s/iter; left time: 13283.0303s
Epoch: 9 cost time: 143.1721067428589
Epoch: 9, Steps: 208 | Train Loss: 0.524 Vali Loss: 6.323 Vali Acc: 0.097 Test Loss: 6.323 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5980642
	speed: 1.7725s/iter; left time: 33374.6567s
	iters: 200, epoch: 10 | loss: 0.3145100
	speed: 0.6634s/iter; left time: 12425.6184s
Epoch: 10 cost time: 143.44929385185242
Epoch: 10, Steps: 208 | Train Loss: 0.439 Vali Loss: 6.790 Vali Acc: 0.096 Test Loss: 6.790 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2974595
	speed: 1.6046s/iter; left time: 29878.8603s
	iters: 200, epoch: 11 | loss: 0.8975222
	speed: 0.6836s/iter; left time: 12660.3553s
Epoch: 11 cost time: 137.74785447120667
Epoch: 11, Steps: 208 | Train Loss: 0.387 Vali Loss: 7.337 Vali Acc: 0.096 Test Loss: 7.337 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1076272
	speed: 1.5769s/iter; left time: 29036.2052s
	iters: 200, epoch: 12 | loss: 0.9244289
	speed: 0.6226s/iter; left time: 11402.3036s
Epoch: 12 cost time: 129.63530850410461
Epoch: 12, Steps: 208 | Train Loss: 0.333 Vali Loss: 7.699 Vali Acc: 0.100 Test Loss: 7.699 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1483679
	speed: 1.5817s/iter; left time: 28794.1455s
	iters: 200, epoch: 13 | loss: 0.6278058
	speed: 0.6296s/iter; left time: 11398.5619s
Epoch: 13 cost time: 131.2429780960083
Epoch: 13, Steps: 208 | Train Loss: 0.298 Vali Loss: 8.048 Vali Acc: 0.098 Test Loss: 8.048 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3442003
	speed: 1.5262s/iter; left time: 27466.8096s
	iters: 200, epoch: 14 | loss: 0.1101032
	speed: 0.6149s/iter; left time: 11004.7959s
Epoch: 14 cost time: 126.56299924850464
Epoch: 14, Steps: 208 | Train Loss: 0.261 Vali Loss: 8.254 Vali Acc: 0.094 Test Loss: 8.254 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0137525
	speed: 1.5841s/iter; left time: 28179.9328s
	iters: 200, epoch: 15 | loss: 0.5070690
	speed: 0.6513s/iter; left time: 11521.5873s
Epoch: 15 cost time: 137.77897453308105
Epoch: 15, Steps: 208 | Train Loss: 0.231 Vali Loss: 8.885 Vali Acc: 0.098 Test Loss: 8.885 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1508499
	speed: 1.5585s/iter; left time: 27399.7623s
	iters: 200, epoch: 16 | loss: 0.0782251
	speed: 0.6450s/iter; left time: 11274.4631s
Epoch: 16 cost time: 131.45703673362732
Epoch: 16, Steps: 208 | Train Loss: 0.212 Vali Loss: 8.839 Vali Acc: 0.098 Test Loss: 8.839 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1076647778109156
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6301470
	speed: 0.6698s/iter; left time: 13865.0210s
	iters: 200, epoch: 1 | loss: 3.6998580
	speed: 0.6268s/iter; left time: 12912.8323s
Epoch: 1 cost time: 135.19203996658325
Epoch: 1, Steps: 208 | Train Loss: 3.634 Vali Loss: 3.470 Vali Acc: 0.067 Test Loss: 3.470 Test Acc: 0.067
Validation loss decreased (inf --> -0.066473).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7720587
	speed: 1.5290s/iter; left time: 31333.6864s
	iters: 200, epoch: 2 | loss: 2.9241829
	speed: 0.6111s/iter; left time: 12461.8024s
Epoch: 2 cost time: 128.01275420188904
Epoch: 2, Steps: 208 | Train Loss: 3.140 Vali Loss: 3.572 Vali Acc: 0.073 Test Loss: 3.572 Test Acc: 0.073
Validation loss decreased (-0.066473 --> -0.073331).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4477160
	speed: 1.5194s/iter; left time: 30820.2564s
	iters: 200, epoch: 3 | loss: 2.5038030
	speed: 0.5692s/iter; left time: 11490.0507s
Epoch: 3 cost time: 123.93506717681885
Epoch: 3, Steps: 208 | Train Loss: 2.619 Vali Loss: 3.757 Vali Acc: 0.089 Test Loss: 3.757 Test Acc: 0.089
Validation loss decreased (-0.073331 --> -0.089435).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1138074
	speed: 1.5476s/iter; left time: 31070.4218s
	iters: 200, epoch: 4 | loss: 1.8240333
	speed: 0.6442s/iter; left time: 12869.4134s
Epoch: 4 cost time: 131.55382895469666
Epoch: 4, Steps: 208 | Train Loss: 2.128 Vali Loss: 4.068 Vali Acc: 0.085 Test Loss: 4.068 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6896634
	speed: 1.5467s/iter; left time: 30730.9767s
	iters: 200, epoch: 5 | loss: 1.7149389
	speed: 0.6003s/iter; left time: 11867.7930s
Epoch: 5 cost time: 127.06892275810242
Epoch: 5, Steps: 208 | Train Loss: 1.644 Vali Loss: 4.300 Vali Acc: 0.103 Test Loss: 4.300 Test Acc: 0.103
Validation loss decreased (-0.089435 --> -0.102850).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9577265
	speed: 1.5338s/iter; left time: 30156.8416s
	iters: 200, epoch: 6 | loss: 1.6953024
	speed: 0.6131s/iter; left time: 11992.1077s
Epoch: 6 cost time: 125.39555382728577
Epoch: 6, Steps: 208 | Train Loss: 1.251 Vali Loss: 4.912 Vali Acc: 0.092 Test Loss: 4.912 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9259587
	speed: 1.4889s/iter; left time: 28962.7263s
	iters: 200, epoch: 7 | loss: 1.3446311
	speed: 0.5744s/iter; left time: 11115.6957s
Epoch: 7 cost time: 119.6583206653595
Epoch: 7, Steps: 208 | Train Loss: 0.932 Vali Loss: 5.331 Vali Acc: 0.099 Test Loss: 5.331 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6102032
	speed: 1.5504s/iter; left time: 29836.5213s
	iters: 200, epoch: 8 | loss: 0.6813430
	speed: 0.6376s/iter; left time: 12207.2309s
Epoch: 8 cost time: 131.45050859451294
Epoch: 8, Steps: 208 | Train Loss: 0.718 Vali Loss: 5.780 Vali Acc: 0.098 Test Loss: 5.780 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2953640
	speed: 1.6172s/iter; left time: 30787.4375s
	iters: 200, epoch: 9 | loss: 1.5806485
	speed: 0.6681s/iter; left time: 12651.3653s
Epoch: 9 cost time: 140.21279287338257
Epoch: 9, Steps: 208 | Train Loss: 0.564 Vali Loss: 6.413 Vali Acc: 0.099 Test Loss: 6.413 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5987288
	speed: 1.5754s/iter; left time: 29663.9105s
	iters: 200, epoch: 10 | loss: 0.6656787
	speed: 0.5081s/iter; left time: 9516.4553s
Epoch: 10 cost time: 113.68289279937744
Epoch: 10, Steps: 208 | Train Loss: 0.476 Vali Loss: 6.457 Vali Acc: 0.104 Test Loss: 6.457 Test Acc: 0.104
Validation loss decreased (-0.102850 --> -0.104021).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2563060
	speed: 1.6469s/iter; left time: 30666.5749s
	iters: 200, epoch: 11 | loss: 0.6578686
	speed: 0.6681s/iter; left time: 12373.7780s
Epoch: 11 cost time: 137.38707780838013
Epoch: 11, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.199 Vali Acc: 0.103 Test Loss: 7.199 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3097100
	speed: 1.7301s/iter; left time: 31855.7571s
	iters: 200, epoch: 12 | loss: 0.4109161
	speed: 0.6729s/iter; left time: 12322.5984s
Epoch: 12 cost time: 141.57564067840576
Epoch: 12, Steps: 208 | Train Loss: 0.347 Vali Loss: 7.420 Vali Acc: 0.091 Test Loss: 7.420 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3776385
	speed: 1.4900s/iter; left time: 27126.0172s
	iters: 200, epoch: 13 | loss: 0.6538996
	speed: 0.6533s/iter; left time: 11827.5352s
Epoch: 13 cost time: 128.38665509223938
Epoch: 13, Steps: 208 | Train Loss: 0.351 Vali Loss: 7.721 Vali Acc: 0.095 Test Loss: 7.721 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0813635
	speed: 1.5386s/iter; left time: 27689.4505s
	iters: 200, epoch: 14 | loss: 0.1519409
	speed: 0.6836s/iter; left time: 12233.9502s
Epoch: 14 cost time: 135.89396238327026
Epoch: 14, Steps: 208 | Train Loss: 0.298 Vali Loss: 8.115 Vali Acc: 0.100 Test Loss: 8.115 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0873472
	speed: 1.7331s/iter; left time: 30829.4505s
	iters: 200, epoch: 15 | loss: 0.0526702
	speed: 0.7158s/iter; left time: 12662.6546s
Epoch: 15 cost time: 148.20508861541748
Epoch: 15, Steps: 208 | Train Loss: 0.273 Vali Loss: 8.320 Vali Acc: 0.096 Test Loss: 8.320 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0985242
	speed: 1.8565s/iter; left time: 32639.5922s
	iters: 200, epoch: 16 | loss: 0.4051254
	speed: 0.7740s/iter; left time: 13530.0051s
Epoch: 16 cost time: 154.73953318595886
Epoch: 16, Steps: 208 | Train Loss: 0.228 Vali Loss: 8.516 Vali Acc: 0.106 Test Loss: 8.516 Test Acc: 0.106
Validation loss decreased (-0.104021 --> -0.105790).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0186660
	speed: 1.7741s/iter; left time: 30821.7492s
	iters: 200, epoch: 17 | loss: 0.3238043
	speed: 0.6966s/iter; left time: 12031.6144s
Epoch: 17 cost time: 150.34160447120667
Epoch: 17, Steps: 208 | Train Loss: 0.223 Vali Loss: 8.858 Vali Acc: 0.097 Test Loss: 8.858 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0095693
	speed: 1.7636s/iter; left time: 30272.0191s
	iters: 200, epoch: 18 | loss: 0.3638353
	speed: 0.6808s/iter; left time: 11617.3584s
Epoch: 18 cost time: 143.3598551750183
Epoch: 18, Steps: 208 | Train Loss: 0.213 Vali Loss: 9.308 Vali Acc: 0.098 Test Loss: 9.308 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1783155
	speed: 1.7893s/iter; left time: 30341.2504s
	iters: 200, epoch: 19 | loss: 0.0294630
	speed: 0.7254s/iter; left time: 12228.6759s
Epoch: 19 cost time: 148.93659901618958
Epoch: 19, Steps: 208 | Train Loss: 0.188 Vali Loss: 8.916 Vali Acc: 0.100 Test Loss: 8.916 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0709686
	speed: 1.8380s/iter; left time: 30784.2685s
	iters: 200, epoch: 20 | loss: 0.0594715
	speed: 0.7662s/iter; left time: 12756.6066s
Epoch: 20 cost time: 161.98397731781006
Epoch: 20, Steps: 208 | Train Loss: 0.191 Vali Loss: 9.788 Vali Acc: 0.089 Test Loss: 9.788 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0218277
	speed: 1.7456s/iter; left time: 28874.7438s
	iters: 200, epoch: 21 | loss: 0.1508958
	speed: 0.6925s/iter; left time: 11385.1097s
Epoch: 21 cost time: 142.87258052825928
Epoch: 21, Steps: 208 | Train Loss: 0.187 Vali Loss: 9.668 Vali Acc: 0.097 Test Loss: 9.668 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0567668
	speed: 1.7672s/iter; left time: 28864.0662s
	iters: 200, epoch: 22 | loss: 0.0691949
	speed: 0.6992s/iter; left time: 11350.2940s
Epoch: 22 cost time: 146.200115442276
Epoch: 22, Steps: 208 | Train Loss: 0.161 Vali Loss: 9.672 Vali Acc: 0.101 Test Loss: 9.672 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0033360
	speed: 1.8394s/iter; left time: 29660.7331s
	iters: 200, epoch: 23 | loss: 0.5828480
	speed: 0.6838s/iter; left time: 10957.2687s
Epoch: 23 cost time: 153.62516164779663
Epoch: 23, Steps: 208 | Train Loss: 0.143 Vali Loss: 10.129 Vali Acc: 0.096 Test Loss: 10.129 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.3116040
	speed: 1.6948s/iter; left time: 26976.8680s
	iters: 200, epoch: 24 | loss: 0.6848885
	speed: 0.6689s/iter; left time: 10579.5882s
Epoch: 24 cost time: 141.41526222229004
Epoch: 24, Steps: 208 | Train Loss: 0.153 Vali Loss: 10.343 Vali Acc: 0.092 Test Loss: 10.343 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0085869
	speed: 1.7398s/iter; left time: 27330.0366s
	iters: 200, epoch: 25 | loss: 0.0068314
	speed: 0.7691s/iter; left time: 12005.1045s
Epoch: 25 cost time: 152.91405510902405
Epoch: 25, Steps: 208 | Train Loss: 0.149 Vali Loss: 10.235 Vali Acc: 0.092 Test Loss: 10.235 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0370159
	speed: 1.7818s/iter; left time: 27620.3751s
	iters: 200, epoch: 26 | loss: 0.2833278
	speed: 0.7116s/iter; left time: 10959.8483s
Epoch: 26 cost time: 149.71370673179626
Epoch: 26, Steps: 208 | Train Loss: 0.130 Vali Loss: 10.721 Vali Acc: 0.095 Test Loss: 10.721 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10587533552042946
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6482167
	speed: 0.8003s/iter; left time: 16566.7375s
	iters: 200, epoch: 1 | loss: 3.5164366
	speed: 0.7061s/iter; left time: 14546.9007s
Epoch: 1 cost time: 157.9405062198639
Epoch: 1, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.506 Vali Acc: 0.063 Test Loss: 3.506 Test Acc: 0.063
Validation loss decreased (inf --> -0.062894).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7664053
	speed: 1.8174s/iter; left time: 37244.9626s
	iters: 200, epoch: 2 | loss: 2.7999208
	speed: 0.7585s/iter; left time: 15467.8660s
Epoch: 2 cost time: 155.69477438926697
Epoch: 2, Steps: 208 | Train Loss: 3.089 Vali Loss: 3.683 Vali Acc: 0.075 Test Loss: 3.683 Test Acc: 0.075
Validation loss decreased (-0.062894 --> -0.075120).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3690481
	speed: 1.8438s/iter; left time: 37401.5339s
	iters: 200, epoch: 3 | loss: 2.4899142
	speed: 0.7438s/iter; left time: 15014.4836s
Epoch: 3 cost time: 159.21183395385742
Epoch: 3, Steps: 208 | Train Loss: 2.662 Vali Loss: 3.796 Vali Acc: 0.089 Test Loss: 3.796 Test Acc: 0.089
Validation loss decreased (-0.075120 --> -0.089434).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9524605
	speed: 1.6382s/iter; left time: 32890.4617s
	iters: 200, epoch: 4 | loss: 1.9615400
	speed: 0.7027s/iter; left time: 14037.4907s
Epoch: 4 cost time: 142.34115147590637
Epoch: 4, Steps: 208 | Train Loss: 2.252 Vali Loss: 3.997 Vali Acc: 0.087 Test Loss: 3.997 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8480577
	speed: 1.6486s/iter; left time: 32755.3359s
	iters: 200, epoch: 5 | loss: 1.8847282
	speed: 0.7386s/iter; left time: 14601.1942s
Epoch: 5 cost time: 143.85935258865356
Epoch: 5, Steps: 208 | Train Loss: 1.871 Vali Loss: 4.333 Vali Acc: 0.097 Test Loss: 4.333 Test Acc: 0.097
Validation loss decreased (-0.089434 --> -0.096587).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8217410
	speed: 1.7242s/iter; left time: 33900.0387s
	iters: 200, epoch: 6 | loss: 2.0801451
	speed: 0.6162s/iter; left time: 12053.6317s
Epoch: 6 cost time: 134.11120796203613
Epoch: 6, Steps: 208 | Train Loss: 1.457 Vali Loss: 4.708 Vali Acc: 0.095 Test Loss: 4.708 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0202938
	speed: 1.8099s/iter; left time: 35207.5364s
	iters: 200, epoch: 7 | loss: 1.4680074
	speed: 0.7525s/iter; left time: 14563.8196s
Epoch: 7 cost time: 163.00512099266052
Epoch: 7, Steps: 208 | Train Loss: 1.145 Vali Loss: 5.171 Vali Acc: 0.092 Test Loss: 5.171 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7884620
	speed: 1.8218s/iter; left time: 35059.7620s
	iters: 200, epoch: 8 | loss: 0.9459789
	speed: 0.6345s/iter; left time: 12147.5456s
Epoch: 8 cost time: 139.976989030838
Epoch: 8, Steps: 208 | Train Loss: 0.912 Vali Loss: 5.420 Vali Acc: 0.093 Test Loss: 5.420 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3869109
	speed: 1.8638s/iter; left time: 35481.5941s
	iters: 200, epoch: 9 | loss: 1.4891703
	speed: 0.6935s/iter; left time: 13133.3110s
Epoch: 9 cost time: 155.6126058101654
Epoch: 9, Steps: 208 | Train Loss: 0.746 Vali Loss: 6.112 Vali Acc: 0.093 Test Loss: 6.112 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9277838
	speed: 1.9313s/iter; left time: 36364.9593s
	iters: 200, epoch: 10 | loss: 0.6548606
	speed: 0.6936s/iter; left time: 12990.4899s
Epoch: 10 cost time: 151.91341519355774
Epoch: 10, Steps: 208 | Train Loss: 0.604 Vali Loss: 6.379 Vali Acc: 0.090 Test Loss: 6.379 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3687070
	speed: 1.8404s/iter; left time: 34270.0309s
	iters: 200, epoch: 11 | loss: 0.3749946
	speed: 0.7314s/iter; left time: 13546.8589s
Epoch: 11 cost time: 155.80446243286133
Epoch: 11, Steps: 208 | Train Loss: 0.556 Vali Loss: 6.832 Vali Acc: 0.097 Test Loss: 6.832 Test Acc: 0.097
Validation loss decreased (-0.096587 --> -0.097158).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6229837
	speed: 1.8737s/iter; left time: 34501.3459s
	iters: 200, epoch: 12 | loss: 0.5137841
	speed: 0.7088s/iter; left time: 12980.8054s
Epoch: 12 cost time: 155.72222471237183
Epoch: 12, Steps: 208 | Train Loss: 0.505 Vali Loss: 7.026 Vali Acc: 0.111 Test Loss: 7.026 Test Acc: 0.111
Validation loss decreased (-0.097158 --> -0.110577).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2086112
	speed: 1.8870s/iter; left time: 34353.6324s
	iters: 200, epoch: 13 | loss: 0.6662842
	speed: 0.7620s/iter; left time: 13795.1394s
Epoch: 13 cost time: 158.72491979599
Epoch: 13, Steps: 208 | Train Loss: 0.427 Vali Loss: 7.422 Vali Acc: 0.098 Test Loss: 7.422 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8991092
	speed: 1.9266s/iter; left time: 34672.9446s
	iters: 200, epoch: 14 | loss: 0.2341716
	speed: 0.6842s/iter; left time: 12245.6432s
Epoch: 14 cost time: 151.77132487297058
Epoch: 14, Steps: 208 | Train Loss: 0.398 Vali Loss: 7.747 Vali Acc: 0.104 Test Loss: 7.747 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2054163
	speed: 1.7965s/iter; left time: 31958.7333s
	iters: 200, epoch: 15 | loss: 0.4118091
	speed: 0.7263s/iter; left time: 12846.6629s
Epoch: 15 cost time: 154.9922652244568
Epoch: 15, Steps: 208 | Train Loss: 0.370 Vali Loss: 7.777 Vali Acc: 0.105 Test Loss: 7.777 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3315332
	speed: 1.8163s/iter; left time: 31932.8588s
	iters: 200, epoch: 16 | loss: 0.3961061
	speed: 0.7472s/iter; left time: 13062.5289s
Epoch: 16 cost time: 152.6734335422516
Epoch: 16, Steps: 208 | Train Loss: 0.348 Vali Loss: 8.178 Vali Acc: 0.104 Test Loss: 8.178 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2512003
	speed: 1.9314s/iter; left time: 33554.9415s
	iters: 200, epoch: 17 | loss: 0.5979322
	speed: 0.7124s/iter; left time: 12306.0855s
Epoch: 17 cost time: 157.89509797096252
Epoch: 17, Steps: 208 | Train Loss: 0.297 Vali Loss: 8.523 Vali Acc: 0.103 Test Loss: 8.523 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0977998
	speed: 1.6960s/iter; left time: 29111.3440s
	iters: 200, epoch: 18 | loss: 0.0375642
	speed: 0.6901s/iter; left time: 11776.7450s
Epoch: 18 cost time: 141.6370711326599
Epoch: 18, Steps: 208 | Train Loss: 0.274 Vali Loss: 8.830 Vali Acc: 0.100 Test Loss: 8.830 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4114525
	speed: 1.7359s/iter; left time: 29436.2725s
	iters: 200, epoch: 19 | loss: 0.3617649
	speed: 0.6657s/iter; left time: 11221.2587s
Epoch: 19 cost time: 149.51501369476318
Epoch: 19, Steps: 208 | Train Loss: 0.266 Vali Loss: 8.835 Vali Acc: 0.105 Test Loss: 8.835 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.3344673
	speed: 1.7660s/iter; left time: 29578.8512s
	iters: 200, epoch: 20 | loss: 0.0628968
	speed: 0.6989s/iter; left time: 11636.3434s
Epoch: 20 cost time: 148.5377860069275
Epoch: 20, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.087 Vali Acc: 0.103 Test Loss: 9.087 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1882991
	speed: 1.7895s/iter; left time: 29600.5741s
	iters: 200, epoch: 21 | loss: 0.2054344
	speed: 0.7521s/iter; left time: 12365.8013s
Epoch: 21 cost time: 153.49339723587036
Epoch: 21, Steps: 208 | Train Loss: 0.211 Vali Loss: 9.503 Vali Acc: 0.104 Test Loss: 9.503 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2117509
	speed: 1.9076s/iter; left time: 31156.3664s
	iters: 200, epoch: 22 | loss: 0.2147386
	speed: 0.7085s/iter; left time: 11500.6984s
Epoch: 22 cost time: 150.3136191368103
Epoch: 22, Steps: 208 | Train Loss: 0.233 Vali Loss: 9.816 Vali Acc: 0.095 Test Loss: 9.816 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11064718162839249
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5869787
	speed: 0.7065s/iter; left time: 14624.5966s
	iters: 200, epoch: 1 | loss: 3.4200816
	speed: 0.6478s/iter; left time: 13345.3025s
Epoch: 1 cost time: 141.91756081581116
Epoch: 1, Steps: 208 | Train Loss: 3.630 Vali Loss: 3.581 Vali Acc: 0.058 Test Loss: 3.581 Test Acc: 0.058
Validation loss decreased (inf --> -0.058121).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9578319
	speed: 1.5615s/iter; left time: 31999.2636s
	iters: 200, epoch: 2 | loss: 2.8369327
	speed: 0.5681s/iter; left time: 11585.9084s
Epoch: 2 cost time: 125.13691592216492
Epoch: 2, Steps: 208 | Train Loss: 3.205 Vali Loss: 3.747 Vali Acc: 0.063 Test Loss: 3.747 Test Acc: 0.063
Validation loss decreased (-0.058121 --> -0.062891).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7063119
	speed: 1.5473s/iter; left time: 31387.0869s
	iters: 200, epoch: 3 | loss: 2.5402951
	speed: 0.5909s/iter; left time: 11926.5267s
Epoch: 3 cost time: 127.3948426246643
Epoch: 3, Steps: 208 | Train Loss: 2.828 Vali Loss: 3.912 Vali Acc: 0.080 Test Loss: 3.912 Test Acc: 0.080
Validation loss decreased (-0.062891 --> -0.079889).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1153858
	speed: 1.6346s/iter; left time: 32818.3609s
	iters: 200, epoch: 4 | loss: 2.4717302
	speed: 0.6076s/iter; left time: 12137.8359s
Epoch: 4 cost time: 133.08241748809814
Epoch: 4, Steps: 208 | Train Loss: 2.516 Vali Loss: 3.906 Vali Acc: 0.085 Test Loss: 3.906 Test Acc: 0.085
Validation loss decreased (-0.079889 --> -0.084959).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1186159
	speed: 1.5387s/iter; left time: 30573.3751s
	iters: 200, epoch: 5 | loss: 2.2993627
	speed: 0.6342s/iter; left time: 12537.2791s
Epoch: 5 cost time: 132.38420057296753
Epoch: 5, Steps: 208 | Train Loss: 2.182 Vali Loss: 4.311 Vali Acc: 0.096 Test Loss: 4.311 Test Acc: 0.096
Validation loss decreased (-0.084959 --> -0.095990).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4403938
	speed: 1.6049s/iter; left time: 31554.6940s
	iters: 200, epoch: 6 | loss: 2.7924168
	speed: 0.6224s/iter; left time: 12173.9432s
Epoch: 6 cost time: 133.4470453262329
Epoch: 6, Steps: 208 | Train Loss: 1.863 Vali Loss: 4.559 Vali Acc: 0.086 Test Loss: 4.559 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5830957
	speed: 1.7304s/iter; left time: 33661.9692s
	iters: 200, epoch: 7 | loss: 1.6223232
	speed: 0.7134s/iter; left time: 13805.9821s
Epoch: 7 cost time: 145.96427965164185
Epoch: 7, Steps: 208 | Train Loss: 1.509 Vali Loss: 4.773 Vali Acc: 0.091 Test Loss: 4.773 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4525028
	speed: 1.6642s/iter; left time: 32026.7603s
	iters: 200, epoch: 8 | loss: 1.6293191
	speed: 0.5681s/iter; left time: 10876.4889s
Epoch: 8 cost time: 127.33339023590088
Epoch: 8, Steps: 208 | Train Loss: 1.231 Vali Loss: 5.177 Vali Acc: 0.084 Test Loss: 5.177 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3960723
	speed: 1.6339s/iter; left time: 31105.4454s
	iters: 200, epoch: 9 | loss: 1.7442923
	speed: 0.6544s/iter; left time: 12391.5128s
Epoch: 9 cost time: 142.1958270072937
Epoch: 9, Steps: 208 | Train Loss: 1.026 Vali Loss: 5.786 Vali Acc: 0.084 Test Loss: 5.786 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2894542
	speed: 1.6736s/iter; left time: 31512.8225s
	iters: 200, epoch: 10 | loss: 1.0013547
	speed: 0.5975s/iter; left time: 11191.2079s
Epoch: 10 cost time: 134.04409956932068
Epoch: 10, Steps: 208 | Train Loss: 0.832 Vali Loss: 5.996 Vali Acc: 0.090 Test Loss: 5.996 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6593540
	speed: 1.5426s/iter; left time: 28724.2747s
	iters: 200, epoch: 11 | loss: 1.0882773
	speed: 0.5977s/iter; left time: 11070.6795s
Epoch: 11 cost time: 130.48307347297668
Epoch: 11, Steps: 208 | Train Loss: 0.733 Vali Loss: 6.455 Vali Acc: 0.097 Test Loss: 6.455 Test Acc: 0.097
Validation loss decreased (-0.095990 --> -0.096864).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5798935
	speed: 1.6054s/iter; left time: 29561.0744s
	iters: 200, epoch: 12 | loss: 0.7709615
	speed: 0.6244s/iter; left time: 11433.7418s
Epoch: 12 cost time: 133.0850329399109
Epoch: 12, Steps: 208 | Train Loss: 0.640 Vali Loss: 6.611 Vali Acc: 0.100 Test Loss: 6.611 Test Acc: 0.100
Validation loss decreased (-0.096864 --> -0.099546).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4421117
	speed: 1.6068s/iter; left time: 29252.2118s
	iters: 200, epoch: 13 | loss: 0.6982685
	speed: 0.7574s/iter; left time: 13713.0967s
Epoch: 13 cost time: 151.41099071502686
Epoch: 13, Steps: 208 | Train Loss: 0.563 Vali Loss: 7.009 Vali Acc: 0.094 Test Loss: 7.009 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3285084
	speed: 1.6675s/iter; left time: 30010.7897s
	iters: 200, epoch: 14 | loss: 0.3656796
	speed: 0.5921s/iter; left time: 10597.2680s
Epoch: 14 cost time: 129.54813146591187
Epoch: 14, Steps: 208 | Train Loss: 0.514 Vali Loss: 7.223 Vali Acc: 0.096 Test Loss: 7.223 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6425654
	speed: 1.6311s/iter; left time: 29016.2910s
	iters: 200, epoch: 15 | loss: 0.5544563
	speed: 0.6861s/iter; left time: 12137.1169s
Epoch: 15 cost time: 145.14214038848877
Epoch: 15, Steps: 208 | Train Loss: 0.472 Vali Loss: 7.524 Vali Acc: 0.091 Test Loss: 7.524 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2294786
	speed: 1.6483s/iter; left time: 28979.5654s
	iters: 200, epoch: 16 | loss: 0.3105354
	speed: 0.6324s/iter; left time: 11055.1007s
Epoch: 16 cost time: 133.9424147605896
Epoch: 16, Steps: 208 | Train Loss: 0.443 Vali Loss: 7.883 Vali Acc: 0.093 Test Loss: 7.883 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2208577
	speed: 1.5083s/iter; left time: 26204.1226s
	iters: 200, epoch: 17 | loss: 0.5100086
	speed: 0.6215s/iter; left time: 10734.4693s
Epoch: 17 cost time: 131.3930492401123
Epoch: 17, Steps: 208 | Train Loss: 0.355 Vali Loss: 7.939 Vali Acc: 0.101 Test Loss: 7.939 Test Acc: 0.101
Validation loss decreased (-0.099546 --> -0.101024).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1022299
	speed: 1.5338s/iter; left time: 26327.7393s
	iters: 200, epoch: 18 | loss: 0.1799926
	speed: 0.6312s/iter; left time: 10771.5181s
Epoch: 18 cost time: 130.72773218154907
Epoch: 18, Steps: 208 | Train Loss: 0.351 Vali Loss: 8.294 Vali Acc: 0.097 Test Loss: 8.294 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1661669
	speed: 1.5962s/iter; left time: 27067.0298s
	iters: 200, epoch: 19 | loss: 0.3845373
	speed: 0.6194s/iter; left time: 10441.6337s
Epoch: 19 cost time: 130.0546953678131
Epoch: 19, Steps: 208 | Train Loss: 0.315 Vali Loss: 8.415 Vali Acc: 0.103 Test Loss: 8.415 Test Acc: 0.103
Validation loss decreased (-0.101024 --> -0.103107).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1363555
	speed: 1.4598s/iter; left time: 24450.4725s
	iters: 200, epoch: 20 | loss: 0.1802524
	speed: 0.5702s/iter; left time: 9493.7351s
Epoch: 20 cost time: 118.14605975151062
Epoch: 20, Steps: 208 | Train Loss: 0.309 Vali Loss: 8.436 Vali Acc: 0.102 Test Loss: 8.436 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3106451
	speed: 1.4191s/iter; left time: 23472.9941s
	iters: 200, epoch: 21 | loss: 0.3552822
	speed: 0.6543s/iter; left time: 10757.2399s
Epoch: 21 cost time: 126.85067057609558
Epoch: 21, Steps: 208 | Train Loss: 0.290 Vali Loss: 8.608 Vali Acc: 0.102 Test Loss: 8.608 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1278314
	speed: 1.5042s/iter; left time: 24567.9688s
	iters: 200, epoch: 22 | loss: 0.1373338
	speed: 0.5761s/iter; left time: 9352.3703s
Epoch: 22 cost time: 123.27282357215881
Epoch: 22, Steps: 208 | Train Loss: 0.249 Vali Loss: 8.924 Vali Acc: 0.100 Test Loss: 8.924 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.2720224
	speed: 1.5270s/iter; left time: 24622.2106s
	iters: 200, epoch: 23 | loss: 0.3059694
	speed: 0.6676s/iter; left time: 10699.0519s
Epoch: 23 cost time: 136.29953122138977
Epoch: 23, Steps: 208 | Train Loss: 0.241 Vali Loss: 9.398 Vali Acc: 0.101 Test Loss: 9.398 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2391870
	speed: 1.4327s/iter; left time: 22804.1338s
	iters: 200, epoch: 24 | loss: 0.4308516
	speed: 0.6230s/iter; left time: 9854.3474s
Epoch: 24 cost time: 125.30764389038086
Epoch: 24, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.158 Vali Acc: 0.095 Test Loss: 9.158 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0070140
	speed: 1.5546s/iter; left time: 24421.2843s
	iters: 200, epoch: 25 | loss: 0.0844715
	speed: 0.6074s/iter; left time: 9480.7810s
Epoch: 25 cost time: 128.7455117702484
Epoch: 25, Steps: 208 | Train Loss: 0.223 Vali Loss: 9.793 Vali Acc: 0.097 Test Loss: 9.793 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2436205
	speed: 1.3706s/iter; left time: 21246.2656s
	iters: 200, epoch: 26 | loss: 0.2480001
	speed: 0.6386s/iter; left time: 9835.4758s
Epoch: 26 cost time: 128.3082525730133
Epoch: 26, Steps: 208 | Train Loss: 0.212 Vali Loss: 9.987 Vali Acc: 0.100 Test Loss: 9.987 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0620489
	speed: 1.5336s/iter; left time: 23452.8954s
	iters: 200, epoch: 27 | loss: 0.2832605
	speed: 0.5831s/iter; left time: 8859.4132s
Epoch: 27 cost time: 123.2226231098175
Epoch: 27, Steps: 208 | Train Loss: 0.190 Vali Loss: 9.932 Vali Acc: 0.098 Test Loss: 9.932 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2368729
	speed: 1.4547s/iter; left time: 21943.8440s
	iters: 200, epoch: 28 | loss: 0.2090266
	speed: 0.5932s/iter; left time: 8888.9182s
Epoch: 28 cost time: 121.97862124443054
Epoch: 28, Steps: 208 | Train Loss: 0.181 Vali Loss: 10.438 Vali Acc: 0.098 Test Loss: 10.438 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.2516211
	speed: 1.5112s/iter; left time: 22482.6013s
	iters: 200, epoch: 29 | loss: 0.1289991
	speed: 0.6083s/iter; left time: 8988.7942s
Epoch: 29 cost time: 121.52383589744568
Epoch: 29, Steps: 208 | Train Loss: 0.193 Vali Loss: 10.199 Vali Acc: 0.095 Test Loss: 10.199 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10319117208470027
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6642573
	speed: 0.7253s/iter; left time: 15015.1319s
	iters: 200, epoch: 1 | loss: 3.6034236
	speed: 0.6727s/iter; left time: 13858.0888s
Epoch: 1 cost time: 145.4214153289795
Epoch: 1, Steps: 208 | Train Loss: 3.667 Vali Loss: 3.690 Vali Acc: 0.045 Test Loss: 3.690 Test Acc: 0.045
Validation loss decreased (inf --> -0.044699).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9396038
	speed: 1.6939s/iter; left time: 34713.7470s
	iters: 200, epoch: 2 | loss: 3.2569396
	speed: 0.7227s/iter; left time: 14737.4997s
Epoch: 2 cost time: 148.05551743507385
Epoch: 2, Steps: 208 | Train Loss: 3.265 Vali Loss: 4.082 Vali Acc: 0.048 Test Loss: 4.082 Test Acc: 0.048
Validation loss decreased (-0.044699 --> -0.047678).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6310806
	speed: 1.7268s/iter; left time: 35027.7971s
	iters: 200, epoch: 3 | loss: 2.3924940
	speed: 0.7244s/iter; left time: 14622.4168s
Epoch: 3 cost time: 148.89131832122803
Epoch: 3, Steps: 208 | Train Loss: 2.986 Vali Loss: 4.326 Vali Acc: 0.050 Test Loss: 4.326 Test Acc: 0.050
Validation loss decreased (-0.047678 --> -0.050061).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.6400487
	speed: 1.7547s/iter; left time: 35230.1081s
	iters: 200, epoch: 4 | loss: 2.3593569
	speed: 0.6624s/iter; left time: 13233.1362s
Epoch: 4 cost time: 144.83925008773804
Epoch: 4, Steps: 208 | Train Loss: 2.775 Vali Loss: 4.309 Vali Acc: 0.049 Test Loss: 4.309 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4867413
	speed: 1.9231s/iter; left time: 38210.9813s
	iters: 200, epoch: 5 | loss: 2.5013125
	speed: 0.7236s/iter; left time: 14303.9531s
Epoch: 5 cost time: 156.4976179599762
Epoch: 5, Steps: 208 | Train Loss: 2.528 Vali Loss: 4.784 Vali Acc: 0.051 Test Loss: 4.784 Test Acc: 0.051
Validation loss decreased (-0.050061 --> -0.051250).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8225574
	speed: 1.8189s/iter; left time: 35762.1694s
	iters: 200, epoch: 6 | loss: 3.6435552
	speed: 0.7526s/iter; left time: 14721.9365s
Epoch: 6 cost time: 157.13767743110657
Epoch: 6, Steps: 208 | Train Loss: 2.259 Vali Loss: 4.784 Vali Acc: 0.062 Test Loss: 4.784 Test Acc: 0.062
Validation loss decreased (-0.051250 --> -0.061688).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9206315
	speed: 1.8242s/iter; left time: 35486.7280s
	iters: 200, epoch: 7 | loss: 2.7297244
	speed: 0.7506s/iter; left time: 14525.9545s
Epoch: 7 cost time: 150.04430651664734
Epoch: 7, Steps: 208 | Train Loss: 1.977 Vali Loss: 5.110 Vali Acc: 0.063 Test Loss: 5.110 Test Acc: 0.063
Validation loss decreased (-0.061688 --> -0.062579).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3212165
	speed: 1.7990s/iter; left time: 34622.3019s
	iters: 200, epoch: 8 | loss: 2.6593437
	speed: 0.7198s/iter; left time: 13780.8719s
Epoch: 8 cost time: 146.10707807540894
Epoch: 8, Steps: 208 | Train Loss: 1.730 Vali Loss: 5.292 Vali Acc: 0.061 Test Loss: 5.292 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8008978
	speed: 1.5798s/iter; left time: 30074.0009s
	iters: 200, epoch: 9 | loss: 2.8628983
	speed: 0.7083s/iter; left time: 13413.9865s
Epoch: 9 cost time: 141.81472778320312
Epoch: 9, Steps: 208 | Train Loss: 1.469 Vali Loss: 5.806 Vali Acc: 0.067 Test Loss: 5.806 Test Acc: 0.067
Validation loss decreased (-0.062579 --> -0.066450).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3693362
	speed: 1.7197s/iter; left time: 32381.0823s
	iters: 200, epoch: 10 | loss: 1.4287611
	speed: 0.6942s/iter; left time: 13001.1497s
Epoch: 10 cost time: 139.0047163963318
Epoch: 10, Steps: 208 | Train Loss: 1.236 Vali Loss: 5.914 Vali Acc: 0.067 Test Loss: 5.914 Test Acc: 0.067
Validation loss decreased (-0.066450 --> -0.067045).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2109939
	speed: 1.7008s/iter; left time: 31671.1545s
	iters: 200, epoch: 11 | loss: 0.9821146
	speed: 0.7280s/iter; left time: 13482.9634s
Epoch: 11 cost time: 149.43658995628357
Epoch: 11, Steps: 208 | Train Loss: 1.065 Vali Loss: 6.272 Vali Acc: 0.070 Test Loss: 6.272 Test Acc: 0.070
Validation loss decreased (-0.067045 --> -0.069726).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0562637
	speed: 1.6655s/iter; left time: 30666.9040s
	iters: 200, epoch: 12 | loss: 0.9257883
	speed: 0.6692s/iter; left time: 12254.3747s
Epoch: 12 cost time: 139.38932013511658
Epoch: 12, Steps: 208 | Train Loss: 0.887 Vali Loss: 6.545 Vali Acc: 0.077 Test Loss: 6.545 Test Acc: 0.077
Validation loss decreased (-0.069726 --> -0.076582).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0336635
	speed: 1.7651s/iter; left time: 32133.1588s
	iters: 200, epoch: 13 | loss: 1.0919986
	speed: 0.6898s/iter; left time: 12488.3142s
Epoch: 13 cost time: 145.54508662223816
Epoch: 13, Steps: 208 | Train Loss: 0.738 Vali Loss: 7.068 Vali Acc: 0.068 Test Loss: 7.068 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1797677
	speed: 1.6268s/iter; left time: 29277.9102s
	iters: 200, epoch: 14 | loss: 0.5129849
	speed: 0.7490s/iter; left time: 13404.9484s
Epoch: 14 cost time: 150.76153898239136
Epoch: 14, Steps: 208 | Train Loss: 0.678 Vali Loss: 7.204 Vali Acc: 0.075 Test Loss: 7.204 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4035295
	speed: 1.6683s/iter; left time: 29677.2240s
	iters: 200, epoch: 15 | loss: 0.7009860
	speed: 0.7188s/iter; left time: 12714.1781s
Epoch: 15 cost time: 147.65985679626465
Epoch: 15, Steps: 208 | Train Loss: 0.583 Vali Loss: 7.417 Vali Acc: 0.083 Test Loss: 7.417 Test Acc: 0.083
Validation loss decreased (-0.076582 --> -0.083135).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6409140
	speed: 1.7754s/iter; left time: 31212.7796s
	iters: 200, epoch: 16 | loss: 1.0179137
	speed: 0.7128s/iter; left time: 12459.5954s
Epoch: 16 cost time: 149.63279676437378
Epoch: 16, Steps: 208 | Train Loss: 0.511 Vali Loss: 7.977 Vali Acc: 0.078 Test Loss: 7.977 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1837086
	speed: 1.6629s/iter; left time: 28889.3552s
	iters: 200, epoch: 17 | loss: 0.4170921
	speed: 0.6024s/iter; left time: 10404.5603s
Epoch: 17 cost time: 131.66622591018677
Epoch: 17, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.207 Vali Acc: 0.088 Test Loss: 8.207 Test Acc: 0.088
Validation loss decreased (-0.083135 --> -0.087601).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0868118
	speed: 1.6940s/iter; left time: 29077.3299s
	iters: 200, epoch: 18 | loss: 0.3575924
	speed: 0.6645s/iter; left time: 11338.9330s
Epoch: 18 cost time: 141.43114733695984
Epoch: 18, Steps: 208 | Train Loss: 0.403 Vali Loss: 8.494 Vali Acc: 0.087 Test Loss: 8.494 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3747624
	speed: 1.6213s/iter; left time: 27491.6226s
	iters: 200, epoch: 19 | loss: 0.5442033
	speed: 0.6986s/iter; left time: 11775.5335s
Epoch: 19 cost time: 140.0536720752716
Epoch: 19, Steps: 208 | Train Loss: 0.368 Vali Loss: 8.781 Vali Acc: 0.076 Test Loss: 8.781 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3170463
	speed: 1.6603s/iter; left time: 27808.4978s
	iters: 200, epoch: 20 | loss: 0.2057934
	speed: 0.6310s/iter; left time: 10504.6876s
Epoch: 20 cost time: 135.98488306999207
Epoch: 20, Steps: 208 | Train Loss: 0.355 Vali Loss: 8.625 Vali Acc: 0.082 Test Loss: 8.625 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1365191
	speed: 1.7105s/iter; left time: 28293.4453s
	iters: 200, epoch: 21 | loss: 0.1157233
	speed: 0.6946s/iter; left time: 11419.8551s
Epoch: 21 cost time: 144.45557951927185
Epoch: 21, Steps: 208 | Train Loss: 0.329 Vali Loss: 8.739 Vali Acc: 0.082 Test Loss: 8.739 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2297019
	speed: 1.6679s/iter; left time: 27241.6611s
	iters: 200, epoch: 22 | loss: 0.1619976
	speed: 0.6840s/iter; left time: 11102.9117s
Epoch: 22 cost time: 143.6919755935669
Epoch: 22, Steps: 208 | Train Loss: 0.310 Vali Loss: 9.061 Vali Acc: 0.081 Test Loss: 9.061 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2066956
	speed: 1.6305s/iter; left time: 26291.9967s
	iters: 200, epoch: 23 | loss: 0.7792686
	speed: 0.6438s/iter; left time: 10316.7872s
Epoch: 23 cost time: 132.3941683769226
Epoch: 23, Steps: 208 | Train Loss: 0.294 Vali Loss: 9.147 Vali Acc: 0.089 Test Loss: 9.147 Test Acc: 0.089
Validation loss decreased (-0.087601 --> -0.088784).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1573414
	speed: 1.6278s/iter; left time: 25910.3271s
	iters: 200, epoch: 24 | loss: 0.2565871
	speed: 0.6687s/iter; left time: 10576.4632s
Epoch: 24 cost time: 138.88033080101013
Epoch: 24, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.448 Vali Acc: 0.098 Test Loss: 9.448 Test Acc: 0.098
Validation loss decreased (-0.088784 --> -0.097728).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0628323
	speed: 1.5571s/iter; left time: 24459.8170s
	iters: 200, epoch: 25 | loss: 0.4038747
	speed: 0.6489s/iter; left time: 10129.3825s
Epoch: 25 cost time: 140.8092656135559
Epoch: 25, Steps: 208 | Train Loss: 0.238 Vali Loss: 9.722 Vali Acc: 0.089 Test Loss: 9.722 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1427604
	speed: 1.5598s/iter; left time: 24178.4916s
	iters: 200, epoch: 26 | loss: 0.0237215
	speed: 0.5845s/iter; left time: 9001.1940s
Epoch: 26 cost time: 124.73949718475342
Epoch: 26, Steps: 208 | Train Loss: 0.230 Vali Loss: 10.237 Vali Acc: 0.081 Test Loss: 10.237 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1119397
	speed: 1.6819s/iter; left time: 25721.2717s
	iters: 200, epoch: 27 | loss: 0.6682653
	speed: 0.6318s/iter; left time: 9599.6049s
Epoch: 27 cost time: 136.5093948841095
Epoch: 27, Steps: 208 | Train Loss: 0.231 Vali Loss: 10.022 Vali Acc: 0.083 Test Loss: 10.022 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0857470
	speed: 1.6204s/iter; left time: 24443.0997s
	iters: 200, epoch: 28 | loss: 0.1268357
	speed: 0.6619s/iter; left time: 9917.8507s
Epoch: 28 cost time: 138.99081230163574
Epoch: 28, Steps: 208 | Train Loss: 0.204 Vali Loss: 10.210 Vali Acc: 0.094 Test Loss: 10.210 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0751762
	speed: 1.5871s/iter; left time: 23610.9852s
	iters: 200, epoch: 29 | loss: 0.0630634
	speed: 0.6908s/iter; left time: 10208.1295s
Epoch: 29 cost time: 141.13035202026367
Epoch: 29, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.113 Vali Acc: 0.091 Test Loss: 10.113 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0067326
	speed: 1.7932s/iter; left time: 26304.5204s
	iters: 200, epoch: 30 | loss: 0.0755861
	speed: 0.6832s/iter; left time: 9953.3058s
Epoch: 30 cost time: 149.89412117004395
Epoch: 30, Steps: 208 | Train Loss: 0.211 Vali Loss: 10.607 Vali Acc: 0.089 Test Loss: 10.607 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0080967
	speed: 1.6515s/iter; left time: 23882.5892s
	iters: 200, epoch: 31 | loss: 0.0824076
	speed: 0.6402s/iter; left time: 9194.3259s
Epoch: 31 cost time: 137.37088656425476
Epoch: 31, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.579 Vali Acc: 0.082 Test Loss: 10.579 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0408817
	speed: 1.5945s/iter; left time: 22726.7107s
	iters: 200, epoch: 32 | loss: 0.0902249
	speed: 0.6466s/iter; left time: 9150.8602s
Epoch: 32 cost time: 133.99722242355347
Epoch: 32, Steps: 208 | Train Loss: 0.154 Vali Loss: 10.498 Vali Acc: 0.082 Test Loss: 10.498 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0445236
	speed: 1.6561s/iter; left time: 23259.3149s
	iters: 200, epoch: 33 | loss: 0.7908370
	speed: 0.5846s/iter; left time: 8152.6294s
Epoch: 33 cost time: 130.9822075366974
Epoch: 33, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.762 Vali Acc: 0.094 Test Loss: 10.762 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.2942379
	speed: 1.7140s/iter; left time: 23716.7282s
	iters: 200, epoch: 34 | loss: 0.0024755
	speed: 0.6823s/iter; left time: 9372.8016s
Epoch: 34 cost time: 148.81002283096313
Epoch: 34, Steps: 208 | Train Loss: 0.163 Vali Loss: 10.922 Vali Acc: 0.090 Test Loss: 10.922 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09782284521324187
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6254656
	speed: 0.7664s/iter; left time: 15864.6738s
	iters: 200, epoch: 1 | loss: 3.4398544
	speed: 0.6434s/iter; left time: 13254.5238s
Epoch: 1 cost time: 146.43428945541382
Epoch: 1, Steps: 208 | Train Loss: 3.685 Vali Loss: 4.477 Vali Acc: 0.028 Test Loss: 4.477 Test Acc: 0.028
Validation loss decreased (inf --> -0.027692).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8738770
	speed: 1.5996s/iter; left time: 32780.3637s
	iters: 200, epoch: 2 | loss: 3.2338727
	speed: 0.6751s/iter; left time: 13767.5982s
Epoch: 2 cost time: 140.37573432922363
Epoch: 2, Steps: 208 | Train Loss: 3.342 Vali Loss: 5.025 Vali Acc: 0.031 Test Loss: 5.025 Test Acc: 0.031
Validation loss decreased (-0.027692 --> -0.030967).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7374365
	speed: 1.5446s/iter; left time: 31332.8751s
	iters: 200, epoch: 3 | loss: 2.7201841
	speed: 0.6906s/iter; left time: 13939.3428s
Epoch: 3 cost time: 135.41696429252625
Epoch: 3, Steps: 208 | Train Loss: 3.099 Vali Loss: 5.029 Vali Acc: 0.046 Test Loss: 5.029 Test Acc: 0.046
Validation loss decreased (-0.030967 --> -0.046177).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7920022
	speed: 1.5701s/iter; left time: 31521.9329s
	iters: 200, epoch: 4 | loss: 2.9371867
	speed: 0.6703s/iter; left time: 13390.3101s
Epoch: 4 cost time: 137.79289317131042
Epoch: 4, Steps: 208 | Train Loss: 2.962 Vali Loss: 4.914 Vali Acc: 0.043 Test Loss: 4.914 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.5291324
	speed: 1.6473s/iter; left time: 32730.8289s
	iters: 200, epoch: 5 | loss: 2.8872848
	speed: 0.6834s/iter; left time: 13509.8972s
Epoch: 5 cost time: 143.47647547721863
Epoch: 5, Steps: 208 | Train Loss: 2.843 Vali Loss: 5.212 Vali Acc: 0.054 Test Loss: 5.212 Test Acc: 0.054
Validation loss decreased (-0.046177 --> -0.053929).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0849695
	speed: 1.6709s/iter; left time: 32852.4075s
	iters: 200, epoch: 6 | loss: 3.1859796
	speed: 0.6826s/iter; left time: 13352.3711s
Epoch: 6 cost time: 141.50686860084534
Epoch: 6, Steps: 208 | Train Loss: 2.685 Vali Loss: 5.082 Vali Acc: 0.050 Test Loss: 5.082 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.6311543
	speed: 1.6388s/iter; left time: 31879.2476s
	iters: 200, epoch: 7 | loss: 2.5112901
	speed: 0.7005s/iter; left time: 13556.5406s
Epoch: 7 cost time: 144.47545289993286
Epoch: 7, Steps: 208 | Train Loss: 2.482 Vali Loss: 5.007 Vali Acc: 0.053 Test Loss: 5.007 Test Acc: 0.053
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.2216058
	speed: 1.7292s/iter; left time: 33277.6566s
	iters: 200, epoch: 8 | loss: 2.8015692
	speed: 0.6636s/iter; left time: 12704.4963s
Epoch: 8 cost time: 139.89572381973267
Epoch: 8, Steps: 208 | Train Loss: 2.237 Vali Loss: 5.019 Vali Acc: 0.070 Test Loss: 5.019 Test Acc: 0.070
Validation loss decreased (-0.053929 --> -0.070036).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4187460
	speed: 1.6871s/iter; left time: 32117.4587s
	iters: 200, epoch: 9 | loss: 2.9485800
	speed: 0.6484s/iter; left time: 12278.1339s
Epoch: 9 cost time: 139.72606563568115
Epoch: 9, Steps: 208 | Train Loss: 2.014 Vali Loss: 5.140 Vali Acc: 0.071 Test Loss: 5.140 Test Acc: 0.071
Validation loss decreased (-0.070036 --> -0.071228).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4042176
	speed: 1.6551s/iter; left time: 31164.5028s
	iters: 200, epoch: 10 | loss: 2.0217030
	speed: 0.7463s/iter; left time: 13977.5770s
Epoch: 10 cost time: 152.85697317123413
Epoch: 10, Steps: 208 | Train Loss: 1.787 Vali Loss: 5.554 Vali Acc: 0.069 Test Loss: 5.554 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4535345
	speed: 1.6689s/iter; left time: 31076.5500s
	iters: 200, epoch: 11 | loss: 1.6014134
	speed: 0.7034s/iter; left time: 13027.1424s
Epoch: 11 cost time: 144.74706554412842
Epoch: 11, Steps: 208 | Train Loss: 1.615 Vali Loss: 5.617 Vali Acc: 0.080 Test Loss: 5.617 Test Acc: 0.080
Validation loss decreased (-0.071228 --> -0.079872).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3600681
	speed: 1.6674s/iter; left time: 30701.7441s
	iters: 200, epoch: 12 | loss: 1.2692597
	speed: 0.6557s/iter; left time: 12006.9821s
Epoch: 12 cost time: 138.23081302642822
Epoch: 12, Steps: 208 | Train Loss: 1.400 Vali Loss: 5.945 Vali Acc: 0.078 Test Loss: 5.945 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9791024
	speed: 1.6658s/iter; left time: 30326.1608s
	iters: 200, epoch: 13 | loss: 1.1033754
	speed: 0.6334s/iter; left time: 11467.6654s
Epoch: 13 cost time: 137.1590394973755
Epoch: 13, Steps: 208 | Train Loss: 1.210 Vali Loss: 6.149 Vali Acc: 0.078 Test Loss: 6.149 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6540622
	speed: 1.6022s/iter; left time: 28835.0307s
	iters: 200, epoch: 14 | loss: 0.6165696
	speed: 0.6783s/iter; left time: 12139.6874s
Epoch: 14 cost time: 138.87005496025085
Epoch: 14, Steps: 208 | Train Loss: 1.047 Vali Loss: 6.562 Vali Acc: 0.072 Test Loss: 6.562 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4214190
	speed: 1.5074s/iter; left time: 26814.8066s
	iters: 200, epoch: 15 | loss: 0.7583573
	speed: 0.5666s/iter; left time: 10023.3920s
Epoch: 15 cost time: 125.11135840415955
Epoch: 15, Steps: 208 | Train Loss: 0.960 Vali Loss: 6.614 Vali Acc: 0.084 Test Loss: 6.614 Test Acc: 0.084
Validation loss decreased (-0.079872 --> -0.084038).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6197163
	speed: 1.3754s/iter; left time: 24180.8706s
	iters: 200, epoch: 16 | loss: 1.7890049
	speed: 0.5909s/iter; left time: 10329.8746s
Epoch: 16 cost time: 125.09726142883301
Epoch: 16, Steps: 208 | Train Loss: 0.872 Vali Loss: 6.929 Vali Acc: 0.068 Test Loss: 6.929 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4589826
	speed: 1.6627s/iter; left time: 28886.5952s
	iters: 200, epoch: 17 | loss: 1.0707616
	speed: 0.7052s/iter; left time: 12181.4887s
Epoch: 17 cost time: 147.70978116989136
Epoch: 17, Steps: 208 | Train Loss: 0.727 Vali Loss: 7.204 Vali Acc: 0.081 Test Loss: 7.204 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4600975
	speed: 1.7445s/iter; left time: 29943.5503s
	iters: 200, epoch: 18 | loss: 0.8805565
	speed: 0.6695s/iter; left time: 11424.7174s
Epoch: 18 cost time: 143.14665031433105
Epoch: 18, Steps: 208 | Train Loss: 0.716 Vali Loss: 7.091 Vali Acc: 0.085 Test Loss: 7.091 Test Acc: 0.085
Validation loss decreased (-0.084038 --> -0.085226).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9825723
	speed: 1.7666s/iter; left time: 29955.7424s
	iters: 200, epoch: 19 | loss: 0.6489613
	speed: 0.6140s/iter; left time: 10350.3040s
Epoch: 19 cost time: 137.78669548034668
Epoch: 19, Steps: 208 | Train Loss: 0.648 Vali Loss: 7.687 Vali Acc: 0.078 Test Loss: 7.687 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.5257158
	speed: 1.4431s/iter; left time: 24169.7559s
	iters: 200, epoch: 20 | loss: 0.9951519
	speed: 0.5678s/iter; left time: 9453.5113s
Epoch: 20 cost time: 121.97250986099243
Epoch: 20, Steps: 208 | Train Loss: 0.610 Vali Loss: 7.757 Vali Acc: 0.078 Test Loss: 7.757 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.6686816
	speed: 1.3488s/iter; left time: 22309.9722s
	iters: 200, epoch: 21 | loss: 0.2845099
	speed: 0.5791s/iter; left time: 9520.2274s
Epoch: 21 cost time: 114.2334976196289
Epoch: 21, Steps: 208 | Train Loss: 0.539 Vali Loss: 7.859 Vali Acc: 0.096 Test Loss: 7.859 Test Acc: 0.096
Validation loss decreased (-0.085226 --> -0.095955).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1945555
	speed: 1.4615s/iter; left time: 23869.9302s
	iters: 200, epoch: 22 | loss: 0.3401637
	speed: 0.6484s/iter; left time: 10526.2539s
Epoch: 22 cost time: 132.81640672683716
Epoch: 22, Steps: 208 | Train Loss: 0.511 Vali Loss: 8.170 Vali Acc: 0.092 Test Loss: 8.170 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1098057
	speed: 1.4422s/iter; left time: 23255.2588s
	iters: 200, epoch: 23 | loss: 0.5618536
	speed: 0.5790s/iter; left time: 9279.0108s
Epoch: 23 cost time: 126.41136384010315
Epoch: 23, Steps: 208 | Train Loss: 0.471 Vali Loss: 8.231 Vali Acc: 0.096 Test Loss: 8.231 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.3624769
	speed: 1.4745s/iter; left time: 23470.1531s
	iters: 200, epoch: 24 | loss: 0.5848953
	speed: 0.5694s/iter; left time: 9006.9854s
Epoch: 24 cost time: 123.09634017944336
Epoch: 24, Steps: 208 | Train Loss: 0.462 Vali Loss: 8.359 Vali Acc: 0.101 Test Loss: 8.359 Test Acc: 0.101
Validation loss decreased (-0.095955 --> -0.100423).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.4705689
	speed: 1.4770s/iter; left time: 23202.4852s
	iters: 200, epoch: 25 | loss: 0.4625784
	speed: 0.5928s/iter; left time: 9253.3368s
Epoch: 25 cost time: 126.47941064834595
Epoch: 25, Steps: 208 | Train Loss: 0.446 Vali Loss: 8.631 Vali Acc: 0.101 Test Loss: 8.631 Test Acc: 0.101
Validation loss decreased (-0.100423 --> -0.100719).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.2991122
	speed: 1.5137s/iter; left time: 23463.8996s
	iters: 200, epoch: 26 | loss: 0.3158057
	speed: 0.7034s/iter; left time: 10833.2026s
Epoch: 26 cost time: 138.93862390518188
Epoch: 26, Steps: 208 | Train Loss: 0.397 Vali Loss: 9.254 Vali Acc: 0.099 Test Loss: 9.254 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.6050154
	speed: 1.6928s/iter; left time: 25888.2123s
	iters: 200, epoch: 27 | loss: 0.1733164
	speed: 0.6603s/iter; left time: 10032.1142s
Epoch: 27 cost time: 139.45358753204346
Epoch: 27, Steps: 208 | Train Loss: 0.400 Vali Loss: 8.769 Vali Acc: 0.098 Test Loss: 8.769 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.4897538
	speed: 1.7417s/iter; left time: 26273.6467s
	iters: 200, epoch: 28 | loss: 0.1347833
	speed: 0.6688s/iter; left time: 10022.6961s
Epoch: 28 cost time: 147.41679048538208
Epoch: 28, Steps: 208 | Train Loss: 0.329 Vali Loss: 9.089 Vali Acc: 0.104 Test Loss: 9.089 Test Acc: 0.104
Validation loss decreased (-0.100719 --> -0.103697).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0601715
	speed: 1.5869s/iter; left time: 23608.3845s
	iters: 200, epoch: 29 | loss: 0.2520349
	speed: 0.6561s/iter; left time: 9695.5887s
Epoch: 29 cost time: 136.7283673286438
Epoch: 29, Steps: 208 | Train Loss: 0.357 Vali Loss: 9.142 Vali Acc: 0.091 Test Loss: 9.142 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.3643556
	speed: 1.6149s/iter; left time: 23688.6962s
	iters: 200, epoch: 30 | loss: 0.8773934
	speed: 0.6579s/iter; left time: 9585.1552s
Epoch: 30 cost time: 134.31318855285645
Epoch: 30, Steps: 208 | Train Loss: 0.331 Vali Loss: 9.381 Vali Acc: 0.087 Test Loss: 9.381 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.2929292
	speed: 1.7465s/iter; left time: 25255.4410s
	iters: 200, epoch: 31 | loss: 0.2256382
	speed: 0.6552s/iter; left time: 9408.7414s
Epoch: 31 cost time: 140.88224077224731
Epoch: 31, Steps: 208 | Train Loss: 0.321 Vali Loss: 9.782 Vali Acc: 0.091 Test Loss: 9.782 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0596089
	speed: 1.7978s/iter; left time: 25623.8022s
	iters: 200, epoch: 32 | loss: 0.2190804
	speed: 0.7130s/iter; left time: 10090.8017s
Epoch: 32 cost time: 157.46936702728271
Epoch: 32, Steps: 208 | Train Loss: 0.301 Vali Loss: 9.616 Vali Acc: 0.092 Test Loss: 9.616 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.3068445
	speed: 1.6252s/iter; left time: 22825.8293s
	iters: 200, epoch: 33 | loss: 0.3069561
	speed: 0.7390s/iter; left time: 10305.6254s
Epoch: 33 cost time: 148.00654530525208
Epoch: 33, Steps: 208 | Train Loss: 0.327 Vali Loss: 9.745 Vali Acc: 0.098 Test Loss: 9.745 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.5880597
	speed: 1.6828s/iter; left time: 23284.3936s
	iters: 200, epoch: 34 | loss: 0.3171199
	speed: 0.6824s/iter; left time: 9374.4316s
Epoch: 34 cost time: 143.21491479873657
Epoch: 34, Steps: 208 | Train Loss: 0.293 Vali Loss: 9.913 Vali Acc: 0.096 Test Loss: 9.913 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.1249494
	speed: 1.7726s/iter; left time: 24158.3744s
	iters: 200, epoch: 35 | loss: 0.3869556
	speed: 0.6970s/iter; left time: 9429.3475s
Epoch: 35 cost time: 147.33665776252747
Epoch: 35, Steps: 208 | Train Loss: 0.302 Vali Loss: 10.121 Vali Acc: 0.090 Test Loss: 10.121 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0896828
	speed: 1.7022s/iter; left time: 22845.3276s
	iters: 200, epoch: 36 | loss: 0.4855596
	speed: 0.6914s/iter; left time: 9210.7713s
Epoch: 36 cost time: 149.30894660949707
Epoch: 36, Steps: 208 | Train Loss: 0.255 Vali Loss: 9.925 Vali Acc: 0.096 Test Loss: 9.925 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.1576407
	speed: 1.6264s/iter; left time: 21489.7798s
	iters: 200, epoch: 37 | loss: 0.3466914
	speed: 0.7334s/iter; left time: 9617.4120s
Epoch: 37 cost time: 145.54714155197144
Epoch: 37, Steps: 208 | Train Loss: 0.266 Vali Loss: 10.285 Vali Acc: 0.097 Test Loss: 10.285 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.1667977
	speed: 1.7315s/iter; left time: 22518.4268s
	iters: 200, epoch: 38 | loss: 0.3328522
	speed: 0.6564s/iter; left time: 8471.0161s
Epoch: 38 cost time: 142.0012333393097
Epoch: 38, Steps: 208 | Train Loss: 0.276 Vali Loss: 10.215 Vali Acc: 0.099 Test Loss: 10.215 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10378765284819565
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6078546
	speed: 0.7226s/iter; left time: 14959.0953s
	iters: 200, epoch: 1 | loss: 3.4860039
	speed: 0.6766s/iter; left time: 13939.0910s
Epoch: 1 cost time: 146.15092515945435
Epoch: 1, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.938 Vali Acc: 0.033 Test Loss: 3.938 Test Acc: 0.033
Validation loss decreased (inf --> -0.032767).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8335519
	speed: 1.6096s/iter; left time: 32986.3662s
	iters: 200, epoch: 2 | loss: 3.1662474
	speed: 0.6453s/iter; left time: 13160.5244s
Epoch: 2 cost time: 141.31505703926086
Epoch: 2, Steps: 208 | Train Loss: 3.303 Vali Loss: 4.453 Vali Acc: 0.038 Test Loss: 4.453 Test Acc: 0.038
Validation loss decreased (-0.032767 --> -0.038428).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4305694
	speed: 1.6058s/iter; left time: 32572.6977s
	iters: 200, epoch: 3 | loss: 2.5499191
	speed: 0.6140s/iter; left time: 12393.1930s
Epoch: 3 cost time: 137.99624824523926
Epoch: 3, Steps: 208 | Train Loss: 2.994 Vali Loss: 4.649 Vali Acc: 0.048 Test Loss: 4.649 Test Acc: 0.048
Validation loss decreased (-0.038428 --> -0.047970).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7135820
	speed: 1.3421s/iter; left time: 26945.5472s
	iters: 200, epoch: 4 | loss: 2.6901426
	speed: 0.5741s/iter; left time: 11468.4232s
Epoch: 4 cost time: 118.2824330329895
Epoch: 4, Steps: 208 | Train Loss: 2.777 Vali Loss: 4.638 Vali Acc: 0.051 Test Loss: 4.638 Test Acc: 0.051
Validation loss decreased (-0.047970 --> -0.050953).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3460317
	speed: 1.4988s/iter; left time: 29780.0984s
	iters: 200, epoch: 5 | loss: 2.5344403
	speed: 0.6521s/iter; left time: 12890.9671s
Epoch: 5 cost time: 138.06002640724182
Epoch: 5, Steps: 208 | Train Loss: 2.614 Vali Loss: 5.020 Vali Acc: 0.057 Test Loss: 5.020 Test Acc: 0.057
Validation loss decreased (-0.050953 --> -0.056615).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8506151
	speed: 1.5627s/iter; left time: 30723.8440s
	iters: 200, epoch: 6 | loss: 3.3121524
	speed: 0.6712s/iter; left time: 13130.0017s
Epoch: 6 cost time: 141.52194213867188
Epoch: 6, Steps: 208 | Train Loss: 2.343 Vali Loss: 4.938 Vali Acc: 0.058 Test Loss: 4.938 Test Acc: 0.058
Validation loss decreased (-0.056615 --> -0.058406).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9285498
	speed: 1.6081s/iter; left time: 31282.4118s
	iters: 200, epoch: 7 | loss: 2.5299480
	speed: 0.6522s/iter; left time: 12621.2969s
Epoch: 7 cost time: 136.7786054611206
Epoch: 7, Steps: 208 | Train Loss: 2.079 Vali Loss: 5.169 Vali Acc: 0.064 Test Loss: 5.169 Test Acc: 0.064
Validation loss decreased (-0.058406 --> -0.064070).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8635149
	speed: 1.6127s/iter; left time: 31037.2949s
	iters: 200, epoch: 8 | loss: 2.9616261
	speed: 0.6434s/iter; left time: 12317.3571s
Epoch: 8 cost time: 136.63504242897034
Epoch: 8, Steps: 208 | Train Loss: 1.808 Vali Loss: 5.346 Vali Acc: 0.072 Test Loss: 5.346 Test Acc: 0.072
Validation loss decreased (-0.064070 --> -0.072121).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8666094
	speed: 1.6250s/iter; left time: 30935.0308s
	iters: 200, epoch: 9 | loss: 2.6947415
	speed: 0.6551s/iter; left time: 12406.2096s
Epoch: 9 cost time: 139.92375898361206
Epoch: 9, Steps: 208 | Train Loss: 1.529 Vali Loss: 5.593 Vali Acc: 0.070 Test Loss: 5.593 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2142996
	speed: 1.5645s/iter; left time: 29458.2043s
	iters: 200, epoch: 10 | loss: 1.9817128
	speed: 0.6931s/iter; left time: 12980.4195s
Epoch: 10 cost time: 139.68416595458984
Epoch: 10, Steps: 208 | Train Loss: 1.290 Vali Loss: 5.935 Vali Acc: 0.069 Test Loss: 5.935 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8050072
	speed: 1.5629s/iter; left time: 29102.7839s
	iters: 200, epoch: 11 | loss: 1.2740767
	speed: 0.6710s/iter; left time: 12427.9251s
Epoch: 11 cost time: 138.49037981033325
Epoch: 11, Steps: 208 | Train Loss: 1.118 Vali Loss: 6.234 Vali Acc: 0.070 Test Loss: 6.234 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8341960
	speed: 1.5635s/iter; left time: 28789.3540s
	iters: 200, epoch: 12 | loss: 1.4499824
	speed: 0.6359s/iter; left time: 11644.8497s
Epoch: 12 cost time: 134.78859114646912
Epoch: 12, Steps: 208 | Train Loss: 0.928 Vali Loss: 6.636 Vali Acc: 0.073 Test Loss: 6.636 Test Acc: 0.073
Validation loss decreased (-0.072121 --> -0.073003).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8145311
	speed: 1.5395s/iter; left time: 28027.1385s
	iters: 200, epoch: 13 | loss: 1.2710886
	speed: 0.6428s/iter; left time: 11637.9296s
Epoch: 13 cost time: 131.72354125976562
Epoch: 13, Steps: 208 | Train Loss: 0.818 Vali Loss: 6.735 Vali Acc: 0.074 Test Loss: 6.735 Test Acc: 0.074
Validation loss decreased (-0.073003 --> -0.073598).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4194913
	speed: 1.5381s/iter; left time: 27682.0062s
	iters: 200, epoch: 14 | loss: 0.4376155
	speed: 0.6634s/iter; left time: 11873.5074s
Epoch: 14 cost time: 135.6130621433258
Epoch: 14, Steps: 208 | Train Loss: 0.711 Vali Loss: 7.173 Vali Acc: 0.080 Test Loss: 7.173 Test Acc: 0.080
Validation loss decreased (-0.073598 --> -0.079558).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4254438
	speed: 1.5816s/iter; left time: 28135.6456s
	iters: 200, epoch: 15 | loss: 0.5169327
	speed: 0.6312s/iter; left time: 11165.7433s
Epoch: 15 cost time: 134.14246535301208
Epoch: 15, Steps: 208 | Train Loss: 0.645 Vali Loss: 7.411 Vali Acc: 0.082 Test Loss: 7.411 Test Acc: 0.082
Validation loss decreased (-0.079558 --> -0.081644).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4587420
	speed: 1.6190s/iter; left time: 28464.3276s
	iters: 200, epoch: 16 | loss: 1.1321131
	speed: 0.6493s/iter; left time: 11350.9004s
Epoch: 16 cost time: 137.32440876960754
Epoch: 16, Steps: 208 | Train Loss: 0.554 Vali Loss: 7.681 Vali Acc: 0.080 Test Loss: 7.681 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3027538
	speed: 1.5686s/iter; left time: 27250.7303s
	iters: 200, epoch: 17 | loss: 0.9218947
	speed: 0.6321s/iter; left time: 10918.0581s
Epoch: 17 cost time: 132.69956970214844
Epoch: 17, Steps: 208 | Train Loss: 0.513 Vali Loss: 7.971 Vali Acc: 0.081 Test Loss: 7.971 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5727750
	speed: 1.6461s/iter; left time: 28254.7457s
	iters: 200, epoch: 18 | loss: 0.2747865
	speed: 0.6380s/iter; left time: 10888.1302s
Epoch: 18 cost time: 136.0795385837555
Epoch: 18, Steps: 208 | Train Loss: 0.485 Vali Loss: 8.129 Vali Acc: 0.089 Test Loss: 8.129 Test Acc: 0.089
Validation loss decreased (-0.081644 --> -0.089391).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6467718
	speed: 1.6438s/iter; left time: 27873.6990s
	iters: 200, epoch: 19 | loss: 0.2805946
	speed: 0.6517s/iter; left time: 10985.6136s
Epoch: 19 cost time: 140.9220690727234
Epoch: 19, Steps: 208 | Train Loss: 0.421 Vali Loss: 8.517 Vali Acc: 0.082 Test Loss: 8.517 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.4271424
	speed: 1.7534s/iter; left time: 29367.1692s
	iters: 200, epoch: 20 | loss: 0.7019652
	speed: 0.6308s/iter; left time: 10502.2499s
Epoch: 20 cost time: 140.0242896080017
Epoch: 20, Steps: 208 | Train Loss: 0.381 Vali Loss: 8.723 Vali Acc: 0.086 Test Loss: 8.723 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.3642456
	speed: 1.5489s/iter; left time: 25620.6261s
	iters: 200, epoch: 21 | loss: 0.1987429
	speed: 0.6086s/iter; left time: 10005.9584s
Epoch: 21 cost time: 131.93797636032104
Epoch: 21, Steps: 208 | Train Loss: 0.383 Vali Loss: 8.847 Vali Acc: 0.089 Test Loss: 8.847 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.3095740
	speed: 1.6147s/iter; left time: 26372.3737s
	iters: 200, epoch: 22 | loss: 0.1584236
	speed: 0.6150s/iter; left time: 9982.5147s
Epoch: 22 cost time: 132.72932696342468
Epoch: 22, Steps: 208 | Train Loss: 0.355 Vali Loss: 9.157 Vali Acc: 0.087 Test Loss: 9.157 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1094564
	speed: 1.6272s/iter; left time: 26239.2779s
	iters: 200, epoch: 23 | loss: 0.6676723
	speed: 0.7155s/iter; left time: 11465.9992s
Epoch: 23 cost time: 147.1152904033661
Epoch: 23, Steps: 208 | Train Loss: 0.329 Vali Loss: 9.268 Vali Acc: 0.087 Test Loss: 9.268 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1428324
	speed: 1.7695s/iter; left time: 28164.3606s
	iters: 200, epoch: 24 | loss: 0.2034284
	speed: 0.6974s/iter; left time: 11031.4881s
Epoch: 24 cost time: 150.80600666999817
Epoch: 24, Steps: 208 | Train Loss: 0.315 Vali Loss: 9.044 Vali Acc: 0.090 Test Loss: 9.044 Test Acc: 0.090
Validation loss decreased (-0.089391 --> -0.089978).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.2369466
	speed: 1.6970s/iter; left time: 26657.4851s
	iters: 200, epoch: 25 | loss: 0.1244412
	speed: 0.6616s/iter; left time: 10327.5443s
Epoch: 25 cost time: 141.4930727481842
Epoch: 25, Steps: 208 | Train Loss: 0.296 Vali Loss: 9.658 Vali Acc: 0.085 Test Loss: 9.658 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.4381699
	speed: 1.5245s/iter; left time: 23630.5191s
	iters: 200, epoch: 26 | loss: 0.3842845
	speed: 0.7015s/iter; left time: 10803.3712s
Epoch: 26 cost time: 140.393315076828
Epoch: 26, Steps: 208 | Train Loss: 0.257 Vali Loss: 9.625 Vali Acc: 0.090 Test Loss: 9.625 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3271810
	speed: 1.6762s/iter; left time: 25633.5652s
	iters: 200, epoch: 27 | loss: 0.8201235
	speed: 0.7494s/iter; left time: 11385.5135s
Epoch: 27 cost time: 157.35272550582886
Epoch: 27, Steps: 208 | Train Loss: 0.307 Vali Loss: 9.736 Vali Acc: 0.091 Test Loss: 9.736 Test Acc: 0.091
Validation loss decreased (-0.089978 --> -0.090866).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.3876910
	speed: 1.6377s/iter; left time: 24704.5018s
	iters: 200, epoch: 28 | loss: 0.3320586
	speed: 0.6840s/iter; left time: 10249.6342s
Epoch: 28 cost time: 143.31098914146423
Epoch: 28, Steps: 208 | Train Loss: 0.244 Vali Loss: 9.997 Vali Acc: 0.093 Test Loss: 9.997 Test Acc: 0.093
Validation loss decreased (-0.090866 --> -0.092951).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1801538
	speed: 1.5831s/iter; left time: 23552.4281s
	iters: 200, epoch: 29 | loss: 0.1329420
	speed: 0.6248s/iter; left time: 9232.9557s
Epoch: 29 cost time: 130.33293867111206
Epoch: 29, Steps: 208 | Train Loss: 0.235 Vali Loss: 9.944 Vali Acc: 0.096 Test Loss: 9.944 Test Acc: 0.096
Validation loss decreased (-0.092951 --> -0.096232).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.1812480
	speed: 1.5999s/iter; left time: 23468.9746s
	iters: 200, epoch: 30 | loss: 0.2467873
	speed: 0.6781s/iter; left time: 9879.4790s
Epoch: 30 cost time: 143.15571308135986
Epoch: 30, Steps: 208 | Train Loss: 0.245 Vali Loss: 9.859 Vali Acc: 0.099 Test Loss: 9.859 Test Acc: 0.099
Validation loss decreased (-0.096232 --> -0.098917).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.3259655
	speed: 1.6430s/iter; left time: 23759.2265s
	iters: 200, epoch: 31 | loss: 0.1536659
	speed: 0.7278s/iter; left time: 10451.2862s
Epoch: 31 cost time: 145.93678832054138
Epoch: 31, Steps: 208 | Train Loss: 0.230 Vali Loss: 10.493 Vali Acc: 0.098 Test Loss: 10.493 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.3312509
	speed: 1.6599s/iter; left time: 23659.0707s
	iters: 200, epoch: 32 | loss: 0.1232063
	speed: 0.7081s/iter; left time: 10022.3408s
Epoch: 32 cost time: 143.66197085380554
Epoch: 32, Steps: 208 | Train Loss: 0.216 Vali Loss: 10.299 Vali Acc: 0.096 Test Loss: 10.299 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.2468491
	speed: 1.6521s/iter; left time: 23204.3640s
	iters: 200, epoch: 33 | loss: 0.0388828
	speed: 0.6718s/iter; left time: 9368.7261s
Epoch: 33 cost time: 144.13383316993713
Epoch: 33, Steps: 208 | Train Loss: 0.206 Vali Loss: 10.605 Vali Acc: 0.092 Test Loss: 10.605 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0205447
	speed: 1.5553s/iter; left time: 21520.2406s
	iters: 200, epoch: 34 | loss: 0.1708264
	speed: 0.6494s/iter; left time: 8921.2838s
Epoch: 34 cost time: 136.80992722511292
Epoch: 34, Steps: 208 | Train Loss: 0.227 Vali Loss: 10.380 Vali Acc: 0.091 Test Loss: 10.380 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.1643519
	speed: 1.7210s/iter; left time: 23455.8451s
	iters: 200, epoch: 35 | loss: 0.2181443
	speed: 0.6855s/iter; left time: 9274.5360s
Epoch: 35 cost time: 146.75267124176025
Epoch: 35, Steps: 208 | Train Loss: 0.186 Vali Loss: 10.760 Vali Acc: 0.098 Test Loss: 10.760 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.3343337
	speed: 1.6209s/iter; left time: 21753.5945s
	iters: 200, epoch: 36 | loss: 0.4788654
	speed: 0.7231s/iter; left time: 9632.6268s
Epoch: 36 cost time: 148.0599901676178
Epoch: 36, Steps: 208 | Train Loss: 0.173 Vali Loss: 10.995 Vali Acc: 0.085 Test Loss: 10.995 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0465443
	speed: 1.6593s/iter; left time: 21923.9448s
	iters: 200, epoch: 37 | loss: 0.0368490
	speed: 0.6136s/iter; left time: 8046.3664s
Epoch: 37 cost time: 136.18851780891418
Epoch: 37, Steps: 208 | Train Loss: 0.165 Vali Loss: 11.015 Vali Acc: 0.093 Test Loss: 11.015 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.2224469
	speed: 1.6803s/iter; left time: 21852.1367s
	iters: 200, epoch: 38 | loss: 0.5760511
	speed: 0.7448s/iter; left time: 9612.1028s
Epoch: 38 cost time: 154.0959415435791
Epoch: 38, Steps: 208 | Train Loss: 0.176 Vali Loss: 10.887 Vali Acc: 0.094 Test Loss: 10.887 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.2136482
	speed: 1.7022s/iter; left time: 21783.6776s
	iters: 200, epoch: 39 | loss: 0.7748418
	speed: 0.6950s/iter; left time: 8824.6043s
Epoch: 39 cost time: 148.84657335281372
Epoch: 39, Steps: 208 | Train Loss: 0.154 Vali Loss: 11.280 Vali Acc: 0.096 Test Loss: 11.280 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0101658
	speed: 1.7153s/iter; left time: 21593.7949s
	iters: 200, epoch: 40 | loss: 0.2117000
	speed: 0.6860s/iter; left time: 8567.4510s
Epoch: 40 cost time: 143.5258686542511
Epoch: 40, Steps: 208 | Train Loss: 0.158 Vali Loss: 11.342 Vali Acc: 0.091 Test Loss: 11.342 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09901580674023262
model parameter : 412743
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9582174
	speed: 0.6104s/iter; left time: 12634.9605s
	iters: 200, epoch: 1 | loss: 3.2092361
	speed: 0.5874s/iter; left time: 12101.7762s
Epoch: 1 cost time: 125.68698787689209
Epoch: 1, Steps: 208 | Train Loss: 3.661 Vali Loss: 3.532 Vali Acc: 0.067 Test Loss: 3.532 Test Acc: 0.067
Validation loss decreased (inf --> -0.066771).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5077395
	speed: 1.4923s/iter; left time: 30580.9602s
	iters: 200, epoch: 2 | loss: 3.1884987
	speed: 0.6383s/iter; left time: 13016.8188s
Epoch: 2 cost time: 130.90881729125977
Epoch: 2, Steps: 208 | Train Loss: 3.183 Vali Loss: 3.529 Vali Acc: 0.084 Test Loss: 3.529 Test Acc: 0.084
Validation loss decreased (-0.066771 --> -0.083472).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8605444
	speed: 1.5976s/iter; left time: 32407.5186s
	iters: 200, epoch: 3 | loss: 3.0292869
	speed: 0.7249s/iter; left time: 14632.8293s
Epoch: 3 cost time: 151.29771399497986
Epoch: 3, Steps: 208 | Train Loss: 2.672 Vali Loss: 3.756 Vali Acc: 0.080 Test Loss: 3.756 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1194186
	speed: 1.6716s/iter; left time: 33560.1374s
	iters: 200, epoch: 4 | loss: 2.7802601
	speed: 0.6985s/iter; left time: 13953.2057s
Epoch: 4 cost time: 144.07424521446228
Epoch: 4, Steps: 208 | Train Loss: 2.185 Vali Loss: 4.046 Vali Acc: 0.101 Test Loss: 4.046 Test Acc: 0.101
Validation loss decreased (-0.083472 --> -0.101361).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9912646
	speed: 1.7892s/iter; left time: 35549.4853s
	iters: 200, epoch: 5 | loss: 2.4595296
	speed: 0.6502s/iter; left time: 12854.3739s
Epoch: 5 cost time: 144.7574234008789
Epoch: 5, Steps: 208 | Train Loss: 1.707 Vali Loss: 4.365 Vali Acc: 0.092 Test Loss: 4.365 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5043999
	speed: 1.6629s/iter; left time: 32694.1905s
	iters: 200, epoch: 6 | loss: 1.7799082
	speed: 0.6833s/iter; left time: 13366.8572s
Epoch: 6 cost time: 143.73112607002258
Epoch: 6, Steps: 208 | Train Loss: 1.213 Vali Loss: 4.909 Vali Acc: 0.102 Test Loss: 4.909 Test Acc: 0.102
Validation loss decreased (-0.101361 --> -0.101651).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7739974
	speed: 1.6880s/iter; left time: 32836.6488s
	iters: 200, epoch: 7 | loss: 1.3053966
	speed: 0.7094s/iter; left time: 13728.9296s
Epoch: 7 cost time: 143.43699502944946
Epoch: 7, Steps: 208 | Train Loss: 0.896 Vali Loss: 5.516 Vali Acc: 0.094 Test Loss: 5.516 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5646811
	speed: 1.6447s/iter; left time: 31652.2423s
	iters: 200, epoch: 8 | loss: 0.7922822
	speed: 0.6649s/iter; left time: 12730.0852s
Epoch: 8 cost time: 136.54236507415771
Epoch: 8, Steps: 208 | Train Loss: 0.664 Vali Loss: 6.060 Vali Acc: 0.094 Test Loss: 6.060 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4097827
	speed: 1.5985s/iter; left time: 30431.3217s
	iters: 200, epoch: 9 | loss: 1.4070374
	speed: 0.6264s/iter; left time: 11862.7892s
Epoch: 9 cost time: 134.58210968971252
Epoch: 9, Steps: 208 | Train Loss: 0.558 Vali Loss: 6.400 Vali Acc: 0.098 Test Loss: 6.400 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6860035
	speed: 1.7355s/iter; left time: 32677.4194s
	iters: 200, epoch: 10 | loss: 0.3747894
	speed: 0.6967s/iter; left time: 13049.0090s
Epoch: 10 cost time: 147.06362342834473
Epoch: 10, Steps: 208 | Train Loss: 0.465 Vali Loss: 6.811 Vali Acc: 0.097 Test Loss: 6.811 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0760233
	speed: 1.7279s/iter; left time: 32174.9584s
	iters: 200, epoch: 11 | loss: 0.4580096
	speed: 0.6811s/iter; left time: 12615.5617s
Epoch: 11 cost time: 142.78116941452026
Epoch: 11, Steps: 208 | Train Loss: 0.373 Vali Loss: 7.514 Vali Acc: 0.103 Test Loss: 7.514 Test Acc: 0.103
Validation loss decreased (-0.101651 --> -0.103116).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1976919
	speed: 1.6073s/iter; left time: 29594.8195s
	iters: 200, epoch: 12 | loss: 1.0267025
	speed: 0.6972s/iter; left time: 12767.5264s
Epoch: 12 cost time: 142.65914130210876
Epoch: 12, Steps: 208 | Train Loss: 0.334 Vali Loss: 7.525 Vali Acc: 0.104 Test Loss: 7.525 Test Acc: 0.104
Validation loss decreased (-0.103116 --> -0.104011).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3062623
	speed: 1.6539s/iter; left time: 30108.5634s
	iters: 200, epoch: 13 | loss: 0.4398221
	speed: 0.7133s/iter; left time: 12914.2400s
Epoch: 13 cost time: 144.53566551208496
Epoch: 13, Steps: 208 | Train Loss: 0.316 Vali Loss: 7.919 Vali Acc: 0.101 Test Loss: 7.919 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2441093
	speed: 1.7867s/iter; left time: 32154.8424s
	iters: 200, epoch: 14 | loss: 0.4190427
	speed: 0.6939s/iter; left time: 12418.4459s
Epoch: 14 cost time: 152.709534406662
Epoch: 14, Steps: 208 | Train Loss: 0.286 Vali Loss: 8.318 Vali Acc: 0.091 Test Loss: 8.318 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5312274
	speed: 1.6802s/iter; left time: 29888.2832s
	iters: 200, epoch: 15 | loss: 0.6931244
	speed: 0.6764s/iter; left time: 11964.2092s
Epoch: 15 cost time: 141.9970669746399
Epoch: 15, Steps: 208 | Train Loss: 0.251 Vali Loss: 8.602 Vali Acc: 0.096 Test Loss: 8.602 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1089737
	speed: 1.7845s/iter; left time: 31372.9917s
	iters: 200, epoch: 16 | loss: 0.2024192
	speed: 0.7145s/iter; left time: 12490.3134s
Epoch: 16 cost time: 152.27637815475464
Epoch: 16, Steps: 208 | Train Loss: 0.216 Vali Loss: 9.014 Vali Acc: 0.088 Test Loss: 9.014 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1295356
	speed: 1.7334s/iter; left time: 30113.5883s
	iters: 200, epoch: 17 | loss: 0.0928247
	speed: 0.6626s/iter; left time: 11445.2946s
Epoch: 17 cost time: 140.01363348960876
Epoch: 17, Steps: 208 | Train Loss: 0.222 Vali Loss: 8.989 Vali Acc: 0.098 Test Loss: 8.989 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0379064
	speed: 1.8349s/iter; left time: 31495.3797s
	iters: 200, epoch: 18 | loss: 0.2785837
	speed: 0.7757s/iter; left time: 13236.7639s
Epoch: 18 cost time: 159.21885871887207
Epoch: 18, Steps: 208 | Train Loss: 0.196 Vali Loss: 9.382 Vali Acc: 0.094 Test Loss: 9.382 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0036462
	speed: 1.9156s/iter; left time: 32482.0380s
	iters: 200, epoch: 19 | loss: 0.3861373
	speed: 0.7987s/iter; left time: 13463.2376s
Epoch: 19 cost time: 167.82766771316528
Epoch: 19, Steps: 208 | Train Loss: 0.195 Vali Loss: 9.710 Vali Acc: 0.093 Test Loss: 9.710 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6781245
	speed: 1.8376s/iter; left time: 30777.9015s
	iters: 200, epoch: 20 | loss: 0.5820803
	speed: 0.7514s/iter; left time: 12509.6294s
Epoch: 20 cost time: 155.86085867881775
Epoch: 20, Steps: 208 | Train Loss: 0.173 Vali Loss: 9.374 Vali Acc: 0.101 Test Loss: 9.374 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0153609
	speed: 1.9737s/iter; left time: 32646.8665s
	iters: 200, epoch: 21 | loss: 0.0114819
	speed: 0.7583s/iter; left time: 12467.2102s
Epoch: 21 cost time: 170.36040806770325
Epoch: 21, Steps: 208 | Train Loss: 0.166 Vali Loss: 10.057 Vali Acc: 0.099 Test Loss: 10.057 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3499789
	speed: 1.9579s/iter; left time: 31978.8301s
	iters: 200, epoch: 22 | loss: 0.1814713
	speed: 0.7413s/iter; left time: 12033.4951s
Epoch: 22 cost time: 161.30451679229736
Epoch: 22, Steps: 208 | Train Loss: 0.155 Vali Loss: 10.169 Vali Acc: 0.098 Test Loss: 10.169 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10408589322994334
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9024141
	speed: 0.7150s/iter; left time: 14800.8690s
	iters: 200, epoch: 1 | loss: 3.1942286
	speed: 0.6960s/iter; left time: 14338.1344s
Epoch: 1 cost time: 147.7572786808014
Epoch: 1, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.536 Vali Acc: 0.071 Test Loss: 3.536 Test Acc: 0.071
Validation loss decreased (inf --> -0.070648).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2178457
	speed: 1.6720s/iter; left time: 34264.3110s
	iters: 200, epoch: 2 | loss: 3.3782444
	speed: 0.6668s/iter; left time: 13597.2224s
Epoch: 2 cost time: 138.51382493972778
Epoch: 2, Steps: 208 | Train Loss: 3.177 Vali Loss: 3.527 Vali Acc: 0.085 Test Loss: 3.527 Test Acc: 0.085
Validation loss decreased (-0.070648 --> -0.084665).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9413834
	speed: 1.7232s/iter; left time: 34955.7037s
	iters: 200, epoch: 3 | loss: 2.9865057
	speed: 0.7355s/iter; left time: 14845.1204s
Epoch: 3 cost time: 151.53163862228394
Epoch: 3, Steps: 208 | Train Loss: 2.668 Vali Loss: 3.765 Vali Acc: 0.084 Test Loss: 3.765 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0023785
	speed: 1.4523s/iter; left time: 29157.7678s
	iters: 200, epoch: 4 | loss: 2.8827262
	speed: 0.5287s/iter; left time: 10561.3566s
Epoch: 4 cost time: 114.92302083969116
Epoch: 4, Steps: 208 | Train Loss: 2.177 Vali Loss: 4.047 Vali Acc: 0.102 Test Loss: 4.047 Test Acc: 0.102
Validation loss decreased (-0.084665 --> -0.102256).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9304706
	speed: 1.1940s/iter; left time: 23724.1823s
	iters: 200, epoch: 5 | loss: 2.6523423
	speed: 0.5389s/iter; left time: 10653.8199s
Epoch: 5 cost time: 106.6750557422638
Epoch: 5, Steps: 208 | Train Loss: 1.679 Vali Loss: 4.348 Vali Acc: 0.103 Test Loss: 4.348 Test Acc: 0.103
Validation loss decreased (-0.102256 --> -0.102551).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1640458
	speed: 1.4150s/iter; left time: 27821.0633s
	iters: 200, epoch: 6 | loss: 1.8353789
	speed: 0.5465s/iter; left time: 10690.5056s
Epoch: 6 cost time: 117.29953503608704
Epoch: 6, Steps: 208 | Train Loss: 1.198 Vali Loss: 4.908 Vali Acc: 0.103 Test Loss: 4.908 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4770199
	speed: 1.4072s/iter; left time: 27373.7166s
	iters: 200, epoch: 7 | loss: 1.0250765
	speed: 0.5355s/iter; left time: 10364.2163s
Epoch: 7 cost time: 115.83778786659241
Epoch: 7, Steps: 208 | Train Loss: 0.899 Vali Loss: 5.477 Vali Acc: 0.100 Test Loss: 5.477 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8052002
	speed: 1.4257s/iter; left time: 27436.8632s
	iters: 200, epoch: 8 | loss: 0.6753891
	speed: 0.5512s/iter; left time: 10551.9534s
Epoch: 8 cost time: 116.92226481437683
Epoch: 8, Steps: 208 | Train Loss: 0.658 Vali Loss: 6.026 Vali Acc: 0.091 Test Loss: 6.026 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1927777
	speed: 1.3489s/iter; left time: 25679.5282s
	iters: 200, epoch: 9 | loss: 1.0957782
	speed: 0.5698s/iter; left time: 10791.1766s
Epoch: 9 cost time: 116.25892949104309
Epoch: 9, Steps: 208 | Train Loss: 0.539 Vali Loss: 6.376 Vali Acc: 0.101 Test Loss: 6.376 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.7795811
	speed: 1.5195s/iter; left time: 28611.4335s
	iters: 200, epoch: 10 | loss: 0.5254164
	speed: 0.6233s/iter; left time: 11672.9479s
Epoch: 10 cost time: 128.9618363380432
Epoch: 10, Steps: 208 | Train Loss: 0.452 Vali Loss: 6.779 Vali Acc: 0.092 Test Loss: 6.779 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0834777
	speed: 1.4791s/iter; left time: 27541.9672s
	iters: 200, epoch: 11 | loss: 0.2960333
	speed: 0.5215s/iter; left time: 9659.1773s
Epoch: 11 cost time: 113.7678611278534
Epoch: 11, Steps: 208 | Train Loss: 0.374 Vali Loss: 7.322 Vali Acc: 0.098 Test Loss: 7.322 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7908376
	speed: 0.6036s/iter; left time: 11114.5134s
	iters: 200, epoch: 12 | loss: 0.6756414
	speed: 0.2566s/iter; left time: 4698.8970s
Epoch: 12 cost time: 53.97080039978027
Epoch: 12, Steps: 208 | Train Loss: 0.369 Vali Loss: 7.644 Vali Acc: 0.096 Test Loss: 7.644 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2342408
	speed: 0.6051s/iter; left time: 11015.5465s
	iters: 200, epoch: 13 | loss: 0.1263279
	speed: 0.2613s/iter; left time: 4730.3042s
Epoch: 13 cost time: 55.071351766586304
Epoch: 13, Steps: 208 | Train Loss: 0.305 Vali Loss: 8.042 Vali Acc: 0.097 Test Loss: 8.042 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.4573416
	speed: 0.5876s/iter; left time: 10574.2687s
	iters: 200, epoch: 14 | loss: 1.1288552
	speed: 0.2612s/iter; left time: 4675.3718s
Epoch: 14 cost time: 53.537983417510986
Epoch: 14, Steps: 208 | Train Loss: 0.277 Vali Loss: 8.400 Vali Acc: 0.097 Test Loss: 8.400 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1882500
	speed: 0.6308s/iter; left time: 11221.6676s
	iters: 200, epoch: 15 | loss: 0.1889372
	speed: 0.2782s/iter; left time: 4921.0132s
Epoch: 15 cost time: 58.269298791885376
Epoch: 15, Steps: 208 | Train Loss: 0.232 Vali Loss: 8.580 Vali Acc: 0.090 Test Loss: 8.580 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1025946913212049
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9105837
	speed: 0.2734s/iter; left time: 5659.5875s
	iters: 200, epoch: 1 | loss: 3.2040102
	speed: 0.2853s/iter; left time: 5877.8710s
Epoch: 1 cost time: 58.18961501121521
Epoch: 1, Steps: 208 | Train Loss: 3.668 Vali Loss: 3.545 Vali Acc: 0.072 Test Loss: 3.545 Test Acc: 0.072
Validation loss decreased (inf --> -0.072437).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9980733
	speed: 0.6537s/iter; left time: 13396.4423s
	iters: 200, epoch: 2 | loss: 3.3780267
	speed: 0.3320s/iter; left time: 6769.4667s
Epoch: 2 cost time: 65.7296929359436
Epoch: 2, Steps: 208 | Train Loss: 3.191 Vali Loss: 3.520 Vali Acc: 0.080 Test Loss: 3.520 Test Acc: 0.080
Validation loss decreased (-0.072437 --> -0.079595).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7439263
	speed: 0.8014s/iter; left time: 16256.3867s
	iters: 200, epoch: 3 | loss: 2.9234178
	speed: 0.3458s/iter; left time: 6980.8897s
Epoch: 3 cost time: 71.00574827194214
Epoch: 3, Steps: 208 | Train Loss: 2.667 Vali Loss: 3.722 Vali Acc: 0.080 Test Loss: 3.722 Test Acc: 0.080
Validation loss decreased (-0.079595 --> -0.079891).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1933153
	speed: 0.9113s/iter; left time: 18295.8482s
	iters: 200, epoch: 4 | loss: 2.8823535
	speed: 0.3612s/iter; left time: 7215.2077s
Epoch: 4 cost time: 75.33341431617737
Epoch: 4, Steps: 208 | Train Loss: 2.180 Vali Loss: 4.004 Vali Acc: 0.095 Test Loss: 4.004 Test Acc: 0.095
Validation loss decreased (-0.079891 --> -0.095397).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1058145
	speed: 0.8994s/iter; left time: 17870.8133s
	iters: 200, epoch: 5 | loss: 2.4731426
	speed: 0.3524s/iter; left time: 6966.0782s
Epoch: 5 cost time: 73.83930540084839
Epoch: 5, Steps: 208 | Train Loss: 1.689 Vali Loss: 4.315 Vali Acc: 0.092 Test Loss: 4.315 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9921755
	speed: 0.9179s/iter; left time: 18046.2930s
	iters: 200, epoch: 6 | loss: 1.7211354
	speed: 0.3399s/iter; left time: 6648.7677s
Epoch: 6 cost time: 72.97525787353516
Epoch: 6, Steps: 208 | Train Loss: 1.231 Vali Loss: 4.884 Vali Acc: 0.109 Test Loss: 4.884 Test Acc: 0.109
Validation loss decreased (-0.095397 --> -0.109107).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5174522
	speed: 0.8538s/iter; left time: 16609.9301s
	iters: 200, epoch: 7 | loss: 1.2922103
	speed: 0.3435s/iter; left time: 6647.8659s
Epoch: 7 cost time: 70.80642104148865
Epoch: 7, Steps: 208 | Train Loss: 0.916 Vali Loss: 5.526 Vali Acc: 0.092 Test Loss: 5.526 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9262323
	speed: 0.8934s/iter; left time: 17194.3002s
	iters: 200, epoch: 8 | loss: 0.4766849
	speed: 0.3706s/iter; left time: 7094.3211s
Epoch: 8 cost time: 75.20753788948059
Epoch: 8, Steps: 208 | Train Loss: 0.698 Vali Loss: 5.859 Vali Acc: 0.096 Test Loss: 5.859 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3755983
	speed: 0.9074s/iter; left time: 17274.8073s
	iters: 200, epoch: 9 | loss: 1.2275971
	speed: 0.3434s/iter; left time: 6503.1532s
Epoch: 9 cost time: 71.7273416519165
Epoch: 9, Steps: 208 | Train Loss: 0.543 Vali Loss: 6.465 Vali Acc: 0.105 Test Loss: 6.465 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1987941
	speed: 0.8411s/iter; left time: 15836.3649s
	iters: 200, epoch: 10 | loss: 0.4911731
	speed: 0.3184s/iter; left time: 5962.9556s
Epoch: 10 cost time: 66.7439239025116
Epoch: 10, Steps: 208 | Train Loss: 0.462 Vali Loss: 6.806 Vali Acc: 0.097 Test Loss: 6.806 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1566262
	speed: 0.8444s/iter; left time: 15723.8317s
	iters: 200, epoch: 11 | loss: 0.1616975
	speed: 0.3300s/iter; left time: 6112.6922s
Epoch: 11 cost time: 69.87160229682922
Epoch: 11, Steps: 208 | Train Loss: 0.386 Vali Loss: 7.200 Vali Acc: 0.095 Test Loss: 7.200 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1617558
	speed: 0.8859s/iter; left time: 16312.6775s
	iters: 200, epoch: 12 | loss: 0.4261653
	speed: 0.3550s/iter; left time: 6501.1154s
Epoch: 12 cost time: 73.83168339729309
Epoch: 12, Steps: 208 | Train Loss: 0.348 Vali Loss: 7.560 Vali Acc: 0.099 Test Loss: 7.560 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3044631
	speed: 0.8684s/iter; left time: 15808.9087s
	iters: 200, epoch: 13 | loss: 0.7884208
	speed: 0.3446s/iter; left time: 6238.4886s
Epoch: 13 cost time: 71.17514133453369
Epoch: 13, Steps: 208 | Train Loss: 0.294 Vali Loss: 7.837 Vali Acc: 0.095 Test Loss: 7.837 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0770658
	speed: 0.8703s/iter; left time: 15662.5455s
	iters: 200, epoch: 14 | loss: 0.7582804
	speed: 0.3376s/iter; left time: 6041.2679s
Epoch: 14 cost time: 71.11558198928833
Epoch: 14, Steps: 208 | Train Loss: 0.280 Vali Loss: 8.147 Vali Acc: 0.092 Test Loss: 8.147 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4896218
	speed: 0.8673s/iter; left time: 15428.0031s
	iters: 200, epoch: 15 | loss: 0.1305991
	speed: 0.3382s/iter; left time: 5981.5586s
Epoch: 15 cost time: 70.99761867523193
Epoch: 15, Steps: 208 | Train Loss: 0.237 Vali Loss: 8.453 Vali Acc: 0.093 Test Loss: 8.453 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1064769
	speed: 0.8612s/iter; left time: 15140.0866s
	iters: 200, epoch: 16 | loss: 0.0153131
	speed: 0.3445s/iter; left time: 6022.2111s
Epoch: 16 cost time: 70.94465065002441
Epoch: 16, Steps: 208 | Train Loss: 0.237 Vali Loss: 8.654 Vali Acc: 0.094 Test Loss: 8.654 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10915597971965404
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9424326
	speed: 0.3540s/iter; left time: 7327.4412s
	iters: 200, epoch: 1 | loss: 3.2970374
	speed: 0.3452s/iter; left time: 7112.3442s
Epoch: 1 cost time: 72.98286747932434
Epoch: 1, Steps: 208 | Train Loss: 3.667 Vali Loss: 3.514 Vali Acc: 0.068 Test Loss: 3.514 Test Acc: 0.068
Validation loss decreased (inf --> -0.068262).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3114080
	speed: 0.8475s/iter; left time: 17368.1599s
	iters: 200, epoch: 2 | loss: 3.3393283
	speed: 0.3267s/iter; left time: 6663.3839s
Epoch: 2 cost time: 68.44265604019165
Epoch: 2, Steps: 208 | Train Loss: 3.181 Vali Loss: 3.523 Vali Acc: 0.084 Test Loss: 3.523 Test Acc: 0.084
Validation loss decreased (-0.068262 --> -0.084367).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4802401
	speed: 0.9089s/iter; left time: 18437.2648s
	iters: 200, epoch: 3 | loss: 3.1659017
	speed: 0.3671s/iter; left time: 7409.7784s
Epoch: 3 cost time: 76.51446223258972
Epoch: 3, Steps: 208 | Train Loss: 2.664 Vali Loss: 3.722 Vali Acc: 0.089 Test Loss: 3.722 Test Acc: 0.089
Validation loss decreased (-0.084367 --> -0.089137).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9494871
	speed: 0.9896s/iter; left time: 19868.2761s
	iters: 200, epoch: 4 | loss: 2.5460827
	speed: 0.3772s/iter; left time: 7534.4256s
Epoch: 4 cost time: 80.46263694763184
Epoch: 4, Steps: 208 | Train Loss: 2.153 Vali Loss: 4.017 Vali Acc: 0.100 Test Loss: 4.017 Test Acc: 0.100
Validation loss decreased (-0.089137 --> -0.099572).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1283529
	speed: 0.9244s/iter; left time: 18367.5796s
	iters: 200, epoch: 5 | loss: 2.5948577
	speed: 0.3660s/iter; left time: 7234.7568s
Epoch: 5 cost time: 74.66381287574768
Epoch: 5, Steps: 208 | Train Loss: 1.680 Vali Loss: 4.361 Vali Acc: 0.097 Test Loss: 4.361 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0883832
	speed: 0.9314s/iter; left time: 18312.5978s
	iters: 200, epoch: 6 | loss: 1.7764798
	speed: 0.3446s/iter; left time: 6739.7830s
Epoch: 6 cost time: 72.2851767539978
Epoch: 6, Steps: 208 | Train Loss: 1.213 Vali Loss: 4.827 Vali Acc: 0.109 Test Loss: 4.827 Test Acc: 0.109
Validation loss decreased (-0.099572 --> -0.108511).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8550160
	speed: 0.9324s/iter; left time: 18137.5158s
	iters: 200, epoch: 7 | loss: 1.5582986
	speed: 0.3626s/iter; left time: 7017.1080s
Epoch: 7 cost time: 75.21225905418396
Epoch: 7, Steps: 208 | Train Loss: 0.918 Vali Loss: 5.401 Vali Acc: 0.098 Test Loss: 5.401 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6991427
	speed: 0.9598s/iter; left time: 18471.5308s
	iters: 200, epoch: 8 | loss: 1.1319473
	speed: 0.3852s/iter; left time: 7374.0051s
Epoch: 8 cost time: 81.58498239517212
Epoch: 8, Steps: 208 | Train Loss: 0.687 Vali Loss: 5.924 Vali Acc: 0.095 Test Loss: 5.924 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5325193
	speed: 0.9096s/iter; left time: 17316.3751s
	iters: 200, epoch: 9 | loss: 1.3790751
	speed: 0.3639s/iter; left time: 6890.2631s
Epoch: 9 cost time: 75.49113368988037
Epoch: 9, Steps: 208 | Train Loss: 0.557 Vali Loss: 6.376 Vali Acc: 0.106 Test Loss: 6.376 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.7884783
	speed: 0.9280s/iter; left time: 17473.7375s
	iters: 200, epoch: 10 | loss: 0.9131834
	speed: 0.3587s/iter; left time: 6717.4153s
Epoch: 10 cost time: 75.07716703414917
Epoch: 10, Steps: 208 | Train Loss: 0.501 Vali Loss: 6.623 Vali Acc: 0.089 Test Loss: 6.623 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2499633
	speed: 0.9562s/iter; left time: 17805.8915s
	iters: 200, epoch: 11 | loss: 0.4141407
	speed: 0.3464s/iter; left time: 6414.7940s
Epoch: 11 cost time: 74.80244517326355
Epoch: 11, Steps: 208 | Train Loss: 0.403 Vali Loss: 7.266 Vali Acc: 0.103 Test Loss: 7.266 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.3971370
	speed: 0.9678s/iter; left time: 17819.8903s
	iters: 200, epoch: 12 | loss: 0.8909329
	speed: 0.3673s/iter; left time: 6727.2611s
Epoch: 12 cost time: 78.65329837799072
Epoch: 12, Steps: 208 | Train Loss: 0.357 Vali Loss: 7.545 Vali Acc: 0.102 Test Loss: 7.545 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2016213
	speed: 1.0143s/iter; left time: 18464.9099s
	iters: 200, epoch: 13 | loss: 0.6885726
	speed: 0.3874s/iter; left time: 7013.4847s
Epoch: 13 cost time: 81.08402824401855
Epoch: 13, Steps: 208 | Train Loss: 0.300 Vali Loss: 7.677 Vali Acc: 0.096 Test Loss: 7.677 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2814106
	speed: 1.0282s/iter; left time: 18504.2988s
	iters: 200, epoch: 14 | loss: 0.5832412
	speed: 0.4035s/iter; left time: 7220.6649s
Epoch: 14 cost time: 85.69074368476868
Epoch: 14, Steps: 208 | Train Loss: 0.298 Vali Loss: 8.177 Vali Acc: 0.099 Test Loss: 8.177 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3646540
	speed: 0.9458s/iter; left time: 16824.8547s
	iters: 200, epoch: 15 | loss: 0.3269898
	speed: 0.3809s/iter; left time: 6738.2999s
Epoch: 15 cost time: 77.83732271194458
Epoch: 15, Steps: 208 | Train Loss: 0.234 Vali Loss: 8.560 Vali Acc: 0.105 Test Loss: 8.560 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0019670
	speed: 0.9570s/iter; left time: 16824.1543s
	iters: 200, epoch: 16 | loss: 0.0247384
	speed: 0.4004s/iter; left time: 7000.2196s
Epoch: 16 cost time: 79.73627996444702
Epoch: 16, Steps: 208 | Train Loss: 0.208 Vali Loss: 8.785 Vali Acc: 0.099 Test Loss: 8.785 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10855949895615867
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8881307
	speed: 0.3877s/iter; left time: 8025.9750s
	iters: 200, epoch: 1 | loss: 3.4335809
	speed: 0.3905s/iter; left time: 8043.7733s
Epoch: 1 cost time: 81.58123970031738
Epoch: 1, Steps: 208 | Train Loss: 3.639 Vali Loss: 3.543 Vali Acc: 0.067 Test Loss: 3.543 Test Acc: 0.067
Validation loss decreased (inf --> -0.066472).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9363084
	speed: 0.9904s/iter; left time: 20296.2012s
	iters: 200, epoch: 2 | loss: 3.3415651
	speed: 0.3638s/iter; left time: 7419.2255s
Epoch: 2 cost time: 77.08165907859802
Epoch: 2, Steps: 208 | Train Loss: 3.177 Vali Loss: 3.612 Vali Acc: 0.078 Test Loss: 3.612 Test Acc: 0.078
Validation loss decreased (-0.066472 --> -0.077506).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5785887
	speed: 0.9680s/iter; left time: 19635.4778s
	iters: 200, epoch: 3 | loss: 2.4827380
	speed: 0.3524s/iter; left time: 7112.8394s
Epoch: 3 cost time: 74.98332715034485
Epoch: 3, Steps: 208 | Train Loss: 2.686 Vali Loss: 3.858 Vali Acc: 0.077 Test Loss: 3.858 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2911377
	speed: 0.9547s/iter; left time: 19168.3504s
	iters: 200, epoch: 4 | loss: 2.2871096
	speed: 0.3785s/iter; left time: 7560.3106s
Epoch: 4 cost time: 79.93064045906067
Epoch: 4, Steps: 208 | Train Loss: 2.233 Vali Loss: 4.035 Vali Acc: 0.092 Test Loss: 4.035 Test Acc: 0.092
Validation loss decreased (-0.077506 --> -0.091818).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8658957
	speed: 0.9965s/iter; left time: 19800.3715s
	iters: 200, epoch: 5 | loss: 2.1951115
	speed: 0.3886s/iter; left time: 7683.1107s
Epoch: 5 cost time: 80.94468688964844
Epoch: 5, Steps: 208 | Train Loss: 1.742 Vali Loss: 4.335 Vali Acc: 0.102 Test Loss: 4.335 Test Acc: 0.102
Validation loss decreased (-0.091818 --> -0.102253).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6197807
	speed: 1.0411s/iter; left time: 20468.9503s
	iters: 200, epoch: 6 | loss: 1.9928037
	speed: 0.3835s/iter; left time: 7501.2516s
Epoch: 6 cost time: 81.8039219379425
Epoch: 6, Steps: 208 | Train Loss: 1.293 Vali Loss: 4.828 Vali Acc: 0.099 Test Loss: 4.828 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6889426
	speed: 1.0824s/iter; left time: 21055.0945s
	iters: 200, epoch: 7 | loss: 1.6730620
	speed: 0.3757s/iter; left time: 7271.8338s
Epoch: 7 cost time: 83.87440657615662
Epoch: 7, Steps: 208 | Train Loss: 0.960 Vali Loss: 5.203 Vali Acc: 0.096 Test Loss: 5.203 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0572642
	speed: 0.9832s/iter; left time: 18921.1207s
	iters: 200, epoch: 8 | loss: 0.8385054
	speed: 0.4051s/iter; left time: 7754.7203s
Epoch: 8 cost time: 82.70808696746826
Epoch: 8, Steps: 208 | Train Loss: 0.737 Vali Loss: 5.770 Vali Acc: 0.099 Test Loss: 5.770 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4581790
	speed: 0.9691s/iter; left time: 18448.5660s
	iters: 200, epoch: 9 | loss: 1.1690542
	speed: 0.3800s/iter; left time: 7196.1894s
Epoch: 9 cost time: 78.68490672111511
Epoch: 9, Steps: 208 | Train Loss: 0.611 Vali Loss: 6.148 Vali Acc: 0.106 Test Loss: 6.148 Test Acc: 0.106
Validation loss decreased (-0.102253 --> -0.106112).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7275466
	speed: 0.9956s/iter; left time: 18746.1144s
	iters: 200, epoch: 10 | loss: 0.5899987
	speed: 0.3892s/iter; left time: 7289.6953s
Epoch: 10 cost time: 80.6933286190033
Epoch: 10, Steps: 208 | Train Loss: 0.514 Vali Loss: 6.593 Vali Acc: 0.102 Test Loss: 6.593 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2721509
	speed: 0.9996s/iter; left time: 18614.4010s
	iters: 200, epoch: 11 | loss: 0.3357487
	speed: 0.4174s/iter; left time: 7731.3056s
Epoch: 11 cost time: 87.10581994056702
Epoch: 11, Steps: 208 | Train Loss: 0.440 Vali Loss: 7.082 Vali Acc: 0.106 Test Loss: 7.082 Test Acc: 0.106
Validation loss decreased (-0.106112 --> -0.106401).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1724747
	speed: 1.0310s/iter; left time: 18983.3987s
	iters: 200, epoch: 12 | loss: 0.4360738
	speed: 0.4097s/iter; left time: 7502.0529s
Epoch: 12 cost time: 84.49133253097534
Epoch: 12, Steps: 208 | Train Loss: 0.383 Vali Loss: 7.034 Vali Acc: 0.111 Test Loss: 7.034 Test Acc: 0.111
Validation loss decreased (-0.106401 --> -0.110875).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0131861
	speed: 1.0369s/iter; left time: 18876.7617s
	iters: 200, epoch: 13 | loss: 0.2882172
	speed: 0.3924s/iter; left time: 7104.0056s
Epoch: 13 cost time: 83.06750464439392
Epoch: 13, Steps: 208 | Train Loss: 0.330 Vali Loss: 7.575 Vali Acc: 0.107 Test Loss: 7.575 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7215771
	speed: 1.0591s/iter; left time: 19060.8921s
	iters: 200, epoch: 14 | loss: 0.3653585
	speed: 0.3979s/iter; left time: 7121.5457s
Epoch: 14 cost time: 84.34401965141296
Epoch: 14, Steps: 208 | Train Loss: 0.296 Vali Loss: 8.002 Vali Acc: 0.106 Test Loss: 8.002 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3983445
	speed: 1.0228s/iter; left time: 18194.1136s
	iters: 200, epoch: 15 | loss: 0.3547365
	speed: 0.3855s/iter; left time: 6819.0865s
Epoch: 15 cost time: 82.13507294654846
Epoch: 15, Steps: 208 | Train Loss: 0.241 Vali Loss: 8.270 Vali Acc: 0.112 Test Loss: 8.270 Test Acc: 0.112
Validation loss decreased (-0.110875 --> -0.112056).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0956337
	speed: 0.9868s/iter; left time: 17349.5325s
	iters: 200, epoch: 16 | loss: 0.1631424
	speed: 0.3986s/iter; left time: 6967.8986s
Epoch: 16 cost time: 82.98841953277588
Epoch: 16, Steps: 208 | Train Loss: 0.250 Vali Loss: 8.825 Vali Acc: 0.101 Test Loss: 8.825 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0179822
	speed: 1.0462s/iter; left time: 18175.5193s
	iters: 200, epoch: 17 | loss: 0.0650143
	speed: 0.4501s/iter; left time: 7774.4575s
Epoch: 17 cost time: 89.50374126434326
Epoch: 17, Steps: 208 | Train Loss: 0.231 Vali Loss: 8.650 Vali Acc: 0.095 Test Loss: 8.650 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2806886
	speed: 1.0333s/iter; left time: 17736.6108s
	iters: 200, epoch: 18 | loss: 0.2711729
	speed: 0.3971s/iter; left time: 6776.4600s
Epoch: 18 cost time: 80.99756455421448
Epoch: 18, Steps: 208 | Train Loss: 0.213 Vali Loss: 9.060 Vali Acc: 0.107 Test Loss: 9.060 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0592288
	speed: 0.9735s/iter; left time: 16507.9901s
	iters: 200, epoch: 19 | loss: 0.2485907
	speed: 0.3628s/iter; left time: 6115.4707s
Epoch: 19 cost time: 75.17643165588379
Epoch: 19, Steps: 208 | Train Loss: 0.198 Vali Loss: 9.288 Vali Acc: 0.096 Test Loss: 9.288 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5640165
	speed: 1.0365s/iter; left time: 17360.0417s
	iters: 200, epoch: 20 | loss: 0.1360432
	speed: 0.3822s/iter; left time: 6362.7965s
Epoch: 20 cost time: 84.38956832885742
Epoch: 20, Steps: 208 | Train Loss: 0.187 Vali Loss: 9.216 Vali Acc: 0.097 Test Loss: 9.216 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2439742
	speed: 0.9717s/iter; left time: 16073.4266s
	iters: 200, epoch: 21 | loss: 0.0534492
	speed: 0.3790s/iter; left time: 6231.0720s
Epoch: 21 cost time: 79.3214156627655
Epoch: 21, Steps: 208 | Train Loss: 0.150 Vali Loss: 9.488 Vali Acc: 0.103 Test Loss: 9.488 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2755539
	speed: 0.9334s/iter; left time: 15245.7892s
	iters: 200, epoch: 22 | loss: 0.0079008
	speed: 0.3741s/iter; left time: 6072.1518s
Epoch: 22 cost time: 76.51505255699158
Epoch: 22, Steps: 208 | Train Loss: 0.166 Vali Loss: 9.455 Vali Acc: 0.107 Test Loss: 9.455 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0751889
	speed: 1.0077s/iter; left time: 16249.4958s
	iters: 200, epoch: 23 | loss: 0.4740660
	speed: 0.3961s/iter; left time: 6346.7991s
Epoch: 23 cost time: 82.48828339576721
Epoch: 23, Steps: 208 | Train Loss: 0.170 Vali Loss: 9.702 Vali Acc: 0.100 Test Loss: 9.702 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1065818
	speed: 1.1316s/iter; left time: 18010.8925s
	iters: 200, epoch: 24 | loss: 0.2304476
	speed: 0.4041s/iter; left time: 6391.8309s
Epoch: 24 cost time: 88.02570295333862
Epoch: 24, Steps: 208 | Train Loss: 0.163 Vali Loss: 10.265 Vali Acc: 0.101 Test Loss: 10.265 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1363568
	speed: 0.9810s/iter; left time: 15411.0106s
	iters: 200, epoch: 25 | loss: 0.4719374
	speed: 0.3861s/iter; left time: 6026.8742s
Epoch: 25 cost time: 79.75100135803223
Epoch: 25, Steps: 208 | Train Loss: 0.158 Vali Loss: 10.175 Vali Acc: 0.098 Test Loss: 10.175 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11213838353713093
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6803544
	speed: 0.4120s/iter; left time: 8528.4693s
	iters: 200, epoch: 1 | loss: 3.1622007
	speed: 0.3870s/iter; left time: 7972.4973s
Epoch: 1 cost time: 83.23855996131897
Epoch: 1, Steps: 208 | Train Loss: 3.618 Vali Loss: 3.549 Vali Acc: 0.067 Test Loss: 3.549 Test Acc: 0.067
Validation loss decreased (inf --> -0.066472).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0361204
	speed: 1.0030s/iter; left time: 20554.4275s
	iters: 200, epoch: 2 | loss: 3.1200814
	speed: 0.4014s/iter; left time: 8185.9134s
Epoch: 2 cost time: 85.75967025756836
Epoch: 2, Steps: 208 | Train Loss: 3.120 Vali Loss: 3.740 Vali Acc: 0.069 Test Loss: 3.740 Test Acc: 0.069
Validation loss decreased (-0.066472 --> -0.069154).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5119915
	speed: 1.0202s/iter; left time: 20694.6684s
	iters: 200, epoch: 3 | loss: 2.6110852
	speed: 0.3873s/iter; left time: 7818.0090s
Epoch: 3 cost time: 82.55047869682312
Epoch: 3, Steps: 208 | Train Loss: 2.688 Vali Loss: 3.893 Vali Acc: 0.075 Test Loss: 3.893 Test Acc: 0.075
Validation loss decreased (-0.069154 --> -0.075416).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1886756
	speed: 1.0129s/iter; left time: 20335.6382s
	iters: 200, epoch: 4 | loss: 3.1306038
	speed: 0.4114s/iter; left time: 8217.6794s
Epoch: 4 cost time: 86.3670289516449
Epoch: 4, Steps: 208 | Train Loss: 2.340 Vali Loss: 3.994 Vali Acc: 0.101 Test Loss: 3.994 Test Acc: 0.101
Validation loss decreased (-0.075416 --> -0.100467).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1058249
	speed: 1.1225s/iter; left time: 22303.5045s
	iters: 200, epoch: 5 | loss: 2.1961627
	speed: 0.4170s/iter; left time: 8243.2239s
Epoch: 5 cost time: 87.70615029335022
Epoch: 5, Steps: 208 | Train Loss: 1.925 Vali Loss: 4.306 Vali Acc: 0.099 Test Loss: 4.306 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8121352
	speed: 1.0567s/iter; left time: 20775.5514s
	iters: 200, epoch: 6 | loss: 2.3278241
	speed: 0.3929s/iter; left time: 7685.1321s
Epoch: 6 cost time: 82.49096965789795
Epoch: 6, Steps: 208 | Train Loss: 1.485 Vali Loss: 4.605 Vali Acc: 0.106 Test Loss: 4.605 Test Acc: 0.106
Validation loss decreased (-0.100467 --> -0.106426).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6933235
	speed: 1.0234s/iter; left time: 19907.7348s
	iters: 200, epoch: 7 | loss: 1.8264138
	speed: 0.3891s/iter; left time: 7530.0684s
Epoch: 7 cost time: 82.56697869300842
Epoch: 7, Steps: 208 | Train Loss: 1.209 Vali Loss: 5.111 Vali Acc: 0.099 Test Loss: 5.111 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6469273
	speed: 1.0618s/iter; left time: 20433.8113s
	iters: 200, epoch: 8 | loss: 0.6125215
	speed: 0.4482s/iter; left time: 8580.3280s
Epoch: 8 cost time: 94.39670372009277
Epoch: 8, Steps: 208 | Train Loss: 0.948 Vali Loss: 5.405 Vali Acc: 0.095 Test Loss: 5.405 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4092194
	speed: 1.0165s/iter; left time: 19350.3053s
	iters: 200, epoch: 9 | loss: 0.8941736
	speed: 0.3794s/iter; left time: 7184.2960s
Epoch: 9 cost time: 83.87487816810608
Epoch: 9, Steps: 208 | Train Loss: 0.796 Vali Loss: 5.809 Vali Acc: 0.103 Test Loss: 5.809 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.7954754
	speed: 0.9484s/iter; left time: 17857.6675s
	iters: 200, epoch: 10 | loss: 0.5982154
	speed: 0.3752s/iter; left time: 7026.3690s
Epoch: 10 cost time: 76.95843172073364
Epoch: 10, Steps: 208 | Train Loss: 0.656 Vali Loss: 6.198 Vali Acc: 0.100 Test Loss: 6.198 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1051457
	speed: 0.9862s/iter; left time: 18363.1937s
	iters: 200, epoch: 11 | loss: 0.4245175
	speed: 0.3709s/iter; left time: 6870.2684s
Epoch: 11 cost time: 79.19933700561523
Epoch: 11, Steps: 208 | Train Loss: 0.563 Vali Loss: 6.470 Vali Acc: 0.095 Test Loss: 6.470 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4237533
	speed: 1.0596s/iter; left time: 19510.2486s
	iters: 200, epoch: 12 | loss: 0.8834815
	speed: 0.3669s/iter; left time: 6719.2025s
Epoch: 12 cost time: 82.33842086791992
Epoch: 12, Steps: 208 | Train Loss: 0.495 Vali Loss: 6.888 Vali Acc: 0.093 Test Loss: 6.888 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.8517988
	speed: 0.9691s/iter; left time: 17643.1663s
	iters: 200, epoch: 13 | loss: 0.5765870
	speed: 0.3652s/iter; left time: 6611.6611s
Epoch: 13 cost time: 77.27140140533447
Epoch: 13, Steps: 208 | Train Loss: 0.447 Vali Loss: 7.411 Vali Acc: 0.094 Test Loss: 7.411 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4316467
	speed: 0.9427s/iter; left time: 16965.8786s
	iters: 200, epoch: 14 | loss: 1.1049953
	speed: 0.3791s/iter; left time: 6784.8872s
Epoch: 14 cost time: 79.70422601699829
Epoch: 14, Steps: 208 | Train Loss: 0.410 Vali Loss: 7.468 Vali Acc: 0.101 Test Loss: 7.468 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3421973
	speed: 0.9900s/iter; left time: 17610.5669s
	iters: 200, epoch: 15 | loss: 0.2499563
	speed: 0.3879s/iter; left time: 6861.3628s
Epoch: 15 cost time: 79.88827443122864
Epoch: 15, Steps: 208 | Train Loss: 0.371 Vali Loss: 7.625 Vali Acc: 0.109 Test Loss: 7.625 Test Acc: 0.109
Validation loss decreased (-0.106426 --> -0.109378).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0795383
	speed: 0.9998s/iter; left time: 17577.1225s
	iters: 200, epoch: 16 | loss: 0.2578437
	speed: 0.3562s/iter; left time: 6226.9678s
Epoch: 16 cost time: 76.77038335800171
Epoch: 16, Steps: 208 | Train Loss: 0.357 Vali Loss: 8.187 Vali Acc: 0.091 Test Loss: 8.187 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4955763
	speed: 0.9829s/iter; left time: 17076.0532s
	iters: 200, epoch: 17 | loss: 0.2058562
	speed: 0.3498s/iter; left time: 6042.3632s
Epoch: 17 cost time: 75.8587281703949
Epoch: 17, Steps: 208 | Train Loss: 0.326 Vali Loss: 8.450 Vali Acc: 0.090 Test Loss: 8.450 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3041265
	speed: 0.9893s/iter; left time: 16980.5239s
	iters: 200, epoch: 18 | loss: 0.1358739
	speed: 0.4072s/iter; left time: 6948.8838s
Epoch: 18 cost time: 84.83133864402771
Epoch: 18, Steps: 208 | Train Loss: 0.287 Vali Loss: 8.653 Vali Acc: 0.101 Test Loss: 8.653 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3357320
	speed: 1.0013s/iter; left time: 16979.1398s
	iters: 200, epoch: 19 | loss: 0.8008231
	speed: 0.3988s/iter; left time: 6722.2816s
Epoch: 19 cost time: 84.56186842918396
Epoch: 19, Steps: 208 | Train Loss: 0.289 Vali Loss: 8.707 Vali Acc: 0.097 Test Loss: 8.707 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6459348
	speed: 1.0096s/iter; left time: 16909.1557s
	iters: 200, epoch: 20 | loss: 0.2875274
	speed: 0.4140s/iter; left time: 6892.9819s
Epoch: 20 cost time: 83.80563426017761
Epoch: 20, Steps: 208 | Train Loss: 0.258 Vali Loss: 8.958 Vali Acc: 0.105 Test Loss: 8.958 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3977606
	speed: 1.1325s/iter; left time: 18733.3493s
	iters: 200, epoch: 21 | loss: 0.1383816
	speed: 0.4162s/iter; left time: 6843.5646s
Epoch: 21 cost time: 88.59492802619934
Epoch: 21, Steps: 208 | Train Loss: 0.278 Vali Loss: 8.986 Vali Acc: 0.103 Test Loss: 8.986 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2116949
	speed: 1.0672s/iter; left time: 17430.8194s
	iters: 200, epoch: 22 | loss: 0.2013337
	speed: 0.3965s/iter; left time: 6436.2898s
Epoch: 22 cost time: 83.07252383232117
Epoch: 22, Steps: 208 | Train Loss: 0.226 Vali Loss: 9.386 Vali Acc: 0.101 Test Loss: 9.386 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.2003913
	speed: 0.9889s/iter; left time: 15946.4865s
	iters: 200, epoch: 23 | loss: 0.1374374
	speed: 0.3640s/iter; left time: 5832.4049s
Epoch: 23 cost time: 78.59437465667725
Epoch: 23, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.889 Vali Acc: 0.105 Test Loss: 9.889 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0300422
	speed: 0.9685s/iter; left time: 15415.4463s
	iters: 200, epoch: 24 | loss: 0.5060768
	speed: 0.3960s/iter; left time: 6263.9840s
Epoch: 24 cost time: 82.35177707672119
Epoch: 24, Steps: 208 | Train Loss: 0.211 Vali Loss: 9.743 Vali Acc: 0.105 Test Loss: 9.743 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.2763101
	speed: 0.9901s/iter; left time: 15553.4318s
	iters: 200, epoch: 25 | loss: 0.5236307
	speed: 0.3958s/iter; left time: 6178.0244s
Epoch: 25 cost time: 81.6779510974884
Epoch: 25, Steps: 208 | Train Loss: 0.218 Vali Loss: 9.635 Vali Acc: 0.101 Test Loss: 9.635 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7781301
	speed: 0.4178s/iter; left time: 8649.5498s
	iters: 200, epoch: 1 | loss: 3.2793269
	speed: 0.4101s/iter; left time: 8448.5663s
Epoch: 1 cost time: 86.71472907066345
Epoch: 1, Steps: 208 | Train Loss: 3.642 Vali Loss: 3.569 Vali Acc: 0.055 Test Loss: 3.569 Test Acc: 0.055
Validation loss decreased (inf --> -0.054542).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4578762
	speed: 1.0039s/iter; left time: 20573.7432s
	iters: 200, epoch: 2 | loss: 3.2630067
	speed: 0.3944s/iter; left time: 8042.2574s
Epoch: 2 cost time: 79.77659249305725
Epoch: 2, Steps: 208 | Train Loss: 3.213 Vali Loss: 3.803 Vali Acc: 0.057 Test Loss: 3.803 Test Acc: 0.057
Validation loss decreased (-0.054542 --> -0.057224).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7170260
	speed: 1.1362s/iter; left time: 23048.7553s
	iters: 200, epoch: 3 | loss: 2.8810432
	speed: 0.4444s/iter; left time: 8970.1075s
Epoch: 3 cost time: 93.94142961502075
Epoch: 3, Steps: 208 | Train Loss: 2.866 Vali Loss: 3.881 Vali Acc: 0.071 Test Loss: 3.881 Test Acc: 0.071
Validation loss decreased (-0.057224 --> -0.071241).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5512421
	speed: 1.1063s/iter; left time: 22212.0482s
	iters: 200, epoch: 4 | loss: 3.1651180
	speed: 0.4287s/iter; left time: 8564.4192s
Epoch: 4 cost time: 87.55792236328125
Epoch: 4, Steps: 208 | Train Loss: 2.563 Vali Loss: 4.028 Vali Acc: 0.083 Test Loss: 4.028 Test Acc: 0.083
Validation loss decreased (-0.071241 --> -0.083169).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4945157
	speed: 1.1586s/iter; left time: 23019.3006s
	iters: 200, epoch: 5 | loss: 2.9211521
	speed: 0.3980s/iter; left time: 7867.3979s
Epoch: 5 cost time: 88.80230903625488
Epoch: 5, Steps: 208 | Train Loss: 2.270 Vali Loss: 4.162 Vali Acc: 0.087 Test Loss: 4.162 Test Acc: 0.087
Validation loss decreased (-0.083169 --> -0.087045).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7328191
	speed: 1.0695s/iter; left time: 21028.3223s
	iters: 200, epoch: 6 | loss: 2.3625195
	speed: 0.3968s/iter; left time: 7761.2461s
Epoch: 6 cost time: 85.71052813529968
Epoch: 6, Steps: 208 | Train Loss: 1.920 Vali Loss: 4.438 Vali Acc: 0.086 Test Loss: 4.438 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3924735
	speed: 1.0290s/iter; left time: 20016.4327s
	iters: 200, epoch: 7 | loss: 2.4058602
	speed: 0.4077s/iter; left time: 7889.5402s
Epoch: 7 cost time: 87.09010863304138
Epoch: 7, Steps: 208 | Train Loss: 1.612 Vali Loss: 4.892 Vali Acc: 0.085 Test Loss: 4.892 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9282521
	speed: 1.0723s/iter; left time: 20636.4945s
	iters: 200, epoch: 8 | loss: 1.6929801
	speed: 0.4239s/iter; left time: 8115.6733s
Epoch: 8 cost time: 90.83288502693176
Epoch: 8, Steps: 208 | Train Loss: 1.353 Vali Loss: 5.155 Vali Acc: 0.080 Test Loss: 5.155 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0295388
	speed: 1.1028s/iter; left time: 20993.3853s
	iters: 200, epoch: 9 | loss: 1.2924191
	speed: 0.4079s/iter; left time: 7723.7588s
Epoch: 9 cost time: 88.89739990234375
Epoch: 9, Steps: 208 | Train Loss: 1.127 Vali Loss: 5.336 Vali Acc: 0.092 Test Loss: 5.336 Test Acc: 0.092
Validation loss decreased (-0.087045 --> -0.091506).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8739460
	speed: 0.9931s/iter; left time: 18698.8181s
	iters: 200, epoch: 10 | loss: 0.6677760
	speed: 0.4068s/iter; left time: 7618.9711s
Epoch: 10 cost time: 83.72311210632324
Epoch: 10, Steps: 208 | Train Loss: 0.941 Vali Loss: 5.791 Vali Acc: 0.089 Test Loss: 5.791 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2558618
	speed: 1.0541s/iter; left time: 19628.9860s
	iters: 200, epoch: 11 | loss: 0.8367932
	speed: 0.4084s/iter; left time: 7564.3065s
Epoch: 11 cost time: 85.1942310333252
Epoch: 11, Steps: 208 | Train Loss: 0.812 Vali Loss: 6.099 Vali Acc: 0.090 Test Loss: 6.099 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7569261
	speed: 1.0604s/iter; left time: 19524.5573s
	iters: 200, epoch: 12 | loss: 0.9929430
	speed: 0.4047s/iter; left time: 7410.5680s
Epoch: 12 cost time: 84.9693443775177
Epoch: 12, Steps: 208 | Train Loss: 0.690 Vali Loss: 6.410 Vali Acc: 0.085 Test Loss: 6.410 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1015779
	speed: 1.0643s/iter; left time: 19374.8924s
	iters: 200, epoch: 13 | loss: 1.2359090
	speed: 0.3902s/iter; left time: 7064.8477s
Epoch: 13 cost time: 86.20128583908081
Epoch: 13, Steps: 208 | Train Loss: 0.640 Vali Loss: 6.825 Vali Acc: 0.091 Test Loss: 6.825 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.7654339
	speed: 1.0969s/iter; left time: 19740.5110s
	iters: 200, epoch: 14 | loss: 0.8689472
	speed: 0.4166s/iter; left time: 7456.3543s
Epoch: 14 cost time: 89.3711290359497
Epoch: 14, Steps: 208 | Train Loss: 0.555 Vali Loss: 6.818 Vali Acc: 0.086 Test Loss: 6.818 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0357438
	speed: 1.0789s/iter; left time: 19192.7200s
	iters: 200, epoch: 15 | loss: 0.8409351
	speed: 0.3903s/iter; left time: 6903.4242s
Epoch: 15 cost time: 84.08331727981567
Epoch: 15, Steps: 208 | Train Loss: 0.487 Vali Loss: 7.231 Vali Acc: 0.097 Test Loss: 7.231 Test Acc: 0.097
Validation loss decreased (-0.091506 --> -0.097154).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1831799
	speed: 1.0589s/iter; left time: 18617.2846s
	iters: 200, epoch: 16 | loss: 0.6372832
	speed: 0.4151s/iter; left time: 7257.0049s
Epoch: 16 cost time: 87.74439144134521
Epoch: 16, Steps: 208 | Train Loss: 0.435 Vali Loss: 7.579 Vali Acc: 0.084 Test Loss: 7.579 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7715451
	speed: 1.0894s/iter; left time: 18925.8699s
	iters: 200, epoch: 17 | loss: 0.4040136
	speed: 0.4295s/iter; left time: 7418.3082s
Epoch: 17 cost time: 89.98553276062012
Epoch: 17, Steps: 208 | Train Loss: 0.410 Vali Loss: 7.572 Vali Acc: 0.089 Test Loss: 7.572 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1398791
	speed: 1.0849s/iter; left time: 18622.2519s
	iters: 200, epoch: 18 | loss: 0.3405730
	speed: 0.4434s/iter; left time: 7566.6333s
Epoch: 18 cost time: 93.28494715690613
Epoch: 18, Steps: 208 | Train Loss: 0.356 Vali Loss: 7.900 Vali Acc: 0.096 Test Loss: 7.900 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2414336
	speed: 1.1090s/iter; left time: 18805.2276s
	iters: 200, epoch: 19 | loss: 0.6236045
	speed: 0.4287s/iter; left time: 7226.8097s
Epoch: 19 cost time: 90.56384038925171
Epoch: 19, Steps: 208 | Train Loss: 0.357 Vali Loss: 8.225 Vali Acc: 0.088 Test Loss: 8.225 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4551325
	speed: 1.0308s/iter; left time: 17265.3791s
	iters: 200, epoch: 20 | loss: 0.3806367
	speed: 0.4356s/iter; left time: 7252.2879s
Epoch: 20 cost time: 88.20535206794739
Epoch: 20, Steps: 208 | Train Loss: 0.339 Vali Loss: 8.092 Vali Acc: 0.099 Test Loss: 8.092 Test Acc: 0.099
Validation loss decreased (-0.097154 --> -0.098935).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3000181
	speed: 1.0835s/iter; left time: 17922.9918s
	iters: 200, epoch: 21 | loss: 0.4378338
	speed: 0.4226s/iter; left time: 6947.8834s
Epoch: 21 cost time: 88.10533833503723
Epoch: 21, Steps: 208 | Train Loss: 0.301 Vali Loss: 8.373 Vali Acc: 0.101 Test Loss: 8.373 Test Acc: 0.101
Validation loss decreased (-0.098935 --> -0.100423).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2467564
	speed: 1.0764s/iter; left time: 17580.6395s
	iters: 200, epoch: 22 | loss: 0.6989688
	speed: 0.3963s/iter; left time: 6432.4444s
Epoch: 22 cost time: 83.06690001487732
Epoch: 22, Steps: 208 | Train Loss: 0.262 Vali Loss: 8.919 Vali Acc: 0.099 Test Loss: 8.919 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2027125
	speed: 1.0316s/iter; left time: 16634.7551s
	iters: 200, epoch: 23 | loss: 0.3233609
	speed: 0.3798s/iter; left time: 6086.2187s
Epoch: 23 cost time: 81.2459888458252
Epoch: 23, Steps: 208 | Train Loss: 0.264 Vali Loss: 8.911 Vali Acc: 0.098 Test Loss: 8.911 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0501342
	speed: 1.0877s/iter; left time: 17312.3228s
	iters: 200, epoch: 24 | loss: 0.0844097
	speed: 0.4438s/iter; left time: 7019.4197s
Epoch: 24 cost time: 93.486159324646
Epoch: 24, Steps: 208 | Train Loss: 0.235 Vali Loss: 9.077 Vali Acc: 0.090 Test Loss: 9.077 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.1295815
	speed: 1.0792s/iter; left time: 16953.0720s
	iters: 200, epoch: 25 | loss: 0.3882411
	speed: 0.4108s/iter; left time: 6412.3541s
Epoch: 25 cost time: 85.74997329711914
Epoch: 25, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.545 Vali Acc: 0.095 Test Loss: 9.545 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1426913
	speed: 1.0192s/iter; left time: 15799.3718s
	iters: 200, epoch: 26 | loss: 0.1364914
	speed: 0.4224s/iter; left time: 6506.0863s
Epoch: 26 cost time: 86.67092156410217
Epoch: 26, Steps: 208 | Train Loss: 0.240 Vali Loss: 9.552 Vali Acc: 0.101 Test Loss: 9.552 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.3692667
	speed: 1.0526s/iter; left time: 16097.9298s
	iters: 200, epoch: 27 | loss: 0.2554285
	speed: 0.4283s/iter; left time: 6506.8452s
Epoch: 27 cost time: 89.84952139854431
Epoch: 27, Steps: 208 | Train Loss: 0.212 Vali Loss: 9.613 Vali Acc: 0.092 Test Loss: 9.613 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.4290583
	speed: 1.0468s/iter; left time: 15791.4531s
	iters: 200, epoch: 28 | loss: 0.3515314
	speed: 0.4644s/iter; left time: 6959.0236s
Epoch: 28 cost time: 92.3521659374237
Epoch: 28, Steps: 208 | Train Loss: 0.212 Vali Loss: 9.690 Vali Acc: 0.098 Test Loss: 9.690 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.5864601
	speed: 1.1854s/iter; left time: 17635.7563s
	iters: 200, epoch: 29 | loss: 0.0373792
	speed: 0.4844s/iter; left time: 7158.6575s
Epoch: 29 cost time: 98.19825005531311
Epoch: 29, Steps: 208 | Train Loss: 0.222 Vali Loss: 9.749 Vali Acc: 0.102 Test Loss: 9.749 Test Acc: 0.102
Validation loss decreased (-0.100423 --> -0.102199).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0121102
	speed: 1.1373s/iter; left time: 16683.2658s
	iters: 200, epoch: 30 | loss: 0.3092690
	speed: 0.4794s/iter; left time: 6984.2821s
Epoch: 30 cost time: 96.75454998016357
Epoch: 30, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.288 Vali Acc: 0.100 Test Loss: 10.288 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0052645
	speed: 1.1913s/iter; left time: 17227.9563s
	iters: 200, epoch: 31 | loss: 0.0815320
	speed: 0.5132s/iter; left time: 7370.4834s
Epoch: 31 cost time: 101.59887266159058
Epoch: 31, Steps: 208 | Train Loss: 0.173 Vali Loss: 9.965 Vali Acc: 0.104 Test Loss: 9.965 Test Acc: 0.104
Validation loss decreased (-0.102199 --> -0.103986).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.1122311
	speed: 1.1890s/iter; left time: 16946.5542s
	iters: 200, epoch: 32 | loss: 0.2626868
	speed: 0.4604s/iter; left time: 6515.8722s
Epoch: 32 cost time: 94.71652507781982
Epoch: 32, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.102 Vali Acc: 0.099 Test Loss: 10.102 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0128682
	speed: 1.1463s/iter; left time: 16099.6262s
	iters: 200, epoch: 33 | loss: 0.0546422
	speed: 0.4954s/iter; left time: 6908.2174s
Epoch: 33 cost time: 100.3950207233429
Epoch: 33, Steps: 208 | Train Loss: 0.174 Vali Loss: 10.265 Vali Acc: 0.098 Test Loss: 10.265 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0308989
	speed: 1.2018s/iter; left time: 16629.0249s
	iters: 200, epoch: 34 | loss: 0.1404207
	speed: 0.4461s/iter; left time: 6127.9241s
Epoch: 34 cost time: 95.40355348587036
Epoch: 34, Steps: 208 | Train Loss: 0.155 Vali Loss: 10.065 Vali Acc: 0.098 Test Loss: 10.065 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.2202700
	speed: 1.2209s/iter; left time: 16640.0616s
	iters: 200, epoch: 35 | loss: 0.3435764
	speed: 0.5322s/iter; left time: 7199.4695s
Epoch: 35 cost time: 110.02435827255249
Epoch: 35, Steps: 208 | Train Loss: 0.169 Vali Loss: 10.163 Vali Acc: 0.103 Test Loss: 10.163 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0535064
	speed: 1.2040s/iter; left time: 16158.2519s
	iters: 200, epoch: 36 | loss: 0.1679152
	speed: 0.5029s/iter; left time: 6698.5465s
Epoch: 36 cost time: 102.5303750038147
Epoch: 36, Steps: 208 | Train Loss: 0.166 Vali Loss: 10.665 Vali Acc: 0.096 Test Loss: 10.665 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.2780371
	speed: 1.2966s/iter; left time: 17131.8724s
	iters: 200, epoch: 37 | loss: 0.4258957
	speed: 0.5698s/iter; left time: 7472.3006s
Epoch: 37 cost time: 116.34125447273254
Epoch: 37, Steps: 208 | Train Loss: 0.144 Vali Loss: 10.238 Vali Acc: 0.098 Test Loss: 10.238 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.1513545
	speed: 1.3716s/iter; left time: 17837.7034s
	iters: 200, epoch: 38 | loss: 0.0118494
	speed: 0.4667s/iter; left time: 6022.9655s
Epoch: 38 cost time: 103.25633883476257
Epoch: 38, Steps: 208 | Train Loss: 0.147 Vali Loss: 11.347 Vali Acc: 0.094 Test Loss: 11.347 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.1367803
	speed: 1.4070s/iter; left time: 18005.7345s
	iters: 200, epoch: 39 | loss: 0.4068902
	speed: 0.5032s/iter; left time: 6389.2331s
Epoch: 39 cost time: 116.38970613479614
Epoch: 39, Steps: 208 | Train Loss: 0.133 Vali Loss: 10.799 Vali Acc: 0.096 Test Loss: 10.799 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.4548877
	speed: 1.3892s/iter; left time: 17488.5164s
	iters: 200, epoch: 40 | loss: 0.1224685
	speed: 0.5264s/iter; left time: 6574.5611s
Epoch: 40 cost time: 111.37893843650818
Epoch: 40, Steps: 208 | Train Loss: 0.132 Vali Loss: 11.064 Vali Acc: 0.096 Test Loss: 11.064 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.3895321
	speed: 1.4223s/iter; left time: 17610.0650s
	iters: 200, epoch: 41 | loss: 0.1816923
	speed: 0.5591s/iter; left time: 6865.8825s
Epoch: 41 cost time: 118.37462735176086
Epoch: 41, Steps: 208 | Train Loss: 0.153 Vali Loss: 11.055 Vali Acc: 0.100 Test Loss: 11.055 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10408589322994334
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8631608
	speed: 0.4994s/iter; left time: 10338.5034s
	iters: 200, epoch: 1 | loss: 3.5835028
	speed: 0.4806s/iter; left time: 9900.5415s
Epoch: 1 cost time: 102.55987429618835
Epoch: 1, Steps: 208 | Train Loss: 3.675 Vali Loss: 3.738 Vali Acc: 0.044 Test Loss: 3.738 Test Acc: 0.044
Validation loss decreased (inf --> -0.043506).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2571874
	speed: 1.3738s/iter; left time: 28153.3458s
	iters: 200, epoch: 2 | loss: 3.4147911
	speed: 0.5879s/iter; left time: 11988.5546s
Epoch: 2 cost time: 120.33502173423767
Epoch: 2, Steps: 208 | Train Loss: 3.298 Vali Loss: 4.147 Vali Acc: 0.037 Test Loss: 4.147 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.6868401
	speed: 1.4465s/iter; left time: 29342.5174s
	iters: 200, epoch: 3 | loss: 3.1955044
	speed: 0.5726s/iter; left time: 11557.7616s
Epoch: 3 cost time: 122.40226650238037
Epoch: 3, Steps: 208 | Train Loss: 3.021 Vali Loss: 4.266 Vali Acc: 0.047 Test Loss: 4.266 Test Acc: 0.047
Validation loss decreased (-0.043506 --> -0.046781).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0049644
	speed: 1.3602s/iter; left time: 27308.6279s
	iters: 200, epoch: 4 | loss: 2.9016311
	speed: 0.5400s/iter; left time: 10786.6734s
Epoch: 4 cost time: 115.31923484802246
Epoch: 4, Steps: 208 | Train Loss: 2.821 Vali Loss: 4.510 Vali Acc: 0.049 Test Loss: 4.510 Test Acc: 0.049
Validation loss decreased (-0.046781 --> -0.048866).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1836207
	speed: 1.3795s/iter; left time: 27409.7995s
	iters: 200, epoch: 5 | loss: 3.1029277
	speed: 0.5827s/iter; left time: 11518.8296s
Epoch: 5 cost time: 118.72185826301575
Epoch: 5, Steps: 208 | Train Loss: 2.586 Vali Loss: 4.633 Vali Acc: 0.056 Test Loss: 4.633 Test Acc: 0.056
Validation loss decreased (-0.048866 --> -0.055725).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6131248
	speed: 1.4083s/iter; left time: 27688.1095s
	iters: 200, epoch: 6 | loss: 2.3816028
	speed: 0.5609s/iter; left time: 10971.9525s
Epoch: 6 cost time: 116.25402164459229
Epoch: 6, Steps: 208 | Train Loss: 2.318 Vali Loss: 4.762 Vali Acc: 0.060 Test Loss: 4.762 Test Acc: 0.060
Validation loss decreased (-0.055725 --> -0.059899).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8166711
	speed: 1.3418s/iter; left time: 26101.7531s
	iters: 200, epoch: 7 | loss: 2.9409242
	speed: 0.5397s/iter; left time: 10444.7870s
Epoch: 7 cost time: 113.02454876899719
Epoch: 7, Steps: 208 | Train Loss: 2.095 Vali Loss: 4.978 Vali Acc: 0.065 Test Loss: 4.978 Test Acc: 0.065
Validation loss decreased (-0.059899 --> -0.064967).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5990944
	speed: 1.4863s/iter; left time: 28604.5192s
	iters: 200, epoch: 8 | loss: 1.7616489
	speed: 0.5349s/iter; left time: 10239.8570s
Epoch: 8 cost time: 117.13872957229614
Epoch: 8, Steps: 208 | Train Loss: 1.826 Vali Loss: 5.189 Vali Acc: 0.066 Test Loss: 5.189 Test Acc: 0.066
Validation loss decreased (-0.064967 --> -0.066157).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6643088
	speed: 1.3896s/iter; left time: 26452.9000s
	iters: 200, epoch: 9 | loss: 1.5629363
	speed: 0.5694s/iter; left time: 10782.5810s
Epoch: 9 cost time: 115.03230786323547
Epoch: 9, Steps: 208 | Train Loss: 1.534 Vali Loss: 5.822 Vali Acc: 0.069 Test Loss: 5.822 Test Acc: 0.069
Validation loss decreased (-0.066157 --> -0.069432).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0247433
	speed: 1.4595s/iter; left time: 27480.9295s
	iters: 200, epoch: 10 | loss: 1.3736213
	speed: 0.5442s/iter; left time: 10193.1485s
Epoch: 10 cost time: 118.01575803756714
Epoch: 10, Steps: 208 | Train Loss: 1.307 Vali Loss: 5.905 Vali Acc: 0.077 Test Loss: 5.905 Test Acc: 0.077
Validation loss decreased (-0.069432 --> -0.076887).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3629602
	speed: 1.4374s/iter; left time: 26765.1913s
	iters: 200, epoch: 11 | loss: 1.1747184
	speed: 0.5917s/iter; left time: 10958.4397s
Epoch: 11 cost time: 125.31726861000061
Epoch: 11, Steps: 208 | Train Loss: 1.090 Vali Loss: 6.270 Vali Acc: 0.076 Test Loss: 6.270 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3661809
	speed: 1.4478s/iter; left time: 26658.8073s
	iters: 200, epoch: 12 | loss: 1.4323757
	speed: 0.5727s/iter; left time: 10487.0947s
Epoch: 12 cost time: 117.58178758621216
Epoch: 12, Steps: 208 | Train Loss: 0.937 Vali Loss: 6.599 Vali Acc: 0.073 Test Loss: 6.599 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1994525
	speed: 1.4745s/iter; left time: 26843.3150s
	iters: 200, epoch: 13 | loss: 1.3770595
	speed: 0.5749s/iter; left time: 10407.6648s
Epoch: 13 cost time: 121.02214574813843
Epoch: 13, Steps: 208 | Train Loss: 0.772 Vali Loss: 7.162 Vali Acc: 0.071 Test Loss: 7.162 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8492063
	speed: 1.5012s/iter; left time: 27017.4016s
	iters: 200, epoch: 14 | loss: 1.1780621
	speed: 0.5927s/iter; left time: 10607.4598s
Epoch: 14 cost time: 121.40697360038757
Epoch: 14, Steps: 208 | Train Loss: 0.668 Vali Loss: 7.119 Vali Acc: 0.078 Test Loss: 7.119 Test Acc: 0.078
Validation loss decreased (-0.076887 --> -0.078068).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0736865
	speed: 1.4714s/iter; left time: 26174.7280s
	iters: 200, epoch: 15 | loss: 0.9079648
	speed: 0.5840s/iter; left time: 10330.4166s
Epoch: 15 cost time: 127.67199563980103
Epoch: 15, Steps: 208 | Train Loss: 0.600 Vali Loss: 7.379 Vali Acc: 0.083 Test Loss: 7.379 Test Acc: 0.083
Validation loss decreased (-0.078068 --> -0.082837).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6899815
	speed: 1.4774s/iter; left time: 25973.3661s
	iters: 200, epoch: 16 | loss: 0.6864036
	speed: 0.6970s/iter; left time: 12185.0618s
Epoch: 16 cost time: 136.3770751953125
Epoch: 16, Steps: 208 | Train Loss: 0.532 Vali Loss: 7.890 Vali Acc: 0.078 Test Loss: 7.890 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7130579
	speed: 1.5544s/iter; left time: 27004.5353s
	iters: 200, epoch: 17 | loss: 0.7131388
	speed: 0.5974s/iter; left time: 10318.8089s
Epoch: 17 cost time: 123.25692462921143
Epoch: 17, Steps: 208 | Train Loss: 0.470 Vali Loss: 8.018 Vali Acc: 0.081 Test Loss: 8.018 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0812294
	speed: 1.5206s/iter; left time: 26100.4051s
	iters: 200, epoch: 18 | loss: 0.2325025
	speed: 0.6631s/iter; left time: 11316.5028s
Epoch: 18 cost time: 130.16474890708923
Epoch: 18, Steps: 208 | Train Loss: 0.436 Vali Loss: 8.425 Vali Acc: 0.083 Test Loss: 8.425 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3398676
	speed: 1.5445s/iter; left time: 26189.3853s
	iters: 200, epoch: 19 | loss: 0.5545975
	speed: 0.5675s/iter; left time: 9566.0011s
Epoch: 19 cost time: 119.5403368473053
Epoch: 19, Steps: 208 | Train Loss: 0.401 Vali Loss: 8.375 Vali Acc: 0.079 Test Loss: 8.375 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5727762
	speed: 1.5168s/iter; left time: 25404.4203s
	iters: 200, epoch: 20 | loss: 0.6851339
	speed: 0.6042s/iter; left time: 10058.8948s
Epoch: 20 cost time: 131.3532259464264
Epoch: 20, Steps: 208 | Train Loss: 0.369 Vali Loss: 8.527 Vali Acc: 0.089 Test Loss: 8.527 Test Acc: 0.089
Validation loss decreased (-0.082837 --> -0.088492).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3832214
	speed: 1.6259s/iter; left time: 26893.8433s
	iters: 200, epoch: 21 | loss: 0.3903054
	speed: 0.5540s/iter; left time: 9108.5370s
Epoch: 21 cost time: 122.91590881347656
Epoch: 21, Steps: 208 | Train Loss: 0.323 Vali Loss: 8.760 Vali Acc: 0.090 Test Loss: 8.760 Test Acc: 0.090
Validation loss decreased (-0.088492 --> -0.089683).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2789218
	speed: 1.4862s/iter; left time: 24274.2506s
	iters: 200, epoch: 22 | loss: 0.6946112
	speed: 0.6342s/iter; left time: 10295.2108s
Epoch: 22 cost time: 130.5895357131958
Epoch: 22, Steps: 208 | Train Loss: 0.325 Vali Loss: 8.873 Vali Acc: 0.081 Test Loss: 8.873 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3207566
	speed: 1.5669s/iter; left time: 25266.1019s
	iters: 200, epoch: 23 | loss: 0.3358944
	speed: 0.5967s/iter; left time: 9561.5399s
Epoch: 23 cost time: 131.84043407440186
Epoch: 23, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.900 Vali Acc: 0.088 Test Loss: 8.900 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0633555
	speed: 1.4842s/iter; left time: 23623.3270s
	iters: 200, epoch: 24 | loss: 0.2391205
	speed: 0.6514s/iter; left time: 10303.3418s
Epoch: 24 cost time: 130.2253704071045
Epoch: 24, Steps: 208 | Train Loss: 0.281 Vali Loss: 9.257 Vali Acc: 0.084 Test Loss: 9.257 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0953563
	speed: 1.5089s/iter; left time: 23702.9736s
	iters: 200, epoch: 25 | loss: 0.3579955
	speed: 0.6137s/iter; left time: 9578.4822s
Epoch: 25 cost time: 128.38472414016724
Epoch: 25, Steps: 208 | Train Loss: 0.232 Vali Loss: 9.627 Vali Acc: 0.080 Test Loss: 9.627 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2493902
	speed: 1.4311s/iter; left time: 22182.8541s
	iters: 200, epoch: 26 | loss: 0.0137025
	speed: 0.6204s/iter; left time: 9554.8750s
Epoch: 26 cost time: 125.72839403152466
Epoch: 26, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.595 Vali Acc: 0.086 Test Loss: 9.595 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1386678
	speed: 1.6895s/iter; left time: 25836.9902s
	iters: 200, epoch: 27 | loss: 0.4174239
	speed: 0.6268s/iter; left time: 9523.6882s
Epoch: 27 cost time: 137.01907324790955
Epoch: 27, Steps: 208 | Train Loss: 0.236 Vali Loss: 9.957 Vali Acc: 0.092 Test Loss: 9.957 Test Acc: 0.092
Validation loss decreased (-0.089683 --> -0.091460).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.1530380
	speed: 1.5094s/iter; left time: 22769.4637s
	iters: 200, epoch: 28 | loss: 0.1308013
	speed: 0.6083s/iter; left time: 9115.0214s
Epoch: 28 cost time: 124.8606858253479
Epoch: 28, Steps: 208 | Train Loss: 0.219 Vali Loss: 9.817 Vali Acc: 0.084 Test Loss: 9.817 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.5387588
	speed: 1.5236s/iter; left time: 22667.1997s
	iters: 200, epoch: 29 | loss: 0.1649541
	speed: 0.6392s/iter; left time: 9445.6155s
Epoch: 29 cost time: 129.77909541130066
Epoch: 29, Steps: 208 | Train Loss: 0.206 Vali Loss: 10.034 Vali Acc: 0.097 Test Loss: 10.034 Test Acc: 0.097
Validation loss decreased (-0.091460 --> -0.096530).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0988984
	speed: 1.5169s/iter; left time: 22251.8641s
	iters: 200, epoch: 30 | loss: 0.0703093
	speed: 0.7127s/iter; left time: 10383.0480s
Epoch: 30 cost time: 140.46871256828308
Epoch: 30, Steps: 208 | Train Loss: 0.209 Vali Loss: 10.171 Vali Acc: 0.090 Test Loss: 10.171 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.1995671
	speed: 1.5682s/iter; left time: 22677.0517s
	iters: 200, epoch: 31 | loss: 0.2140591
	speed: 0.5867s/iter; left time: 8426.2071s
Epoch: 31 cost time: 124.58307456970215
Epoch: 31, Steps: 208 | Train Loss: 0.192 Vali Loss: 10.298 Vali Acc: 0.094 Test Loss: 10.298 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0320511
	speed: 1.4731s/iter; left time: 20996.1367s
	iters: 200, epoch: 32 | loss: 0.3078125
	speed: 0.5998s/iter; left time: 8488.9095s
Epoch: 32 cost time: 125.60431408882141
Epoch: 32, Steps: 208 | Train Loss: 0.156 Vali Loss: 10.572 Vali Acc: 0.094 Test Loss: 10.572 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0102490
	speed: 1.4132s/iter; left time: 19848.0717s
	iters: 200, epoch: 33 | loss: 0.2249529
	speed: 0.5439s/iter; left time: 7584.6780s
Epoch: 33 cost time: 116.15965437889099
Epoch: 33, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.567 Vali Acc: 0.092 Test Loss: 10.567 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0556088
	speed: 1.4903s/iter; left time: 20621.5846s
	iters: 200, epoch: 34 | loss: 0.2878836
	speed: 0.6131s/iter; left time: 8422.8236s
Epoch: 34 cost time: 125.34206223487854
Epoch: 34, Steps: 208 | Train Loss: 0.174 Vali Loss: 10.542 Vali Acc: 0.095 Test Loss: 10.542 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.3674927
	speed: 1.5207s/iter; left time: 20725.5892s
	iters: 200, epoch: 35 | loss: 0.2638751
	speed: 0.5872s/iter; left time: 7943.6939s
Epoch: 35 cost time: 123.04138660430908
Epoch: 35, Steps: 208 | Train Loss: 0.164 Vali Loss: 10.708 Vali Acc: 0.087 Test Loss: 10.708 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.2198972
	speed: 1.5318s/iter; left time: 20557.6841s
	iters: 200, epoch: 36 | loss: 0.2691604
	speed: 0.6754s/iter; left time: 8996.5457s
Epoch: 36 cost time: 133.6927936077118
Epoch: 36, Steps: 208 | Train Loss: 0.166 Vali Loss: 10.601 Vali Acc: 0.088 Test Loss: 10.601 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.1949017
	speed: 1.4930s/iter; left time: 19727.1650s
	iters: 200, epoch: 37 | loss: 0.2399223
	speed: 0.6505s/iter; left time: 8530.5703s
Epoch: 37 cost time: 128.99277877807617
Epoch: 37, Steps: 208 | Train Loss: 0.151 Vali Loss: 10.990 Vali Acc: 0.097 Test Loss: 10.990 Test Acc: 0.097
Validation loss decreased (-0.096530 --> -0.097116).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.1330528
	speed: 1.4694s/iter; left time: 19110.0511s
	iters: 200, epoch: 38 | loss: 0.0713379
	speed: 0.5635s/iter; left time: 7272.4903s
Epoch: 38 cost time: 120.55371880531311
Epoch: 38, Steps: 208 | Train Loss: 0.170 Vali Loss: 11.281 Vali Acc: 0.089 Test Loss: 11.281 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.2549804
	speed: 1.3873s/iter; left time: 17752.9274s
	iters: 200, epoch: 39 | loss: 0.4914171
	speed: 0.6021s/iter; left time: 7644.9928s
Epoch: 39 cost time: 117.44112825393677
Epoch: 39, Steps: 208 | Train Loss: 0.142 Vali Loss: 11.052 Vali Acc: 0.095 Test Loss: 11.052 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.3422113
	speed: 1.6105s/iter; left time: 20274.3738s
	iters: 200, epoch: 40 | loss: 0.0060748
	speed: 0.6070s/iter; left time: 7580.8713s
Epoch: 40 cost time: 124.67654538154602
Epoch: 40, Steps: 208 | Train Loss: 0.156 Vali Loss: 11.340 Vali Acc: 0.089 Test Loss: 11.340 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.2225332
	speed: 1.5085s/iter; left time: 18677.1269s
	iters: 200, epoch: 41 | loss: 0.1947223
	speed: 0.6180s/iter; left time: 7589.9865s
Epoch: 41 cost time: 124.18426322937012
Epoch: 41, Steps: 208 | Train Loss: 0.119 Vali Loss: 11.072 Vali Acc: 0.095 Test Loss: 11.072 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.0067794
	speed: 1.6250s/iter; left time: 19781.3241s
	iters: 200, epoch: 42 | loss: 0.0600505
	speed: 0.5341s/iter; left time: 6448.5628s
Epoch: 42 cost time: 122.66144895553589
Epoch: 42, Steps: 208 | Train Loss: 0.125 Vali Loss: 11.255 Vali Acc: 0.093 Test Loss: 11.255 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 0.3905278
	speed: 1.4721s/iter; left time: 17614.0184s
	iters: 200, epoch: 43 | loss: 0.4214453
	speed: 0.6390s/iter; left time: 7581.8810s
Epoch: 43 cost time: 130.85264015197754
Epoch: 43, Steps: 208 | Train Loss: 0.110 Vali Loss: 11.478 Vali Acc: 0.100 Test Loss: 11.478 Test Acc: 0.100
Validation loss decreased (-0.097116 --> -0.100094).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0401893
	speed: 1.5567s/iter; left time: 18302.1184s
	iters: 200, epoch: 44 | loss: 0.2268480
	speed: 0.6144s/iter; left time: 7162.2528s
Epoch: 44 cost time: 130.33135867118835
Epoch: 44, Steps: 208 | Train Loss: 0.133 Vali Loss: 11.380 Vali Acc: 0.096 Test Loss: 11.380 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.0052020
	speed: 1.3757s/iter; left time: 15888.2376s
	iters: 200, epoch: 45 | loss: 0.0377913
	speed: 0.6281s/iter; left time: 7190.6067s
Epoch: 45 cost time: 123.48273611068726
Epoch: 45, Steps: 208 | Train Loss: 0.161 Vali Loss: 11.479 Vali Acc: 0.090 Test Loss: 11.479 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.0228291
	speed: 1.6294s/iter; left time: 18479.0967s
	iters: 200, epoch: 46 | loss: 0.0877139
	speed: 0.6663s/iter; left time: 7490.1838s
Epoch: 46 cost time: 133.66201972961426
Epoch: 46, Steps: 208 | Train Loss: 0.112 Vali Loss: 11.820 Vali Acc: 0.093 Test Loss: 11.820 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.2342976
	speed: 1.5164s/iter; left time: 16882.1948s
	iters: 200, epoch: 47 | loss: 0.2412234
	speed: 0.5807s/iter; left time: 6406.3843s
Epoch: 47 cost time: 121.52520322799683
Epoch: 47, Steps: 208 | Train Loss: 0.114 Vali Loss: 11.552 Vali Acc: 0.099 Test Loss: 11.552 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.0326681
	speed: 1.4885s/iter; left time: 16261.6955s
	iters: 200, epoch: 48 | loss: 0.0364694
	speed: 0.6104s/iter; left time: 6607.7197s
Epoch: 48 cost time: 130.95435547828674
Epoch: 48, Steps: 208 | Train Loss: 0.124 Vali Loss: 10.736 Vali Acc: 0.092 Test Loss: 10.736 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.1159007
	speed: 1.5449s/iter; left time: 16556.8482s
	iters: 200, epoch: 49 | loss: 0.0795944
	speed: 0.5544s/iter; left time: 5886.0754s
Epoch: 49 cost time: 119.92083501815796
Epoch: 49, Steps: 208 | Train Loss: 0.100 Vali Loss: 12.227 Vali Acc: 0.085 Test Loss: 12.227 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.3228423
	speed: 1.7908s/iter; left time: 18819.6983s
	iters: 200, epoch: 50 | loss: 0.0366147
	speed: 0.6330s/iter; left time: 6588.7088s
Epoch: 50 cost time: 137.48377585411072
Epoch: 50, Steps: 208 | Train Loss: 0.095 Vali Loss: 11.763 Vali Acc: 0.096 Test Loss: 11.763 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 0.0034232
	speed: 1.5554s/iter; left time: 16022.4351s
	iters: 200, epoch: 51 | loss: 0.0139727
	speed: 0.5953s/iter; left time: 6072.1600s
Epoch: 51 cost time: 125.51171922683716
Epoch: 51, Steps: 208 | Train Loss: 0.095 Vali Loss: 12.141 Vali Acc: 0.092 Test Loss: 12.141 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 0.0620108
	speed: 1.6686s/iter; left time: 16840.7974s
	iters: 200, epoch: 52 | loss: 0.0991635
	speed: 0.5889s/iter; left time: 5884.7434s
Epoch: 52 cost time: 133.60219860076904
Epoch: 52, Steps: 208 | Train Loss: 0.105 Vali Loss: 12.037 Vali Acc: 0.100 Test Loss: 12.037 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 0.2202078
	speed: 1.5950s/iter; left time: 15766.9178s
	iters: 200, epoch: 53 | loss: 0.0019004
	speed: 0.6689s/iter; left time: 6545.0823s
Epoch: 53 cost time: 137.1308126449585
Epoch: 53, Steps: 208 | Train Loss: 0.105 Vali Loss: 11.656 Vali Acc: 0.093 Test Loss: 11.656 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10020876826722339
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7732766
	speed: 0.5984s/iter; left time: 12388.3639s
	iters: 200, epoch: 1 | loss: 3.3481851
	speed: 0.5094s/iter; left time: 10494.3908s
Epoch: 1 cost time: 115.29262137413025
Epoch: 1, Steps: 208 | Train Loss: 3.694 Vali Loss: 4.337 Vali Acc: 0.029 Test Loss: 4.337 Test Acc: 0.029
Validation loss decreased (inf --> -0.028886).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1863344
	speed: 1.4879s/iter; left time: 30492.1596s
	iters: 200, epoch: 2 | loss: 3.1680124
	speed: 0.6100s/iter; left time: 12440.4539s
Epoch: 2 cost time: 129.54885053634644
Epoch: 2, Steps: 208 | Train Loss: 3.376 Vali Loss: 5.110 Vali Acc: 0.033 Test Loss: 5.110 Test Acc: 0.033
Validation loss decreased (-0.028886 --> -0.033352).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2283659
	speed: 1.5957s/iter; left time: 32369.6763s
	iters: 200, epoch: 3 | loss: 3.2910428
	speed: 0.5343s/iter; left time: 10785.1491s
Epoch: 3 cost time: 122.95900273323059
Epoch: 3, Steps: 208 | Train Loss: 3.141 Vali Loss: 5.210 Vali Acc: 0.038 Test Loss: 5.210 Test Acc: 0.038
Validation loss decreased (-0.033352 --> -0.037526).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2499413
	speed: 1.4555s/iter; left time: 29222.3544s
	iters: 200, epoch: 4 | loss: 3.2737885
	speed: 0.5892s/iter; left time: 11769.9349s
Epoch: 4 cost time: 120.91518688201904
Epoch: 4, Steps: 208 | Train Loss: 2.973 Vali Loss: 5.287 Vali Acc: 0.040 Test Loss: 5.287 Test Acc: 0.040
Validation loss decreased (-0.037526 --> -0.039613).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8237565
	speed: 1.3231s/iter; left time: 26288.7748s
	iters: 200, epoch: 5 | loss: 3.5144155
	speed: 0.5955s/iter; left time: 11771.9403s
Epoch: 5 cost time: 118.3152494430542
Epoch: 5, Steps: 208 | Train Loss: 2.830 Vali Loss: 5.290 Vali Acc: 0.043 Test Loss: 5.290 Test Acc: 0.043
Validation loss decreased (-0.039613 --> -0.042595).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1305664
	speed: 1.5221s/iter; left time: 29925.1818s
	iters: 200, epoch: 6 | loss: 2.8572316
	speed: 0.5526s/iter; left time: 10810.2676s
Epoch: 6 cost time: 119.08284163475037
Epoch: 6, Steps: 208 | Train Loss: 2.684 Vali Loss: 5.388 Vali Acc: 0.053 Test Loss: 5.388 Test Acc: 0.053
Validation loss decreased (-0.042595 --> -0.053331).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0622501
	speed: 1.4913s/iter; left time: 29009.7595s
	iters: 200, epoch: 7 | loss: 2.6128793
	speed: 0.6641s/iter; left time: 12851.5215s
Epoch: 7 cost time: 137.03332901000977
Epoch: 7, Steps: 208 | Train Loss: 2.543 Vali Loss: 5.356 Vali Acc: 0.058 Test Loss: 5.356 Test Acc: 0.058
Validation loss decreased (-0.053331 --> -0.057805).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4985096
	speed: 1.6609s/iter; left time: 31964.1819s
	iters: 200, epoch: 8 | loss: 2.4436657
	speed: 0.6365s/iter; left time: 12185.7554s
Epoch: 8 cost time: 140.3192105293274
Epoch: 8, Steps: 208 | Train Loss: 2.382 Vali Loss: 5.190 Vali Acc: 0.061 Test Loss: 5.190 Test Acc: 0.061
Validation loss decreased (-0.057805 --> -0.061087).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8922219
	speed: 1.6516s/iter; left time: 31441.0906s
	iters: 200, epoch: 9 | loss: 2.0112100
	speed: 0.6325s/iter; left time: 11978.3435s
Epoch: 9 cost time: 133.3414032459259
Epoch: 9, Steps: 208 | Train Loss: 2.137 Vali Loss: 5.524 Vali Acc: 0.061 Test Loss: 5.524 Test Acc: 0.061
Validation loss decreased (-0.061087 --> -0.061382).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0722537
	speed: 1.6270s/iter; left time: 30634.6107s
	iters: 200, epoch: 10 | loss: 2.0203259
	speed: 0.6002s/iter; left time: 11240.9167s
Epoch: 10 cost time: 128.57292532920837
Epoch: 10, Steps: 208 | Train Loss: 1.928 Vali Loss: 5.354 Vali Acc: 0.073 Test Loss: 5.354 Test Acc: 0.073
Validation loss decreased (-0.061382 --> -0.073314).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7348572
	speed: 1.6395s/iter; left time: 30529.0561s
	iters: 200, epoch: 11 | loss: 2.0353527
	speed: 0.6641s/iter; left time: 12299.9943s
Epoch: 11 cost time: 136.6373200416565
Epoch: 11, Steps: 208 | Train Loss: 1.677 Vali Loss: 5.659 Vali Acc: 0.077 Test Loss: 5.659 Test Acc: 0.077
Validation loss decreased (-0.073314 --> -0.076591).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7879232
	speed: 1.5410s/iter; left time: 28374.4824s
	iters: 200, epoch: 12 | loss: 1.7782189
	speed: 0.6499s/iter; left time: 11901.9373s
Epoch: 12 cost time: 132.57152462005615
Epoch: 12, Steps: 208 | Train Loss: 1.469 Vali Loss: 5.827 Vali Acc: 0.081 Test Loss: 5.827 Test Acc: 0.081
Validation loss decreased (-0.076591 --> -0.080765).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4278818
	speed: 1.6025s/iter; left time: 29174.1775s
	iters: 200, epoch: 13 | loss: 1.5385226
	speed: 0.6388s/iter; left time: 11565.0163s
Epoch: 13 cost time: 130.28079295158386
Epoch: 13, Steps: 208 | Train Loss: 1.288 Vali Loss: 6.478 Vali Acc: 0.072 Test Loss: 6.478 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5506259
	speed: 1.5860s/iter; left time: 28543.4064s
	iters: 200, epoch: 14 | loss: 1.3871830
	speed: 0.6497s/iter; left time: 11627.9169s
Epoch: 14 cost time: 133.63458108901978
Epoch: 14, Steps: 208 | Train Loss: 1.114 Vali Loss: 6.540 Vali Acc: 0.074 Test Loss: 6.540 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3246113
	speed: 1.6458s/iter; left time: 29277.1230s
	iters: 200, epoch: 15 | loss: 1.3056393
	speed: 0.6049s/iter; left time: 10699.4389s
Epoch: 15 cost time: 128.73522019386292
Epoch: 15, Steps: 208 | Train Loss: 1.026 Vali Loss: 6.688 Vali Acc: 0.080 Test Loss: 6.688 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8894560
	speed: 1.6825s/iter; left time: 29580.6670s
	iters: 200, epoch: 16 | loss: 1.2303096
	speed: 0.6790s/iter; left time: 11869.2858s
Epoch: 16 cost time: 142.2684736251831
Epoch: 16, Steps: 208 | Train Loss: 0.855 Vali Loss: 6.743 Vali Acc: 0.084 Test Loss: 6.743 Test Acc: 0.084
Validation loss decreased (-0.080765 --> -0.083440).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5483447
	speed: 1.5646s/iter; left time: 27181.6921s
	iters: 200, epoch: 17 | loss: 0.7648773
	speed: 0.6486s/iter; left time: 11203.3642s
Epoch: 17 cost time: 134.86060571670532
Epoch: 17, Steps: 208 | Train Loss: 0.802 Vali Loss: 7.268 Vali Acc: 0.082 Test Loss: 7.268 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5208721
	speed: 1.7057s/iter; left time: 29278.2553s
	iters: 200, epoch: 18 | loss: 1.0605898
	speed: 0.6098s/iter; left time: 10406.8840s
Epoch: 18 cost time: 135.89896321296692
Epoch: 18, Steps: 208 | Train Loss: 0.723 Vali Loss: 7.455 Vali Acc: 0.085 Test Loss: 7.455 Test Acc: 0.085
Validation loss decreased (-0.083440 --> -0.084626).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3050103
	speed: 1.6637s/iter; left time: 28211.4906s
	iters: 200, epoch: 19 | loss: 0.9477527
	speed: 0.5988s/iter; left time: 10093.3236s
Epoch: 19 cost time: 130.43408870697021
Epoch: 19, Steps: 208 | Train Loss: 0.662 Vali Loss: 7.727 Vali Acc: 0.082 Test Loss: 7.727 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.0219054
	speed: 1.6555s/iter; left time: 27728.1217s
	iters: 200, epoch: 20 | loss: 0.9640026
	speed: 0.6926s/iter; left time: 11531.1530s
Epoch: 20 cost time: 142.81912446022034
Epoch: 20, Steps: 208 | Train Loss: 0.639 Vali Loss: 7.899 Vali Acc: 0.088 Test Loss: 7.899 Test Acc: 0.088
Validation loss decreased (-0.084626 --> -0.087902).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.4322192
	speed: 1.6563s/iter; left time: 27396.4206s
	iters: 200, epoch: 21 | loss: 0.7667484
	speed: 0.6258s/iter; left time: 10288.5350s
Epoch: 21 cost time: 133.01480388641357
Epoch: 21, Steps: 208 | Train Loss: 0.553 Vali Loss: 8.014 Vali Acc: 0.088 Test Loss: 8.014 Test Acc: 0.088
Validation loss decreased (-0.087902 --> -0.088199).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.7416561
	speed: 1.6121s/iter; left time: 26329.6878s
	iters: 200, epoch: 22 | loss: 0.7957195
	speed: 0.6377s/iter; left time: 10351.8145s
Epoch: 22 cost time: 137.38044810295105
Epoch: 22, Steps: 208 | Train Loss: 0.527 Vali Loss: 8.167 Vali Acc: 0.085 Test Loss: 8.167 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.7025623
	speed: 1.6293s/iter; left time: 26272.2431s
	iters: 200, epoch: 23 | loss: 0.6256127
	speed: 0.6306s/iter; left time: 10104.8491s
Epoch: 23 cost time: 135.52456068992615
Epoch: 23, Steps: 208 | Train Loss: 0.476 Vali Loss: 8.624 Vali Acc: 0.083 Test Loss: 8.624 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2962817
	speed: 1.7221s/iter; left time: 27410.4198s
	iters: 200, epoch: 24 | loss: 0.8034881
	speed: 0.6229s/iter; left time: 9853.0969s
Epoch: 24 cost time: 132.99030232429504
Epoch: 24, Steps: 208 | Train Loss: 0.459 Vali Loss: 8.504 Vali Acc: 0.089 Test Loss: 8.504 Test Acc: 0.089
Validation loss decreased (-0.088199 --> -0.089089).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.5765275
	speed: 1.6336s/iter; left time: 25662.1799s
	iters: 200, epoch: 25 | loss: 0.5063161
	speed: 0.5892s/iter; left time: 9196.1667s
Epoch: 25 cost time: 128.45319318771362
Epoch: 25, Steps: 208 | Train Loss: 0.434 Vali Loss: 8.606 Vali Acc: 0.092 Test Loss: 8.606 Test Acc: 0.092
Validation loss decreased (-0.089089 --> -0.092368).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.2300068
	speed: 1.5495s/iter; left time: 24018.1968s
	iters: 200, epoch: 26 | loss: 0.4994858
	speed: 0.5866s/iter; left time: 9034.8078s
Epoch: 26 cost time: 124.99434685707092
Epoch: 26, Steps: 208 | Train Loss: 0.412 Vali Loss: 8.899 Vali Acc: 0.094 Test Loss: 8.899 Test Acc: 0.094
Validation loss decreased (-0.092368 --> -0.093857).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.5359207
	speed: 1.4590s/iter; left time: 22312.0124s
	iters: 200, epoch: 27 | loss: 0.4135937
	speed: 0.5326s/iter; left time: 8091.9304s
Epoch: 27 cost time: 117.03212881088257
Epoch: 27, Steps: 208 | Train Loss: 0.367 Vali Loss: 8.815 Vali Acc: 0.087 Test Loss: 8.815 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.7191352
	speed: 1.5335s/iter; left time: 23132.9910s
	iters: 200, epoch: 28 | loss: 0.5163960
	speed: 0.6219s/iter; left time: 9319.9078s
Epoch: 28 cost time: 129.22506880760193
Epoch: 28, Steps: 208 | Train Loss: 0.371 Vali Loss: 9.446 Vali Acc: 0.086 Test Loss: 9.446 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.6551845
	speed: 1.5991s/iter; left time: 23790.3364s
	iters: 200, epoch: 29 | loss: 0.2312726
	speed: 0.6661s/iter; left time: 9842.4106s
Epoch: 29 cost time: 138.1298701763153
Epoch: 29, Steps: 208 | Train Loss: 0.362 Vali Loss: 9.258 Vali Acc: 0.095 Test Loss: 9.258 Test Acc: 0.095
Validation loss decreased (-0.093857 --> -0.095344).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.3607920
	speed: 1.6724s/iter; left time: 24532.5019s
	iters: 200, epoch: 30 | loss: 0.2930796
	speed: 0.6480s/iter; left time: 9440.5285s
Epoch: 30 cost time: 136.56516933441162
Epoch: 30, Steps: 208 | Train Loss: 0.335 Vali Loss: 9.371 Vali Acc: 0.093 Test Loss: 9.371 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.4308499
	speed: 1.6259s/iter; left time: 23512.5835s
	iters: 200, epoch: 31 | loss: 0.0957024
	speed: 0.6198s/iter; left time: 8901.4276s
Epoch: 31 cost time: 134.12823128700256
Epoch: 31, Steps: 208 | Train Loss: 0.343 Vali Loss: 9.495 Vali Acc: 0.097 Test Loss: 9.495 Test Acc: 0.097
Validation loss decreased (-0.095344 --> -0.096535).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0845354
	speed: 1.5895s/iter; left time: 22654.5079s
	iters: 200, epoch: 32 | loss: 0.9964812
	speed: 0.6546s/iter; left time: 9264.6713s
Epoch: 32 cost time: 133.12783575057983
Epoch: 32, Steps: 208 | Train Loss: 0.308 Vali Loss: 9.993 Vali Acc: 0.090 Test Loss: 9.993 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0739571
	speed: 1.6722s/iter; left time: 23486.5243s
	iters: 200, epoch: 33 | loss: 0.1768468
	speed: 0.6711s/iter; left time: 9358.8160s
Epoch: 33 cost time: 141.08383536338806
Epoch: 33, Steps: 208 | Train Loss: 0.286 Vali Loss: 9.657 Vali Acc: 0.095 Test Loss: 9.657 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0796524
	speed: 1.5088s/iter; left time: 20876.9378s
	iters: 200, epoch: 34 | loss: 0.2644643
	speed: 0.6049s/iter; left time: 8309.5024s
Epoch: 34 cost time: 126.55895805358887
Epoch: 34, Steps: 208 | Train Loss: 0.284 Vali Loss: 10.040 Vali Acc: 0.099 Test Loss: 10.040 Test Acc: 0.099
Validation loss decreased (-0.096535 --> -0.099214).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.2803704
	speed: 1.6389s/iter; left time: 22336.3496s
	iters: 200, epoch: 35 | loss: 0.2250207
	speed: 0.6580s/iter; left time: 8902.1138s
Epoch: 35 cost time: 139.27750205993652
Epoch: 35, Steps: 208 | Train Loss: 0.264 Vali Loss: 10.032 Vali Acc: 0.103 Test Loss: 10.032 Test Acc: 0.103
Validation loss decreased (-0.099214 --> -0.103091).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0927150
	speed: 1.6921s/iter; left time: 22709.3395s
	iters: 200, epoch: 36 | loss: 0.3106822
	speed: 0.6634s/iter; left time: 8837.2810s
Epoch: 36 cost time: 139.66024255752563
Epoch: 36, Steps: 208 | Train Loss: 0.267 Vali Loss: 10.411 Vali Acc: 0.096 Test Loss: 10.411 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.1737047
	speed: 1.6072s/iter; left time: 21235.4043s
	iters: 200, epoch: 37 | loss: 0.4840813
	speed: 0.5842s/iter; left time: 7660.1495s
Epoch: 37 cost time: 126.25922870635986
Epoch: 37, Steps: 208 | Train Loss: 0.291 Vali Loss: 10.744 Vali Acc: 0.089 Test Loss: 10.744 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.1459440
	speed: 1.6557s/iter; left time: 21532.6709s
	iters: 200, epoch: 38 | loss: 0.0104564
	speed: 0.6417s/iter; left time: 8280.8682s
Epoch: 38 cost time: 133.14848589897156
Epoch: 38, Steps: 208 | Train Loss: 0.269 Vali Loss: 10.339 Vali Acc: 0.095 Test Loss: 10.339 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0268124
	speed: 1.7337s/iter; left time: 22185.9700s
	iters: 200, epoch: 39 | loss: 0.2812371
	speed: 0.6504s/iter; left time: 8257.9557s
Epoch: 39 cost time: 139.93617248535156
Epoch: 39, Steps: 208 | Train Loss: 0.263 Vali Loss: 10.504 Vali Acc: 0.094 Test Loss: 10.504 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.4384531
	speed: 1.5913s/iter; left time: 20033.3242s
	iters: 200, epoch: 40 | loss: 0.4172930
	speed: 0.7105s/iter; left time: 8873.3946s
Epoch: 40 cost time: 134.84669184684753
Epoch: 40, Steps: 208 | Train Loss: 0.256 Vali Loss: 10.557 Vali Acc: 0.099 Test Loss: 10.557 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.2673610
	speed: 1.6017s/iter; left time: 19830.6941s
	iters: 200, epoch: 41 | loss: 0.0860849
	speed: 0.5813s/iter; left time: 7139.0072s
Epoch: 41 cost time: 126.2838785648346
Epoch: 41, Steps: 208 | Train Loss: 0.238 Vali Loss: 10.802 Vali Acc: 0.096 Test Loss: 10.802 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0183799
	speed: 1.6632s/iter; left time: 20246.2015s
	iters: 200, epoch: 42 | loss: 0.0492727
	speed: 0.6938s/iter; left time: 8376.7085s
Epoch: 42 cost time: 147.27126288414001
Epoch: 42, Steps: 208 | Train Loss: 0.227 Vali Loss: 10.867 Vali Acc: 0.090 Test Loss: 10.867 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.3048533
	speed: 1.6899s/iter; left time: 20219.5210s
	iters: 200, epoch: 43 | loss: 0.8194829
	speed: 0.6981s/iter; left time: 8282.5119s
Epoch: 43 cost time: 144.3041410446167
Epoch: 43, Steps: 208 | Train Loss: 0.223 Vali Loss: 10.579 Vali Acc: 0.103 Test Loss: 10.579 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.1692108
	speed: 1.5964s/iter; left time: 18769.2050s
	iters: 200, epoch: 44 | loss: 0.1800140
	speed: 0.6271s/iter; left time: 7310.5276s
Epoch: 44 cost time: 130.13156175613403
Epoch: 44, Steps: 208 | Train Loss: 0.197 Vali Loss: 11.149 Vali Acc: 0.097 Test Loss: 11.149 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0401903
	speed: 1.7060s/iter; left time: 19702.9221s
	iters: 200, epoch: 45 | loss: 0.2768643
	speed: 0.6112s/iter; left time: 6997.8259s
Epoch: 45 cost time: 135.0015161037445
Epoch: 45, Steps: 208 | Train Loss: 0.188 Vali Loss: 11.193 Vali Acc: 0.096 Test Loss: 11.193 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10319117208470027
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7595091
	speed: 0.6874s/iter; left time: 14229.1391s
	iters: 200, epoch: 1 | loss: 3.6545763
	speed: 0.6779s/iter; left time: 13965.0594s
Epoch: 1 cost time: 143.08500146865845
Epoch: 1, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.935 Vali Acc: 0.034 Test Loss: 3.935 Test Acc: 0.034
Validation loss decreased (inf --> -0.034258).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3246481
	speed: 1.6611s/iter; left time: 34041.7554s
	iters: 200, epoch: 2 | loss: 3.1203079
	speed: 0.6501s/iter; left time: 13258.2780s
Epoch: 2 cost time: 137.03134083747864
Epoch: 2, Steps: 208 | Train Loss: 3.326 Vali Loss: 4.435 Vali Acc: 0.035 Test Loss: 4.435 Test Acc: 0.035
Validation loss decreased (-0.034258 --> -0.035148).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0273736
	speed: 1.7395s/iter; left time: 35285.4560s
	iters: 200, epoch: 3 | loss: 3.0685654
	speed: 0.6405s/iter; left time: 12927.8032s
Epoch: 3 cost time: 141.54438591003418
Epoch: 3, Steps: 208 | Train Loss: 2.995 Vali Loss: 4.596 Vali Acc: 0.050 Test Loss: 4.596 Test Acc: 0.050
Validation loss decreased (-0.035148 --> -0.050357).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8916497
	speed: 1.5119s/iter; left time: 30353.8858s
	iters: 200, epoch: 4 | loss: 2.9988136
	speed: 0.6483s/iter; left time: 12951.7478s
Epoch: 4 cost time: 134.83911228179932
Epoch: 4, Steps: 208 | Train Loss: 2.786 Vali Loss: 4.796 Vali Acc: 0.050 Test Loss: 4.796 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.5704219
	speed: 1.5798s/iter; left time: 31389.2994s
	iters: 200, epoch: 5 | loss: 3.2671807
	speed: 0.5640s/iter; left time: 11150.3817s
Epoch: 5 cost time: 122.60349655151367
Epoch: 5, Steps: 208 | Train Loss: 2.579 Vali Loss: 4.934 Vali Acc: 0.055 Test Loss: 4.934 Test Acc: 0.055
Validation loss decreased (-0.050357 --> -0.055125).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7178206
	speed: 1.6862s/iter; left time: 33153.0565s
	iters: 200, epoch: 6 | loss: 2.5443442
	speed: 0.6449s/iter; left time: 12615.6236s
Epoch: 6 cost time: 135.14236092567444
Epoch: 6, Steps: 208 | Train Loss: 2.348 Vali Loss: 5.019 Vali Acc: 0.062 Test Loss: 5.019 Test Acc: 0.062
Validation loss decreased (-0.055125 --> -0.061686).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4541731
	speed: 1.5587s/iter; left time: 30320.5044s
	iters: 200, epoch: 7 | loss: 2.7844665
	speed: 0.6512s/iter; left time: 12602.4851s
Epoch: 7 cost time: 133.10781908035278
Epoch: 7, Steps: 208 | Train Loss: 2.095 Vali Loss: 5.266 Vali Acc: 0.062 Test Loss: 5.266 Test Acc: 0.062
Validation loss decreased (-0.061686 --> -0.062280).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9264323
	speed: 1.5992s/iter; left time: 30776.2244s
	iters: 200, epoch: 8 | loss: 1.8923318
	speed: 0.6661s/iter; left time: 12753.1859s
Epoch: 8 cost time: 133.14174342155457
Epoch: 8, Steps: 208 | Train Loss: 1.830 Vali Loss: 5.396 Vali Acc: 0.072 Test Loss: 5.396 Test Acc: 0.072
Validation loss decreased (-0.062280 --> -0.071822).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3887188
	speed: 1.6480s/iter; left time: 31373.5696s
	iters: 200, epoch: 9 | loss: 2.0983508
	speed: 0.6622s/iter; left time: 12540.0559s
Epoch: 9 cost time: 137.72469067573547
Epoch: 9, Steps: 208 | Train Loss: 1.572 Vali Loss: 5.776 Vali Acc: 0.068 Test Loss: 5.776 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6060610
	speed: 1.7076s/iter; left time: 32152.6401s
	iters: 200, epoch: 10 | loss: 1.3025687
	speed: 0.6169s/iter; left time: 11553.0999s
Epoch: 10 cost time: 137.6360194683075
Epoch: 10, Steps: 208 | Train Loss: 1.372 Vali Loss: 5.994 Vali Acc: 0.075 Test Loss: 5.994 Test Acc: 0.075
Validation loss decreased (-0.071822 --> -0.075097).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5416746
	speed: 1.6323s/iter; left time: 30394.6216s
	iters: 200, epoch: 11 | loss: 1.6326573
	speed: 0.6323s/iter; left time: 11711.3660s
Epoch: 11 cost time: 136.7400872707367
Epoch: 11, Steps: 208 | Train Loss: 1.163 Vali Loss: 6.231 Vali Acc: 0.079 Test Loss: 6.231 Test Acc: 0.079
Validation loss decreased (-0.075097 --> -0.079270).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3377131
	speed: 1.6286s/iter; left time: 29986.8914s
	iters: 200, epoch: 12 | loss: 1.0354661
	speed: 0.6853s/iter; left time: 12550.6238s
Epoch: 12 cost time: 143.9663233757019
Epoch: 12, Steps: 208 | Train Loss: 0.990 Vali Loss: 6.503 Vali Acc: 0.074 Test Loss: 6.503 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2606912
	speed: 1.5617s/iter; left time: 28430.9742s
	iters: 200, epoch: 13 | loss: 0.9907525
	speed: 0.7127s/iter; left time: 12903.1464s
Epoch: 13 cost time: 138.31267261505127
Epoch: 13, Steps: 208 | Train Loss: 0.831 Vali Loss: 6.956 Vali Acc: 0.067 Test Loss: 6.956 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8290982
	speed: 1.6364s/iter; left time: 29449.7301s
	iters: 200, epoch: 14 | loss: 0.8892992
	speed: 0.5936s/iter; left time: 10624.4947s
Epoch: 14 cost time: 128.77074694633484
Epoch: 14, Steps: 208 | Train Loss: 0.763 Vali Loss: 7.090 Vali Acc: 0.073 Test Loss: 7.090 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2323842
	speed: 1.6397s/iter; left time: 29167.9456s
	iters: 200, epoch: 15 | loss: 1.0473437
	speed: 0.6217s/iter; left time: 10996.5341s
Epoch: 15 cost time: 138.5706503391266
Epoch: 15, Steps: 208 | Train Loss: 0.690 Vali Loss: 7.235 Vali Acc: 0.079 Test Loss: 7.235 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.2042838
	speed: 1.5606s/iter; left time: 27436.8886s
	iters: 200, epoch: 16 | loss: 1.1811237
	speed: 0.6065s/iter; left time: 10602.4653s
Epoch: 16 cost time: 130.18248867988586
Epoch: 16, Steps: 208 | Train Loss: 0.586 Vali Loss: 7.506 Vali Acc: 0.086 Test Loss: 7.506 Test Acc: 0.086
Validation loss decreased (-0.079270 --> -0.085818).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3635208
	speed: 1.5788s/iter; left time: 27427.9144s
	iters: 200, epoch: 17 | loss: 0.6105474
	speed: 0.6083s/iter; left time: 10506.8548s
Epoch: 17 cost time: 128.6345443725586
Epoch: 17, Steps: 208 | Train Loss: 0.524 Vali Loss: 7.870 Vali Acc: 0.079 Test Loss: 7.870 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1705080
	speed: 1.6275s/iter; left time: 27935.4208s
	iters: 200, epoch: 18 | loss: 0.1879045
	speed: 0.6273s/iter; left time: 10704.1434s
Epoch: 18 cost time: 133.5050745010376
Epoch: 18, Steps: 208 | Train Loss: 0.474 Vali Loss: 8.148 Vali Acc: 0.075 Test Loss: 8.148 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1909019
	speed: 1.7036s/iter; left time: 28887.3097s
	iters: 200, epoch: 19 | loss: 0.9122034
	speed: 0.7608s/iter; left time: 12824.3004s
Epoch: 19 cost time: 148.83272004127502
Epoch: 19, Steps: 208 | Train Loss: 0.430 Vali Loss: 8.460 Vali Acc: 0.085 Test Loss: 8.460 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.9406400
	speed: 1.7098s/iter; left time: 28637.5795s
	iters: 200, epoch: 20 | loss: 0.4432239
	speed: 0.7180s/iter; left time: 11954.7339s
Epoch: 20 cost time: 149.5549418926239
Epoch: 20, Steps: 208 | Train Loss: 0.420 Vali Loss: 8.511 Vali Acc: 0.083 Test Loss: 8.511 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6512414
	speed: 1.8266s/iter; left time: 30213.4604s
	iters: 200, epoch: 21 | loss: 0.5523071
	speed: 0.7308s/iter; left time: 12015.7169s
Epoch: 21 cost time: 157.74680376052856
Epoch: 21, Steps: 208 | Train Loss: 0.392 Vali Loss: 8.780 Vali Acc: 0.094 Test Loss: 8.780 Test Acc: 0.094
Validation loss decreased (-0.085818 --> -0.093560).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.7683542
	speed: 1.7328s/iter; left time: 28301.7120s
	iters: 200, epoch: 22 | loss: 0.6292698
	speed: 0.6354s/iter; left time: 10313.8568s
Epoch: 22 cost time: 140.46816563606262
Epoch: 22, Steps: 208 | Train Loss: 0.344 Vali Loss: 9.125 Vali Acc: 0.097 Test Loss: 9.125 Test Acc: 0.097
Validation loss decreased (-0.093560 --> -0.096837).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.2851027
	speed: 1.7942s/iter; left time: 28930.9947s
	iters: 200, epoch: 23 | loss: 0.5679488
	speed: 0.6402s/iter; left time: 10259.1146s
Epoch: 23 cost time: 137.55848002433777
Epoch: 23, Steps: 208 | Train Loss: 0.346 Vali Loss: 9.025 Vali Acc: 0.082 Test Loss: 9.025 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.3302750
	speed: 1.6665s/iter; left time: 26526.0525s
	iters: 200, epoch: 24 | loss: 0.3756409
	speed: 0.6579s/iter; left time: 10405.9185s
Epoch: 24 cost time: 139.4266655445099
Epoch: 24, Steps: 208 | Train Loss: 0.332 Vali Loss: 9.259 Vali Acc: 0.090 Test Loss: 9.259 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.3074752
	speed: 1.5756s/iter; left time: 24750.3823s
	iters: 200, epoch: 25 | loss: 0.3060691
	speed: 0.6562s/iter; left time: 10242.7408s
Epoch: 25 cost time: 134.74917268753052
Epoch: 25, Steps: 208 | Train Loss: 0.285 Vali Loss: 9.646 Vali Acc: 0.091 Test Loss: 9.646 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1074478
	speed: 1.4574s/iter; left time: 22590.6250s
	iters: 200, epoch: 26 | loss: 0.0596440
	speed: 0.6034s/iter; left time: 9292.8890s
Epoch: 26 cost time: 123.79736542701721
Epoch: 26, Steps: 208 | Train Loss: 0.292 Vali Loss: 9.451 Vali Acc: 0.095 Test Loss: 9.451 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.6505300
	speed: 1.5301s/iter; left time: 23399.5752s
	iters: 200, epoch: 27 | loss: 0.0878235
	speed: 0.5733s/iter; left time: 8710.4091s
Epoch: 27 cost time: 125.35494017601013
Epoch: 27, Steps: 208 | Train Loss: 0.259 Vali Loss: 9.554 Vali Acc: 0.095 Test Loss: 9.554 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1342767
	speed: 1.3491s/iter; left time: 20351.7840s
	iters: 200, epoch: 28 | loss: 0.4128456
	speed: 0.5505s/iter; left time: 8249.8843s
Epoch: 28 cost time: 112.57706332206726
Epoch: 28, Steps: 208 | Train Loss: 0.269 Vali Loss: 9.829 Vali Acc: 0.091 Test Loss: 9.829 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.4346822
	speed: 1.3937s/iter; left time: 20733.8890s
	iters: 200, epoch: 29 | loss: 0.0812741
	speed: 0.5147s/iter; left time: 7605.5834s
Epoch: 29 cost time: 112.65489101409912
Epoch: 29, Steps: 208 | Train Loss: 0.275 Vali Loss: 10.026 Vali Acc: 0.089 Test Loss: 10.026 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.4459052
	speed: 1.3674s/iter; left time: 20059.0883s
	iters: 200, epoch: 30 | loss: 0.2962671
	speed: 0.5901s/iter; left time: 8596.9789s
Epoch: 30 cost time: 121.21851754188538
Epoch: 30, Steps: 208 | Train Loss: 0.241 Vali Loss: 10.269 Vali Acc: 0.091 Test Loss: 10.269 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.1779484
	speed: 1.5149s/iter; left time: 21906.7240s
	iters: 200, epoch: 31 | loss: 0.1960465
	speed: 0.5928s/iter; left time: 8512.9469s
Epoch: 31 cost time: 121.71660828590393
Epoch: 31, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.467 Vali Acc: 0.083 Test Loss: 10.467 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.5260397
	speed: 1.4438s/iter; left time: 20578.6516s
	iters: 200, epoch: 32 | loss: 0.3949536
	speed: 0.5804s/iter; left time: 8213.7817s
Epoch: 32 cost time: 123.53924751281738
Epoch: 32, Steps: 208 | Train Loss: 0.204 Vali Loss: 10.525 Vali Acc: 0.093 Test Loss: 10.525 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0969281240679988
model parameter : 363591
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         109                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7231834
	speed: 0.5845s/iter; left time: 12098.9644s
	iters: 200, epoch: 1 | loss: 3.9925115
	speed: 0.5835s/iter; left time: 12020.7913s
Epoch: 1 cost time: 122.61469745635986
Epoch: 1, Steps: 208 | Train Loss: 3.654 Vali Loss: 3.565 Vali Acc: 0.071 Test Loss: 3.565 Test Acc: 0.071
Validation loss decreased (inf --> -0.071244).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2071400
	speed: 1.4950s/iter; left time: 30637.5658s
	iters: 200, epoch: 2 | loss: 3.3871069
	speed: 0.6285s/iter; left time: 12817.8675s
Epoch: 2 cost time: 129.94626998901367
Epoch: 2, Steps: 208 | Train Loss: 3.181 Vali Loss: 3.554 Vali Acc: 0.092 Test Loss: 3.554 Test Acc: 0.092
Validation loss decreased (-0.071244 --> -0.091524).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0493994
	speed: 1.6936s/iter; left time: 34353.9422s
	iters: 200, epoch: 3 | loss: 2.9408810
	speed: 0.5873s/iter; left time: 11854.9389s
Epoch: 3 cost time: 131.37472558021545
Epoch: 3, Steps: 208 | Train Loss: 2.697 Vali Loss: 3.747 Vali Acc: 0.093 Test Loss: 3.747 Test Acc: 0.093
Validation loss decreased (-0.091524 --> -0.093312).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4264138
	speed: 1.5544s/iter; left time: 31206.7247s
	iters: 200, epoch: 4 | loss: 2.0984645
	speed: 0.6187s/iter; left time: 12359.7843s
Epoch: 4 cost time: 128.36853528022766
Epoch: 4, Steps: 208 | Train Loss: 2.231 Vali Loss: 3.924 Vali Acc: 0.104 Test Loss: 3.924 Test Acc: 0.104
Validation loss decreased (-0.093312 --> -0.103748).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8908739
	speed: 1.6851s/iter; left time: 33480.8594s
	iters: 200, epoch: 5 | loss: 2.4785495
	speed: 0.7313s/iter; left time: 14457.1128s
Epoch: 5 cost time: 150.28511142730713
Epoch: 5, Steps: 208 | Train Loss: 1.766 Vali Loss: 4.371 Vali Acc: 0.096 Test Loss: 4.371 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0933433
	speed: 1.7788s/iter; left time: 34972.6121s
	iters: 200, epoch: 6 | loss: 1.0433059
	speed: 0.6996s/iter; left time: 13685.3740s
Epoch: 6 cost time: 147.28649187088013
Epoch: 6, Steps: 208 | Train Loss: 1.301 Vali Loss: 4.861 Vali Acc: 0.107 Test Loss: 4.861 Test Acc: 0.107
Validation loss decreased (-0.103748 --> -0.106721).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0719646
	speed: 1.6833s/iter; left time: 32745.6381s
	iters: 200, epoch: 7 | loss: 1.6527791
	speed: 0.6477s/iter; left time: 12534.3402s
Epoch: 7 cost time: 141.03216290473938
Epoch: 7, Steps: 208 | Train Loss: 1.006 Vali Loss: 5.554 Vali Acc: 0.095 Test Loss: 5.554 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7893868
	speed: 1.6317s/iter; left time: 31402.2447s
	iters: 200, epoch: 8 | loss: 0.7556786
	speed: 0.6301s/iter; left time: 12062.3518s
Epoch: 8 cost time: 138.92787671089172
Epoch: 8, Steps: 208 | Train Loss: 0.748 Vali Loss: 5.837 Vali Acc: 0.101 Test Loss: 5.837 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6088976
	speed: 1.5512s/iter; left time: 29530.4209s
	iters: 200, epoch: 9 | loss: 0.9201080
	speed: 0.6360s/iter; left time: 12044.4831s
Epoch: 9 cost time: 132.5951988697052
Epoch: 9, Steps: 208 | Train Loss: 0.609 Vali Loss: 6.312 Vali Acc: 0.104 Test Loss: 6.312 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2467866
	speed: 1.6319s/iter; left time: 30727.0640s
	iters: 200, epoch: 10 | loss: 0.4059325
	speed: 0.5917s/iter; left time: 11082.0555s
Epoch: 10 cost time: 131.91995811462402
Epoch: 10, Steps: 208 | Train Loss: 0.489 Vali Loss: 6.802 Vali Acc: 0.093 Test Loss: 6.802 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4760150
	speed: 1.5262s/iter; left time: 28418.8927s
	iters: 200, epoch: 11 | loss: 0.9728401
	speed: 0.6224s/iter; left time: 11526.6741s
Epoch: 11 cost time: 129.33114194869995
Epoch: 11, Steps: 208 | Train Loss: 0.430 Vali Loss: 7.188 Vali Acc: 0.107 Test Loss: 7.188 Test Acc: 0.107
Validation loss decreased (-0.106721 --> -0.106996).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5139637
	speed: 1.6123s/iter; left time: 29687.7810s
	iters: 200, epoch: 12 | loss: 0.2341596
	speed: 0.6058s/iter; left time: 11093.5817s
Epoch: 12 cost time: 132.97299075126648
Epoch: 12, Steps: 208 | Train Loss: 0.380 Vali Loss: 7.562 Vali Acc: 0.098 Test Loss: 7.562 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0677911
	speed: 1.6878s/iter; left time: 30725.7391s
	iters: 200, epoch: 13 | loss: 0.3565404
	speed: 0.6261s/iter; left time: 11336.0497s
Epoch: 13 cost time: 138.8827202320099
Epoch: 13, Steps: 208 | Train Loss: 0.323 Vali Loss: 7.997 Vali Acc: 0.099 Test Loss: 7.997 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3161819
	speed: 1.7085s/iter; left time: 30747.4555s
	iters: 200, epoch: 14 | loss: 0.2440375
	speed: 0.6220s/iter; left time: 11132.0007s
Epoch: 14 cost time: 137.46037650108337
Epoch: 14, Steps: 208 | Train Loss: 0.299 Vali Loss: 8.294 Vali Acc: 0.102 Test Loss: 8.294 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3314045
	speed: 1.5646s/iter; left time: 27832.7041s
	iters: 200, epoch: 15 | loss: 0.2465680
	speed: 0.6092s/iter; left time: 10775.8687s
Epoch: 15 cost time: 127.6461238861084
Epoch: 15, Steps: 208 | Train Loss: 0.269 Vali Loss: 8.445 Vali Acc: 0.097 Test Loss: 8.445 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.2726314
	speed: 1.6562s/iter; left time: 29118.4368s
	iters: 200, epoch: 16 | loss: 0.3146239
	speed: 0.6329s/iter; left time: 11063.0522s
Epoch: 16 cost time: 139.06606364250183
Epoch: 16, Steps: 208 | Train Loss: 0.226 Vali Loss: 8.924 Vali Acc: 0.105 Test Loss: 8.924 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3309148
	speed: 1.5168s/iter; left time: 26351.6275s
	iters: 200, epoch: 17 | loss: 0.1170255
	speed: 0.6968s/iter; left time: 12035.7237s
Epoch: 17 cost time: 138.32420301437378
Epoch: 17, Steps: 208 | Train Loss: 0.220 Vali Loss: 9.240 Vali Acc: 0.100 Test Loss: 9.240 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0806808
	speed: 1.6882s/iter; left time: 28977.4569s
	iters: 200, epoch: 18 | loss: 0.0667973
	speed: 0.6585s/iter; left time: 11237.7080s
Epoch: 18 cost time: 136.4706416130066
Epoch: 18, Steps: 208 | Train Loss: 0.224 Vali Loss: 9.431 Vali Acc: 0.099 Test Loss: 9.431 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0795861
	speed: 1.5716s/iter; left time: 26649.8200s
	iters: 200, epoch: 19 | loss: 0.0232631
	speed: 0.6514s/iter; left time: 10981.2018s
Epoch: 19 cost time: 132.4800820350647
Epoch: 19, Steps: 208 | Train Loss: 0.205 Vali Loss: 9.768 Vali Acc: 0.102 Test Loss: 9.768 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0142171
	speed: 1.5993s/iter; left time: 26787.2304s
	iters: 200, epoch: 20 | loss: 0.7477298
	speed: 0.6119s/iter; left time: 10187.1050s
Epoch: 20 cost time: 131.42604517936707
Epoch: 20, Steps: 208 | Train Loss: 0.197 Vali Loss: 9.889 Vali Acc: 0.095 Test Loss: 9.889 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1538512
	speed: 1.6164s/iter; left time: 26736.5312s
	iters: 200, epoch: 21 | loss: 0.3802789
	speed: 0.6656s/iter; left time: 10943.3023s
Epoch: 21 cost time: 133.68124079704285
Epoch: 21, Steps: 208 | Train Loss: 0.187 Vali Loss: 10.006 Vali Acc: 0.097 Test Loss: 10.006 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10706829704742023
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         87                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6477132
	speed: 0.6521s/iter; left time: 13498.2191s
	iters: 200, epoch: 1 | loss: 3.9073777
	speed: 0.6486s/iter; left time: 13361.1273s
Epoch: 1 cost time: 134.39593410491943
Epoch: 1, Steps: 208 | Train Loss: 3.650 Vali Loss: 3.564 Vali Acc: 0.071 Test Loss: 3.564 Test Acc: 0.071
Validation loss decreased (inf --> -0.070946).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3498888
	speed: 1.5294s/iter; left time: 31342.0079s
	iters: 200, epoch: 2 | loss: 3.2612720
	speed: 0.5965s/iter; left time: 12163.5412s
Epoch: 2 cost time: 126.93113827705383
Epoch: 2, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.580 Vali Acc: 0.089 Test Loss: 3.580 Test Acc: 0.089
Validation loss decreased (-0.070946 --> -0.088542).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9495387
	speed: 1.5366s/iter; left time: 31169.9031s
	iters: 200, epoch: 3 | loss: 2.9484329
	speed: 0.6734s/iter; left time: 13592.8339s
Epoch: 3 cost time: 138.8724069595337
Epoch: 3, Steps: 208 | Train Loss: 2.702 Vali Loss: 3.766 Vali Acc: 0.092 Test Loss: 3.766 Test Acc: 0.092
Validation loss decreased (-0.088542 --> -0.091820).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2886083
	speed: 1.4968s/iter; left time: 30051.9083s
	iters: 200, epoch: 4 | loss: 2.2786076
	speed: 0.6286s/iter; left time: 12557.9331s
Epoch: 4 cost time: 128.95959949493408
Epoch: 4, Steps: 208 | Train Loss: 2.231 Vali Loss: 3.926 Vali Acc: 0.107 Test Loss: 3.926 Test Acc: 0.107
Validation loss decreased (-0.091820 --> -0.106731).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8045466
	speed: 1.5301s/iter; left time: 30401.3783s
	iters: 200, epoch: 5 | loss: 2.1710546
	speed: 0.6680s/iter; left time: 13205.9721s
Epoch: 5 cost time: 134.99966263771057
Epoch: 5, Steps: 208 | Train Loss: 1.774 Vali Loss: 4.298 Vali Acc: 0.093 Test Loss: 4.298 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2720879
	speed: 1.5441s/iter; left time: 30357.5747s
	iters: 200, epoch: 6 | loss: 1.2324494
	speed: 0.5740s/iter; left time: 11227.0961s
Epoch: 6 cost time: 124.27103972434998
Epoch: 6, Steps: 208 | Train Loss: 1.309 Vali Loss: 4.925 Vali Acc: 0.102 Test Loss: 4.925 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8912499
	speed: 1.5283s/iter; left time: 29730.1372s
	iters: 200, epoch: 7 | loss: 1.4793212
	speed: 0.6355s/iter; left time: 12298.4649s
Epoch: 7 cost time: 135.40314078330994
Epoch: 7, Steps: 208 | Train Loss: 1.000 Vali Loss: 5.509 Vali Acc: 0.094 Test Loss: 5.509 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0076609
	speed: 1.5741s/iter; left time: 30293.5815s
	iters: 200, epoch: 8 | loss: 0.7667739
	speed: 0.6481s/iter; left time: 12408.7543s
Epoch: 8 cost time: 139.0469069480896
Epoch: 8, Steps: 208 | Train Loss: 0.762 Vali Loss: 5.781 Vali Acc: 0.102 Test Loss: 5.781 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9450977
	speed: 1.5684s/iter; left time: 29858.5712s
	iters: 200, epoch: 9 | loss: 0.6673589
	speed: 0.5780s/iter; left time: 10945.1061s
Epoch: 9 cost time: 126.41196537017822
Epoch: 9, Steps: 208 | Train Loss: 0.617 Vali Loss: 6.277 Vali Acc: 0.100 Test Loss: 6.277 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2127197
	speed: 1.5992s/iter; left time: 30110.9249s
	iters: 200, epoch: 10 | loss: 0.4704160
	speed: 0.6087s/iter; left time: 11399.4231s
Epoch: 10 cost time: 134.13446426391602
Epoch: 10, Steps: 208 | Train Loss: 0.495 Vali Loss: 6.723 Vali Acc: 0.101 Test Loss: 6.723 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4775115
	speed: 1.5715s/iter; left time: 29262.6483s
	iters: 200, epoch: 11 | loss: 0.5419180
	speed: 0.6224s/iter; left time: 11527.2478s
Epoch: 11 cost time: 135.33319783210754
Epoch: 11, Steps: 208 | Train Loss: 0.428 Vali Loss: 7.179 Vali Acc: 0.101 Test Loss: 7.179 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2104949
	speed: 1.6858s/iter; left time: 31041.4243s
	iters: 200, epoch: 12 | loss: 0.3171260
	speed: 0.6053s/iter; left time: 11084.6832s
Epoch: 12 cost time: 134.77582240104675
Epoch: 12, Steps: 208 | Train Loss: 0.385 Vali Loss: 7.477 Vali Acc: 0.099 Test Loss: 7.477 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1565561
	speed: 1.5338s/iter; left time: 27922.7361s
	iters: 200, epoch: 13 | loss: 0.2153078
	speed: 0.5900s/iter; left time: 10682.3269s
Epoch: 13 cost time: 128.6815185546875
Epoch: 13, Steps: 208 | Train Loss: 0.310 Vali Loss: 8.126 Vali Acc: 0.095 Test Loss: 8.126 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1495323
	speed: 1.4904s/iter; left time: 26823.5413s
	iters: 200, epoch: 14 | loss: 0.0430315
	speed: 0.5459s/iter; left time: 9769.3762s
Epoch: 14 cost time: 118.76262903213501
Epoch: 14, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.311 Vali Acc: 0.105 Test Loss: 8.311 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10677005666567253
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         66                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma66_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8367286
	speed: 0.6566s/iter; left time: 13591.7852s
	iters: 200, epoch: 1 | loss: 4.0473280
	speed: 0.6061s/iter; left time: 12486.8230s
Epoch: 1 cost time: 131.24928331375122
Epoch: 1, Steps: 208 | Train Loss: 3.658 Vali Loss: 3.568 Vali Acc: 0.077 Test Loss: 3.568 Test Acc: 0.077
Validation loss decreased (inf --> -0.077209).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3308134
	speed: 1.4932s/iter; left time: 30599.2956s
	iters: 200, epoch: 2 | loss: 3.0141869
	speed: 0.5739s/iter; left time: 11704.2569s
Epoch: 2 cost time: 125.68900966644287
Epoch: 2, Steps: 208 | Train Loss: 3.191 Vali Loss: 3.583 Vali Acc: 0.091 Test Loss: 3.583 Test Acc: 0.091
Validation loss decreased (-0.077209 --> -0.090927).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8678429
	speed: 1.4767s/iter; left time: 29954.9547s
	iters: 200, epoch: 3 | loss: 2.9033453
	speed: 0.5579s/iter; left time: 11261.2146s
Epoch: 3 cost time: 115.9842689037323
Epoch: 3, Steps: 208 | Train Loss: 2.710 Vali Loss: 3.737 Vali Acc: 0.098 Test Loss: 3.737 Test Acc: 0.098
Validation loss decreased (-0.090927 --> -0.097487).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2549775
	speed: 1.4892s/iter; left time: 29898.6211s
	iters: 200, epoch: 4 | loss: 2.2816503
	speed: 0.6015s/iter; left time: 12015.4508s
Epoch: 4 cost time: 127.33047223091125
Epoch: 4, Steps: 208 | Train Loss: 2.250 Vali Loss: 3.947 Vali Acc: 0.104 Test Loss: 3.947 Test Acc: 0.104
Validation loss decreased (-0.097487 --> -0.104046).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8481784
	speed: 1.6209s/iter; left time: 32206.0174s
	iters: 200, epoch: 5 | loss: 2.3555021
	speed: 0.5843s/iter; left time: 11551.2499s
Epoch: 5 cost time: 128.21174669265747
Epoch: 5, Steps: 208 | Train Loss: 1.808 Vali Loss: 4.285 Vali Acc: 0.102 Test Loss: 4.285 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9291971
	speed: 1.5175s/iter; left time: 29835.9891s
	iters: 200, epoch: 6 | loss: 1.1356734
	speed: 0.5429s/iter; left time: 10620.4469s
Epoch: 6 cost time: 120.49415183067322
Epoch: 6, Steps: 208 | Train Loss: 1.353 Vali Loss: 4.817 Vali Acc: 0.103 Test Loss: 4.817 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9109224
	speed: 1.5032s/iter; left time: 29241.2759s
	iters: 200, epoch: 7 | loss: 1.4935741
	speed: 0.5858s/iter; left time: 11336.7391s
Epoch: 7 cost time: 126.45087337493896
Epoch: 7, Steps: 208 | Train Loss: 1.009 Vali Loss: 5.578 Vali Acc: 0.096 Test Loss: 5.578 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1420169
	speed: 1.4655s/iter; left time: 28203.4989s
	iters: 200, epoch: 8 | loss: 0.8716542
	speed: 0.5605s/iter; left time: 10730.0379s
Epoch: 8 cost time: 120.83625507354736
Epoch: 8, Steps: 208 | Train Loss: 0.816 Vali Loss: 5.659 Vali Acc: 0.104 Test Loss: 5.659 Test Acc: 0.104
Validation loss decreased (-0.104046 --> -0.104328).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1350956
	speed: 1.6048s/iter; left time: 30549.6660s
	iters: 200, epoch: 9 | loss: 0.3785565
	speed: 0.6374s/iter; left time: 12070.7647s
Epoch: 9 cost time: 138.71427392959595
Epoch: 9, Steps: 208 | Train Loss: 0.647 Vali Loss: 6.216 Vali Acc: 0.102 Test Loss: 6.216 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5316782
	speed: 1.5034s/iter; left time: 28307.1488s
	iters: 200, epoch: 10 | loss: 0.3499365
	speed: 0.5830s/iter; left time: 10919.8810s
Epoch: 10 cost time: 122.20575642585754
Epoch: 10, Steps: 208 | Train Loss: 0.525 Vali Loss: 6.686 Vali Acc: 0.095 Test Loss: 6.686 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2666798
	speed: 1.5085s/iter; left time: 28090.1865s
	iters: 200, epoch: 11 | loss: 0.8605323
	speed: 0.6319s/iter; left time: 11703.0482s
Epoch: 11 cost time: 131.47894024848938
Epoch: 11, Steps: 208 | Train Loss: 0.454 Vali Loss: 6.990 Vali Acc: 0.100 Test Loss: 6.990 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4267316
	speed: 1.5255s/iter; left time: 28089.3873s
	iters: 200, epoch: 12 | loss: 0.2893884
	speed: 0.6198s/iter; left time: 11351.0880s
Epoch: 12 cost time: 128.4575469493866
Epoch: 12, Steps: 208 | Train Loss: 0.376 Vali Loss: 7.173 Vali Acc: 0.104 Test Loss: 7.173 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0627675
	speed: 1.4853s/iter; left time: 27039.1737s
	iters: 200, epoch: 13 | loss: 0.4424416
	speed: 0.5852s/iter; left time: 10595.8846s
Epoch: 13 cost time: 125.23690891265869
Epoch: 13, Steps: 208 | Train Loss: 0.339 Vali Loss: 7.662 Vali Acc: 0.106 Test Loss: 7.662 Test Acc: 0.106
Validation loss decreased (-0.104328 --> -0.105500).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3109522
	speed: 1.3508s/iter; left time: 24311.2003s
	iters: 200, epoch: 14 | loss: 0.1242095
	speed: 0.5534s/iter; left time: 9904.3260s
Epoch: 14 cost time: 114.32370138168335
Epoch: 14, Steps: 208 | Train Loss: 0.285 Vali Loss: 8.109 Vali Acc: 0.101 Test Loss: 8.109 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1494572
	speed: 1.3186s/iter; left time: 23457.2843s
	iters: 200, epoch: 15 | loss: 0.0827561
	speed: 0.5525s/iter; left time: 9773.4505s
Epoch: 15 cost time: 112.88338732719421
Epoch: 15, Steps: 208 | Train Loss: 0.234 Vali Loss: 8.546 Vali Acc: 0.098 Test Loss: 8.546 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3815779
	speed: 1.2878s/iter; left time: 22641.3853s
	iters: 200, epoch: 16 | loss: 0.1824881
	speed: 0.5690s/iter; left time: 9946.3795s
Epoch: 16 cost time: 114.60202050209045
Epoch: 16, Steps: 208 | Train Loss: 0.238 Vali Loss: 8.879 Vali Acc: 0.096 Test Loss: 8.879 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2081149
	speed: 1.3666s/iter; left time: 23742.7194s
	iters: 200, epoch: 17 | loss: 0.2510174
	speed: 0.6390s/iter; left time: 11036.6680s
Epoch: 17 cost time: 126.13359260559082
Epoch: 17, Steps: 208 | Train Loss: 0.190 Vali Loss: 9.285 Vali Acc: 0.097 Test Loss: 9.285 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2258465
	speed: 1.4004s/iter; left time: 24038.0945s
	iters: 200, epoch: 18 | loss: 0.1698511
	speed: 0.5812s/iter; left time: 9919.0208s
Epoch: 18 cost time: 119.57704782485962
Epoch: 18, Steps: 208 | Train Loss: 0.222 Vali Loss: 9.208 Vali Acc: 0.105 Test Loss: 9.208 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1732115
	speed: 1.4250s/iter; left time: 24163.7827s
	iters: 200, epoch: 19 | loss: 0.0594061
	speed: 0.5734s/iter; left time: 9665.9301s
Epoch: 19 cost time: 117.39970445632935
Epoch: 19, Steps: 208 | Train Loss: 0.208 Vali Loss: 9.696 Vali Acc: 0.094 Test Loss: 9.696 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1148746
	speed: 1.4875s/iter; left time: 24914.3656s
	iters: 200, epoch: 20 | loss: 0.0283527
	speed: 0.6042s/iter; left time: 10059.1017s
Epoch: 20 cost time: 128.34712386131287
Epoch: 20, Steps: 208 | Train Loss: 0.182 Vali Loss: 9.584 Vali Acc: 0.095 Test Loss: 9.584 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2175277
	speed: 1.3998s/iter; left time: 23153.9512s
	iters: 200, epoch: 21 | loss: 0.6435791
	speed: 0.5732s/iter; left time: 9424.4478s
Epoch: 21 cost time: 120.62150740623474
Epoch: 21, Steps: 208 | Train Loss: 0.174 Vali Loss: 9.716 Vali Acc: 0.097 Test Loss: 9.716 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1583158
	speed: 1.4188s/iter; left time: 23172.5991s
	iters: 200, epoch: 22 | loss: 0.0668127
	speed: 0.5773s/iter; left time: 9371.3421s
Epoch: 22 cost time: 122.91652250289917
Epoch: 22, Steps: 208 | Train Loss: 0.178 Vali Loss: 10.176 Vali Acc: 0.092 Test Loss: 10.176 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0561929
	speed: 1.4364s/iter; left time: 23161.4589s
	iters: 200, epoch: 23 | loss: 0.0208187
	speed: 0.5301s/iter; left time: 8495.3543s
Epoch: 23 cost time: 114.63638544082642
Epoch: 23, Steps: 208 | Train Loss: 0.135 Vali Loss: 10.352 Vali Acc: 0.095 Test Loss: 10.352 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma66_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10557709513868178
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7686772
	speed: 0.6005s/iter; left time: 12430.1916s
	iters: 200, epoch: 1 | loss: 3.9011493
	speed: 0.5872s/iter; left time: 12096.1037s
Epoch: 1 cost time: 123.91112613677979
Epoch: 1, Steps: 208 | Train Loss: 3.654 Vali Loss: 3.571 Vali Acc: 0.076 Test Loss: 3.571 Test Acc: 0.076
Validation loss decreased (inf --> -0.075717).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2414784
	speed: 1.3771s/iter; left time: 28221.0819s
	iters: 200, epoch: 2 | loss: 3.2535198
	speed: 0.5191s/iter; left time: 10586.0990s
Epoch: 2 cost time: 109.80806398391724
Epoch: 2, Steps: 208 | Train Loss: 3.186 Vali Loss: 3.551 Vali Acc: 0.097 Test Loss: 3.551 Test Acc: 0.097
Validation loss decreased (-0.075717 --> -0.096594).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0816669
	speed: 1.4194s/iter; left time: 28791.6249s
	iters: 200, epoch: 3 | loss: 3.0490179
	speed: 0.5756s/iter; left time: 11618.1338s
Epoch: 3 cost time: 121.26897430419922
Epoch: 3, Steps: 208 | Train Loss: 2.698 Vali Loss: 3.695 Vali Acc: 0.098 Test Loss: 3.695 Test Acc: 0.098
Validation loss decreased (-0.096594 --> -0.098084).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5753636
	speed: 1.3192s/iter; left time: 26485.9394s
	iters: 200, epoch: 4 | loss: 2.2829928
	speed: 0.5420s/iter; left time: 10826.9792s
Epoch: 4 cost time: 110.82316446304321
Epoch: 4, Steps: 208 | Train Loss: 2.233 Vali Loss: 3.836 Vali Acc: 0.104 Test Loss: 3.836 Test Acc: 0.104
Validation loss decreased (-0.098084 --> -0.103749).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6710297
	speed: 1.3294s/iter; left time: 26413.4664s
	iters: 200, epoch: 5 | loss: 2.2883966
	speed: 0.4996s/iter; left time: 9876.5581s
Epoch: 5 cost time: 108.30455923080444
Epoch: 5, Steps: 208 | Train Loss: 1.801 Vali Loss: 4.220 Vali Acc: 0.117 Test Loss: 4.220 Test Acc: 0.117
Validation loss decreased (-0.103749 --> -0.116868).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1690506
	speed: 1.3298s/iter; left time: 26146.0030s
	iters: 200, epoch: 6 | loss: 0.8984817
	speed: 0.5554s/iter; left time: 10865.1016s
Epoch: 6 cost time: 116.1240165233612
Epoch: 6, Steps: 208 | Train Loss: 1.343 Vali Loss: 4.675 Vali Acc: 0.104 Test Loss: 4.675 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0251144
	speed: 1.3191s/iter; left time: 25661.2769s
	iters: 200, epoch: 7 | loss: 1.4724997
	speed: 0.5609s/iter; left time: 10855.8176s
Epoch: 7 cost time: 116.5680878162384
Epoch: 7, Steps: 208 | Train Loss: 1.036 Vali Loss: 5.382 Vali Acc: 0.095 Test Loss: 5.382 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0290706
	speed: 1.4006s/iter; left time: 26955.1249s
	iters: 200, epoch: 8 | loss: 1.0599235
	speed: 0.6125s/iter; left time: 11725.6664s
Epoch: 8 cost time: 124.49639248847961
Epoch: 8, Steps: 208 | Train Loss: 0.790 Vali Loss: 5.698 Vali Acc: 0.105 Test Loss: 5.698 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6187025
	speed: 1.3163s/iter; left time: 25058.9620s
	iters: 200, epoch: 9 | loss: 0.8469771
	speed: 0.5741s/iter; left time: 10870.8330s
Epoch: 9 cost time: 115.36485719680786
Epoch: 9, Steps: 208 | Train Loss: 0.633 Vali Loss: 6.233 Vali Acc: 0.104 Test Loss: 6.233 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6724827
	speed: 1.3128s/iter; left time: 24719.3229s
	iters: 200, epoch: 10 | loss: 0.4581170
	speed: 0.5334s/iter; left time: 9990.0021s
Epoch: 10 cost time: 112.70086526870728
Epoch: 10, Steps: 208 | Train Loss: 0.515 Vali Loss: 6.678 Vali Acc: 0.096 Test Loss: 6.678 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2802383
	speed: 1.2862s/iter; left time: 23949.6346s
	iters: 200, epoch: 11 | loss: 0.9182456
	speed: 0.5708s/iter; left time: 10570.9393s
Epoch: 11 cost time: 116.25921702384949
Epoch: 11, Steps: 208 | Train Loss: 0.442 Vali Loss: 6.883 Vali Acc: 0.101 Test Loss: 6.883 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2087482
	speed: 1.3888s/iter; left time: 25571.3171s
	iters: 200, epoch: 12 | loss: 0.2952028
	speed: 0.5623s/iter; left time: 10297.0128s
Epoch: 12 cost time: 116.79640030860901
Epoch: 12, Steps: 208 | Train Loss: 0.402 Vali Loss: 7.363 Vali Acc: 0.102 Test Loss: 7.363 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0698726
	speed: 1.3773s/iter; left time: 25073.4080s
	iters: 200, epoch: 13 | loss: 0.3310237
	speed: 0.5823s/iter; left time: 10543.0774s
Epoch: 13 cost time: 118.59919309616089
Epoch: 13, Steps: 208 | Train Loss: 0.350 Vali Loss: 7.751 Vali Acc: 0.108 Test Loss: 7.751 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.4035130
	speed: 1.3530s/iter; left time: 24350.3425s
	iters: 200, epoch: 14 | loss: 0.2720410
	speed: 0.6213s/iter; left time: 11120.0287s
Epoch: 14 cost time: 122.99080348014832
Epoch: 14, Steps: 208 | Train Loss: 0.306 Vali Loss: 8.085 Vali Acc: 0.095 Test Loss: 8.085 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3804572
	speed: 1.3269s/iter; left time: 23604.8659s
	iters: 200, epoch: 15 | loss: 0.2410307
	speed: 0.5415s/iter; left time: 9579.4420s
Epoch: 15 cost time: 115.16658210754395
Epoch: 15, Steps: 208 | Train Loss: 0.236 Vali Loss: 8.492 Vali Acc: 0.099 Test Loss: 8.492 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11691022964509394
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         22                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6927454
	speed: 0.6613s/iter; left time: 13690.0935s
	iters: 200, epoch: 1 | loss: 3.8615220
	speed: 0.5482s/iter; left time: 11293.3904s
Epoch: 1 cost time: 125.35834670066833
Epoch: 1, Steps: 208 | Train Loss: 3.626 Vali Loss: 3.599 Vali Acc: 0.058 Test Loss: 3.599 Test Acc: 0.058
Validation loss decreased (inf --> -0.057823).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2917423
	speed: 1.4359s/iter; left time: 29426.7282s
	iters: 200, epoch: 2 | loss: 3.2958589
	speed: 0.5032s/iter; left time: 10261.3573s
Epoch: 2 cost time: 114.74714875221252
Epoch: 2, Steps: 208 | Train Loss: 3.176 Vali Loss: 3.655 Vali Acc: 0.078 Test Loss: 3.655 Test Acc: 0.078
Validation loss decreased (-0.057823 --> -0.077506).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0952158
	speed: 1.4810s/iter; left time: 30042.4838s
	iters: 200, epoch: 3 | loss: 3.0784874
	speed: 0.6004s/iter; left time: 12119.9125s
Epoch: 3 cost time: 124.8703043460846
Epoch: 3, Steps: 208 | Train Loss: 2.729 Vali Loss: 3.812 Vali Acc: 0.084 Test Loss: 3.812 Test Acc: 0.084
Validation loss decreased (-0.077506 --> -0.083767).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2103517
	speed: 1.4261s/iter; left time: 28632.1854s
	iters: 200, epoch: 4 | loss: 2.1512494
	speed: 0.5649s/iter; left time: 11285.5566s
Epoch: 4 cost time: 119.7632908821106
Epoch: 4, Steps: 208 | Train Loss: 2.275 Vali Loss: 4.037 Vali Acc: 0.090 Test Loss: 4.037 Test Acc: 0.090
Validation loss decreased (-0.083767 --> -0.089730).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5407008
	speed: 1.4351s/iter; left time: 28513.0478s
	iters: 200, epoch: 5 | loss: 2.2530205
	speed: 0.5545s/iter; left time: 10961.3885s
Epoch: 5 cost time: 121.31204295158386
Epoch: 5, Steps: 208 | Train Loss: 1.828 Vali Loss: 4.388 Vali Acc: 0.098 Test Loss: 4.388 Test Acc: 0.098
Validation loss decreased (-0.089730 --> -0.098375).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2354134
	speed: 1.4376s/iter; left time: 28263.6838s
	iters: 200, epoch: 6 | loss: 1.4703832
	speed: 0.5364s/iter; left time: 10493.3564s
Epoch: 6 cost time: 115.37860941886902
Epoch: 6, Steps: 208 | Train Loss: 1.387 Vali Loss: 4.897 Vali Acc: 0.101 Test Loss: 4.897 Test Acc: 0.101
Validation loss decreased (-0.098375 --> -0.100458).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1286008
	speed: 1.3712s/iter; left time: 26673.2519s
	iters: 200, epoch: 7 | loss: 1.4884313
	speed: 0.5663s/iter; left time: 10960.5675s
Epoch: 7 cost time: 116.8818633556366
Epoch: 7, Steps: 208 | Train Loss: 1.045 Vali Loss: 5.403 Vali Acc: 0.102 Test Loss: 5.403 Test Acc: 0.102
Validation loss decreased (-0.100458 --> -0.102242).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1366268
	speed: 1.5936s/iter; left time: 30668.6835s
	iters: 200, epoch: 8 | loss: 0.8766553
	speed: 0.7064s/iter; left time: 13523.4136s
Epoch: 8 cost time: 139.61005878448486
Epoch: 8, Steps: 208 | Train Loss: 0.837 Vali Loss: 5.677 Vali Acc: 0.103 Test Loss: 5.677 Test Acc: 0.103
Validation loss decreased (-0.102242 --> -0.102836).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9358466
	speed: 1.4485s/iter; left time: 27575.5906s
	iters: 200, epoch: 9 | loss: 0.4583636
	speed: 0.6186s/iter; left time: 11714.9558s
Epoch: 9 cost time: 125.47716784477234
Epoch: 9, Steps: 208 | Train Loss: 0.669 Vali Loss: 6.200 Vali Acc: 0.099 Test Loss: 6.200 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6178512
	speed: 1.4316s/iter; left time: 26955.8174s
	iters: 200, epoch: 10 | loss: 0.2941552
	speed: 0.6400s/iter; left time: 11986.9881s
Epoch: 10 cost time: 129.5594699382782
Epoch: 10, Steps: 208 | Train Loss: 0.575 Vali Loss: 6.463 Vali Acc: 0.098 Test Loss: 6.463 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3669504
	speed: 1.4188s/iter; left time: 26419.1567s
	iters: 200, epoch: 11 | loss: 0.7344798
	speed: 0.5793s/iter; left time: 10729.0966s
Epoch: 11 cost time: 121.73567819595337
Epoch: 11, Steps: 208 | Train Loss: 0.459 Vali Loss: 6.816 Vali Acc: 0.103 Test Loss: 6.816 Test Acc: 0.103
Validation loss decreased (-0.102836 --> -0.103421).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3680227
	speed: 1.4402s/iter; left time: 26518.4181s
	iters: 200, epoch: 12 | loss: 0.2502617
	speed: 0.6517s/iter; left time: 11934.0258s
Epoch: 12 cost time: 133.31326723098755
Epoch: 12, Steps: 208 | Train Loss: 0.420 Vali Loss: 7.491 Vali Acc: 0.092 Test Loss: 7.491 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1116755
	speed: 1.4627s/iter; left time: 26628.9033s
	iters: 200, epoch: 13 | loss: 0.2551383
	speed: 0.5738s/iter; left time: 10388.0082s
Epoch: 13 cost time: 120.99889349937439
Epoch: 13, Steps: 208 | Train Loss: 0.347 Vali Loss: 7.588 Vali Acc: 0.096 Test Loss: 7.588 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.2113477
	speed: 1.3618s/iter; left time: 24508.5889s
	iters: 200, epoch: 14 | loss: 0.1576622
	speed: 0.6330s/iter; left time: 11329.1173s
Epoch: 14 cost time: 127.45950746536255
Epoch: 14, Steps: 208 | Train Loss: 0.307 Vali Loss: 8.097 Vali Acc: 0.095 Test Loss: 8.097 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3763846
	speed: 1.4253s/iter; left time: 25354.7525s
	iters: 200, epoch: 15 | loss: 0.0560556
	speed: 0.6192s/iter; left time: 10953.7805s
Epoch: 15 cost time: 128.35559678077698
Epoch: 15, Steps: 208 | Train Loss: 0.284 Vali Loss: 8.534 Vali Acc: 0.104 Test Loss: 8.534 Test Acc: 0.104
Validation loss decreased (-0.103421 --> -0.104001).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0763609
	speed: 1.4291s/iter; left time: 25124.5303s
	iters: 200, epoch: 16 | loss: 0.1996520
	speed: 0.5767s/iter; left time: 10081.4810s
Epoch: 16 cost time: 123.35278058052063
Epoch: 16, Steps: 208 | Train Loss: 0.269 Vali Loss: 8.506 Vali Acc: 0.100 Test Loss: 8.506 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1401342
	speed: 1.4162s/iter; left time: 24602.8051s
	iters: 200, epoch: 17 | loss: 0.3219099
	speed: 0.6223s/iter; left time: 10748.2056s
Epoch: 17 cost time: 130.5124454498291
Epoch: 17, Steps: 208 | Train Loss: 0.246 Vali Loss: 8.786 Vali Acc: 0.098 Test Loss: 8.786 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4100380
	speed: 1.4174s/iter; left time: 24330.2031s
	iters: 200, epoch: 18 | loss: 0.2246856
	speed: 0.5875s/iter; left time: 10025.7457s
Epoch: 18 cost time: 123.18450140953064
Epoch: 18, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.428 Vali Acc: 0.101 Test Loss: 9.428 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0890103
	speed: 1.3832s/iter; left time: 23455.0643s
	iters: 200, epoch: 19 | loss: 0.0347288
	speed: 0.5772s/iter; left time: 9729.1207s
Epoch: 19 cost time: 121.47073125839233
Epoch: 19, Steps: 208 | Train Loss: 0.209 Vali Loss: 9.569 Vali Acc: 0.098 Test Loss: 9.569 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0046028
	speed: 1.4135s/iter; left time: 23673.9818s
	iters: 200, epoch: 20 | loss: 0.1136014
	speed: 0.6052s/iter; left time: 10075.3090s
Epoch: 20 cost time: 127.76379179954529
Epoch: 20, Steps: 208 | Train Loss: 0.186 Vali Loss: 9.728 Vali Acc: 0.104 Test Loss: 9.728 Test Acc: 0.104
Validation loss decreased (-0.104001 --> -0.104287).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1088498
	speed: 1.3534s/iter; left time: 22385.9492s
	iters: 200, epoch: 21 | loss: 0.4150636
	speed: 0.6267s/iter; left time: 10304.2203s
Epoch: 21 cost time: 125.68499732017517
Epoch: 21, Steps: 208 | Train Loss: 0.173 Vali Loss: 9.799 Vali Acc: 0.099 Test Loss: 9.799 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0612687
	speed: 1.4305s/iter; left time: 23364.7271s
	iters: 200, epoch: 22 | loss: 0.1162792
	speed: 0.5650s/iter; left time: 9170.8871s
Epoch: 22 cost time: 120.36418747901917
Epoch: 22, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.072 Vali Acc: 0.100 Test Loss: 10.072 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2665053
	speed: 1.3530s/iter; left time: 21817.5351s
	iters: 200, epoch: 23 | loss: 0.2673140
	speed: 0.5972s/iter; left time: 9570.1759s
Epoch: 23 cost time: 126.69821500778198
Epoch: 23, Steps: 208 | Train Loss: 0.164 Vali Loss: 10.098 Vali Acc: 0.102 Test Loss: 10.098 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1669018
	speed: 1.3911s/iter; left time: 22142.1369s
	iters: 200, epoch: 24 | loss: 0.3859518
	speed: 0.5574s/iter; left time: 8817.1662s
Epoch: 24 cost time: 117.92138814926147
Epoch: 24, Steps: 208 | Train Loss: 0.145 Vali Loss: 10.188 Vali Acc: 0.100 Test Loss: 10.188 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2990741
	speed: 1.4223s/iter; left time: 22342.6840s
	iters: 200, epoch: 25 | loss: 0.0242244
	speed: 0.5634s/iter; left time: 8794.7297s
Epoch: 25 cost time: 119.2760591506958
Epoch: 25, Steps: 208 | Train Loss: 0.141 Vali Loss: 10.845 Vali Acc: 0.095 Test Loss: 10.845 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1531896
	speed: 1.3555s/iter; left time: 21011.5201s
	iters: 200, epoch: 26 | loss: 0.0443286
	speed: 0.5676s/iter; left time: 8741.6395s
Epoch: 26 cost time: 116.5546305179596
Epoch: 26, Steps: 208 | Train Loss: 0.151 Vali Loss: 10.772 Vali Acc: 0.102 Test Loss: 10.772 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0834102
	speed: 1.4185s/iter; left time: 21692.4895s
	iters: 200, epoch: 27 | loss: 0.0664257
	speed: 0.6353s/iter; left time: 9651.3795s
Epoch: 27 cost time: 125.51676154136658
Epoch: 27, Steps: 208 | Train Loss: 0.141 Vali Loss: 10.617 Vali Acc: 0.105 Test Loss: 10.617 Test Acc: 0.105
Validation loss decreased (-0.104287 --> -0.104576).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0124239
	speed: 1.4160s/iter; left time: 21361.0521s
	iters: 200, epoch: 28 | loss: 0.3390984
	speed: 0.5749s/iter; left time: 8614.2311s
Epoch: 28 cost time: 120.09446597099304
Epoch: 28, Steps: 208 | Train Loss: 0.127 Vali Loss: 10.910 Vali Acc: 0.101 Test Loss: 10.910 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.2378307
	speed: 1.3677s/iter; left time: 20346.7625s
	iters: 200, epoch: 29 | loss: 0.2309267
	speed: 0.5689s/iter; left time: 8405.9809s
Epoch: 29 cost time: 120.49539017677307
Epoch: 29, Steps: 208 | Train Loss: 0.148 Vali Loss: 10.850 Vali Acc: 0.105 Test Loss: 10.850 Test Acc: 0.105
Validation loss decreased (-0.104576 --> -0.104872).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.3796514
	speed: 1.3697s/iter; left time: 20092.0644s
	iters: 200, epoch: 30 | loss: 0.1310498
	speed: 0.6165s/iter; left time: 8981.9535s
Epoch: 30 cost time: 126.68777346611023
Epoch: 30, Steps: 208 | Train Loss: 0.122 Vali Loss: 11.255 Vali Acc: 0.096 Test Loss: 11.255 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.2302874
	speed: 1.4036s/iter; left time: 20297.5390s
	iters: 200, epoch: 31 | loss: 0.0879608
	speed: 0.5414s/iter; left time: 7775.1469s
Epoch: 31 cost time: 117.60825037956238
Epoch: 31, Steps: 208 | Train Loss: 0.118 Vali Loss: 11.329 Vali Acc: 0.095 Test Loss: 11.329 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.4745138
	speed: 1.4261s/iter; left time: 20326.0927s
	iters: 200, epoch: 32 | loss: 0.0148544
	speed: 0.5113s/iter; left time: 7235.8275s
Epoch: 32 cost time: 115.87129473686218
Epoch: 32, Steps: 208 | Train Loss: 0.113 Vali Loss: 11.462 Vali Acc: 0.101 Test Loss: 11.462 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0060538
	speed: 1.3478s/iter; left time: 18929.3010s
	iters: 200, epoch: 33 | loss: 0.0030720
	speed: 0.5691s/iter; left time: 7936.4429s
Epoch: 33 cost time: 118.48937749862671
Epoch: 33, Steps: 208 | Train Loss: 0.108 Vali Loss: 11.514 Vali Acc: 0.098 Test Loss: 11.514 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.2744437
	speed: 1.4656s/iter; left time: 20279.0957s
	iters: 200, epoch: 34 | loss: 0.3474624
	speed: 0.5489s/iter; left time: 7540.1228s
Epoch: 34 cost time: 117.1040587425232
Epoch: 34, Steps: 208 | Train Loss: 0.108 Vali Loss: 11.859 Vali Acc: 0.091 Test Loss: 11.859 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0056367
	speed: 1.3524s/iter; left time: 18431.3675s
	iters: 200, epoch: 35 | loss: 0.1853974
	speed: 0.5730s/iter; left time: 7752.6437s
Epoch: 35 cost time: 117.61695504188538
Epoch: 35, Steps: 208 | Train Loss: 0.087 Vali Loss: 11.970 Vali Acc: 0.092 Test Loss: 11.970 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0060477
	speed: 1.3433s/iter; left time: 18028.0126s
	iters: 200, epoch: 36 | loss: 0.1509532
	speed: 0.5504s/iter; left time: 7331.5756s
Epoch: 36 cost time: 118.34381747245789
Epoch: 36, Steps: 208 | Train Loss: 0.105 Vali Loss: 11.788 Vali Acc: 0.103 Test Loss: 11.788 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0254121
	speed: 1.3486s/iter; left time: 17819.6325s
	iters: 200, epoch: 37 | loss: 0.0132156
	speed: 0.5853s/iter; left time: 7675.6304s
Epoch: 37 cost time: 122.81979775428772
Epoch: 37, Steps: 208 | Train Loss: 0.109 Vali Loss: 11.906 Vali Acc: 0.090 Test Loss: 11.906 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.2116163
	speed: 1.3312s/iter; left time: 17312.0678s
	iters: 200, epoch: 38 | loss: 0.0375407
	speed: 0.5281s/iter; left time: 6815.4951s
Epoch: 38 cost time: 111.66428446769714
Epoch: 38, Steps: 208 | Train Loss: 0.119 Vali Loss: 11.804 Vali Acc: 0.097 Test Loss: 11.804 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.3357192
	speed: 1.2418s/iter; left time: 15891.2088s
	iters: 200, epoch: 39 | loss: 0.4257433
	speed: 0.4978s/iter; left time: 6320.0872s
Epoch: 39 cost time: 108.3745174407959
Epoch: 39, Steps: 208 | Train Loss: 0.098 Vali Loss: 11.788 Vali Acc: 0.103 Test Loss: 11.788 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1049806143751864
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5918772
	speed: 0.4660s/iter; left time: 9647.6570s
	iters: 200, epoch: 1 | loss: 3.4377608
	speed: 0.4549s/iter; left time: 9371.8265s
Epoch: 1 cost time: 96.06565356254578
Epoch: 1, Steps: 208 | Train Loss: 3.615 Vali Loss: 3.622 Vali Acc: 0.059 Test Loss: 3.622 Test Acc: 0.059
Validation loss decreased (inf --> -0.059314).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0646000
	speed: 1.1320s/iter; left time: 23198.9100s
	iters: 200, epoch: 2 | loss: 3.0802579
	speed: 0.4307s/iter; left time: 8783.4287s
Epoch: 2 cost time: 92.06687378883362
Epoch: 2, Steps: 208 | Train Loss: 3.125 Vali Loss: 3.727 Vali Acc: 0.084 Test Loss: 3.727 Test Acc: 0.084
Validation loss decreased (-0.059314 --> -0.084067).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9885192
	speed: 1.0475s/iter; left time: 21249.2485s
	iters: 200, epoch: 3 | loss: 3.2744319
	speed: 0.4214s/iter; left time: 8506.5083s
Epoch: 3 cost time: 89.07683897018433
Epoch: 3, Steps: 208 | Train Loss: 2.719 Vali Loss: 3.889 Vali Acc: 0.090 Test Loss: 3.889 Test Acc: 0.090
Validation loss decreased (-0.084067 --> -0.090030).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3141809
	speed: 1.1275s/iter; left time: 22635.8849s
	iters: 200, epoch: 4 | loss: 2.3969910
	speed: 0.4518s/iter; left time: 9025.6635s
Epoch: 4 cost time: 96.11877179145813
Epoch: 4, Steps: 208 | Train Loss: 2.381 Vali Loss: 4.049 Vali Acc: 0.089 Test Loss: 4.049 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1310735
	speed: 1.0796s/iter; left time: 21451.1738s
	iters: 200, epoch: 5 | loss: 2.5210044
	speed: 0.4385s/iter; left time: 8668.8097s
Epoch: 5 cost time: 92.30339407920837
Epoch: 5, Steps: 208 | Train Loss: 2.072 Vali Loss: 4.321 Vali Acc: 0.095 Test Loss: 4.321 Test Acc: 0.095
Validation loss decreased (-0.090030 --> -0.094499).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6639522
	speed: 1.1715s/iter; left time: 23032.0179s
	iters: 200, epoch: 6 | loss: 1.4313842
	speed: 0.5053s/iter; left time: 9883.3528s
Epoch: 6 cost time: 103.2180724143982
Epoch: 6, Steps: 208 | Train Loss: 1.670 Vali Loss: 4.781 Vali Acc: 0.095 Test Loss: 4.781 Test Acc: 0.095
Validation loss decreased (-0.094499 --> -0.094793).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8509860
	speed: 1.0697s/iter; left time: 20808.9682s
	iters: 200, epoch: 7 | loss: 1.7421277
	speed: 0.4566s/iter; left time: 8837.2860s
Epoch: 7 cost time: 93.98459053039551
Epoch: 7, Steps: 208 | Train Loss: 1.330 Vali Loss: 5.242 Vali Acc: 0.096 Test Loss: 5.242 Test Acc: 0.096
Validation loss decreased (-0.094793 --> -0.095981).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2723950
	speed: 1.1846s/iter; left time: 22796.7954s
	iters: 200, epoch: 8 | loss: 1.3554587
	speed: 0.5084s/iter; left time: 9733.8688s
Epoch: 8 cost time: 104.18464422225952
Epoch: 8, Steps: 208 | Train Loss: 1.095 Vali Loss: 5.402 Vali Acc: 0.100 Test Loss: 5.402 Test Acc: 0.100
Validation loss decreased (-0.095981 --> -0.099857).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9862477
	speed: 1.0867s/iter; left time: 20687.4138s
	iters: 200, epoch: 9 | loss: 0.7336316
	speed: 0.4493s/iter; left time: 8508.7558s
Epoch: 9 cost time: 95.13583850860596
Epoch: 9, Steps: 208 | Train Loss: 0.875 Vali Loss: 5.871 Vali Acc: 0.095 Test Loss: 5.871 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8974450
	speed: 1.1016s/iter; left time: 20741.5349s
	iters: 200, epoch: 10 | loss: 0.5612543
	speed: 0.4972s/iter; left time: 9311.7433s
Epoch: 10 cost time: 101.29070091247559
Epoch: 10, Steps: 208 | Train Loss: 0.745 Vali Loss: 6.266 Vali Acc: 0.095 Test Loss: 6.266 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6001923
	speed: 1.0961s/iter; left time: 20409.5864s
	iters: 200, epoch: 11 | loss: 1.1979998
	speed: 0.4369s/iter; left time: 8092.6435s
Epoch: 11 cost time: 91.29660820960999
Epoch: 11, Steps: 208 | Train Loss: 0.624 Vali Loss: 6.413 Vali Acc: 0.096 Test Loss: 6.413 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4980603
	speed: 1.1201s/iter; left time: 20623.9046s
	iters: 200, epoch: 12 | loss: 0.3864477
	speed: 0.4846s/iter; left time: 8874.8328s
Epoch: 12 cost time: 102.67635369300842
Epoch: 12, Steps: 208 | Train Loss: 0.561 Vali Loss: 6.849 Vali Acc: 0.090 Test Loss: 6.849 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3516749
	speed: 1.0908s/iter; left time: 19857.9080s
	iters: 200, epoch: 13 | loss: 0.1843851
	speed: 0.4237s/iter; left time: 7670.7047s
Epoch: 13 cost time: 91.31397676467896
Epoch: 13, Steps: 208 | Train Loss: 0.481 Vali Loss: 7.386 Vali Acc: 0.089 Test Loss: 7.386 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6170487
	speed: 1.1198s/iter; left time: 20153.3144s
	iters: 200, epoch: 14 | loss: 0.1135441
	speed: 0.4500s/iter; left time: 8053.3074s
Epoch: 14 cost time: 98.72998261451721
Epoch: 14, Steps: 208 | Train Loss: 0.448 Vali Loss: 7.528 Vali Acc: 0.096 Test Loss: 7.528 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.2986263
	speed: 1.0968s/iter; left time: 19511.4936s
	iters: 200, epoch: 15 | loss: 0.3610300
	speed: 0.4082s/iter; left time: 7219.8363s
Epoch: 15 cost time: 88.59336638450623
Epoch: 15, Steps: 208 | Train Loss: 0.422 Vali Loss: 7.958 Vali Acc: 0.092 Test Loss: 7.958 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1168569
	speed: 1.0258s/iter; left time: 18035.3445s
	iters: 200, epoch: 16 | loss: 0.4319556
	speed: 0.4579s/iter; left time: 8004.6029s
Epoch: 16 cost time: 91.92514848709106
Epoch: 16, Steps: 208 | Train Loss: 0.358 Vali Loss: 8.020 Vali Acc: 0.096 Test Loss: 8.020 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.3226351
	speed: 1.0935s/iter; left time: 18997.6173s
	iters: 200, epoch: 17 | loss: 0.1885509
	speed: 0.4549s/iter; left time: 7858.0758s
Epoch: 17 cost time: 92.7971739768982
Epoch: 17, Steps: 208 | Train Loss: 0.350 Vali Loss: 8.229 Vali Acc: 0.096 Test Loss: 8.229 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0676299
	speed: 1.1134s/iter; left time: 19111.4108s
	iters: 200, epoch: 18 | loss: 0.1225062
	speed: 0.5083s/iter; left time: 8674.3639s
Epoch: 18 cost time: 101.88422799110413
Epoch: 18, Steps: 208 | Train Loss: 0.307 Vali Loss: 8.315 Vali Acc: 0.103 Test Loss: 8.315 Test Acc: 0.103
Validation loss decreased (-0.099857 --> -0.102512).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1108483
	speed: 1.1975s/iter; left time: 20306.4349s
	iters: 200, epoch: 19 | loss: 0.0088777
	speed: 0.5290s/iter; left time: 8916.9472s
Epoch: 19 cost time: 106.82386708259583
Epoch: 19, Steps: 208 | Train Loss: 0.282 Vali Loss: 8.874 Vali Acc: 0.093 Test Loss: 8.874 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1408912
	speed: 1.2868s/iter; left time: 21552.4231s
	iters: 200, epoch: 20 | loss: 0.3155299
	speed: 0.4809s/iter; left time: 8006.7294s
Epoch: 20 cost time: 104.04570126533508
Epoch: 20, Steps: 208 | Train Loss: 0.270 Vali Loss: 8.874 Vali Acc: 0.094 Test Loss: 8.874 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1219748
	speed: 1.2686s/iter; left time: 20984.4826s
	iters: 200, epoch: 21 | loss: 0.4254631
	speed: 0.5237s/iter; left time: 8610.7365s
Epoch: 21 cost time: 110.76887226104736
Epoch: 21, Steps: 208 | Train Loss: 0.275 Vali Loss: 8.985 Vali Acc: 0.095 Test Loss: 8.985 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.4025373
	speed: 1.1933s/iter; left time: 19490.1552s
	iters: 200, epoch: 22 | loss: 0.2271978
	speed: 0.4551s/iter; left time: 7387.3819s
Epoch: 22 cost time: 96.17515206336975
Epoch: 22, Steps: 208 | Train Loss: 0.249 Vali Loss: 9.352 Vali Acc: 0.100 Test Loss: 9.352 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1627865
	speed: 1.2392s/iter; left time: 19981.9262s
	iters: 200, epoch: 23 | loss: 0.3422860
	speed: 0.5547s/iter; left time: 8888.4020s
Epoch: 23 cost time: 110.76910305023193
Epoch: 23, Steps: 208 | Train Loss: 0.211 Vali Loss: 9.582 Vali Acc: 0.102 Test Loss: 9.582 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.6215929
	speed: 1.2364s/iter; left time: 19679.8715s
	iters: 200, epoch: 24 | loss: 0.1771666
	speed: 0.5258s/iter; left time: 8316.6211s
Epoch: 24 cost time: 107.84341311454773
Epoch: 24, Steps: 208 | Train Loss: 0.210 Vali Loss: 9.731 Vali Acc: 0.098 Test Loss: 9.731 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.1253186
	speed: 1.1572s/iter; left time: 18177.6839s
	iters: 200, epoch: 25 | loss: 0.6528327
	speed: 0.4372s/iter; left time: 6824.6389s
Epoch: 25 cost time: 93.88059687614441
Epoch: 25, Steps: 208 | Train Loss: 0.202 Vali Loss: 9.813 Vali Acc: 0.104 Test Loss: 9.813 Test Acc: 0.104
Validation loss decreased (-0.102512 --> -0.104286).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0444902
	speed: 1.0773s/iter; left time: 16699.0950s
	iters: 200, epoch: 26 | loss: 0.2401121
	speed: 0.4284s/iter; left time: 6597.3536s
Epoch: 26 cost time: 91.811274766922
Epoch: 26, Steps: 208 | Train Loss: 0.212 Vali Loss: 9.887 Vali Acc: 0.100 Test Loss: 9.887 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.5458665
	speed: 1.2017s/iter; left time: 18377.6447s
	iters: 200, epoch: 27 | loss: 0.0790424
	speed: 0.4368s/iter; left time: 6636.8673s
Epoch: 27 cost time: 99.80961799621582
Epoch: 27, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.209 Vali Acc: 0.103 Test Loss: 10.209 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0279265
	speed: 1.0661s/iter; left time: 16082.6916s
	iters: 200, epoch: 28 | loss: 0.0723484
	speed: 0.4227s/iter; left time: 6333.9497s
Epoch: 28 cost time: 90.18137335777283
Epoch: 28, Steps: 208 | Train Loss: 0.178 Vali Loss: 10.430 Vali Acc: 0.098 Test Loss: 10.430 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0761589
	speed: 1.2057s/iter; left time: 17937.0766s
	iters: 200, epoch: 29 | loss: 0.0954376
	speed: 0.4454s/iter; left time: 6581.7301s
Epoch: 29 cost time: 99.52664685249329
Epoch: 29, Steps: 208 | Train Loss: 0.172 Vali Loss: 10.142 Vali Acc: 0.103 Test Loss: 10.142 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1635941
	speed: 1.0882s/iter; left time: 15963.3925s
	iters: 200, epoch: 30 | loss: 0.0512622
	speed: 0.4561s/iter; left time: 6644.6317s
Epoch: 30 cost time: 94.22558450698853
Epoch: 30, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.314 Vali Acc: 0.100 Test Loss: 10.314 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0909858
	speed: 1.1206s/iter; left time: 16205.5199s
	iters: 200, epoch: 31 | loss: 0.0267408
	speed: 0.4166s/iter; left time: 5982.3999s
Epoch: 31 cost time: 90.24919986724854
Epoch: 31, Steps: 208 | Train Loss: 0.163 Vali Loss: 10.802 Vali Acc: 0.098 Test Loss: 10.802 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.3863333
	speed: 1.0845s/iter; left time: 15457.8718s
	iters: 200, epoch: 32 | loss: 0.0199062
	speed: 0.4698s/iter; left time: 6649.4744s
Epoch: 32 cost time: 97.50699281692505
Epoch: 32, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.776 Vali Acc: 0.091 Test Loss: 10.776 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.2294198
	speed: 1.2141s/iter; left time: 17052.1181s
	iters: 200, epoch: 33 | loss: 0.1125181
	speed: 0.5183s/iter; left time: 7227.2067s
Epoch: 33 cost time: 102.56404519081116
Epoch: 33, Steps: 208 | Train Loss: 0.149 Vali Loss: 10.756 Vali Acc: 0.099 Test Loss: 10.756 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.3629628
	speed: 1.2687s/iter; left time: 17555.2592s
	iters: 200, epoch: 34 | loss: 0.0158856
	speed: 0.5464s/iter; left time: 7506.1297s
Epoch: 34 cost time: 110.51535606384277
Epoch: 34, Steps: 208 | Train Loss: 0.150 Vali Loss: 10.827 Vali Acc: 0.100 Test Loss: 10.827 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.2776206
	speed: 1.2180s/iter; left time: 16600.0417s
	iters: 200, epoch: 35 | loss: 0.4580273
	speed: 0.5074s/iter; left time: 6864.9518s
Epoch: 35 cost time: 106.7228753566742
Epoch: 35, Steps: 208 | Train Loss: 0.125 Vali Loss: 11.177 Vali Acc: 0.100 Test Loss: 11.177 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10438413361169102
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6292510
	speed: 0.5974s/iter; left time: 12366.9918s
	iters: 200, epoch: 1 | loss: 3.6947825
	speed: 0.4855s/iter; left time: 10001.8519s
Epoch: 1 cost time: 112.71099138259888
Epoch: 1, Steps: 208 | Train Loss: 3.623 Vali Loss: 3.625 Vali Acc: 0.055 Test Loss: 3.625 Test Acc: 0.055
Validation loss decreased (inf --> -0.055436).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2713597
	speed: 1.2088s/iter; left time: 24772.7719s
	iters: 200, epoch: 2 | loss: 3.3589604
	speed: 0.5095s/iter; left time: 10390.1912s
Epoch: 2 cost time: 109.47106051445007
Epoch: 2, Steps: 208 | Train Loss: 3.213 Vali Loss: 3.795 Vali Acc: 0.072 Test Loss: 3.795 Test Acc: 0.072
Validation loss decreased (-0.055436 --> -0.071540).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2696579
	speed: 1.2045s/iter; left time: 24433.1458s
	iters: 200, epoch: 3 | loss: 3.4922912
	speed: 0.5159s/iter; left time: 10412.6248s
Epoch: 3 cost time: 105.96478390693665
Epoch: 3, Steps: 208 | Train Loss: 2.880 Vali Loss: 3.995 Vali Acc: 0.062 Test Loss: 3.995 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6392796
	speed: 1.3313s/iter; left time: 26729.0051s
	iters: 200, epoch: 4 | loss: 2.5469830
	speed: 0.5091s/iter; left time: 10170.6129s
Epoch: 4 cost time: 108.78303527832031
Epoch: 4, Steps: 208 | Train Loss: 2.603 Vali Loss: 4.103 Vali Acc: 0.072 Test Loss: 4.103 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.7538002
	speed: 1.2610s/iter; left time: 25054.0244s
	iters: 200, epoch: 5 | loss: 2.4949701
	speed: 0.5144s/iter; left time: 10168.5248s
Epoch: 5 cost time: 111.68750667572021
Epoch: 5, Steps: 208 | Train Loss: 2.347 Vali Loss: 4.230 Vali Acc: 0.088 Test Loss: 4.230 Test Acc: 0.088
Validation loss decreased (-0.071540 --> -0.087939).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7929908
	speed: 1.1977s/iter; left time: 23548.3530s
	iters: 200, epoch: 6 | loss: 1.9941560
	speed: 0.5515s/iter; left time: 10788.8394s
Epoch: 6 cost time: 113.72928309440613
Epoch: 6, Steps: 208 | Train Loss: 2.020 Vali Loss: 4.601 Vali Acc: 0.083 Test Loss: 4.601 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6779938
	speed: 1.2090s/iter; left time: 23519.5148s
	iters: 200, epoch: 7 | loss: 2.0341101
	speed: 0.4827s/iter; left time: 9340.8597s
Epoch: 7 cost time: 99.80509901046753
Epoch: 7, Steps: 208 | Train Loss: 1.696 Vali Loss: 4.979 Vali Acc: 0.086 Test Loss: 4.979 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5716240
	speed: 1.2738s/iter; left time: 24515.0492s
	iters: 200, epoch: 8 | loss: 1.6049256
	speed: 0.4911s/iter; left time: 9402.9768s
Epoch: 8 cost time: 105.96035695075989
Epoch: 8, Steps: 208 | Train Loss: 1.439 Vali Loss: 5.166 Vali Acc: 0.083 Test Loss: 5.166 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1925368
	speed: 1.1542s/iter; left time: 21972.6124s
	iters: 200, epoch: 9 | loss: 1.2957280
	speed: 0.4853s/iter; left time: 9190.2675s
Epoch: 9 cost time: 104.77691388130188
Epoch: 9, Steps: 208 | Train Loss: 1.165 Vali Loss: 5.384 Vali Acc: 0.090 Test Loss: 5.384 Test Acc: 0.090
Validation loss decreased (-0.087939 --> -0.089717).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7215582
	speed: 1.1329s/iter; left time: 21330.7233s
	iters: 200, epoch: 10 | loss: 1.1195725
	speed: 0.4700s/iter; left time: 8802.4960s
Epoch: 10 cost time: 98.45607566833496
Epoch: 10, Steps: 208 | Train Loss: 0.981 Vali Loss: 5.875 Vali Acc: 0.093 Test Loss: 5.875 Test Acc: 0.093
Validation loss decreased (-0.089717 --> -0.092694).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7166990
	speed: 1.1919s/iter; left time: 22193.4601s
	iters: 200, epoch: 11 | loss: 1.7195703
	speed: 0.4355s/iter; left time: 8066.2513s
Epoch: 11 cost time: 95.47973775863647
Epoch: 11, Steps: 208 | Train Loss: 0.808 Vali Loss: 6.201 Vali Acc: 0.092 Test Loss: 6.201 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5353176
	speed: 1.0059s/iter; left time: 18521.5626s
	iters: 200, epoch: 12 | loss: 1.0315909
	speed: 0.4308s/iter; left time: 7889.7544s
Epoch: 12 cost time: 90.41472458839417
Epoch: 12, Steps: 208 | Train Loss: 0.733 Vali Loss: 6.544 Vali Acc: 0.091 Test Loss: 6.544 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3662054
	speed: 1.0145s/iter; left time: 18468.4586s
	iters: 200, epoch: 13 | loss: 0.2891857
	speed: 0.4084s/iter; left time: 7394.2311s
Epoch: 13 cost time: 89.69998049736023
Epoch: 13, Steps: 208 | Train Loss: 0.639 Vali Loss: 6.866 Vali Acc: 0.088 Test Loss: 6.866 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7998748
	speed: 0.9022s/iter; left time: 16237.2644s
	iters: 200, epoch: 14 | loss: 0.4036278
	speed: 0.3559s/iter; left time: 6368.9409s
Epoch: 14 cost time: 75.16198992729187
Epoch: 14, Steps: 208 | Train Loss: 0.577 Vali Loss: 7.037 Vali Acc: 0.089 Test Loss: 7.037 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3834710
	speed: 0.9001s/iter; left time: 16011.6458s
	iters: 200, epoch: 15 | loss: 0.4352769
	speed: 0.3862s/iter; left time: 6831.8334s
Epoch: 15 cost time: 79.53561091423035
Epoch: 15, Steps: 208 | Train Loss: 0.510 Vali Loss: 7.237 Vali Acc: 0.093 Test Loss: 7.237 Test Acc: 0.093
Validation loss decreased (-0.092694 --> -0.093277).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1500730
	speed: 0.8101s/iter; left time: 14242.5765s
	iters: 200, epoch: 16 | loss: 0.7909648
	speed: 0.2454s/iter; left time: 4289.6625s
Epoch: 16 cost time: 52.24295973777771
Epoch: 16, Steps: 208 | Train Loss: 0.452 Vali Loss: 7.550 Vali Acc: 0.094 Test Loss: 7.550 Test Acc: 0.094
Validation loss decreased (-0.093277 --> -0.093870).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4737117
	speed: 0.5210s/iter; left time: 9051.2075s
	iters: 200, epoch: 17 | loss: 0.6885495
	speed: 0.2195s/iter; left time: 3791.1154s
Epoch: 17 cost time: 45.84098029136658
Epoch: 17, Steps: 208 | Train Loss: 0.419 Vali Loss: 7.885 Vali Acc: 0.091 Test Loss: 7.885 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2223790
	speed: 0.5059s/iter; left time: 8683.1462s
	iters: 200, epoch: 18 | loss: 0.4240982
	speed: 0.2285s/iter; left time: 3900.1576s
Epoch: 18 cost time: 47.6897497177124
Epoch: 18, Steps: 208 | Train Loss: 0.384 Vali Loss: 7.950 Vali Acc: 0.095 Test Loss: 7.950 Test Acc: 0.095
Validation loss decreased (-0.093870 --> -0.095357).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4234406
	speed: 0.5665s/iter; left time: 9606.6018s
	iters: 200, epoch: 19 | loss: 0.1402083
	speed: 0.2594s/iter; left time: 4372.6985s
Epoch: 19 cost time: 54.24471616744995
Epoch: 19, Steps: 208 | Train Loss: 0.383 Vali Loss: 8.249 Vali Acc: 0.091 Test Loss: 8.249 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.2256004
	speed: 0.5679s/iter; left time: 9512.3548s
	iters: 200, epoch: 20 | loss: 0.2333499
	speed: 0.2261s/iter; left time: 3764.2976s
Epoch: 20 cost time: 48.2851505279541
Epoch: 20, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.682 Vali Acc: 0.091 Test Loss: 8.682 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1246246
	speed: 0.5309s/iter; left time: 8781.1495s
	iters: 200, epoch: 21 | loss: 0.2630824
	speed: 0.2277s/iter; left time: 3744.0082s
Epoch: 21 cost time: 47.42442345619202
Epoch: 21, Steps: 208 | Train Loss: 0.293 Vali Loss: 8.753 Vali Acc: 0.096 Test Loss: 8.753 Test Acc: 0.096
Validation loss decreased (-0.095357 --> -0.095946).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.7310288
	speed: 0.5398s/iter; left time: 8816.8024s
	iters: 200, epoch: 22 | loss: 0.0918287
	speed: 0.2501s/iter; left time: 4059.2832s
Epoch: 22 cost time: 51.91547632217407
Epoch: 22, Steps: 208 | Train Loss: 0.296 Vali Loss: 8.548 Vali Acc: 0.094 Test Loss: 8.548 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3418974
	speed: 0.5897s/iter; left time: 9508.2535s
	iters: 200, epoch: 23 | loss: 0.5468306
	speed: 0.2440s/iter; left time: 3910.4757s
Epoch: 23 cost time: 51.544251918792725
Epoch: 23, Steps: 208 | Train Loss: 0.278 Vali Loss: 9.036 Vali Acc: 0.098 Test Loss: 9.036 Test Acc: 0.098
Validation loss decreased (-0.095946 --> -0.098031).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1176523
	speed: 0.5090s/iter; left time: 8102.0762s
	iters: 200, epoch: 24 | loss: 0.2528350
	speed: 0.2278s/iter; left time: 3602.4295s
Epoch: 24 cost time: 46.91422367095947
Epoch: 24, Steps: 208 | Train Loss: 0.255 Vali Loss: 9.165 Vali Acc: 0.093 Test Loss: 9.165 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.8084311
	speed: 0.5315s/iter; left time: 8349.6334s
	iters: 200, epoch: 25 | loss: 0.1187076
	speed: 0.2321s/iter; left time: 3622.7205s
Epoch: 25 cost time: 48.72426724433899
Epoch: 25, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.119 Vali Acc: 0.101 Test Loss: 9.119 Test Acc: 0.101
Validation loss decreased (-0.098031 --> -0.101012).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0593106
	speed: 0.5951s/iter; left time: 9224.8476s
	iters: 200, epoch: 26 | loss: 0.2146736
	speed: 0.2487s/iter; left time: 3829.5451s
Epoch: 26 cost time: 53.51139235496521
Epoch: 26, Steps: 208 | Train Loss: 0.240 Vali Loss: 9.094 Vali Acc: 0.098 Test Loss: 9.094 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.4930845
	speed: 0.5540s/iter; left time: 8472.6310s
	iters: 200, epoch: 27 | loss: 0.2456453
	speed: 0.2267s/iter; left time: 3443.6701s
Epoch: 27 cost time: 47.572258710861206
Epoch: 27, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.625 Vali Acc: 0.101 Test Loss: 9.625 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0418931
	speed: 0.5289s/iter; left time: 7978.5282s
	iters: 200, epoch: 28 | loss: 0.0522166
	speed: 0.2292s/iter; left time: 3435.1983s
Epoch: 28 cost time: 48.50270462036133
Epoch: 28, Steps: 208 | Train Loss: 0.233 Vali Loss: 9.421 Vali Acc: 0.101 Test Loss: 9.421 Test Acc: 0.101
Validation loss decreased (-0.101012 --> -0.101308).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.2265605
	speed: 0.5159s/iter; left time: 7675.0294s
	iters: 200, epoch: 29 | loss: 0.1806339
	speed: 0.2519s/iter; left time: 3722.5458s
Epoch: 29 cost time: 50.008172035217285
Epoch: 29, Steps: 208 | Train Loss: 0.198 Vali Loss: 10.098 Vali Acc: 0.095 Test Loss: 10.098 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.1432910
	speed: 0.5753s/iter; left time: 8438.9011s
	iters: 200, epoch: 30 | loss: 0.2915876
	speed: 0.2374s/iter; left time: 3457.9842s
Epoch: 30 cost time: 50.997193336486816
Epoch: 30, Steps: 208 | Train Loss: 0.187 Vali Loss: 9.923 Vali Acc: 0.098 Test Loss: 9.923 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.3699836
	speed: 0.5053s/iter; left time: 7307.4879s
	iters: 200, epoch: 31 | loss: 0.1598139
	speed: 0.2326s/iter; left time: 3341.0648s
Epoch: 31 cost time: 47.62405514717102
Epoch: 31, Steps: 208 | Train Loss: 0.187 Vali Loss: 10.267 Vali Acc: 0.098 Test Loss: 10.267 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.3962978
	speed: 0.5268s/iter; left time: 7508.7991s
	iters: 200, epoch: 32 | loss: 0.3841052
	speed: 0.2330s/iter; left time: 3298.2463s
Epoch: 32 cost time: 48.71406102180481
Epoch: 32, Steps: 208 | Train Loss: 0.187 Vali Loss: 9.973 Vali Acc: 0.098 Test Loss: 9.973 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0236281
	speed: 0.5743s/iter; left time: 8065.7301s
	iters: 200, epoch: 33 | loss: 0.1738612
	speed: 0.2422s/iter; left time: 3377.7121s
Epoch: 33 cost time: 52.53878998756409
Epoch: 33, Steps: 208 | Train Loss: 0.159 Vali Loss: 10.384 Vali Acc: 0.098 Test Loss: 10.384 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0641334
	speed: 0.5325s/iter; left time: 7368.8639s
	iters: 200, epoch: 34 | loss: 0.4633289
	speed: 0.2382s/iter; left time: 3272.5923s
Epoch: 34 cost time: 49.16107726097107
Epoch: 34, Steps: 208 | Train Loss: 0.157 Vali Loss: 10.444 Vali Acc: 0.094 Test Loss: 10.444 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0305119
	speed: 0.5152s/iter; left time: 7021.7554s
	iters: 200, epoch: 35 | loss: 0.3446876
	speed: 0.2257s/iter; left time: 3053.9133s
Epoch: 35 cost time: 47.40662384033203
Epoch: 35, Steps: 208 | Train Loss: 0.166 Vali Loss: 10.569 Vali Acc: 0.098 Test Loss: 10.569 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.4433760
	speed: 0.5222s/iter; left time: 7008.3272s
	iters: 200, epoch: 36 | loss: 0.0930808
	speed: 0.2210s/iter; left time: 2944.4773s
Epoch: 36 cost time: 47.8452672958374
Epoch: 36, Steps: 208 | Train Loss: 0.182 Vali Loss: 10.672 Vali Acc: 0.097 Test Loss: 10.672 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.1515529
	speed: 0.5860s/iter; left time: 7743.3955s
	iters: 200, epoch: 37 | loss: 0.1352578
	speed: 0.2445s/iter; left time: 3205.5276s
Epoch: 37 cost time: 53.005581855773926
Epoch: 37, Steps: 208 | Train Loss: 0.160 Vali Loss: 10.679 Vali Acc: 0.099 Test Loss: 10.679 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.4538952
	speed: 0.5602s/iter; left time: 7285.4860s
	iters: 200, epoch: 38 | loss: 0.0462550
	speed: 0.2297s/iter; left time: 2964.4459s
Epoch: 38 cost time: 48.913387298583984
Epoch: 38, Steps: 208 | Train Loss: 0.134 Vali Loss: 10.963 Vali Acc: 0.097 Test Loss: 10.963 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10140172979421413
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6912944
	speed: 0.2321s/iter; left time: 4805.3091s
	iters: 200, epoch: 1 | loss: 3.6898577
	speed: 0.2310s/iter; left time: 4759.0923s
Epoch: 1 cost time: 48.67950201034546
Epoch: 1, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.717 Vali Acc: 0.047 Test Loss: 3.717 Test Acc: 0.047
Validation loss decreased (inf --> -0.047085).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2692835
	speed: 0.5917s/iter; left time: 12126.2902s
	iters: 200, epoch: 2 | loss: 3.5874999
	speed: 0.2443s/iter; left time: 4982.0567s
Epoch: 2 cost time: 54.31565976142883
Epoch: 2, Steps: 208 | Train Loss: 3.282 Vali Loss: 4.031 Vali Acc: 0.038 Test Loss: 4.031 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3033221
	speed: 0.5750s/iter; left time: 11663.3683s
	iters: 200, epoch: 3 | loss: 3.7420361
	speed: 0.2261s/iter; left time: 4563.2478s
Epoch: 3 cost time: 49.010961055755615
Epoch: 3, Steps: 208 | Train Loss: 3.037 Vali Loss: 4.309 Vali Acc: 0.043 Test Loss: 4.309 Test Acc: 0.043
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.7780378
	speed: 0.5269s/iter; left time: 10578.5459s
	iters: 200, epoch: 4 | loss: 3.1308978
	speed: 0.2368s/iter; left time: 4730.2959s
Epoch: 4 cost time: 48.87820553779602
Epoch: 4, Steps: 208 | Train Loss: 2.811 Vali Loss: 4.415 Vali Acc: 0.048 Test Loss: 4.415 Test Acc: 0.048
Validation loss decreased (-0.047085 --> -0.047674).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0846906
	speed: 0.5344s/iter; left time: 10617.7746s
	iters: 200, epoch: 5 | loss: 2.8859584
	speed: 0.2555s/iter; left time: 5051.6151s
Epoch: 5 cost time: 51.43416738510132
Epoch: 5, Steps: 208 | Train Loss: 2.636 Vali Loss: 4.655 Vali Acc: 0.050 Test Loss: 4.655 Test Acc: 0.050
Validation loss decreased (-0.047674 --> -0.049760).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6040437
	speed: 0.5934s/iter; left time: 11665.9916s
	iters: 200, epoch: 6 | loss: 2.0657556
	speed: 0.2342s/iter; left time: 4580.8389s
Epoch: 6 cost time: 51.086061239242554
Epoch: 6, Steps: 208 | Train Loss: 2.367 Vali Loss: 4.706 Vali Acc: 0.061 Test Loss: 4.706 Test Acc: 0.061
Validation loss decreased (-0.049760 --> -0.061092).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0231442
	speed: 0.5327s/iter; left time: 10361.9844s
	iters: 200, epoch: 7 | loss: 2.8985078
	speed: 0.2266s/iter; left time: 4385.9562s
Epoch: 7 cost time: 47.39248299598694
Epoch: 7, Steps: 208 | Train Loss: 2.124 Vali Loss: 5.007 Vali Acc: 0.059 Test Loss: 5.007 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8220139
	speed: 0.5265s/iter; left time: 10133.3595s
	iters: 200, epoch: 8 | loss: 1.7782463
	speed: 0.2234s/iter; left time: 4276.6305s
Epoch: 8 cost time: 47.540083169937134
Epoch: 8, Steps: 208 | Train Loss: 1.808 Vali Loss: 5.205 Vali Acc: 0.062 Test Loss: 5.205 Test Acc: 0.062
Validation loss decreased (-0.061092 --> -0.062280).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4017369
	speed: 0.5642s/iter; left time: 10739.8527s
	iters: 200, epoch: 9 | loss: 1.5213686
	speed: 0.2633s/iter; left time: 4985.9556s
Epoch: 9 cost time: 54.08649015426636
Epoch: 9, Steps: 208 | Train Loss: 1.561 Vali Loss: 5.450 Vali Acc: 0.069 Test Loss: 5.450 Test Acc: 0.069
Validation loss decreased (-0.062280 --> -0.068541).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0890702
	speed: 0.5591s/iter; left time: 10527.6164s
	iters: 200, epoch: 10 | loss: 1.4174192
	speed: 0.2216s/iter; left time: 4150.5925s
Epoch: 10 cost time: 48.27137494087219
Epoch: 10, Steps: 208 | Train Loss: 1.319 Vali Loss: 5.752 Vali Acc: 0.071 Test Loss: 5.752 Test Acc: 0.071
Validation loss decreased (-0.068541 --> -0.070924).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6584126
	speed: 0.4913s/iter; left time: 9147.6486s
	iters: 200, epoch: 11 | loss: 1.6422468
	speed: 0.2128s/iter; left time: 3941.2889s
Epoch: 11 cost time: 44.18979001045227
Epoch: 11, Steps: 208 | Train Loss: 1.098 Vali Loss: 6.076 Vali Acc: 0.074 Test Loss: 6.076 Test Acc: 0.074
Validation loss decreased (-0.070924 --> -0.074201).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2914616
	speed: 0.5120s/iter; left time: 9427.9521s
	iters: 200, epoch: 12 | loss: 0.6834862
	speed: 0.2525s/iter; left time: 4624.5977s
Epoch: 12 cost time: 50.754215240478516
Epoch: 12, Steps: 208 | Train Loss: 0.943 Vali Loss: 6.391 Vali Acc: 0.076 Test Loss: 6.391 Test Acc: 0.076
Validation loss decreased (-0.074201 --> -0.076286).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5955716
	speed: 0.5951s/iter; left time: 10834.0738s
	iters: 200, epoch: 13 | loss: 0.9926000
	speed: 0.2317s/iter; left time: 4195.6024s
Epoch: 13 cost time: 49.69136190414429
Epoch: 13, Steps: 208 | Train Loss: 0.809 Vali Loss: 6.758 Vali Acc: 0.074 Test Loss: 6.758 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8881564
	speed: 0.4938s/iter; left time: 8886.2006s
	iters: 200, epoch: 14 | loss: 0.4429667
	speed: 0.2236s/iter; left time: 4002.2629s
Epoch: 14 cost time: 44.86312174797058
Epoch: 14, Steps: 208 | Train Loss: 0.710 Vali Loss: 7.116 Vali Acc: 0.077 Test Loss: 7.116 Test Acc: 0.077
Validation loss decreased (-0.076286 --> -0.076875).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3383809
	speed: 0.5235s/iter; left time: 9313.0627s
	iters: 200, epoch: 15 | loss: 0.2628189
	speed: 0.2352s/iter; left time: 4160.1641s
Epoch: 15 cost time: 48.800511598587036
Epoch: 15, Steps: 208 | Train Loss: 0.632 Vali Loss: 7.381 Vali Acc: 0.078 Test Loss: 7.381 Test Acc: 0.078
Validation loss decreased (-0.076875 --> -0.077767).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4568535
	speed: 0.5715s/iter; left time: 10046.7065s
	iters: 200, epoch: 16 | loss: 0.3263206
	speed: 0.2408s/iter; left time: 4208.8095s
Epoch: 16 cost time: 50.7319450378418
Epoch: 16, Steps: 208 | Train Loss: 0.553 Vali Loss: 7.729 Vali Acc: 0.073 Test Loss: 7.729 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6987203
	speed: 0.5457s/iter; left time: 9480.5405s
	iters: 200, epoch: 17 | loss: 0.1815421
	speed: 0.2393s/iter; left time: 4134.1680s
Epoch: 17 cost time: 50.62780809402466
Epoch: 17, Steps: 208 | Train Loss: 0.500 Vali Loss: 7.985 Vali Acc: 0.081 Test Loss: 7.985 Test Acc: 0.081
Validation loss decreased (-0.077767 --> -0.081042).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1336198
	speed: 0.5272s/iter; left time: 9049.0398s
	iters: 200, epoch: 18 | loss: 0.3773784
	speed: 0.2268s/iter; left time: 3870.0793s
Epoch: 18 cost time: 47.39820456504822
Epoch: 18, Steps: 208 | Train Loss: 0.492 Vali Loss: 8.081 Vali Acc: 0.082 Test Loss: 8.081 Test Acc: 0.082
Validation loss decreased (-0.081042 --> -0.081935).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4226474
	speed: 0.5300s/iter; left time: 8987.4309s
	iters: 200, epoch: 19 | loss: 0.3285744
	speed: 0.2485s/iter; left time: 4188.6927s
Epoch: 19 cost time: 51.35626697540283
Epoch: 19, Steps: 208 | Train Loss: 0.467 Vali Loss: 8.225 Vali Acc: 0.074 Test Loss: 8.225 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1725635
	speed: 0.5828s/iter; left time: 9761.2014s
	iters: 200, epoch: 20 | loss: 0.1136164
	speed: 0.2534s/iter; left time: 4218.8252s
Epoch: 20 cost time: 52.64871835708618
Epoch: 20, Steps: 208 | Train Loss: 0.403 Vali Loss: 8.588 Vali Acc: 0.084 Test Loss: 8.588 Test Acc: 0.084
Validation loss decreased (-0.081935 --> -0.084018).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0634019
	speed: 0.5853s/iter; left time: 9681.9057s
	iters: 200, epoch: 21 | loss: 0.4075456
	speed: 0.2362s/iter; left time: 3883.1304s
Epoch: 21 cost time: 50.33660435676575
Epoch: 21, Steps: 208 | Train Loss: 0.375 Vali Loss: 8.925 Vali Acc: 0.087 Test Loss: 8.925 Test Acc: 0.087
Validation loss decreased (-0.084018 --> -0.086699).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4721603
	speed: 0.5978s/iter; left time: 9764.3154s
	iters: 200, epoch: 22 | loss: 0.4525877
	speed: 0.2583s/iter; left time: 4192.3012s
Epoch: 22 cost time: 54.590075731277466
Epoch: 22, Steps: 208 | Train Loss: 0.339 Vali Loss: 8.985 Vali Acc: 0.080 Test Loss: 8.985 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0061275
	speed: 0.5935s/iter; left time: 9570.2994s
	iters: 200, epoch: 23 | loss: 0.3280948
	speed: 0.2511s/iter; left time: 4024.0360s
Epoch: 23 cost time: 53.08806610107422
Epoch: 23, Steps: 208 | Train Loss: 0.327 Vali Loss: 9.160 Vali Acc: 0.077 Test Loss: 9.160 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2007523
	speed: 0.6414s/iter; left time: 10208.7388s
	iters: 200, epoch: 24 | loss: 0.4047439
	speed: 0.2646s/iter; left time: 4184.3913s
Epoch: 24 cost time: 54.598469257354736
Epoch: 24, Steps: 208 | Train Loss: 0.300 Vali Loss: 9.320 Vali Acc: 0.084 Test Loss: 9.320 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.5906966
	speed: 0.6462s/iter; left time: 10151.4228s
	iters: 200, epoch: 25 | loss: 0.1892169
	speed: 0.2761s/iter; left time: 4309.8436s
Epoch: 25 cost time: 56.93433952331543
Epoch: 25, Steps: 208 | Train Loss: 0.300 Vali Loss: 9.570 Vali Acc: 0.093 Test Loss: 9.570 Test Acc: 0.093
Validation loss decreased (-0.086699 --> -0.093254).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0250662
	speed: 0.6702s/iter; left time: 10389.0594s
	iters: 200, epoch: 26 | loss: 0.1521861
	speed: 0.2812s/iter; left time: 4330.1267s
Epoch: 26 cost time: 57.05282402038574
Epoch: 26, Steps: 208 | Train Loss: 0.264 Vali Loss: 9.517 Vali Acc: 0.087 Test Loss: 9.517 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.3411842
	speed: 0.6746s/iter; left time: 10316.1015s
	iters: 200, epoch: 27 | loss: 0.4051607
	speed: 0.2656s/iter; left time: 4035.2274s
Epoch: 27 cost time: 55.08294486999512
Epoch: 27, Steps: 208 | Train Loss: 0.276 Vali Loss: 9.414 Vali Acc: 0.090 Test Loss: 9.414 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0303446
	speed: 0.6868s/iter; left time: 10360.6043s
	iters: 200, epoch: 28 | loss: 0.0502654
	speed: 0.2617s/iter; left time: 3922.2445s
Epoch: 28 cost time: 56.72376561164856
Epoch: 28, Steps: 208 | Train Loss: 0.250 Vali Loss: 9.762 Vali Acc: 0.094 Test Loss: 9.762 Test Acc: 0.094
Validation loss decreased (-0.093254 --> -0.093550).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1226874
	speed: 0.5926s/iter; left time: 8816.6049s
	iters: 200, epoch: 29 | loss: 0.1439046
	speed: 0.2521s/iter; left time: 3725.7941s
Epoch: 29 cost time: 51.33910083770752
Epoch: 29, Steps: 208 | Train Loss: 0.248 Vali Loss: 10.124 Vali Acc: 0.089 Test Loss: 10.124 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.4137829
	speed: 0.7000s/iter; left time: 10267.7250s
	iters: 200, epoch: 30 | loss: 0.4465010
	speed: 0.2723s/iter; left time: 3966.5410s
Epoch: 30 cost time: 57.60048818588257
Epoch: 30, Steps: 208 | Train Loss: 0.224 Vali Loss: 9.859 Vali Acc: 0.089 Test Loss: 9.859 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.1331496
	speed: 0.7105s/iter; left time: 10275.0892s
	iters: 200, epoch: 31 | loss: 0.2676086
	speed: 0.2665s/iter; left time: 3826.6801s
Epoch: 31 cost time: 56.65094232559204
Epoch: 31, Steps: 208 | Train Loss: 0.219 Vali Loss: 9.862 Vali Acc: 0.089 Test Loss: 9.862 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.5676689
	speed: 0.6401s/iter; left time: 9123.6283s
	iters: 200, epoch: 32 | loss: 0.1897694
	speed: 0.2416s/iter; left time: 3418.8343s
Epoch: 32 cost time: 52.9590859413147
Epoch: 32, Steps: 208 | Train Loss: 0.208 Vali Loss: 9.882 Vali Acc: 0.089 Test Loss: 9.882 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0600208
	speed: 0.5871s/iter; left time: 8246.2020s
	iters: 200, epoch: 33 | loss: 0.0750527
	speed: 0.2743s/iter; left time: 3824.9052s
Epoch: 33 cost time: 56.44402575492859
Epoch: 33, Steps: 208 | Train Loss: 0.190 Vali Loss: 10.488 Vali Acc: 0.094 Test Loss: 10.488 Test Acc: 0.094
Validation loss decreased (-0.093550 --> -0.094139).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0039867
	speed: 0.7120s/iter; left time: 9851.6311s
	iters: 200, epoch: 34 | loss: 0.0537699
	speed: 0.2533s/iter; left time: 3479.3426s
Epoch: 34 cost time: 55.04059195518494
Epoch: 34, Steps: 208 | Train Loss: 0.196 Vali Loss: 10.485 Vali Acc: 0.089 Test Loss: 10.485 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.1564485
	speed: 0.5824s/iter; left time: 7937.6624s
	iters: 200, epoch: 35 | loss: 0.1942717
	speed: 0.2601s/iter; left time: 3518.7310s
Epoch: 35 cost time: 52.83194899559021
Epoch: 35, Steps: 208 | Train Loss: 0.197 Vali Loss: 10.257 Vali Acc: 0.094 Test Loss: 10.257 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.1140368
	speed: 0.6829s/iter; left time: 9165.3669s
	iters: 200, epoch: 36 | loss: 0.1149641
	speed: 0.2735s/iter; left time: 3643.8718s
Epoch: 36 cost time: 58.035008907318115
Epoch: 36, Steps: 208 | Train Loss: 0.185 Vali Loss: 10.633 Vali Acc: 0.086 Test Loss: 10.633 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0346132
	speed: 0.6092s/iter; left time: 8049.2109s
	iters: 200, epoch: 37 | loss: 0.0758454
	speed: 0.2568s/iter; left time: 3367.7384s
Epoch: 37 cost time: 54.56570053100586
Epoch: 37, Steps: 208 | Train Loss: 0.162 Vali Loss: 10.922 Vali Acc: 0.092 Test Loss: 10.922 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.3062580
	speed: 0.6505s/iter; left time: 8459.3218s
	iters: 200, epoch: 38 | loss: 0.1252605
	speed: 0.2790s/iter; left time: 3600.2111s
Epoch: 38 cost time: 58.269451379776
Epoch: 38, Steps: 208 | Train Loss: 0.161 Vali Loss: 10.738 Vali Acc: 0.092 Test Loss: 10.738 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.4900083
	speed: 0.6406s/iter; left time: 8198.3876s
	iters: 200, epoch: 39 | loss: 0.0134737
	speed: 0.2720s/iter; left time: 3453.8188s
Epoch: 39 cost time: 56.16468405723572
Epoch: 39, Steps: 208 | Train Loss: 0.172 Vali Loss: 10.860 Vali Acc: 0.089 Test Loss: 10.860 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0129789
	speed: 0.6707s/iter; left time: 8443.3529s
	iters: 200, epoch: 40 | loss: 0.3505364
	speed: 0.2579s/iter; left time: 3221.4693s
Epoch: 40 cost time: 55.386584758758545
Epoch: 40, Steps: 208 | Train Loss: 0.154 Vali Loss: 10.833 Vali Acc: 0.097 Test Loss: 10.833 Test Acc: 0.097
Validation loss decreased (-0.094139 --> -0.096522).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.1215438
	speed: 0.6044s/iter; left time: 7483.3892s
	iters: 200, epoch: 41 | loss: 0.3611895
	speed: 0.2699s/iter; left time: 3314.8726s
Epoch: 41 cost time: 55.24581289291382
Epoch: 41, Steps: 208 | Train Loss: 0.162 Vali Loss: 10.993 Vali Acc: 0.090 Test Loss: 10.993 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0520382
	speed: 0.6822s/iter; left time: 8304.8662s
	iters: 200, epoch: 42 | loss: 0.1229877
	speed: 0.2627s/iter; left time: 3171.2194s
Epoch: 42 cost time: 54.56761956214905
Epoch: 42, Steps: 208 | Train Loss: 0.150 Vali Loss: 10.983 Vali Acc: 0.092 Test Loss: 10.983 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.3522649
	speed: 0.6784s/iter; left time: 8116.6089s
	iters: 200, epoch: 43 | loss: 0.0164253
	speed: 0.2619s/iter; left time: 3107.5449s
Epoch: 43 cost time: 55.776296615600586
Epoch: 43, Steps: 208 | Train Loss: 0.155 Vali Loss: 10.955 Vali Acc: 0.092 Test Loss: 10.955 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.1462958
	speed: 0.6526s/iter; left time: 7672.1866s
	iters: 200, epoch: 44 | loss: 0.3757036
	speed: 0.2798s/iter; left time: 3261.7690s
Epoch: 44 cost time: 59.14138889312744
Epoch: 44, Steps: 208 | Train Loss: 0.131 Vali Loss: 11.128 Vali Acc: 0.095 Test Loss: 11.128 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.1005085
	speed: 0.7009s/iter; left time: 8094.5382s
	iters: 200, epoch: 45 | loss: 0.0221077
	speed: 0.2831s/iter; left time: 3241.2662s
Epoch: 45 cost time: 57.94846796989441
Epoch: 45, Steps: 208 | Train Loss: 0.136 Vali Loss: 11.216 Vali Acc: 0.087 Test Loss: 11.216 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.2115663
	speed: 0.6490s/iter; left time: 7360.7577s
	iters: 200, epoch: 46 | loss: 0.1625501
	speed: 0.2841s/iter; left time: 3193.5678s
Epoch: 46 cost time: 57.795188426971436
Epoch: 46, Steps: 208 | Train Loss: 0.143 Vali Loss: 11.436 Vali Acc: 0.089 Test Loss: 11.436 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0019849
	speed: 0.6728s/iter; left time: 7490.2974s
	iters: 200, epoch: 47 | loss: 0.0408441
	speed: 0.2641s/iter; left time: 2913.6059s
Epoch: 47 cost time: 56.34885287284851
Epoch: 47, Steps: 208 | Train Loss: 0.123 Vali Loss: 11.505 Vali Acc: 0.089 Test Loss: 11.505 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0285444
	speed: 0.6266s/iter; left time: 6845.6226s
	iters: 200, epoch: 48 | loss: 0.4358471
	speed: 0.2838s/iter; left time: 3072.2715s
Epoch: 48 cost time: 57.72919487953186
Epoch: 48, Steps: 208 | Train Loss: 0.133 Vali Loss: 11.837 Vali Acc: 0.091 Test Loss: 11.837 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.1256005
	speed: 0.6065s/iter; left time: 6499.8055s
	iters: 200, epoch: 49 | loss: 0.2038397
	speed: 0.2499s/iter; left time: 2653.2937s
Epoch: 49 cost time: 51.61595368385315
Epoch: 49, Steps: 208 | Train Loss: 0.127 Vali Loss: 11.586 Vali Acc: 0.092 Test Loss: 11.586 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.1475552
	speed: 0.7087s/iter; left time: 7447.6694s
	iters: 200, epoch: 50 | loss: 0.0867257
	speed: 0.2815s/iter; left time: 2930.1239s
Epoch: 50 cost time: 60.423930644989014
Epoch: 50, Steps: 208 | Train Loss: 0.123 Vali Loss: 11.438 Vali Acc: 0.092 Test Loss: 11.438 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09662988368625113
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7464554
	speed: 0.2711s/iter; left time: 5612.9070s
	iters: 200, epoch: 1 | loss: 3.7934527
	speed: 0.2688s/iter; left time: 5538.0609s
Epoch: 1 cost time: 56.353718996047974
Epoch: 1, Steps: 208 | Train Loss: 3.674 Vali Loss: 4.418 Vali Acc: 0.032 Test Loss: 4.418 Test Acc: 0.032
Validation loss decreased (inf --> -0.031868).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2058592
	speed: 0.7267s/iter; left time: 14892.8007s
	iters: 200, epoch: 2 | loss: 3.6572714
	speed: 0.2806s/iter; left time: 5722.5048s
Epoch: 2 cost time: 60.283329010009766
Epoch: 2, Steps: 208 | Train Loss: 3.348 Vali Loss: 4.965 Vali Acc: 0.032 Test Loss: 4.965 Test Acc: 0.032
Validation loss decreased (-0.031868 --> -0.032160).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5708072
	speed: 0.6468s/iter; left time: 13119.4451s
	iters: 200, epoch: 3 | loss: 3.2912877
	speed: 0.2606s/iter; left time: 5260.2983s
Epoch: 3 cost time: 56.45401358604431
Epoch: 3, Steps: 208 | Train Loss: 3.139 Vali Loss: 5.054 Vali Acc: 0.041 Test Loss: 5.054 Test Acc: 0.041
Validation loss decreased (-0.032160 --> -0.041405).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9018817
	speed: 0.6245s/iter; left time: 12538.1619s
	iters: 200, epoch: 4 | loss: 3.1417999
	speed: 0.2886s/iter; left time: 5765.7904s
Epoch: 4 cost time: 59.20186805725098
Epoch: 4, Steps: 208 | Train Loss: 2.986 Vali Loss: 5.116 Vali Acc: 0.039 Test Loss: 5.116 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9007823
	speed: 0.6718s/iter; left time: 13348.4082s
	iters: 200, epoch: 5 | loss: 3.0574114
	speed: 0.2794s/iter; left time: 5524.1615s
Epoch: 5 cost time: 59.53852581977844
Epoch: 5, Steps: 208 | Train Loss: 2.854 Vali Loss: 5.456 Vali Acc: 0.038 Test Loss: 5.456 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.9448273
	speed: 0.6320s/iter; left time: 12425.6146s
	iters: 200, epoch: 6 | loss: 2.8695879
	speed: 0.2753s/iter; left time: 5385.0451s
Epoch: 6 cost time: 57.138227701187134
Epoch: 6, Steps: 208 | Train Loss: 2.675 Vali Loss: 5.212 Vali Acc: 0.056 Test Loss: 5.212 Test Acc: 0.056
Validation loss decreased (-0.041405 --> -0.056315).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7160225
	speed: 0.6577s/iter; left time: 12793.3292s
	iters: 200, epoch: 7 | loss: 3.1815772
	speed: 0.2771s/iter; left time: 5361.9329s
Epoch: 7 cost time: 57.392394065856934
Epoch: 7, Steps: 208 | Train Loss: 2.558 Vali Loss: 5.095 Vali Acc: 0.059 Test Loss: 5.095 Test Acc: 0.059
Validation loss decreased (-0.056315 --> -0.059001).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0517225
	speed: 0.6653s/iter; left time: 12804.3076s
	iters: 200, epoch: 8 | loss: 2.4988971
	speed: 0.2881s/iter; left time: 5516.0731s
Epoch: 8 cost time: 61.690224170684814
Epoch: 8, Steps: 208 | Train Loss: 2.351 Vali Loss: 5.321 Vali Acc: 0.060 Test Loss: 5.321 Test Acc: 0.060
Validation loss decreased (-0.059001 --> -0.059893).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7661583
	speed: 0.5885s/iter; left time: 11203.2967s
	iters: 200, epoch: 9 | loss: 1.5261556
	speed: 0.2665s/iter; left time: 5046.2032s
Epoch: 9 cost time: 56.28886342048645
Epoch: 9, Steps: 208 | Train Loss: 2.148 Vali Loss: 5.328 Vali Acc: 0.065 Test Loss: 5.328 Test Acc: 0.065
Validation loss decreased (-0.059893 --> -0.064963).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8630223
	speed: 0.6625s/iter; left time: 12474.5719s
	iters: 200, epoch: 10 | loss: 2.0631287
	speed: 0.2802s/iter; left time: 5248.5427s
Epoch: 10 cost time: 58.93735384941101
Epoch: 10, Steps: 208 | Train Loss: 1.933 Vali Loss: 5.473 Vali Acc: 0.070 Test Loss: 5.473 Test Acc: 0.070
Validation loss decreased (-0.064963 --> -0.070032).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3388057
	speed: 0.6782s/iter; left time: 12629.2049s
	iters: 200, epoch: 11 | loss: 2.5229080
	speed: 0.2885s/iter; left time: 5343.0603s
Epoch: 11 cost time: 59.827163219451904
Epoch: 11, Steps: 208 | Train Loss: 1.682 Vali Loss: 5.633 Vali Acc: 0.075 Test Loss: 5.633 Test Acc: 0.075
Validation loss decreased (-0.070032 --> -0.074802).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4287028
	speed: 0.7153s/iter; left time: 13170.5965s
	iters: 200, epoch: 12 | loss: 1.5905151
	speed: 0.2704s/iter; left time: 4951.9894s
Epoch: 12 cost time: 58.16410303115845
Epoch: 12, Steps: 208 | Train Loss: 1.503 Vali Loss: 6.110 Vali Acc: 0.076 Test Loss: 6.110 Test Acc: 0.076
Validation loss decreased (-0.074802 --> -0.076288).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0227058
	speed: 0.6814s/iter; left time: 12405.6573s
	iters: 200, epoch: 13 | loss: 2.2952375
	speed: 0.2765s/iter; left time: 5006.5255s
Epoch: 13 cost time: 58.849745750427246
Epoch: 13, Steps: 208 | Train Loss: 1.324 Vali Loss: 6.020 Vali Acc: 0.081 Test Loss: 6.020 Test Acc: 0.081
Validation loss decreased (-0.076288 --> -0.080465).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8961083
	speed: 0.7150s/iter; left time: 12868.4422s
	iters: 200, epoch: 14 | loss: 1.2037601
	speed: 0.2766s/iter; left time: 4949.5653s
Epoch: 14 cost time: 60.441402196884155
Epoch: 14, Steps: 208 | Train Loss: 1.168 Vali Loss: 6.388 Vali Acc: 0.075 Test Loss: 6.388 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0587810
	speed: 0.6485s/iter; left time: 11535.6014s
	iters: 200, epoch: 15 | loss: 0.7397881
	speed: 0.2697s/iter; left time: 4769.9072s
Epoch: 15 cost time: 54.97957801818848
Epoch: 15, Steps: 208 | Train Loss: 1.030 Vali Loss: 6.602 Vali Acc: 0.075 Test Loss: 6.602 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4810012
	speed: 0.6359s/iter; left time: 11179.0933s
	iters: 200, epoch: 16 | loss: 1.1813432
	speed: 0.2864s/iter; left time: 5007.1521s
Epoch: 16 cost time: 59.04777002334595
Epoch: 16, Steps: 208 | Train Loss: 0.917 Vali Loss: 6.929 Vali Acc: 0.080 Test Loss: 6.929 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6525546
	speed: 0.6821s/iter; left time: 11849.3082s
	iters: 200, epoch: 17 | loss: 0.4220731
	speed: 0.2854s/iter; left time: 4929.6836s
Epoch: 17 cost time: 60.736721992492676
Epoch: 17, Steps: 208 | Train Loss: 0.831 Vali Loss: 7.094 Vali Acc: 0.079 Test Loss: 7.094 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2589060
	speed: 0.6634s/iter; left time: 11386.9065s
	iters: 200, epoch: 18 | loss: 0.5576401
	speed: 0.2975s/iter; left time: 5077.4619s
Epoch: 18 cost time: 61.248093128204346
Epoch: 18, Steps: 208 | Train Loss: 0.754 Vali Loss: 7.316 Vali Acc: 0.082 Test Loss: 7.316 Test Acc: 0.082
Validation loss decreased (-0.080465 --> -0.081645).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6812724
	speed: 0.5887s/iter; left time: 9982.2323s
	iters: 200, epoch: 19 | loss: 0.8268222
	speed: 0.2810s/iter; left time: 4736.7578s
Epoch: 19 cost time: 55.9112229347229
Epoch: 19, Steps: 208 | Train Loss: 0.671 Vali Loss: 7.640 Vali Acc: 0.080 Test Loss: 7.640 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.4469429
	speed: 0.6713s/iter; left time: 11242.8415s
	iters: 200, epoch: 20 | loss: 0.5380548
	speed: 0.2834s/iter; left time: 4718.4682s
Epoch: 20 cost time: 60.74615550041199
Epoch: 20, Steps: 208 | Train Loss: 0.644 Vali Loss: 7.877 Vali Acc: 0.087 Test Loss: 7.877 Test Acc: 0.087
Validation loss decreased (-0.081645 --> -0.087306).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5349780
	speed: 0.6593s/iter; left time: 10905.6277s
	iters: 200, epoch: 21 | loss: 0.3944721
	speed: 0.2672s/iter; left time: 4393.6392s
Epoch: 21 cost time: 57.77839279174805
Epoch: 21, Steps: 208 | Train Loss: 0.597 Vali Loss: 8.093 Vali Acc: 0.084 Test Loss: 8.093 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5771076
	speed: 0.6282s/iter; left time: 10259.8344s
	iters: 200, epoch: 22 | loss: 0.7294648
	speed: 0.2828s/iter; left time: 4590.8726s
Epoch: 22 cost time: 58.02260899543762
Epoch: 22, Steps: 208 | Train Loss: 0.536 Vali Loss: 8.328 Vali Acc: 0.084 Test Loss: 8.328 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5849482
	speed: 0.6846s/iter; left time: 11039.0135s
	iters: 200, epoch: 23 | loss: 0.5429820
	speed: 0.2777s/iter; left time: 4450.1617s
Epoch: 23 cost time: 58.990628242492676
Epoch: 23, Steps: 208 | Train Loss: 0.509 Vali Loss: 8.474 Vali Acc: 0.089 Test Loss: 8.474 Test Acc: 0.089
Validation loss decreased (-0.087306 --> -0.088493).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.4535355
	speed: 0.6765s/iter; left time: 10768.0077s
	iters: 200, epoch: 24 | loss: 0.4814608
	speed: 0.2868s/iter; left time: 4536.2263s
Epoch: 24 cost time: 59.05166268348694
Epoch: 24, Steps: 208 | Train Loss: 0.480 Vali Loss: 8.767 Vali Acc: 0.085 Test Loss: 8.767 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.3181357
	speed: 0.6180s/iter; left time: 9708.4095s
	iters: 200, epoch: 25 | loss: 1.1970776
	speed: 0.2675s/iter; left time: 4175.4208s
Epoch: 25 cost time: 55.27566051483154
Epoch: 25, Steps: 208 | Train Loss: 0.426 Vali Loss: 8.903 Vali Acc: 0.087 Test Loss: 8.903 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.1598138
	speed: 0.6358s/iter; left time: 9856.1345s
	iters: 200, epoch: 26 | loss: 0.8236951
	speed: 0.2969s/iter; left time: 4572.0493s
Epoch: 26 cost time: 59.445069313049316
Epoch: 26, Steps: 208 | Train Loss: 0.451 Vali Loss: 9.076 Vali Acc: 0.089 Test Loss: 9.076 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1808656
	speed: 0.6702s/iter; left time: 10248.6041s
	iters: 200, epoch: 27 | loss: 0.2566156
	speed: 0.2576s/iter; left time: 3913.6366s
Epoch: 27 cost time: 56.33958697319031
Epoch: 27, Steps: 208 | Train Loss: 0.397 Vali Loss: 9.041 Vali Acc: 0.081 Test Loss: 9.041 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1164171
	speed: 0.6035s/iter; left time: 9103.7618s
	iters: 200, epoch: 28 | loss: 0.3602740
	speed: 0.2494s/iter; left time: 3737.5799s
Epoch: 28 cost time: 51.67307686805725
Epoch: 28, Steps: 208 | Train Loss: 0.398 Vali Loss: 9.231 Vali Acc: 0.089 Test Loss: 9.231 Test Acc: 0.089
Validation loss decreased (-0.088493 --> -0.089082).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.8265047
	speed: 0.6768s/iter; left time: 10068.8217s
	iters: 200, epoch: 29 | loss: 0.1414329
	speed: 0.3191s/iter; left time: 4715.9898s
Epoch: 29 cost time: 65.38005208969116
Epoch: 29, Steps: 208 | Train Loss: 0.369 Vali Loss: 9.351 Vali Acc: 0.091 Test Loss: 9.351 Test Acc: 0.091
Validation loss decreased (-0.089082 --> -0.090870).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.2786037
	speed: 0.6496s/iter; left time: 9529.2027s
	iters: 200, epoch: 30 | loss: 0.2673233
	speed: 0.2690s/iter; left time: 3919.4262s
Epoch: 30 cost time: 56.49455213546753
Epoch: 30, Steps: 208 | Train Loss: 0.345 Vali Loss: 9.448 Vali Acc: 0.086 Test Loss: 9.448 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.2254361
	speed: 0.6441s/iter; left time: 9314.3923s
	iters: 200, epoch: 31 | loss: 0.1797301
	speed: 0.2951s/iter; left time: 4238.0152s
Epoch: 31 cost time: 59.94173336029053
Epoch: 31, Steps: 208 | Train Loss: 0.340 Vali Loss: 9.664 Vali Acc: 0.095 Test Loss: 9.664 Test Acc: 0.095
Validation loss decreased (-0.090870 --> -0.095340).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.8731871
	speed: 0.6634s/iter; left time: 9455.8354s
	iters: 200, epoch: 32 | loss: 0.3759471
	speed: 0.2764s/iter; left time: 3912.0410s
Epoch: 32 cost time: 59.04392457008362
Epoch: 32, Steps: 208 | Train Loss: 0.347 Vali Loss: 9.714 Vali Acc: 0.087 Test Loss: 9.714 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.1600428
	speed: 0.6156s/iter; left time: 8646.7998s
	iters: 200, epoch: 33 | loss: 0.1885171
	speed: 0.2837s/iter; left time: 3955.5261s
Epoch: 33 cost time: 58.63119864463806
Epoch: 33, Steps: 208 | Train Loss: 0.323 Vali Loss: 9.620 Vali Acc: 0.090 Test Loss: 9.620 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.5320447
	speed: 0.6476s/iter; left time: 8961.0976s
	iters: 200, epoch: 34 | loss: 0.2571224
	speed: 0.2877s/iter; left time: 3951.9186s
Epoch: 34 cost time: 57.01764988899231
Epoch: 34, Steps: 208 | Train Loss: 0.290 Vali Loss: 9.800 Vali Acc: 0.093 Test Loss: 9.800 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.1815081
	speed: 0.6642s/iter; left time: 9052.5064s
	iters: 200, epoch: 35 | loss: 0.3562782
	speed: 0.3001s/iter; left time: 4060.2365s
Epoch: 35 cost time: 62.14344263076782
Epoch: 35, Steps: 208 | Train Loss: 0.301 Vali Loss: 10.134 Vali Acc: 0.098 Test Loss: 10.134 Test Acc: 0.098
Validation loss decreased (-0.095340 --> -0.097722).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.2925936
	speed: 0.6287s/iter; left time: 8438.0135s
	iters: 200, epoch: 36 | loss: 0.1246772
	speed: 0.2873s/iter; left time: 3827.7075s
Epoch: 36 cost time: 58.861496686935425
Epoch: 36, Steps: 208 | Train Loss: 0.289 Vali Loss: 10.038 Vali Acc: 0.107 Test Loss: 10.038 Test Acc: 0.107
Validation loss decreased (-0.097722 --> -0.107266).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.1557922
	speed: 0.6428s/iter; left time: 8493.6842s
	iters: 200, epoch: 37 | loss: 0.1376444
	speed: 0.2666s/iter; left time: 3496.2976s
Epoch: 37 cost time: 56.902507066726685
Epoch: 37, Steps: 208 | Train Loss: 0.288 Vali Loss: 10.255 Vali Acc: 0.101 Test Loss: 10.255 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.4588336
	speed: 0.6472s/iter; left time: 8417.1822s
	iters: 200, epoch: 38 | loss: 0.2097293
	speed: 0.2515s/iter; left time: 3245.7259s
Epoch: 38 cost time: 54.687594413757324
Epoch: 38, Steps: 208 | Train Loss: 0.272 Vali Loss: 10.374 Vali Acc: 0.101 Test Loss: 10.374 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0780798
	speed: 0.6321s/iter; left time: 8088.4724s
	iters: 200, epoch: 39 | loss: 0.2590631
	speed: 0.2953s/iter; left time: 3749.8776s
Epoch: 39 cost time: 60.903746604919434
Epoch: 39, Steps: 208 | Train Loss: 0.240 Vali Loss: 10.848 Vali Acc: 0.106 Test Loss: 10.848 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0761379
	speed: 0.6365s/iter; left time: 8013.3630s
	iters: 200, epoch: 40 | loss: 0.1130752
	speed: 0.2815s/iter; left time: 3515.3505s
Epoch: 40 cost time: 56.9100444316864
Epoch: 40, Steps: 208 | Train Loss: 0.229 Vali Loss: 10.693 Vali Acc: 0.100 Test Loss: 10.693 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0052036
	speed: 0.6087s/iter; left time: 7536.2060s
	iters: 200, epoch: 41 | loss: 0.3475633
	speed: 0.2808s/iter; left time: 3448.6162s
Epoch: 41 cost time: 56.011810302734375
Epoch: 41, Steps: 208 | Train Loss: 0.230 Vali Loss: 10.950 Vali Acc: 0.093 Test Loss: 10.950 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.2345595
	speed: 0.6984s/iter; left time: 8502.1078s
	iters: 200, epoch: 42 | loss: 0.2147228
	speed: 0.2716s/iter; left time: 3278.8099s
Epoch: 42 cost time: 58.032777309417725
Epoch: 42, Steps: 208 | Train Loss: 0.252 Vali Loss: 10.720 Vali Acc: 0.101 Test Loss: 10.720 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.2478992
	speed: 0.6536s/iter; left time: 7820.7500s
	iters: 200, epoch: 43 | loss: 0.4525884
	speed: 0.2642s/iter; left time: 3134.3982s
Epoch: 43 cost time: 57.08029890060425
Epoch: 43, Steps: 208 | Train Loss: 0.243 Vali Loss: 11.203 Vali Acc: 0.095 Test Loss: 11.203 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0972566
	speed: 0.6542s/iter; left time: 7691.4405s
	iters: 200, epoch: 44 | loss: 0.2883274
	speed: 0.2644s/iter; left time: 3082.4171s
Epoch: 44 cost time: 56.76034331321716
Epoch: 44, Steps: 208 | Train Loss: 0.214 Vali Loss: 11.054 Vali Acc: 0.099 Test Loss: 11.054 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.3477148
	speed: 0.6024s/iter; left time: 6957.4110s
	iters: 200, epoch: 45 | loss: 0.0953081
	speed: 0.2723s/iter; left time: 3117.3703s
Epoch: 45 cost time: 55.5536162853241
Epoch: 45, Steps: 208 | Train Loss: 0.222 Vali Loss: 11.200 Vali Acc: 0.103 Test Loss: 11.200 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.4840128
	speed: 0.6598s/iter; left time: 7482.7270s
	iters: 200, epoch: 46 | loss: 0.7647356
	speed: 0.2700s/iter; left time: 3035.6087s
Epoch: 46 cost time: 58.32157588005066
Epoch: 46, Steps: 208 | Train Loss: 0.224 Vali Loss: 11.478 Vali Acc: 0.103 Test Loss: 11.478 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10736653742916791
model parameter : 339015
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 28, 30, 34, 35, 37, 42, 46, 58, 60, 61, 67, 73, 76, 78, 80, 81, 84, 88, 89, 90, 95, 96, 99, 101, 105]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 6, 8, 9, 10, 13, 14, 16, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 36, 37, 40, 42, 45, 46, 47, 49, 52]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 3, 8, 9, 11, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 26, 30, 31, 32, 35, 36, 38, 39, 40, 42, 43, 48, 49, 51, 52, 53]
modes_kv=32, index_kv=[1, 2, 6, 9, 11, 23, 25, 28, 29, 36, 41, 45, 46, 54, 60, 61, 63, 64, 67, 74, 78, 79, 83, 87, 93, 94, 95, 96, 99, 100, 101, 104]
>>>>>>>start training : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6037865
	speed: 0.2594s/iter; left time: 5370.2534s
	iters: 200, epoch: 1 | loss: 3.6530042
	speed: 0.2567s/iter; left time: 5288.0674s
Epoch: 1 cost time: 53.83196520805359
Epoch: 1, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.976 Vali Acc: 0.025 Test Loss: 3.976 Test Acc: 0.025
Validation loss decreased (inf --> -0.025311).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3267906
	speed: 0.6412s/iter; left time: 13139.2718s
	iters: 200, epoch: 2 | loss: 3.5034575
	speed: 0.2617s/iter; left time: 5335.8869s
Epoch: 2 cost time: 55.96497917175293
Epoch: 2, Steps: 208 | Train Loss: 3.294 Vali Loss: 4.357 Vali Acc: 0.039 Test Loss: 4.357 Test Acc: 0.039
Validation loss decreased (-0.025311 --> -0.038728).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4775593
	speed: 0.6368s/iter; left time: 12918.3121s
	iters: 200, epoch: 3 | loss: 3.3670282
	speed: 0.2525s/iter; left time: 5097.4191s
Epoch: 3 cost time: 55.36503005027771
Epoch: 3, Steps: 208 | Train Loss: 3.025 Vali Loss: 4.541 Vali Acc: 0.044 Test Loss: 4.541 Test Acc: 0.044
Validation loss decreased (-0.038728 --> -0.043498).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.7183571
	speed: 0.6175s/iter; left time: 12397.4518s
	iters: 200, epoch: 4 | loss: 2.7038729
	speed: 0.2500s/iter; left time: 4993.4616s
Epoch: 4 cost time: 52.4783616065979
Epoch: 4, Steps: 208 | Train Loss: 2.786 Vali Loss: 4.765 Vali Acc: 0.049 Test Loss: 4.765 Test Acc: 0.049
Validation loss decreased (-0.043498 --> -0.048864).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5060825
	speed: 0.5862s/iter; left time: 11648.1858s
	iters: 200, epoch: 5 | loss: 2.5932951
	speed: 0.2613s/iter; left time: 5165.7823s
Epoch: 5 cost time: 52.16210627555847
Epoch: 5, Steps: 208 | Train Loss: 2.607 Vali Loss: 5.107 Vali Acc: 0.047 Test Loss: 5.107 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.6860056
	speed: 0.6411s/iter; left time: 12604.2597s
	iters: 200, epoch: 6 | loss: 2.4743509
	speed: 0.2800s/iter; left time: 5477.2343s
Epoch: 6 cost time: 59.820096254348755
Epoch: 6, Steps: 208 | Train Loss: 2.375 Vali Loss: 5.107 Vali Acc: 0.069 Test Loss: 5.107 Test Acc: 0.069
Validation loss decreased (-0.048864 --> -0.069439).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5150588
	speed: 0.6146s/iter; left time: 11956.1104s
	iters: 200, epoch: 7 | loss: 3.1330900
	speed: 0.2689s/iter; left time: 5203.5036s
Epoch: 7 cost time: 56.65949320793152
Epoch: 7, Steps: 208 | Train Loss: 2.165 Vali Loss: 5.333 Vali Acc: 0.067 Test Loss: 5.333 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6465168
	speed: 0.6515s/iter; left time: 12537.3822s
	iters: 200, epoch: 8 | loss: 1.7639508
	speed: 0.2532s/iter; left time: 4847.0780s
Epoch: 8 cost time: 54.41207265853882
Epoch: 8, Steps: 208 | Train Loss: 1.901 Vali Loss: 5.587 Vali Acc: 0.065 Test Loss: 5.587 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3922572
	speed: 0.6138s/iter; left time: 11683.9885s
	iters: 200, epoch: 9 | loss: 1.4000019
	speed: 0.2744s/iter; left time: 5196.4693s
Epoch: 9 cost time: 55.02521848678589
Epoch: 9, Steps: 208 | Train Loss: 1.663 Vali Loss: 5.857 Vali Acc: 0.066 Test Loss: 5.857 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2589313
	speed: 0.5981s/iter; left time: 11262.2611s
	iters: 200, epoch: 10 | loss: 1.5445061
	speed: 0.2617s/iter; left time: 4901.9340s
Epoch: 10 cost time: 53.17415118217468
Epoch: 10, Steps: 208 | Train Loss: 1.424 Vali Loss: 5.935 Vali Acc: 0.072 Test Loss: 5.935 Test Acc: 0.072
Validation loss decreased (-0.069439 --> -0.071817).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4456226
	speed: 0.6717s/iter; left time: 12508.3596s
	iters: 200, epoch: 11 | loss: 1.2383084
	speed: 0.2816s/iter; left time: 5215.1944s
Epoch: 11 cost time: 59.18885278701782
Epoch: 11, Steps: 208 | Train Loss: 1.224 Vali Loss: 6.391 Vali Acc: 0.072 Test Loss: 6.391 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9386387
	speed: 0.5465s/iter; left time: 10061.8966s
	iters: 200, epoch: 12 | loss: 1.2593588
	speed: 0.2670s/iter; left time: 4888.9573s
Epoch: 12 cost time: 51.52975821495056
Epoch: 12, Steps: 208 | Train Loss: 1.082 Vali Loss: 6.499 Vali Acc: 0.079 Test Loss: 6.499 Test Acc: 0.079
Validation loss decreased (-0.071817 --> -0.078670).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6330468
	speed: 0.6164s/iter; left time: 11220.7662s
	iters: 200, epoch: 13 | loss: 1.1021986
	speed: 0.2855s/iter; left time: 5169.2705s
Epoch: 13 cost time: 58.69032382965088
Epoch: 13, Steps: 208 | Train Loss: 0.895 Vali Loss: 6.795 Vali Acc: 0.083 Test Loss: 6.795 Test Acc: 0.083
Validation loss decreased (-0.078670 --> -0.082843).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2609810
	speed: 0.6708s/iter; left time: 12072.8252s
	iters: 200, epoch: 14 | loss: 0.6963245
	speed: 0.2761s/iter; left time: 4940.8970s
Epoch: 14 cost time: 57.31894254684448
Epoch: 14, Steps: 208 | Train Loss: 0.810 Vali Loss: 6.987 Vali Acc: 0.081 Test Loss: 6.987 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0513464
	speed: 0.6319s/iter; left time: 11241.6373s
	iters: 200, epoch: 15 | loss: 0.7452181
	speed: 0.2519s/iter; left time: 4455.1828s
Epoch: 15 cost time: 55.29764795303345
Epoch: 15, Steps: 208 | Train Loss: 0.722 Vali Loss: 7.363 Vali Acc: 0.069 Test Loss: 7.363 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.2743638
	speed: 0.6042s/iter; left time: 10622.0706s
	iters: 200, epoch: 16 | loss: 0.9568527
	speed: 0.2718s/iter; left time: 4751.1761s
Epoch: 16 cost time: 57.17325758934021
Epoch: 16, Steps: 208 | Train Loss: 0.648 Vali Loss: 7.486 Vali Acc: 0.081 Test Loss: 7.486 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6446018
	speed: 0.6722s/iter; left time: 11678.6961s
	iters: 200, epoch: 17 | loss: 0.7215082
	speed: 0.2746s/iter; left time: 4742.3171s
Epoch: 17 cost time: 57.98453950881958
Epoch: 17, Steps: 208 | Train Loss: 0.594 Vali Loss: 7.774 Vali Acc: 0.078 Test Loss: 7.774 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7443735
	speed: 0.6242s/iter; left time: 10714.5303s
	iters: 200, epoch: 18 | loss: 0.1884334
	speed: 0.2858s/iter; left time: 4877.5722s
Epoch: 18 cost time: 58.8276424407959
Epoch: 18, Steps: 208 | Train Loss: 0.533 Vali Loss: 8.014 Vali Acc: 0.086 Test Loss: 8.014 Test Acc: 0.086
Validation loss decreased (-0.082843 --> -0.085813).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7900544
	speed: 0.5965s/iter; left time: 10115.3289s
	iters: 200, epoch: 19 | loss: 0.4275998
	speed: 0.2534s/iter; left time: 4271.0589s
Epoch: 19 cost time: 52.632596254348755
Epoch: 19, Steps: 208 | Train Loss: 0.496 Vali Loss: 8.162 Vali Acc: 0.084 Test Loss: 8.162 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1735058
	speed: 0.6566s/iter; left time: 10996.7915s
	iters: 200, epoch: 20 | loss: 0.4265704
	speed: 0.2701s/iter; left time: 4496.0648s
Epoch: 20 cost time: 56.88363599777222
Epoch: 20, Steps: 208 | Train Loss: 0.438 Vali Loss: 8.647 Vali Acc: 0.093 Test Loss: 8.647 Test Acc: 0.093
Validation loss decreased (-0.085813 --> -0.092965).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2418830
	speed: 0.6738s/iter; left time: 11145.1088s
	iters: 200, epoch: 21 | loss: 0.3392043
	speed: 0.2663s/iter; left time: 4377.4275s
Epoch: 21 cost time: 54.463385820388794
Epoch: 21, Steps: 208 | Train Loss: 0.434 Vali Loss: 8.569 Vali Acc: 0.090 Test Loss: 8.569 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3274449
	speed: 0.6250s/iter; left time: 10208.3153s
	iters: 200, epoch: 22 | loss: 0.3001346
	speed: 0.2371s/iter; left time: 3849.6422s
Epoch: 22 cost time: 52.07988476753235
Epoch: 22, Steps: 208 | Train Loss: 0.400 Vali Loss: 8.686 Vali Acc: 0.088 Test Loss: 8.686 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2262917
	speed: 0.5937s/iter; left time: 9574.2035s
	iters: 200, epoch: 23 | loss: 0.3527285
	speed: 0.2863s/iter; left time: 4587.7758s
Epoch: 23 cost time: 57.692126750946045
Epoch: 23, Steps: 208 | Train Loss: 0.394 Vali Loss: 9.044 Vali Acc: 0.079 Test Loss: 9.044 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.6219465
	speed: 0.6720s/iter; left time: 10696.3358s
	iters: 200, epoch: 24 | loss: 0.2860898
	speed: 0.2608s/iter; left time: 4124.3408s
Epoch: 24 cost time: 54.465665102005005
Epoch: 24, Steps: 208 | Train Loss: 0.341 Vali Loss: 9.184 Vali Acc: 0.090 Test Loss: 9.184 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.9315548
	speed: 0.6631s/iter; left time: 10416.8977s
	iters: 200, epoch: 25 | loss: 0.6088291
	speed: 0.2526s/iter; left time: 3943.3097s
Epoch: 25 cost time: 55.38379192352295
Epoch: 25, Steps: 208 | Train Loss: 0.317 Vali Loss: 9.514 Vali Acc: 0.091 Test Loss: 9.514 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0551327
	speed: 0.6400s/iter; left time: 9920.2794s
	iters: 200, epoch: 26 | loss: 0.1818669
	speed: 0.2689s/iter; left time: 4140.7485s
Epoch: 26 cost time: 57.487690925598145
Epoch: 26, Steps: 208 | Train Loss: 0.335 Vali Loss: 9.491 Vali Acc: 0.091 Test Loss: 9.491 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.8190622
	speed: 0.6213s/iter; left time: 9501.3256s
	iters: 200, epoch: 27 | loss: 0.2548566
	speed: 0.2873s/iter; left time: 4364.1938s
Epoch: 27 cost time: 57.92107534408569
Epoch: 27, Steps: 208 | Train Loss: 0.307 Vali Loss: 9.694 Vali Acc: 0.089 Test Loss: 9.694 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0142435
	speed: 0.6008s/iter; left time: 9063.2567s
	iters: 200, epoch: 28 | loss: 0.1450603
	speed: 0.2573s/iter; left time: 3855.3126s
Epoch: 28 cost time: 52.821898460388184
Epoch: 28, Steps: 208 | Train Loss: 0.301 Vali Loss: 9.723 Vali Acc: 0.088 Test Loss: 9.723 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1330052
	speed: 0.5963s/iter; left time: 8871.2376s
	iters: 200, epoch: 29 | loss: 0.1554335
	speed: 0.2678s/iter; left time: 3956.7900s
Epoch: 29 cost time: 56.15282487869263
Epoch: 29, Steps: 208 | Train Loss: 0.259 Vali Loss: 9.875 Vali Acc: 0.095 Test Loss: 9.875 Test Acc: 0.095
Validation loss decreased (-0.092965 --> -0.095040).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.2907355
	speed: 0.6491s/iter; left time: 9522.3261s
	iters: 200, epoch: 30 | loss: 0.0705263
	speed: 0.2813s/iter; left time: 4098.5194s
Epoch: 30 cost time: 55.80509161949158
Epoch: 30, Steps: 208 | Train Loss: 0.263 Vali Loss: 9.888 Vali Acc: 0.095 Test Loss: 9.888 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.5894254
	speed: 0.6436s/iter; left time: 9307.0930s
	iters: 200, epoch: 31 | loss: 0.2026056
	speed: 0.2482s/iter; left time: 3564.7370s
Epoch: 31 cost time: 52.81859111785889
Epoch: 31, Steps: 208 | Train Loss: 0.266 Vali Loss: 10.076 Vali Acc: 0.091 Test Loss: 10.076 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.6452435
	speed: 0.6000s/iter; left time: 8552.0772s
	iters: 200, epoch: 32 | loss: 0.4510514
	speed: 0.2570s/iter; left time: 3636.7863s
Epoch: 32 cost time: 53.40085959434509
Epoch: 32, Steps: 208 | Train Loss: 0.231 Vali Loss: 10.422 Vali Acc: 0.095 Test Loss: 10.422 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.1292124
	speed: 0.6571s/iter; left time: 9229.5018s
	iters: 200, epoch: 33 | loss: 0.6692867
	speed: 0.2745s/iter; left time: 3828.1498s
Epoch: 33 cost time: 57.81831955909729
Epoch: 33, Steps: 208 | Train Loss: 0.219 Vali Loss: 10.430 Vali Acc: 0.096 Test Loss: 10.430 Test Acc: 0.096
Validation loss decreased (-0.095040 --> -0.095929).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0721270
	speed: 0.5818s/iter; left time: 8050.2861s
	iters: 200, epoch: 34 | loss: 0.0490014
	speed: 0.2325s/iter; left time: 3194.2395s
Epoch: 34 cost time: 49.93612599372864
Epoch: 34, Steps: 208 | Train Loss: 0.225 Vali Loss: 10.395 Vali Acc: 0.095 Test Loss: 10.395 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0631748
	speed: 0.5851s/iter; left time: 7974.8158s
	iters: 200, epoch: 35 | loss: 0.3835515
	speed: 0.2527s/iter; left time: 3418.1944s
Epoch: 35 cost time: 53.21187782287598
Epoch: 35, Steps: 208 | Train Loss: 0.226 Vali Loss: 10.519 Vali Acc: 0.089 Test Loss: 10.519 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.2262690
	speed: 0.6467s/iter; left time: 8678.9458s
	iters: 200, epoch: 36 | loss: 0.1857602
	speed: 0.2662s/iter; left time: 3546.0321s
Epoch: 36 cost time: 56.6680371761322
Epoch: 36, Steps: 208 | Train Loss: 0.211 Vali Loss: 10.843 Vali Acc: 0.093 Test Loss: 10.843 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0985814
	speed: 0.5697s/iter; left time: 7526.8883s
	iters: 200, epoch: 37 | loss: 0.0815879
	speed: 0.2683s/iter; left time: 3518.0356s
Epoch: 37 cost time: 53.258572816848755
Epoch: 37, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.813 Vali Acc: 0.094 Test Loss: 10.813 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.2428597
	speed: 0.6581s/iter; left time: 8558.7447s
	iters: 200, epoch: 38 | loss: 0.0360054
	speed: 0.2660s/iter; left time: 3433.2919s
Epoch: 38 cost time: 55.545076847076416
Epoch: 38, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.722 Vali Acc: 0.096 Test Loss: 10.722 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0012719
	speed: 0.6281s/iter; left time: 8037.9508s
	iters: 200, epoch: 39 | loss: 0.0212925
	speed: 0.2429s/iter; left time: 3083.8880s
Epoch: 39 cost time: 52.839418172836304
Epoch: 39, Steps: 208 | Train Loss: 0.173 Vali Loss: 11.101 Vali Acc: 0.095 Test Loss: 11.101 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0054070
	speed: 0.5911s/iter; left time: 7440.9884s
	iters: 200, epoch: 40 | loss: 0.2112812
	speed: 0.2433s/iter; left time: 3038.9239s
Epoch: 40 cost time: 50.605579137802124
Epoch: 40, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.489 Vali Acc: 0.096 Test Loss: 11.489 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0801244
	speed: 0.6380s/iter; left time: 7899.6376s
	iters: 200, epoch: 41 | loss: 0.1126643
	speed: 0.2480s/iter; left time: 3045.7368s
Epoch: 41 cost time: 53.48287606239319
Epoch: 41, Steps: 208 | Train Loss: 0.177 Vali Loss: 11.350 Vali Acc: 0.094 Test Loss: 11.350 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.3761597
	speed: 0.6055s/iter; left time: 7371.3452s
	iters: 200, epoch: 42 | loss: 0.4219066
	speed: 0.2550s/iter; left time: 3078.2932s
Epoch: 42 cost time: 53.16172218322754
Epoch: 42, Steps: 208 | Train Loss: 0.176 Vali Loss: 11.288 Vali Acc: 0.088 Test Loss: 11.288 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.1513801
	speed: 0.5970s/iter; left time: 7142.5309s
	iters: 200, epoch: 43 | loss: 0.1471471
	speed: 0.2470s/iter; left time: 2931.0303s
Epoch: 43 cost time: 51.185290575027466
Epoch: 43, Steps: 208 | Train Loss: 0.189 Vali Loss: 11.628 Vali Acc: 0.094 Test Loss: 11.628 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_FEDformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09603340292275574
model parameter : 339015
model size : 2.54MB
