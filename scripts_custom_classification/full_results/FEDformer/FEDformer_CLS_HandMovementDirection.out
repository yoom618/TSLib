Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.76984429359436
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 5.919843673706055
Epoch: 2, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 3 cost time: 5.56443190574646
Epoch: 3, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.231 Vali Acc: 0.608 Test Loss: 1.231 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608096).  Saving model ...
Epoch: 4 cost time: 6.249772071838379
Epoch: 4, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.098 Vali Acc: 0.608 Test Loss: 1.098 Test Acc: 0.608
Validation loss decreased (-0.608096 --> -0.608097).  Saving model ...
Epoch: 5 cost time: 7.081802845001221
Epoch: 5, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.407 Vali Acc: 0.581 Test Loss: 1.407 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.512467861175537
Epoch: 6, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.354 Vali Acc: 0.649 Test Loss: 1.354 Test Acc: 0.649
Validation loss decreased (-0.608097 --> -0.648635).  Saving model ...
Epoch: 7 cost time: 6.6269919872283936
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.788 Vali Acc: 0.595 Test Loss: 1.788 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.037282943725586
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.610 Vali Acc: 0.595 Test Loss: 1.610 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.871088743209839
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.405 Vali Acc: 0.635 Test Loss: 1.405 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.73755407333374
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.662 Test Loss: 1.437 Test Acc: 0.662
Validation loss decreased (-0.648635 --> -0.662148).  Saving model ...
Epoch: 11 cost time: 6.8995795249938965
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.689 Test Loss: 1.486 Test Acc: 0.689
Validation loss decreased (-0.662148 --> -0.689174).  Saving model ...
Epoch: 12 cost time: 7.313457012176514
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.635 Test Loss: 1.459 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.972560167312622
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.635 Test Loss: 1.441 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.849049091339111
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.662 Test Loss: 1.436 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.837793350219727
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.649 Test Loss: 1.430 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.4694130420684814
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.676 Test Loss: 1.434 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.282962322235107
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.662 Test Loss: 1.438 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.27690315246582
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.649 Test Loss: 1.437 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.920027732849121
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.649 Test Loss: 1.436 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.10563325881958
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.649 Test Loss: 1.436 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.859718084335327
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.649 Test Loss: 1.440 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.133821964263916
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.181 Vali Acc: 0.473 Test Loss: 1.181 Test Acc: 0.473
Validation loss decreased (inf --> -0.472961).  Saving model ...
Epoch: 2 cost time: 6.608234643936157
Epoch: 2, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.312 Vali Acc: 0.514 Test Loss: 1.312 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513500).  Saving model ...
Epoch: 3 cost time: 7.487239837646484
Epoch: 3, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.270 Vali Acc: 0.595 Test Loss: 1.270 Test Acc: 0.595
Validation loss decreased (-0.513500 --> -0.594582).  Saving model ...
Epoch: 4 cost time: 6.880106210708618
Epoch: 4, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.264 Vali Acc: 0.595 Test Loss: 1.264 Test Acc: 0.595
Validation loss decreased (-0.594582 --> -0.594582).  Saving model ...
Epoch: 5 cost time: 6.823998689651489
Epoch: 5, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.608 Vali Acc: 0.595 Test Loss: 1.608 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.041272163391113
Epoch: 6, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.444 Vali Acc: 0.608 Test Loss: 1.444 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608094).  Saving model ...
Epoch: 7 cost time: 7.505823373794556
Epoch: 7, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.554 Test Loss: 1.618 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.7762768268585205
Epoch: 8, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.554 Test Loss: 1.621 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.4638512134552
Epoch: 9, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.568 Test Loss: 1.613 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.731611967086792
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.568 Test Loss: 1.624 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.504782438278198
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.581 Test Loss: 1.617 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.7107343673706055
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.595 Test Loss: 1.607 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.802191257476807
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.595 Test Loss: 1.591 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.812057971954346
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.595 Test Loss: 1.588 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.861401796340942
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.595 Test Loss: 1.587 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.724803686141968
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.595 Test Loss: 1.590 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.132855653762817
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.340 Vali Acc: 0.365 Test Loss: 1.340 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 5.553551912307739
Epoch: 2, Steps: 10 | Train Loss: 0.734 Vali Loss: 1.941 Vali Acc: 0.378 Test Loss: 1.941 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378359).  Saving model ...
Epoch: 3 cost time: 6.052717208862305
Epoch: 3, Steps: 10 | Train Loss: 0.267 Vali Loss: 2.024 Vali Acc: 0.365 Test Loss: 2.024 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.796013832092285
Epoch: 4, Steps: 10 | Train Loss: 0.093 Vali Loss: 2.195 Vali Acc: 0.419 Test Loss: 2.195 Test Acc: 0.419
Validation loss decreased (-0.378359 --> -0.418897).  Saving model ...
Epoch: 5 cost time: 6.4407007694244385
Epoch: 5, Steps: 10 | Train Loss: 0.071 Vali Loss: 2.745 Vali Acc: 0.405 Test Loss: 2.745 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.062513589859009
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.873 Vali Acc: 0.378 Test Loss: 2.873 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.968398332595825
Epoch: 7, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.633 Vali Acc: 0.324 Test Loss: 3.633 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.110005140304565
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.704 Vali Acc: 0.378 Test Loss: 3.704 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.248236179351807
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.838 Vali Acc: 0.459 Test Loss: 3.838 Test Acc: 0.459
Validation loss decreased (-0.418897 --> -0.459421).  Saving model ...
Epoch: 10 cost time: 5.804828405380249
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.866 Vali Acc: 0.459 Test Loss: 3.866 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.390755653381348
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.898 Vali Acc: 0.392 Test Loss: 3.898 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.971072196960449
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.063 Vali Acc: 0.324 Test Loss: 4.063 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.96146035194397
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.769 Vali Acc: 0.365 Test Loss: 4.769 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.993256330490112
Epoch: 14, Steps: 10 | Train Loss: 0.143 Vali Loss: 5.227 Vali Acc: 0.419 Test Loss: 5.227 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.35382866859436
Epoch: 15, Steps: 10 | Train Loss: 0.188 Vali Loss: 7.859 Vali Acc: 0.405 Test Loss: 7.859 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.49634051322937
Epoch: 16, Steps: 10 | Train Loss: 0.194 Vali Loss: 6.770 Vali Acc: 0.392 Test Loss: 6.770 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.727179527282715
Epoch: 17, Steps: 10 | Train Loss: 0.505 Vali Loss: 5.863 Vali Acc: 0.432 Test Loss: 5.863 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.698528528213501
Epoch: 18, Steps: 10 | Train Loss: 0.105 Vali Loss: 6.416 Vali Acc: 0.378 Test Loss: 6.416 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.936334133148193
Epoch: 19, Steps: 10 | Train Loss: 0.294 Vali Loss: 6.764 Vali Acc: 0.473 Test Loss: 6.764 Test Acc: 0.473
Validation loss decreased (-0.459421 --> -0.472905).  Saving model ...
Epoch: 20 cost time: 6.834482431411743
Epoch: 20, Steps: 10 | Train Loss: 0.097 Vali Loss: 6.950 Vali Acc: 0.405 Test Loss: 6.950 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.451222658157349
Epoch: 21, Steps: 10 | Train Loss: 0.247 Vali Loss: 8.342 Vali Acc: 0.405 Test Loss: 8.342 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.39004373550415
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 7.144 Vali Acc: 0.473 Test Loss: 7.144 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.665217876434326
Epoch: 23, Steps: 10 | Train Loss: 0.105 Vali Loss: 8.386 Vali Acc: 0.365 Test Loss: 8.386 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.712783575057983
Epoch: 24, Steps: 10 | Train Loss: 0.228 Vali Loss: 11.742 Vali Acc: 0.432 Test Loss: 11.742 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.6335039138793945
Epoch: 25, Steps: 10 | Train Loss: 0.141 Vali Loss: 11.209 Vali Acc: 0.378 Test Loss: 11.209 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.098942518234253
Epoch: 26, Steps: 10 | Train Loss: 0.520 Vali Loss: 13.882 Vali Acc: 0.338 Test Loss: 13.882 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.415977239608765
Epoch: 27, Steps: 10 | Train Loss: 0.516 Vali Loss: 14.805 Vali Acc: 0.324 Test Loss: 14.805 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.572925567626953
Epoch: 28, Steps: 10 | Train Loss: 0.403 Vali Loss: 13.028 Vali Acc: 0.351 Test Loss: 13.028 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.031770944595337
Epoch: 29, Steps: 10 | Train Loss: 0.352 Vali Loss: 16.226 Vali Acc: 0.351 Test Loss: 16.226 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.463479280471802
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.411 Vali Acc: 0.405 Test Loss: 1.411 Test Acc: 0.405
Validation loss decreased (inf --> -0.405391).  Saving model ...
Epoch: 2 cost time: 6.952739953994751
Epoch: 2, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.759 Vali Acc: 0.297 Test Loss: 1.759 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.3724565505981445
Epoch: 3, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.836 Vali Acc: 0.297 Test Loss: 1.836 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.776034116744995
Epoch: 4, Steps: 10 | Train Loss: 0.104 Vali Loss: 2.208 Vali Acc: 0.351 Test Loss: 2.208 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.8740973472595215
Epoch: 5, Steps: 10 | Train Loss: 0.046 Vali Loss: 2.540 Vali Acc: 0.297 Test Loss: 2.540 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.96193790435791
Epoch: 6, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.275 Vali Acc: 0.351 Test Loss: 3.275 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.011855602264404
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.210 Vali Acc: 0.311 Test Loss: 3.210 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.554619073867798
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.315 Vali Acc: 0.311 Test Loss: 4.315 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.297544717788696
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.888 Vali Acc: 0.378 Test Loss: 3.888 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.0243964195251465
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.916 Vali Acc: 0.297 Test Loss: 4.916 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.134103298187256
Epoch: 11, Steps: 10 | Train Loss: 0.159 Vali Loss: 5.364 Vali Acc: 0.338 Test Loss: 5.364 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.480468511581421
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.467 Vali Acc: 0.351 Test Loss: 1.467 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 5.153112411499023
Epoch: 2, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.921 Vali Acc: 0.284 Test Loss: 1.921 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.142000198364258
Epoch: 3, Steps: 10 | Train Loss: 0.336 Vali Loss: 2.108 Vali Acc: 0.338 Test Loss: 2.108 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.8903937339782715
Epoch: 4, Steps: 10 | Train Loss: 0.105 Vali Loss: 2.630 Vali Acc: 0.351 Test Loss: 2.630 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.048955202102661
Epoch: 5, Steps: 10 | Train Loss: 0.101 Vali Loss: 2.980 Vali Acc: 0.365 Test Loss: 2.980 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364835).  Saving model ...
Epoch: 6 cost time: 4.985516548156738
Epoch: 6, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.442 Vali Acc: 0.311 Test Loss: 3.442 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.543346643447876
Epoch: 7, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.496 Vali Acc: 0.243 Test Loss: 4.496 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.313888788223267
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.975 Vali Acc: 0.257 Test Loss: 4.975 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.816436290740967
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.871 Vali Acc: 0.284 Test Loss: 4.871 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.535948038101196
Epoch: 10, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.112 Vali Acc: 0.365 Test Loss: 5.112 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.273261070251465
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.862 Vali Acc: 0.284 Test Loss: 5.862 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.991345405578613
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.270 Vali Acc: 0.324 Test Loss: 5.270 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.629384279251099
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.807 Vali Acc: 0.216 Test Loss: 6.807 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.6403727531433105
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.749 Vali Acc: 0.324 Test Loss: 6.749 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.771206855773926
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 6.750 Vali Acc: 0.351 Test Loss: 6.750 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.56536865234375
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.417 Vali Acc: 0.311 Test Loss: 1.417 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.333872556686401
Epoch: 2, Steps: 10 | Train Loss: 0.795 Vali Loss: 1.672 Vali Acc: 0.338 Test Loss: 1.672 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337821).  Saving model ...
Epoch: 3 cost time: 4.447875022888184
Epoch: 3, Steps: 10 | Train Loss: 0.307 Vali Loss: 2.117 Vali Acc: 0.338 Test Loss: 2.117 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.246996164321899
Epoch: 4, Steps: 10 | Train Loss: 0.103 Vali Loss: 2.706 Vali Acc: 0.270 Test Loss: 2.706 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.928022146224976
Epoch: 5, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.983 Vali Acc: 0.297 Test Loss: 2.983 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.334851503372192
Epoch: 6, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.419 Vali Acc: 0.257 Test Loss: 3.419 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.811850309371948
Epoch: 7, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.013 Vali Acc: 0.230 Test Loss: 4.013 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.330570220947266
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.944 Vali Acc: 0.284 Test Loss: 3.944 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.350973606109619
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.462 Vali Acc: 0.203 Test Loss: 4.462 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.838747978210449
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.366 Vali Acc: 0.405 Test Loss: 4.366 Test Acc: 0.405
Validation loss decreased (-0.337821 --> -0.405362).  Saving model ...
Epoch: 11 cost time: 6.104542970657349
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.688 Vali Acc: 0.230 Test Loss: 5.688 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.32246732711792
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.236 Vali Acc: 0.162 Test Loss: 6.236 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.212432146072388
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 7.059 Vali Acc: 0.135 Test Loss: 7.059 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.4686033725738525
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.755 Vali Acc: 0.338 Test Loss: 5.755 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.977481842041016
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 7.259 Vali Acc: 0.216 Test Loss: 7.259 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.993595600128174
Epoch: 16, Steps: 10 | Train Loss: 0.255 Vali Loss: 8.921 Vali Acc: 0.284 Test Loss: 8.921 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.3566575050354
Epoch: 17, Steps: 10 | Train Loss: 0.385 Vali Loss: 10.162 Vali Acc: 0.216 Test Loss: 10.162 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.903808355331421
Epoch: 18, Steps: 10 | Train Loss: 0.198 Vali Loss: 9.216 Vali Acc: 0.216 Test Loss: 9.216 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.485472679138184
Epoch: 19, Steps: 10 | Train Loss: 0.275 Vali Loss: 10.543 Vali Acc: 0.243 Test Loss: 10.543 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.436614274978638
Epoch: 20, Steps: 10 | Train Loss: 0.142 Vali Loss: 8.284 Vali Acc: 0.257 Test Loss: 8.284 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.916280269622803
Epoch: 1, Steps: 10 | Train Loss: 1.538 Vali Loss: 1.617 Vali Acc: 0.338 Test Loss: 1.617 Test Acc: 0.338
Validation loss decreased (inf --> -0.337822).  Saving model ...
Epoch: 2 cost time: 5.396131753921509
Epoch: 2, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.742 Vali Acc: 0.311 Test Loss: 1.742 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.037184953689575
Epoch: 3, Steps: 10 | Train Loss: 0.899 Vali Loss: 2.475 Vali Acc: 0.270 Test Loss: 2.475 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.084148406982422
Epoch: 4, Steps: 10 | Train Loss: 0.327 Vali Loss: 2.425 Vali Acc: 0.270 Test Loss: 2.425 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.647498369216919
Epoch: 5, Steps: 10 | Train Loss: 0.085 Vali Loss: 2.670 Vali Acc: 0.270 Test Loss: 2.670 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.98581600189209
Epoch: 6, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.651 Vali Acc: 0.216 Test Loss: 3.651 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.589657306671143
Epoch: 7, Steps: 10 | Train Loss: 0.195 Vali Loss: 5.216 Vali Acc: 0.243 Test Loss: 5.216 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.2313642501831055
Epoch: 8, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.298 Vali Acc: 0.270 Test Loss: 4.298 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.125223875045776
Epoch: 9, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.956 Vali Acc: 0.365 Test Loss: 3.956 Test Acc: 0.365
Validation loss decreased (-0.337822 --> -0.364825).  Saving model ...
Epoch: 10 cost time: 4.418392896652222
Epoch: 10, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.322 Vali Acc: 0.297 Test Loss: 4.322 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.709420680999756
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 6.680 Vali Acc: 0.216 Test Loss: 6.680 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.340075969696045
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 6.073 Vali Acc: 0.311 Test Loss: 6.073 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.537863492965698
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 8.690 Vali Acc: 0.270 Test Loss: 8.690 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.7940449714660645
Epoch: 14, Steps: 10 | Train Loss: 0.108 Vali Loss: 6.998 Vali Acc: 0.257 Test Loss: 6.998 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.104423522949219
Epoch: 15, Steps: 10 | Train Loss: 0.140 Vali Loss: 8.557 Vali Acc: 0.203 Test Loss: 8.557 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.078091859817505
Epoch: 16, Steps: 10 | Train Loss: 0.177 Vali Loss: 7.873 Vali Acc: 0.203 Test Loss: 7.873 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.658769845962524
Epoch: 17, Steps: 10 | Train Loss: 0.165 Vali Loss: 8.430 Vali Acc: 0.270 Test Loss: 8.430 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.249938011169434
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 9.457 Vali Acc: 0.230 Test Loss: 9.457 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.335943937301636
Epoch: 19, Steps: 10 | Train Loss: 0.113 Vali Loss: 7.790 Vali Acc: 0.230 Test Loss: 7.790 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.552501440048218
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.469 Vali Acc: 0.324 Test Loss: 1.469 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 5.083899736404419
Epoch: 2, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.643 Vali Acc: 0.311 Test Loss: 1.643 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.460043430328369
Epoch: 3, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.933 Vali Acc: 0.365 Test Loss: 1.933 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364846).  Saving model ...
Epoch: 4 cost time: 4.950460910797119
Epoch: 4, Steps: 10 | Train Loss: 0.144 Vali Loss: 2.222 Vali Acc: 0.338 Test Loss: 2.222 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.546220064163208
Epoch: 5, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.068 Vali Acc: 0.270 Test Loss: 3.068 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.493527173995972
Epoch: 6, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.923 Vali Acc: 0.284 Test Loss: 2.923 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.227414131164551
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.054 Vali Acc: 0.243 Test Loss: 3.054 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.843989372253418
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.336 Vali Acc: 0.216 Test Loss: 4.336 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.985859155654907
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.624 Vali Acc: 0.270 Test Loss: 3.624 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.642865419387817
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.155 Vali Acc: 0.203 Test Loss: 4.155 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.507556200027466
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.747 Vali Acc: 0.257 Test Loss: 3.747 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.002766847610474
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.972 Vali Acc: 0.243 Test Loss: 3.972 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.786815404891968
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.968 Vali Acc: 0.257 Test Loss: 3.968 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.313076019287109
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.388 Vali Acc: 0.297 Test Loss: 1.388 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 5.373288631439209
Epoch: 2, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.512 Vali Acc: 0.338 Test Loss: 1.512 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337823).  Saving model ...
Epoch: 3 cost time: 6.32059645652771
Epoch: 3, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.571 Vali Acc: 0.405 Test Loss: 1.571 Test Acc: 0.405
Validation loss decreased (-0.337823 --> -0.405390).  Saving model ...
Epoch: 4 cost time: 6.152216911315918
Epoch: 4, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.606 Vali Acc: 0.365 Test Loss: 1.606 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.492557525634766
Epoch: 5, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.960 Vali Acc: 0.324 Test Loss: 1.960 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.2993316650390625
Epoch: 6, Steps: 10 | Train Loss: 0.140 Vali Loss: 2.105 Vali Acc: 0.365 Test Loss: 2.105 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.9632408618927
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.769 Vali Acc: 0.230 Test Loss: 2.769 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.515739679336548
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.618 Vali Acc: 0.270 Test Loss: 3.618 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.802503824234009
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.689 Vali Acc: 0.270 Test Loss: 3.689 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.644817590713501
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.350 Vali Acc: 0.270 Test Loss: 3.350 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.010660886764526
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.754 Vali Acc: 0.297 Test Loss: 3.754 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.157241344451904
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.861 Vali Acc: 0.351 Test Loss: 3.861 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.494295835494995
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.875 Vali Acc: 0.216 Test Loss: 4.875 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.351125955581665
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 5.5272369384765625
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.528 Vali Acc: 0.365 Test Loss: 1.528 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364850).  Saving model ...
Epoch: 3 cost time: 5.63799262046814
Epoch: 3, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.641 Vali Acc: 0.392 Test Loss: 1.641 Test Acc: 0.392
Validation loss decreased (-0.364850 --> -0.391875).  Saving model ...
Epoch: 4 cost time: 5.731626033782959
Epoch: 4, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.633 Vali Acc: 0.392 Test Loss: 1.633 Test Acc: 0.392
Validation loss decreased (-0.391875 --> -0.391876).  Saving model ...
Epoch: 5 cost time: 6.065262079238892
Epoch: 5, Steps: 10 | Train Loss: 0.442 Vali Loss: 2.003 Vali Acc: 0.365 Test Loss: 2.003 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.073236703872681
Epoch: 6, Steps: 10 | Train Loss: 0.243 Vali Loss: 2.443 Vali Acc: 0.324 Test Loss: 2.443 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.101495027542114
Epoch: 7, Steps: 10 | Train Loss: 0.149 Vali Loss: 2.570 Vali Acc: 0.324 Test Loss: 2.570 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.1112895011901855
Epoch: 8, Steps: 10 | Train Loss: 0.097 Vali Loss: 2.891 Vali Acc: 0.324 Test Loss: 2.891 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.024830102920532
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.142 Vali Acc: 0.311 Test Loss: 3.142 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.444724082946777
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.398 Vali Acc: 0.338 Test Loss: 3.398 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.084900617599487
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.757 Vali Acc: 0.324 Test Loss: 3.757 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.633352518081665
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.753 Vali Acc: 0.270 Test Loss: 4.753 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.460185289382935
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.968 Vali Acc: 0.284 Test Loss: 4.968 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.762430429458618
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.315 Vali Acc: 0.365 Test Loss: 5.315 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 17636868
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.580685138702393
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.219 Vali Acc: 0.405 Test Loss: 1.219 Test Acc: 0.405
Validation loss decreased (inf --> -0.405393).  Saving model ...
Epoch: 2 cost time: 5.4856719970703125
Epoch: 2, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.292 Vali Acc: 0.473 Test Loss: 1.292 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 5.5767502784729
Epoch: 3, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.907 Vali Acc: 0.662 Test Loss: 0.907 Test Acc: 0.662
Validation loss decreased (-0.472960 --> -0.662153).  Saving model ...
Epoch: 4 cost time: 6.139894962310791
Epoch: 4, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.109 Vali Acc: 0.595 Test Loss: 1.109 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.046111106872559
Epoch: 5, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.907 Vali Acc: 0.486 Test Loss: 1.907 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.269404172897339
Epoch: 6, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.309 Vali Acc: 0.622 Test Loss: 1.309 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.973155736923218
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.444 Vali Acc: 0.581 Test Loss: 1.444 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.130608558654785
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.070 Vali Acc: 0.622 Test Loss: 2.070 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.791378498077393
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.659 Vali Acc: 0.622 Test Loss: 1.659 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.447092533111572
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.049 Vali Acc: 0.568 Test Loss: 2.049 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.264909029006958
Epoch: 11, Steps: 10 | Train Loss: 0.066 Vali Loss: 2.571 Vali Acc: 0.595 Test Loss: 2.571 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.7864930629730225
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.705 Vali Acc: 0.568 Test Loss: 2.705 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.077195167541504
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.089 Vali Acc: 0.541 Test Loss: 4.089 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.560404539108276
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.240 Vali Acc: 0.432 Test Loss: 1.240 Test Acc: 0.432
Validation loss decreased (inf --> -0.432420).  Saving model ...
Epoch: 2 cost time: 6.4727842807769775
Epoch: 2, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.466 Vali Acc: 0.473 Test Loss: 1.466 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472958).  Saving model ...
Epoch: 3 cost time: 6.4292356967926025
Epoch: 3, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
Validation loss decreased (-0.472958 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 6.196228742599487
Epoch: 4, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.371 Vali Acc: 0.486 Test Loss: 1.371 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.728711128234863
Epoch: 5, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.732 Vali Acc: 0.514 Test Loss: 1.732 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.682741641998291
Epoch: 6, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.065 Vali Acc: 0.554 Test Loss: 2.065 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554033).  Saving model ...
Epoch: 7 cost time: 6.012671232223511
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.664 Vali Acc: 0.568 Test Loss: 2.664 Test Acc: 0.568
Validation loss decreased (-0.554033 --> -0.567541).  Saving model ...
Epoch: 8 cost time: 6.1454901695251465
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.106 Vali Acc: 0.608 Test Loss: 2.106 Test Acc: 0.608
Validation loss decreased (-0.567541 --> -0.608087).  Saving model ...
Epoch: 9 cost time: 4.83246111869812
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.473 Vali Acc: 0.514 Test Loss: 2.473 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.466786861419678
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.901 Vali Acc: 0.541 Test Loss: 2.901 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.186467885971069
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.007 Vali Acc: 0.514 Test Loss: 3.007 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.607438325881958
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.478 Vali Acc: 0.554 Test Loss: 2.478 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.565016746520996
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.171 Vali Acc: 0.514 Test Loss: 3.171 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.460763931274414
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.128 Vali Acc: 0.514 Test Loss: 3.128 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.9825756549835205
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.540 Vali Acc: 0.527 Test Loss: 4.540 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.983771800994873
Epoch: 16, Steps: 10 | Train Loss: 0.209 Vali Loss: 4.498 Vali Acc: 0.541 Test Loss: 4.498 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.500816106796265
Epoch: 17, Steps: 10 | Train Loss: 0.202 Vali Loss: 4.078 Vali Acc: 0.568 Test Loss: 4.078 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.806989669799805
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.087 Vali Acc: 0.500 Test Loss: 5.087 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.611854076385498
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 5.564301013946533
Epoch: 2, Steps: 10 | Train Loss: 0.809 Vali Loss: 2.059 Vali Acc: 0.324 Test Loss: 2.059 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324304).  Saving model ...
Epoch: 3 cost time: 5.600304365158081
Epoch: 3, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.838 Vali Acc: 0.419 Test Loss: 1.838 Test Acc: 0.419
Validation loss decreased (-0.324304 --> -0.418901).  Saving model ...
Epoch: 4 cost time: 5.7225501537323
Epoch: 4, Steps: 10 | Train Loss: 0.077 Vali Loss: 2.445 Vali Acc: 0.405 Test Loss: 2.445 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.872399806976318
Epoch: 5, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.357 Vali Acc: 0.365 Test Loss: 3.357 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.578503370285034
Epoch: 6, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.096 Vali Acc: 0.432 Test Loss: 3.096 Test Acc: 0.432
Validation loss decreased (-0.418901 --> -0.432401).  Saving model ...
Epoch: 7 cost time: 5.710281848907471
Epoch: 7, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.062 Vali Acc: 0.419 Test Loss: 3.062 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.085839033126831
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.222 Vali Acc: 0.432 Test Loss: 3.222 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.379268407821655
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.257 Vali Acc: 0.473 Test Loss: 3.257 Test Acc: 0.473
Validation loss decreased (-0.432401 --> -0.472940).  Saving model ...
Epoch: 10 cost time: 4.1351728439331055
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.420 Vali Acc: 0.446 Test Loss: 3.420 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.339909315109253
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.763 Vali Acc: 0.405 Test Loss: 3.763 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.623446226119995
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.432 Test Loss: 3.638 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.677190065383911
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.581 Vali Acc: 0.432 Test Loss: 3.581 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.23319149017334
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.581 Vali Acc: 0.432 Test Loss: 3.581 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.023005485534668
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.597 Vali Acc: 0.446 Test Loss: 3.597 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.88807487487793
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.619 Vali Acc: 0.446 Test Loss: 3.619 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.08252215385437
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.626 Vali Acc: 0.446 Test Loss: 3.626 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.138220310211182
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.618 Vali Acc: 0.446 Test Loss: 3.618 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.743565559387207
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.612 Vali Acc: 0.446 Test Loss: 3.612 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.587964057922363
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.483 Vali Acc: 0.257 Test Loss: 1.483 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 5.250309705734253
Epoch: 2, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.799 Vali Acc: 0.270 Test Loss: 1.799 Test Acc: 0.270
Validation loss decreased (-0.256742 --> -0.270252).  Saving model ...
Epoch: 3 cost time: 5.227825880050659
Epoch: 3, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.935 Vali Acc: 0.324 Test Loss: 1.935 Test Acc: 0.324
Validation loss decreased (-0.270252 --> -0.324305).  Saving model ...
Epoch: 4 cost time: 5.2595436573028564
Epoch: 4, Steps: 10 | Train Loss: 0.063 Vali Loss: 2.437 Vali Acc: 0.324 Test Loss: 2.437 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.332888841629028
Epoch: 5, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.822 Vali Acc: 0.311 Test Loss: 2.822 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.854236841201782
Epoch: 6, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.738 Vali Acc: 0.297 Test Loss: 3.738 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.59178352355957
Epoch: 7, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.833 Vali Acc: 0.365 Test Loss: 3.833 Test Acc: 0.365
Validation loss decreased (-0.324305 --> -0.364827).  Saving model ...
Epoch: 8 cost time: 5.089812994003296
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.052 Vali Acc: 0.270 Test Loss: 4.052 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.647400379180908
Epoch: 9, Steps: 10 | Train Loss: 0.066 Vali Loss: 5.337 Vali Acc: 0.311 Test Loss: 5.337 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.322901248931885
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.985 Vali Acc: 0.338 Test Loss: 4.985 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.827616214752197
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 5.561 Vali Acc: 0.324 Test Loss: 5.561 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.451008558273315
Epoch: 12, Steps: 10 | Train Loss: 0.194 Vali Loss: 6.018 Vali Acc: 0.297 Test Loss: 6.018 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.577727794647217
Epoch: 13, Steps: 10 | Train Loss: 0.196 Vali Loss: 7.160 Vali Acc: 0.243 Test Loss: 7.160 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.13734769821167
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 7.065 Vali Acc: 0.324 Test Loss: 7.065 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.356882810592651
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 7.852 Vali Acc: 0.270 Test Loss: 7.852 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.229514122009277
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 8.415 Vali Acc: 0.311 Test Loss: 8.415 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.202205657958984
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 7.398 Vali Acc: 0.297 Test Loss: 7.398 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.245559930801392
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.497 Vali Acc: 0.203 Test Loss: 1.497 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 5.239184379577637
Epoch: 2, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.989 Vali Acc: 0.311 Test Loss: 1.989 Test Acc: 0.311
Validation loss decreased (-0.202688 --> -0.310791).  Saving model ...
Epoch: 3 cost time: 5.12253475189209
Epoch: 3, Steps: 10 | Train Loss: 0.321 Vali Loss: 2.058 Vali Acc: 0.284 Test Loss: 2.058 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.786576271057129
Epoch: 4, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.527 Vali Acc: 0.284 Test Loss: 2.527 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.182885646820068
Epoch: 5, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.528 Vali Acc: 0.338 Test Loss: 2.528 Test Acc: 0.338
Validation loss decreased (-0.310791 --> -0.337813).  Saving model ...
Epoch: 6 cost time: 5.833795070648193
Epoch: 6, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.920 Vali Acc: 0.351 Test Loss: 2.920 Test Acc: 0.351
Validation loss decreased (-0.337813 --> -0.351322).  Saving model ...
Epoch: 7 cost time: 5.5746214389801025
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.039 Vali Acc: 0.378 Test Loss: 4.039 Test Acc: 0.378
Validation loss decreased (-0.351322 --> -0.378338).  Saving model ...
Epoch: 8 cost time: 5.338456392288208
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.943 Vali Acc: 0.351 Test Loss: 3.943 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.786898612976074
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.978 Vali Acc: 0.311 Test Loss: 4.978 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.27899956703186
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.038 Vali Acc: 0.230 Test Loss: 4.038 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.680246353149414
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.980 Vali Acc: 0.311 Test Loss: 3.980 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.555736064910889
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.247 Vali Acc: 0.270 Test Loss: 5.247 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.422345399856567
Epoch: 13, Steps: 10 | Train Loss: 0.182 Vali Loss: 5.022 Vali Acc: 0.324 Test Loss: 5.022 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.821649551391602
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.872 Vali Acc: 0.311 Test Loss: 5.872 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.434863328933716
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 5.601 Vali Acc: 0.324 Test Loss: 5.601 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.59050726890564
Epoch: 16, Steps: 10 | Train Loss: 0.103 Vali Loss: 6.144 Vali Acc: 0.365 Test Loss: 6.144 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.003035306930542
Epoch: 17, Steps: 10 | Train Loss: 0.155 Vali Loss: 6.838 Vali Acc: 0.324 Test Loss: 6.838 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.916257381439209
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.498 Vali Acc: 0.203 Test Loss: 1.498 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 4.849477767944336
Epoch: 2, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.870 Vali Acc: 0.257 Test Loss: 1.870 Test Acc: 0.257
Validation loss decreased (-0.202688 --> -0.256738).  Saving model ...
Epoch: 3 cost time: 5.060909748077393
Epoch: 3, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.884 Vali Acc: 0.351 Test Loss: 1.884 Test Acc: 0.351
Validation loss decreased (-0.256738 --> -0.351333).  Saving model ...
Epoch: 4 cost time: 4.601594924926758
Epoch: 4, Steps: 10 | Train Loss: 0.059 Vali Loss: 2.396 Vali Acc: 0.257 Test Loss: 2.396 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.425397634506226
Epoch: 5, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.984 Vali Acc: 0.324 Test Loss: 2.984 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.2286036014556885
Epoch: 6, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.557 Vali Acc: 0.230 Test Loss: 3.557 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.839474201202393
Epoch: 7, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.261 Vali Acc: 0.351 Test Loss: 4.261 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.518446445465088
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.026 Vali Acc: 0.297 Test Loss: 4.026 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.982769012451172
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.925 Vali Acc: 0.351 Test Loss: 3.925 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.849088191986084
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.746 Vali Acc: 0.189 Test Loss: 4.746 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.40415358543396
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.200 Vali Acc: 0.338 Test Loss: 4.200 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.770053863525391
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.693 Vali Acc: 0.216 Test Loss: 5.693 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.413471698760986
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.364 Vali Acc: 0.203 Test Loss: 5.364 Test Acc: 0.203
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.064862012863159
Epoch: 1, Steps: 10 | Train Loss: 1.562 Vali Loss: 1.651 Vali Acc: 0.270 Test Loss: 1.651 Test Acc: 0.270
Validation loss decreased (inf --> -0.270254).  Saving model ...
Epoch: 2 cost time: 3.457279920578003
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.924 Vali Acc: 0.176 Test Loss: 1.924 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8902392387390137
Epoch: 3, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.808 Vali Acc: 0.284 Test Loss: 1.808 Test Acc: 0.284
Validation loss decreased (-0.270254 --> -0.283766).  Saving model ...
Epoch: 4 cost time: 3.72935152053833
Epoch: 4, Steps: 10 | Train Loss: 0.357 Vali Loss: 2.528 Vali Acc: 0.203 Test Loss: 2.528 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.056285381317139
Epoch: 5, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.029 Vali Acc: 0.216 Test Loss: 3.029 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.72055983543396
Epoch: 6, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.595 Vali Acc: 0.243 Test Loss: 3.595 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.014369010925293
Epoch: 7, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.236 Vali Acc: 0.351 Test Loss: 3.236 Test Acc: 0.351
Validation loss decreased (-0.283766 --> -0.351319).  Saving model ...
Epoch: 8 cost time: 4.324370384216309
Epoch: 8, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.044 Vali Acc: 0.243 Test Loss: 4.044 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.013209581375122
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 6.143 Vali Acc: 0.176 Test Loss: 6.143 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.692815065383911
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.667 Vali Acc: 0.270 Test Loss: 4.667 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.856343746185303
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 5.868 Vali Acc: 0.243 Test Loss: 5.868 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.531951189041138
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.776 Vali Acc: 0.270 Test Loss: 5.776 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.748347759246826
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.949 Vali Acc: 0.338 Test Loss: 5.949 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.437037467956543
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 7.250 Vali Acc: 0.257 Test Loss: 7.250 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.349240064620972
Epoch: 15, Steps: 10 | Train Loss: 0.104 Vali Loss: 7.343 Vali Acc: 0.324 Test Loss: 7.343 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.273157596588135
Epoch: 16, Steps: 10 | Train Loss: 0.169 Vali Loss: 9.069 Vali Acc: 0.243 Test Loss: 9.069 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.273755311965942
Epoch: 17, Steps: 10 | Train Loss: 0.085 Vali Loss: 8.433 Vali Acc: 0.243 Test Loss: 8.433 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.0952935218811035
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.521 Vali Acc: 0.243 Test Loss: 1.521 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 5.124163866043091
Epoch: 2, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.956 Vali Acc: 0.230 Test Loss: 1.956 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.347458839416504
Epoch: 3, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.810 Vali Acc: 0.270 Test Loss: 1.810 Test Acc: 0.270
Validation loss decreased (-0.243228 --> -0.270252).  Saving model ...
Epoch: 4 cost time: 5.259927272796631
Epoch: 4, Steps: 10 | Train Loss: 0.138 Vali Loss: 2.681 Vali Acc: 0.216 Test Loss: 2.681 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.362574338912964
Epoch: 5, Steps: 10 | Train Loss: 0.089 Vali Loss: 2.714 Vali Acc: 0.176 Test Loss: 2.714 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.543226003646851
Epoch: 6, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.813 Vali Acc: 0.176 Test Loss: 2.813 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.865126371383667
Epoch: 7, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.368 Vali Acc: 0.324 Test Loss: 4.368 Test Acc: 0.324
Validation loss decreased (-0.270252 --> -0.324281).  Saving model ...
Epoch: 8 cost time: 3.9690964221954346
Epoch: 8, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.051 Vali Acc: 0.257 Test Loss: 4.051 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.084211111068726
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.440 Vali Acc: 0.216 Test Loss: 3.440 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.62801718711853
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.103 Vali Acc: 0.311 Test Loss: 4.103 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.6530139446258545
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 5.658 Vali Acc: 0.216 Test Loss: 5.658 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.299471616744995
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.891 Vali Acc: 0.365 Test Loss: 4.891 Test Acc: 0.365
Validation loss decreased (-0.324281 --> -0.364816).  Saving model ...
Epoch: 13 cost time: 4.879170894622803
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.167 Vali Acc: 0.203 Test Loss: 6.167 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.521136999130249
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 6.075 Vali Acc: 0.338 Test Loss: 6.075 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.007400989532471
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 9.499 Vali Acc: 0.189 Test Loss: 9.499 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.07665491104126
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 6.980 Vali Acc: 0.311 Test Loss: 6.980 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.122488498687744
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 5.583 Vali Acc: 0.243 Test Loss: 5.583 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.254578351974487
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 7.807 Vali Acc: 0.257 Test Loss: 7.807 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.064895153045654
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 8.361 Vali Acc: 0.257 Test Loss: 8.361 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.832667112350464
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 8.469 Vali Acc: 0.257 Test Loss: 8.469 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.1216490268707275
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 6.948 Vali Acc: 0.257 Test Loss: 6.948 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.480513334274292
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 8.003 Vali Acc: 0.378 Test Loss: 8.003 Test Acc: 0.378
Validation loss decreased (-0.364816 --> -0.378298).  Saving model ...
Epoch: 23 cost time: 5.14814019203186
Epoch: 23, Steps: 10 | Train Loss: 0.173 Vali Loss: 7.588 Vali Acc: 0.230 Test Loss: 7.588 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.506549835205078
Epoch: 24, Steps: 10 | Train Loss: 0.061 Vali Loss: 8.314 Vali Acc: 0.189 Test Loss: 8.314 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.131187200546265
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 8.577 Vali Acc: 0.270 Test Loss: 8.577 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.283396482467651
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 9.605 Vali Acc: 0.230 Test Loss: 9.605 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.123939752578735
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 10.564 Vali Acc: 0.243 Test Loss: 10.564 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.169363260269165
Epoch: 28, Steps: 10 | Train Loss: 0.340 Vali Loss: 9.640 Vali Acc: 0.270 Test Loss: 9.640 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.374133348464966
Epoch: 29, Steps: 10 | Train Loss: 0.118 Vali Loss: 10.986 Vali Acc: 0.392 Test Loss: 10.986 Test Acc: 0.392
Validation loss decreased (-0.378298 --> -0.391782).  Saving model ...
Epoch: 30 cost time: 4.261083126068115
Epoch: 30, Steps: 10 | Train Loss: 0.121 Vali Loss: 10.377 Vali Acc: 0.324 Test Loss: 10.377 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.5089075565338135
Epoch: 31, Steps: 10 | Train Loss: 0.188 Vali Loss: 13.311 Vali Acc: 0.270 Test Loss: 13.311 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.546966314315796
Epoch: 32, Steps: 10 | Train Loss: 0.070 Vali Loss: 13.043 Vali Acc: 0.257 Test Loss: 13.043 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.139230489730835
Epoch: 33, Steps: 10 | Train Loss: 0.132 Vali Loss: 14.146 Vali Acc: 0.284 Test Loss: 14.146 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.576445579528809
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 14.040 Vali Acc: 0.284 Test Loss: 14.040 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.984859228134155
Epoch: 35, Steps: 10 | Train Loss: 0.091 Vali Loss: 12.643 Vali Acc: 0.324 Test Loss: 12.643 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.026458501815796
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 14.945 Vali Acc: 0.230 Test Loss: 14.945 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.741758108139038
Epoch: 37, Steps: 10 | Train Loss: 0.260 Vali Loss: 17.671 Vali Acc: 0.216 Test Loss: 17.671 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.724713563919067
Epoch: 38, Steps: 10 | Train Loss: 0.353 Vali Loss: 15.776 Vali Acc: 0.351 Test Loss: 15.776 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.012691497802734
Epoch: 39, Steps: 10 | Train Loss: 0.302 Vali Loss: 19.337 Vali Acc: 0.230 Test Loss: 19.337 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.250753402709961
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.539 Vali Acc: 0.149 Test Loss: 1.539 Test Acc: 0.149
Validation loss decreased (inf --> -0.148633).  Saving model ...
Epoch: 2 cost time: 5.167898178100586
Epoch: 2, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.728 Vali Acc: 0.176 Test Loss: 1.728 Test Acc: 0.176
Validation loss decreased (-0.148633 --> -0.175658).  Saving model ...
Epoch: 3 cost time: 4.6167333126068115
Epoch: 3, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.613 Vali Acc: 0.351 Test Loss: 1.613 Test Acc: 0.351
Validation loss decreased (-0.175658 --> -0.351335).  Saving model ...
Epoch: 4 cost time: 4.674241542816162
Epoch: 4, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.927 Vali Acc: 0.243 Test Loss: 1.927 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.978854656219482
Epoch: 5, Steps: 10 | Train Loss: 0.370 Vali Loss: 2.256 Vali Acc: 0.203 Test Loss: 2.256 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.636564254760742
Epoch: 6, Steps: 10 | Train Loss: 0.139 Vali Loss: 2.234 Vali Acc: 0.311 Test Loss: 2.234 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.864704132080078
Epoch: 7, Steps: 10 | Train Loss: 0.077 Vali Loss: 2.760 Vali Acc: 0.324 Test Loss: 2.760 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.462081670761108
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 2.718 Vali Acc: 0.338 Test Loss: 2.718 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.327301025390625
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.820 Vali Acc: 0.297 Test Loss: 2.820 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.5031044483184814
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.563 Vali Acc: 0.338 Test Loss: 3.563 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.353450536727905
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.486 Vali Acc: 0.365 Test Loss: 3.486 Test Acc: 0.365
Validation loss decreased (-0.351335 --> -0.364830).  Saving model ...
Epoch: 12 cost time: 5.975669860839844
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.406 Vali Acc: 0.378 Test Loss: 3.406 Test Acc: 0.378
Validation loss decreased (-0.364830 --> -0.378344).  Saving model ...
Epoch: 13 cost time: 4.920772075653076
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.500 Vali Acc: 0.297 Test Loss: 3.500 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.452836036682129
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.560 Vali Acc: 0.311 Test Loss: 3.560 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.881689071655273
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.459 Vali Acc: 0.338 Test Loss: 3.459 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.870558977127075
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.667 Vali Acc: 0.311 Test Loss: 3.667 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.532458066940308
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.674 Vali Acc: 0.324 Test Loss: 3.674 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.468895673751831
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.597 Vali Acc: 0.365 Test Loss: 3.597 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.24287223815918
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.809 Vali Acc: 0.351 Test Loss: 3.809 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.6526267528533936
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.841 Vali Acc: 0.324 Test Loss: 3.841 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.439094543457031
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.623 Vali Acc: 0.378 Test Loss: 3.623 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.298619031906128
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.623 Vali Acc: 0.365 Test Loss: 3.623 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.387210845947266
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.429 Vali Acc: 0.311 Test Loss: 1.429 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 5.167963981628418
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.718 Vali Acc: 0.216 Test Loss: 1.718 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.115715742111206
Epoch: 3, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.695 Vali Acc: 0.392 Test Loss: 1.695 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391875).  Saving model ...
Epoch: 4 cost time: 4.821169853210449
Epoch: 4, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.541 Vali Acc: 0.365 Test Loss: 1.541 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.918589115142822
Epoch: 5, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.936 Vali Acc: 0.270 Test Loss: 1.936 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.711339473724365
Epoch: 6, Steps: 10 | Train Loss: 0.202 Vali Loss: 2.365 Vali Acc: 0.243 Test Loss: 2.365 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.022094488143921
Epoch: 7, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.559 Vali Acc: 0.270 Test Loss: 2.559 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.017455101013184
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 2.977 Vali Acc: 0.365 Test Loss: 2.977 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.7436606884002686
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.452 Vali Acc: 0.365 Test Loss: 3.452 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.7958760261535645
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.891 Vali Acc: 0.324 Test Loss: 3.891 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.960057497024536
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.085 Vali Acc: 0.311 Test Loss: 4.085 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.953262567520142
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.316 Vali Acc: 0.311 Test Loss: 4.316 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.329330682754517
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.365 Vali Acc: 0.270 Test Loss: 4.365 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 14491140
model size : 74.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.735425710678101
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.363 Vali Acc: 0.324 Test Loss: 1.363 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 5.418910980224609
Epoch: 2, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.214 Vali Acc: 0.473 Test Loss: 1.214 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 5.516406297683716
Epoch: 3, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.417 Vali Acc: 0.486 Test Loss: 1.417 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486472).  Saving model ...
Epoch: 4 cost time: 5.206964492797852
Epoch: 4, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.382 Vali Acc: 0.527 Test Loss: 1.382 Test Acc: 0.527
Validation loss decreased (-0.486472 --> -0.527013).  Saving model ...
Epoch: 5 cost time: 5.862988233566284
Epoch: 5, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.921 Vali Acc: 0.541 Test Loss: 1.921 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540521).  Saving model ...
Epoch: 6 cost time: 4.639790773391724
Epoch: 6, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.600 Vali Acc: 0.595 Test Loss: 1.600 Test Acc: 0.595
Validation loss decreased (-0.540521 --> -0.594579).  Saving model ...
Epoch: 7 cost time: 5.615239858627319
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.041 Vali Acc: 0.595 Test Loss: 2.041 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.381366491317749
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.660 Vali Acc: 0.622 Test Loss: 1.660 Test Acc: 0.622
Validation loss decreased (-0.594579 --> -0.621605).  Saving model ...
Epoch: 9 cost time: 5.6822710037231445
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.253 Vali Acc: 0.500 Test Loss: 2.253 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.869760513305664
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.298 Vali Acc: 0.622 Test Loss: 2.298 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.3208253383636475
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.304 Vali Acc: 0.568 Test Loss: 2.304 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.558716058731079
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.304 Vali Acc: 0.595 Test Loss: 2.304 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.463888168334961
Epoch: 13, Steps: 10 | Train Loss: 0.345 Vali Loss: 4.989 Vali Acc: 0.500 Test Loss: 4.989 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.221486330032349
Epoch: 14, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.487 Vali Acc: 0.527 Test Loss: 3.487 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.8570170402526855
Epoch: 15, Steps: 10 | Train Loss: 0.291 Vali Loss: 5.528 Vali Acc: 0.541 Test Loss: 5.528 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.295639276504517
Epoch: 16, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.296 Vali Acc: 0.649 Test Loss: 4.296 Test Acc: 0.649
Validation loss decreased (-0.621605 --> -0.648606).  Saving model ...
Epoch: 17 cost time: 6.090608596801758
Epoch: 17, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.868 Vali Acc: 0.554 Test Loss: 3.868 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.511111736297607
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 6.038 Vali Acc: 0.541 Test Loss: 6.038 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.070958852767944
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.959 Vali Acc: 0.622 Test Loss: 3.959 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.667999029159546
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.954 Vali Acc: 0.541 Test Loss: 4.954 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.74109148979187
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.964 Vali Acc: 0.568 Test Loss: 4.964 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.025001764297485
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.258 Vali Acc: 0.500 Test Loss: 6.258 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.7258172035217285
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 6.045 Vali Acc: 0.500 Test Loss: 6.045 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.414712190628052
Epoch: 24, Steps: 10 | Train Loss: 0.309 Vali Loss: 7.739 Vali Acc: 0.595 Test Loss: 7.739 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.291835069656372
Epoch: 25, Steps: 10 | Train Loss: 0.212 Vali Loss: 9.400 Vali Acc: 0.514 Test Loss: 9.400 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.153856992721558
Epoch: 26, Steps: 10 | Train Loss: 0.564 Vali Loss: 6.088 Vali Acc: 0.608 Test Loss: 6.088 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.152629852294922
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.430 Vali Acc: 0.378 Test Loss: 1.430 Test Acc: 0.378
Validation loss decreased (inf --> -0.378364).  Saving model ...
Epoch: 2 cost time: 4.975523471832275
Epoch: 2, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.272 Vali Acc: 0.527 Test Loss: 1.272 Test Acc: 0.527
Validation loss decreased (-0.378364 --> -0.527014).  Saving model ...
Epoch: 3 cost time: 5.521420001983643
Epoch: 3, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.427 Vali Acc: 0.419 Test Loss: 1.427 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.878801345825195
Epoch: 4, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 6.143446683883667
Epoch: 5, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.683 Vali Acc: 0.541 Test Loss: 1.683 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.701532602310181
Epoch: 6, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.674 Vali Acc: 0.568 Test Loss: 1.674 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567551).  Saving model ...
Epoch: 7 cost time: 5.511591911315918
Epoch: 7, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.079 Vali Acc: 0.595 Test Loss: 2.079 Test Acc: 0.595
Validation loss decreased (-0.567551 --> -0.594574).  Saving model ...
Epoch: 8 cost time: 5.250777959823608
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.908 Vali Acc: 0.500 Test Loss: 1.908 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.28670859336853
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.771 Vali Acc: 0.622 Test Loss: 1.771 Test Acc: 0.622
Validation loss decreased (-0.594574 --> -0.621604).  Saving model ...
Epoch: 10 cost time: 5.804643869400024
Epoch: 10, Steps: 10 | Train Loss: 0.110 Vali Loss: 2.962 Vali Acc: 0.486 Test Loss: 2.962 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.101588487625122
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 2.866 Vali Acc: 0.595 Test Loss: 2.866 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.123746156692505
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.359 Vali Acc: 0.554 Test Loss: 4.359 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.672147989273071
Epoch: 13, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.985 Vali Acc: 0.541 Test Loss: 3.985 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.7174460887908936
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.958 Vali Acc: 0.608 Test Loss: 3.958 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.382713556289673
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.828 Vali Acc: 0.514 Test Loss: 3.828 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.397155523300171
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.171 Vali Acc: 0.568 Test Loss: 4.171 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.104159832000732
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.844 Vali Acc: 0.568 Test Loss: 4.844 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.30515456199646
Epoch: 18, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.562 Vali Acc: 0.514 Test Loss: 4.562 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.028665781021118
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 5.511 Vali Acc: 0.514 Test Loss: 5.511 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.207188844680786
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.560 Vali Acc: 0.243 Test Loss: 1.560 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 5.051859617233276
Epoch: 2, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.783 Vali Acc: 0.365 Test Loss: 1.783 Test Acc: 0.365
Validation loss decreased (-0.243228 --> -0.364847).  Saving model ...
Epoch: 3 cost time: 5.437676191329956
Epoch: 3, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.986 Vali Acc: 0.324 Test Loss: 1.986 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.656245708465576
Epoch: 4, Steps: 10 | Train Loss: 0.105 Vali Loss: 2.224 Vali Acc: 0.419 Test Loss: 2.224 Test Acc: 0.419
Validation loss decreased (-0.364847 --> -0.418897).  Saving model ...
Epoch: 5 cost time: 5.196270227432251
Epoch: 5, Steps: 10 | Train Loss: 0.060 Vali Loss: 2.887 Vali Acc: 0.405 Test Loss: 2.887 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.495504856109619
Epoch: 6, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.152 Vali Acc: 0.243 Test Loss: 4.152 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.716739892959595
Epoch: 7, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.761 Vali Acc: 0.365 Test Loss: 3.761 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.279759407043457
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.427 Vali Acc: 0.351 Test Loss: 4.427 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.780668497085571
Epoch: 9, Steps: 10 | Train Loss: 0.092 Vali Loss: 5.096 Vali Acc: 0.311 Test Loss: 5.096 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.457437992095947
Epoch: 10, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.135 Vali Acc: 0.338 Test Loss: 5.135 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.14167332649231
Epoch: 11, Steps: 10 | Train Loss: 0.061 Vali Loss: 5.767 Vali Acc: 0.351 Test Loss: 5.767 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.653304100036621
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 6.225 Vali Acc: 0.338 Test Loss: 6.225 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.231666803359985
Epoch: 13, Steps: 10 | Train Loss: 0.085 Vali Loss: 6.235 Vali Acc: 0.378 Test Loss: 6.235 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.9885027408599854
Epoch: 14, Steps: 10 | Train Loss: 0.322 Vali Loss: 8.775 Vali Acc: 0.297 Test Loss: 8.775 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.552014589309692
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.674 Vali Acc: 0.189 Test Loss: 1.674 Test Acc: 0.189
Validation loss decreased (inf --> -0.189172).  Saving model ...
Epoch: 2 cost time: 4.8786444664001465
Epoch: 2, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.764 Vali Acc: 0.324 Test Loss: 1.764 Test Acc: 0.324
Validation loss decreased (-0.189172 --> -0.324307).  Saving model ...
Epoch: 3 cost time: 5.119969367980957
Epoch: 3, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.936 Vali Acc: 0.365 Test Loss: 1.936 Test Acc: 0.365
Validation loss decreased (-0.324307 --> -0.364846).  Saving model ...
Epoch: 4 cost time: 4.385915279388428
Epoch: 4, Steps: 10 | Train Loss: 0.235 Vali Loss: 2.228 Vali Acc: 0.284 Test Loss: 2.228 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.835874795913696
Epoch: 5, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.990 Vali Acc: 0.243 Test Loss: 2.990 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.18602728843689
Epoch: 6, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.620 Vali Acc: 0.257 Test Loss: 3.620 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.847072601318359
Epoch: 7, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.277 Vali Acc: 0.351 Test Loss: 4.277 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.3233323097229
Epoch: 8, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.178 Vali Acc: 0.338 Test Loss: 4.178 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.401686668395996
Epoch: 9, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.547 Vali Acc: 0.351 Test Loss: 4.547 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.98644757270813
Epoch: 10, Steps: 10 | Train Loss: 0.275 Vali Loss: 6.809 Vali Acc: 0.243 Test Loss: 6.809 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.088662624359131
Epoch: 11, Steps: 10 | Train Loss: 0.134 Vali Loss: 6.005 Vali Acc: 0.297 Test Loss: 6.005 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.773254871368408
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.360 Vali Acc: 0.351 Test Loss: 5.360 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.687166929244995
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 6.688 Vali Acc: 0.338 Test Loss: 6.688 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.3357298374176025
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.700 Vali Acc: 0.189 Test Loss: 1.700 Test Acc: 0.189
Validation loss decreased (inf --> -0.189172).  Saving model ...
Epoch: 2 cost time: 5.284013271331787
Epoch: 2, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.666 Vali Acc: 0.284 Test Loss: 1.666 Test Acc: 0.284
Validation loss decreased (-0.189172 --> -0.283767).  Saving model ...
Epoch: 3 cost time: 5.332976579666138
Epoch: 3, Steps: 10 | Train Loss: 0.292 Vali Loss: 2.148 Vali Acc: 0.351 Test Loss: 2.148 Test Acc: 0.351
Validation loss decreased (-0.283767 --> -0.351330).  Saving model ...
Epoch: 4 cost time: 4.71169114112854
Epoch: 4, Steps: 10 | Train Loss: 0.122 Vali Loss: 2.547 Vali Acc: 0.324 Test Loss: 2.547 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.158100843429565
Epoch: 5, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.016 Vali Acc: 0.405 Test Loss: 3.016 Test Acc: 0.405
Validation loss decreased (-0.351330 --> -0.405375).  Saving model ...
Epoch: 6 cost time: 5.0051796436309814
Epoch: 6, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.805 Vali Acc: 0.351 Test Loss: 3.805 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.298986911773682
Epoch: 7, Steps: 10 | Train Loss: 0.113 Vali Loss: 6.675 Vali Acc: 0.270 Test Loss: 6.675 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.955456256866455
Epoch: 8, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.388 Vali Acc: 0.311 Test Loss: 4.388 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.384991884231567
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.602 Vali Acc: 0.270 Test Loss: 4.602 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.681174278259277
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.522 Vali Acc: 0.203 Test Loss: 5.522 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.403857469558716
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.714 Vali Acc: 0.257 Test Loss: 5.714 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.393064975738525
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.906 Vali Acc: 0.324 Test Loss: 5.906 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.5099475383758545
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.909 Vali Acc: 0.324 Test Loss: 5.909 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.973993539810181
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.395 Vali Acc: 0.297 Test Loss: 6.395 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.246966123580933
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 7.890 Vali Acc: 0.203 Test Loss: 7.890 Test Acc: 0.203
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.118286848068237
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.682 Vali Acc: 0.203 Test Loss: 1.682 Test Acc: 0.203
Validation loss decreased (inf --> -0.202686).  Saving model ...
Epoch: 2 cost time: 5.063236236572266
Epoch: 2, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.775 Vali Acc: 0.284 Test Loss: 1.775 Test Acc: 0.284
Validation loss decreased (-0.202686 --> -0.283766).  Saving model ...
Epoch: 3 cost time: 5.1421637535095215
Epoch: 3, Steps: 10 | Train Loss: 0.275 Vali Loss: 2.045 Vali Acc: 0.392 Test Loss: 2.045 Test Acc: 0.392
Validation loss decreased (-0.283766 --> -0.391871).  Saving model ...
Epoch: 4 cost time: 4.948142051696777
Epoch: 4, Steps: 10 | Train Loss: 0.124 Vali Loss: 2.379 Vali Acc: 0.365 Test Loss: 2.379 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.127880096435547
Epoch: 5, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.092 Vali Acc: 0.284 Test Loss: 3.092 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.364640712738037
Epoch: 6, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.433 Vali Acc: 0.216 Test Loss: 3.433 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.8350889682769775
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.398 Vali Acc: 0.338 Test Loss: 3.398 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.706363916397095
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.680 Vali Acc: 0.284 Test Loss: 3.680 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.246941328048706
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.805 Vali Acc: 0.284 Test Loss: 3.805 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.840832233428955
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.934 Vali Acc: 0.297 Test Loss: 3.934 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.742809295654297
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.877 Vali Acc: 0.270 Test Loss: 3.877 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.449277639389038
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.852 Vali Acc: 0.284 Test Loss: 3.852 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.952269792556763
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.890 Vali Acc: 0.311 Test Loss: 3.890 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.891479969024658
Epoch: 1, Steps: 10 | Train Loss: 1.541 Vali Loss: 1.796 Vali Acc: 0.176 Test Loss: 1.796 Test Acc: 0.176
Validation loss decreased (inf --> -0.175658).  Saving model ...
Epoch: 2 cost time: 4.044296026229858
Epoch: 2, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.661 Vali Acc: 0.324 Test Loss: 1.661 Test Acc: 0.324
Validation loss decreased (-0.175658 --> -0.324308).  Saving model ...
Epoch: 3 cost time: 4.174863576889038
Epoch: 3, Steps: 10 | Train Loss: 0.656 Vali Loss: 2.220 Vali Acc: 0.297 Test Loss: 2.220 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9529638290405273
Epoch: 4, Steps: 10 | Train Loss: 0.418 Vali Loss: 2.114 Vali Acc: 0.311 Test Loss: 2.114 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.948618412017822
Epoch: 5, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.454 Vali Acc: 0.297 Test Loss: 3.454 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.6035542488098145
Epoch: 6, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.483 Vali Acc: 0.203 Test Loss: 3.483 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.571720838546753
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.544 Vali Acc: 0.311 Test Loss: 3.544 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.6674933433532715
Epoch: 8, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.493 Vali Acc: 0.203 Test Loss: 4.493 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.561851739883423
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.438 Vali Acc: 0.216 Test Loss: 4.438 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.833214998245239
Epoch: 10, Steps: 10 | Train Loss: 0.329 Vali Loss: 6.433 Vali Acc: 0.243 Test Loss: 6.433 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.588588237762451
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.278 Vali Acc: 0.270 Test Loss: 5.278 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.425617694854736
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.080 Vali Acc: 0.284 Test Loss: 7.080 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.905153036117554
Epoch: 1, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.720 Vali Acc: 0.189 Test Loss: 1.720 Test Acc: 0.189
Validation loss decreased (inf --> -0.189172).  Saving model ...
Epoch: 2 cost time: 4.345765590667725
Epoch: 2, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.556 Vali Acc: 0.216 Test Loss: 1.556 Test Acc: 0.216
Validation loss decreased (-0.189172 --> -0.216201).  Saving model ...
Epoch: 3 cost time: 5.5243988037109375
Epoch: 3, Steps: 10 | Train Loss: 0.388 Vali Loss: 2.016 Vali Acc: 0.311 Test Loss: 2.016 Test Acc: 0.311
Validation loss decreased (-0.216201 --> -0.310791).  Saving model ...
Epoch: 4 cost time: 4.958385705947876
Epoch: 4, Steps: 10 | Train Loss: 0.214 Vali Loss: 2.231 Vali Acc: 0.365 Test Loss: 2.231 Test Acc: 0.365
Validation loss decreased (-0.310791 --> -0.364843).  Saving model ...
Epoch: 5 cost time: 4.765628099441528
Epoch: 5, Steps: 10 | Train Loss: 0.141 Vali Loss: 2.578 Vali Acc: 0.311 Test Loss: 2.578 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.78135347366333
Epoch: 6, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.685 Vali Acc: 0.338 Test Loss: 2.685 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.250826120376587
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.312 Vali Acc: 0.216 Test Loss: 3.312 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.79113245010376
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.106 Vali Acc: 0.189 Test Loss: 4.106 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.598516225814819
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.213 Vali Acc: 0.338 Test Loss: 4.213 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.143672704696655
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.754 Vali Acc: 0.284 Test Loss: 4.754 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.406038284301758
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.935 Vali Acc: 0.297 Test Loss: 3.935 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.849334478378296
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 7.683 Vali Acc: 0.243 Test Loss: 7.683 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.143157958984375
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.413 Vali Acc: 0.311 Test Loss: 4.413 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.838444471359253
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.997 Vali Acc: 0.257 Test Loss: 4.997 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.088903427124023
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.684 Vali Acc: 0.203 Test Loss: 1.684 Test Acc: 0.203
Validation loss decreased (inf --> -0.202686).  Saving model ...
Epoch: 2 cost time: 5.516278982162476
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.459 Vali Acc: 0.270 Test Loss: 1.459 Test Acc: 0.270
Validation loss decreased (-0.202686 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 5.09194278717041
Epoch: 3, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.547 Vali Acc: 0.284 Test Loss: 1.547 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283768).  Saving model ...
Epoch: 4 cost time: 4.846001386642456
Epoch: 4, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.601 Vali Acc: 0.338 Test Loss: 1.601 Test Acc: 0.338
Validation loss decreased (-0.283768 --> -0.337822).  Saving model ...
Epoch: 5 cost time: 5.116170167922974
Epoch: 5, Steps: 10 | Train Loss: 0.277 Vali Loss: 2.090 Vali Acc: 0.338 Test Loss: 2.090 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.475762367248535
Epoch: 6, Steps: 10 | Train Loss: 0.129 Vali Loss: 2.249 Vali Acc: 0.365 Test Loss: 2.249 Test Acc: 0.365
Validation loss decreased (-0.337822 --> -0.364842).  Saving model ...
Epoch: 7 cost time: 4.85181188583374
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 2.794 Vali Acc: 0.392 Test Loss: 2.794 Test Acc: 0.392
Validation loss decreased (-0.364842 --> -0.391864).  Saving model ...
Epoch: 8 cost time: 4.539214372634888
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.175 Vali Acc: 0.338 Test Loss: 3.175 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.120730638504028
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.279 Vali Acc: 0.311 Test Loss: 3.279 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.796338796615601
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.596 Vali Acc: 0.270 Test Loss: 3.596 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.89022970199585
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.889 Vali Acc: 0.311 Test Loss: 3.889 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.483083963394165
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.701 Vali Acc: 0.324 Test Loss: 4.701 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.124660491943359
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.001 Vali Acc: 0.324 Test Loss: 4.001 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.417874336242676
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.609 Vali Acc: 0.284 Test Loss: 4.609 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.128943681716919
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.518 Vali Acc: 0.311 Test Loss: 4.518 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.603755235671997
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.581 Vali Acc: 0.351 Test Loss: 4.581 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.827325344085693
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.990 Vali Acc: 0.311 Test Loss: 5.990 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.820803642272949
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.606 Vali Acc: 0.203 Test Loss: 1.606 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 4.126586437225342
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.611 Vali Acc: 0.189 Test Loss: 1.611 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.57334303855896
Epoch: 3, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.745 Vali Acc: 0.230 Test Loss: 1.745 Test Acc: 0.230
Validation loss decreased (-0.202687 --> -0.229712).  Saving model ...
Epoch: 4 cost time: 4.894372463226318
Epoch: 4, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.594 Vali Acc: 0.284 Test Loss: 1.594 Test Acc: 0.284
Validation loss decreased (-0.229712 --> -0.283768).  Saving model ...
Epoch: 5 cost time: 4.645176887512207
Epoch: 5, Steps: 10 | Train Loss: 0.396 Vali Loss: 2.055 Vali Acc: 0.351 Test Loss: 2.055 Test Acc: 0.351
Validation loss decreased (-0.283768 --> -0.351331).  Saving model ...
Epoch: 6 cost time: 4.655860900878906
Epoch: 6, Steps: 10 | Train Loss: 0.217 Vali Loss: 2.115 Vali Acc: 0.365 Test Loss: 2.115 Test Acc: 0.365
Validation loss decreased (-0.351331 --> -0.364844).  Saving model ...
Epoch: 7 cost time: 4.701731204986572
Epoch: 7, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.344 Vali Acc: 0.311 Test Loss: 3.344 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.758630037307739
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.252 Vali Acc: 0.216 Test Loss: 3.252 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.673925876617432
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.811 Vali Acc: 0.297 Test Loss: 3.811 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.7863609790802
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.851 Vali Acc: 0.270 Test Loss: 3.851 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.465821981430054
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.115 Vali Acc: 0.243 Test Loss: 4.115 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.646076202392578
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.598 Vali Acc: 0.297 Test Loss: 4.598 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.36217737197876
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.170 Vali Acc: 0.297 Test Loss: 5.170 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.9328694343566895
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.870 Vali Acc: 0.230 Test Loss: 5.870 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.620344161987305
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.809 Vali Acc: 0.243 Test Loss: 5.809 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.960408449172974
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.340 Vali Acc: 0.230 Test Loss: 5.340 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 12918276
model size : 68.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.316047668457031
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.197 Vali Acc: 0.459 Test Loss: 1.197 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 5.324557542800903
Epoch: 2, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.180 Vali Acc: 0.459 Test Loss: 1.180 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 3 cost time: 6.181756258010864
Epoch: 3, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.242 Vali Acc: 0.473 Test Loss: 1.242 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 6.38029670715332
Epoch: 4, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.836 Vali Acc: 0.432 Test Loss: 1.836 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.76329231262207
Epoch: 5, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.870 Vali Acc: 0.554 Test Loss: 1.870 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554035).  Saving model ...
Epoch: 6 cost time: 5.797370910644531
Epoch: 6, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.752 Vali Acc: 0.473 Test Loss: 1.752 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.027317047119141
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.703 Vali Acc: 0.568 Test Loss: 2.703 Test Acc: 0.568
Validation loss decreased (-0.554035 --> -0.567541).  Saving model ...
Epoch: 8 cost time: 5.8388941287994385
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.048 Vali Acc: 0.541 Test Loss: 2.048 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.021192789077759
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.430 Vali Acc: 0.568 Test Loss: 2.430 Test Acc: 0.568
Validation loss decreased (-0.567541 --> -0.567543).  Saving model ...
Epoch: 10 cost time: 6.462974548339844
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.714 Vali Acc: 0.554 Test Loss: 3.714 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.960967302322388
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 2.994 Vali Acc: 0.554 Test Loss: 2.994 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.077038526535034
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.016 Vali Acc: 0.581 Test Loss: 3.016 Test Acc: 0.581
Validation loss decreased (-0.567543 --> -0.581051).  Saving model ...
Epoch: 13 cost time: 6.409761190414429
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.019 Vali Acc: 0.568 Test Loss: 3.019 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.961016654968262
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.523 Vali Acc: 0.608 Test Loss: 2.523 Test Acc: 0.608
Validation loss decreased (-0.581051 --> -0.608083).  Saving model ...
Epoch: 15 cost time: 6.014303922653198
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.760 Vali Acc: 0.581 Test Loss: 2.760 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.629597187042236
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.617 Vali Acc: 0.622 Test Loss: 2.617 Test Acc: 0.622
Validation loss decreased (-0.608083 --> -0.621595).  Saving model ...
Epoch: 17 cost time: 6.040869951248169
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.602 Vali Acc: 0.608 Test Loss: 2.602 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.17366099357605
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.607 Vali Acc: 0.622 Test Loss: 2.607 Test Acc: 0.622
Validation loss decreased (-0.621595 --> -0.621596).  Saving model ...
Epoch: 19 cost time: 6.162143230438232
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.612 Vali Acc: 0.635 Test Loss: 2.612 Test Acc: 0.635
Validation loss decreased (-0.621596 --> -0.635109).  Saving model ...
Epoch: 20 cost time: 6.447329521179199
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.606 Vali Acc: 0.622 Test Loss: 2.606 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.9712700843811035
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.592 Vali Acc: 0.622 Test Loss: 2.592 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.168292760848999
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.579 Vali Acc: 0.622 Test Loss: 2.579 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.160838842391968
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.569 Vali Acc: 0.622 Test Loss: 2.569 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.741737365722656
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.565 Vali Acc: 0.635 Test Loss: 2.565 Test Acc: 0.635
Validation loss decreased (-0.635109 --> -0.635109).  Saving model ...
Epoch: 25 cost time: 4.975400686264038
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.562 Vali Acc: 0.635 Test Loss: 2.562 Test Acc: 0.635
Validation loss decreased (-0.635109 --> -0.635110).  Saving model ...
Epoch: 26 cost time: 5.243228197097778
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.561 Vali Acc: 0.635 Test Loss: 2.561 Test Acc: 0.635
Validation loss decreased (-0.635110 --> -0.635110).  Saving model ...
Epoch: 27 cost time: 4.676205396652222
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.561 Vali Acc: 0.635 Test Loss: 2.561 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.417518377304077
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.560 Vali Acc: 0.635 Test Loss: 2.560 Test Acc: 0.635
Validation loss decreased (-0.635110 --> -0.635110).  Saving model ...
Epoch: 29 cost time: 5.597341775894165
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.559 Vali Acc: 0.635 Test Loss: 2.559 Test Acc: 0.635
Validation loss decreased (-0.635110 --> -0.635110).  Saving model ...
Epoch: 30 cost time: 5.168846607208252
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.622 Test Loss: 2.557 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.933613538742065
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.622 Test Loss: 2.557 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.653404235839844
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.622 Test Loss: 2.557 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.1592535972595215
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.608 Test Loss: 2.557 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.069175481796265
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.608 Test Loss: 2.557 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.44735860824585
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.555 Vali Acc: 0.608 Test Loss: 2.555 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.353888511657715
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.554 Vali Acc: 0.608 Test Loss: 2.554 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.90580153465271
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.608 Test Loss: 2.552 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.921675682067871
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.608 Test Loss: 2.552 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.843807697296143
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.551 Vali Acc: 0.608 Test Loss: 2.551 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.798962831497192
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
Validation loss decreased (inf --> -0.472961).  Saving model ...
Epoch: 2 cost time: 4.076998949050903
Epoch: 2, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.413 Vali Acc: 0.459 Test Loss: 1.413 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.569109678268433
Epoch: 3, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
Validation loss decreased (-0.472961 --> -0.581068).  Saving model ...
Epoch: 4 cost time: 4.971314907073975
Epoch: 4, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.696014642715454
Epoch: 5, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.530 Vali Acc: 0.608 Test Loss: 1.530 Test Acc: 0.608
Validation loss decreased (-0.581068 --> -0.608093).  Saving model ...
Epoch: 6 cost time: 5.3967883586883545
Epoch: 6, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.775 Vali Acc: 0.514 Test Loss: 1.775 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.429403305053711
Epoch: 7, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.764 Vali Acc: 0.554 Test Loss: 1.764 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.1934814453125
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.208 Vali Acc: 0.527 Test Loss: 2.208 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.451098918914795
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.038 Vali Acc: 0.527 Test Loss: 2.038 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.716040849685669
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.962 Vali Acc: 0.514 Test Loss: 1.962 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.609792470932007
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.568 Test Loss: 1.873 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.907317638397217
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.554 Test Loss: 1.827 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.072502374649048
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.581 Test Loss: 1.824 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.549510717391968
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.541 Test Loss: 1.837 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.919596195220947
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.541 Test Loss: 1.833 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.175460338592529
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.393 Vali Acc: 0.324 Test Loss: 1.393 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 6.069900035858154
Epoch: 2, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.755 Vali Acc: 0.351 Test Loss: 1.755 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351334).  Saving model ...
Epoch: 3 cost time: 5.446228981018066
Epoch: 3, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.919 Vali Acc: 0.365 Test Loss: 1.919 Test Acc: 0.365
Validation loss decreased (-0.351334 --> -0.364846).  Saving model ...
Epoch: 4 cost time: 5.032361030578613
Epoch: 4, Steps: 10 | Train Loss: 0.137 Vali Loss: 2.299 Vali Acc: 0.392 Test Loss: 2.299 Test Acc: 0.392
Validation loss decreased (-0.364846 --> -0.391869).  Saving model ...
Epoch: 5 cost time: 5.265018463134766
Epoch: 5, Steps: 10 | Train Loss: 0.109 Vali Loss: 2.504 Vali Acc: 0.365 Test Loss: 2.504 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.641437530517578
Epoch: 6, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.541 Vali Acc: 0.284 Test Loss: 3.541 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.308825969696045
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.896 Vali Acc: 0.324 Test Loss: 3.896 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.580635070800781
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.847 Vali Acc: 0.365 Test Loss: 3.847 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.176404714584351
Epoch: 9, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.204 Vali Acc: 0.378 Test Loss: 4.204 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.264112949371338
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.905 Vali Acc: 0.338 Test Loss: 4.905 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.511476278305054
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.652 Vali Acc: 0.338 Test Loss: 4.652 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.387195587158203
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.481 Vali Acc: 0.392 Test Loss: 5.481 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.872793436050415
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 6.191 Vali Acc: 0.419 Test Loss: 6.191 Test Acc: 0.419
Validation loss decreased (-0.391869 --> -0.418857).  Saving model ...
Epoch: 14 cost time: 5.675299644470215
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.856 Vali Acc: 0.405 Test Loss: 5.856 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.333002328872681
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 7.643 Vali Acc: 0.432 Test Loss: 7.643 Test Acc: 0.432
Validation loss decreased (-0.418857 --> -0.432356).  Saving model ...
Epoch: 16 cost time: 5.742202043533325
Epoch: 16, Steps: 10 | Train Loss: 0.388 Vali Loss: 6.781 Vali Acc: 0.405 Test Loss: 6.781 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.515092849731445
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 6.191 Vali Acc: 0.446 Test Loss: 6.191 Test Acc: 0.446
Validation loss decreased (-0.432356 --> -0.445884).  Saving model ...
Epoch: 18 cost time: 5.430469512939453
Epoch: 18, Steps: 10 | Train Loss: 0.158 Vali Loss: 7.799 Vali Acc: 0.378 Test Loss: 7.799 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.772955417633057
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 8.747 Vali Acc: 0.392 Test Loss: 8.747 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.124690055847168
Epoch: 20, Steps: 10 | Train Loss: 0.108 Vali Loss: 8.924 Vali Acc: 0.405 Test Loss: 8.924 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.9634315967559814
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.685 Vali Acc: 0.432 Test Loss: 7.685 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.997879981994629
Epoch: 22, Steps: 10 | Train Loss: 0.089 Vali Loss: 10.104 Vali Acc: 0.365 Test Loss: 10.104 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.399463415145874
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 9.361 Vali Acc: 0.365 Test Loss: 9.361 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.986880540847778
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 9.774 Vali Acc: 0.459 Test Loss: 9.774 Test Acc: 0.459
Validation loss decreased (-0.445884 --> -0.459362).  Saving model ...
Epoch: 25 cost time: 4.221006155014038
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 9.431 Vali Acc: 0.419 Test Loss: 9.431 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.315730333328247
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 11.435 Vali Acc: 0.378 Test Loss: 11.435 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.697494029998779
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 11.203 Vali Acc: 0.378 Test Loss: 11.203 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.510009288787842
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 10.264 Vali Acc: 0.392 Test Loss: 10.264 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.117681980133057
Epoch: 29, Steps: 10 | Train Loss: 0.220 Vali Loss: 10.073 Vali Acc: 0.284 Test Loss: 10.073 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.086112976074219
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 13.187 Vali Acc: 0.324 Test Loss: 13.187 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.35624361038208
Epoch: 31, Steps: 10 | Train Loss: 0.437 Vali Loss: 12.060 Vali Acc: 0.419 Test Loss: 12.060 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.085131645202637
Epoch: 32, Steps: 10 | Train Loss: 0.232 Vali Loss: 13.552 Vali Acc: 0.446 Test Loss: 13.552 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.325984954833984
Epoch: 33, Steps: 10 | Train Loss: 0.098 Vali Loss: 16.312 Vali Acc: 0.392 Test Loss: 16.312 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.891492128372192
Epoch: 34, Steps: 10 | Train Loss: 0.146 Vali Loss: 16.822 Vali Acc: 0.392 Test Loss: 16.822 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.126293420791626
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.420 Vali Acc: 0.405 Test Loss: 1.420 Test Acc: 0.405
Validation loss decreased (inf --> -0.405391).  Saving model ...
Epoch: 2 cost time: 4.0602126121521
Epoch: 2, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.708 Vali Acc: 0.297 Test Loss: 1.708 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.952260971069336
Epoch: 3, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.946 Vali Acc: 0.243 Test Loss: 1.946 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.504290342330933
Epoch: 4, Steps: 10 | Train Loss: 0.144 Vali Loss: 2.493 Vali Acc: 0.311 Test Loss: 2.493 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.59089994430542
Epoch: 5, Steps: 10 | Train Loss: 0.149 Vali Loss: 2.713 Vali Acc: 0.324 Test Loss: 2.713 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.677928686141968
Epoch: 6, Steps: 10 | Train Loss: 0.056 Vali Loss: 2.967 Vali Acc: 0.311 Test Loss: 2.967 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.656977653503418
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.134 Vali Acc: 0.338 Test Loss: 3.134 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.768747329711914
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.230 Vali Acc: 0.338 Test Loss: 3.230 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.863178968429565
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.454 Vali Acc: 0.351 Test Loss: 3.454 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.2050464153289795
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.041 Vali Acc: 0.351 Test Loss: 4.041 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.05604887008667
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.913 Vali Acc: 0.338 Test Loss: 3.913 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.130035400390625
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.437 Vali Acc: 0.351 Test Loss: 1.437 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 4.514463424682617
Epoch: 2, Steps: 10 | Train Loss: 1.082 Vali Loss: 2.051 Vali Acc: 0.189 Test Loss: 2.051 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.856714725494385
Epoch: 3, Steps: 10 | Train Loss: 0.498 Vali Loss: 2.143 Vali Acc: 0.243 Test Loss: 2.143 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.40185284614563
Epoch: 4, Steps: 10 | Train Loss: 0.229 Vali Loss: 2.384 Vali Acc: 0.284 Test Loss: 2.384 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.4587647914886475
Epoch: 5, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.701 Vali Acc: 0.216 Test Loss: 3.701 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.9770729541778564
Epoch: 6, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.408 Vali Acc: 0.230 Test Loss: 3.408 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.6913933753967285
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.629 Vali Acc: 0.230 Test Loss: 4.629 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.468003988265991
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.049 Vali Acc: 0.270 Test Loss: 5.049 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.057794809341431
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.743 Vali Acc: 0.270 Test Loss: 4.743 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.697827339172363
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.096 Vali Acc: 0.270 Test Loss: 5.096 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.9371020793914795
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.156 Vali Acc: 0.243 Test Loss: 5.156 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.247612237930298
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.446 Vali Acc: 0.446 Test Loss: 1.446 Test Acc: 0.446
Validation loss decreased (inf --> -0.445931).  Saving model ...
Epoch: 2 cost time: 4.9506516456604
Epoch: 2, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.867 Vali Acc: 0.351 Test Loss: 1.867 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.5513715744018555
Epoch: 3, Steps: 10 | Train Loss: 0.364 Vali Loss: 2.010 Vali Acc: 0.297 Test Loss: 2.010 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.67103385925293
Epoch: 4, Steps: 10 | Train Loss: 0.106 Vali Loss: 2.579 Vali Acc: 0.230 Test Loss: 2.579 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.515387535095215
Epoch: 5, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.987 Vali Acc: 0.378 Test Loss: 2.987 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.680639266967773
Epoch: 6, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.595 Vali Acc: 0.257 Test Loss: 3.595 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.356592893600464
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.174 Vali Acc: 0.257 Test Loss: 4.174 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.20577335357666
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.092 Vali Acc: 0.284 Test Loss: 4.092 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.858191251754761
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.324 Vali Acc: 0.270 Test Loss: 4.324 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.31156849861145
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.155 Vali Acc: 0.270 Test Loss: 4.155 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.296643972396851
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.139 Vali Acc: 0.311 Test Loss: 4.139 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.4786152839660645
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.423 Vali Acc: 0.378 Test Loss: 1.423 Test Acc: 0.378
Validation loss decreased (inf --> -0.378364).  Saving model ...
Epoch: 2 cost time: 4.776964902877808
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 2.171 Vali Acc: 0.243 Test Loss: 2.171 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.51482367515564
Epoch: 3, Steps: 10 | Train Loss: 1.110 Vali Loss: 2.487 Vali Acc: 0.284 Test Loss: 2.487 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.79035496711731
Epoch: 4, Steps: 10 | Train Loss: 0.776 Vali Loss: 2.899 Vali Acc: 0.243 Test Loss: 2.899 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.10832142829895
Epoch: 5, Steps: 10 | Train Loss: 0.494 Vali Loss: 2.614 Vali Acc: 0.203 Test Loss: 2.614 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.770688056945801
Epoch: 6, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.083 Vali Acc: 0.230 Test Loss: 3.083 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8374969959259033
Epoch: 7, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.617 Vali Acc: 0.243 Test Loss: 3.617 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.494015216827393
Epoch: 8, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.151 Vali Acc: 0.257 Test Loss: 4.151 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9536006450653076
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.510 Vali Acc: 0.216 Test Loss: 4.510 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.1134350299835205
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.408 Vali Acc: 0.243 Test Loss: 4.408 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.2519004344940186
Epoch: 11, Steps: 10 | Train Loss: 0.174 Vali Loss: 4.373 Vali Acc: 0.311 Test Loss: 4.373 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.143940210342407
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.406 Vali Acc: 0.392 Test Loss: 1.406 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 4.1435112953186035
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.670 Vali Acc: 0.230 Test Loss: 1.670 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.47160005569458
Epoch: 3, Steps: 10 | Train Loss: 0.590 Vali Loss: 2.089 Vali Acc: 0.257 Test Loss: 2.089 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.570639133453369
Epoch: 4, Steps: 10 | Train Loss: 0.309 Vali Loss: 2.583 Vali Acc: 0.243 Test Loss: 2.583 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.426983118057251
Epoch: 5, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.253 Vali Acc: 0.230 Test Loss: 3.253 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.524012804031372
Epoch: 6, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.287 Vali Acc: 0.270 Test Loss: 3.287 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.78723669052124
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.726 Vali Acc: 0.311 Test Loss: 3.726 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.210357666015625
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.994 Vali Acc: 0.203 Test Loss: 3.994 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.690283298492432
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.552 Vali Acc: 0.297 Test Loss: 3.552 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.599363088607788
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.793 Vali Acc: 0.297 Test Loss: 3.793 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.791086435317993
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.041 Vali Acc: 0.297 Test Loss: 4.041 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.340008735656738
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.340 Vali Acc: 0.378 Test Loss: 1.340 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 4.157134532928467
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.983 Vali Acc: 0.203 Test Loss: 1.983 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.82815146446228
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.649 Vali Acc: 0.257 Test Loss: 1.649 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.361464262008667
Epoch: 4, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.987 Vali Acc: 0.257 Test Loss: 1.987 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.8103601932525635
Epoch: 5, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.889 Vali Acc: 0.351 Test Loss: 1.889 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.140794515609741
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 2.491 Vali Acc: 0.324 Test Loss: 2.491 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.827107191085815
Epoch: 7, Steps: 10 | Train Loss: 0.116 Vali Loss: 2.558 Vali Acc: 0.351 Test Loss: 2.558 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.981693983078003
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.672 Vali Acc: 0.284 Test Loss: 2.672 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.271909952163696
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.944 Vali Acc: 0.297 Test Loss: 2.944 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.513125419616699
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.973 Vali Acc: 0.338 Test Loss: 2.973 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.230751276016235
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.993 Vali Acc: 0.365 Test Loss: 2.993 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.429117441177368
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.410 Vali Acc: 0.338 Test Loss: 1.410 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 4.188358306884766
Epoch: 2, Steps: 10 | Train Loss: 1.483 Vali Loss: 2.168 Vali Acc: 0.243 Test Loss: 2.168 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.92479944229126
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.704 Vali Acc: 0.189 Test Loss: 1.704 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.683436155319214
Epoch: 4, Steps: 10 | Train Loss: 0.816 Vali Loss: 2.025 Vali Acc: 0.203 Test Loss: 2.025 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.503600597381592
Epoch: 5, Steps: 10 | Train Loss: 0.509 Vali Loss: 1.842 Vali Acc: 0.338 Test Loss: 1.842 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.785370588302612
Epoch: 6, Steps: 10 | Train Loss: 0.280 Vali Loss: 2.242 Vali Acc: 0.311 Test Loss: 2.242 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.066375255584717
Epoch: 7, Steps: 10 | Train Loss: 0.152 Vali Loss: 2.529 Vali Acc: 0.351 Test Loss: 2.529 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351326).  Saving model ...
Epoch: 8 cost time: 4.763948678970337
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.178 Vali Acc: 0.270 Test Loss: 3.178 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.477679967880249
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.454 Vali Acc: 0.338 Test Loss: 3.454 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.363558769226074
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.995 Vali Acc: 0.297 Test Loss: 3.995 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.615217208862305
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.171 Vali Acc: 0.338 Test Loss: 4.171 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.632339000701904
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.295 Vali Acc: 0.311 Test Loss: 4.295 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.098906517028809
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.468 Vali Acc: 0.230 Test Loss: 4.468 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8852944374084473
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.860 Vali Acc: 0.257 Test Loss: 5.860 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.396749496459961
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.805 Vali Acc: 0.297 Test Loss: 4.805 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.879350185394287
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.722 Vali Acc: 0.243 Test Loss: 5.722 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.661441802978516
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.096 Vali Acc: 0.257 Test Loss: 5.096 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 12131844
model size : 65.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.979375123977661
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.236 Vali Acc: 0.446 Test Loss: 1.236 Test Acc: 0.446
Validation loss decreased (inf --> -0.445934).  Saving model ...
Epoch: 2 cost time: 5.46339225769043
Epoch: 2, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.006 Vali Acc: 0.554 Test Loss: 1.006 Test Acc: 0.554
Validation loss decreased (-0.445934 --> -0.554044).  Saving model ...
Epoch: 3 cost time: 5.140647888183594
Epoch: 3, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.205 Vali Acc: 0.581 Test Loss: 1.205 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581069).  Saving model ...
Epoch: 4 cost time: 5.502068519592285
Epoch: 4, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.325 Vali Acc: 0.635 Test Loss: 1.325 Test Acc: 0.635
Validation loss decreased (-0.581069 --> -0.635122).  Saving model ...
Epoch: 5 cost time: 5.622316837310791
Epoch: 5, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.757 Vali Acc: 0.527 Test Loss: 1.757 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.708233833312988
Epoch: 6, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.724 Vali Acc: 0.608 Test Loss: 1.724 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.940377235412598
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 2.474 Vali Acc: 0.541 Test Loss: 2.474 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.0090718269348145
Epoch: 8, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.105 Vali Acc: 0.405 Test Loss: 4.105 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.723188161849976
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.582 Vali Acc: 0.514 Test Loss: 2.582 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.757486343383789
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 2.362 Vali Acc: 0.541 Test Loss: 2.362 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.909891128540039
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.530 Vali Acc: 0.554 Test Loss: 2.530 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.394771575927734
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.438 Vali Acc: 0.527 Test Loss: 3.438 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.703622579574585
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.065 Vali Acc: 0.595 Test Loss: 3.065 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.6382341384887695
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.870 Vali Acc: 0.527 Test Loss: 3.870 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.513231992721558
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.256 Vali Acc: 0.378 Test Loss: 1.256 Test Acc: 0.378
Validation loss decreased (inf --> -0.378366).  Saving model ...
Epoch: 2 cost time: 5.156371355056763
Epoch: 2, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.378366 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 5.058880805969238
Epoch: 3, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 4.792906761169434
Epoch: 4, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.498 Vali Acc: 0.554 Test Loss: 1.498 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554039).  Saving model ...
Epoch: 5 cost time: 4.796830415725708
Epoch: 5, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.918 Vali Acc: 0.554 Test Loss: 1.918 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.067384719848633
Epoch: 6, Steps: 10 | Train Loss: 0.065 Vali Loss: 2.091 Vali Acc: 0.514 Test Loss: 2.091 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.437927007675171
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.013 Vali Acc: 0.568 Test Loss: 2.013 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567547).  Saving model ...
Epoch: 8 cost time: 4.880323171615601
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.280 Vali Acc: 0.554 Test Loss: 2.280 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.471837997436523
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.647 Vali Acc: 0.473 Test Loss: 2.647 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.902002811431885
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 2.797 Vali Acc: 0.527 Test Loss: 2.797 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.750721454620361
Epoch: 11, Steps: 10 | Train Loss: 0.071 Vali Loss: 2.625 Vali Acc: 0.568 Test Loss: 2.625 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.877708911895752
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 2.718 Vali Acc: 0.500 Test Loss: 2.718 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.44970178604126
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.305 Vali Acc: 0.568 Test Loss: 2.305 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.645383596420288
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.460 Vali Acc: 0.514 Test Loss: 3.460 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.33147668838501
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.921 Vali Acc: 0.541 Test Loss: 2.921 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.926537990570068
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.285 Vali Acc: 0.581 Test Loss: 3.285 Test Acc: 0.581
Validation loss decreased (-0.567547 --> -0.581048).  Saving model ...
Epoch: 17 cost time: 5.8164894580841064
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.151 Vali Acc: 0.527 Test Loss: 4.151 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.6981165409088135
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.284 Vali Acc: 0.500 Test Loss: 4.284 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.975486516952515
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.638 Vali Acc: 0.608 Test Loss: 4.638 Test Acc: 0.608
Validation loss decreased (-0.581048 --> -0.608062).  Saving model ...
Epoch: 20 cost time: 6.008995056152344
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.146 Vali Acc: 0.527 Test Loss: 4.146 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.8207619190216064
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.417 Vali Acc: 0.568 Test Loss: 4.417 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.467256546020508
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.924 Vali Acc: 0.554 Test Loss: 3.924 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.332573652267456
Epoch: 23, Steps: 10 | Train Loss: 0.076 Vali Loss: 5.625 Vali Acc: 0.527 Test Loss: 5.625 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.011135816574097
Epoch: 24, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.764 Vali Acc: 0.500 Test Loss: 3.764 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.831380844116211
Epoch: 25, Steps: 10 | Train Loss: 0.081 Vali Loss: 6.473 Vali Acc: 0.473 Test Loss: 6.473 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.361123323440552
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 5.556 Vali Acc: 0.554 Test Loss: 5.556 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.650011777877808
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.777 Vali Acc: 0.514 Test Loss: 5.777 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.781658172607422
Epoch: 28, Steps: 10 | Train Loss: 0.224 Vali Loss: 5.649 Vali Acc: 0.568 Test Loss: 5.649 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.993490695953369
Epoch: 29, Steps: 10 | Train Loss: 0.168 Vali Loss: 10.240 Vali Acc: 0.473 Test Loss: 10.240 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.8971803188323975
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.426 Vali Acc: 0.284 Test Loss: 1.426 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 4.599279880523682
Epoch: 2, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.709 Vali Acc: 0.351 Test Loss: 1.709 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351334).  Saving model ...
Epoch: 3 cost time: 4.890666723251343
Epoch: 3, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.905 Vali Acc: 0.378 Test Loss: 1.905 Test Acc: 0.378
Validation loss decreased (-0.351334 --> -0.378359).  Saving model ...
Epoch: 4 cost time: 5.230504274368286
Epoch: 4, Steps: 10 | Train Loss: 0.174 Vali Loss: 2.459 Vali Acc: 0.378 Test Loss: 2.459 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.241583585739136
Epoch: 5, Steps: 10 | Train Loss: 0.059 Vali Loss: 2.924 Vali Acc: 0.338 Test Loss: 2.924 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.993526220321655
Epoch: 6, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.764 Vali Acc: 0.311 Test Loss: 3.764 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.507415294647217
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.295 Vali Acc: 0.338 Test Loss: 4.295 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.414558172225952
Epoch: 8, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.396 Vali Acc: 0.378 Test Loss: 4.396 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.049063205718994
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.198 Vali Acc: 0.338 Test Loss: 4.198 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.3465611934661865
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.102 Vali Acc: 0.378 Test Loss: 6.102 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.0311455726623535
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.569 Vali Acc: 0.473 Test Loss: 4.569 Test Acc: 0.473
Validation loss decreased (-0.378359 --> -0.472927).  Saving model ...
Epoch: 12 cost time: 5.217926502227783
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 5.492 Vali Acc: 0.378 Test Loss: 5.492 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.8343892097473145
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 6.796 Vali Acc: 0.365 Test Loss: 6.796 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.684017658233643
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.335 Vali Acc: 0.392 Test Loss: 5.335 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.8076605796813965
Epoch: 15, Steps: 10 | Train Loss: 0.092 Vali Loss: 5.555 Vali Acc: 0.405 Test Loss: 5.555 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.641721487045288
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.295 Vali Acc: 0.432 Test Loss: 6.295 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.118774175643921
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.689 Vali Acc: 0.365 Test Loss: 5.689 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.976210355758667
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 6.699 Vali Acc: 0.405 Test Loss: 6.699 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.354675531387329
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.811 Vali Acc: 0.365 Test Loss: 6.811 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.651804685592651
Epoch: 20, Steps: 10 | Train Loss: 0.121 Vali Loss: 8.925 Vali Acc: 0.365 Test Loss: 8.925 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.974926471710205
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 8.107 Vali Acc: 0.378 Test Loss: 8.107 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.9561498165130615
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.465 Vali Acc: 0.270 Test Loss: 1.465 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.797954320907593
Epoch: 2, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.574 Vali Acc: 0.311 Test Loss: 1.574 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310795).  Saving model ...
Epoch: 3 cost time: 4.148144006729126
Epoch: 3, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.823 Vali Acc: 0.338 Test Loss: 1.823 Test Acc: 0.338
Validation loss decreased (-0.310795 --> -0.337820).  Saving model ...
Epoch: 4 cost time: 4.411328554153442
Epoch: 4, Steps: 10 | Train Loss: 0.114 Vali Loss: 2.245 Vali Acc: 0.378 Test Loss: 2.245 Test Acc: 0.378
Validation loss decreased (-0.337820 --> -0.378356).  Saving model ...
Epoch: 5 cost time: 4.811737775802612
Epoch: 5, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.317 Vali Acc: 0.257 Test Loss: 3.317 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.228734254837036
Epoch: 6, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.073 Vali Acc: 0.311 Test Loss: 3.073 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.653975963592529
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.055 Vali Acc: 0.284 Test Loss: 4.055 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.838144302368164
Epoch: 8, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.172 Vali Acc: 0.243 Test Loss: 4.172 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.38793683052063
Epoch: 9, Steps: 10 | Train Loss: 0.092 Vali Loss: 5.177 Vali Acc: 0.378 Test Loss: 5.177 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.175217151641846
Epoch: 10, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.681 Vali Acc: 0.365 Test Loss: 4.681 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.2355735301971436
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.242 Vali Acc: 0.270 Test Loss: 4.242 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.633523464202881
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.823 Vali Acc: 0.365 Test Loss: 4.823 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.067803144454956
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.686 Vali Acc: 0.311 Test Loss: 5.686 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.569103240966797
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.620 Vali Acc: 0.392 Test Loss: 5.620 Test Acc: 0.392
Validation loss decreased (-0.378356 --> -0.391836).  Saving model ...
Epoch: 15 cost time: 5.857562780380249
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.090 Vali Acc: 0.365 Test Loss: 5.090 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.107257604598999
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.913 Vali Acc: 0.284 Test Loss: 5.913 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.521191835403442
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 5.958 Vali Acc: 0.257 Test Loss: 5.958 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.448692798614502
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.839 Vali Acc: 0.284 Test Loss: 6.839 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.150844573974609
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 7.826 Vali Acc: 0.311 Test Loss: 7.826 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.362935543060303
Epoch: 20, Steps: 10 | Train Loss: 0.185 Vali Loss: 6.855 Vali Acc: 0.378 Test Loss: 6.855 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.0261383056640625
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 8.486 Vali Acc: 0.365 Test Loss: 8.486 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.833385705947876
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 7.873 Vali Acc: 0.419 Test Loss: 7.873 Test Acc: 0.419
Validation loss decreased (-0.391836 --> -0.418840).  Saving model ...
Epoch: 23 cost time: 5.476650238037109
Epoch: 23, Steps: 10 | Train Loss: 0.087 Vali Loss: 8.421 Vali Acc: 0.365 Test Loss: 8.421 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.3152337074279785
Epoch: 24, Steps: 10 | Train Loss: 0.420 Vali Loss: 8.526 Vali Acc: 0.392 Test Loss: 8.526 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.069148063659668
Epoch: 25, Steps: 10 | Train Loss: 0.298 Vali Loss: 12.910 Vali Acc: 0.284 Test Loss: 12.910 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.1401917934417725
Epoch: 26, Steps: 10 | Train Loss: 0.056 Vali Loss: 11.272 Vali Acc: 0.351 Test Loss: 11.272 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.958587169647217
Epoch: 27, Steps: 10 | Train Loss: 0.164 Vali Loss: 11.290 Vali Acc: 0.270 Test Loss: 11.290 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.095217943191528
Epoch: 28, Steps: 10 | Train Loss: 0.101 Vali Loss: 12.864 Vali Acc: 0.257 Test Loss: 12.864 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.062923192977905
Epoch: 29, Steps: 10 | Train Loss: 0.113 Vali Loss: 12.366 Vali Acc: 0.324 Test Loss: 12.366 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.865798711776733
Epoch: 30, Steps: 10 | Train Loss: 0.096 Vali Loss: 14.029 Vali Acc: 0.311 Test Loss: 14.029 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.9008378982543945
Epoch: 31, Steps: 10 | Train Loss: 0.069 Vali Loss: 12.424 Vali Acc: 0.378 Test Loss: 12.424 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.388154745101929
Epoch: 32, Steps: 10 | Train Loss: 0.052 Vali Loss: 15.491 Vali Acc: 0.297 Test Loss: 15.491 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.311535596847534
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.487 Vali Acc: 0.324 Test Loss: 1.487 Test Acc: 0.324
Validation loss decreased (inf --> -0.324309).  Saving model ...
Epoch: 2 cost time: 4.065459728240967
Epoch: 2, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.705 Vali Acc: 0.324 Test Loss: 1.705 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.92706036567688
Epoch: 3, Steps: 10 | Train Loss: 0.554 Vali Loss: 2.250 Vali Acc: 0.230 Test Loss: 2.250 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.037356853485107
Epoch: 4, Steps: 10 | Train Loss: 0.346 Vali Loss: 2.706 Vali Acc: 0.270 Test Loss: 2.706 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.087631940841675
Epoch: 5, Steps: 10 | Train Loss: 0.189 Vali Loss: 2.927 Vali Acc: 0.270 Test Loss: 2.927 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.8802173137664795
Epoch: 6, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.365 Vali Acc: 0.311 Test Loss: 3.365 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.8671393394470215
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.275 Vali Acc: 0.297 Test Loss: 4.275 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.570693731307983
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.572 Vali Acc: 0.257 Test Loss: 4.572 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.513631582260132
Epoch: 9, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.759 Vali Acc: 0.365 Test Loss: 4.759 Test Acc: 0.365
Validation loss decreased (-0.324309 --> -0.364817).  Saving model ...
Epoch: 10 cost time: 5.00471830368042
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.841 Vali Acc: 0.311 Test Loss: 3.841 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.9074554443359375
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.737 Vali Acc: 0.324 Test Loss: 4.737 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.237234354019165
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.707 Vali Acc: 0.405 Test Loss: 5.707 Test Acc: 0.405
Validation loss decreased (-0.364817 --> -0.405348).  Saving model ...
Epoch: 13 cost time: 4.446941375732422
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 7.898 Vali Acc: 0.257 Test Loss: 7.898 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.365060806274414
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 7.732 Vali Acc: 0.324 Test Loss: 7.732 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.274385213851929
Epoch: 15, Steps: 10 | Train Loss: 0.253 Vali Loss: 7.595 Vali Acc: 0.311 Test Loss: 7.595 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.411835193634033
Epoch: 16, Steps: 10 | Train Loss: 0.156 Vali Loss: 7.205 Vali Acc: 0.324 Test Loss: 7.205 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.54034948348999
Epoch: 17, Steps: 10 | Train Loss: 0.136 Vali Loss: 9.102 Vali Acc: 0.230 Test Loss: 9.102 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.711727619171143
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 8.246 Vali Acc: 0.243 Test Loss: 8.246 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.3940465450286865
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 8.902 Vali Acc: 0.230 Test Loss: 8.902 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.442197561264038
Epoch: 20, Steps: 10 | Train Loss: 0.102 Vali Loss: 7.785 Vali Acc: 0.311 Test Loss: 7.785 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.106240749359131
Epoch: 21, Steps: 10 | Train Loss: 0.095 Vali Loss: 8.006 Vali Acc: 0.216 Test Loss: 8.006 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.5521910190582275
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.482 Vali Acc: 0.284 Test Loss: 7.482 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.305789470672607
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.546 Vali Acc: 0.284 Test Loss: 1.546 Test Acc: 0.284
Validation loss decreased (inf --> -0.283768).  Saving model ...
Epoch: 2 cost time: 5.193342447280884
Epoch: 2, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.692 Vali Acc: 0.311 Test Loss: 1.692 Test Acc: 0.311
Validation loss decreased (-0.283768 --> -0.310794).  Saving model ...
Epoch: 3 cost time: 5.139042854309082
Epoch: 3, Steps: 10 | Train Loss: 0.428 Vali Loss: 2.049 Vali Acc: 0.311 Test Loss: 2.049 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.282994031906128
Epoch: 4, Steps: 10 | Train Loss: 0.133 Vali Loss: 2.579 Vali Acc: 0.392 Test Loss: 2.579 Test Acc: 0.392
Validation loss decreased (-0.310794 --> -0.391866).  Saving model ...
Epoch: 5 cost time: 4.724895000457764
Epoch: 5, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.425 Vali Acc: 0.351 Test Loss: 3.425 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.919687986373901
Epoch: 6, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.046 Vali Acc: 0.216 Test Loss: 4.046 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5165441036224365
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.949 Vali Acc: 0.135 Test Loss: 4.949 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.120058536529541
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.563 Vali Acc: 0.284 Test Loss: 4.563 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.124073028564453
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.599 Vali Acc: 0.338 Test Loss: 4.599 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.104209899902344
Epoch: 10, Steps: 10 | Train Loss: 0.108 Vali Loss: 5.984 Vali Acc: 0.176 Test Loss: 5.984 Test Acc: 0.176
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.068202257156372
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 5.574 Vali Acc: 0.297 Test Loss: 5.574 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.486273288726807
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.769 Vali Acc: 0.243 Test Loss: 5.769 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.009405612945557
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.831 Vali Acc: 0.230 Test Loss: 5.831 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.955167770385742
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.383 Vali Acc: 0.311 Test Loss: 5.383 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.445049285888672
Epoch: 1, Steps: 10 | Train Loss: 1.540 Vali Loss: 1.589 Vali Acc: 0.270 Test Loss: 1.589 Test Acc: 0.270
Validation loss decreased (inf --> -0.270254).  Saving model ...
Epoch: 2 cost time: 4.821151971817017
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 2.240 Vali Acc: 0.270 Test Loss: 2.240 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.547513723373413
Epoch: 3, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.973 Vali Acc: 0.257 Test Loss: 1.973 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.706944465637207
Epoch: 4, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.858 Vali Acc: 0.324 Test Loss: 1.858 Test Acc: 0.324
Validation loss decreased (-0.270254 --> -0.324306).  Saving model ...
Epoch: 5 cost time: 4.75360894203186
Epoch: 5, Steps: 10 | Train Loss: 0.203 Vali Loss: 2.621 Vali Acc: 0.243 Test Loss: 2.621 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.188023090362549
Epoch: 6, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.054 Vali Acc: 0.324 Test Loss: 4.054 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.494002819061279
Epoch: 7, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.612 Vali Acc: 0.311 Test Loss: 3.612 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.621264696121216
Epoch: 8, Steps: 10 | Train Loss: 0.142 Vali Loss: 5.043 Vali Acc: 0.243 Test Loss: 5.043 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.585664749145508
Epoch: 9, Steps: 10 | Train Loss: 0.217 Vali Loss: 4.548 Vali Acc: 0.378 Test Loss: 4.548 Test Acc: 0.378
Validation loss decreased (-0.324306 --> -0.378333).  Saving model ...
Epoch: 10 cost time: 4.495509624481201
Epoch: 10, Steps: 10 | Train Loss: 0.215 Vali Loss: 5.280 Vali Acc: 0.297 Test Loss: 5.280 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.201267957687378
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 5.682 Vali Acc: 0.284 Test Loss: 5.682 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.790053367614746
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 6.830 Vali Acc: 0.243 Test Loss: 6.830 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.933242559432983
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 5.429 Vali Acc: 0.270 Test Loss: 5.429 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.988493919372559
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 6.465 Vali Acc: 0.311 Test Loss: 6.465 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.260071516036987
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.725 Vali Acc: 0.243 Test Loss: 6.725 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.683875799179077
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 5.680 Vali Acc: 0.230 Test Loss: 5.680 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.579067230224609
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 6.443 Vali Acc: 0.257 Test Loss: 6.443 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.502655029296875
Epoch: 18, Steps: 10 | Train Loss: 0.067 Vali Loss: 9.613 Vali Acc: 0.230 Test Loss: 9.613 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.928739070892334
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 7.006 Vali Acc: 0.338 Test Loss: 7.006 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.367983341217041
Epoch: 1, Steps: 10 | Train Loss: 1.531 Vali Loss: 1.547 Vali Acc: 0.311 Test Loss: 1.547 Test Acc: 0.311
Validation loss decreased (inf --> -0.310795).  Saving model ...
Epoch: 2 cost time: 5.202882289886475
Epoch: 2, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.726 Vali Acc: 0.311 Test Loss: 1.726 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.122438669204712
Epoch: 3, Steps: 10 | Train Loss: 0.548 Vali Loss: 2.165 Vali Acc: 0.230 Test Loss: 2.165 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.599142074584961
Epoch: 4, Steps: 10 | Train Loss: 0.217 Vali Loss: 2.227 Vali Acc: 0.243 Test Loss: 2.227 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.1600501537323
Epoch: 5, Steps: 10 | Train Loss: 0.083 Vali Loss: 2.673 Vali Acc: 0.216 Test Loss: 2.673 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.978149652481079
Epoch: 6, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.731 Vali Acc: 0.311 Test Loss: 2.731 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.94355845451355
Epoch: 7, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.746 Vali Acc: 0.270 Test Loss: 2.746 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.50891375541687
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.045 Vali Acc: 0.284 Test Loss: 3.045 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.200331211090088
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.212 Vali Acc: 0.338 Test Loss: 3.212 Test Acc: 0.338
Validation loss decreased (-0.310795 --> -0.337806).  Saving model ...
Epoch: 10 cost time: 4.748893976211548
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.040 Vali Acc: 0.284 Test Loss: 3.040 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.213478326797485
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.087 Vali Acc: 0.297 Test Loss: 3.087 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.610767602920532
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.097 Vali Acc: 0.270 Test Loss: 3.097 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.073591470718384
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.077 Vali Acc: 0.284 Test Loss: 3.077 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.560626029968262
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.093 Vali Acc: 0.270 Test Loss: 3.093 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.7207114696502686
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.115 Vali Acc: 0.257 Test Loss: 3.115 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.800079107284546
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.124 Vali Acc: 0.257 Test Loss: 3.124 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.3345067501068115
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.114 Vali Acc: 0.257 Test Loss: 3.114 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.951713562011719
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.094 Vali Acc: 0.270 Test Loss: 3.094 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.136170864105225
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.101 Vali Acc: 0.270 Test Loss: 3.101 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.654303789138794
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 4.2615275382995605
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.557 Vali Acc: 0.311 Test Loss: 1.557 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310795).  Saving model ...
Epoch: 3 cost time: 4.837169408798218
Epoch: 3, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.546 Vali Acc: 0.284 Test Loss: 1.546 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.619833946228027
Epoch: 4, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.622 Vali Acc: 0.351 Test Loss: 1.622 Test Acc: 0.351
Validation loss decreased (-0.310795 --> -0.351335).  Saving model ...
Epoch: 5 cost time: 4.565316677093506
Epoch: 5, Steps: 10 | Train Loss: 0.340 Vali Loss: 2.173 Vali Acc: 0.297 Test Loss: 2.173 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.83644437789917
Epoch: 6, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.230 Vali Acc: 0.230 Test Loss: 3.230 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.2577269077301025
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 2.766 Vali Acc: 0.297 Test Loss: 2.766 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.651719808578491
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.634 Vali Acc: 0.270 Test Loss: 3.634 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.695411682128906
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.565 Vali Acc: 0.270 Test Loss: 3.565 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.531243324279785
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.355 Vali Acc: 0.311 Test Loss: 3.355 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.8854968547821045
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.592 Vali Acc: 0.338 Test Loss: 3.592 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.953254461288452
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.125 Vali Acc: 0.338 Test Loss: 4.125 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.676266193389893
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.311 Vali Acc: 0.351 Test Loss: 4.311 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.961454629898071
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.153 Vali Acc: 0.243 Test Loss: 4.153 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.395596742630005
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 3.7849817276000977
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.722 Vali Acc: 0.311 Test Loss: 1.722 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310794).  Saving model ...
Epoch: 3 cost time: 4.3982954025268555
Epoch: 3, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.815 Vali Acc: 0.230 Test Loss: 1.815 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.740930795669556
Epoch: 4, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.741 Vali Acc: 0.392 Test Loss: 1.741 Test Acc: 0.392
Validation loss decreased (-0.310794 --> -0.391874).  Saving model ...
Epoch: 5 cost time: 5.54275918006897
Epoch: 5, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.968 Vali Acc: 0.297 Test Loss: 1.968 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.527835369110107
Epoch: 6, Steps: 10 | Train Loss: 0.227 Vali Loss: 2.457 Vali Acc: 0.243 Test Loss: 2.457 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.953229904174805
Epoch: 7, Steps: 10 | Train Loss: 0.106 Vali Loss: 2.559 Vali Acc: 0.270 Test Loss: 2.559 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.813784122467041
Epoch: 8, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.565 Vali Acc: 0.257 Test Loss: 3.565 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.405856609344482
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.329 Vali Acc: 0.311 Test Loss: 3.329 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.9973368644714355
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.427 Vali Acc: 0.351 Test Loss: 3.427 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.8102707862854
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.631 Vali Acc: 0.311 Test Loss: 3.631 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.41402006149292
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.938 Vali Acc: 0.270 Test Loss: 3.938 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.332151889801025
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.654 Vali Acc: 0.270 Test Loss: 4.654 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.820117473602295
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.314 Vali Acc: 0.311 Test Loss: 4.314 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 11738628
model size : 64.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.8907248973846436
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.286 Vali Acc: 0.338 Test Loss: 1.286 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 4.17351222038269
Epoch: 2, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
Validation loss decreased (-0.337825 --> -0.567557).  Saving model ...
Epoch: 3 cost time: 4.025306940078735
Epoch: 3, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.399399518966675
Epoch: 4, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.887 Vali Acc: 0.622 Test Loss: 0.887 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621613).  Saving model ...
Epoch: 5 cost time: 4.169249773025513
Epoch: 5, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.813 Vali Acc: 0.649 Test Loss: 0.813 Test Acc: 0.649
Validation loss decreased (-0.621613 --> -0.648641).  Saving model ...
Epoch: 6 cost time: 3.909034252166748
Epoch: 6, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.008 Vali Acc: 0.689 Test Loss: 1.008 Test Acc: 0.689
Validation loss decreased (-0.648641 --> -0.689179).  Saving model ...
Epoch: 7 cost time: 3.81083345413208
Epoch: 7, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.997 Vali Acc: 0.689 Test Loss: 0.997 Test Acc: 0.689
Validation loss decreased (-0.689179 --> -0.689179).  Saving model ...
Epoch: 8 cost time: 3.7423741817474365
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.401846885681152
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.662 Test Loss: 0.945 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9434328079223633
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.662 Test Loss: 0.980 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.85038161277771
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.662 Test Loss: 0.985 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9682369232177734
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.662 Test Loss: 0.976 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.215816020965576
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.662 Test Loss: 0.971 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.283328056335449
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.676 Test Loss: 0.969 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.8249170780181885
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.662 Test Loss: 0.974 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.680976152420044
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.676 Test Loss: 0.983 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.464966535568237
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.676 Test Loss: 0.985 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.4320902824401855
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.290 Vali Acc: 0.365 Test Loss: 1.290 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 4.322491407394409
Epoch: 2, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.112 Vali Acc: 0.486 Test Loss: 1.112 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 5.074550628662109
Epoch: 3, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 4.980137348175049
Epoch: 4, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.580652952194214
Epoch: 5, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 5.237008333206177
Epoch: 6, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.211 Vali Acc: 0.662 Test Loss: 1.211 Test Acc: 0.662
Validation loss decreased (-0.594584 --> -0.662150).  Saving model ...
Epoch: 7 cost time: 5.306097030639648
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.198 Vali Acc: 0.635 Test Loss: 1.198 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.452006816864014
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.098 Vali Acc: 0.649 Test Loss: 1.098 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.042703866958618
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.125 Vali Acc: 0.635 Test Loss: 1.125 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.379427909851074
Epoch: 10, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.622 Test Loss: 1.160 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.33613133430481
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.649 Test Loss: 1.177 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.219184160232544
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.649 Test Loss: 1.170 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.423511981964111
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.159 Vali Acc: 0.622 Test Loss: 1.159 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.02234148979187
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.635 Test Loss: 1.153 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9764482975006104
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.635 Test Loss: 1.160 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.538262367248535
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.622 Test Loss: 1.168 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.6484410762786865
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.376 Vali Acc: 0.270 Test Loss: 1.376 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 3.9659228324890137
Epoch: 2, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.468 Vali Acc: 0.338 Test Loss: 1.468 Test Acc: 0.338
Validation loss decreased (-0.270257 --> -0.337823).  Saving model ...
Epoch: 3 cost time: 3.8463852405548096
Epoch: 3, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.761 Vali Acc: 0.351 Test Loss: 1.761 Test Acc: 0.351
Validation loss decreased (-0.337823 --> -0.351334).  Saving model ...
Epoch: 4 cost time: 3.994088649749756
Epoch: 4, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.799 Vali Acc: 0.378 Test Loss: 1.799 Test Acc: 0.378
Validation loss decreased (-0.351334 --> -0.378360).  Saving model ...
Epoch: 5 cost time: 3.917811155319214
Epoch: 5, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.980 Vali Acc: 0.432 Test Loss: 1.980 Test Acc: 0.432
Validation loss decreased (-0.378360 --> -0.432413).  Saving model ...
Epoch: 6 cost time: 3.8766093254089355
Epoch: 6, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.166 Vali Acc: 0.392 Test Loss: 2.166 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.850088357925415
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.241 Vali Acc: 0.419 Test Loss: 2.241 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.074249982833862
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.355 Vali Acc: 0.405 Test Loss: 2.355 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.085971117019653
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.475 Vali Acc: 0.419 Test Loss: 2.475 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7220284938812256
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.443 Vali Acc: 0.405 Test Loss: 2.443 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9120829105377197
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.436 Vali Acc: 0.419 Test Loss: 2.436 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.07744288444519
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.432 Test Loss: 2.463 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.87231707572937
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.479 Vali Acc: 0.432 Test Loss: 2.479 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.162635087966919
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.481 Vali Acc: 0.432 Test Loss: 2.481 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.8768248558044434
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.482 Vali Acc: 0.446 Test Loss: 2.482 Test Acc: 0.446
Validation loss decreased (-0.432413 --> -0.445921).  Saving model ...
Epoch: 16 cost time: 3.8523881435394287
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.493 Vali Acc: 0.446 Test Loss: 2.493 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.08915638923645
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.503 Vali Acc: 0.432 Test Loss: 2.503 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9447150230407715
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.517 Vali Acc: 0.432 Test Loss: 2.517 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.8695931434631348
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.432 Test Loss: 2.530 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6666574478149414
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.537 Vali Acc: 0.432 Test Loss: 2.537 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.79725980758667
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.548 Vali Acc: 0.446 Test Loss: 2.548 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6404879093170166
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.553 Vali Acc: 0.446 Test Loss: 2.553 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6844937801361084
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.560 Vali Acc: 0.432 Test Loss: 2.560 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.53462815284729
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.571 Vali Acc: 0.446 Test Loss: 2.571 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.534702777862549
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.581 Vali Acc: 0.432 Test Loss: 2.581 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.321901798248291
Epoch: 1, Steps: 10 | Train Loss: 1.536 Vali Loss: 1.409 Vali Acc: 0.257 Test Loss: 1.409 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.7085750102996826
Epoch: 2, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.468 Vali Acc: 0.257 Test Loss: 1.468 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.662639856338501
Epoch: 3, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.834 Vali Acc: 0.257 Test Loss: 1.834 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.571664333343506
Epoch: 4, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.785 Vali Acc: 0.297 Test Loss: 1.785 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297279).  Saving model ...
Epoch: 5 cost time: 3.9564409255981445
Epoch: 5, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.948 Vali Acc: 0.351 Test Loss: 1.948 Test Acc: 0.351
Validation loss decreased (-0.297279 --> -0.351332).  Saving model ...
Epoch: 6 cost time: 3.449315071105957
Epoch: 6, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.253 Vali Acc: 0.324 Test Loss: 2.253 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9844439029693604
Epoch: 7, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.245 Vali Acc: 0.378 Test Loss: 2.245 Test Acc: 0.378
Validation loss decreased (-0.351332 --> -0.378356).  Saving model ...
Epoch: 8 cost time: 3.540400981903076
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.461 Vali Acc: 0.392 Test Loss: 2.461 Test Acc: 0.392
Validation loss decreased (-0.378356 --> -0.391867).  Saving model ...
Epoch: 9 cost time: 3.6740174293518066
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.478 Vali Acc: 0.365 Test Loss: 2.478 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.773982524871826
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.458 Vali Acc: 0.324 Test Loss: 2.458 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7860586643218994
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.475 Vali Acc: 0.365 Test Loss: 2.475 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.015768766403198
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.519 Vali Acc: 0.351 Test Loss: 2.519 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9738640785217285
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.526 Vali Acc: 0.365 Test Loss: 2.526 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.794670581817627
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.523 Vali Acc: 0.365 Test Loss: 2.523 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.9452056884765625
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.531 Vali Acc: 0.378 Test Loss: 2.531 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.471785545349121
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.539 Vali Acc: 0.365 Test Loss: 2.539 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.446009635925293
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.378 Test Loss: 2.549 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.247434139251709
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.561 Vali Acc: 0.378 Test Loss: 2.561 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.157253980636597
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.407192945480347
Epoch: 2, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.607 Vali Acc: 0.257 Test Loss: 1.607 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256741).  Saving model ...
Epoch: 3 cost time: 3.9569509029388428
Epoch: 3, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.856 Vali Acc: 0.230 Test Loss: 1.856 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.203406095504761
Epoch: 4, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.927 Vali Acc: 0.230 Test Loss: 1.927 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.175639867782593
Epoch: 5, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.181 Vali Acc: 0.351 Test Loss: 2.181 Test Acc: 0.351
Validation loss decreased (-0.256741 --> -0.351330).  Saving model ...
Epoch: 6 cost time: 4.459378480911255
Epoch: 6, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.415 Vali Acc: 0.284 Test Loss: 2.415 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.196772336959839
Epoch: 7, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.676 Vali Acc: 0.270 Test Loss: 2.676 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.400856256484985
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.229 Vali Acc: 0.284 Test Loss: 3.229 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.301638841629028
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.869 Vali Acc: 0.365 Test Loss: 2.869 Test Acc: 0.365
Validation loss decreased (-0.351330 --> -0.364836).  Saving model ...
Epoch: 10 cost time: 4.299256086349487
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.905 Vali Acc: 0.311 Test Loss: 2.905 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.367941617965698
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.990 Vali Acc: 0.311 Test Loss: 2.990 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.107815742492676
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.896 Vali Acc: 0.324 Test Loss: 2.896 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.6524858474731445
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.991 Vali Acc: 0.338 Test Loss: 2.991 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.385299444198608
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.927 Vali Acc: 0.365 Test Loss: 2.927 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.586387634277344
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.892 Vali Acc: 0.338 Test Loss: 2.892 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.194483518600464
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.935 Vali Acc: 0.338 Test Loss: 2.935 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.128567218780518
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.948 Vali Acc: 0.351 Test Loss: 2.948 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.129497289657593
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.955 Vali Acc: 0.351 Test Loss: 2.955 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.290870904922485
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.960 Vali Acc: 0.365 Test Loss: 2.960 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.9377219676971436
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.426 Vali Acc: 0.243 Test Loss: 1.426 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.329922676086426
Epoch: 2, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.531 Vali Acc: 0.257 Test Loss: 1.531 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256741).  Saving model ...
Epoch: 3 cost time: 4.304455518722534
Epoch: 3, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.927 Vali Acc: 0.270 Test Loss: 1.927 Test Acc: 0.270
Validation loss decreased (-0.256741 --> -0.270251).  Saving model ...
Epoch: 4 cost time: 3.9990298748016357
Epoch: 4, Steps: 10 | Train Loss: 0.228 Vali Loss: 2.063 Vali Acc: 0.203 Test Loss: 2.063 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.051822662353516
Epoch: 5, Steps: 10 | Train Loss: 0.089 Vali Loss: 2.212 Vali Acc: 0.270 Test Loss: 2.212 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.118860244750977
Epoch: 6, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.381 Vali Acc: 0.257 Test Loss: 2.381 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.3491809368133545
Epoch: 7, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.739 Vali Acc: 0.297 Test Loss: 2.739 Test Acc: 0.297
Validation loss decreased (-0.270251 --> -0.297270).  Saving model ...
Epoch: 8 cost time: 4.496964454650879
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.770 Vali Acc: 0.297 Test Loss: 2.770 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.621133804321289
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.957 Vali Acc: 0.324 Test Loss: 2.957 Test Acc: 0.324
Validation loss decreased (-0.297270 --> -0.324295).  Saving model ...
Epoch: 10 cost time: 4.395489692687988
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.137 Vali Acc: 0.176 Test Loss: 3.137 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.590599775314331
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.019 Vali Acc: 0.270 Test Loss: 3.019 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.271947860717773
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.052 Vali Acc: 0.297 Test Loss: 3.052 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.277413845062256
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.270 Test Loss: 3.032 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.255995512008667
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.019 Vali Acc: 0.270 Test Loss: 3.019 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.612433433532715
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.016 Vali Acc: 0.270 Test Loss: 3.016 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.562179088592529
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.284 Test Loss: 3.032 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.42472243309021
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.044 Vali Acc: 0.284 Test Loss: 3.044 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.629917621612549
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.057 Vali Acc: 0.270 Test Loss: 3.057 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.337109804153442
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.063 Vali Acc: 0.270 Test Loss: 3.063 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.33720064163208
Epoch: 1, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.539 Vali Acc: 0.189 Test Loss: 1.539 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 4.364136695861816
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.546 Vali Acc: 0.189 Test Loss: 1.546 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.316690444946289
Epoch: 3, Steps: 10 | Train Loss: 0.837 Vali Loss: 2.164 Vali Acc: 0.230 Test Loss: 2.164 Test Acc: 0.230
Validation loss decreased (-0.189174 --> -0.229708).  Saving model ...
Epoch: 4 cost time: 4.294694900512695
Epoch: 4, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.768 Vali Acc: 0.257 Test Loss: 1.768 Test Acc: 0.257
Validation loss decreased (-0.229708 --> -0.256739).  Saving model ...
Epoch: 5 cost time: 4.394480466842651
Epoch: 5, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.999 Vali Acc: 0.216 Test Loss: 1.999 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.4952287673950195
Epoch: 6, Steps: 10 | Train Loss: 0.108 Vali Loss: 2.223 Vali Acc: 0.216 Test Loss: 2.223 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.120750665664673
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.873 Vali Acc: 0.270 Test Loss: 2.873 Test Acc: 0.270
Validation loss decreased (-0.256739 --> -0.270242).  Saving model ...
Epoch: 8 cost time: 4.409513235092163
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 2.796 Vali Acc: 0.216 Test Loss: 2.796 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.792351722717285
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.107 Vali Acc: 0.230 Test Loss: 3.107 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.317031145095825
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.931 Vali Acc: 0.257 Test Loss: 2.931 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.978323698043823
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.166 Vali Acc: 0.243 Test Loss: 3.166 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.560160398483276
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.061 Vali Acc: 0.257 Test Loss: 3.061 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.076854228973389
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.017 Vali Acc: 0.216 Test Loss: 3.017 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.318902492523193
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.135 Vali Acc: 0.243 Test Loss: 3.135 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.905335426330566
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.143 Vali Acc: 0.203 Test Loss: 3.143 Test Acc: 0.203
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.746144771575928
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.071 Vali Acc: 0.189 Test Loss: 3.071 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.0836756229400635
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.032 Vali Acc: 0.203 Test Loss: 3.032 Test Acc: 0.203
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.2702702702702703
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.59301495552063
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.487 Vali Acc: 0.203 Test Loss: 1.487 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 4.3370888233184814
Epoch: 2, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.513 Vali Acc: 0.216 Test Loss: 1.513 Test Acc: 0.216
Validation loss decreased (-0.202688 --> -0.216201).  Saving model ...
Epoch: 3 cost time: 4.647449016571045
Epoch: 3, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.863 Vali Acc: 0.189 Test Loss: 1.863 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.3759167194366455
Epoch: 4, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.812 Vali Acc: 0.230 Test Loss: 1.812 Test Acc: 0.230
Validation loss decreased (-0.216201 --> -0.229712).  Saving model ...
Epoch: 5 cost time: 4.640008449554443
Epoch: 5, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.924 Vali Acc: 0.230 Test Loss: 1.924 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.34093976020813
Epoch: 6, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.389 Vali Acc: 0.257 Test Loss: 2.389 Test Acc: 0.257
Validation loss decreased (-0.229712 --> -0.256733).  Saving model ...
Epoch: 7 cost time: 4.627593755722046
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.274 Vali Acc: 0.270 Test Loss: 2.274 Test Acc: 0.270
Validation loss decreased (-0.256733 --> -0.270248).  Saving model ...
Epoch: 8 cost time: 4.456398248672485
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.423 Vali Acc: 0.270 Test Loss: 2.423 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.769873857498169
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.488 Vali Acc: 0.162 Test Loss: 2.488 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.406259536743164
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.454 Vali Acc: 0.284 Test Loss: 2.454 Test Acc: 0.284
Validation loss decreased (-0.270248 --> -0.283759).  Saving model ...
Epoch: 11 cost time: 4.5171098709106445
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.466 Vali Acc: 0.297 Test Loss: 2.466 Test Acc: 0.297
Validation loss decreased (-0.283759 --> -0.297273).  Saving model ...
Epoch: 12 cost time: 4.8194661140441895
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.684 Vali Acc: 0.203 Test Loss: 2.684 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.425976037979126
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.465 Vali Acc: 0.162 Test Loss: 2.465 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.909157037734985
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.421 Vali Acc: 0.189 Test Loss: 2.421 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.576995134353638
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.431 Vali Acc: 0.203 Test Loss: 2.431 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.95758056640625
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.216 Test Loss: 2.455 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.463580369949341
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.189 Test Loss: 2.463 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.019263029098511
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.473 Vali Acc: 0.203 Test Loss: 2.473 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.408507585525513
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.216 Test Loss: 2.467 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.45377516746521
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.461 Vali Acc: 0.216 Test Loss: 2.461 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.661453485488892
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.474 Vali Acc: 0.230 Test Loss: 2.474 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.2972972972972973
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.807766437530518
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.420 Vali Acc: 0.189 Test Loss: 1.420 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 4.243555784225464
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.514 Vali Acc: 0.230 Test Loss: 1.514 Test Acc: 0.230
Validation loss decreased (-0.189175 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 4.123424768447876
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.573 Vali Acc: 0.216 Test Loss: 1.573 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.347289562225342
Epoch: 4, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.547 Vali Acc: 0.297 Test Loss: 1.547 Test Acc: 0.297
Validation loss decreased (-0.229715 --> -0.297282).  Saving model ...
Epoch: 5 cost time: 4.409185171127319
Epoch: 5, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.513 Vali Acc: 0.324 Test Loss: 1.513 Test Acc: 0.324
Validation loss decreased (-0.297282 --> -0.324309).  Saving model ...
Epoch: 6 cost time: 4.590205430984497
Epoch: 6, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.851 Vali Acc: 0.243 Test Loss: 1.851 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.33093523979187
Epoch: 7, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.951 Vali Acc: 0.284 Test Loss: 1.951 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5219950675964355
Epoch: 8, Steps: 10 | Train Loss: 0.149 Vali Loss: 2.205 Vali Acc: 0.324 Test Loss: 2.205 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.244648694992065
Epoch: 9, Steps: 10 | Train Loss: 0.062 Vali Loss: 2.169 Vali Acc: 0.351 Test Loss: 2.169 Test Acc: 0.351
Validation loss decreased (-0.324309 --> -0.351330).  Saving model ...
Epoch: 10 cost time: 4.313167333602905
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.378 Vali Acc: 0.338 Test Loss: 2.378 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.973658561706543
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.753 Vali Acc: 0.284 Test Loss: 2.753 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.017716884613037
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.804 Vali Acc: 0.324 Test Loss: 2.804 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.81427264213562
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.734 Vali Acc: 0.378 Test Loss: 2.734 Test Acc: 0.378
Validation loss decreased (-0.351330 --> -0.378351).  Saving model ...
Epoch: 14 cost time: 4.127314329147339
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.749 Vali Acc: 0.338 Test Loss: 2.749 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.217757940292358
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.781 Vali Acc: 0.311 Test Loss: 2.781 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.377825498580933
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.750 Vali Acc: 0.324 Test Loss: 2.750 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.16321325302124
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.764 Vali Acc: 0.324 Test Loss: 2.764 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.059963226318359
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.882 Vali Acc: 0.324 Test Loss: 2.882 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.3533477783203125
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.854 Vali Acc: 0.311 Test Loss: 2.854 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.041683197021484
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.903 Vali Acc: 0.324 Test Loss: 2.903 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.1981542110443115
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.977 Vali Acc: 0.297 Test Loss: 2.977 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.27262282371521
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.971 Vali Acc: 0.324 Test Loss: 2.971 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.057170391082764
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.994 Vali Acc: 0.324 Test Loss: 2.994 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.1713056564331055
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.469 Vali Acc: 0.176 Test Loss: 1.469 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 4.443737268447876
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.615 Vali Acc: 0.230 Test Loss: 1.615 Test Acc: 0.230
Validation loss decreased (-0.175661 --> -0.229714).  Saving model ...
Epoch: 3 cost time: 4.711644887924194
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.595 Vali Acc: 0.189 Test Loss: 1.595 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.44898247718811
Epoch: 4, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.530 Vali Acc: 0.311 Test Loss: 1.530 Test Acc: 0.311
Validation loss decreased (-0.229714 --> -0.310796).  Saving model ...
Epoch: 5 cost time: 4.331433534622192
Epoch: 5, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.692 Vali Acc: 0.284 Test Loss: 1.692 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.325484752655029
Epoch: 6, Steps: 10 | Train Loss: 0.553 Vali Loss: 2.113 Vali Acc: 0.243 Test Loss: 2.113 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.505681753158569
Epoch: 7, Steps: 10 | Train Loss: 0.429 Vali Loss: 2.111 Vali Acc: 0.270 Test Loss: 2.111 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.306045770645142
Epoch: 8, Steps: 10 | Train Loss: 0.280 Vali Loss: 2.295 Vali Acc: 0.297 Test Loss: 2.295 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.3230085372924805
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 2.195 Vali Acc: 0.230 Test Loss: 2.195 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.451413869857788
Epoch: 10, Steps: 10 | Train Loss: 0.066 Vali Loss: 2.335 Vali Acc: 0.257 Test Loss: 2.335 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.3881354331970215
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.924 Vali Acc: 0.270 Test Loss: 2.924 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.155324459075928
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.929 Vali Acc: 0.257 Test Loss: 2.929 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.05331015586853
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.959 Vali Acc: 0.243 Test Loss: 2.959 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.058645725250244
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.989 Vali Acc: 0.243 Test Loss: 2.989 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 6196996
model size : 33.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.786177158355713
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.194 Vali Acc: 0.459 Test Loss: 1.194 Test Acc: 0.459
Validation loss decreased (inf --> -0.459448).  Saving model ...
Epoch: 2 cost time: 4.332609176635742
Epoch: 2, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.158 Vali Acc: 0.486 Test Loss: 1.158 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 3.992439031600952
Epoch: 3, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.050 Vali Acc: 0.581 Test Loss: 1.050 Test Acc: 0.581
Validation loss decreased (-0.486475 --> -0.581071).  Saving model ...
Epoch: 4 cost time: 4.213738441467285
Epoch: 4, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.937 Vali Acc: 0.649 Test Loss: 0.937 Test Acc: 0.649
Validation loss decreased (-0.581071 --> -0.648639).  Saving model ...
Epoch: 5 cost time: 4.5252485275268555
Epoch: 5, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.978 Vali Acc: 0.581 Test Loss: 0.978 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.2523744106292725
Epoch: 6, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.058 Vali Acc: 0.608 Test Loss: 1.058 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.252737998962402
Epoch: 7, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.662 Test Loss: 1.000 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 8 cost time: 4.513186693191528
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.635 Test Loss: 1.030 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.469774484634399
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.649 Test Loss: 1.021 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.440768241882324
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.649 Test Loss: 1.003 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.194770097732544
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.4211530685424805
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.635 Test Loss: 1.004 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.44548225402832
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.676 Test Loss: 1.002 Test Acc: 0.676
Validation loss decreased (-0.662152 --> -0.675666).  Saving model ...
Epoch: 14 cost time: 4.313189268112183
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.676 Test Loss: 1.003 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.598047494888306
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.649 Test Loss: 1.010 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.407399415969849
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.649 Test Loss: 1.014 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.237816333770752
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.662 Test Loss: 1.012 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.334540605545044
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.662 Test Loss: 1.019 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.220422029495239
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.649 Test Loss: 1.026 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.331043004989624
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.649 Test Loss: 1.024 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.168789863586426
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.649 Test Loss: 1.024 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.287505865097046
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.635 Test Loss: 1.027 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.392899990081787
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.649 Test Loss: 1.029 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.250346422195435
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.213 Vali Acc: 0.473 Test Loss: 1.213 Test Acc: 0.473
Validation loss decreased (inf --> -0.472961).  Saving model ...
Epoch: 2 cost time: 4.535234451293945
Epoch: 2, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 4.467773675918579
Epoch: 3, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.159 Vali Acc: 0.581 Test Loss: 1.159 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581069).  Saving model ...
Epoch: 4 cost time: 4.514900207519531
Epoch: 4, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.167 Vali Acc: 0.581 Test Loss: 1.167 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.141680479049683
Epoch: 5, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.239 Vali Acc: 0.622 Test Loss: 1.239 Test Acc: 0.622
Validation loss decreased (-0.581069 --> -0.621609).  Saving model ...
Epoch: 6 cost time: 4.825252294540405
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.154 Vali Acc: 0.622 Test Loss: 1.154 Test Acc: 0.622
Validation loss decreased (-0.621609 --> -0.621610).  Saving model ...
Epoch: 7 cost time: 4.555162668228149
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.278 Vali Acc: 0.622 Test Loss: 1.278 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5533127784729
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.126 Vali Acc: 0.622 Test Loss: 1.126 Test Acc: 0.622
Validation loss decreased (-0.621610 --> -0.621610).  Saving model ...
Epoch: 9 cost time: 4.842412233352661
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.117 Vali Acc: 0.595 Test Loss: 1.117 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.444722652435303
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.175 Vali Acc: 0.622 Test Loss: 1.175 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.118691682815552
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.622 Test Loss: 1.196 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.613762617111206
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.608 Test Loss: 1.173 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.939187288284302
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.525817632675171
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.608 Test Loss: 1.162 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.535578727722168
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.583428144454956
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.595 Test Loss: 1.180 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.394468545913696
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.608 Test Loss: 1.180 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.41829776763916
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.635 Test Loss: 1.187 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635123).  Saving model ...
Epoch: 19 cost time: 4.411052703857422
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.635 Test Loss: 1.192 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.853455066680908
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.635 Test Loss: 1.195 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.510730981826782
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.635 Test Loss: 1.201 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.344151496887207
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.649 Test Loss: 1.206 Test Acc: 0.649
Validation loss decreased (-0.635123 --> -0.648637).  Saving model ...
Epoch: 23 cost time: 4.5577239990234375
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.649 Test Loss: 1.208 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.4816224575042725
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.662 Test Loss: 1.208 Test Acc: 0.662
Validation loss decreased (-0.648637 --> -0.662150).  Saving model ...
Epoch: 25 cost time: 4.8681018352508545
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.662 Test Loss: 1.215 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.904227256774902
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.676 Test Loss: 1.211 Test Acc: 0.676
Validation loss decreased (-0.662150 --> -0.675664).  Saving model ...
Epoch: 27 cost time: 4.716943025588989
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.676 Test Loss: 1.215 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.539905548095703
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.676 Test Loss: 1.222 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.976675510406494
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.676 Test Loss: 1.224 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.278352975845337
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.676 Test Loss: 1.225 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.102473020553589
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.676 Test Loss: 1.225 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.982583522796631
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.676 Test Loss: 1.227 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.59731912612915
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.662 Test Loss: 1.235 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.442371368408203
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.662 Test Loss: 1.240 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.193482398986816
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.676 Test Loss: 1.243 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.409424066543579
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.676 Test Loss: 1.248 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.152215480804443
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.326 Vali Acc: 0.338 Test Loss: 1.326 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 4.765573978424072
Epoch: 2, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.558 Vali Acc: 0.351 Test Loss: 1.558 Test Acc: 0.351
Validation loss decreased (-0.337825 --> -0.351336).  Saving model ...
Epoch: 3 cost time: 4.381983280181885
Epoch: 3, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.640 Vali Acc: 0.365 Test Loss: 1.640 Test Acc: 0.365
Validation loss decreased (-0.351336 --> -0.364848).  Saving model ...
Epoch: 4 cost time: 4.389638423919678
Epoch: 4, Steps: 10 | Train Loss: 0.178 Vali Loss: 2.056 Vali Acc: 0.365 Test Loss: 2.056 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.381086587905884
Epoch: 5, Steps: 10 | Train Loss: 0.091 Vali Loss: 2.158 Vali Acc: 0.419 Test Loss: 2.158 Test Acc: 0.419
Validation loss decreased (-0.364848 --> -0.418897).  Saving model ...
Epoch: 6 cost time: 4.934071779251099
Epoch: 6, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.288 Vali Acc: 0.378 Test Loss: 2.288 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.535977363586426
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.901 Vali Acc: 0.405 Test Loss: 2.901 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.351265907287598
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.419 Vali Acc: 0.446 Test Loss: 2.419 Test Acc: 0.446
Validation loss decreased (-0.418897 --> -0.445922).  Saving model ...
Epoch: 9 cost time: 4.618701934814453
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.505 Vali Acc: 0.405 Test Loss: 2.505 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.390930414199829
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.639 Vali Acc: 0.392 Test Loss: 2.639 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.317494869232178
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.521 Vali Acc: 0.459 Test Loss: 2.521 Test Acc: 0.459
Validation loss decreased (-0.445922 --> -0.459434).  Saving model ...
Epoch: 12 cost time: 4.3601250648498535
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.553 Vali Acc: 0.392 Test Loss: 2.553 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.67621636390686
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.538 Vali Acc: 0.432 Test Loss: 2.538 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.412956953048706
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.573 Vali Acc: 0.432 Test Loss: 2.573 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.752360582351685
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.577 Vali Acc: 0.446 Test Loss: 2.577 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.873802661895752
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.571 Vali Acc: 0.432 Test Loss: 2.571 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.525133371353149
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.571 Vali Acc: 0.432 Test Loss: 2.571 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.560565710067749
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.575 Vali Acc: 0.432 Test Loss: 2.575 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.761563777923584
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.419 Test Loss: 2.584 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.69848370552063
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.591 Vali Acc: 0.419 Test Loss: 2.591 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.68839168548584
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.600 Vali Acc: 0.432 Test Loss: 2.600 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.670386075973511
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.366 Vali Acc: 0.365 Test Loss: 1.366 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 4.11629319190979
Epoch: 2, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.576 Vali Acc: 0.216 Test Loss: 1.576 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.388728857040405
Epoch: 3, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.600 Vali Acc: 0.270 Test Loss: 1.600 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.118928670883179
Epoch: 4, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.820 Vali Acc: 0.324 Test Loss: 1.820 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.213359355926514
Epoch: 5, Steps: 10 | Train Loss: 0.075 Vali Loss: 2.229 Vali Acc: 0.338 Test Loss: 2.229 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.016793251037598
Epoch: 6, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.988 Vali Acc: 0.324 Test Loss: 1.988 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.1315741539001465
Epoch: 7, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.450 Vali Acc: 0.297 Test Loss: 2.450 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.332492828369141
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.317 Vali Acc: 0.311 Test Loss: 2.317 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.3265111446380615
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.475 Vali Acc: 0.351 Test Loss: 2.475 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.074671506881714
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.534 Vali Acc: 0.351 Test Loss: 2.534 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.4010913372039795
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.444 Vali Acc: 0.324 Test Loss: 2.444 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.802750825881958
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.411 Vali Acc: 0.257 Test Loss: 1.411 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.138728618621826
Epoch: 2, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.601 Vali Acc: 0.297 Test Loss: 1.601 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297281).  Saving model ...
Epoch: 3 cost time: 4.143706798553467
Epoch: 3, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.723 Vali Acc: 0.270 Test Loss: 1.723 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9752774238586426
Epoch: 4, Steps: 10 | Train Loss: 0.256 Vali Loss: 2.037 Vali Acc: 0.243 Test Loss: 2.037 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.042189121246338
Epoch: 5, Steps: 10 | Train Loss: 0.112 Vali Loss: 2.757 Vali Acc: 0.257 Test Loss: 2.757 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.357415199279785
Epoch: 6, Steps: 10 | Train Loss: 0.050 Vali Loss: 2.563 Vali Acc: 0.284 Test Loss: 2.563 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.163762092590332
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.649 Vali Acc: 0.311 Test Loss: 2.649 Test Acc: 0.311
Validation loss decreased (-0.297281 --> -0.310784).  Saving model ...
Epoch: 8 cost time: 4.500412702560425
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.737 Vali Acc: 0.365 Test Loss: 2.737 Test Acc: 0.365
Validation loss decreased (-0.310784 --> -0.364837).  Saving model ...
Epoch: 9 cost time: 4.418367624282837
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.866 Vali Acc: 0.351 Test Loss: 2.866 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.093599319458008
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.107 Vali Acc: 0.311 Test Loss: 3.107 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.088465213775635
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.918 Vali Acc: 0.351 Test Loss: 2.918 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.0088584423065186
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.905 Vali Acc: 0.351 Test Loss: 2.905 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.097620725631714
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.930 Vali Acc: 0.351 Test Loss: 2.930 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.0848259925842285
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.985 Vali Acc: 0.351 Test Loss: 2.985 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.031934976577759
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.992 Vali Acc: 0.351 Test Loss: 2.992 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.9898011684417725
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.993 Vali Acc: 0.351 Test Loss: 2.993 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.1328089237213135
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.001 Vali Acc: 0.351 Test Loss: 3.001 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.258188247680664
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.011 Vali Acc: 0.351 Test Loss: 3.011 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.41009521484375
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.377 Vali Acc: 0.243 Test Loss: 1.377 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.450194358825684
Epoch: 2, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.632 Vali Acc: 0.216 Test Loss: 1.632 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.452582120895386
Epoch: 3, Steps: 10 | Train Loss: 0.583 Vali Loss: 1.769 Vali Acc: 0.203 Test Loss: 1.769 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.428205728530884
Epoch: 4, Steps: 10 | Train Loss: 0.289 Vali Loss: 2.472 Vali Acc: 0.216 Test Loss: 2.472 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.303733825683594
Epoch: 5, Steps: 10 | Train Loss: 0.111 Vali Loss: 2.513 Vali Acc: 0.257 Test Loss: 2.513 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256732).  Saving model ...
Epoch: 6 cost time: 4.597127676010132
Epoch: 6, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.381 Vali Acc: 0.257 Test Loss: 2.381 Test Acc: 0.257
Validation loss decreased (-0.256732 --> -0.256733).  Saving model ...
Epoch: 7 cost time: 4.785731792449951
Epoch: 7, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.733 Vali Acc: 0.216 Test Loss: 2.733 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.028452634811401
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.647 Vali Acc: 0.324 Test Loss: 2.647 Test Acc: 0.324
Validation loss decreased (-0.256733 --> -0.324298).  Saving model ...
Epoch: 9 cost time: 4.331583023071289
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.775 Vali Acc: 0.270 Test Loss: 2.775 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.6032493114471436
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.768 Vali Acc: 0.297 Test Loss: 2.768 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.334678649902344
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.789 Vali Acc: 0.324 Test Loss: 2.789 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.15369176864624
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.820 Vali Acc: 0.297 Test Loss: 2.820 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.144794225692749
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.839 Vali Acc: 0.297 Test Loss: 2.839 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9512860774993896
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.836 Vali Acc: 0.297 Test Loss: 2.836 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.1725451946258545
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.848 Vali Acc: 0.311 Test Loss: 2.848 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.281110048294067
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.868 Vali Acc: 0.311 Test Loss: 2.868 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.261854648590088
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.905 Vali Acc: 0.284 Test Loss: 2.905 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.065093278884888
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.910 Vali Acc: 0.311 Test Loss: 2.910 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.566464900970459
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.417 Vali Acc: 0.297 Test Loss: 1.417 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 4.580941438674927
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.871 Vali Acc: 0.230 Test Loss: 1.871 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.208792448043823
Epoch: 3, Steps: 10 | Train Loss: 0.978 Vali Loss: 2.053 Vali Acc: 0.149 Test Loss: 2.053 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.071992874145508
Epoch: 4, Steps: 10 | Train Loss: 0.852 Vali Loss: 2.204 Vali Acc: 0.176 Test Loss: 2.204 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.219467878341675
Epoch: 5, Steps: 10 | Train Loss: 0.550 Vali Loss: 2.309 Vali Acc: 0.284 Test Loss: 2.309 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.2572338581085205
Epoch: 6, Steps: 10 | Train Loss: 0.213 Vali Loss: 2.096 Vali Acc: 0.257 Test Loss: 2.096 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.277144908905029
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 2.435 Vali Acc: 0.230 Test Loss: 2.435 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.569883108139038
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.862 Vali Acc: 0.230 Test Loss: 2.862 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.17320990562439
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.790 Vali Acc: 0.243 Test Loss: 2.790 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.2031638622283936
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.039 Vali Acc: 0.203 Test Loss: 3.039 Test Acc: 0.203
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.492311954498291
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.002 Vali Acc: 0.270 Test Loss: 3.002 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.2972972972972973
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.235732316970825
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.390 Vali Acc: 0.324 Test Loss: 1.390 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 4.326572895050049
Epoch: 2, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.617 Vali Acc: 0.189 Test Loss: 1.617 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.364684820175171
Epoch: 3, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.705 Vali Acc: 0.270 Test Loss: 1.705 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.355555534362793
Epoch: 4, Steps: 10 | Train Loss: 0.456 Vali Loss: 2.041 Vali Acc: 0.122 Test Loss: 2.041 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.092498540878296
Epoch: 5, Steps: 10 | Train Loss: 0.195 Vali Loss: 2.500 Vali Acc: 0.216 Test Loss: 2.500 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.165544271469116
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 2.138 Vali Acc: 0.176 Test Loss: 2.138 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.329091787338257
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 2.964 Vali Acc: 0.189 Test Loss: 2.964 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.285587787628174
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.599 Vali Acc: 0.243 Test Loss: 2.599 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.542009115219116
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.549 Vali Acc: 0.351 Test Loss: 2.549 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351326).  Saving model ...
Epoch: 10 cost time: 4.785222768783569
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.801 Vali Acc: 0.270 Test Loss: 2.801 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.563764572143555
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.591 Vali Acc: 0.351 Test Loss: 2.591 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.50315523147583
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.962 Vali Acc: 0.297 Test Loss: 2.962 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.5540525913238525
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.650 Vali Acc: 0.311 Test Loss: 2.650 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.626157283782959
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.770 Vali Acc: 0.162 Test Loss: 2.770 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.543792724609375
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.836 Vali Acc: 0.203 Test Loss: 2.836 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.801699161529541
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.794 Vali Acc: 0.270 Test Loss: 2.794 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.381579160690308
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.809 Vali Acc: 0.243 Test Loss: 2.809 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.919975519180298
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.817 Vali Acc: 0.243 Test Loss: 2.817 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.92327094078064
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.806 Vali Acc: 0.243 Test Loss: 2.806 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.616155385971069
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.8436262607574463
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.593 Vali Acc: 0.203 Test Loss: 1.593 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.20878267288208
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.665 Vali Acc: 0.189 Test Loss: 1.665 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.945030689239502
Epoch: 4, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.687 Vali Acc: 0.189 Test Loss: 1.687 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.077148199081421
Epoch: 5, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.833 Vali Acc: 0.257 Test Loss: 1.833 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256738).  Saving model ...
Epoch: 6 cost time: 3.932807207107544
Epoch: 6, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.681 Vali Acc: 0.189 Test Loss: 1.681 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.10288667678833
Epoch: 7, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.829 Vali Acc: 0.284 Test Loss: 1.829 Test Acc: 0.284
Validation loss decreased (-0.256738 --> -0.283765).  Saving model ...
Epoch: 8 cost time: 4.189390182495117
Epoch: 8, Steps: 10 | Train Loss: 0.142 Vali Loss: 2.024 Vali Acc: 0.230 Test Loss: 2.024 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.317231178283691
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.995 Vali Acc: 0.270 Test Loss: 1.995 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.343214273452759
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.418 Vali Acc: 0.284 Test Loss: 2.418 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.106116056442261
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.390 Vali Acc: 0.324 Test Loss: 2.390 Test Acc: 0.324
Validation loss decreased (-0.283765 --> -0.324300).  Saving model ...
Epoch: 12 cost time: 4.701697587966919
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.824 Vali Acc: 0.284 Test Loss: 2.824 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9759371280670166
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.710 Vali Acc: 0.311 Test Loss: 2.710 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.708829402923584
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.807 Vali Acc: 0.311 Test Loss: 2.807 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.343544006347656
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.612 Vali Acc: 0.257 Test Loss: 2.612 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.45139217376709
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.646 Vali Acc: 0.284 Test Loss: 2.646 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.043090581893921
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.751 Vali Acc: 0.297 Test Loss: 2.751 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.30362343788147
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.746 Vali Acc: 0.284 Test Loss: 2.746 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.117027759552002
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.766 Vali Acc: 0.297 Test Loss: 2.766 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.961756706237793
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.752 Vali Acc: 0.284 Test Loss: 2.752 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.284662485122681
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.796 Vali Acc: 0.311 Test Loss: 2.796 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.619673728942871
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.351 Vali Acc: 0.419 Test Loss: 1.351 Test Acc: 0.419
Validation loss decreased (inf --> -0.418905).  Saving model ...
Epoch: 2 cost time: 4.143592119216919
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.418 Vali Acc: 0.311 Test Loss: 1.418 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4509968757629395
Epoch: 3, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.508 Vali Acc: 0.230 Test Loss: 1.508 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.07848596572876
Epoch: 4, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.619 Vali Acc: 0.365 Test Loss: 1.619 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.461917161941528
Epoch: 5, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.677 Vali Acc: 0.311 Test Loss: 1.677 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.336729288101196
Epoch: 6, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.491 Vali Acc: 0.324 Test Loss: 1.491 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.372692108154297
Epoch: 7, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.817 Vali Acc: 0.338 Test Loss: 1.817 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.510155916213989
Epoch: 8, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.965 Vali Acc: 0.243 Test Loss: 1.965 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.51314377784729
Epoch: 9, Steps: 10 | Train Loss: 0.148 Vali Loss: 2.043 Vali Acc: 0.324 Test Loss: 2.043 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.3595311641693115
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 2.667 Vali Acc: 0.270 Test Loss: 2.667 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.686860084533691
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 2.553 Vali Acc: 0.378 Test Loss: 2.553 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 4624132
model size : 27.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.8291285037994385
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.322 Vali Acc: 0.351 Test Loss: 1.322 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 4.016118764877319
Epoch: 2, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.011 Vali Acc: 0.581 Test Loss: 1.011 Test Acc: 0.581
Validation loss decreased (-0.351338 --> -0.581071).  Saving model ...
Epoch: 3 cost time: 3.820556163787842
Epoch: 3, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 4 cost time: 4.148091077804565
Epoch: 4, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.989 Vali Acc: 0.622 Test Loss: 0.989 Test Acc: 0.622
Validation loss decreased (-0.581071 --> -0.621612).  Saving model ...
Epoch: 5 cost time: 3.813302993774414
Epoch: 5, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.167272090911865
Epoch: 6, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.241 Vali Acc: 0.568 Test Loss: 1.241 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.0374414920806885
Epoch: 7, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.980 Vali Acc: 0.649 Test Loss: 0.980 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648639).  Saving model ...
Epoch: 8 cost time: 3.9189627170562744
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.955 Vali Acc: 0.662 Test Loss: 0.955 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 9 cost time: 3.9236607551574707
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.676 Test Loss: 1.014 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 10 cost time: 3.8287250995635986
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.946 Vali Acc: 0.689 Test Loss: 0.946 Test Acc: 0.689
Validation loss decreased (-0.675666 --> -0.689180).  Saving model ...
Epoch: 11 cost time: 3.8543155193328857
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.676 Test Loss: 0.923 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.2063212394714355
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.662 Test Loss: 0.935 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8692471981048584
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.662 Test Loss: 0.949 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.051505088806152
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.662 Test Loss: 0.948 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.115147113800049
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.662 Test Loss: 0.951 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.091449022293091
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.662 Test Loss: 0.952 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.8451035022735596
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.662 Test Loss: 0.956 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.062988758087158
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.662 Test Loss: 0.960 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.030421495437622
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.662 Test Loss: 0.962 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.5324482917785645
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.662 Test Loss: 0.968 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.044612169265747
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 4.021334171295166
Epoch: 2, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.097 Vali Acc: 0.568 Test Loss: 1.097 Test Acc: 0.568
Validation loss decreased (-0.364852 --> -0.567557).  Saving model ...
Epoch: 3 cost time: 4.178839445114136
Epoch: 3, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.072 Vali Acc: 0.581 Test Loss: 1.072 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 4 cost time: 3.96999454498291
Epoch: 4, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.131 Vali Acc: 0.568 Test Loss: 1.131 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.29759407043457
Epoch: 5, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.196 Vali Acc: 0.568 Test Loss: 1.196 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.181536674499512
Epoch: 6, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.298 Vali Acc: 0.595 Test Loss: 1.298 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 7 cost time: 4.083638668060303
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.089 Vali Acc: 0.649 Test Loss: 1.089 Test Acc: 0.649
Validation loss decreased (-0.594582 --> -0.648638).  Saving model ...
Epoch: 8 cost time: 3.8707685470581055
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.048 Vali Acc: 0.622 Test Loss: 1.048 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.0429847240448
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.129 Vali Acc: 0.649 Test Loss: 1.129 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.847410202026367
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.649 Test Loss: 1.108 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.969282388687134
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.595 Test Loss: 1.116 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9215893745422363
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.595 Test Loss: 1.132 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.193429470062256
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.635 Test Loss: 1.143 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.436633825302124
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.622 Test Loss: 1.144 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.067515850067139
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.635 Test Loss: 1.148 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.130354404449463
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.635 Test Loss: 1.144 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.152448654174805
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.635 Test Loss: 1.148 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.2675087451934814
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.131132125854492
Epoch: 2, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.464 Vali Acc: 0.405 Test Loss: 1.464 Test Acc: 0.405
Validation loss decreased (-0.243229 --> -0.405391).  Saving model ...
Epoch: 3 cost time: 4.581507205963135
Epoch: 3, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.750 Vali Acc: 0.338 Test Loss: 1.750 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.115771055221558
Epoch: 4, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.666 Vali Acc: 0.432 Test Loss: 1.666 Test Acc: 0.432
Validation loss decreased (-0.405391 --> -0.432416).  Saving model ...
Epoch: 5 cost time: 4.177026033401489
Epoch: 5, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.978 Vali Acc: 0.365 Test Loss: 1.978 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.958155870437622
Epoch: 6, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.141 Vali Acc: 0.378 Test Loss: 2.141 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.0126731395721436
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.218 Vali Acc: 0.432 Test Loss: 2.218 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.181073904037476
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.779 Vali Acc: 0.419 Test Loss: 2.779 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.08992862701416
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.335 Vali Acc: 0.365 Test Loss: 2.335 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.223029375076294
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.837 Vali Acc: 0.432 Test Loss: 2.837 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.21905779838562
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.367 Vali Acc: 0.405 Test Loss: 2.367 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.154304504394531
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.412 Vali Acc: 0.419 Test Loss: 2.412 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.197043180465698
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.475 Vali Acc: 0.432 Test Loss: 2.475 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.773598909378052
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.521 Vali Acc: 0.432 Test Loss: 2.521 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.8245134353637695
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.533 Vali Acc: 0.176 Test Loss: 1.533 Test Acc: 0.176
Validation loss decreased (inf --> -0.175660).  Saving model ...
Epoch: 2 cost time: 4.060722589492798
Epoch: 2, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.492 Vali Acc: 0.338 Test Loss: 1.492 Test Acc: 0.338
Validation loss decreased (-0.175660 --> -0.337823).  Saving model ...
Epoch: 3 cost time: 4.321956157684326
Epoch: 3, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.830 Vali Acc: 0.284 Test Loss: 1.830 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.418813705444336
Epoch: 4, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.692 Vali Acc: 0.311 Test Loss: 1.692 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.3563597202301025
Epoch: 5, Steps: 10 | Train Loss: 0.102 Vali Loss: 2.064 Vali Acc: 0.297 Test Loss: 2.064 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.457787752151489
Epoch: 6, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.490 Vali Acc: 0.351 Test Loss: 2.490 Test Acc: 0.351
Validation loss decreased (-0.337823 --> -0.351326).  Saving model ...
Epoch: 7 cost time: 4.5969932079315186
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.131 Vali Acc: 0.297 Test Loss: 2.131 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.226037502288818
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.388 Vali Acc: 0.338 Test Loss: 2.388 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.106814622879028
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.594 Vali Acc: 0.297 Test Loss: 2.594 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8446438312530518
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.617 Vali Acc: 0.324 Test Loss: 2.617 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.053703308105469
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.636 Vali Acc: 0.365 Test Loss: 2.636 Test Acc: 0.365
Validation loss decreased (-0.351326 --> -0.364839).  Saving model ...
Epoch: 12 cost time: 4.045138359069824
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.643 Vali Acc: 0.311 Test Loss: 2.643 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.1561853885650635
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.695 Vali Acc: 0.324 Test Loss: 2.695 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.140208959579468
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.700 Vali Acc: 0.324 Test Loss: 2.700 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.076823711395264
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.693 Vali Acc: 0.338 Test Loss: 2.693 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9438605308532715
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.689 Vali Acc: 0.324 Test Loss: 2.689 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.387984275817871
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.701 Vali Acc: 0.324 Test Loss: 2.701 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.0506086349487305
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.710 Vali Acc: 0.324 Test Loss: 2.710 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.282632112503052
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.721 Vali Acc: 0.311 Test Loss: 2.721 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.563220500946045
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.735 Vali Acc: 0.311 Test Loss: 2.735 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.365133762359619
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.746 Vali Acc: 0.311 Test Loss: 2.746 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.262099504470825
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.522 Vali Acc: 0.243 Test Loss: 1.522 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 4.466284990310669
Epoch: 2, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.519 Vali Acc: 0.338 Test Loss: 1.519 Test Acc: 0.338
Validation loss decreased (-0.243228 --> -0.337823).  Saving model ...
Epoch: 3 cost time: 4.591322660446167
Epoch: 3, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.921 Vali Acc: 0.297 Test Loss: 1.921 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.314794540405273
Epoch: 4, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.930 Vali Acc: 0.270 Test Loss: 1.930 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.33559775352478
Epoch: 5, Steps: 10 | Train Loss: 0.105 Vali Loss: 2.346 Vali Acc: 0.243 Test Loss: 2.346 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.456928253173828
Epoch: 6, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.591 Vali Acc: 0.297 Test Loss: 2.591 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.384928464889526
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.322 Vali Acc: 0.338 Test Loss: 2.322 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.396157741546631
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.463 Vali Acc: 0.311 Test Loss: 2.463 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.298373222351074
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.603 Vali Acc: 0.351 Test Loss: 2.603 Test Acc: 0.351
Validation loss decreased (-0.337823 --> -0.351325).  Saving model ...
Epoch: 10 cost time: 4.416242599487305
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.664 Vali Acc: 0.338 Test Loss: 2.664 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.248013734817505
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.633 Vali Acc: 0.351 Test Loss: 2.633 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.5368616580963135
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.646 Vali Acc: 0.338 Test Loss: 2.646 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.684261083602905
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.675 Vali Acc: 0.324 Test Loss: 2.675 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.931962490081787
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.690 Vali Acc: 0.338 Test Loss: 2.690 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.853226661682129
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.690 Vali Acc: 0.324 Test Loss: 2.690 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.701940298080444
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.351 Test Loss: 2.696 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.766164302825928
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.713 Vali Acc: 0.351 Test Loss: 2.713 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.728983402252197
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.721 Vali Acc: 0.351 Test Loss: 2.721 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.479616641998291
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.737 Vali Acc: 0.338 Test Loss: 2.737 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.037200689315796
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.502 Vali Acc: 0.257 Test Loss: 1.502 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 4.509751319885254
Epoch: 2, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.513 Vali Acc: 0.324 Test Loss: 1.513 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324309).  Saving model ...
Epoch: 3 cost time: 4.483629465103149
Epoch: 3, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.876 Vali Acc: 0.243 Test Loss: 1.876 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.644430875778198
Epoch: 4, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.857 Vali Acc: 0.284 Test Loss: 1.857 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.137141704559326
Epoch: 5, Steps: 10 | Train Loss: 0.091 Vali Loss: 2.158 Vali Acc: 0.257 Test Loss: 2.158 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.321613073348999
Epoch: 6, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.657 Vali Acc: 0.257 Test Loss: 2.657 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.689635753631592
Epoch: 7, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.532 Vali Acc: 0.270 Test Loss: 2.532 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.356747150421143
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.897 Vali Acc: 0.257 Test Loss: 2.897 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.301364421844482
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.757 Vali Acc: 0.297 Test Loss: 2.757 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.199045419692993
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.922 Vali Acc: 0.243 Test Loss: 2.922 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.842772483825684
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.902 Vali Acc: 0.270 Test Loss: 2.902 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.497431039810181
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.887 Vali Acc: 0.284 Test Loss: 2.887 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.7822136878967285
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.594 Vali Acc: 0.176 Test Loss: 1.594 Test Acc: 0.176
Validation loss decreased (inf --> -0.175660).  Saving model ...
Epoch: 2 cost time: 4.213775396347046
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.479 Vali Acc: 0.311 Test Loss: 1.479 Test Acc: 0.311
Validation loss decreased (-0.175660 --> -0.310796).  Saving model ...
Epoch: 3 cost time: 3.916321277618408
Epoch: 3, Steps: 10 | Train Loss: 0.954 Vali Loss: 2.122 Vali Acc: 0.243 Test Loss: 2.122 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.060145616531372
Epoch: 4, Steps: 10 | Train Loss: 0.669 Vali Loss: 2.285 Vali Acc: 0.284 Test Loss: 2.285 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.887852907180786
Epoch: 5, Steps: 10 | Train Loss: 0.424 Vali Loss: 2.224 Vali Acc: 0.311 Test Loss: 2.224 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.4164838790893555
Epoch: 6, Steps: 10 | Train Loss: 0.274 Vali Loss: 2.380 Vali Acc: 0.243 Test Loss: 2.380 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.08245587348938
Epoch: 7, Steps: 10 | Train Loss: 0.189 Vali Loss: 2.563 Vali Acc: 0.203 Test Loss: 2.563 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.4092864990234375
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 2.414 Vali Acc: 0.297 Test Loss: 2.414 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.827941656112671
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.986 Vali Acc: 0.243 Test Loss: 2.986 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.15806770324707
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.049 Vali Acc: 0.176 Test Loss: 3.049 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.1309592723846436
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.492 Vali Acc: 0.243 Test Loss: 3.492 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.213337659835815
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.124 Vali Acc: 0.324 Test Loss: 3.124 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324293).  Saving model ...
Epoch: 13 cost time: 4.372041702270508
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.510 Vali Acc: 0.243 Test Loss: 3.510 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.6108314990997314
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.399 Vali Acc: 0.243 Test Loss: 3.399 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9412429332733154
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.197 Vali Acc: 0.230 Test Loss: 3.197 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.169288635253906
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.248 Vali Acc: 0.230 Test Loss: 3.248 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9878854751586914
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.277 Vali Acc: 0.216 Test Loss: 3.277 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.966643810272217
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.294 Vali Acc: 0.216 Test Loss: 3.294 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.300546646118164
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.298 Vali Acc: 0.216 Test Loss: 3.298 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.216878652572632
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.317 Vali Acc: 0.216 Test Loss: 3.317 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.31478476524353
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.322 Vali Acc: 0.216 Test Loss: 3.322 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.323871612548828
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.326 Vali Acc: 0.216 Test Loss: 3.326 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.423789739608765
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.476 Vali Acc: 0.270 Test Loss: 1.476 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.66839861869812
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.443 Vali Acc: 0.392 Test Loss: 1.443 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391877).  Saving model ...
Epoch: 3 cost time: 4.615362167358398
Epoch: 3, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.747 Vali Acc: 0.284 Test Loss: 1.747 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.1759772300720215
Epoch: 4, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.802 Vali Acc: 0.257 Test Loss: 1.802 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.277382135391235
Epoch: 5, Steps: 10 | Train Loss: 0.163 Vali Loss: 2.069 Vali Acc: 0.257 Test Loss: 2.069 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.2816321849823
Epoch: 6, Steps: 10 | Train Loss: 0.077 Vali Loss: 2.491 Vali Acc: 0.203 Test Loss: 2.491 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.278611898422241
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.200 Vali Acc: 0.162 Test Loss: 2.200 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.5673439502716064
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.168 Vali Acc: 0.284 Test Loss: 2.168 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.333990812301636
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.446 Vali Acc: 0.257 Test Loss: 2.446 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.202219247817993
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.316 Vali Acc: 0.230 Test Loss: 2.316 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.9671261310577393
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.340 Vali Acc: 0.230 Test Loss: 2.340 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.087591886520386
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.325 Vali Acc: 0.270 Test Loss: 2.325 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.3583664894104
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.443 Vali Acc: 0.257 Test Loss: 1.443 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 4.084027290344238
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.398 Vali Acc: 0.338 Test Loss: 1.398 Test Acc: 0.338
Validation loss decreased (-0.256742 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 4.0682501792907715
Epoch: 3, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.830 Vali Acc: 0.149 Test Loss: 1.830 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.134188890457153
Epoch: 4, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.447 Vali Acc: 0.351 Test Loss: 1.447 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351337).  Saving model ...
Epoch: 5 cost time: 4.38438868522644
Epoch: 5, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.622 Vali Acc: 0.203 Test Loss: 1.622 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.363448858261108
Epoch: 6, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.907 Vali Acc: 0.230 Test Loss: 1.907 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.101142644882202
Epoch: 7, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.851 Vali Acc: 0.203 Test Loss: 1.851 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.281594753265381
Epoch: 8, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.947 Vali Acc: 0.284 Test Loss: 1.947 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.386495590209961
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 2.121 Vali Acc: 0.324 Test Loss: 2.121 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.224623918533325
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 2.362 Vali Acc: 0.338 Test Loss: 2.362 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.1960289478302
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.566 Vali Acc: 0.365 Test Loss: 2.566 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364839).  Saving model ...
Epoch: 12 cost time: 4.28617262840271
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.990 Vali Acc: 0.270 Test Loss: 2.990 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8761684894561768
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.974 Vali Acc: 0.311 Test Loss: 2.974 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.595195531845093
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.998 Vali Acc: 0.324 Test Loss: 2.998 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9843435287475586
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.904 Vali Acc: 0.338 Test Loss: 2.904 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.983872413635254
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.002 Vali Acc: 0.324 Test Loss: 3.002 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.177931070327759
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.999 Vali Acc: 0.297 Test Loss: 2.999 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.321700096130371
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.024 Vali Acc: 0.338 Test Loss: 3.024 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.07135009765625
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.052 Vali Acc: 0.297 Test Loss: 3.052 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.294647693634033
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.120 Vali Acc: 0.324 Test Loss: 3.120 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.106923580169678
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.151 Vali Acc: 0.311 Test Loss: 3.151 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.332348346710205
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.415 Vali Acc: 0.284 Test Loss: 1.415 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 4.306518077850342
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.372 Vali Acc: 0.338 Test Loss: 1.372 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 4.647011756896973
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.738 Vali Acc: 0.216 Test Loss: 1.738 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.632461309432983
Epoch: 4, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.605 Vali Acc: 0.351 Test Loss: 1.605 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351335).  Saving model ...
Epoch: 5 cost time: 4.370777606964111
Epoch: 5, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.722 Vali Acc: 0.243 Test Loss: 1.722 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.5574071407318115
Epoch: 6, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.973 Vali Acc: 0.270 Test Loss: 1.973 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.464297294616699
Epoch: 7, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.718 Vali Acc: 0.311 Test Loss: 1.718 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.291684865951538
Epoch: 8, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.771 Vali Acc: 0.378 Test Loss: 1.771 Test Acc: 0.378
Validation loss decreased (-0.351335 --> -0.378361).  Saving model ...
Epoch: 9 cost time: 4.297842025756836
Epoch: 9, Steps: 10 | Train Loss: 0.184 Vali Loss: 2.093 Vali Acc: 0.270 Test Loss: 2.093 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.009324789047241
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 2.299 Vali Acc: 0.297 Test Loss: 2.299 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.321248292922974
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 2.381 Vali Acc: 0.324 Test Loss: 2.381 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.001272201538086
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.612 Vali Acc: 0.378 Test Loss: 2.612 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.260819911956787
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.998 Vali Acc: 0.311 Test Loss: 2.998 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.276004791259766
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.225 Vali Acc: 0.216 Test Loss: 3.225 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.2199671268463135
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.173 Vali Acc: 0.311 Test Loss: 3.173 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.9968459606170654
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.467 Vali Acc: 0.284 Test Loss: 3.467 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.293712615966797
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.482 Vali Acc: 0.351 Test Loss: 3.482 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.24657678604126
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.951 Vali Acc: 0.297 Test Loss: 3.951 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 3837700
model size : 24.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.85956335067749
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
Validation loss decreased (inf --> -0.513501).  Saving model ...
Epoch: 2 cost time: 4.140918254852295
Epoch: 2, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.274 Vali Acc: 0.514 Test Loss: 1.274 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.20225977897644
Epoch: 3, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.926 Vali Acc: 0.595 Test Loss: 0.926 Test Acc: 0.595
Validation loss decreased (-0.513501 --> -0.594585).  Saving model ...
Epoch: 4 cost time: 4.118506669998169
Epoch: 4, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.887 Vali Acc: 0.622 Test Loss: 0.887 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621613).  Saving model ...
Epoch: 5 cost time: 4.206140041351318
Epoch: 5, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.906 Vali Acc: 0.649 Test Loss: 0.906 Test Acc: 0.649
Validation loss decreased (-0.621613 --> -0.648640).  Saving model ...
Epoch: 6 cost time: 4.295540809631348
Epoch: 6, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.983 Vali Acc: 0.649 Test Loss: 0.983 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.304836750030518
Epoch: 7, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.982 Vali Acc: 0.622 Test Loss: 0.982 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.290176868438721
Epoch: 8, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.733325481414795
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9892048835754395
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.622 Test Loss: 0.985 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.208551406860352
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.595 Test Loss: 1.005 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.0829596519470215
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.0341973304748535
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.635 Test Loss: 1.002 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.944941520690918
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.635 Test Loss: 1.001 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.247362375259399
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.635 Test Loss: 0.996 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.673540115356445
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.232 Vali Acc: 0.459 Test Loss: 1.232 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 4.066289901733398
Epoch: 2, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.395 Vali Acc: 0.446 Test Loss: 1.395 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2927844524383545
Epoch: 3, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 4.1147260665893555
Epoch: 4, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608098).  Saving model ...
Epoch: 5 cost time: 4.062153339385986
Epoch: 5, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.963 Vali Acc: 0.608 Test Loss: 0.963 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 6 cost time: 3.9994778633117676
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.115 Vali Acc: 0.622 Test Loss: 1.115 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621610).  Saving model ...
Epoch: 7 cost time: 4.132962703704834
Epoch: 7, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.139 Vali Acc: 0.568 Test Loss: 1.139 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.298938512802124
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.326 Vali Acc: 0.595 Test Loss: 1.326 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.069311857223511
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.198 Vali Acc: 0.595 Test Loss: 1.198 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.012952089309692
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.173 Vali Acc: 0.622 Test Loss: 1.173 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8900938034057617
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.207 Vali Acc: 0.608 Test Loss: 1.207 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.7066879272460938
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9106383323669434
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.595 Test Loss: 1.214 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.115804433822632
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.595 Test Loss: 1.215 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8865749835968018
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.581 Test Loss: 1.204 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.7775626182556152
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.595 Test Loss: 1.219 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.904439210891724
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.331 Vali Acc: 0.324 Test Loss: 1.331 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 4.203199625015259
Epoch: 2, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.806 Vali Acc: 0.324 Test Loss: 1.806 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.423180818557739
Epoch: 3, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.727 Vali Acc: 0.405 Test Loss: 1.727 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405388).  Saving model ...
Epoch: 4 cost time: 4.361927032470703
Epoch: 4, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.781 Vali Acc: 0.446 Test Loss: 1.781 Test Acc: 0.446
Validation loss decreased (-0.405388 --> -0.445928).  Saving model ...
Epoch: 5 cost time: 4.447954177856445
Epoch: 5, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.800 Vali Acc: 0.459 Test Loss: 1.800 Test Acc: 0.459
Validation loss decreased (-0.445928 --> -0.459441).  Saving model ...
Epoch: 6 cost time: 4.416321039199829
Epoch: 6, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.956 Vali Acc: 0.432 Test Loss: 1.956 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.670865535736084
Epoch: 7, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.533 Vali Acc: 0.378 Test Loss: 2.533 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.890880584716797
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.456 Vali Acc: 0.446 Test Loss: 2.456 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.6571173667907715
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.606 Vali Acc: 0.392 Test Loss: 2.606 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.4107582569122314
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.447 Vali Acc: 0.446 Test Loss: 2.447 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.620852708816528
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.556 Vali Acc: 0.446 Test Loss: 2.556 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.290209770202637
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.638 Vali Acc: 0.432 Test Loss: 2.638 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.066242456436157
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.652 Vali Acc: 0.432 Test Loss: 2.652 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.16253662109375
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.621 Vali Acc: 0.446 Test Loss: 2.621 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.282131910324097
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.432 Test Loss: 2.597 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.829685688018799
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.358 Vali Acc: 0.351 Test Loss: 1.358 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 4.256058931350708
Epoch: 2, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.811 Vali Acc: 0.243 Test Loss: 1.811 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.400874853134155
Epoch: 3, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.954 Vali Acc: 0.230 Test Loss: 1.954 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.321783781051636
Epoch: 4, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.676 Vali Acc: 0.351 Test Loss: 1.676 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.390813112258911
Epoch: 5, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.795 Vali Acc: 0.365 Test Loss: 1.795 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364847).  Saving model ...
Epoch: 6 cost time: 4.144312858581543
Epoch: 6, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.061 Vali Acc: 0.365 Test Loss: 2.061 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.476271152496338
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.370 Vali Acc: 0.365 Test Loss: 2.370 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.366883993148804
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.481 Vali Acc: 0.270 Test Loss: 2.481 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.552502870559692
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.664 Vali Acc: 0.324 Test Loss: 2.664 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.3323774337768555
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.679 Vali Acc: 0.243 Test Loss: 2.679 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.445592403411865
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.594 Vali Acc: 0.284 Test Loss: 2.594 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.610552549362183
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.657 Vali Acc: 0.311 Test Loss: 2.657 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.518060684204102
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.667 Vali Acc: 0.284 Test Loss: 2.667 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.186688423156738
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.641 Vali Acc: 0.284 Test Loss: 2.641 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.149077892303467
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.619 Vali Acc: 0.284 Test Loss: 2.619 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.748275518417358
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.356 Vali Acc: 0.338 Test Loss: 1.356 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 4.073621034622192
Epoch: 2, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.906 Vali Acc: 0.284 Test Loss: 1.906 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.1362526416778564
Epoch: 3, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.846 Vali Acc: 0.284 Test Loss: 1.846 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.131420612335205
Epoch: 4, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.871 Vali Acc: 0.324 Test Loss: 1.871 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.375246286392212
Epoch: 5, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.877 Vali Acc: 0.297 Test Loss: 1.877 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.207459449768066
Epoch: 6, Steps: 10 | Train Loss: 0.054 Vali Loss: 2.268 Vali Acc: 0.324 Test Loss: 2.268 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.560382843017578
Epoch: 7, Steps: 10 | Train Loss: 0.062 Vali Loss: 2.299 Vali Acc: 0.392 Test Loss: 2.299 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391869).  Saving model ...
Epoch: 8 cost time: 4.500188589096069
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.172 Vali Acc: 0.257 Test Loss: 3.172 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.435423851013184
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.653 Vali Acc: 0.270 Test Loss: 2.653 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.425629615783691
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.954 Vali Acc: 0.338 Test Loss: 2.954 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.520861387252808
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.066 Vali Acc: 0.338 Test Loss: 3.066 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.148837566375732
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.790 Vali Acc: 0.324 Test Loss: 2.790 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.465963363647461
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.822 Vali Acc: 0.311 Test Loss: 2.822 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.459506034851074
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.918 Vali Acc: 0.297 Test Loss: 2.918 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.10828423500061
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.965 Vali Acc: 0.297 Test Loss: 2.965 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9979612827301025
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.947 Vali Acc: 0.297 Test Loss: 2.947 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.091265916824341
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.928 Vali Acc: 0.297 Test Loss: 2.928 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.6856348514556885
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.420 Vali Acc: 0.257 Test Loss: 1.420 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.696399211883545
Epoch: 2, Steps: 10 | Train Loss: 1.104 Vali Loss: 2.015 Vali Acc: 0.189 Test Loss: 2.015 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.961740255355835
Epoch: 3, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.952 Vali Acc: 0.216 Test Loss: 1.952 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.064878940582275
Epoch: 4, Steps: 10 | Train Loss: 0.288 Vali Loss: 2.061 Vali Acc: 0.243 Test Loss: 2.061 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.203206777572632
Epoch: 5, Steps: 10 | Train Loss: 0.113 Vali Loss: 2.002 Vali Acc: 0.365 Test Loss: 2.002 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364845).  Saving model ...
Epoch: 6 cost time: 4.4008519649505615
Epoch: 6, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.196 Vali Acc: 0.392 Test Loss: 2.196 Test Acc: 0.392
Validation loss decreased (-0.364845 --> -0.391870).  Saving model ...
Epoch: 7 cost time: 4.249874114990234
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.599 Vali Acc: 0.257 Test Loss: 2.599 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.309916973114014
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.053 Vali Acc: 0.270 Test Loss: 3.053 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.349972724914551
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.788 Vali Acc: 0.297 Test Loss: 2.788 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.559143304824829
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.954 Vali Acc: 0.284 Test Loss: 2.954 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.469519853591919
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.917 Vali Acc: 0.284 Test Loss: 2.917 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.3920629024505615
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.924 Vali Acc: 0.284 Test Loss: 2.924 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.432294130325317
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.981 Vali Acc: 0.297 Test Loss: 2.981 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.414704084396362
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.988 Vali Acc: 0.284 Test Loss: 2.988 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.190284252166748
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.981 Vali Acc: 0.284 Test Loss: 2.981 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.285959005355835
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.979 Vali Acc: 0.284 Test Loss: 2.979 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.253380298614502
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.470 Vali Acc: 0.230 Test Loss: 1.470 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 4.340267658233643
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.934 Vali Acc: 0.149 Test Loss: 1.934 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.359986305236816
Epoch: 3, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.986 Vali Acc: 0.216 Test Loss: 1.986 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.611460447311401
Epoch: 4, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.909 Vali Acc: 0.351 Test Loss: 1.909 Test Acc: 0.351
Validation loss decreased (-0.229715 --> -0.351332).  Saving model ...
Epoch: 5 cost time: 4.6263556480407715
Epoch: 5, Steps: 10 | Train Loss: 0.392 Vali Loss: 2.074 Vali Acc: 0.243 Test Loss: 2.074 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.617366075515747
Epoch: 6, Steps: 10 | Train Loss: 0.319 Vali Loss: 2.151 Vali Acc: 0.257 Test Loss: 2.151 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.260880947113037
Epoch: 7, Steps: 10 | Train Loss: 0.219 Vali Loss: 2.535 Vali Acc: 0.216 Test Loss: 2.535 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.8990325927734375
Epoch: 8, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.518 Vali Acc: 0.311 Test Loss: 2.518 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.001235246658325
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 2.943 Vali Acc: 0.243 Test Loss: 2.943 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.508630990982056
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.870 Vali Acc: 0.230 Test Loss: 2.870 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.244816064834595
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.037 Vali Acc: 0.216 Test Loss: 3.037 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.6370673179626465
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.870 Vali Acc: 0.216 Test Loss: 2.870 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.445657968521118
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.818 Vali Acc: 0.270 Test Loss: 2.818 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.8576343059539795
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.720 Vali Acc: 0.216 Test Loss: 3.720 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.054585933685303
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.440 Vali Acc: 0.311 Test Loss: 1.440 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 4.1256139278411865
Epoch: 2, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.890 Vali Acc: 0.162 Test Loss: 1.890 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.140773296356201
Epoch: 3, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.678 Vali Acc: 0.216 Test Loss: 1.678 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7411930561065674
Epoch: 4, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.860 Vali Acc: 0.243 Test Loss: 1.860 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.143803119659424
Epoch: 5, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.823 Vali Acc: 0.230 Test Loss: 1.823 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.036510467529297
Epoch: 6, Steps: 10 | Train Loss: 0.095 Vali Loss: 2.065 Vali Acc: 0.297 Test Loss: 2.065 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.270724058151245
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.282 Vali Acc: 0.257 Test Loss: 2.282 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.170908689498901
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.506 Vali Acc: 0.230 Test Loss: 2.506 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.342186689376831
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.885 Vali Acc: 0.230 Test Loss: 2.885 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9050300121307373
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.638 Vali Acc: 0.338 Test Loss: 2.638 Test Acc: 0.338
Validation loss decreased (-0.310796 --> -0.337811).  Saving model ...
Epoch: 11 cost time: 4.017765045166016
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.812 Vali Acc: 0.176 Test Loss: 2.812 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.745875835418701
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.510 Vali Acc: 0.284 Test Loss: 2.510 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.045799970626831
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.104 Vali Acc: 0.189 Test Loss: 3.104 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.0592286586761475
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.328 Vali Acc: 0.311 Test Loss: 3.328 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.146022319793701
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.749 Vali Acc: 0.257 Test Loss: 2.749 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.825878858566284
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.898 Vali Acc: 0.230 Test Loss: 2.898 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.925687074661255
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.760 Vali Acc: 0.230 Test Loss: 2.760 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.800138235092163
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.729 Vali Acc: 0.230 Test Loss: 2.729 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7852797508239746
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.726 Vali Acc: 0.243 Test Loss: 2.726 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6639082431793213
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.736 Vali Acc: 0.230 Test Loss: 2.736 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.889851808547974
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 3.9455220699310303
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.736 Vali Acc: 0.189 Test Loss: 1.736 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.061046123504639
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.572 Vali Acc: 0.270 Test Loss: 1.572 Test Acc: 0.270
Validation loss decreased (-0.243228 --> -0.270255).  Saving model ...
Epoch: 4 cost time: 4.2853333950042725
Epoch: 4, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.699 Vali Acc: 0.311 Test Loss: 1.699 Test Acc: 0.311
Validation loss decreased (-0.270255 --> -0.310794).  Saving model ...
Epoch: 5 cost time: 4.417940378189087
Epoch: 5, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.630 Vali Acc: 0.324 Test Loss: 1.630 Test Acc: 0.324
Validation loss decreased (-0.310794 --> -0.324308).  Saving model ...
Epoch: 6 cost time: 4.2052083015441895
Epoch: 6, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.682 Vali Acc: 0.351 Test Loss: 1.682 Test Acc: 0.351
Validation loss decreased (-0.324308 --> -0.351335).  Saving model ...
Epoch: 7 cost time: 4.2544944286346436
Epoch: 7, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.902 Vali Acc: 0.243 Test Loss: 1.902 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.140825986862183
Epoch: 8, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.924 Vali Acc: 0.324 Test Loss: 1.924 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.330106019973755
Epoch: 9, Steps: 10 | Train Loss: 0.139 Vali Loss: 2.628 Vali Acc: 0.230 Test Loss: 2.628 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.540601491928101
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 2.703 Vali Acc: 0.351 Test Loss: 2.703 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.361793041229248
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.522 Vali Acc: 0.284 Test Loss: 2.522 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.532248258590698
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.697 Vali Acc: 0.311 Test Loss: 2.697 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.158033132553101
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.621 Vali Acc: 0.311 Test Loss: 2.621 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.284291505813599
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.888 Vali Acc: 0.338 Test Loss: 2.888 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.061371564865112
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.215 Vali Acc: 0.324 Test Loss: 3.215 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.252804279327393
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.972 Vali Acc: 0.365 Test Loss: 2.972 Test Acc: 0.365
Validation loss decreased (-0.351335 --> -0.364835).  Saving model ...
Epoch: 17 cost time: 4.149478197097778
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.299 Vali Acc: 0.311 Test Loss: 3.299 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.129444122314453
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.130 Vali Acc: 0.365 Test Loss: 3.130 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.139908313751221
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.178 Vali Acc: 0.351 Test Loss: 3.178 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.172286033630371
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.307 Vali Acc: 0.338 Test Loss: 3.307 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.238500356674194
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.299 Vali Acc: 0.338 Test Loss: 3.299 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.1443870067596436
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.210 Vali Acc: 0.351 Test Loss: 3.210 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.620887994766235
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.355 Vali Acc: 0.338 Test Loss: 3.355 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.178900241851807
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.409 Vali Acc: 0.338 Test Loss: 3.409 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.353525876998901
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.349 Vali Acc: 0.351 Test Loss: 3.349 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.40564751625061
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.419 Vali Acc: 0.351 Test Loss: 3.419 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.601499080657959
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.67606520652771
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.572 Vali Acc: 0.216 Test Loss: 1.572 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.709668874740601
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.545 Vali Acc: 0.297 Test Loss: 1.545 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297282).  Saving model ...
Epoch: 4 cost time: 4.788931369781494
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.591 Vali Acc: 0.351 Test Loss: 1.591 Test Acc: 0.351
Validation loss decreased (-0.297282 --> -0.351335).  Saving model ...
Epoch: 5 cost time: 4.088940382003784
Epoch: 5, Steps: 10 | Train Loss: 0.766 Vali Loss: 1.627 Vali Acc: 0.270 Test Loss: 1.627 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.313046455383301
Epoch: 6, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.589 Vali Acc: 0.297 Test Loss: 1.589 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.160046100616455
Epoch: 7, Steps: 10 | Train Loss: 0.406 Vali Loss: 2.418 Vali Acc: 0.162 Test Loss: 2.418 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.420274496078491
Epoch: 8, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.946 Vali Acc: 0.284 Test Loss: 1.946 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.153236389160156
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 2.130 Vali Acc: 0.324 Test Loss: 2.130 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.3696372509002686
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 2.260 Vali Acc: 0.365 Test Loss: 2.260 Test Acc: 0.365
Validation loss decreased (-0.351335 --> -0.364842).  Saving model ...
Epoch: 11 cost time: 3.9563682079315186
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.348 Vali Acc: 0.311 Test Loss: 2.348 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.457538366317749
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.722 Vali Acc: 0.324 Test Loss: 2.722 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.289130687713623
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.801 Vali Acc: 0.311 Test Loss: 2.801 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.618568420410156
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.162 Vali Acc: 0.230 Test Loss: 3.162 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.475870370864868
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.611 Vali Acc: 0.149 Test Loss: 3.611 Test Acc: 0.149
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.420011043548584
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.400 Vali Acc: 0.338 Test Loss: 3.400 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.396578788757324
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.531 Vali Acc: 0.297 Test Loss: 3.531 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.319425821304321
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.484 Vali Acc: 0.270 Test Loss: 3.484 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.7754130363464355
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.507 Vali Acc: 0.270 Test Loss: 3.507 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.434427976608276
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.609 Vali Acc: 0.270 Test Loss: 3.609 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 3444484
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.102199077606201
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.259 Vali Acc: 0.365 Test Loss: 1.259 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 4.380277633666992
Epoch: 2, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.244 Vali Acc: 0.486 Test Loss: 1.244 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 4.525752782821655
Epoch: 3, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.116 Vali Acc: 0.554 Test Loss: 1.116 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 3.813943862915039
Epoch: 4, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.071 Vali Acc: 0.554 Test Loss: 1.071 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 4.299948692321777
Epoch: 5, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.098 Vali Acc: 0.595 Test Loss: 1.098 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 4.127824306488037
Epoch: 6, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.017 Vali Acc: 0.581 Test Loss: 1.017 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.102904558181763
Epoch: 7, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.106 Vali Acc: 0.649 Test Loss: 1.106 Test Acc: 0.649
Validation loss decreased (-0.594584 --> -0.648638).  Saving model ...
Epoch: 8 cost time: 4.431683778762817
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.6366283893585205
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.232 Vali Acc: 0.608 Test Loss: 1.232 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.569050312042236
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.262 Vali Acc: 0.581 Test Loss: 1.262 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.463467359542847
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.172 Vali Acc: 0.608 Test Loss: 1.172 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.714810132980347
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.622 Test Loss: 1.133 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.663502931594849
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.608 Test Loss: 1.134 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.3474767208099365
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.608 Test Loss: 1.144 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.343169450759888
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.147 Vali Acc: 0.608 Test Loss: 1.147 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.925003528594971
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.608 Test Loss: 1.150 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.180347681045532
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.608 Test Loss: 1.139 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.031528949737549
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.257 Vali Acc: 0.419 Test Loss: 1.257 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 4.262681007385254
Epoch: 2, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.359 Vali Acc: 0.446 Test Loss: 1.359 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 4.371587753295898
Epoch: 3, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.262 Vali Acc: 0.514 Test Loss: 1.262 Test Acc: 0.514
Validation loss decreased (-0.445932 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 4.2095324993133545
Epoch: 4, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 4.018279552459717
Epoch: 5, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.124 Vali Acc: 0.595 Test Loss: 1.124 Test Acc: 0.595
Validation loss decreased (-0.540528 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 4.163185119628906
Epoch: 6, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.233 Vali Acc: 0.541 Test Loss: 1.233 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.285214424133301
Epoch: 7, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.479 Vali Acc: 0.608 Test Loss: 1.479 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608093).  Saving model ...
Epoch: 8 cost time: 4.1400229930877686
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.272 Vali Acc: 0.608 Test Loss: 1.272 Test Acc: 0.608
Validation loss decreased (-0.608093 --> -0.608095).  Saving model ...
Epoch: 9 cost time: 4.903287649154663
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.272 Vali Acc: 0.622 Test Loss: 1.272 Test Acc: 0.622
Validation loss decreased (-0.608095 --> -0.621609).  Saving model ...
Epoch: 10 cost time: 4.358029842376709
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.581 Test Loss: 1.311 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.318789958953857
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.595 Test Loss: 1.333 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.203039169311523
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.635 Test Loss: 1.328 Test Acc: 0.635
Validation loss decreased (-0.621609 --> -0.635122).  Saving model ...
Epoch: 13 cost time: 4.121357202529907
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.622 Test Loss: 1.298 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.335651874542236
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.622 Test Loss: 1.289 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.125040054321289
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.622 Test Loss: 1.306 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.044746160507202
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.608 Test Loss: 1.327 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.083783388137817
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.608 Test Loss: 1.321 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.093291997909546
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.622 Test Loss: 1.317 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.0365684032440186
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.622 Test Loss: 1.318 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.389062166213989
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.622 Test Loss: 1.320 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.184145927429199
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.622 Test Loss: 1.323 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.634230375289917
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.622 Test Loss: 1.333 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.5255045890808105
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.360 Vali Acc: 0.270 Test Loss: 1.360 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 4.3505449295043945
Epoch: 2, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.810 Vali Acc: 0.311 Test Loss: 1.810 Test Acc: 0.311
Validation loss decreased (-0.270257 --> -0.310793).  Saving model ...
Epoch: 3 cost time: 4.666996717453003
Epoch: 3, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.873 Vali Acc: 0.365 Test Loss: 1.873 Test Acc: 0.365
Validation loss decreased (-0.310793 --> -0.364846).  Saving model ...
Epoch: 4 cost time: 4.31990909576416
Epoch: 4, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.922 Vali Acc: 0.338 Test Loss: 1.922 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.9365763664245605
Epoch: 5, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.823 Vali Acc: 0.432 Test Loss: 1.823 Test Acc: 0.432
Validation loss decreased (-0.364846 --> -0.432414).  Saving model ...
Epoch: 6 cost time: 3.969419479370117
Epoch: 6, Steps: 10 | Train Loss: 0.047 Vali Loss: 2.124 Vali Acc: 0.419 Test Loss: 2.124 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.367040157318115
Epoch: 7, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.354 Vali Acc: 0.446 Test Loss: 2.354 Test Acc: 0.446
Validation loss decreased (-0.432414 --> -0.445922).  Saving model ...
Epoch: 8 cost time: 4.678420782089233
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.436 Vali Acc: 0.392 Test Loss: 2.436 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.798984050750732
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.575 Vali Acc: 0.432 Test Loss: 2.575 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.365298748016357
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.554 Vali Acc: 0.432 Test Loss: 2.554 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.628531455993652
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.572 Vali Acc: 0.392 Test Loss: 2.572 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.107408046722412
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.605 Vali Acc: 0.419 Test Loss: 2.605 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.368578672409058
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.609 Vali Acc: 0.419 Test Loss: 2.609 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.449124336242676
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.607 Vali Acc: 0.405 Test Loss: 2.607 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.125720739364624
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.613 Vali Acc: 0.419 Test Loss: 2.613 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.177692651748657
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.630 Vali Acc: 0.419 Test Loss: 2.630 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.124833583831787
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.636 Vali Acc: 0.405 Test Loss: 2.636 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.24192214012146
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.423 Vali Acc: 0.311 Test Loss: 1.423 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 3.9713587760925293
Epoch: 2, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.717 Vali Acc: 0.270 Test Loss: 1.717 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.311156749725342
Epoch: 3, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.976 Vali Acc: 0.284 Test Loss: 1.976 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9352383613586426
Epoch: 4, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.985 Vali Acc: 0.270 Test Loss: 1.985 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.471638441085815
Epoch: 5, Steps: 10 | Train Loss: 0.141 Vali Loss: 2.001 Vali Acc: 0.270 Test Loss: 2.001 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.0639331340789795
Epoch: 6, Steps: 10 | Train Loss: 0.085 Vali Loss: 2.030 Vali Acc: 0.297 Test Loss: 2.030 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.321948051452637
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.565 Vali Acc: 0.351 Test Loss: 2.565 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351326).  Saving model ...
Epoch: 8 cost time: 4.076488018035889
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.806 Vali Acc: 0.284 Test Loss: 2.806 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.297366619110107
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.829 Vali Acc: 0.297 Test Loss: 2.829 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.338634490966797
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.749 Vali Acc: 0.311 Test Loss: 2.749 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.995046854019165
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.024 Vali Acc: 0.338 Test Loss: 3.024 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8899383544921875
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.900 Vali Acc: 0.378 Test Loss: 2.900 Test Acc: 0.378
Validation loss decreased (-0.351326 --> -0.378349).  Saving model ...
Epoch: 13 cost time: 3.981710433959961
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.874 Vali Acc: 0.365 Test Loss: 2.874 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.13613224029541
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.960 Vali Acc: 0.378 Test Loss: 2.960 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.27070689201355
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.910 Vali Acc: 0.365 Test Loss: 2.910 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.016952753067017
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.872 Vali Acc: 0.365 Test Loss: 2.872 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.168452739715576
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.861 Vali Acc: 0.365 Test Loss: 2.861 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.177430152893066
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.869 Vali Acc: 0.351 Test Loss: 2.869 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.240342378616333
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.891 Vali Acc: 0.351 Test Loss: 2.891 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.156313896179199
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.898 Vali Acc: 0.351 Test Loss: 2.898 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.130476236343384
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.893 Vali Acc: 0.351 Test Loss: 2.893 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.181197881698608
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.351 Test Loss: 2.889 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.995779037475586
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.420 Vali Acc: 0.311 Test Loss: 1.420 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.265853404998779
Epoch: 2, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.790 Vali Acc: 0.297 Test Loss: 1.790 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4699671268463135
Epoch: 3, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.958 Vali Acc: 0.284 Test Loss: 1.958 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.409146785736084
Epoch: 4, Steps: 10 | Train Loss: 0.365 Vali Loss: 2.039 Vali Acc: 0.243 Test Loss: 2.039 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.119601249694824
Epoch: 5, Steps: 10 | Train Loss: 0.140 Vali Loss: 2.187 Vali Acc: 0.257 Test Loss: 2.187 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.7119245529174805
Epoch: 6, Steps: 10 | Train Loss: 0.060 Vali Loss: 2.270 Vali Acc: 0.297 Test Loss: 2.270 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.9705684185028076
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.461 Vali Acc: 0.351 Test Loss: 2.461 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351327).  Saving model ...
Epoch: 8 cost time: 4.655975580215454
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.812 Vali Acc: 0.365 Test Loss: 2.812 Test Acc: 0.365
Validation loss decreased (-0.351327 --> -0.364837).  Saving model ...
Epoch: 9 cost time: 4.373814582824707
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.046 Vali Acc: 0.230 Test Loss: 3.046 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0014097690582275
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.755 Vali Acc: 0.378 Test Loss: 2.755 Test Acc: 0.378
Validation loss decreased (-0.364837 --> -0.378351).  Saving model ...
Epoch: 11 cost time: 4.416205644607544
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.733 Vali Acc: 0.338 Test Loss: 2.733 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.246691465377808
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.977 Vali Acc: 0.297 Test Loss: 2.977 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.153380870819092
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.778 Vali Acc: 0.324 Test Loss: 2.778 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.633410692214966
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.768 Vali Acc: 0.378 Test Loss: 2.768 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.191788911819458
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.797 Vali Acc: 0.297 Test Loss: 2.797 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.440989017486572
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.836 Vali Acc: 0.324 Test Loss: 2.836 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.652866840362549
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.853 Vali Acc: 0.324 Test Loss: 2.853 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.703480243682861
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.854 Vali Acc: 0.311 Test Loss: 2.854 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.589126825332642
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.864 Vali Acc: 0.311 Test Loss: 2.864 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.281850814819336
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.866 Vali Acc: 0.311 Test Loss: 2.866 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.814685344696045
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.413 Vali Acc: 0.284 Test Loss: 1.413 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 4.12263035774231
Epoch: 2, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.790 Vali Acc: 0.203 Test Loss: 1.790 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.472519874572754
Epoch: 3, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.934 Vali Acc: 0.203 Test Loss: 1.934 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.57694935798645
Epoch: 4, Steps: 10 | Train Loss: 0.325 Vali Loss: 2.332 Vali Acc: 0.149 Test Loss: 2.332 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.016115188598633
Epoch: 5, Steps: 10 | Train Loss: 0.149 Vali Loss: 2.303 Vali Acc: 0.257 Test Loss: 2.303 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.483911752700806
Epoch: 6, Steps: 10 | Train Loss: 0.076 Vali Loss: 2.243 Vali Acc: 0.338 Test Loss: 2.243 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337815).  Saving model ...
Epoch: 7 cost time: 4.491990566253662
Epoch: 7, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.506 Vali Acc: 0.405 Test Loss: 2.506 Test Acc: 0.405
Validation loss decreased (-0.337815 --> -0.405380).  Saving model ...
Epoch: 8 cost time: 4.297652959823608
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.637 Vali Acc: 0.243 Test Loss: 2.637 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.959835529327393
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.611 Vali Acc: 0.338 Test Loss: 2.611 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.478203535079956
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.857 Vali Acc: 0.257 Test Loss: 2.857 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.423098564147949
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.762 Vali Acc: 0.270 Test Loss: 2.762 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.859149694442749
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.754 Vali Acc: 0.338 Test Loss: 2.754 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.765640735626221
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.826 Vali Acc: 0.324 Test Loss: 2.826 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.39499044418335
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.840 Vali Acc: 0.324 Test Loss: 2.840 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.918091058731079
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.846 Vali Acc: 0.324 Test Loss: 2.846 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.282538890838623
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.862 Vali Acc: 0.324 Test Loss: 2.862 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.071571588516235
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.883 Vali Acc: 0.324 Test Loss: 2.883 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.177535772323608
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.478 Vali Acc: 0.311 Test Loss: 1.478 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 4.283519506454468
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.817 Vali Acc: 0.243 Test Loss: 1.817 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.453211545944214
Epoch: 3, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.850 Vali Acc: 0.176 Test Loss: 1.850 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.9643285274505615
Epoch: 4, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.800 Vali Acc: 0.216 Test Loss: 1.800 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.330349683761597
Epoch: 5, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.681 Vali Acc: 0.297 Test Loss: 1.681 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.266406774520874
Epoch: 6, Steps: 10 | Train Loss: 0.239 Vali Loss: 2.078 Vali Acc: 0.176 Test Loss: 2.078 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.827448129653931
Epoch: 7, Steps: 10 | Train Loss: 0.126 Vali Loss: 2.136 Vali Acc: 0.216 Test Loss: 2.136 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.278855562210083
Epoch: 8, Steps: 10 | Train Loss: 0.072 Vali Loss: 2.010 Vali Acc: 0.351 Test Loss: 2.010 Test Acc: 0.351
Validation loss decreased (-0.310796 --> -0.351331).  Saving model ...
Epoch: 9 cost time: 4.643419504165649
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.656 Vali Acc: 0.243 Test Loss: 2.656 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.831701278686523
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.565 Vali Acc: 0.338 Test Loss: 2.565 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.639866590499878
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.868 Vali Acc: 0.311 Test Loss: 2.868 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.6584367752075195
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.128 Vali Acc: 0.230 Test Loss: 3.128 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.6420135498046875
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.756 Vali Acc: 0.297 Test Loss: 2.756 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.612933158874512
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.935 Vali Acc: 0.270 Test Loss: 2.935 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.266070365905762
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.840 Vali Acc: 0.243 Test Loss: 2.840 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.3944947719573975
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.917 Vali Acc: 0.243 Test Loss: 2.917 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.300783634185791
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.878 Vali Acc: 0.243 Test Loss: 2.878 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.4064600467681885
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.844 Vali Acc: 0.230 Test Loss: 2.844 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.968891620635986
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.440 Vali Acc: 0.230 Test Loss: 1.440 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 4.301198482513428
Epoch: 2, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.784 Vali Acc: 0.216 Test Loss: 1.784 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.194121599197388
Epoch: 3, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.834 Vali Acc: 0.149 Test Loss: 1.834 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.3011415004730225
Epoch: 4, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.848 Vali Acc: 0.230 Test Loss: 1.848 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.271177053451538
Epoch: 5, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.767 Vali Acc: 0.230 Test Loss: 1.767 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.42361044883728
Epoch: 6, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.939 Vali Acc: 0.243 Test Loss: 1.939 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243224).  Saving model ...
Epoch: 7 cost time: 3.9647464752197266
Epoch: 7, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.103 Vali Acc: 0.270 Test Loss: 2.103 Test Acc: 0.270
Validation loss decreased (-0.243224 --> -0.270249).  Saving model ...
Epoch: 8 cost time: 4.215933322906494
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.212 Vali Acc: 0.257 Test Loss: 2.212 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.3133203983306885
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.825 Vali Acc: 0.189 Test Loss: 2.825 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.036003828048706
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.409 Vali Acc: 0.257 Test Loss: 2.409 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.0434277057647705
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.371 Vali Acc: 0.257 Test Loss: 2.371 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.773557186126709
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.537 Vali Acc: 0.230 Test Loss: 2.537 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9276506900787354
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.380 Vali Acc: 0.230 Test Loss: 2.380 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.081756353378296
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.397 Vali Acc: 0.257 Test Loss: 2.397 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.211251974105835
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.450 Vali Acc: 0.257 Test Loss: 2.450 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.0523903369903564
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.479 Vali Acc: 0.243 Test Loss: 2.479 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.269134521484375
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.444 Vali Acc: 0.230 Test Loss: 2.444 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.2702702702702703
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.918640375137329
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.399 Vali Acc: 0.297 Test Loss: 1.399 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 5.038580894470215
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.635 Vali Acc: 0.230 Test Loss: 1.635 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.331003665924072
Epoch: 3, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.567 Vali Acc: 0.243 Test Loss: 1.567 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.230310916900635
Epoch: 4, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.500 Vali Acc: 0.243 Test Loss: 1.500 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.695157051086426
Epoch: 5, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.574 Vali Acc: 0.243 Test Loss: 1.574 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.433678865432739
Epoch: 6, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.614 Vali Acc: 0.216 Test Loss: 1.614 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.213253021240234
Epoch: 7, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.738 Vali Acc: 0.297 Test Loss: 1.738 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.47109580039978
Epoch: 8, Steps: 10 | Train Loss: 0.184 Vali Loss: 2.034 Vali Acc: 0.297 Test Loss: 2.034 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.274468660354614
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 2.067 Vali Acc: 0.324 Test Loss: 2.067 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324304).  Saving model ...
Epoch: 10 cost time: 4.441909074783325
Epoch: 10, Steps: 10 | Train Loss: 0.058 Vali Loss: 2.379 Vali Acc: 0.311 Test Loss: 2.379 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.344213247299194
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.583 Vali Acc: 0.284 Test Loss: 2.583 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.264117479324341
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.523 Vali Acc: 0.351 Test Loss: 2.523 Test Acc: 0.351
Validation loss decreased (-0.324304 --> -0.351326).  Saving model ...
Epoch: 13 cost time: 4.220613718032837
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.740 Vali Acc: 0.311 Test Loss: 2.740 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9739906787872314
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.844 Vali Acc: 0.338 Test Loss: 2.844 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.132304668426514
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.857 Vali Acc: 0.311 Test Loss: 2.857 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.315160274505615
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.979 Vali Acc: 0.297 Test Loss: 2.979 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.204508304595947
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.993 Vali Acc: 0.338 Test Loss: 2.993 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.004059553146362
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.120 Vali Acc: 0.297 Test Loss: 3.120 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.0865607261657715
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.109 Vali Acc: 0.311 Test Loss: 3.109 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.996856451034546
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.114 Vali Acc: 0.311 Test Loss: 3.114 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.295971393585205
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.230 Vali Acc: 0.297 Test Loss: 3.230 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.0286595821380615
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.240 Vali Acc: 0.324 Test Loss: 3.240 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.364595413208008
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.402 Vali Acc: 0.270 Test Loss: 1.402 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.283108711242676
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.546 Vali Acc: 0.230 Test Loss: 1.546 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.367523431777954
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.543 Vali Acc: 0.284 Test Loss: 1.543 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283768).  Saving model ...
Epoch: 4 cost time: 4.400826692581177
Epoch: 4, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.35841178894043
Epoch: 5, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.527 Vali Acc: 0.338 Test Loss: 1.527 Test Acc: 0.338
Validation loss decreased (-0.283768 --> -0.337823).  Saving model ...
Epoch: 6 cost time: 4.401679277420044
Epoch: 6, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.586 Vali Acc: 0.311 Test Loss: 1.586 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.030077695846558
Epoch: 7, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.715 Vali Acc: 0.311 Test Loss: 1.715 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.152261018753052
Epoch: 8, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.877 Vali Acc: 0.378 Test Loss: 1.877 Test Acc: 0.378
Validation loss decreased (-0.337823 --> -0.378360).  Saving model ...
Epoch: 9 cost time: 3.677694082260132
Epoch: 9, Steps: 10 | Train Loss: 0.232 Vali Loss: 2.055 Vali Acc: 0.351 Test Loss: 2.055 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.822105646133423
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 2.029 Vali Acc: 0.365 Test Loss: 2.029 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.380417346954346
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.366 Vali Acc: 0.311 Test Loss: 2.366 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.277134418487549
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 2.330 Vali Acc: 0.297 Test Loss: 2.330 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.349018812179565
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.636 Vali Acc: 0.297 Test Loss: 2.636 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.344639539718628
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.923 Vali Acc: 0.338 Test Loss: 2.923 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.217115640640259
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.703 Vali Acc: 0.311 Test Loss: 3.703 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.548064947128296
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.256 Vali Acc: 0.284 Test Loss: 3.256 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.282854795455933
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.913 Vali Acc: 0.311 Test Loss: 3.913 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.1113440990448
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.729 Vali Acc: 0.311 Test Loss: 3.729 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 3247876
model size : 22.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.351271390914917
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.356 Vali Acc: 0.297 Test Loss: 1.356 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 4.33693528175354
Epoch: 2, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.168 Vali Acc: 0.554 Test Loss: 1.168 Test Acc: 0.554
Validation loss decreased (-0.297284 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 4.000058650970459
Epoch: 3, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 4.236913681030273
Epoch: 4, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.985 Vali Acc: 0.541 Test Loss: 0.985 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.251352787017822
Epoch: 5, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.132 Vali Acc: 0.554 Test Loss: 1.132 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.238297462463379
Epoch: 6, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.788 Vali Acc: 0.649 Test Loss: 0.788 Test Acc: 0.649
Validation loss decreased (-0.554043 --> -0.648641).  Saving model ...
Epoch: 7 cost time: 4.417842388153076
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.824 Vali Acc: 0.703 Test Loss: 0.824 Test Acc: 0.703
Validation loss decreased (-0.648641 --> -0.702694).  Saving model ...
Epoch: 8 cost time: 4.052627325057983
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.764 Vali Acc: 0.662 Test Loss: 0.764 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.6663923263549805
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.676 Test Loss: 0.814 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.17503809928894
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.857 Vali Acc: 0.716 Test Loss: 0.857 Test Acc: 0.716
Validation loss decreased (-0.702694 --> -0.716208).  Saving model ...
Epoch: 11 cost time: 4.07106876373291
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.689 Test Loss: 0.812 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.41209864616394
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.703 Test Loss: 0.821 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.421218633651733
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.689 Test Loss: 0.838 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.709711790084839
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.703 Test Loss: 0.850 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.500102519989014
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.703 Test Loss: 0.844 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.497922420501709
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.689 Test Loss: 0.843 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.918014764785767
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.703 Test Loss: 0.852 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.517432689666748
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.689 Test Loss: 0.853 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.556460618972778
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.703 Test Loss: 0.855 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.476257801055908
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.703 Test Loss: 0.854 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7162162162162162
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.093868017196655
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.353 Vali Acc: 0.270 Test Loss: 1.353 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 4.312519073486328
Epoch: 2, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
Validation loss decreased (-0.270257 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 4.361554145812988
Epoch: 3, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.420392036437988
Epoch: 4, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.049 Vali Acc: 0.527 Test Loss: 1.049 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527017).  Saving model ...
Epoch: 5 cost time: 4.1318066120147705
Epoch: 5, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.116 Vali Acc: 0.581 Test Loss: 1.116 Test Acc: 0.581
Validation loss decreased (-0.527017 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 4.414156198501587
Epoch: 6, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.883 Vali Acc: 0.635 Test Loss: 0.883 Test Acc: 0.635
Validation loss decreased (-0.581070 --> -0.635126).  Saving model ...
Epoch: 7 cost time: 4.00062894821167
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.900 Vali Acc: 0.635 Test Loss: 0.900 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.545389890670776
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.881 Vali Acc: 0.649 Test Loss: 0.881 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648640).  Saving model ...
Epoch: 9 cost time: 4.201647996902466
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.915 Vali Acc: 0.622 Test Loss: 0.915 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.244865894317627
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.622 Test Loss: 0.958 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.788294076919556
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.635 Test Loss: 0.923 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.44334602355957
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.478032350540161
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.941 Vali Acc: 0.635 Test Loss: 0.941 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.82391881942749
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.635 Test Loss: 0.950 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.56348180770874
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.649 Test Loss: 0.943 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.866725921630859
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.649 Test Loss: 0.944 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.224406480789185
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.649 Test Loss: 0.952 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.609429597854614
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.649 Test Loss: 0.954 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.1425511837005615
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.413 Vali Acc: 0.230 Test Loss: 1.413 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 4.264571905136108
Epoch: 2, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.405 Vali Acc: 0.378 Test Loss: 1.405 Test Acc: 0.378
Validation loss decreased (-0.229716 --> -0.378364).  Saving model ...
Epoch: 3 cost time: 4.3300089836120605
Epoch: 3, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.499 Vali Acc: 0.338 Test Loss: 1.499 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.414820194244385
Epoch: 4, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.470 Vali Acc: 0.378 Test Loss: 1.470 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.062742471694946
Epoch: 5, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.687 Vali Acc: 0.351 Test Loss: 1.687 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.2188169956207275
Epoch: 6, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.583 Vali Acc: 0.392 Test Loss: 1.583 Test Acc: 0.392
Validation loss decreased (-0.378364 --> -0.391876).  Saving model ...
Epoch: 7 cost time: 4.423590660095215
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.800 Vali Acc: 0.365 Test Loss: 1.800 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.2827324867248535
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.905 Vali Acc: 0.392 Test Loss: 1.905 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.809892892837524
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.974 Vali Acc: 0.378 Test Loss: 1.974 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.324475049972534
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.054 Vali Acc: 0.405 Test Loss: 2.054 Test Acc: 0.405
Validation loss decreased (-0.391876 --> -0.405385).  Saving model ...
Epoch: 11 cost time: 5.481513261795044
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.018 Vali Acc: 0.392 Test Loss: 2.018 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.693674087524414
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.048 Vali Acc: 0.392 Test Loss: 2.048 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.602047443389893
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.069 Vali Acc: 0.405 Test Loss: 2.069 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.540747404098511
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.082 Vali Acc: 0.392 Test Loss: 2.082 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.876620769500732
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.083 Vali Acc: 0.392 Test Loss: 2.083 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.48833155632019
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.088 Vali Acc: 0.392 Test Loss: 2.088 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.341912508010864
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.117 Vali Acc: 0.392 Test Loss: 2.117 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.779700994491577
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.123 Vali Acc: 0.392 Test Loss: 2.123 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.62915563583374
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.135 Vali Acc: 0.392 Test Loss: 2.135 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.0953309535980225
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.137 Vali Acc: 0.392 Test Loss: 2.137 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.073875427246094
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.470 Vali Acc: 0.203 Test Loss: 1.470 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 4.203614711761475
Epoch: 2, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.462 Vali Acc: 0.365 Test Loss: 1.462 Test Acc: 0.365
Validation loss decreased (-0.202688 --> -0.364850).  Saving model ...
Epoch: 3 cost time: 4.18491792678833
Epoch: 3, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.491 Vali Acc: 0.203 Test Loss: 1.491 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.724358320236206
Epoch: 4, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.488 Vali Acc: 0.351 Test Loss: 1.488 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.574554920196533
Epoch: 5, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.677 Vali Acc: 0.351 Test Loss: 1.677 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.369413614273071
Epoch: 6, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.636 Vali Acc: 0.338 Test Loss: 1.636 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.436647415161133
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.977 Vali Acc: 0.284 Test Loss: 1.977 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.088576316833496
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.890 Vali Acc: 0.351 Test Loss: 1.890 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.700514554977417
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.977 Vali Acc: 0.311 Test Loss: 1.977 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.590211629867554
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.980 Vali Acc: 0.338 Test Loss: 1.980 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.786545038223267
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.016 Vali Acc: 0.378 Test Loss: 2.016 Test Acc: 0.378
Validation loss decreased (-0.364850 --> -0.378358).  Saving model ...
Epoch: 12 cost time: 4.514503717422485
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.037 Vali Acc: 0.365 Test Loss: 2.037 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.157021760940552
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.056 Vali Acc: 0.351 Test Loss: 2.056 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.289741516113281
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.082 Vali Acc: 0.378 Test Loss: 2.082 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.842007637023926
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.089 Vali Acc: 0.378 Test Loss: 2.089 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.106399774551392
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.104 Vali Acc: 0.351 Test Loss: 2.104 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.109233140945435
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.128 Vali Acc: 0.392 Test Loss: 2.128 Test Acc: 0.392
Validation loss decreased (-0.378358 --> -0.391871).  Saving model ...
Epoch: 18 cost time: 4.334232568740845
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.135 Vali Acc: 0.378 Test Loss: 2.135 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.421823978424072
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.147 Vali Acc: 0.378 Test Loss: 2.147 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7478299140930176
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.159 Vali Acc: 0.378 Test Loss: 2.159 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.688530445098877
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.167 Vali Acc: 0.378 Test Loss: 2.167 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.535429954528809
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.178 Vali Acc: 0.378 Test Loss: 2.178 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.035333633422852
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.189 Vali Acc: 0.378 Test Loss: 2.189 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.5654191970825195
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.202 Vali Acc: 0.378 Test Loss: 2.202 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.645873308181763
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.209 Vali Acc: 0.378 Test Loss: 2.209 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.306782245635986
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.222 Vali Acc: 0.378 Test Loss: 2.222 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.733668565750122
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.234 Vali Acc: 0.392 Test Loss: 2.234 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.94293999671936
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.430 Vali Acc: 0.203 Test Loss: 1.430 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 4.115631103515625
Epoch: 2, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.464 Vali Acc: 0.297 Test Loss: 1.464 Test Acc: 0.297
Validation loss decreased (-0.202688 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 4.242520809173584
Epoch: 3, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.497 Vali Acc: 0.324 Test Loss: 1.497 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324309).  Saving model ...
Epoch: 4 cost time: 4.326281547546387
Epoch: 4, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.563 Vali Acc: 0.311 Test Loss: 1.563 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.280690670013428
Epoch: 5, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.928 Vali Acc: 0.243 Test Loss: 1.928 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.458873271942139
Epoch: 6, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.890 Vali Acc: 0.378 Test Loss: 1.890 Test Acc: 0.378
Validation loss decreased (-0.324309 --> -0.378359).  Saving model ...
Epoch: 7 cost time: 4.04693603515625
Epoch: 7, Steps: 10 | Train Loss: 0.065 Vali Loss: 2.018 Vali Acc: 0.270 Test Loss: 2.018 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.558907747268677
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.998 Vali Acc: 0.338 Test Loss: 1.998 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.316047668457031
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.035 Vali Acc: 0.338 Test Loss: 2.035 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.323117017745972
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.066 Vali Acc: 0.297 Test Loss: 2.066 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.010938405990601
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.162 Vali Acc: 0.338 Test Loss: 2.162 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.742157936096191
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.170 Vali Acc: 0.324 Test Loss: 2.170 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.447848081588745
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.201 Vali Acc: 0.324 Test Loss: 2.201 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.169095039367676
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.245 Vali Acc: 0.311 Test Loss: 2.245 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.540746212005615
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.263 Vali Acc: 0.324 Test Loss: 2.263 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.152628183364868
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.284 Vali Acc: 0.324 Test Loss: 2.284 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.894877195358276
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.458 Vali Acc: 0.216 Test Loss: 1.458 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.191466808319092
Epoch: 2, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.499 Vali Acc: 0.270 Test Loss: 1.499 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270255).  Saving model ...
Epoch: 3 cost time: 4.459585189819336
Epoch: 3, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.569 Vali Acc: 0.189 Test Loss: 1.569 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.284982919692993
Epoch: 4, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.610 Vali Acc: 0.311 Test Loss: 1.610 Test Acc: 0.311
Validation loss decreased (-0.270255 --> -0.310795).  Saving model ...
Epoch: 5 cost time: 4.19286584854126
Epoch: 5, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.960 Vali Acc: 0.216 Test Loss: 1.960 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.235078573226929
Epoch: 6, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.894 Vali Acc: 0.311 Test Loss: 1.894 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.0019776821136475
Epoch: 7, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.979 Vali Acc: 0.257 Test Loss: 1.979 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.167962312698364
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.261 Vali Acc: 0.311 Test Loss: 2.261 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.708072900772095
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.256 Vali Acc: 0.257 Test Loss: 2.256 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.732362270355225
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.341 Vali Acc: 0.297 Test Loss: 2.341 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.502994537353516
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.362 Vali Acc: 0.270 Test Loss: 2.362 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.1548871994018555
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.371 Vali Acc: 0.311 Test Loss: 2.371 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.278012037277222
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.416 Vali Acc: 0.270 Test Loss: 2.416 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.435023546218872
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.455 Vali Acc: 0.297 Test Loss: 2.455 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.177006006240845
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.415 Vali Acc: 0.257 Test Loss: 1.415 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.312662124633789
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.521 Vali Acc: 0.149 Test Loss: 1.521 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.423599481582642
Epoch: 3, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.553 Vali Acc: 0.230 Test Loss: 1.553 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.276075124740601
Epoch: 4, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.500 Vali Acc: 0.324 Test Loss: 1.500 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324309).  Saving model ...
Epoch: 5 cost time: 4.3482701778411865
Epoch: 5, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.848 Vali Acc: 0.203 Test Loss: 1.848 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.138488054275513
Epoch: 6, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.806 Vali Acc: 0.243 Test Loss: 1.806 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.253316640853882
Epoch: 7, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.751 Vali Acc: 0.230 Test Loss: 1.751 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.4522669315338135
Epoch: 8, Steps: 10 | Train Loss: 0.117 Vali Loss: 2.306 Vali Acc: 0.230 Test Loss: 2.306 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.494756460189819
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.325 Vali Acc: 0.230 Test Loss: 2.325 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.468466520309448
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.141 Vali Acc: 0.284 Test Loss: 2.141 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.874764442443848
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.715 Vali Acc: 0.243 Test Loss: 2.715 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.040966987609863
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.366 Vali Acc: 0.230 Test Loss: 2.366 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.263939619064331
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.417 Vali Acc: 0.216 Test Loss: 2.417 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.692230939865112
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.522 Vali Acc: 0.243 Test Loss: 2.522 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.914888620376587
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.374 Vali Acc: 0.297 Test Loss: 1.374 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 4.6128058433532715
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.490 Vali Acc: 0.311 Test Loss: 1.490 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310796).  Saving model ...
Epoch: 3 cost time: 4.827200174331665
Epoch: 3, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.472 Vali Acc: 0.216 Test Loss: 1.472 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.120302677154541
Epoch: 4, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.445 Vali Acc: 0.297 Test Loss: 1.445 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.456480979919434
Epoch: 5, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.724 Vali Acc: 0.257 Test Loss: 1.724 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.236732482910156
Epoch: 6, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.707 Vali Acc: 0.311 Test Loss: 1.707 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.239866733551025
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.712 Vali Acc: 0.311 Test Loss: 1.712 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.003166437149048
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.767 Vali Acc: 0.338 Test Loss: 1.767 Test Acc: 0.338
Validation loss decreased (-0.310796 --> -0.337820).  Saving model ...
Epoch: 9 cost time: 4.109863042831421
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.883 Vali Acc: 0.284 Test Loss: 1.883 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.258689880371094
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.885 Vali Acc: 0.324 Test Loss: 1.885 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.448367595672607
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.917 Vali Acc: 0.324 Test Loss: 1.917 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.666357755661011
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.961 Vali Acc: 0.324 Test Loss: 1.961 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.324054956436157
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.010 Vali Acc: 0.311 Test Loss: 2.010 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.589466333389282
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.004 Vali Acc: 0.311 Test Loss: 2.004 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.566706418991089
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.008 Vali Acc: 0.311 Test Loss: 2.008 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.790888786315918
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.031 Vali Acc: 0.324 Test Loss: 2.031 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.231172800064087
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.048 Vali Acc: 0.324 Test Loss: 2.048 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.671891450881958
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.064 Vali Acc: 0.311 Test Loss: 2.064 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.176426410675049
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.414 Vali Acc: 0.243 Test Loss: 1.414 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.341352701187134
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.468 Vali Acc: 0.243 Test Loss: 1.468 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.479689359664917
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.430 Vali Acc: 0.270 Test Loss: 1.430 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 4.314525842666626
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.454 Vali Acc: 0.311 Test Loss: 1.454 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310796).  Saving model ...
Epoch: 5 cost time: 4.005288124084473
Epoch: 5, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.607 Vali Acc: 0.230 Test Loss: 1.607 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1447837352752686
Epoch: 6, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.484 Vali Acc: 0.311 Test Loss: 1.484 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.137516975402832
Epoch: 7, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.730 Vali Acc: 0.189 Test Loss: 1.730 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.23714017868042
Epoch: 8, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.644 Vali Acc: 0.257 Test Loss: 1.644 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.306533336639404
Epoch: 9, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.944 Vali Acc: 0.270 Test Loss: 1.944 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.435013771057129
Epoch: 10, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.699 Vali Acc: 0.324 Test Loss: 1.699 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324307).  Saving model ...
Epoch: 11 cost time: 4.181124210357666
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.774 Vali Acc: 0.284 Test Loss: 1.774 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.304810047149658
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.926 Vali Acc: 0.284 Test Loss: 1.926 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.6231019496917725
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.179 Vali Acc: 0.311 Test Loss: 2.179 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.487919569015503
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.036 Vali Acc: 0.297 Test Loss: 2.036 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.121599912643433
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.191 Vali Acc: 0.257 Test Loss: 2.191 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.547925710678101
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.165 Vali Acc: 0.230 Test Loss: 2.165 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.415601491928101
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.156 Vali Acc: 0.270 Test Loss: 2.156 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.392653465270996
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.166 Vali Acc: 0.270 Test Loss: 2.166 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.113350868225098
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.232 Vali Acc: 0.270 Test Loss: 2.232 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.315275192260742
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.229 Vali Acc: 0.230 Test Loss: 2.229 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.774211406707764
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.385 Vali Acc: 0.311 Test Loss: 1.385 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.202739953994751
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.443 Vali Acc: 0.338 Test Loss: 1.443 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337823).  Saving model ...
Epoch: 3 cost time: 4.027998447418213
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.394 Vali Acc: 0.324 Test Loss: 1.394 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.200307369232178
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.446 Vali Acc: 0.324 Test Loss: 1.446 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.08599591255188
Epoch: 5, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.517 Vali Acc: 0.270 Test Loss: 1.517 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.366306781768799
Epoch: 6, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.423 Vali Acc: 0.351 Test Loss: 1.423 Test Acc: 0.351
Validation loss decreased (-0.337823 --> -0.351337).  Saving model ...
Epoch: 7 cost time: 4.264772891998291
Epoch: 7, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.727 Vali Acc: 0.149 Test Loss: 1.727 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3401312828063965
Epoch: 8, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.869 Vali Acc: 0.284 Test Loss: 1.869 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9581098556518555
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.752 Vali Acc: 0.243 Test Loss: 1.752 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.980783700942993
Epoch: 10, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.685 Vali Acc: 0.284 Test Loss: 1.685 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.243054389953613
Epoch: 11, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.668 Vali Acc: 0.284 Test Loss: 1.668 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.146014213562012
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 2.121 Vali Acc: 0.297 Test Loss: 2.121 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9652514457702637
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 2.442 Vali Acc: 0.311 Test Loss: 2.442 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.061095952987671
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 2.318 Vali Acc: 0.338 Test Loss: 2.318 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.318614482879639
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 2.293 Vali Acc: 0.338 Test Loss: 2.293 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.286859750747681
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.887 Vali Acc: 0.257 Test Loss: 2.887 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 2443140
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.9778454303741455
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.294 Vali Acc: 0.419 Test Loss: 1.294 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 4.088490009307861
Epoch: 2, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.282 Vali Acc: 0.446 Test Loss: 1.282 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 4.251128673553467
Epoch: 3, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.061 Vali Acc: 0.473 Test Loss: 1.061 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472962).  Saving model ...
Epoch: 4 cost time: 3.962092876434326
Epoch: 4, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.977 Vali Acc: 0.568 Test Loss: 0.977 Test Acc: 0.568
Validation loss decreased (-0.472962 --> -0.567558).  Saving model ...
Epoch: 5 cost time: 3.9240362644195557
Epoch: 5, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.891 Vali Acc: 0.608 Test Loss: 0.891 Test Acc: 0.608
Validation loss decreased (-0.567558 --> -0.608099).  Saving model ...
Epoch: 6 cost time: 3.987653970718384
Epoch: 6, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.968 Vali Acc: 0.662 Test Loss: 0.968 Test Acc: 0.662
Validation loss decreased (-0.608099 --> -0.662152).  Saving model ...
Epoch: 7 cost time: 4.19249701499939
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.840 Vali Acc: 0.608 Test Loss: 0.840 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3014373779296875
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.944 Vali Acc: 0.608 Test Loss: 0.944 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.361770391464233
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.833 Vali Acc: 0.635 Test Loss: 0.833 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.20428991317749
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.622 Test Loss: 0.843 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.214438438415527
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.635 Test Loss: 0.936 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.7150092124938965
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.890 Vali Acc: 0.676 Test Loss: 0.890 Test Acc: 0.676
Validation loss decreased (-0.662152 --> -0.675667).  Saving model ...
Epoch: 13 cost time: 4.440173387527466
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.676 Test Loss: 0.854 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 14 cost time: 4.437102317810059
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.676 Test Loss: 0.857 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.824277877807617
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.662 Test Loss: 0.884 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.493746757507324
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.662 Test Loss: 0.894 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.643917083740234
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.890 Vali Acc: 0.676 Test Loss: 0.890 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.082178831100464
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.676 Test Loss: 0.883 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.311797857284546
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.662 Test Loss: 0.891 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.343068599700928
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.901 Vali Acc: 0.662 Test Loss: 0.901 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.393320798873901
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.676 Test Loss: 0.902 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.779676914215088
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.676 Test Loss: 0.893 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.077856540679932
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.662 Test Loss: 0.902 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.07704758644104
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.308 Vali Acc: 0.392 Test Loss: 1.308 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 4.12547492980957
Epoch: 2, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.295 Vali Acc: 0.432 Test Loss: 1.295 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 4.151991605758667
Epoch: 3, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.139 Vali Acc: 0.473 Test Loss: 1.139 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472962).  Saving model ...
Epoch: 4 cost time: 4.5423829555511475
Epoch: 4, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.472962 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 4.502512454986572
Epoch: 5, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.995 Vali Acc: 0.622 Test Loss: 0.995 Test Acc: 0.622
Validation loss decreased (-0.540530 --> -0.621612).  Saving model ...
Epoch: 6 cost time: 4.030818462371826
Epoch: 6, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.132 Vali Acc: 0.568 Test Loss: 1.132 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.230206489562988
Epoch: 7, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.405565977096558
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.022 Vali Acc: 0.622 Test Loss: 1.022 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.503398656845093
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.635 Test Loss: 1.025 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 10 cost time: 4.07073974609375
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.622 Test Loss: 1.014 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.217577219009399
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.075 Vali Acc: 0.622 Test Loss: 1.075 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.736048698425293
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.026 Vali Acc: 0.622 Test Loss: 1.026 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.318796873092651
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.012 Vali Acc: 0.635 Test Loss: 1.012 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 4.5804548263549805
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.635 Test Loss: 1.022 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.306020259857178
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.056377172470093
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.88258695602417
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.649 Test Loss: 1.048 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 18 cost time: 4.296067714691162
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.649 Test Loss: 1.041 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 19 cost time: 4.5078935623168945
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.053 Vali Acc: 0.635 Test Loss: 1.053 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.414406776428223
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.622 Test Loss: 1.059 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.573348522186279
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.067 Vali Acc: 0.649 Test Loss: 1.067 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.6425769329071045
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.058 Vali Acc: 0.649 Test Loss: 1.058 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.82180380821228
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.071 Vali Acc: 0.635 Test Loss: 1.071 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.184284687042236
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.081 Vali Acc: 0.635 Test Loss: 1.081 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.281572341918945
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.635 Test Loss: 1.082 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.9674911499023438
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.635 Test Loss: 1.089 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.237632989883423
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.086 Vali Acc: 0.635 Test Loss: 1.086 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.332620620727539
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.086 Vali Acc: 0.635 Test Loss: 1.086 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.498924493789673
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.203439712524414
Epoch: 2, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.480 Vali Acc: 0.284 Test Loss: 1.480 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 4.273332595825195
Epoch: 3, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.466 Vali Acc: 0.338 Test Loss: 1.466 Test Acc: 0.338
Validation loss decreased (-0.283769 --> -0.337823).  Saving model ...
Epoch: 4 cost time: 4.463442325592041
Epoch: 4, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.581 Vali Acc: 0.378 Test Loss: 1.581 Test Acc: 0.378
Validation loss decreased (-0.337823 --> -0.378363).  Saving model ...
Epoch: 5 cost time: 4.18713641166687
Epoch: 5, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.568 Vali Acc: 0.365 Test Loss: 1.568 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.966821670532227
Epoch: 6, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.730 Vali Acc: 0.392 Test Loss: 1.730 Test Acc: 0.392
Validation loss decreased (-0.378363 --> -0.391875).  Saving model ...
Epoch: 7 cost time: 4.331402540206909
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.901 Vali Acc: 0.365 Test Loss: 1.901 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.123394727706909
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.970 Vali Acc: 0.378 Test Loss: 1.970 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6739182472229
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.947 Vali Acc: 0.419 Test Loss: 1.947 Test Acc: 0.419
Validation loss decreased (-0.391875 --> -0.418899).  Saving model ...
Epoch: 10 cost time: 4.275495290756226
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.010 Vali Acc: 0.378 Test Loss: 2.010 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7897684574127197
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.054 Vali Acc: 0.378 Test Loss: 2.054 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.146336555480957
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.031 Vali Acc: 0.378 Test Loss: 2.031 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8518552780151367
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.055 Vali Acc: 0.392 Test Loss: 2.055 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7737350463867188
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.075 Vali Acc: 0.392 Test Loss: 2.075 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8539350032806396
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.086 Vali Acc: 0.392 Test Loss: 2.086 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.092981338500977
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.106 Vali Acc: 0.392 Test Loss: 2.106 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.996345281600952
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.125 Vali Acc: 0.365 Test Loss: 2.125 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.025747776031494
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.132 Vali Acc: 0.392 Test Loss: 2.132 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.035088777542114
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.149 Vali Acc: 0.405 Test Loss: 2.149 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.272096395492554
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.633222818374634
Epoch: 2, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.488 Vali Acc: 0.243 Test Loss: 1.488 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.578144788742065
Epoch: 3, Steps: 10 | Train Loss: 0.879 Vali Loss: 1.473 Vali Acc: 0.351 Test Loss: 1.473 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 4.617029666900635
Epoch: 4, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.584 Vali Acc: 0.270 Test Loss: 1.584 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.847670793533325
Epoch: 5, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.511 Vali Acc: 0.311 Test Loss: 1.511 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.521356105804443
Epoch: 6, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.679 Vali Acc: 0.297 Test Loss: 1.679 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.74007511138916
Epoch: 7, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.820 Vali Acc: 0.365 Test Loss: 1.820 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364847).  Saving model ...
Epoch: 8 cost time: 4.559982061386108
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.030 Vali Acc: 0.311 Test Loss: 2.030 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.273244857788086
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.014 Vali Acc: 0.324 Test Loss: 2.014 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.2802414894104
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.031 Vali Acc: 0.284 Test Loss: 2.031 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.909797430038452
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.043 Vali Acc: 0.311 Test Loss: 2.043 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.065134763717651
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.000 Vali Acc: 0.338 Test Loss: 2.000 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.54918909072876
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.066 Vali Acc: 0.311 Test Loss: 2.066 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.177025079727173
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.058 Vali Acc: 0.311 Test Loss: 2.058 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.951569080352783
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.055 Vali Acc: 0.338 Test Loss: 2.055 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.655400991439819
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.067 Vali Acc: 0.324 Test Loss: 2.067 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.356943130493164
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.083 Vali Acc: 0.324 Test Loss: 2.083 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.99199104309082
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.449 Vali Acc: 0.149 Test Loss: 1.449 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 4.223421096801758
Epoch: 2, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.557 Vali Acc: 0.216 Test Loss: 1.557 Test Acc: 0.216
Validation loss decreased (-0.148634 --> -0.216201).  Saving model ...
Epoch: 3 cost time: 4.387288331985474
Epoch: 3, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.500 Vali Acc: 0.284 Test Loss: 1.500 Test Acc: 0.284
Validation loss decreased (-0.216201 --> -0.283769).  Saving model ...
Epoch: 4 cost time: 4.475641965866089
Epoch: 4, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.633 Vali Acc: 0.270 Test Loss: 1.633 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.90343713760376
Epoch: 5, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.720 Vali Acc: 0.351 Test Loss: 1.720 Test Acc: 0.351
Validation loss decreased (-0.283769 --> -0.351334).  Saving model ...
Epoch: 6 cost time: 4.423556089401245
Epoch: 6, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.865 Vali Acc: 0.311 Test Loss: 1.865 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.279110431671143
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 2.158 Vali Acc: 0.270 Test Loss: 2.158 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.414756536483765
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.139 Vali Acc: 0.284 Test Loss: 2.139 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.219269752502441
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.104 Vali Acc: 0.324 Test Loss: 2.104 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.458870887756348
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.257 Vali Acc: 0.284 Test Loss: 2.257 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.461369514465332
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.310 Vali Acc: 0.311 Test Loss: 2.310 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.234082937240601
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.255 Vali Acc: 0.338 Test Loss: 2.255 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.038395881652832
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.339 Vali Acc: 0.311 Test Loss: 2.339 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.633625268936157
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.344 Vali Acc: 0.351 Test Loss: 2.344 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.35822057723999
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.339 Vali Acc: 0.365 Test Loss: 2.339 Test Acc: 0.365
Validation loss decreased (-0.351334 --> -0.364841).  Saving model ...
Epoch: 16 cost time: 4.208364963531494
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.375 Vali Acc: 0.351 Test Loss: 2.375 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9591686725616455
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.385 Vali Acc: 0.351 Test Loss: 2.385 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.200007677078247
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.381 Vali Acc: 0.365 Test Loss: 2.381 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.576261758804321
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.408 Vali Acc: 0.338 Test Loss: 2.408 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.465041399002075
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.416 Vali Acc: 0.351 Test Loss: 2.416 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.397856712341309
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.437 Vali Acc: 0.351 Test Loss: 2.437 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.347724676132202
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.431 Vali Acc: 0.351 Test Loss: 2.431 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.439704179763794
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.446 Vali Acc: 0.351 Test Loss: 2.446 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.267408847808838
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.482 Vali Acc: 0.338 Test Loss: 2.482 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.077514171600342
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.488 Vali Acc: 0.351 Test Loss: 2.488 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.580640077590942
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.446 Vali Acc: 0.230 Test Loss: 1.446 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 4.514325141906738
Epoch: 2, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.569 Vali Acc: 0.243 Test Loss: 1.569 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243228).  Saving model ...
Epoch: 3 cost time: 4.335591077804565
Epoch: 3, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.491 Vali Acc: 0.297 Test Loss: 1.491 Test Acc: 0.297
Validation loss decreased (-0.243228 --> -0.297282).  Saving model ...
Epoch: 4 cost time: 4.453864812850952
Epoch: 4, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.610 Vali Acc: 0.324 Test Loss: 1.610 Test Acc: 0.324
Validation loss decreased (-0.297282 --> -0.324308).  Saving model ...
Epoch: 5 cost time: 4.645719289779663
Epoch: 5, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.765 Vali Acc: 0.311 Test Loss: 1.765 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.500035047531128
Epoch: 6, Steps: 10 | Train Loss: 0.155 Vali Loss: 2.055 Vali Acc: 0.297 Test Loss: 2.055 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.547802448272705
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 2.129 Vali Acc: 0.297 Test Loss: 2.129 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.885918140411377
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.255 Vali Acc: 0.257 Test Loss: 2.255 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.805506944656372
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.248 Vali Acc: 0.297 Test Loss: 2.248 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.640050649642944
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.344 Vali Acc: 0.311 Test Loss: 2.344 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.746710777282715
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.380 Vali Acc: 0.311 Test Loss: 2.380 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.6501405239105225
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.375 Vali Acc: 0.324 Test Loss: 2.375 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.095656394958496
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.433 Vali Acc: 0.297 Test Loss: 2.433 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.409569978713989
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.431 Vali Acc: 0.324 Test Loss: 2.431 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.660815000534058
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.450 Vali Acc: 0.176 Test Loss: 1.450 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.887866258621216
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.537 Vali Acc: 0.216 Test Loss: 1.537 Test Acc: 0.216
Validation loss decreased (-0.175661 --> -0.216201).  Saving model ...
Epoch: 3 cost time: 4.192305326461792
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.512 Vali Acc: 0.284 Test Loss: 1.512 Test Acc: 0.284
Validation loss decreased (-0.216201 --> -0.283769).  Saving model ...
Epoch: 4 cost time: 4.030196666717529
Epoch: 4, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.713 Vali Acc: 0.203 Test Loss: 1.713 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.5244879722595215
Epoch: 5, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.787 Vali Acc: 0.203 Test Loss: 1.787 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.717174053192139
Epoch: 6, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.814 Vali Acc: 0.257 Test Loss: 1.814 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.660926103591919
Epoch: 7, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.888 Vali Acc: 0.284 Test Loss: 1.888 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.649667978286743
Epoch: 8, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.954 Vali Acc: 0.230 Test Loss: 1.954 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.3287482261657715
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.971 Vali Acc: 0.270 Test Loss: 1.971 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.713763952255249
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.263 Vali Acc: 0.270 Test Loss: 2.263 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.669394254684448
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.227 Vali Acc: 0.230 Test Loss: 2.227 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.5906407833099365
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.208 Vali Acc: 0.230 Test Loss: 2.208 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.8286027908325195
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.300 Vali Acc: 0.257 Test Loss: 2.300 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.28378378378378377
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.051478147506714
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.413 Vali Acc: 0.216 Test Loss: 1.413 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.358450174331665
Epoch: 2, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.513 Vali Acc: 0.270 Test Loss: 1.513 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270255).  Saving model ...
Epoch: 3 cost time: 4.462756156921387
Epoch: 3, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.428 Vali Acc: 0.324 Test Loss: 1.428 Test Acc: 0.324
Validation loss decreased (-0.270255 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 4.060595273971558
Epoch: 4, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.601 Vali Acc: 0.189 Test Loss: 1.601 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.13597297668457
Epoch: 5, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.583 Vali Acc: 0.324 Test Loss: 1.583 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.520342826843262
Epoch: 6, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.819 Vali Acc: 0.243 Test Loss: 1.819 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.447439908981323
Epoch: 7, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.842 Vali Acc: 0.216 Test Loss: 1.842 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.452331304550171
Epoch: 8, Steps: 10 | Train Loss: 0.055 Vali Loss: 2.056 Vali Acc: 0.257 Test Loss: 2.056 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.800741195678711
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.899 Vali Acc: 0.351 Test Loss: 1.899 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351332).  Saving model ...
Epoch: 10 cost time: 4.588167190551758
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.156 Vali Acc: 0.270 Test Loss: 2.156 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.7276551723480225
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.990 Vali Acc: 0.284 Test Loss: 1.990 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.528181314468384
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.098 Vali Acc: 0.311 Test Loss: 2.098 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.681288242340088
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.132 Vali Acc: 0.270 Test Loss: 2.132 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.7498133182525635
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.079 Vali Acc: 0.324 Test Loss: 2.079 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.8385491371154785
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.101 Vali Acc: 0.324 Test Loss: 2.101 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.544726848602295
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.124 Vali Acc: 0.297 Test Loss: 2.124 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.360658407211304
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.123 Vali Acc: 0.311 Test Loss: 2.123 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.295830249786377
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.137 Vali Acc: 0.338 Test Loss: 2.137 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.069467067718506
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.154 Vali Acc: 0.338 Test Loss: 2.154 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.730830192565918
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.438 Vali Acc: 0.257 Test Loss: 1.438 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.956212043762207
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.450 Vali Acc: 0.230 Test Loss: 1.450 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4881322383880615
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (-0.256742 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 3.9903485774993896
Epoch: 4, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.552 Vali Acc: 0.257 Test Loss: 1.552 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.360792398452759
Epoch: 5, Steps: 10 | Train Loss: 0.944 Vali Loss: 1.434 Vali Acc: 0.338 Test Loss: 1.434 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337823).  Saving model ...
Epoch: 6 cost time: 4.26775050163269
Epoch: 6, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.541 Vali Acc: 0.230 Test Loss: 1.541 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.181758403778076
Epoch: 7, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.612 Vali Acc: 0.297 Test Loss: 1.612 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.242574453353882
Epoch: 8, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.697 Vali Acc: 0.270 Test Loss: 1.697 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.3352015018463135
Epoch: 9, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.731 Vali Acc: 0.351 Test Loss: 1.731 Test Acc: 0.351
Validation loss decreased (-0.337823 --> -0.351334).  Saving model ...
Epoch: 10 cost time: 4.248394727706909
Epoch: 10, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.745 Vali Acc: 0.324 Test Loss: 1.745 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.143875360488892
Epoch: 11, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.848 Vali Acc: 0.270 Test Loss: 1.848 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.433134078979492
Epoch: 12, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.975 Vali Acc: 0.243 Test Loss: 1.975 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.9488651752471924
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 2.020 Vali Acc: 0.243 Test Loss: 2.020 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.3000829219818115
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.209 Vali Acc: 0.297 Test Loss: 2.209 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.0357067584991455
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.296 Vali Acc: 0.243 Test Loss: 2.296 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.86808180809021
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.349 Vali Acc: 0.297 Test Loss: 2.349 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.22242283821106
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.459 Vali Acc: 0.270 Test Loss: 2.459 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.2816736698150635
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.402 Vali Acc: 0.284 Test Loss: 2.402 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.104908466339111
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.486 Vali Acc: 0.297 Test Loss: 2.486 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.076064109802246
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.383 Vali Acc: 0.257 Test Loss: 1.383 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.402921915054321
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.393 Vali Acc: 0.311 Test Loss: 1.393 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 4.564091444015503
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.349 Vali Acc: 0.351 Test Loss: 1.349 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 4.319223880767822
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.513 Vali Acc: 0.297 Test Loss: 1.513 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.285555362701416
Epoch: 5, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.411 Vali Acc: 0.392 Test Loss: 1.411 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391878).  Saving model ...
Epoch: 6 cost time: 4.388939142227173
Epoch: 6, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.514 Vali Acc: 0.257 Test Loss: 1.514 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.239537477493286
Epoch: 7, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.299686670303345
Epoch: 8, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.527 Vali Acc: 0.297 Test Loss: 1.527 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.122905492782593
Epoch: 9, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.714 Vali Acc: 0.392 Test Loss: 1.714 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.38844108581543
Epoch: 10, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.925 Vali Acc: 0.230 Test Loss: 1.925 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.268053770065308
Epoch: 11, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.724 Vali Acc: 0.324 Test Loss: 1.724 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.173259735107422
Epoch: 12, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.988 Vali Acc: 0.230 Test Loss: 1.988 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.2315332889556885
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 2.085 Vali Acc: 0.257 Test Loss: 2.085 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.092726469039917
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 2.237 Vali Acc: 0.297 Test Loss: 2.237 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.179805755615234
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 2.212 Vali Acc: 0.324 Test Loss: 2.212 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 1656708
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.527175426483154
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 4.316914081573486
Epoch: 2, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
Validation loss decreased (-0.351338 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 4.0502119064331055
Epoch: 3, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.052 Vali Acc: 0.554 Test Loss: 1.052 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554044).  Saving model ...
Epoch: 4 cost time: 3.8250601291656494
Epoch: 4, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608098).  Saving model ...
Epoch: 5 cost time: 4.236119031906128
Epoch: 5, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.015127182006836
Epoch: 6, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.800 Vali Acc: 0.662 Test Loss: 0.800 Test Acc: 0.662
Validation loss decreased (-0.608098 --> -0.662154).  Saving model ...
Epoch: 7 cost time: 4.377884149551392
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.831 Vali Acc: 0.635 Test Loss: 0.831 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8330719470977783
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.986 Vali Acc: 0.662 Test Loss: 0.986 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9618771076202393
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.880 Vali Acc: 0.676 Test Loss: 0.880 Test Acc: 0.676
Validation loss decreased (-0.662154 --> -0.675667).  Saving model ...
Epoch: 10 cost time: 3.7408344745635986
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.635 Test Loss: 0.822 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.894014596939087
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.649 Test Loss: 0.842 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8365659713745117
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.867 Vali Acc: 0.649 Test Loss: 0.867 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.669895887374878
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.662 Test Loss: 0.853 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8731930255889893
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.649 Test Loss: 0.835 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.873915672302246
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.635 Test Loss: 0.836 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.928906202316284
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.662 Test Loss: 0.848 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.055642366409302
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.649 Test Loss: 0.860 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8985867500305176
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.635 Test Loss: 0.855 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.334174871444702
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.635 Test Loss: 0.859 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.343257904052734
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.344 Vali Acc: 0.351 Test Loss: 1.344 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 4.796473026275635
Epoch: 2, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 4.626205682754517
Epoch: 3, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.151 Vali Acc: 0.581 Test Loss: 1.151 Test Acc: 0.581
Validation loss decreased (-0.486475 --> -0.581070).  Saving model ...
Epoch: 4 cost time: 4.635724067687988
Epoch: 4, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.548631191253662
Epoch: 5, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.4757843017578125
Epoch: 6, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.948 Vali Acc: 0.608 Test Loss: 0.948 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608099).  Saving model ...
Epoch: 7 cost time: 4.3817644119262695
Epoch: 7, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.004 Vali Acc: 0.635 Test Loss: 1.004 Test Acc: 0.635
Validation loss decreased (-0.608099 --> -0.635125).  Saving model ...
Epoch: 8 cost time: 4.1779563426971436
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.080 Vali Acc: 0.608 Test Loss: 1.080 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.500993728637695
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.798738718032837
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.008 Vali Acc: 0.608 Test Loss: 1.008 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.144969701766968
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.033 Vali Acc: 0.622 Test Loss: 1.033 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7482824325561523
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.595 Test Loss: 1.051 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.2381463050842285
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.025 Vali Acc: 0.595 Test Loss: 1.025 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.812666893005371
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.595 Test Loss: 1.015 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.327592134475708
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.358648061752319
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.608 Test Loss: 1.029 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.389968633651733
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.676220178604126
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.403 Vali Acc: 0.338 Test Loss: 1.403 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 4.0718560218811035
Epoch: 2, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.366 Vali Acc: 0.297 Test Loss: 1.366 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.659266710281372
Epoch: 3, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.472 Vali Acc: 0.392 Test Loss: 1.472 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391877).  Saving model ...
Epoch: 4 cost time: 4.729365110397339
Epoch: 4, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.554 Vali Acc: 0.324 Test Loss: 1.554 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.099504470825195
Epoch: 5, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.729 Vali Acc: 0.351 Test Loss: 1.729 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.356411695480347
Epoch: 6, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.603 Vali Acc: 0.378 Test Loss: 1.603 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.241451740264893
Epoch: 7, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.716 Vali Acc: 0.392 Test Loss: 1.716 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.777827024459839
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.032 Vali Acc: 0.365 Test Loss: 2.032 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.0062971115112305
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.870 Vali Acc: 0.432 Test Loss: 1.870 Test Acc: 0.432
Validation loss decreased (-0.391877 --> -0.432414).  Saving model ...
Epoch: 10 cost time: 4.428019285202026
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.154 Vali Acc: 0.378 Test Loss: 2.154 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0986692905426025
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.096 Vali Acc: 0.405 Test Loss: 2.096 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.113569259643555
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.111 Vali Acc: 0.405 Test Loss: 2.111 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.033825159072876
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.186 Vali Acc: 0.392 Test Loss: 2.186 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.405895233154297
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.206 Vali Acc: 0.392 Test Loss: 2.206 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.327296018600464
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.164 Vali Acc: 0.405 Test Loss: 2.164 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.704775333404541
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.174 Vali Acc: 0.405 Test Loss: 2.174 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.5292510986328125
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.198 Vali Acc: 0.419 Test Loss: 2.198 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.26290225982666
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.206 Vali Acc: 0.419 Test Loss: 2.206 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.8047215938568115
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.218 Vali Acc: 0.419 Test Loss: 2.218 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.937983751296997
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.455 Vali Acc: 0.189 Test Loss: 1.455 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 4.15020489692688
Epoch: 2, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.400 Vali Acc: 0.351 Test Loss: 1.400 Test Acc: 0.351
Validation loss decreased (-0.189175 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 4.039307355880737
Epoch: 3, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.418 Vali Acc: 0.378 Test Loss: 1.418 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378364).  Saving model ...
Epoch: 4 cost time: 4.221967458724976
Epoch: 4, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.592 Vali Acc: 0.230 Test Loss: 1.592 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8162336349487305
Epoch: 5, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.703 Vali Acc: 0.243 Test Loss: 1.703 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.161558151245117
Epoch: 6, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.602 Vali Acc: 0.365 Test Loss: 1.602 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.1831254959106445
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.840 Vali Acc: 0.351 Test Loss: 1.840 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.079838991165161
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.948 Vali Acc: 0.243 Test Loss: 1.948 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.139487981796265
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.901 Vali Acc: 0.311 Test Loss: 1.901 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.337494134902954
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.985 Vali Acc: 0.311 Test Loss: 1.985 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.406550407409668
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.076 Vali Acc: 0.311 Test Loss: 2.076 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.7764129638671875
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.052 Vali Acc: 0.297 Test Loss: 2.052 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.6134514808654785
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.068 Vali Acc: 0.324 Test Loss: 2.068 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.682229042053223
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.449 Vali Acc: 0.189 Test Loss: 1.449 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 4.078295946121216
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.471 Vali Acc: 0.351 Test Loss: 1.471 Test Acc: 0.351
Validation loss decreased (-0.189175 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 3.75195574760437
Epoch: 3, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.535 Vali Acc: 0.338 Test Loss: 1.535 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.1420817375183105
Epoch: 4, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.837 Vali Acc: 0.257 Test Loss: 1.837 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.817697286605835
Epoch: 5, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.780 Vali Acc: 0.297 Test Loss: 1.780 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.054684162139893
Epoch: 6, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.784 Vali Acc: 0.324 Test Loss: 1.784 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.94950532913208
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.823 Vali Acc: 0.365 Test Loss: 1.823 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364847).  Saving model ...
Epoch: 8 cost time: 3.920290231704712
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.030 Vali Acc: 0.351 Test Loss: 2.030 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6772561073303223
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.130 Vali Acc: 0.338 Test Loss: 2.130 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.031104803085327
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.113 Vali Acc: 0.324 Test Loss: 2.113 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.198434829711914
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.228 Vali Acc: 0.324 Test Loss: 2.228 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.952723741531372
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.176 Vali Acc: 0.324 Test Loss: 2.176 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.113098621368408
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.190 Vali Acc: 0.338 Test Loss: 2.190 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.761399745941162
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.241 Vali Acc: 0.338 Test Loss: 2.241 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.368363618850708
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.278 Vali Acc: 0.338 Test Loss: 2.278 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.194025993347168
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.282 Vali Acc: 0.324 Test Loss: 2.282 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.3489990234375
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.297 Vali Acc: 0.324 Test Loss: 2.297 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.638184070587158
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.405 Vali Acc: 0.230 Test Loss: 1.405 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 3.858834981918335
Epoch: 2, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 4.075439453125
Epoch: 3, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.479 Vali Acc: 0.365 Test Loss: 1.479 Test Acc: 0.365
Validation loss decreased (-0.270256 --> -0.364850).  Saving model ...
Epoch: 4 cost time: 4.059859037399292
Epoch: 4, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.736 Vali Acc: 0.203 Test Loss: 1.736 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.141170978546143
Epoch: 5, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.735 Vali Acc: 0.324 Test Loss: 1.735 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.298730373382568
Epoch: 6, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.867 Vali Acc: 0.378 Test Loss: 1.867 Test Acc: 0.378
Validation loss decreased (-0.364850 --> -0.378360).  Saving model ...
Epoch: 7 cost time: 4.041369199752808
Epoch: 7, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.956 Vali Acc: 0.351 Test Loss: 1.956 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9284725189208984
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.136 Vali Acc: 0.270 Test Loss: 2.136 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7940917015075684
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.310 Vali Acc: 0.365 Test Loss: 2.310 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.223289489746094
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.263 Vali Acc: 0.297 Test Loss: 2.263 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.039796590805054
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.336 Vali Acc: 0.338 Test Loss: 2.336 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.264641046524048
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.402 Vali Acc: 0.365 Test Loss: 2.402 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.397840261459351
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.394 Vali Acc: 0.338 Test Loss: 2.394 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.237705707550049
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.402 Vali Acc: 0.365 Test Loss: 2.402 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.284991025924683
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.464 Vali Acc: 0.378 Test Loss: 2.464 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.113147735595703
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.473 Vali Acc: 0.365 Test Loss: 2.473 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.670635223388672
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.431 Vali Acc: 0.284 Test Loss: 1.431 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 4.413920164108276
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.463 Vali Acc: 0.230 Test Loss: 1.463 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2887022495269775
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.459 Vali Acc: 0.365 Test Loss: 1.459 Test Acc: 0.365
Validation loss decreased (-0.283769 --> -0.364850).  Saving model ...
Epoch: 4 cost time: 4.138805627822876
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.808 Vali Acc: 0.203 Test Loss: 1.808 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.354690313339233
Epoch: 5, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.649 Vali Acc: 0.311 Test Loss: 1.649 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.343954563140869
Epoch: 6, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.551 Vali Acc: 0.338 Test Loss: 1.551 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.231390476226807
Epoch: 7, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.791 Vali Acc: 0.257 Test Loss: 1.791 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.468696594238281
Epoch: 8, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.980 Vali Acc: 0.230 Test Loss: 1.980 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.448492765426636
Epoch: 9, Steps: 10 | Train Loss: 0.112 Vali Loss: 2.058 Vali Acc: 0.243 Test Loss: 2.058 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.04185152053833
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.019 Vali Acc: 0.243 Test Loss: 2.019 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.256208658218384
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.119 Vali Acc: 0.270 Test Loss: 2.119 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.086176872253418
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.399 Vali Acc: 0.216 Test Loss: 2.399 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.214328765869141
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.154 Vali Acc: 0.243 Test Loss: 2.154 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.910349130630493
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.416 Vali Acc: 0.257 Test Loss: 1.416 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.435921669006348
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.437 Vali Acc: 0.311 Test Loss: 1.437 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310796).  Saving model ...
Epoch: 3 cost time: 4.077837228775024
Epoch: 3, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.432 Vali Acc: 0.378 Test Loss: 1.432 Test Acc: 0.378
Validation loss decreased (-0.310796 --> -0.378364).  Saving model ...
Epoch: 4 cost time: 4.280871629714966
Epoch: 4, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.688 Vali Acc: 0.189 Test Loss: 1.688 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.1684346199035645
Epoch: 5, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.614 Vali Acc: 0.297 Test Loss: 1.614 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.147362470626831
Epoch: 6, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.600 Vali Acc: 0.324 Test Loss: 1.600 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.1174092292785645
Epoch: 7, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.659 Vali Acc: 0.338 Test Loss: 1.659 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.327821254730225
Epoch: 8, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.776 Vali Acc: 0.297 Test Loss: 1.776 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.78931450843811
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.980 Vali Acc: 0.284 Test Loss: 1.980 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.36473822593689
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.930 Vali Acc: 0.297 Test Loss: 1.930 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.169059991836548
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.936 Vali Acc: 0.311 Test Loss: 1.936 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.412192344665527
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.960 Vali Acc: 0.297 Test Loss: 1.960 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.079791307449341
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.964 Vali Acc: 0.338 Test Loss: 1.964 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.320229768753052
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.399 Vali Acc: 0.324 Test Loss: 1.399 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 4.110960006713867
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.342 Vali Acc: 0.351 Test Loss: 1.342 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 4.153717517852783
Epoch: 3, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.421 Vali Acc: 0.257 Test Loss: 1.421 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0986926555633545
Epoch: 4, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.459 Vali Acc: 0.297 Test Loss: 1.459 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9949052333831787
Epoch: 5, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.402 Vali Acc: 0.311 Test Loss: 1.402 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.1002357006073
Epoch: 6, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.369 Vali Acc: 0.351 Test Loss: 1.369 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.275335073471069
Epoch: 7, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.404 Vali Acc: 0.324 Test Loss: 1.404 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.296654224395752
Epoch: 8, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.538 Vali Acc: 0.297 Test Loss: 1.538 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.275972604751587
Epoch: 9, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.532 Vali Acc: 0.324 Test Loss: 1.532 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.379289388656616
Epoch: 10, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.538 Vali Acc: 0.338 Test Loss: 1.538 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.0327839851379395
Epoch: 11, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.661 Vali Acc: 0.338 Test Loss: 1.661 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.126916170120239
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.835 Vali Acc: 0.270 Test Loss: 1.835 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.589266538619995
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.191549062728882
Epoch: 2, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.419 Vali Acc: 0.230 Test Loss: 1.419 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.78765606880188
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.461 Vali Acc: 0.297 Test Loss: 1.461 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 4.070018291473389
Epoch: 4, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.532 Vali Acc: 0.297 Test Loss: 1.532 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.126609802246094
Epoch: 5, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.419 Vali Acc: 0.338 Test Loss: 1.419 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 3.8418285846710205
Epoch: 6, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.448 Vali Acc: 0.203 Test Loss: 1.448 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9546074867248535
Epoch: 7, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.380 Vali Acc: 0.351 Test Loss: 1.380 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 8 cost time: 4.069509506225586
Epoch: 8, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.540 Vali Acc: 0.243 Test Loss: 1.540 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8280961513519287
Epoch: 9, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.579 Vali Acc: 0.230 Test Loss: 1.579 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9143402576446533
Epoch: 10, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.639 Vali Acc: 0.338 Test Loss: 1.639 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.018001079559326
Epoch: 11, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.588 Vali Acc: 0.338 Test Loss: 1.588 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8756585121154785
Epoch: 12, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.891 Vali Acc: 0.297 Test Loss: 1.891 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.183674573898315
Epoch: 13, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.742 Vali Acc: 0.338 Test Loss: 1.742 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.25045371055603
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 2.110 Vali Acc: 0.297 Test Loss: 2.110 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.9538822174072266
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 2.137 Vali Acc: 0.338 Test Loss: 2.137 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.623883008956909
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.273 Vali Acc: 0.311 Test Loss: 2.273 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.346463441848755
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.374 Vali Acc: 0.284 Test Loss: 2.374 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 1263492
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.047685146331787
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.412 Vali Acc: 0.311 Test Loss: 1.412 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.80485200881958
Epoch: 2, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.221 Vali Acc: 0.446 Test Loss: 1.221 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 4.790570020675659
Epoch: 3, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.073 Vali Acc: 0.622 Test Loss: 1.073 Test Acc: 0.622
Validation loss decreased (-0.445934 --> -0.621611).  Saving model ...
Epoch: 4 cost time: 4.74494194984436
Epoch: 4, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 5 cost time: 4.705200433731079
Epoch: 5, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.408228397369385
Epoch: 6, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.029 Vali Acc: 0.608 Test Loss: 1.029 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.4571287631988525
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.920 Vali Acc: 0.635 Test Loss: 0.920 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635126).  Saving model ...
Epoch: 8 cost time: 4.59453010559082
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.952 Vali Acc: 0.622 Test Loss: 0.952 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.549309968948364
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.983 Vali Acc: 0.635 Test Loss: 0.983 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.631362199783325
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.962 Vali Acc: 0.622 Test Loss: 0.962 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.426086187362671
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.965 Vali Acc: 0.635 Test Loss: 0.965 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.101269006729126
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.972 Vali Acc: 0.635 Test Loss: 0.972 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.578388214111328
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.731020212173462
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.649 Test Loss: 0.985 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 15 cost time: 4.598942518234253
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.662 Test Loss: 0.968 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 16 cost time: 4.6008570194244385
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.649 Test Loss: 0.978 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.695609092712402
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.580543041229248
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.649 Test Loss: 0.984 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.470789194107056
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.649 Test Loss: 0.988 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.855549097061157
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.649 Test Loss: 0.996 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.673522472381592
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.649 Test Loss: 1.001 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.448655366897583
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.649 Test Loss: 1.007 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.205511093139648
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.649 Test Loss: 1.015 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.5586090087890625
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.635 Test Loss: 1.014 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.253987073898315
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.649 Test Loss: 1.016 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.799424171447754
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 4.575735092163086
Epoch: 2, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 4.7898852825164795
Epoch: 3, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 4.679285049438477
Epoch: 4, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 4.461421251296997
Epoch: 5, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.425551652908325
Epoch: 6, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 4.454183340072632
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 4.449508428573608
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.174 Vali Acc: 0.581 Test Loss: 1.174 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 4.273301839828491
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 4.589071750640869
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.116 Vali Acc: 0.581 Test Loss: 1.116 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.586377382278442
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.124 Vali Acc: 0.622 Test Loss: 1.124 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621610).  Saving model ...
Epoch: 12 cost time: 4.432373523712158
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.079 Vali Acc: 0.595 Test Loss: 1.079 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0684895515441895
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.087 Vali Acc: 0.595 Test Loss: 1.087 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.071014165878296
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.107 Vali Acc: 0.595 Test Loss: 1.107 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8811120986938477
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.608 Test Loss: 1.097 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.225631237030029
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.595 Test Loss: 1.099 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.125585556030273
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.247998237609863
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.608 Test Loss: 1.105 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.04037880897522
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.595 Test Loss: 1.111 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.544979572296143
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.615830421447754
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.125 Vali Acc: 0.581 Test Loss: 1.125 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.779983997344971
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.7857890129089355
Epoch: 2, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.411 Vali Acc: 0.338 Test Loss: 1.411 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 4.638844013214111
Epoch: 3, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.478 Vali Acc: 0.419 Test Loss: 1.478 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418904).  Saving model ...
Epoch: 4 cost time: 4.717232942581177
Epoch: 4, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.547 Vali Acc: 0.351 Test Loss: 1.547 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.828811168670654
Epoch: 5, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.612 Vali Acc: 0.419 Test Loss: 1.612 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.182491302490234
Epoch: 6, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.706 Vali Acc: 0.392 Test Loss: 1.706 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.75615382194519
Epoch: 7, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.813 Vali Acc: 0.405 Test Loss: 1.813 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.58455753326416
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.081 Vali Acc: 0.392 Test Loss: 2.081 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.5414063930511475
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.011 Vali Acc: 0.405 Test Loss: 2.011 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.346097469329834
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.075 Vali Acc: 0.405 Test Loss: 2.075 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.7375383377075195
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.077 Vali Acc: 0.419 Test Loss: 2.077 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.676025152206421
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.094 Vali Acc: 0.432 Test Loss: 2.094 Test Acc: 0.432
Validation loss decreased (-0.418904 --> -0.432411).  Saving model ...
Epoch: 13 cost time: 4.545339584350586
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.112 Vali Acc: 0.419 Test Loss: 2.112 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.843262434005737
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.138 Vali Acc: 0.419 Test Loss: 2.138 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.908221960067749
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.131 Vali Acc: 0.419 Test Loss: 2.131 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.270984888076782
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.162 Vali Acc: 0.419 Test Loss: 2.162 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.861717224121094
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.176 Vali Acc: 0.432 Test Loss: 2.176 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.894555330276489
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.176 Vali Acc: 0.432 Test Loss: 2.176 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.212412357330322
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.193 Vali Acc: 0.419 Test Loss: 2.193 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.653005599975586
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.218 Vali Acc: 0.419 Test Loss: 2.218 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.872486591339111
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.229 Vali Acc: 0.432 Test Loss: 2.229 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.762728929519653
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.248 Vali Acc: 0.432 Test Loss: 2.248 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.25847315788269
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.437 Vali Acc: 0.284 Test Loss: 1.437 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 4.7459588050842285
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.3238444328308105
Epoch: 3, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.402 Vali Acc: 0.338 Test Loss: 1.402 Test Acc: 0.338
Validation loss decreased (-0.283769 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 4.511080980300903
Epoch: 4, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.441 Vali Acc: 0.297 Test Loss: 1.441 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.49554705619812
Epoch: 5, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.587 Vali Acc: 0.351 Test Loss: 1.587 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351335).  Saving model ...
Epoch: 6 cost time: 4.442485332489014
Epoch: 6, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.747 Vali Acc: 0.284 Test Loss: 1.747 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.600890159606934
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.693 Vali Acc: 0.324 Test Loss: 1.693 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.387094497680664
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.849 Vali Acc: 0.324 Test Loss: 1.849 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.476792573928833
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.899 Vali Acc: 0.311 Test Loss: 1.899 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.729772329330444
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.950 Vali Acc: 0.324 Test Loss: 1.950 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.4703593254089355
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.970 Vali Acc: 0.297 Test Loss: 1.970 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.577654600143433
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.975 Vali Acc: 0.324 Test Loss: 1.975 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.49314546585083
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.032 Vali Acc: 0.324 Test Loss: 2.032 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.534657001495361
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.048 Vali Acc: 0.297 Test Loss: 2.048 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.268068790435791
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.037 Vali Acc: 0.338 Test Loss: 2.037 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.899336576461792
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.479 Vali Acc: 0.257 Test Loss: 1.479 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.901418447494507
Epoch: 2, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.417 Vali Acc: 0.351 Test Loss: 1.417 Test Acc: 0.351
Validation loss decreased (-0.256742 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 4.016402721405029
Epoch: 3, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.496 Vali Acc: 0.378 Test Loss: 1.496 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378363).  Saving model ...
Epoch: 4 cost time: 3.7153570652008057
Epoch: 4, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.569 Vali Acc: 0.405 Test Loss: 1.569 Test Acc: 0.405
Validation loss decreased (-0.378363 --> -0.405390).  Saving model ...
Epoch: 5 cost time: 3.8685405254364014
Epoch: 5, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.660 Vali Acc: 0.351 Test Loss: 1.660 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8739161491394043
Epoch: 6, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.885 Vali Acc: 0.297 Test Loss: 1.885 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8943965435028076
Epoch: 7, Steps: 10 | Train Loss: 0.093 Vali Loss: 2.155 Vali Acc: 0.311 Test Loss: 2.155 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.198509693145752
Epoch: 8, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.016 Vali Acc: 0.338 Test Loss: 2.016 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.344353437423706
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.187 Vali Acc: 0.378 Test Loss: 2.187 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.062568664550781
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.350 Vali Acc: 0.284 Test Loss: 2.350 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.27173376083374
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.269 Vali Acc: 0.351 Test Loss: 2.269 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.1142542362213135
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.304 Vali Acc: 0.324 Test Loss: 2.304 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.114115476608276
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.339 Vali Acc: 0.324 Test Loss: 2.339 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.227027893066406
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.372 Vali Acc: 0.338 Test Loss: 2.372 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.580614328384399
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.533 Vali Acc: 0.203 Test Loss: 1.533 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 4.224388360977173
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.491 Vali Acc: 0.216 Test Loss: 1.491 Test Acc: 0.216
Validation loss decreased (-0.202687 --> -0.216201).  Saving model ...
Epoch: 3 cost time: 4.295950889587402
Epoch: 3, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.533 Vali Acc: 0.392 Test Loss: 1.533 Test Acc: 0.392
Validation loss decreased (-0.216201 --> -0.391877).  Saving model ...
Epoch: 4 cost time: 4.0985963344573975
Epoch: 4, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.600 Vali Acc: 0.297 Test Loss: 1.600 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.29825234413147
Epoch: 5, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.787 Vali Acc: 0.270 Test Loss: 1.787 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.964557409286499
Epoch: 6, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.903 Vali Acc: 0.243 Test Loss: 1.903 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.012316703796387
Epoch: 7, Steps: 10 | Train Loss: 0.101 Vali Loss: 2.088 Vali Acc: 0.230 Test Loss: 2.088 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.538315534591675
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.070 Vali Acc: 0.324 Test Loss: 2.070 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.673346281051636
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.192 Vali Acc: 0.324 Test Loss: 2.192 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.631800174713135
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.237 Vali Acc: 0.284 Test Loss: 2.237 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.444112062454224
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.340 Vali Acc: 0.297 Test Loss: 2.340 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.451357364654541
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.346 Vali Acc: 0.324 Test Loss: 2.346 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.5869457721710205
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.373 Vali Acc: 0.284 Test Loss: 2.373 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.980231046676636
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.533 Vali Acc: 0.189 Test Loss: 1.533 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 4.465548753738403
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.489 Vali Acc: 0.149 Test Loss: 1.489 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.342055559158325
Epoch: 3, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.552 Vali Acc: 0.230 Test Loss: 1.552 Test Acc: 0.230
Validation loss decreased (-0.189174 --> -0.229714).  Saving model ...
Epoch: 4 cost time: 4.31432580947876
Epoch: 4, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.535 Vali Acc: 0.257 Test Loss: 1.535 Test Acc: 0.257
Validation loss decreased (-0.229714 --> -0.256741).  Saving model ...
Epoch: 5 cost time: 4.348712682723999
Epoch: 5, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.686 Vali Acc: 0.297 Test Loss: 1.686 Test Acc: 0.297
Validation loss decreased (-0.256741 --> -0.297280).  Saving model ...
Epoch: 6 cost time: 4.470983266830444
Epoch: 6, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.833 Vali Acc: 0.189 Test Loss: 1.833 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.238224506378174
Epoch: 7, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.725 Vali Acc: 0.230 Test Loss: 1.725 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.254082441329956
Epoch: 8, Steps: 10 | Train Loss: 0.211 Vali Loss: 2.055 Vali Acc: 0.189 Test Loss: 2.055 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.556565523147583
Epoch: 9, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.908 Vali Acc: 0.257 Test Loss: 1.908 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.708707094192505
Epoch: 10, Steps: 10 | Train Loss: 0.062 Vali Loss: 2.101 Vali Acc: 0.311 Test Loss: 2.101 Test Acc: 0.311
Validation loss decreased (-0.297280 --> -0.310790).  Saving model ...
Epoch: 11 cost time: 4.33026123046875
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.281 Vali Acc: 0.230 Test Loss: 2.281 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.527042388916016
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.475 Vali Acc: 0.216 Test Loss: 2.475 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.601954221725464
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.262 Vali Acc: 0.270 Test Loss: 2.262 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.638080358505249
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.396 Vali Acc: 0.257 Test Loss: 2.396 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.595984697341919
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.631 Vali Acc: 0.243 Test Loss: 2.631 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.088232755661011
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.507 Vali Acc: 0.243 Test Loss: 2.507 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.647504568099976
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.469 Vali Acc: 0.257 Test Loss: 2.469 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.535604476928711
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.470 Vali Acc: 0.257 Test Loss: 2.470 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.4771647453308105
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.507 Vali Acc: 0.243 Test Loss: 2.507 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.600627422332764
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.526 Vali Acc: 0.257 Test Loss: 2.526 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.002496719360352
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.477 Vali Acc: 0.216 Test Loss: 1.477 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 3.986558198928833
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.516 Vali Acc: 0.189 Test Loss: 1.516 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.14387059211731
Epoch: 3, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.495 Vali Acc: 0.351 Test Loss: 1.495 Test Acc: 0.351
Validation loss decreased (-0.216201 --> -0.351336).  Saving model ...
Epoch: 4 cost time: 4.1850457191467285
Epoch: 4, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.513 Vali Acc: 0.270 Test Loss: 1.513 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.918396234512329
Epoch: 5, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.629 Vali Acc: 0.338 Test Loss: 1.629 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.805137634277344
Epoch: 6, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.715 Vali Acc: 0.230 Test Loss: 1.715 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.6337950229644775
Epoch: 7, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.833 Vali Acc: 0.284 Test Loss: 1.833 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.24789571762085
Epoch: 8, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.823 Vali Acc: 0.311 Test Loss: 1.823 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.563586950302124
Epoch: 9, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.978 Vali Acc: 0.270 Test Loss: 1.978 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.4493138790130615
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.084 Vali Acc: 0.297 Test Loss: 2.084 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.598715305328369
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.084 Vali Acc: 0.311 Test Loss: 2.084 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.399124622344971
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.131 Vali Acc: 0.311 Test Loss: 2.131 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9442877769470215
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.113 Vali Acc: 0.284 Test Loss: 2.113 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.899368762969971
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.427 Vali Acc: 0.257 Test Loss: 1.427 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 4.346036672592163
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.450 Vali Acc: 0.270 Test Loss: 1.450 Test Acc: 0.270
Validation loss decreased (-0.256742 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 4.122359037399292
Epoch: 3, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.382 Vali Acc: 0.284 Test Loss: 1.382 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 4.1401526927948
Epoch: 4, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.413 Vali Acc: 0.297 Test Loss: 1.413 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 4.22841215133667
Epoch: 5, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.432 Vali Acc: 0.311 Test Loss: 1.432 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310796).  Saving model ...
Epoch: 6 cost time: 4.377244472503662
Epoch: 6, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.570 Vali Acc: 0.257 Test Loss: 1.570 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.332259893417358
Epoch: 7, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.521 Vali Acc: 0.392 Test Loss: 1.521 Test Acc: 0.392
Validation loss decreased (-0.310796 --> -0.391877).  Saving model ...
Epoch: 8 cost time: 4.644140720367432
Epoch: 8, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.595 Vali Acc: 0.230 Test Loss: 1.595 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.137782096862793
Epoch: 9, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.554 Vali Acc: 0.230 Test Loss: 1.554 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.911620616912842
Epoch: 10, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.612 Vali Acc: 0.297 Test Loss: 1.612 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.404917478561401
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.721 Vali Acc: 0.297 Test Loss: 1.721 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.27524995803833
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.793 Vali Acc: 0.297 Test Loss: 1.793 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.766643047332764
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.821 Vali Acc: 0.311 Test Loss: 1.821 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.432270050048828
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.981 Vali Acc: 0.297 Test Loss: 1.981 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.666999816894531
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.359 Vali Acc: 0.284 Test Loss: 2.359 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.118302345275879
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.176 Vali Acc: 0.324 Test Loss: 2.176 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.158833980560303
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.210 Vali Acc: 0.257 Test Loss: 2.210 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.60883903503418
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.423 Vali Acc: 0.311 Test Loss: 1.423 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.511897325515747
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.485 Vali Acc: 0.297 Test Loss: 1.485 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.353564500808716
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.429 Vali Acc: 0.324 Test Loss: 1.429 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 4.557598352432251
Epoch: 4, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.423 Vali Acc: 0.392 Test Loss: 1.423 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391878).  Saving model ...
Epoch: 5 cost time: 4.536610841751099
Epoch: 5, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.463 Vali Acc: 0.297 Test Loss: 1.463 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.376475095748901
Epoch: 6, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.571 Vali Acc: 0.270 Test Loss: 1.571 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.1932213306427
Epoch: 7, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.542 Vali Acc: 0.378 Test Loss: 1.542 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.544898271560669
Epoch: 8, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.707 Vali Acc: 0.203 Test Loss: 1.707 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.337965726852417
Epoch: 9, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.559 Vali Acc: 0.270 Test Loss: 1.559 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.689324378967285
Epoch: 10, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.714 Vali Acc: 0.338 Test Loss: 1.714 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.639615297317505
Epoch: 11, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.871 Vali Acc: 0.257 Test Loss: 1.871 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.314586162567139
Epoch: 12, Steps: 10 | Train Loss: 0.249 Vali Loss: 2.111 Vali Acc: 0.230 Test Loss: 2.111 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.35565710067749
Epoch: 13, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.999 Vali Acc: 0.351 Test Loss: 1.999 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.082822322845459
Epoch: 14, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.973 Vali Acc: 0.351 Test Loss: 1.973 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 1066884
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.770496606826782
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.382 Vali Acc: 0.230 Test Loss: 1.382 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 3.997037172317505
Epoch: 2, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
Validation loss decreased (-0.229716 --> -0.540529).  Saving model ...
Epoch: 3 cost time: 4.258431434631348
Epoch: 3, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.295 Vali Acc: 0.446 Test Loss: 1.295 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.078540325164795
Epoch: 4, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.954 Vali Acc: 0.595 Test Loss: 0.954 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594585).  Saving model ...
Epoch: 5 cost time: 4.474166631698608
Epoch: 5, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.909 Vali Acc: 0.622 Test Loss: 0.909 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621613).  Saving model ...
Epoch: 6 cost time: 4.170095443725586
Epoch: 6, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.955 Vali Acc: 0.622 Test Loss: 0.955 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.39614200592041
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.939 Vali Acc: 0.595 Test Loss: 0.939 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.215286731719971
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.968 Vali Acc: 0.635 Test Loss: 0.968 Test Acc: 0.635
Validation loss decreased (-0.621613 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 4.294266700744629
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.915 Vali Acc: 0.635 Test Loss: 0.915 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 10 cost time: 4.293946981430054
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.924 Vali Acc: 0.635 Test Loss: 0.924 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.028878211975098
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.942 Vali Acc: 0.662 Test Loss: 0.942 Test Acc: 0.662
Validation loss decreased (-0.635126 --> -0.662153).  Saving model ...
Epoch: 12 cost time: 4.341354131698608
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.922 Vali Acc: 0.662 Test Loss: 0.922 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 13 cost time: 4.181885480880737
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.649 Test Loss: 0.914 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.004709959030151
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.662 Test Loss: 0.940 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9129440784454346
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.928 Vali Acc: 0.662 Test Loss: 0.928 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8341572284698486
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.649 Test Loss: 0.932 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.044831275939941
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.030517816543579
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.649 Test Loss: 0.944 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.9409470558166504
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.834541082382202
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.662 Test Loss: 0.944 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.98048734664917
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7988383769989014
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.649 Test Loss: 0.944 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.114067792892456
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.422 Vali Acc: 0.176 Test Loss: 1.422 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.9002034664154053
Epoch: 2, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.175661 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 4.392125844955444
Epoch: 3, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.359 Vali Acc: 0.459 Test Loss: 1.359 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.394236087799072
Epoch: 4, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 4.33280086517334
Epoch: 5, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.041 Vali Acc: 0.514 Test Loss: 1.041 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.015042781829834
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.058 Vali Acc: 0.608 Test Loss: 1.058 Test Acc: 0.608
Validation loss decreased (-0.527016 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 3.9664950370788574
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8274359703063965
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.115 Vali Acc: 0.581 Test Loss: 1.115 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9201700687408447
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.012722969055176
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.092 Vali Acc: 0.554 Test Loss: 1.092 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.9164528846740723
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.116 Vali Acc: 0.581 Test Loss: 1.116 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.8616602420806885
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.0815160274505615
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.110 Vali Acc: 0.595 Test Loss: 1.110 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.0197906494140625
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.130 Vali Acc: 0.595 Test Loss: 1.130 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.076007843017578
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.110 Vali Acc: 0.608 Test Loss: 1.110 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.9496586322784424
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.02720832824707
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.477 Vali Acc: 0.176 Test Loss: 1.477 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 4.251169443130493
Epoch: 2, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.410 Vali Acc: 0.338 Test Loss: 1.410 Test Acc: 0.338
Validation loss decreased (-0.175661 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 4.182825326919556
Epoch: 3, Steps: 10 | Train Loss: 0.816 Vali Loss: 1.674 Vali Acc: 0.297 Test Loss: 1.674 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.246098279953003
Epoch: 4, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.547 Vali Acc: 0.405 Test Loss: 1.547 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405390).  Saving model ...
Epoch: 5 cost time: 3.9346163272857666
Epoch: 5, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.677 Vali Acc: 0.351 Test Loss: 1.677 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0798962116241455
Epoch: 6, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.792 Vali Acc: 0.338 Test Loss: 1.792 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.216374158859253
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.756 Vali Acc: 0.405 Test Loss: 1.756 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.616815805435181
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.087 Vali Acc: 0.365 Test Loss: 2.087 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.1872239112854
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.072 Vali Acc: 0.392 Test Loss: 2.072 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.339860200881958
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.124 Vali Acc: 0.405 Test Loss: 2.124 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.328357219696045
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.118 Vali Acc: 0.405 Test Loss: 2.118 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.306834936141968
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.121 Vali Acc: 0.419 Test Loss: 2.121 Test Acc: 0.419
Validation loss decreased (-0.405390 --> -0.418898).  Saving model ...
Epoch: 13 cost time: 4.05142879486084
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.171 Vali Acc: 0.405 Test Loss: 2.171 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.420940399169922
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.196 Vali Acc: 0.419 Test Loss: 2.196 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.444814682006836
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.182 Vali Acc: 0.419 Test Loss: 2.182 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.388262987136841
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.218 Vali Acc: 0.405 Test Loss: 2.218 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.199920415878296
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.237 Vali Acc: 0.405 Test Loss: 2.237 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.318398714065552
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.249 Vali Acc: 0.419 Test Loss: 2.249 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.266510725021362
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.262 Vali Acc: 0.405 Test Loss: 2.262 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.274648904800415
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.286 Vali Acc: 0.405 Test Loss: 2.286 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.457693576812744
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.292 Vali Acc: 0.405 Test Loss: 2.292 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.371589183807373
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.313 Vali Acc: 0.405 Test Loss: 2.313 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.346101760864258
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.517 Vali Acc: 0.203 Test Loss: 1.517 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 4.211143732070923
Epoch: 2, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.418 Vali Acc: 0.324 Test Loss: 1.418 Test Acc: 0.324
Validation loss decreased (-0.202688 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 4.61681056022644
Epoch: 3, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.736 Vali Acc: 0.270 Test Loss: 1.736 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.24149489402771
Epoch: 4, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.515 Vali Acc: 0.338 Test Loss: 1.515 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337823).  Saving model ...
Epoch: 5 cost time: 4.296182632446289
Epoch: 5, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.566 Vali Acc: 0.311 Test Loss: 1.566 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.247014284133911
Epoch: 6, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.718 Vali Acc: 0.338 Test Loss: 1.718 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.3871989250183105
Epoch: 7, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.648 Vali Acc: 0.338 Test Loss: 1.648 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.163311243057251
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.895 Vali Acc: 0.311 Test Loss: 1.895 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.917177200317383
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.922 Vali Acc: 0.297 Test Loss: 1.922 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.07169246673584
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.041 Vali Acc: 0.365 Test Loss: 2.041 Test Acc: 0.365
Validation loss decreased (-0.337823 --> -0.364844).  Saving model ...
Epoch: 11 cost time: 4.204984903335571
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.012 Vali Acc: 0.311 Test Loss: 2.012 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.447532653808594
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.059 Vali Acc: 0.351 Test Loss: 2.059 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.265617609024048
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.067 Vali Acc: 0.311 Test Loss: 2.067 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.546056032180786
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.093 Vali Acc: 0.297 Test Loss: 2.093 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.407771587371826
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.078 Vali Acc: 0.311 Test Loss: 2.078 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.544877529144287
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.107 Vali Acc: 0.324 Test Loss: 2.107 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.558984756469727
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.131 Vali Acc: 0.324 Test Loss: 2.131 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.435486555099487
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.138 Vali Acc: 0.324 Test Loss: 2.138 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.525815486907959
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.150 Vali Acc: 0.324 Test Loss: 2.150 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.374203443527222
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.178 Vali Acc: 0.324 Test Loss: 2.178 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.6762049198150635
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.435 Vali Acc: 0.189 Test Loss: 1.435 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 3.9312825202941895
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.419 Vali Acc: 0.351 Test Loss: 1.419 Test Acc: 0.351
Validation loss decreased (-0.189175 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 4.2299981117248535
Epoch: 3, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.743 Vali Acc: 0.230 Test Loss: 1.743 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9649384021759033
Epoch: 4, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.614 Vali Acc: 0.378 Test Loss: 1.614 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378362).  Saving model ...
Epoch: 5 cost time: 3.7521562576293945
Epoch: 5, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.850 Vali Acc: 0.351 Test Loss: 1.850 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.097925424575806
Epoch: 6, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.885 Vali Acc: 0.297 Test Loss: 1.885 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.403351306915283
Epoch: 7, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.848 Vali Acc: 0.338 Test Loss: 1.848 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.330767631530762
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.143 Vali Acc: 0.297 Test Loss: 2.143 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.479020833969116
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.247 Vali Acc: 0.297 Test Loss: 2.247 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.301891088485718
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.182 Vali Acc: 0.338 Test Loss: 2.182 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.241505861282349
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.271 Vali Acc: 0.311 Test Loss: 2.271 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.844568967819214
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.344 Vali Acc: 0.324 Test Loss: 2.344 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.825876474380493
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.341 Vali Acc: 0.324 Test Loss: 2.341 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.676071643829346
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.382 Vali Acc: 0.311 Test Loss: 2.382 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.687816143035889
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.483 Vali Acc: 0.270 Test Loss: 1.483 Test Acc: 0.270
Validation loss decreased (inf --> -0.270255).  Saving model ...
Epoch: 2 cost time: 4.350884199142456
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.421 Vali Acc: 0.351 Test Loss: 1.421 Test Acc: 0.351
Validation loss decreased (-0.270255 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 4.173798322677612
Epoch: 3, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.713 Vali Acc: 0.162 Test Loss: 1.713 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.285078287124634
Epoch: 4, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.653 Vali Acc: 0.324 Test Loss: 1.653 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.490079641342163
Epoch: 5, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.814 Vali Acc: 0.297 Test Loss: 1.814 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.27074122428894
Epoch: 6, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.910 Vali Acc: 0.243 Test Loss: 1.910 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.954883337020874
Epoch: 7, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.942 Vali Acc: 0.338 Test Loss: 1.942 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.973893404006958
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.205 Vali Acc: 0.257 Test Loss: 2.205 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.694496154785156
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.283 Vali Acc: 0.351 Test Loss: 2.283 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.917245388031006
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.196 Vali Acc: 0.338 Test Loss: 2.196 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.546576261520386
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.299 Vali Acc: 0.270 Test Loss: 2.299 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.622483253479004
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.332 Vali Acc: 0.324 Test Loss: 2.332 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.887188673019409
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.448 Vali Acc: 0.162 Test Loss: 1.448 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 4.527991533279419
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.452 Vali Acc: 0.311 Test Loss: 1.452 Test Acc: 0.311
Validation loss decreased (-0.162148 --> -0.310796).  Saving model ...
Epoch: 3 cost time: 4.41261625289917
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.596 Vali Acc: 0.189 Test Loss: 1.596 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.461522579193115
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.642 Vali Acc: 0.243 Test Loss: 1.642 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.203196048736572
Epoch: 5, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.701 Vali Acc: 0.230 Test Loss: 1.701 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.2155070304870605
Epoch: 6, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.732 Vali Acc: 0.149 Test Loss: 1.732 Test Acc: 0.149
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.221423625946045
Epoch: 7, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.850 Vali Acc: 0.351 Test Loss: 1.850 Test Acc: 0.351
Validation loss decreased (-0.310796 --> -0.351333).  Saving model ...
Epoch: 8 cost time: 4.433617115020752
Epoch: 8, Steps: 10 | Train Loss: 0.375 Vali Loss: 2.549 Vali Acc: 0.162 Test Loss: 2.549 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.640810012817383
Epoch: 9, Steps: 10 | Train Loss: 0.178 Vali Loss: 2.333 Vali Acc: 0.203 Test Loss: 2.333 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.604370594024658
Epoch: 10, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.963 Vali Acc: 0.338 Test Loss: 1.963 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.621539831161499
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.192 Vali Acc: 0.257 Test Loss: 2.192 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.701927423477173
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.379 Vali Acc: 0.270 Test Loss: 2.379 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.3267388343811035
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.302 Vali Acc: 0.189 Test Loss: 2.302 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.036545753479004
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.330 Vali Acc: 0.243 Test Loss: 2.330 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.5717973709106445
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.214 Vali Acc: 0.257 Test Loss: 2.214 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.437091588973999
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.328 Vali Acc: 0.230 Test Loss: 2.328 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.159831762313843
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.333 Vali Acc: 0.230 Test Loss: 2.333 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.7027976512908936
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.409 Vali Acc: 0.176 Test Loss: 1.409 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 4.068101644515991
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.393 Vali Acc: 0.365 Test Loss: 1.393 Test Acc: 0.365
Validation loss decreased (-0.175662 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 4.290837526321411
Epoch: 3, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.581 Vali Acc: 0.216 Test Loss: 1.581 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.249624013900757
Epoch: 4, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.520 Vali Acc: 0.297 Test Loss: 1.520 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.191659450531006
Epoch: 5, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.579 Vali Acc: 0.257 Test Loss: 1.579 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.040782928466797
Epoch: 6, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.709 Vali Acc: 0.203 Test Loss: 1.709 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.191037893295288
Epoch: 7, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.614 Vali Acc: 0.338 Test Loss: 1.614 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.150526762008667
Epoch: 8, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.984 Vali Acc: 0.243 Test Loss: 1.984 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.15794825553894
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.069 Vali Acc: 0.284 Test Loss: 2.069 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.345118284225464
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.871 Vali Acc: 0.365 Test Loss: 1.871 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.352487087249756
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.182 Vali Acc: 0.257 Test Loss: 2.182 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.9321916103363037
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.940 Vali Acc: 0.284 Test Loss: 1.940 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.385615348815918
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.419 Vali Acc: 0.203 Test Loss: 1.419 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 3.9422144889831543
Epoch: 2, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.400 Vali Acc: 0.257 Test Loss: 1.400 Test Acc: 0.257
Validation loss decreased (-0.202689 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 4.0277721881866455
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.437 Vali Acc: 0.230 Test Loss: 1.437 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.287216424942017
Epoch: 4, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.393 Vali Acc: 0.392 Test Loss: 1.393 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391878).  Saving model ...
Epoch: 5 cost time: 4.352262496948242
Epoch: 5, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.481 Vali Acc: 0.324 Test Loss: 1.481 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.2903971672058105
Epoch: 6, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.475 Vali Acc: 0.311 Test Loss: 1.475 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.907165765762329
Epoch: 7, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.526 Vali Acc: 0.365 Test Loss: 1.526 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.1442646980285645
Epoch: 8, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.911 Vali Acc: 0.257 Test Loss: 1.911 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.065171003341675
Epoch: 9, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.584 Vali Acc: 0.311 Test Loss: 1.584 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.135033369064331
Epoch: 10, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.586 Vali Acc: 0.311 Test Loss: 1.586 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.395231246948242
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.723 Vali Acc: 0.297 Test Loss: 1.723 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.288242340087891
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.788 Vali Acc: 0.284 Test Loss: 1.788 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.214890003204346
Epoch: 13, Steps: 10 | Train Loss: 0.092 Vali Loss: 2.236 Vali Acc: 0.284 Test Loss: 2.236 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.189981460571289
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.212 Vali Acc: 0.284 Test Loss: 2.212 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.880735158920288
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.430 Vali Acc: 0.338 Test Loss: 1.430 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 3.895814895629883
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.424 Vali Acc: 0.284 Test Loss: 1.424 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9678170680999756
Epoch: 3, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.446 Vali Acc: 0.284 Test Loss: 1.446 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.800100088119507
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.474 Vali Acc: 0.284 Test Loss: 1.474 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.931168794631958
Epoch: 5, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.418 Vali Acc: 0.297 Test Loss: 1.418 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.81137752532959
Epoch: 6, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.452 Vali Acc: 0.311 Test Loss: 1.452 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.2578794956207275
Epoch: 7, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.525 Vali Acc: 0.311 Test Loss: 1.525 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8742172718048096
Epoch: 8, Steps: 10 | Train Loss: 0.719 Vali Loss: 2.027 Vali Acc: 0.257 Test Loss: 2.027 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.832919120788574
Epoch: 9, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.644 Vali Acc: 0.297 Test Loss: 1.644 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.241198539733887
Epoch: 10, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.655 Vali Acc: 0.338 Test Loss: 1.655 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.399536848068237
Epoch: 11, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.746 Vali Acc: 0.297 Test Loss: 1.746 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 968580
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.080383777618408
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.370 Vali Acc: 0.338 Test Loss: 1.370 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 4.570214033126831
Epoch: 2, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 4.593848705291748
Epoch: 3, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 4.450739622116089
Epoch: 4, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.995 Vali Acc: 0.541 Test Loss: 0.995 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540531).  Saving model ...
Epoch: 5 cost time: 4.586522340774536
Epoch: 5, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
Validation loss decreased (-0.540531 --> -0.554044).  Saving model ...
Epoch: 6 cost time: 3.939847707748413
Epoch: 6, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.874 Vali Acc: 0.662 Test Loss: 0.874 Test Acc: 0.662
Validation loss decreased (-0.554044 --> -0.662153).  Saving model ...
Epoch: 7 cost time: 3.9985156059265137
Epoch: 7, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.800 Vali Acc: 0.662 Test Loss: 0.800 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662154).  Saving model ...
Epoch: 8 cost time: 3.97627592086792
Epoch: 8, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.798 Vali Acc: 0.608 Test Loss: 0.798 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.292887449264526
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.806 Vali Acc: 0.689 Test Loss: 0.806 Test Acc: 0.689
Validation loss decreased (-0.662154 --> -0.689181).  Saving model ...
Epoch: 10 cost time: 4.1580281257629395
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.836 Vali Acc: 0.676 Test Loss: 0.836 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.051187992095947
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.788 Vali Acc: 0.649 Test Loss: 0.788 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.361113548278809
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.824 Vali Acc: 0.676 Test Loss: 0.824 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.440216064453125
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.834 Vali Acc: 0.662 Test Loss: 0.834 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.473193168640137
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.662 Test Loss: 0.830 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.640640020370483
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.703 Test Loss: 0.818 Test Acc: 0.703
Validation loss decreased (-0.689181 --> -0.702695).  Saving model ...
Epoch: 16 cost time: 4.6818013191223145
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.676 Test Loss: 0.830 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.060521364212036
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.860 Vali Acc: 0.676 Test Loss: 0.860 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.328094482421875
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.689 Test Loss: 0.847 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.5891711711883545
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.662 Test Loss: 0.839 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.603039026260376
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.662 Test Loss: 0.849 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.6811182498931885
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.689 Test Loss: 0.847 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.234792470932007
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.676 Test Loss: 0.846 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.311311960220337
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.689 Test Loss: 0.855 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.441789150238037
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.676 Test Loss: 0.857 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.157531261444092
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.676 Test Loss: 0.871 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7027027027027027
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.2720465660095215
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.367 Vali Acc: 0.324 Test Loss: 1.367 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 4.187446355819702
Epoch: 2, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.302 Vali Acc: 0.378 Test Loss: 1.302 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 4.512651681900024
Epoch: 3, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.208 Vali Acc: 0.432 Test Loss: 1.208 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 4.168207168579102
Epoch: 4, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.079 Vali Acc: 0.527 Test Loss: 1.079 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 3.982207775115967
Epoch: 5, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 4.349590539932251
Epoch: 6, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.971 Vali Acc: 0.554 Test Loss: 0.971 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 4.44345235824585
Epoch: 7, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.903 Vali Acc: 0.608 Test Loss: 0.903 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608099).  Saving model ...
Epoch: 8 cost time: 4.6977667808532715
Epoch: 8, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.851 Vali Acc: 0.635 Test Loss: 0.851 Test Acc: 0.635
Validation loss decreased (-0.608099 --> -0.635127).  Saving model ...
Epoch: 9 cost time: 4.390607833862305
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.937 Vali Acc: 0.568 Test Loss: 0.937 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.66544771194458
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.892 Vali Acc: 0.622 Test Loss: 0.892 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.1905517578125
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.882 Vali Acc: 0.649 Test Loss: 0.882 Test Acc: 0.649
Validation loss decreased (-0.635127 --> -0.648640).  Saving model ...
Epoch: 12 cost time: 4.319735288619995
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.930 Vali Acc: 0.595 Test Loss: 0.930 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.3329551219940186
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.910 Vali Acc: 0.635 Test Loss: 0.910 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.069248914718628
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.906 Vali Acc: 0.622 Test Loss: 0.906 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.7743401527404785
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.915 Vali Acc: 0.622 Test Loss: 0.915 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.493978977203369
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.916 Vali Acc: 0.635 Test Loss: 0.916 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.285666465759277
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.595 Test Loss: 0.936 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.288733005523682
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.935 Vali Acc: 0.622 Test Loss: 0.935 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.3257763385772705
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.622 Test Loss: 0.924 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.294872999191284
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.928 Vali Acc: 0.622 Test Loss: 0.928 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.224036455154419
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.929 Vali Acc: 0.622 Test Loss: 0.929 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.986093282699585
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.409 Vali Acc: 0.351 Test Loss: 1.409 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 4.238502264022827
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.430 Vali Acc: 0.324 Test Loss: 1.430 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.085265398025513
Epoch: 3, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.423 Vali Acc: 0.297 Test Loss: 1.423 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.957399606704712
Epoch: 4, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.407 Vali Acc: 0.365 Test Loss: 1.407 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 4.117532730102539
Epoch: 5, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.523 Vali Acc: 0.297 Test Loss: 1.523 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.6957080364227295
Epoch: 6, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.509 Vali Acc: 0.392 Test Loss: 1.509 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391877).  Saving model ...
Epoch: 7 cost time: 4.23644757270813
Epoch: 7, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.502 Vali Acc: 0.405 Test Loss: 1.502 Test Acc: 0.405
Validation loss decreased (-0.391877 --> -0.405390).  Saving model ...
Epoch: 8 cost time: 4.495896577835083
Epoch: 8, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.497 Vali Acc: 0.432 Test Loss: 1.497 Test Acc: 0.432
Validation loss decreased (-0.405390 --> -0.432417).  Saving model ...
Epoch: 9 cost time: 4.574418306350708
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.631 Vali Acc: 0.405 Test Loss: 1.631 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.289086103439331
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.632 Vali Acc: 0.405 Test Loss: 1.632 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.131998062133789
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.711 Vali Acc: 0.419 Test Loss: 1.711 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.084168195724487
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.732 Vali Acc: 0.392 Test Loss: 1.732 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.227160453796387
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.726 Vali Acc: 0.392 Test Loss: 1.726 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.3202924728393555
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.758 Vali Acc: 0.405 Test Loss: 1.758 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.0840699672698975
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.785 Vali Acc: 0.405 Test Loss: 1.785 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.350524187088013
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.780 Vali Acc: 0.405 Test Loss: 1.780 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.2681145668029785
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.812 Vali Acc: 0.405 Test Loss: 1.812 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.233689546585083
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.844 Vali Acc: 0.419 Test Loss: 1.844 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.006113767623901
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.436 Vali Acc: 0.311 Test Loss: 1.436 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 4.473661422729492
Epoch: 2, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.475 Vali Acc: 0.270 Test Loss: 1.475 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.662147521972656
Epoch: 3, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.457 Vali Acc: 0.257 Test Loss: 1.457 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.12740159034729
Epoch: 4, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.443 Vali Acc: 0.297 Test Loss: 1.443 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.482857942581177
Epoch: 5, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.595 Vali Acc: 0.216 Test Loss: 1.595 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.3823888301849365
Epoch: 6, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.524 Vali Acc: 0.324 Test Loss: 1.524 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324309).  Saving model ...
Epoch: 7 cost time: 4.459384202957153
Epoch: 7, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.545 Vali Acc: 0.378 Test Loss: 1.545 Test Acc: 0.378
Validation loss decreased (-0.324309 --> -0.378363).  Saving model ...
Epoch: 8 cost time: 4.504356384277344
Epoch: 8, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.581 Vali Acc: 0.365 Test Loss: 1.581 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.468683242797852
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.720 Vali Acc: 0.351 Test Loss: 1.720 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.131303548812866
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.788 Vali Acc: 0.378 Test Loss: 1.788 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.293528079986572
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.844 Vali Acc: 0.392 Test Loss: 1.844 Test Acc: 0.392
Validation loss decreased (-0.378363 --> -0.391873).  Saving model ...
Epoch: 12 cost time: 4.174655914306641
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.888 Vali Acc: 0.378 Test Loss: 1.888 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.126522541046143
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.933 Vali Acc: 0.351 Test Loss: 1.933 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8522183895111084
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.957 Vali Acc: 0.351 Test Loss: 1.957 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.053766250610352
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.979 Vali Acc: 0.351 Test Loss: 1.979 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.176959276199341
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.989 Vali Acc: 0.338 Test Loss: 1.989 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6001574993133545
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.014 Vali Acc: 0.351 Test Loss: 2.014 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.103597640991211
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.028 Vali Acc: 0.338 Test Loss: 2.028 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.161809682846069
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.043 Vali Acc: 0.338 Test Loss: 2.043 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.880491256713867
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.060 Vali Acc: 0.338 Test Loss: 2.060 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.298839092254639
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.069 Vali Acc: 0.338 Test Loss: 2.069 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.093065977096558
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.253183603286743
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.465 Vali Acc: 0.243 Test Loss: 1.465 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.878981351852417
Epoch: 3, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.463 Vali Acc: 0.270 Test Loss: 1.463 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 4.375058889389038
Epoch: 4, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.462 Vali Acc: 0.324 Test Loss: 1.462 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 4.461519956588745
Epoch: 5, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.558 Vali Acc: 0.324 Test Loss: 1.558 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.684279918670654
Epoch: 6, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.611 Vali Acc: 0.405 Test Loss: 1.611 Test Acc: 0.405
Validation loss decreased (-0.324310 --> -0.405389).  Saving model ...
Epoch: 7 cost time: 4.2359395027160645
Epoch: 7, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.636 Vali Acc: 0.297 Test Loss: 1.636 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.331850051879883
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.662 Vali Acc: 0.324 Test Loss: 1.662 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.19873046875
Epoch: 9, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.807 Vali Acc: 0.351 Test Loss: 1.807 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.115780591964722
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.913 Vali Acc: 0.284 Test Loss: 1.913 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.9893205165863037
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.960 Vali Acc: 0.365 Test Loss: 1.960 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.502771615982056
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.988 Vali Acc: 0.338 Test Loss: 1.988 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.876877784729004
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.012 Vali Acc: 0.324 Test Loss: 2.012 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.44405460357666
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.023 Vali Acc: 0.324 Test Loss: 2.023 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.63261079788208
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.056 Vali Acc: 0.311 Test Loss: 2.056 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.504236459732056
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.081 Vali Acc: 0.311 Test Loss: 2.081 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.13972544670105
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.405 Vali Acc: 0.311 Test Loss: 1.405 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.418358564376831
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.448 Vali Acc: 0.243 Test Loss: 1.448 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.325792074203491
Epoch: 3, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.557178735733032
Epoch: 4, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.474 Vali Acc: 0.324 Test Loss: 1.474 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 4.210027456283569
Epoch: 5, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.583 Vali Acc: 0.203 Test Loss: 1.583 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0293073654174805
Epoch: 6, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.601 Vali Acc: 0.351 Test Loss: 1.601 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351335).  Saving model ...
Epoch: 7 cost time: 4.29449200630188
Epoch: 7, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.688 Vali Acc: 0.297 Test Loss: 1.688 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.151471853256226
Epoch: 8, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.755 Vali Acc: 0.270 Test Loss: 1.755 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.229382514953613
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 2.002 Vali Acc: 0.297 Test Loss: 2.002 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.256643772125244
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 2.002 Vali Acc: 0.284 Test Loss: 2.002 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.132936477661133
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.139 Vali Acc: 0.311 Test Loss: 2.139 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.396600008010864
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.154 Vali Acc: 0.297 Test Loss: 2.154 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.734591245651245
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.218 Vali Acc: 0.284 Test Loss: 2.218 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.398828744888306
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.235 Vali Acc: 0.338 Test Loss: 2.235 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.001536130905151
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.258 Vali Acc: 0.338 Test Loss: 2.258 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.392223119735718
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.297 Vali Acc: 0.297 Test Loss: 2.297 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.040887832641602
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.362 Vali Acc: 0.378 Test Loss: 1.362 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 4.517689228057861
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.445 Vali Acc: 0.176 Test Loss: 1.445 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.324945688247681
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.33339524269104
Epoch: 4, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9827258586883545
Epoch: 5, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.489 Vali Acc: 0.176 Test Loss: 1.489 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.702186346054077
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.557 Vali Acc: 0.257 Test Loss: 1.557 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.3809733390808105
Epoch: 7, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.537 Vali Acc: 0.243 Test Loss: 1.537 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.413002014160156
Epoch: 8, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.687 Vali Acc: 0.216 Test Loss: 1.687 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.230975866317749
Epoch: 9, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.874 Vali Acc: 0.216 Test Loss: 1.874 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.003284215927124
Epoch: 10, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.843 Vali Acc: 0.257 Test Loss: 1.843 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.225035667419434
Epoch: 11, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.976 Vali Acc: 0.243 Test Loss: 1.976 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.066908359527588
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.362 Vali Acc: 0.311 Test Loss: 1.362 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.2622175216674805
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.405 Vali Acc: 0.189 Test Loss: 1.405 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.187828540802002
Epoch: 3, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.402 Vali Acc: 0.257 Test Loss: 1.402 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.328871011734009
Epoch: 4, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.408 Vali Acc: 0.257 Test Loss: 1.408 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.126558780670166
Epoch: 5, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.473 Vali Acc: 0.284 Test Loss: 1.473 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.09864068031311
Epoch: 6, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.444 Vali Acc: 0.338 Test Loss: 1.444 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337823).  Saving model ...
Epoch: 7 cost time: 4.03294825553894
Epoch: 7, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.495 Vali Acc: 0.311 Test Loss: 1.495 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.773134708404541
Epoch: 8, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.544 Vali Acc: 0.297 Test Loss: 1.544 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.015303611755371
Epoch: 9, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.739 Vali Acc: 0.270 Test Loss: 1.739 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.316434144973755
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.727 Vali Acc: 0.257 Test Loss: 1.727 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.08093523979187
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.792 Vali Acc: 0.257 Test Loss: 1.792 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.0641632080078125
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.953 Vali Acc: 0.243 Test Loss: 1.953 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.139174699783325
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.907 Vali Acc: 0.243 Test Loss: 1.907 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.074075222015381
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.955 Vali Acc: 0.270 Test Loss: 1.955 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.022768259048462
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.975 Vali Acc: 0.311 Test Loss: 1.975 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.449737071990967
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.984 Vali Acc: 0.284 Test Loss: 1.984 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.1907639503479
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.451 Vali Acc: 0.311 Test Loss: 1.451 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 4.5825419425964355
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.454 Vali Acc: 0.284 Test Loss: 1.454 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.370977401733398
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.478 Vali Acc: 0.216 Test Loss: 1.478 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.342439889907837
Epoch: 4, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.474 Vali Acc: 0.257 Test Loss: 1.474 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.6090407371521
Epoch: 5, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.443 Vali Acc: 0.311 Test Loss: 1.443 Test Acc: 0.311
Validation loss decreased (-0.310796 --> -0.310796).  Saving model ...
Epoch: 6 cost time: 4.824645519256592
Epoch: 6, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.493 Vali Acc: 0.243 Test Loss: 1.493 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.695379257202148
Epoch: 7, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.459 Vali Acc: 0.284 Test Loss: 1.459 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.291025161743164
Epoch: 8, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.480 Vali Acc: 0.311 Test Loss: 1.480 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.121034383773804
Epoch: 9, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.511 Vali Acc: 0.284 Test Loss: 1.511 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.258112907409668
Epoch: 10, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.547 Vali Acc: 0.311 Test Loss: 1.547 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.33551812171936
Epoch: 11, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.576 Vali Acc: 0.284 Test Loss: 1.576 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.201319932937622
Epoch: 12, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.735 Vali Acc: 0.216 Test Loss: 1.735 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.206712245941162
Epoch: 13, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.782 Vali Acc: 0.216 Test Loss: 1.782 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.200772047042847
Epoch: 14, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.876 Vali Acc: 0.270 Test Loss: 1.876 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.44199013710022
Epoch: 15, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.903 Vali Acc: 0.243 Test Loss: 1.903 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.66793417930603
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.361 Vali Acc: 0.351 Test Loss: 1.361 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 3.970872163772583
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.356 Vali Acc: 0.351 Test Loss: 1.356 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 4.54237961769104
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.379 Vali Acc: 0.270 Test Loss: 1.379 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.41156530380249
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.388 Vali Acc: 0.324 Test Loss: 1.388 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.998387098312378
Epoch: 5, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.377 Vali Acc: 0.338 Test Loss: 1.377 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.241032838821411
Epoch: 6, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.392 Vali Acc: 0.324 Test Loss: 1.392 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.38309645652771
Epoch: 7, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.352 Vali Acc: 0.365 Test Loss: 1.352 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364851).  Saving model ...
Epoch: 8 cost time: 4.319431781768799
Epoch: 8, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.346 Vali Acc: 0.365 Test Loss: 1.346 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364851).  Saving model ...
Epoch: 9 cost time: 4.306866407394409
Epoch: 9, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.367 Vali Acc: 0.311 Test Loss: 1.367 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.475445508956909
Epoch: 10, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.416 Vali Acc: 0.365 Test Loss: 1.416 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.211637735366821
Epoch: 11, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.411 Vali Acc: 0.351 Test Loss: 1.411 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.648855924606323
Epoch: 12, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.525 Vali Acc: 0.311 Test Loss: 1.525 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.559683084487915
Epoch: 13, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.560 Vali Acc: 0.284 Test Loss: 1.560 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.340928077697754
Epoch: 14, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.576 Vali Acc: 0.311 Test Loss: 1.576 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.686239957809448
Epoch: 15, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.731 Vali Acc: 0.257 Test Loss: 1.731 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.7396581172943115
Epoch: 16, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.951 Vali Acc: 0.176 Test Loss: 1.951 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.957020282745361
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.750 Vali Acc: 0.392 Test Loss: 1.750 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391874).  Saving model ...
Epoch: 18 cost time: 4.94999623298645
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.934 Vali Acc: 0.311 Test Loss: 1.934 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.705779790878296
Epoch: 19, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.888 Vali Acc: 0.338 Test Loss: 1.888 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.961923360824585
Epoch: 20, Steps: 10 | Train Loss: 0.086 Vali Loss: 2.006 Vali Acc: 0.392 Test Loss: 2.006 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.746728897094727
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 2.573 Vali Acc: 0.189 Test Loss: 2.573 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.527210235595703
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 2.164 Vali Acc: 0.338 Test Loss: 2.164 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.610300540924072
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.181 Vali Acc: 0.365 Test Loss: 2.181 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.440380334854126
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.357 Vali Acc: 0.230 Test Loss: 2.357 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.38123631477356
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.584 Vali Acc: 0.365 Test Loss: 2.584 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.227022886276245
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.554 Vali Acc: 0.297 Test Loss: 2.554 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.5276780128479
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.640 Vali Acc: 0.324 Test Loss: 2.640 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 1057732
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.11540675163269
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.373 Vali Acc: 0.311 Test Loss: 1.373 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.497610569000244
Epoch: 2, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 4.5565268993377686
Epoch: 3, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 4.014893293380737
Epoch: 4, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594584).  Saving model ...
Epoch: 5 cost time: 4.47071385383606
Epoch: 5, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.966 Vali Acc: 0.608 Test Loss: 0.966 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 6 cost time: 4.124143123626709
Epoch: 6, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.996 Vali Acc: 0.568 Test Loss: 0.996 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.376806020736694
Epoch: 7, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.923 Vali Acc: 0.608 Test Loss: 0.923 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 8 cost time: 4.187723398208618
Epoch: 8, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.917 Vali Acc: 0.635 Test Loss: 0.917 Test Acc: 0.635
Validation loss decreased (-0.608099 --> -0.635126).  Saving model ...
Epoch: 9 cost time: 4.567376136779785
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.041 Vali Acc: 0.581 Test Loss: 1.041 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.206460475921631
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.934 Vali Acc: 0.595 Test Loss: 0.934 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.316662073135376
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.917 Vali Acc: 0.622 Test Loss: 0.917 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.052873373031616
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.905 Vali Acc: 0.649 Test Loss: 0.905 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648640).  Saving model ...
Epoch: 13 cost time: 4.031728744506836
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.876 Vali Acc: 0.676 Test Loss: 0.876 Test Acc: 0.676
Validation loss decreased (-0.648640 --> -0.675667).  Saving model ...
Epoch: 14 cost time: 3.959717273712158
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.880 Vali Acc: 0.662 Test Loss: 0.880 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.695532321929932
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.891 Vali Acc: 0.662 Test Loss: 0.891 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.335077524185181
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.892 Vali Acc: 0.662 Test Loss: 0.892 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.2591211795806885
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.676 Test Loss: 0.893 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.692119836807251
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.887 Vali Acc: 0.676 Test Loss: 0.887 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.734559774398804
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.898 Vali Acc: 0.676 Test Loss: 0.898 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.671106338500977
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.676 Test Loss: 0.900 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.1761252880096436
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.901 Vali Acc: 0.676 Test Loss: 0.901 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.290806770324707
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.676 Test Loss: 0.898 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.57256555557251
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.676 Test Loss: 0.899 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.378015518188477
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.378 Vali Acc: 0.284 Test Loss: 1.378 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.884974956512451
Epoch: 2, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.297 Vali Acc: 0.378 Test Loss: 1.297 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 3.969449996948242
Epoch: 3, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 3.911311388015747
Epoch: 4, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.128 Vali Acc: 0.432 Test Loss: 1.128 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.375958442687988
Epoch: 5, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.039 Vali Acc: 0.541 Test Loss: 1.039 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 4.15754508972168
Epoch: 6, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.111 Vali Acc: 0.514 Test Loss: 1.111 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0537331104278564
Epoch: 7, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.999 Vali Acc: 0.581 Test Loss: 0.999 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 4.379117488861084
Epoch: 8, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.863679885864258
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.105 Vali Acc: 0.554 Test Loss: 1.105 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.457526683807373
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 4.115631341934204
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.397807359695435
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.211677551269531
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.022 Vali Acc: 0.608 Test Loss: 1.022 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 4.4202728271484375
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.255903959274292
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.045 Vali Acc: 0.581 Test Loss: 1.045 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.026517868041992
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.039 Vali Acc: 0.595 Test Loss: 1.039 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.0400543212890625
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.906261920928955
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.023 Vali Acc: 0.608 Test Loss: 1.023 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.2558066844940186
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.040 Vali Acc: 0.608 Test Loss: 1.040 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.287339687347412
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.254996061325073
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.608 Test Loss: 1.055 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.261619329452515
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 23 cost time: 3.9273412227630615
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 24 cost time: 4.238979339599609
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.608 Test Loss: 1.046 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.282464027404785
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.560241222381592
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.608 Test Loss: 1.056 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.196474552154541
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.622 Test Loss: 1.056 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.382015943527222
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.635 Test Loss: 1.057 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 29 cost time: 4.389197587966919
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.635 Test Loss: 1.059 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.362922191619873
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.064 Vali Acc: 0.635 Test Loss: 1.064 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.482638835906982
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.635 Test Loss: 1.073 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.386098384857178
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.635 Test Loss: 1.075 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.768807888031006
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.635 Test Loss: 1.077 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.020093679428101
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.649 Test Loss: 1.074 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 35 cost time: 4.210883617401123
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.086 Vali Acc: 0.649 Test Loss: 1.086 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.127143144607544
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.649 Test Loss: 1.084 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.062756538391113
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.085 Vali Acc: 0.649 Test Loss: 1.085 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.152570724487305
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.649 Test Loss: 1.090 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.2042555809021
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.635 Test Loss: 1.097 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.409089803695679
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.635 Test Loss: 1.102 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.199857711791992
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.649 Test Loss: 1.105 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.196577310562134
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.635 Test Loss: 1.109 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.9641942977905273
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.115 Vali Acc: 0.635 Test Loss: 1.115 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.347377777099609
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.115 Vali Acc: 0.649 Test Loss: 1.115 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.682448148727417
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.163385629653931
Epoch: 2, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.409 Vali Acc: 0.297 Test Loss: 1.409 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 4.073680639266968
Epoch: 3, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.430 Vali Acc: 0.270 Test Loss: 1.430 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.215969085693359
Epoch: 4, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.442 Vali Acc: 0.351 Test Loss: 1.442 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351337).  Saving model ...
Epoch: 5 cost time: 3.622194766998291
Epoch: 5, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.444 Vali Acc: 0.405 Test Loss: 1.444 Test Acc: 0.405
Validation loss decreased (-0.351337 --> -0.405391).  Saving model ...
Epoch: 6 cost time: 4.435078144073486
Epoch: 6, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.562 Vali Acc: 0.365 Test Loss: 1.562 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7642247676849365
Epoch: 7, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.610 Vali Acc: 0.324 Test Loss: 1.610 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8281304836273193
Epoch: 8, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.680 Vali Acc: 0.419 Test Loss: 1.680 Test Acc: 0.419
Validation loss decreased (-0.405391 --> -0.418902).  Saving model ...
Epoch: 9 cost time: 3.766741991043091
Epoch: 9, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.826 Vali Acc: 0.311 Test Loss: 1.826 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.29271936416626
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.814 Vali Acc: 0.432 Test Loss: 1.814 Test Acc: 0.432
Validation loss decreased (-0.418902 --> -0.432414).  Saving model ...
Epoch: 11 cost time: 4.3220555782318115
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.843 Vali Acc: 0.419 Test Loss: 1.843 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.642146110534668
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.843 Vali Acc: 0.392 Test Loss: 1.843 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.397069931030273
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.897 Vali Acc: 0.405 Test Loss: 1.897 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.485706567764282
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.917 Vali Acc: 0.419 Test Loss: 1.917 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.375049591064453
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.952 Vali Acc: 0.405 Test Loss: 1.952 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.393807649612427
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.961 Vali Acc: 0.419 Test Loss: 1.961 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.2363035678863525
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.960 Vali Acc: 0.405 Test Loss: 1.960 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.408539533615112
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.979 Vali Acc: 0.432 Test Loss: 1.979 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.2174906730651855
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.011 Vali Acc: 0.419 Test Loss: 2.011 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.295186758041382
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.003 Vali Acc: 0.419 Test Loss: 2.003 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.621665716171265
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.412 Vali Acc: 0.203 Test Loss: 1.412 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 4.245016813278198
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
Validation loss decreased (-0.202689 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 3.961897373199463
Epoch: 3, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 4.244921922683716
Epoch: 4, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.466 Vali Acc: 0.243 Test Loss: 1.466 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.086282014846802
Epoch: 5, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.431 Vali Acc: 0.378 Test Loss: 1.431 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378364).  Saving model ...
Epoch: 6 cost time: 4.288626670837402
Epoch: 6, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.557 Vali Acc: 0.311 Test Loss: 1.557 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.297834634780884
Epoch: 7, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.690 Vali Acc: 0.270 Test Loss: 1.690 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.023678779602051
Epoch: 8, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.717 Vali Acc: 0.351 Test Loss: 1.717 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.281375169754028
Epoch: 9, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.885 Vali Acc: 0.284 Test Loss: 1.885 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.491967439651489
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.791 Vali Acc: 0.324 Test Loss: 1.791 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.200857400894165
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.868 Vali Acc: 0.284 Test Loss: 1.868 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.447312593460083
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.907 Vali Acc: 0.270 Test Loss: 1.907 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.588367223739624
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.941 Vali Acc: 0.297 Test Loss: 1.941 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.34363317489624
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.942 Vali Acc: 0.297 Test Loss: 1.942 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.135282278060913
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.970 Vali Acc: 0.297 Test Loss: 1.970 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.477940797805786
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.7862188816070557
Epoch: 2, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.428 Vali Acc: 0.284 Test Loss: 1.428 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 4.090080261230469
Epoch: 3, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.453 Vali Acc: 0.338 Test Loss: 1.453 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337823).  Saving model ...
Epoch: 4 cost time: 3.8811745643615723
Epoch: 4, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.520 Vali Acc: 0.243 Test Loss: 1.520 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.205246210098267
Epoch: 5, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.503 Vali Acc: 0.324 Test Loss: 1.503 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.04873251914978
Epoch: 6, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.613 Vali Acc: 0.297 Test Loss: 1.613 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.306854724884033
Epoch: 7, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.825 Vali Acc: 0.270 Test Loss: 1.825 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.338355779647827
Epoch: 8, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.825 Vali Acc: 0.365 Test Loss: 1.825 Test Acc: 0.365
Validation loss decreased (-0.337823 --> -0.364847).  Saving model ...
Epoch: 9 cost time: 4.376375436782837
Epoch: 9, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.928 Vali Acc: 0.297 Test Loss: 1.928 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.460066556930542
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.894 Vali Acc: 0.365 Test Loss: 1.894 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.088839054107666
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.024 Vali Acc: 0.311 Test Loss: 2.024 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.163960218429565
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.029 Vali Acc: 0.351 Test Loss: 2.029 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.312581777572632
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.141 Vali Acc: 0.297 Test Loss: 2.141 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.0100743770599365
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.113 Vali Acc: 0.311 Test Loss: 2.113 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.0916008949279785
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.139 Vali Acc: 0.324 Test Loss: 2.139 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.078969478607178
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.184 Vali Acc: 0.311 Test Loss: 2.184 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.9326133728027344
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.200 Vali Acc: 0.311 Test Loss: 2.200 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.8387787342071533
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.209 Vali Acc: 0.297 Test Loss: 2.209 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.783864498138428
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.411 Vali Acc: 0.284 Test Loss: 1.411 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.950895309448242
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.428 Vali Acc: 0.216 Test Loss: 1.428 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.295388698577881
Epoch: 3, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.434 Vali Acc: 0.243 Test Loss: 1.434 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.427941799163818
Epoch: 4, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.511 Vali Acc: 0.162 Test Loss: 1.511 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.407456636428833
Epoch: 5, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.493 Vali Acc: 0.324 Test Loss: 1.493 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324309).  Saving model ...
Epoch: 6 cost time: 4.071559190750122
Epoch: 6, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.629 Vali Acc: 0.243 Test Loss: 1.629 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.243851184844971
Epoch: 7, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.769 Vali Acc: 0.216 Test Loss: 1.769 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.07751727104187
Epoch: 8, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.843 Vali Acc: 0.378 Test Loss: 1.843 Test Acc: 0.378
Validation loss decreased (-0.324309 --> -0.378360).  Saving model ...
Epoch: 9 cost time: 4.288800477981567
Epoch: 9, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.934 Vali Acc: 0.243 Test Loss: 1.934 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.4319541454315186
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.928 Vali Acc: 0.324 Test Loss: 1.928 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9636294841766357
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.036 Vali Acc: 0.257 Test Loss: 2.036 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.999572515487671
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.110 Vali Acc: 0.270 Test Loss: 2.110 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.8085386753082275
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.146 Vali Acc: 0.284 Test Loss: 2.146 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.768359899520874
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.169 Vali Acc: 0.257 Test Loss: 2.169 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.064306020736694
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.199 Vali Acc: 0.284 Test Loss: 2.199 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.7223336696624756
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.220 Vali Acc: 0.297 Test Loss: 2.220 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.91603422164917
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.278 Vali Acc: 0.297 Test Loss: 2.278 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.990692615509033
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.279 Vali Acc: 0.257 Test Loss: 2.279 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.743379592895508
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.387 Vali Acc: 0.311 Test Loss: 1.387 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.2653350830078125
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.415 Vali Acc: 0.284 Test Loss: 1.415 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.452662706375122
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.455 Vali Acc: 0.338 Test Loss: 1.455 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337823).  Saving model ...
Epoch: 4 cost time: 4.168674468994141
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.515 Vali Acc: 0.189 Test Loss: 1.515 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.245693683624268
Epoch: 5, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.460 Vali Acc: 0.284 Test Loss: 1.460 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.3301122188568115
Epoch: 6, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.522 Vali Acc: 0.203 Test Loss: 1.522 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.204911231994629
Epoch: 7, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.659 Vali Acc: 0.257 Test Loss: 1.659 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.202025413513184
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.598 Vali Acc: 0.378 Test Loss: 1.598 Test Acc: 0.378
Validation loss decreased (-0.337823 --> -0.378362).  Saving model ...
Epoch: 9 cost time: 3.8558430671691895
Epoch: 9, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.810 Vali Acc: 0.230 Test Loss: 1.810 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.07356333732605
Epoch: 10, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.726 Vali Acc: 0.257 Test Loss: 1.726 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.986731767654419
Epoch: 11, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.911 Vali Acc: 0.216 Test Loss: 1.911 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9001171588897705
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 2.018 Vali Acc: 0.216 Test Loss: 2.018 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.248425722122192
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.130 Vali Acc: 0.270 Test Loss: 2.130 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.216076612472534
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.225 Vali Acc: 0.243 Test Loss: 2.225 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.0027916431427
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.149 Vali Acc: 0.257 Test Loss: 2.149 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.273741245269775
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.209 Vali Acc: 0.243 Test Loss: 2.209 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.141677379608154
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.321 Vali Acc: 0.216 Test Loss: 2.321 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.30971360206604
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.322 Vali Acc: 0.243 Test Loss: 2.322 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.100422143936157
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.412 Vali Acc: 0.284 Test Loss: 1.412 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 4.582860469818115
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.429 Vali Acc: 0.284 Test Loss: 1.429 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.542212009429932
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.453 Vali Acc: 0.257 Test Loss: 1.453 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.126552581787109
Epoch: 4, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.501 Vali Acc: 0.176 Test Loss: 1.501 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.968900203704834
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.470 Vali Acc: 0.324 Test Loss: 1.470 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324310).  Saving model ...
Epoch: 6 cost time: 4.144198656082153
Epoch: 6, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.557 Vali Acc: 0.189 Test Loss: 1.557 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.347689867019653
Epoch: 7, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.648 Vali Acc: 0.216 Test Loss: 1.648 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.148216962814331
Epoch: 8, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.608 Vali Acc: 0.351 Test Loss: 1.608 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351335).  Saving model ...
Epoch: 9 cost time: 4.0139806270599365
Epoch: 9, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.836 Vali Acc: 0.189 Test Loss: 1.836 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.265872001647949
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.720 Vali Acc: 0.338 Test Loss: 1.720 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.461324691772461
Epoch: 11, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.846 Vali Acc: 0.230 Test Loss: 1.846 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.441525459289551
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.898 Vali Acc: 0.243 Test Loss: 1.898 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.570878267288208
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.896 Vali Acc: 0.257 Test Loss: 1.896 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.401706218719482
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.952 Vali Acc: 0.257 Test Loss: 1.952 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.125092267990112
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.998 Vali Acc: 0.257 Test Loss: 1.998 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.334959268569946
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.944 Vali Acc: 0.297 Test Loss: 1.944 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.468039512634277
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.054 Vali Acc: 0.257 Test Loss: 2.054 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.537085056304932
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.094 Vali Acc: 0.284 Test Loss: 2.094 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.558117389678955
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.482 Vali Acc: 0.230 Test Loss: 1.482 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 4.2259016036987305
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.488 Vali Acc: 0.230 Test Loss: 1.488 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.179133176803589
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.486 Vali Acc: 0.216 Test Loss: 1.486 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.1768574714660645
Epoch: 4, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.533 Vali Acc: 0.176 Test Loss: 1.533 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.2527782917022705
Epoch: 5, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.513 Vali Acc: 0.203 Test Loss: 1.513 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.143342018127441
Epoch: 6, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.466 Vali Acc: 0.270 Test Loss: 1.466 Test Acc: 0.270
Validation loss decreased (-0.229715 --> -0.270256).  Saving model ...
Epoch: 7 cost time: 4.56126070022583
Epoch: 7, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.552 Vali Acc: 0.176 Test Loss: 1.552 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3442223072052
Epoch: 8, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.516 Vali Acc: 0.216 Test Loss: 1.516 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.330985069274902
Epoch: 9, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.637 Vali Acc: 0.216 Test Loss: 1.637 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.555316925048828
Epoch: 10, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.531 Vali Acc: 0.270 Test Loss: 1.531 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.554502248764038
Epoch: 11, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.698 Vali Acc: 0.230 Test Loss: 1.698 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.743008375167847
Epoch: 12, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.635 Vali Acc: 0.176 Test Loss: 1.635 Test Acc: 0.176
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.196892261505127
Epoch: 13, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.667 Vali Acc: 0.162 Test Loss: 1.667 Test Acc: 0.162
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.133990526199341
Epoch: 14, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.887 Vali Acc: 0.284 Test Loss: 1.887 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283765).  Saving model ...
Epoch: 15 cost time: 4.02590012550354
Epoch: 15, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.798 Vali Acc: 0.216 Test Loss: 1.798 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9411516189575195
Epoch: 16, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.945 Vali Acc: 0.189 Test Loss: 1.945 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.06491231918335
Epoch: 17, Steps: 10 | Train Loss: 0.100 Vali Loss: 2.068 Vali Acc: 0.176 Test Loss: 2.068 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.3850157260894775
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.248 Vali Acc: 0.203 Test Loss: 2.248 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.8728463649749756
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 2.093 Vali Acc: 0.230 Test Loss: 2.093 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.882925033569336
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.388 Vali Acc: 0.243 Test Loss: 2.388 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.879420280456543
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.264 Vali Acc: 0.203 Test Loss: 2.264 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.9326767921447754
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.382 Vali Acc: 0.230 Test Loss: 2.382 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.042163372039795
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.380 Vali Acc: 0.243 Test Loss: 2.380 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.455008029937744
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.523 Vali Acc: 0.203 Test Loss: 2.523 Test Acc: 0.203
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.28378378378378377
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.941129207611084
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.361 Vali Acc: 0.257 Test Loss: 1.361 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.054770469665527
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.348 Vali Acc: 0.297 Test Loss: 1.348 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 4.066184043884277
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.366 Vali Acc: 0.324 Test Loss: 1.366 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 4.093895673751831
Epoch: 4, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.393 Vali Acc: 0.297 Test Loss: 1.393 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.849392890930176
Epoch: 5, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.399 Vali Acc: 0.378 Test Loss: 1.399 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378364).  Saving model ...
Epoch: 6 cost time: 3.9413135051727295
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.320 Vali Acc: 0.338 Test Loss: 1.320 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8703136444091797
Epoch: 7, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.426 Vali Acc: 0.243 Test Loss: 1.426 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.178812742233276
Epoch: 8, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.404 Vali Acc: 0.311 Test Loss: 1.404 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.9753737449645996
Epoch: 9, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.429 Vali Acc: 0.365 Test Loss: 1.429 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.228772878646851
Epoch: 10, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.388 Vali Acc: 0.392 Test Loss: 1.388 Test Acc: 0.392
Validation loss decreased (-0.378364 --> -0.391878).  Saving model ...
Epoch: 11 cost time: 4.164448976516724
Epoch: 11, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.445 Vali Acc: 0.324 Test Loss: 1.445 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.100183963775635
Epoch: 12, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.505 Vali Acc: 0.311 Test Loss: 1.505 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.189804792404175
Epoch: 13, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.505 Vali Acc: 0.338 Test Loss: 1.505 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.2610321044921875
Epoch: 14, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.679 Vali Acc: 0.284 Test Loss: 1.679 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.625702381134033
Epoch: 15, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.549 Vali Acc: 0.324 Test Loss: 1.549 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.053248882293701
Epoch: 16, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.685 Vali Acc: 0.324 Test Loss: 1.685 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.037519931793213
Epoch: 17, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.762 Vali Acc: 0.311 Test Loss: 1.762 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.301999568939209
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.769 Vali Acc: 0.365 Test Loss: 1.769 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.288560152053833
Epoch: 19, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.842 Vali Acc: 0.351 Test Loss: 1.842 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.0952043533325195
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 2.005 Vali Acc: 0.324 Test Loss: 2.005 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 664516
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.720863580703735
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.366 Vali Acc: 0.311 Test Loss: 1.366 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 4.194466590881348
Epoch: 2, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
Validation loss decreased (-0.310797 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 4.528604507446289
Epoch: 3, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.138 Vali Acc: 0.622 Test Loss: 1.138 Test Acc: 0.622
Validation loss decreased (-0.486474 --> -0.621610).  Saving model ...
Epoch: 4 cost time: 4.333395719528198
Epoch: 4, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.126224756240845
Epoch: 5, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.573352813720703
Epoch: 6, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5848894119262695
Epoch: 7, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.652303695678711
Epoch: 8, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.918 Vali Acc: 0.662 Test Loss: 0.918 Test Acc: 0.662
Validation loss decreased (-0.621610 --> -0.662153).  Saving model ...
Epoch: 9 cost time: 4.63395881652832
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.878 Vali Acc: 0.649 Test Loss: 0.878 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.582553386688232
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.892 Vali Acc: 0.622 Test Loss: 0.892 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.591962575912476
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.855 Vali Acc: 0.649 Test Loss: 0.855 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.591616630554199
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.911 Vali Acc: 0.676 Test Loss: 0.911 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675667).  Saving model ...
Epoch: 13 cost time: 4.631560564041138
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.886 Vali Acc: 0.622 Test Loss: 0.886 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.469499826431274
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.882 Vali Acc: 0.622 Test Loss: 0.882 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.271992921829224
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.884 Vali Acc: 0.649 Test Loss: 0.884 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.886162042617798
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.878 Vali Acc: 0.649 Test Loss: 0.878 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.176742315292358
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.868 Vali Acc: 0.622 Test Loss: 0.868 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.156302452087402
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.888 Vali Acc: 0.635 Test Loss: 0.888 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.211888551712036
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.649 Test Loss: 0.886 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.422443389892578
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.884 Vali Acc: 0.622 Test Loss: 0.884 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.4749391078948975
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.888 Vali Acc: 0.635 Test Loss: 0.888 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.892557144165039
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.899 Vali Acc: 0.649 Test Loss: 0.899 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.550486326217651
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.403 Vali Acc: 0.230 Test Loss: 1.403 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 4.539024114608765
Epoch: 2, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.269 Vali Acc: 0.486 Test Loss: 1.269 Test Acc: 0.486
Validation loss decreased (-0.229716 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 4.842321157455444
Epoch: 3, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.194 Vali Acc: 0.554 Test Loss: 1.194 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 4.781858205795288
Epoch: 4, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.0246665477752686
Epoch: 5, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.083 Vali Acc: 0.446 Test Loss: 1.083 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.52553653717041
Epoch: 6, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5881006717681885
Epoch: 7, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 4.154714584350586
Epoch: 8, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.959 Vali Acc: 0.514 Test Loss: 0.959 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.050118446350098
Epoch: 9, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.973 Vali Acc: 0.581 Test Loss: 0.973 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 4.138417482376099
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.990 Vali Acc: 0.581 Test Loss: 0.990 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.175410985946655
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.951 Vali Acc: 0.568 Test Loss: 0.951 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.104916572570801
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.005 Vali Acc: 0.581 Test Loss: 1.005 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.328717231750488
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.967 Vali Acc: 0.581 Test Loss: 0.967 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 4.475731372833252
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.966 Vali Acc: 0.608 Test Loss: 0.966 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 4.442946672439575
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.975 Vali Acc: 0.581 Test Loss: 0.975 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.180833578109741
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.972 Vali Acc: 0.595 Test Loss: 0.972 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.797793865203857
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.971 Vali Acc: 0.595 Test Loss: 0.971 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.252336502075195
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.983 Vali Acc: 0.581 Test Loss: 0.983 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.07949423789978
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.986 Vali Acc: 0.595 Test Loss: 0.986 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.151138067245483
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.986 Vali Acc: 0.595 Test Loss: 0.986 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.65011191368103
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.595 Test Loss: 0.996 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.256680011749268
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.177788734436035
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.005 Vali Acc: 0.595 Test Loss: 1.005 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.077466726303101
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.998 Vali Acc: 0.595 Test Loss: 0.998 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.581753969192505
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.462 Vali Acc: 0.203 Test Loss: 1.462 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 3.888883352279663
Epoch: 2, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
Validation loss decreased (-0.202688 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 3.8619513511657715
Epoch: 3, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.409 Vali Acc: 0.378 Test Loss: 1.409 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378364).  Saving model ...
Epoch: 4 cost time: 4.196499347686768
Epoch: 4, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.434 Vali Acc: 0.392 Test Loss: 1.434 Test Acc: 0.392
Validation loss decreased (-0.378364 --> -0.391878).  Saving model ...
Epoch: 5 cost time: 3.908569574356079
Epoch: 5, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.447 Vali Acc: 0.351 Test Loss: 1.447 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.960465908050537
Epoch: 6, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.574 Vali Acc: 0.378 Test Loss: 1.574 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.134963274002075
Epoch: 7, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.555 Vali Acc: 0.378 Test Loss: 1.555 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.003696441650391
Epoch: 8, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.563 Vali Acc: 0.378 Test Loss: 1.563 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.823611259460449
Epoch: 9, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.640 Vali Acc: 0.405 Test Loss: 1.640 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405389).  Saving model ...
Epoch: 10 cost time: 3.815171003341675
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.709 Vali Acc: 0.432 Test Loss: 1.709 Test Acc: 0.432
Validation loss decreased (-0.405389 --> -0.432415).  Saving model ...
Epoch: 11 cost time: 3.933112144470215
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.772 Vali Acc: 0.405 Test Loss: 1.772 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.811832904815674
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.872 Vali Acc: 0.392 Test Loss: 1.872 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.929551839828491
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.832 Vali Acc: 0.432 Test Loss: 1.832 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7645981311798096
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.887 Vali Acc: 0.392 Test Loss: 1.887 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6341822147369385
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.895 Vali Acc: 0.432 Test Loss: 1.895 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.78735613822937
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.909 Vali Acc: 0.432 Test Loss: 1.909 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.8173394203186035
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.920 Vali Acc: 0.446 Test Loss: 1.920 Test Acc: 0.446
Validation loss decreased (-0.432415 --> -0.445927).  Saving model ...
Epoch: 18 cost time: 3.8074841499328613
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.944 Vali Acc: 0.432 Test Loss: 1.944 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.026482343673706
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.949 Vali Acc: 0.432 Test Loss: 1.949 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.965968132019043
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.966 Vali Acc: 0.446 Test Loss: 1.966 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.046133279800415
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.994 Vali Acc: 0.446 Test Loss: 1.994 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.9865524768829346
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.009 Vali Acc: 0.446 Test Loss: 2.009 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.314667224884033
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.027 Vali Acc: 0.446 Test Loss: 2.027 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.279324531555176
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.036 Vali Acc: 0.446 Test Loss: 2.036 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.509927034378052
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.052 Vali Acc: 0.446 Test Loss: 2.052 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.369480133056641
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.057 Vali Acc: 0.446 Test Loss: 2.057 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.084547758102417
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.063 Vali Acc: 0.446 Test Loss: 2.063 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.7709527015686035
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.410 Vali Acc: 0.284 Test Loss: 1.410 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.917421817779541
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.386 Vali Acc: 0.284 Test Loss: 1.386 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 3.9310519695281982
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.409 Vali Acc: 0.297 Test Loss: 1.409 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 3.8423500061035156
Epoch: 4, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6354289054870605
Epoch: 5, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.481 Vali Acc: 0.230 Test Loss: 1.481 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.928471326828003
Epoch: 6, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.599 Vali Acc: 0.270 Test Loss: 1.599 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.651625394821167
Epoch: 7, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.601 Vali Acc: 0.297 Test Loss: 1.601 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.5299272537231445
Epoch: 8, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.603 Vali Acc: 0.284 Test Loss: 1.603 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9573419094085693
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.616 Vali Acc: 0.297 Test Loss: 1.616 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.400290250778198
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.727 Vali Acc: 0.338 Test Loss: 1.727 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337821).  Saving model ...
Epoch: 11 cost time: 4.148890733718872
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.928 Vali Acc: 0.311 Test Loss: 1.928 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.167560577392578
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.864 Vali Acc: 0.324 Test Loss: 1.864 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.487834215164185
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.953 Vali Acc: 0.311 Test Loss: 1.953 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.387970685958862
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.022 Vali Acc: 0.338 Test Loss: 2.022 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.954763889312744
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.982 Vali Acc: 0.311 Test Loss: 1.982 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.873884677886963
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.014 Vali Acc: 0.324 Test Loss: 2.014 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.90219783782959
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.041 Vali Acc: 0.338 Test Loss: 2.041 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9450905323028564
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.079 Vali Acc: 0.351 Test Loss: 2.079 Test Acc: 0.351
Validation loss decreased (-0.337821 --> -0.351331).  Saving model ...
Epoch: 19 cost time: 3.771728754043579
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.077 Vali Acc: 0.324 Test Loss: 2.077 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.615945816040039
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.095 Vali Acc: 0.338 Test Loss: 2.095 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.018892049789429
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.128 Vali Acc: 0.338 Test Loss: 2.128 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7956368923187256
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.143 Vali Acc: 0.351 Test Loss: 2.143 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.070958614349365
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.159 Vali Acc: 0.338 Test Loss: 2.159 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.8817741870880127
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.172 Vali Acc: 0.338 Test Loss: 2.172 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.754523992538452
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.199 Vali Acc: 0.351 Test Loss: 2.199 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.993863582611084
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.203 Vali Acc: 0.338 Test Loss: 2.203 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.8930530548095703
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.206 Vali Acc: 0.338 Test Loss: 2.206 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.033806085586548
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.225 Vali Acc: 0.338 Test Loss: 2.225 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.641937494277954
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.9768271446228027
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.398 Vali Acc: 0.338 Test Loss: 1.398 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 4.0267534255981445
Epoch: 3, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.411 Vali Acc: 0.365 Test Loss: 1.411 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 3.702211618423462
Epoch: 4, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.475 Vali Acc: 0.338 Test Loss: 1.475 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.661195993423462
Epoch: 5, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.495 Vali Acc: 0.365 Test Loss: 1.495 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.249883651733398
Epoch: 6, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.635 Vali Acc: 0.338 Test Loss: 1.635 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.015554904937744
Epoch: 7, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.647 Vali Acc: 0.257 Test Loss: 1.647 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.807298421859741
Epoch: 8, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.647 Vali Acc: 0.338 Test Loss: 1.647 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.388885736465454
Epoch: 9, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.816 Vali Acc: 0.311 Test Loss: 1.816 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7533152103424072
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.820 Vali Acc: 0.365 Test Loss: 1.820 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.009838342666626
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.964 Vali Acc: 0.324 Test Loss: 1.964 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.8090219497680664
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.940 Vali Acc: 0.378 Test Loss: 1.940 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378359).  Saving model ...
Epoch: 13 cost time: 4.032193183898926
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.051 Vali Acc: 0.324 Test Loss: 2.051 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.051882743835449
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.052 Vali Acc: 0.351 Test Loss: 2.052 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.15275502204895
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.078 Vali Acc: 0.365 Test Loss: 2.078 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.959294319152832
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.075 Vali Acc: 0.324 Test Loss: 2.075 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8100850582122803
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.095 Vali Acc: 0.338 Test Loss: 2.095 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.802824020385742
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.138 Vali Acc: 0.378 Test Loss: 2.138 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.308166027069092
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.137 Vali Acc: 0.365 Test Loss: 2.137 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.423753976821899
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.158 Vali Acc: 0.351 Test Loss: 2.158 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.8564529418945312
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.190 Vali Acc: 0.378 Test Loss: 2.190 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.346029996871948
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.188 Vali Acc: 0.338 Test Loss: 2.188 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.234813928604126
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.438 Vali Acc: 0.257 Test Loss: 1.438 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 4.25529408454895
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.437 Vali Acc: 0.257 Test Loss: 1.437 Test Acc: 0.257
Validation loss decreased (-0.256742 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 4.034735918045044
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.441 Vali Acc: 0.311 Test Loss: 1.441 Test Acc: 0.311
Validation loss decreased (-0.256742 --> -0.310796).  Saving model ...
Epoch: 4 cost time: 3.9646146297454834
Epoch: 4, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.507 Vali Acc: 0.257 Test Loss: 1.507 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.02746057510376
Epoch: 5, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.533 Vali Acc: 0.270 Test Loss: 1.533 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.943843126296997
Epoch: 6, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.656 Vali Acc: 0.324 Test Loss: 1.656 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324308).  Saving model ...
Epoch: 7 cost time: 3.991879463195801
Epoch: 7, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.743 Vali Acc: 0.270 Test Loss: 1.743 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.284212112426758
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.716 Vali Acc: 0.324 Test Loss: 1.716 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.467487812042236
Epoch: 9, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.795 Vali Acc: 0.284 Test Loss: 1.795 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.838210105895996
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.823 Vali Acc: 0.405 Test Loss: 1.823 Test Acc: 0.405
Validation loss decreased (-0.324308 --> -0.405387).  Saving model ...
Epoch: 11 cost time: 4.344216585159302
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.028 Vali Acc: 0.311 Test Loss: 2.028 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.167981386184692
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.014 Vali Acc: 0.284 Test Loss: 2.014 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.210710525512695
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.125 Vali Acc: 0.324 Test Loss: 2.125 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.436400651931763
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.199 Vali Acc: 0.324 Test Loss: 2.199 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.163357734680176
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.196 Vali Acc: 0.324 Test Loss: 2.196 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.066651344299316
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.227 Vali Acc: 0.365 Test Loss: 2.227 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.512871980667114
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.254 Vali Acc: 0.351 Test Loss: 2.254 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.762640953063965
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.289 Vali Acc: 0.324 Test Loss: 2.289 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.248766899108887
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.285 Vali Acc: 0.324 Test Loss: 2.285 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9741365909576416
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.316 Vali Acc: 0.351 Test Loss: 2.316 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.495702505111694
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.793919086456299
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.442 Vali Acc: 0.243 Test Loss: 1.442 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.02687931060791
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.464 Vali Acc: 0.324 Test Loss: 1.464 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 4.099060535430908
Epoch: 4, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.512 Vali Acc: 0.230 Test Loss: 1.512 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9679782390594482
Epoch: 5, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.503 Vali Acc: 0.270 Test Loss: 1.503 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.170809030532837
Epoch: 6, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.607 Vali Acc: 0.284 Test Loss: 1.607 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.355710983276367
Epoch: 7, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.693 Vali Acc: 0.216 Test Loss: 1.693 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.156457424163818
Epoch: 8, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.635 Vali Acc: 0.203 Test Loss: 1.635 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.379215478897095
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.804 Vali Acc: 0.243 Test Loss: 1.804 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.097565650939941
Epoch: 10, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.677 Vali Acc: 0.311 Test Loss: 1.677 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.155156850814819
Epoch: 11, Steps: 10 | Train Loss: 0.136 Vali Loss: 2.049 Vali Acc: 0.270 Test Loss: 2.049 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.9044742584228516
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.976 Vali Acc: 0.203 Test Loss: 1.976 Test Acc: 0.203
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.101472616195679
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 2.018 Vali Acc: 0.270 Test Loss: 2.018 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.759843349456787
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.8908917903900146
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.433 Vali Acc: 0.230 Test Loss: 1.433 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.086066246032715
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.440 Vali Acc: 0.284 Test Loss: 1.440 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283769).  Saving model ...
Epoch: 4 cost time: 3.9287896156311035
Epoch: 4, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.483 Vali Acc: 0.176 Test Loss: 1.483 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9032135009765625
Epoch: 5, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.466 Vali Acc: 0.297 Test Loss: 1.466 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297283).  Saving model ...
Epoch: 6 cost time: 4.357649326324463
Epoch: 6, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.555 Vali Acc: 0.324 Test Loss: 1.555 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324309).  Saving model ...
Epoch: 7 cost time: 4.324547290802002
Epoch: 7, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.651 Vali Acc: 0.203 Test Loss: 1.651 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.242177248001099
Epoch: 8, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.578 Vali Acc: 0.284 Test Loss: 1.578 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.428225517272949
Epoch: 9, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.689 Vali Acc: 0.243 Test Loss: 1.689 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.196083068847656
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.672 Vali Acc: 0.284 Test Loss: 1.672 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.2461998462677
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.797 Vali Acc: 0.284 Test Loss: 1.797 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.349581241607666
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.878 Vali Acc: 0.324 Test Loss: 1.878 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.250066041946411
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.907 Vali Acc: 0.297 Test Loss: 1.907 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.401984930038452
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.932 Vali Acc: 0.297 Test Loss: 1.932 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.278288841247559
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.952 Vali Acc: 0.297 Test Loss: 1.952 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.171309232711792
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.943 Vali Acc: 0.351 Test Loss: 1.943 Test Acc: 0.351
Validation loss decreased (-0.324309 --> -0.351332).  Saving model ...
Epoch: 17 cost time: 4.015930652618408
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.000 Vali Acc: 0.311 Test Loss: 2.000 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.974148988723755
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.009 Vali Acc: 0.297 Test Loss: 2.009 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.116393804550171
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.987 Vali Acc: 0.338 Test Loss: 1.987 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.1698126792907715
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.023 Vali Acc: 0.324 Test Loss: 2.023 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.725620746612549
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.062 Vali Acc: 0.311 Test Loss: 2.062 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.730419874191284
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.074 Vali Acc: 0.324 Test Loss: 2.074 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.072159767150879
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.065 Vali Acc: 0.338 Test Loss: 2.065 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.034637212753296
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.070 Vali Acc: 0.338 Test Loss: 2.070 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.044199228286743
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.105 Vali Acc: 0.324 Test Loss: 2.105 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.9776835441589355
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.120 Vali Acc: 0.324 Test Loss: 2.120 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.728471517562866
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.495 Vali Acc: 0.216 Test Loss: 1.495 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 4.097648859024048
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.530 Vali Acc: 0.108 Test Loss: 1.530 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.099790096282959
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.498 Vali Acc: 0.297 Test Loss: 1.498 Test Acc: 0.297
Validation loss decreased (-0.216201 --> -0.297282).  Saving model ...
Epoch: 4 cost time: 3.681969165802002
Epoch: 4, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.533 Vali Acc: 0.230 Test Loss: 1.533 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9646570682525635
Epoch: 5, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.517 Vali Acc: 0.297 Test Loss: 1.517 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9955451488494873
Epoch: 6, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.536 Vali Acc: 0.284 Test Loss: 1.536 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.958631753921509
Epoch: 7, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.536 Vali Acc: 0.270 Test Loss: 1.536 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.780334949493408
Epoch: 8, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.584 Vali Acc: 0.243 Test Loss: 1.584 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.393623352050781
Epoch: 9, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.625 Vali Acc: 0.149 Test Loss: 1.625 Test Acc: 0.149
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.5549304485321045
Epoch: 10, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.563 Vali Acc: 0.257 Test Loss: 1.563 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.207923412322998
Epoch: 11, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.700 Vali Acc: 0.243 Test Loss: 1.700 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.1709818840026855
Epoch: 12, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.693 Vali Acc: 0.257 Test Loss: 1.693 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.47516131401062
Epoch: 13, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.673 Vali Acc: 0.297 Test Loss: 1.673 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.2972972972972973
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.735439777374268
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.458 Vali Acc: 0.216 Test Loss: 1.458 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.17730712890625
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.471 Vali Acc: 0.189 Test Loss: 1.471 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9983248710632324
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 3.84962797164917
Epoch: 4, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.465 Vali Acc: 0.297 Test Loss: 1.465 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 3.9573850631713867
Epoch: 5, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.471 Vali Acc: 0.324 Test Loss: 1.471 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 6 cost time: 3.993778705596924
Epoch: 6, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.471 Vali Acc: 0.324 Test Loss: 1.471 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324310).  Saving model ...
Epoch: 7 cost time: 3.9783780574798584
Epoch: 7, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.459 Vali Acc: 0.311 Test Loss: 1.459 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.976665735244751
Epoch: 8, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.491 Vali Acc: 0.311 Test Loss: 1.491 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7464494705200195
Epoch: 9, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.517 Vali Acc: 0.216 Test Loss: 1.517 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.795387029647827
Epoch: 10, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.494 Vali Acc: 0.392 Test Loss: 1.494 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391877).  Saving model ...
Epoch: 11 cost time: 4.17024302482605
Epoch: 11, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.543 Vali Acc: 0.216 Test Loss: 1.543 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.084756851196289
Epoch: 12, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.508 Vali Acc: 0.243 Test Loss: 1.508 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.384109258651733
Epoch: 13, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.585 Vali Acc: 0.243 Test Loss: 1.585 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.95434832572937
Epoch: 14, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.622 Vali Acc: 0.270 Test Loss: 1.622 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.154976844787598
Epoch: 15, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.757 Vali Acc: 0.257 Test Loss: 1.757 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.118524074554443
Epoch: 16, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.709 Vali Acc: 0.284 Test Loss: 1.709 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.094906568527222
Epoch: 17, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.951 Vali Acc: 0.243 Test Loss: 1.951 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.475007772445679
Epoch: 18, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.830 Vali Acc: 0.270 Test Loss: 1.830 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.115943193435669
Epoch: 19, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.935 Vali Acc: 0.297 Test Loss: 1.935 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.2082836627960205
Epoch: 20, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.983 Vali Acc: 0.243 Test Loss: 1.983 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 467908
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.2127625942230225
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.428 Vali Acc: 0.203 Test Loss: 1.428 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 4.07790994644165
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
Validation loss decreased (-0.202688 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 3.98624849319458
Epoch: 3, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 3.8138091564178467
Epoch: 4, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 4.167011022567749
Epoch: 5, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 4.142797946929932
Epoch: 6, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.983 Vali Acc: 0.595 Test Loss: 0.983 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594585).  Saving model ...
Epoch: 7 cost time: 4.24034571647644
Epoch: 7, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.943 Vali Acc: 0.568 Test Loss: 0.943 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.175813913345337
Epoch: 8, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.953 Vali Acc: 0.622 Test Loss: 0.953 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621612).  Saving model ...
Epoch: 9 cost time: 4.448213338851929
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.913 Vali Acc: 0.595 Test Loss: 0.913 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.249585866928101
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.893 Vali Acc: 0.662 Test Loss: 0.893 Test Acc: 0.662
Validation loss decreased (-0.621612 --> -0.662153).  Saving model ...
Epoch: 11 cost time: 4.508234977722168
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.892 Vali Acc: 0.635 Test Loss: 0.892 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.071555852890015
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.873 Vali Acc: 0.635 Test Loss: 0.873 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.175965070724487
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.889 Vali Acc: 0.649 Test Loss: 0.889 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.28555703163147
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.891 Vali Acc: 0.649 Test Loss: 0.891 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8013360500335693
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.878 Vali Acc: 0.635 Test Loss: 0.878 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8205008506774902
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.892 Vali Acc: 0.635 Test Loss: 0.892 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.2845659255981445
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.891 Vali Acc: 0.635 Test Loss: 0.891 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.011304616928101
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.897 Vali Acc: 0.635 Test Loss: 0.897 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7871432304382324
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.899 Vali Acc: 0.635 Test Loss: 0.899 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.982353448867798
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.905 Vali Acc: 0.635 Test Loss: 0.905 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.211780309677124
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.539751052856445
Epoch: 2, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.278 Vali Acc: 0.446 Test Loss: 1.278 Test Acc: 0.446
Validation loss decreased (-0.243229 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 4.392092704772949
Epoch: 3, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.254 Vali Acc: 0.432 Test Loss: 1.254 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0545313358306885
Epoch: 4, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.125 Vali Acc: 0.541 Test Loss: 1.125 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 4.326938152313232
Epoch: 5, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.128 Vali Acc: 0.473 Test Loss: 1.128 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.497989654541016
Epoch: 6, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.049 Vali Acc: 0.554 Test Loss: 1.049 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 4.6104583740234375
Epoch: 7, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 4.265819072723389
Epoch: 8, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.008 Vali Acc: 0.568 Test Loss: 1.008 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.36021876335144
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.997 Vali Acc: 0.514 Test Loss: 0.997 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.126835346221924
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.987 Vali Acc: 0.581 Test Loss: 0.987 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.026011943817139
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.972 Vali Acc: 0.581 Test Loss: 0.972 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.346063852310181
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.958 Vali Acc: 0.595 Test Loss: 0.958 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 13 cost time: 4.606205701828003
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.989 Vali Acc: 0.568 Test Loss: 0.989 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.499439716339111
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.975 Vali Acc: 0.608 Test Loss: 0.975 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 4.272639751434326
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.972 Vali Acc: 0.595 Test Loss: 0.972 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.574240684509277
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.993 Vali Acc: 0.608 Test Loss: 0.993 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.7467262744903564
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.981 Vali Acc: 0.595 Test Loss: 0.981 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.407857894897461
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.994 Vali Acc: 0.608 Test Loss: 0.994 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.562911748886108
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.577999591827393
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.006 Vali Acc: 0.608 Test Loss: 1.006 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.904162645339966
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.343687534332275
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.994 Vali Acc: 0.608 Test Loss: 0.994 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.588693857192993
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.964282274246216
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.608 Test Loss: 1.000 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.088874816894531
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.429 Vali Acc: 0.257 Test Loss: 1.429 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.761070728302002
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.392 Vali Acc: 0.311 Test Loss: 1.392 Test Acc: 0.311
Validation loss decreased (-0.256742 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 3.7503371238708496
Epoch: 3, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.454 Vali Acc: 0.243 Test Loss: 1.454 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.426393032073975
Epoch: 4, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.409 Vali Acc: 0.324 Test Loss: 1.409 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 4.236851930618286
Epoch: 5, Steps: 10 | Train Loss: 0.583 Vali Loss: 1.459 Vali Acc: 0.365 Test Loss: 1.459 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364850).  Saving model ...
Epoch: 6 cost time: 4.388762950897217
Epoch: 6, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.484 Vali Acc: 0.378 Test Loss: 1.484 Test Acc: 0.378
Validation loss decreased (-0.364850 --> -0.378364).  Saving model ...
Epoch: 7 cost time: 4.473591089248657
Epoch: 7, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.527 Vali Acc: 0.405 Test Loss: 1.527 Test Acc: 0.405
Validation loss decreased (-0.378364 --> -0.405390).  Saving model ...
Epoch: 8 cost time: 4.40325140953064
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.567 Vali Acc: 0.392 Test Loss: 1.567 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.962112665176392
Epoch: 9, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.641 Vali Acc: 0.378 Test Loss: 1.641 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.6534271240234375
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.749 Vali Acc: 0.392 Test Loss: 1.749 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.457194089889526
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.720 Vali Acc: 0.378 Test Loss: 1.720 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.625156879425049
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.796 Vali Acc: 0.405 Test Loss: 1.796 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.2470622062683105
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.862 Vali Acc: 0.419 Test Loss: 1.862 Test Acc: 0.419
Validation loss decreased (-0.405390 --> -0.418900).  Saving model ...
Epoch: 14 cost time: 4.6539201736450195
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.845 Vali Acc: 0.405 Test Loss: 1.845 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.6149938106536865
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.913 Vali Acc: 0.392 Test Loss: 1.913 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.626251697540283
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.942 Vali Acc: 0.432 Test Loss: 1.942 Test Acc: 0.432
Validation loss decreased (-0.418900 --> -0.432413).  Saving model ...
Epoch: 17 cost time: 4.341291904449463
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.924 Vali Acc: 0.405 Test Loss: 1.924 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.3929736614227295
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.963 Vali Acc: 0.432 Test Loss: 1.963 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.811184406280518
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.978 Vali Acc: 0.419 Test Loss: 1.978 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.300983905792236
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.988 Vali Acc: 0.419 Test Loss: 1.988 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.15287446975708
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.991 Vali Acc: 0.419 Test Loss: 1.991 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.193762302398682
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.000 Vali Acc: 0.419 Test Loss: 2.000 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.401999235153198
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.029 Vali Acc: 0.419 Test Loss: 2.029 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.209983587265015
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.022 Vali Acc: 0.419 Test Loss: 2.022 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.492516279220581
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.039 Vali Acc: 0.392 Test Loss: 2.039 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.4605889320373535
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.055 Vali Acc: 0.392 Test Loss: 2.055 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.394323348999023
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.447 Vali Acc: 0.176 Test Loss: 1.447 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.8904943466186523
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.423 Vali Acc: 0.203 Test Loss: 1.423 Test Acc: 0.203
Validation loss decreased (-0.175661 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 3.860327959060669
Epoch: 3, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.493 Vali Acc: 0.149 Test Loss: 1.493 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.90351939201355
Epoch: 4, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.436 Vali Acc: 0.324 Test Loss: 1.436 Test Acc: 0.324
Validation loss decreased (-0.202688 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 4.077003002166748
Epoch: 5, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.501 Vali Acc: 0.243 Test Loss: 1.501 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9372472763061523
Epoch: 6, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.514 Vali Acc: 0.351 Test Loss: 1.514 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351336).  Saving model ...
Epoch: 7 cost time: 4.251944541931152
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.587 Vali Acc: 0.324 Test Loss: 1.587 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.254121541976929
Epoch: 8, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.582 Vali Acc: 0.311 Test Loss: 1.582 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.203054189682007
Epoch: 9, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.698 Vali Acc: 0.257 Test Loss: 1.698 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.066020727157593
Epoch: 10, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.905 Vali Acc: 0.338 Test Loss: 1.905 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.444552898406982
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.826 Vali Acc: 0.338 Test Loss: 1.826 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9546124935150146
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.962 Vali Acc: 0.284 Test Loss: 1.962 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.389221906661987
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.957 Vali Acc: 0.338 Test Loss: 1.957 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.192739248275757
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.014 Vali Acc: 0.324 Test Loss: 2.014 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.291079998016357
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.029 Vali Acc: 0.324 Test Loss: 2.029 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.814119815826416
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.066 Vali Acc: 0.324 Test Loss: 2.066 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.897074222564697
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.424 Vali Acc: 0.216 Test Loss: 1.424 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.043219566345215
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.408 Vali Acc: 0.284 Test Loss: 1.408 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 3.933847427368164
Epoch: 3, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.463 Vali Acc: 0.324 Test Loss: 1.463 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 4.22587251663208
Epoch: 4, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.442 Vali Acc: 0.351 Test Loss: 1.442 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351337).  Saving model ...
Epoch: 5 cost time: 3.820957660675049
Epoch: 5, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.504 Vali Acc: 0.284 Test Loss: 1.504 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.20162558555603
Epoch: 6, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.522 Vali Acc: 0.419 Test Loss: 1.522 Test Acc: 0.419
Validation loss decreased (-0.351337 --> -0.418904).  Saving model ...
Epoch: 7 cost time: 4.141692876815796
Epoch: 7, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.651 Vali Acc: 0.351 Test Loss: 1.651 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.223028898239136
Epoch: 8, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.674 Vali Acc: 0.378 Test Loss: 1.674 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.094493389129639
Epoch: 9, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.806 Vali Acc: 0.351 Test Loss: 1.806 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.958268165588379
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.925 Vali Acc: 0.297 Test Loss: 1.925 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.9996724128723145
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.866 Vali Acc: 0.351 Test Loss: 1.866 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.4841508865356445
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.954 Vali Acc: 0.324 Test Loss: 1.954 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.224483013153076
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.931 Vali Acc: 0.378 Test Loss: 1.931 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.0744054317474365
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.026 Vali Acc: 0.378 Test Loss: 2.026 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9313855171203613
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.998 Vali Acc: 0.351 Test Loss: 1.998 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.041396617889404
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.059 Vali Acc: 0.365 Test Loss: 2.059 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.4639575481414795
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.451 Vali Acc: 0.257 Test Loss: 1.451 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 4.59318470954895
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.449 Vali Acc: 0.338 Test Loss: 1.449 Test Acc: 0.338
Validation loss decreased (-0.256742 --> -0.337823).  Saving model ...
Epoch: 3 cost time: 4.629514932632446
Epoch: 3, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.550 Vali Acc: 0.189 Test Loss: 1.550 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.062473297119141
Epoch: 4, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.496 Vali Acc: 0.324 Test Loss: 1.496 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.921259641647339
Epoch: 5, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.578 Vali Acc: 0.203 Test Loss: 1.578 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.563478231430054
Epoch: 6, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.578 Vali Acc: 0.351 Test Loss: 1.578 Test Acc: 0.351
Validation loss decreased (-0.337823 --> -0.351336).  Saving model ...
Epoch: 7 cost time: 4.241713523864746
Epoch: 7, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.766 Vali Acc: 0.257 Test Loss: 1.766 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.26883602142334
Epoch: 8, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.711 Vali Acc: 0.324 Test Loss: 1.711 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.290287733078003
Epoch: 9, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.868 Vali Acc: 0.270 Test Loss: 1.868 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.23826265335083
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 2.002 Vali Acc: 0.297 Test Loss: 2.002 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.254615545272827
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.974 Vali Acc: 0.392 Test Loss: 1.974 Test Acc: 0.392
Validation loss decreased (-0.351336 --> -0.391872).  Saving model ...
Epoch: 12 cost time: 3.872607946395874
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.140 Vali Acc: 0.297 Test Loss: 2.140 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.899876356124878
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.105 Vali Acc: 0.405 Test Loss: 2.105 Test Acc: 0.405
Validation loss decreased (-0.391872 --> -0.405384).  Saving model ...
Epoch: 14 cost time: 4.2726240158081055
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.239 Vali Acc: 0.311 Test Loss: 2.239 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.096134185791016
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.194 Vali Acc: 0.351 Test Loss: 2.194 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.086895227432251
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.256 Vali Acc: 0.324 Test Loss: 2.256 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.977336883544922
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.296 Vali Acc: 0.338 Test Loss: 2.296 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.420443296432495
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.306 Vali Acc: 0.338 Test Loss: 2.306 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.095066070556641
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.328 Vali Acc: 0.338 Test Loss: 2.328 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.011488199234009
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.359 Vali Acc: 0.338 Test Loss: 2.359 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.017824411392212
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.356 Vali Acc: 0.338 Test Loss: 2.356 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8794071674346924
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.389 Vali Acc: 0.324 Test Loss: 2.389 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.3392956256866455
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.418 Vali Acc: 0.338 Test Loss: 2.418 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.365991592407227
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.422 Vali Acc: 0.189 Test Loss: 1.422 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 4.138406991958618
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.471 Vali Acc: 0.324 Test Loss: 1.471 Test Acc: 0.324
Validation loss decreased (-0.189175 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 4.0575573444366455
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.512 Vali Acc: 0.149 Test Loss: 1.512 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9054291248321533
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.455 Vali Acc: 0.311 Test Loss: 1.455 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.034795522689819
Epoch: 5, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.536 Vali Acc: 0.162 Test Loss: 1.536 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.771651268005371
Epoch: 6, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.499 Vali Acc: 0.284 Test Loss: 1.499 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7419023513793945
Epoch: 7, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.663 Vali Acc: 0.176 Test Loss: 1.663 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7372772693634033
Epoch: 8, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.580 Vali Acc: 0.216 Test Loss: 1.580 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.7518064975738525
Epoch: 9, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.672 Vali Acc: 0.230 Test Loss: 1.672 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.111109733581543
Epoch: 10, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.884 Vali Acc: 0.216 Test Loss: 1.884 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.717890739440918
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.711 Vali Acc: 0.257 Test Loss: 1.711 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.023139238357544
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.912 Vali Acc: 0.270 Test Loss: 1.912 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.055525064468384
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.439 Vali Acc: 0.230 Test Loss: 1.439 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 4.51485276222229
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.466 Vali Acc: 0.216 Test Loss: 1.466 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.136297702789307
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.510 Vali Acc: 0.189 Test Loss: 1.510 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.039957523345947
Epoch: 4, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.452 Vali Acc: 0.203 Test Loss: 1.452 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.954210042953491
Epoch: 5, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.532 Vali Acc: 0.270 Test Loss: 1.532 Test Acc: 0.270
Validation loss decreased (-0.229715 --> -0.270255).  Saving model ...
Epoch: 6 cost time: 4.116185665130615
Epoch: 6, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.492 Vali Acc: 0.243 Test Loss: 1.492 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.931313991546631
Epoch: 7, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.644 Vali Acc: 0.216 Test Loss: 1.644 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.214545726776123
Epoch: 8, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.552 Vali Acc: 0.311 Test Loss: 1.552 Test Acc: 0.311
Validation loss decreased (-0.270255 --> -0.310795).  Saving model ...
Epoch: 9 cost time: 4.316544771194458
Epoch: 9, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.663 Vali Acc: 0.270 Test Loss: 1.663 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.2733869552612305
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.858 Vali Acc: 0.216 Test Loss: 1.858 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.165381908416748
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.720 Vali Acc: 0.297 Test Loss: 1.720 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.2869713306427
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.860 Vali Acc: 0.243 Test Loss: 1.860 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.221187353134155
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.909 Vali Acc: 0.243 Test Loss: 1.909 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.555102348327637
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.910 Vali Acc: 0.284 Test Loss: 1.910 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.20002818107605
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.934 Vali Acc: 0.297 Test Loss: 1.934 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.119961738586426
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.008 Vali Acc: 0.243 Test Loss: 2.008 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.296975135803223
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.948 Vali Acc: 0.284 Test Loss: 1.948 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.345914363861084
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.003 Vali Acc: 0.257 Test Loss: 2.003 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.4215497970581055
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.426 Vali Acc: 0.243 Test Loss: 1.426 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.604938507080078
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.441 Vali Acc: 0.230 Test Loss: 1.441 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.869875907897949
Epoch: 3, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.479 Vali Acc: 0.243 Test Loss: 1.479 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.236910104751587
Epoch: 4, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.445 Vali Acc: 0.230 Test Loss: 1.445 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7902376651763916
Epoch: 5, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.410 Vali Acc: 0.297 Test Loss: 1.410 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 6 cost time: 4.09649658203125
Epoch: 6, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.455 Vali Acc: 0.216 Test Loss: 1.455 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.319939136505127
Epoch: 7, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.464 Vali Acc: 0.203 Test Loss: 1.464 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.053187131881714
Epoch: 8, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.451 Vali Acc: 0.257 Test Loss: 1.451 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.334626197814941
Epoch: 9, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.519 Vali Acc: 0.257 Test Loss: 1.519 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.345503807067871
Epoch: 10, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.506 Vali Acc: 0.257 Test Loss: 1.506 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.181181907653809
Epoch: 11, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.466 Vali Acc: 0.324 Test Loss: 1.466 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 12 cost time: 4.128669500350952
Epoch: 12, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.612 Vali Acc: 0.162 Test Loss: 1.612 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.053431034088135
Epoch: 13, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.544 Vali Acc: 0.351 Test Loss: 1.544 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351336).  Saving model ...
Epoch: 14 cost time: 3.707449197769165
Epoch: 14, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.608 Vali Acc: 0.311 Test Loss: 1.608 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8153865337371826
Epoch: 15, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.610 Vali Acc: 0.311 Test Loss: 1.610 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.861905574798584
Epoch: 16, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.675 Vali Acc: 0.270 Test Loss: 1.675 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9532530307769775
Epoch: 17, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.756 Vali Acc: 0.257 Test Loss: 1.756 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.7459447383880615
Epoch: 18, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.872 Vali Acc: 0.243 Test Loss: 1.872 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.5395123958587646
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.877 Vali Acc: 0.257 Test Loss: 1.877 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.720414161682129
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.965 Vali Acc: 0.284 Test Loss: 1.965 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.727957010269165
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.159 Vali Acc: 0.243 Test Loss: 2.159 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.773392677307129
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.087 Vali Acc: 0.257 Test Loss: 2.087 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8444342613220215
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.195 Vali Acc: 0.243 Test Loss: 2.195 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.060666084289551
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.401 Vali Acc: 0.257 Test Loss: 1.401 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.726900339126587
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.432 Vali Acc: 0.203 Test Loss: 1.432 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.658195972442627
Epoch: 3, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.420 Vali Acc: 0.230 Test Loss: 1.420 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6582608222961426
Epoch: 4, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.389 Vali Acc: 0.284 Test Loss: 1.389 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 3.656156063079834
Epoch: 5, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.411 Vali Acc: 0.284 Test Loss: 1.411 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9619863033294678
Epoch: 6, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.412 Vali Acc: 0.297 Test Loss: 1.412 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 7 cost time: 3.8865604400634766
Epoch: 7, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.001166820526123
Epoch: 8, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.420 Vali Acc: 0.297 Test Loss: 1.420 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7407212257385254
Epoch: 9, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.433 Vali Acc: 0.324 Test Loss: 1.433 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 10 cost time: 3.8719093799591064
Epoch: 10, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.479 Vali Acc: 0.270 Test Loss: 1.479 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8925068378448486
Epoch: 11, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.424 Vali Acc: 0.324 Test Loss: 1.424 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324310).  Saving model ...
Epoch: 12 cost time: 3.9884145259857178
Epoch: 12, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.548 Vali Acc: 0.216 Test Loss: 1.548 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8354651927948
Epoch: 13, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.495 Vali Acc: 0.338 Test Loss: 1.495 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337823).  Saving model ...
Epoch: 14 cost time: 4.018022298812866
Epoch: 14, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.533 Vali Acc: 0.324 Test Loss: 1.533 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.902008056640625
Epoch: 15, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.541 Vali Acc: 0.324 Test Loss: 1.541 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.035474061965942
Epoch: 16, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.629 Vali Acc: 0.311 Test Loss: 1.629 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.865483045578003
Epoch: 17, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.670 Vali Acc: 0.311 Test Loss: 1.670 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.9893505573272705
Epoch: 18, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.711 Vali Acc: 0.324 Test Loss: 1.711 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.91701078414917
Epoch: 19, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.923 Vali Acc: 0.284 Test Loss: 1.923 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8976757526397705
Epoch: 20, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.875 Vali Acc: 0.311 Test Loss: 1.875 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.025918006896973
Epoch: 21, Steps: 10 | Train Loss: 0.118 Vali Loss: 2.090 Vali Acc: 0.257 Test Loss: 2.090 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.299649238586426
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 2.041 Vali Acc: 0.311 Test Loss: 2.041 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.283995151519775
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 2.079 Vali Acc: 0.324 Test Loss: 2.079 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 369604
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.630626201629639
Epoch: 1, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.331 Vali Acc: 0.365 Test Loss: 1.331 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 4.022104501724243
Epoch: 2, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.364852 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 4.001952886581421
Epoch: 3, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 3.9365782737731934
Epoch: 4, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.025 Vali Acc: 0.608 Test Loss: 1.025 Test Acc: 0.608
Validation loss decreased (-0.513502 --> -0.608098).  Saving model ...
Epoch: 5 cost time: 4.1512839794158936
Epoch: 5, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 6 cost time: 3.995779037475586
Epoch: 6, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.916 Vali Acc: 0.635 Test Loss: 0.916 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 7 cost time: 3.7498583793640137
Epoch: 7, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.892 Vali Acc: 0.662 Test Loss: 0.892 Test Acc: 0.662
Validation loss decreased (-0.635126 --> -0.662153).  Saving model ...
Epoch: 8 cost time: 3.6844482421875
Epoch: 8, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.876 Vali Acc: 0.662 Test Loss: 0.876 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 9 cost time: 3.959477663040161
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.862 Vali Acc: 0.635 Test Loss: 0.862 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.018293619155884
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.844 Vali Acc: 0.662 Test Loss: 0.844 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662154).  Saving model ...
Epoch: 11 cost time: 3.936965227127075
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.848 Vali Acc: 0.662 Test Loss: 0.848 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8958916664123535
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.871 Vali Acc: 0.703 Test Loss: 0.871 Test Acc: 0.703
Validation loss decreased (-0.662154 --> -0.702694).  Saving model ...
Epoch: 13 cost time: 4.289820909500122
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.849 Vali Acc: 0.662 Test Loss: 0.849 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.068314790725708
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.874 Vali Acc: 0.649 Test Loss: 0.874 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.247481822967529
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.861 Vali Acc: 0.676 Test Loss: 0.861 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9401135444641113
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.864 Vali Acc: 0.676 Test Loss: 0.864 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.098888158798218
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.882 Vali Acc: 0.649 Test Loss: 0.882 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.255401134490967
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.867 Vali Acc: 0.676 Test Loss: 0.867 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.0337629318237305
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.870 Vali Acc: 0.676 Test Loss: 0.870 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.144869804382324
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.880 Vali Acc: 0.649 Test Loss: 0.880 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.127240896224976
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.676 Test Loss: 0.890 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.019225597381592
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.883 Vali Acc: 0.662 Test Loss: 0.883 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7027027027027027
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.497182369232178
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.341 Vali Acc: 0.324 Test Loss: 1.341 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 3.949134588241577
Epoch: 2, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
Validation loss decreased (-0.324311 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 3.9951422214508057
Epoch: 3, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.178 Vali Acc: 0.446 Test Loss: 1.178 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.209057331085205
Epoch: 4, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.098 Vali Acc: 0.527 Test Loss: 1.098 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 3.785525321960449
Epoch: 5, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.068 Vali Acc: 0.486 Test Loss: 1.068 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9651660919189453
Epoch: 6, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.990 Vali Acc: 0.568 Test Loss: 0.990 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567558).  Saving model ...
Epoch: 7 cost time: 3.89643931388855
Epoch: 7, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
Validation loss decreased (-0.567558 --> -0.594585).  Saving model ...
Epoch: 8 cost time: 3.9191884994506836
Epoch: 8, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.965 Vali Acc: 0.595 Test Loss: 0.965 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 3.9941251277923584
Epoch: 9, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.951 Vali Acc: 0.595 Test Loss: 0.951 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 3.810821533203125
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.983 Vali Acc: 0.622 Test Loss: 0.983 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 3.7339093685150146
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.972 Vali Acc: 0.554 Test Loss: 0.972 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.546278953552246
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.991 Vali Acc: 0.581 Test Loss: 0.991 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6917531490325928
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.979 Vali Acc: 0.595 Test Loss: 0.979 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.608250617980957
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.794851541519165
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.987 Vali Acc: 0.581 Test Loss: 0.987 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5716359615325928
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.996 Vali Acc: 0.608 Test Loss: 0.996 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.7548909187316895
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.011 Vali Acc: 0.608 Test Loss: 1.011 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.087825775146484
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.920301675796509
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.012 Vali Acc: 0.608 Test Loss: 1.012 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.849778413772583
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.608 Test Loss: 1.012 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.921353340148926
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.394 Vali Acc: 0.230 Test Loss: 1.394 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 4.100319147109985
Epoch: 2, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.346 Vali Acc: 0.365 Test Loss: 1.346 Test Acc: 0.365
Validation loss decreased (-0.229716 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 3.6699764728546143
Epoch: 3, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.387 Vali Acc: 0.351 Test Loss: 1.387 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9459376335144043
Epoch: 4, Steps: 10 | Train Loss: 0.766 Vali Loss: 1.391 Vali Acc: 0.405 Test Loss: 1.391 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405391).  Saving model ...
Epoch: 5 cost time: 3.866699695587158
Epoch: 5, Steps: 10 | Train Loss: 0.583 Vali Loss: 1.447 Vali Acc: 0.351 Test Loss: 1.447 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7889328002929688
Epoch: 6, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.408 Vali Acc: 0.392 Test Loss: 1.408 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.536734342575073
Epoch: 7, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.525 Vali Acc: 0.405 Test Loss: 1.525 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.204428672790527
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.541 Vali Acc: 0.405 Test Loss: 1.541 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.7751102447509766
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.617 Vali Acc: 0.405 Test Loss: 1.617 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.959289073944092
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.695 Vali Acc: 0.392 Test Loss: 1.695 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.510786056518555
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.771 Vali Acc: 0.392 Test Loss: 1.771 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.034391403198242
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.774 Vali Acc: 0.405 Test Loss: 1.774 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.940324544906616
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.825 Vali Acc: 0.378 Test Loss: 1.825 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.323057174682617
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.872 Vali Acc: 0.405 Test Loss: 1.872 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.40540540540540543
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.474016427993774
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.409 Vali Acc: 0.257 Test Loss: 1.409 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.063277721405029
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 3.4390130043029785
Epoch: 3, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.447 Vali Acc: 0.230 Test Loss: 1.447 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7315142154693604
Epoch: 4, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.399 Vali Acc: 0.365 Test Loss: 1.399 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 3.681575059890747
Epoch: 5, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.468 Vali Acc: 0.243 Test Loss: 1.468 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5750887393951416
Epoch: 6, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.440 Vali Acc: 0.365 Test Loss: 1.440 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6927552223205566
Epoch: 7, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.484 Vali Acc: 0.324 Test Loss: 1.484 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.4972782135009766
Epoch: 8, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.695 Vali Acc: 0.284 Test Loss: 1.695 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6048669815063477
Epoch: 9, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.596 Vali Acc: 0.311 Test Loss: 1.596 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8673391342163086
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.687 Vali Acc: 0.284 Test Loss: 1.687 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.074812173843384
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.784 Vali Acc: 0.311 Test Loss: 1.784 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.041185140609741
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.828 Vali Acc: 0.297 Test Loss: 1.828 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.945589542388916
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.837 Vali Acc: 0.284 Test Loss: 1.837 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.15475058555603
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.905 Vali Acc: 0.338 Test Loss: 1.905 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.608161211013794
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.411 Vali Acc: 0.149 Test Loss: 1.411 Test Acc: 0.149
Validation loss decreased (inf --> -0.148635).  Saving model ...
Epoch: 2 cost time: 4.123963832855225
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
Validation loss decreased (-0.148635 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 3.555844306945801
Epoch: 3, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.497 Vali Acc: 0.243 Test Loss: 1.497 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.993614912033081
Epoch: 4, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.456 Vali Acc: 0.338 Test Loss: 1.456 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337823).  Saving model ...
Epoch: 5 cost time: 3.5236525535583496
Epoch: 5, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.538 Vali Acc: 0.324 Test Loss: 1.538 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7073609828948975
Epoch: 6, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.538 Vali Acc: 0.297 Test Loss: 1.538 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7408952713012695
Epoch: 7, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.637 Vali Acc: 0.378 Test Loss: 1.637 Test Acc: 0.378
Validation loss decreased (-0.337823 --> -0.378362).  Saving model ...
Epoch: 8 cost time: 3.677727222442627
Epoch: 8, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.806 Vali Acc: 0.297 Test Loss: 1.806 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.529503107070923
Epoch: 9, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.799 Vali Acc: 0.324 Test Loss: 1.799 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.544818878173828
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.849 Vali Acc: 0.338 Test Loss: 1.849 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7225000858306885
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 2.026 Vali Acc: 0.365 Test Loss: 2.026 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.058279991149902
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.007 Vali Acc: 0.351 Test Loss: 2.007 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.040421724319458
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.059 Vali Acc: 0.338 Test Loss: 2.059 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.9637012481689453
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.094 Vali Acc: 0.365 Test Loss: 2.094 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.085384368896484
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.127 Vali Acc: 0.351 Test Loss: 2.127 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.033175230026245
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.158 Vali Acc: 0.338 Test Loss: 2.158 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.307425498962402
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.195 Vali Acc: 0.365 Test Loss: 2.195 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.327081918716431
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.420 Vali Acc: 0.189 Test Loss: 1.420 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 3.6521263122558594
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.424 Vali Acc: 0.203 Test Loss: 1.424 Test Acc: 0.203
Validation loss decreased (-0.189175 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 3.90918231010437
Epoch: 3, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.503 Vali Acc: 0.149 Test Loss: 1.503 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8520541191101074
Epoch: 4, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.465 Vali Acc: 0.297 Test Loss: 1.465 Test Acc: 0.297
Validation loss decreased (-0.202688 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 4.225457668304443
Epoch: 5, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.582 Vali Acc: 0.311 Test Loss: 1.582 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310795).  Saving model ...
Epoch: 6 cost time: 3.795280933380127
Epoch: 6, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.572 Vali Acc: 0.284 Test Loss: 1.572 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7685863971710205
Epoch: 7, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.689 Vali Acc: 0.284 Test Loss: 1.689 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.948049783706665
Epoch: 8, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.759 Vali Acc: 0.297 Test Loss: 1.759 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.9304778575897217
Epoch: 9, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.880 Vali Acc: 0.297 Test Loss: 1.880 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.919560670852661
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.908 Vali Acc: 0.338 Test Loss: 1.908 Test Acc: 0.338
Validation loss decreased (-0.310795 --> -0.337819).  Saving model ...
Epoch: 11 cost time: 3.927809000015259
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.999 Vali Acc: 0.365 Test Loss: 1.999 Test Acc: 0.365
Validation loss decreased (-0.337819 --> -0.364845).  Saving model ...
Epoch: 12 cost time: 3.9454586505889893
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.101 Vali Acc: 0.338 Test Loss: 2.101 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.956083297729492
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.139 Vali Acc: 0.365 Test Loss: 2.139 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.275976657867432
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.202 Vali Acc: 0.351 Test Loss: 2.202 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9196200370788574
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.214 Vali Acc: 0.338 Test Loss: 2.214 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.198083162307739
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.247 Vali Acc: 0.351 Test Loss: 2.247 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.856663227081299
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.276 Vali Acc: 0.351 Test Loss: 2.276 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.844943046569824
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.285 Vali Acc: 0.338 Test Loss: 2.285 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.998262882232666
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.315 Vali Acc: 0.338 Test Loss: 2.315 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.033822774887085
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.336 Vali Acc: 0.338 Test Loss: 2.336 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.975078821182251
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.359 Vali Acc: 0.338 Test Loss: 2.359 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.82853889465332
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 4.312368154525757
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.427 Vali Acc: 0.297 Test Loss: 1.427 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 4.311286449432373
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.499 Vali Acc: 0.284 Test Loss: 1.499 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.184607744216919
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.421 Vali Acc: 0.230 Test Loss: 1.421 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.230141878128052
Epoch: 5, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.533 Vali Acc: 0.284 Test Loss: 1.533 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.232793092727661
Epoch: 6, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.447451591491699
Epoch: 7, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.506 Vali Acc: 0.216 Test Loss: 1.506 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.2481324672698975
Epoch: 8, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.669 Vali Acc: 0.230 Test Loss: 1.669 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.1253252029418945
Epoch: 9, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.560 Vali Acc: 0.216 Test Loss: 1.560 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.05830717086792
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.628 Vali Acc: 0.189 Test Loss: 1.628 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.8120522499084473
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.645 Vali Acc: 0.338 Test Loss: 1.645 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337821).  Saving model ...
Epoch: 12 cost time: 4.141194581985474
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.849 Vali Acc: 0.284 Test Loss: 1.849 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.082974672317505
Epoch: 13, Steps: 10 | Train Loss: 0.092 Vali Loss: 2.040 Vali Acc: 0.230 Test Loss: 2.040 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.054254055023193
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.919 Vali Acc: 0.257 Test Loss: 1.919 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.025180101394653
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.927 Vali Acc: 0.243 Test Loss: 1.927 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8056602478027344
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.052 Vali Acc: 0.284 Test Loss: 2.052 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.182739496231079
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.069 Vali Acc: 0.243 Test Loss: 2.069 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.136542081832886
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.037 Vali Acc: 0.243 Test Loss: 2.037 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.0992560386657715
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.118 Vali Acc: 0.284 Test Loss: 2.118 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.146410942077637
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.114 Vali Acc: 0.257 Test Loss: 2.114 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.0746753215789795
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.117 Vali Acc: 0.270 Test Loss: 2.117 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.4874114990234375
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.405 Vali Acc: 0.216 Test Loss: 1.405 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.6661760807037354
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.429 Vali Acc: 0.203 Test Loss: 1.429 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.176915645599365
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.503 Vali Acc: 0.284 Test Loss: 1.503 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283769).  Saving model ...
Epoch: 4 cost time: 3.720935344696045
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.412 Vali Acc: 0.284 Test Loss: 1.412 Test Acc: 0.284
Validation loss decreased (-0.283769 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 3.7889466285705566
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.499 Vali Acc: 0.297 Test Loss: 1.499 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297282).  Saving model ...
Epoch: 6 cost time: 3.768326997756958
Epoch: 6, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.477 Vali Acc: 0.270 Test Loss: 1.477 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8488354682922363
Epoch: 7, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.514 Vali Acc: 0.324 Test Loss: 1.514 Test Acc: 0.324
Validation loss decreased (-0.297282 --> -0.324309).  Saving model ...
Epoch: 8 cost time: 3.9623968601226807
Epoch: 8, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.709 Vali Acc: 0.189 Test Loss: 1.709 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.050698518753052
Epoch: 9, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.601 Vali Acc: 0.257 Test Loss: 1.601 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9791481494903564
Epoch: 10, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.631 Vali Acc: 0.297 Test Loss: 1.631 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.105191230773926
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.655 Vali Acc: 0.257 Test Loss: 1.655 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8988869190216064
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.824 Vali Acc: 0.257 Test Loss: 1.824 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.802565813064575
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.833 Vali Acc: 0.270 Test Loss: 1.833 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.084280967712402
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.868 Vali Acc: 0.270 Test Loss: 1.868 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.2828614711761475
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.820 Vali Acc: 0.270 Test Loss: 1.820 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.322876214981079
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.938 Vali Acc: 0.243 Test Loss: 1.938 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.314577579498291
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.894 Vali Acc: 0.270 Test Loss: 1.894 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.592931032180786
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.9529430866241455
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 4.037904739379883
Epoch: 3, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.513 Vali Acc: 0.216 Test Loss: 1.513 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.138596534729004
Epoch: 4, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.406 Vali Acc: 0.257 Test Loss: 1.406 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.477099418640137
Epoch: 5, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.465 Vali Acc: 0.257 Test Loss: 1.465 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.45907998085022
Epoch: 6, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.435 Vali Acc: 0.311 Test Loss: 1.435 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310796).  Saving model ...
Epoch: 7 cost time: 4.422834396362305
Epoch: 7, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.278736591339111
Epoch: 8, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.487 Vali Acc: 0.270 Test Loss: 1.487 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.248908758163452
Epoch: 9, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.482 Vali Acc: 0.270 Test Loss: 1.482 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.531528949737549
Epoch: 10, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.501 Vali Acc: 0.284 Test Loss: 1.501 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.3283233642578125
Epoch: 11, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.518 Vali Acc: 0.270 Test Loss: 1.518 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.342417478561401
Epoch: 12, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.573 Vali Acc: 0.243 Test Loss: 1.573 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.472885847091675
Epoch: 13, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.761 Vali Acc: 0.189 Test Loss: 1.761 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9207499027252197
Epoch: 14, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.722 Vali Acc: 0.297 Test Loss: 1.722 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.026108980178833
Epoch: 15, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.757 Vali Acc: 0.257 Test Loss: 1.757 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.190985918045044
Epoch: 16, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.826 Vali Acc: 0.270 Test Loss: 1.826 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.326574802398682
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.422 Vali Acc: 0.216 Test Loss: 1.422 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.272317409515381
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.414 Vali Acc: 0.230 Test Loss: 1.414 Test Acc: 0.230
Validation loss decreased (-0.216202 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 3.8235554695129395
Epoch: 3, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.494 Vali Acc: 0.176 Test Loss: 1.494 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.081599950790405
Epoch: 4, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.399 Vali Acc: 0.284 Test Loss: 1.399 Test Acc: 0.284
Validation loss decreased (-0.229716 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 4.02554988861084
Epoch: 5, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.460 Vali Acc: 0.243 Test Loss: 1.460 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.992987871170044
Epoch: 6, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.429 Vali Acc: 0.230 Test Loss: 1.429 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9145827293395996
Epoch: 7, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.447 Vali Acc: 0.284 Test Loss: 1.447 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8504536151885986
Epoch: 8, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.496 Vali Acc: 0.257 Test Loss: 1.496 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9188151359558105
Epoch: 9, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.459 Vali Acc: 0.257 Test Loss: 1.459 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.025270700454712
Epoch: 10, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.761925458908081
Epoch: 11, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.458 Vali Acc: 0.284 Test Loss: 1.458 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.982011318206787
Epoch: 12, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.509 Vali Acc: 0.324 Test Loss: 1.509 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324309).  Saving model ...
Epoch: 13 cost time: 4.0653252601623535
Epoch: 13, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.582 Vali Acc: 0.365 Test Loss: 1.582 Test Acc: 0.365
Validation loss decreased (-0.324309 --> -0.364849).  Saving model ...
Epoch: 14 cost time: 3.9074981212615967
Epoch: 14, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.657 Vali Acc: 0.338 Test Loss: 1.657 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.050299644470215
Epoch: 15, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.631 Vali Acc: 0.270 Test Loss: 1.631 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8040497303009033
Epoch: 16, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.693 Vali Acc: 0.351 Test Loss: 1.693 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.110287189483643
Epoch: 17, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.759 Vali Acc: 0.324 Test Loss: 1.759 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.142776250839233
Epoch: 18, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.825 Vali Acc: 0.351 Test Loss: 1.825 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.11394190788269
Epoch: 19, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.835 Vali Acc: 0.311 Test Loss: 1.835 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.117102146148682
Epoch: 20, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.958 Vali Acc: 0.338 Test Loss: 1.958 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.7834951877593994
Epoch: 21, Steps: 10 | Train Loss: 0.117 Vali Loss: 2.015 Vali Acc: 0.284 Test Loss: 2.015 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.9523513317108154
Epoch: 22, Steps: 10 | Train Loss: 0.119 Vali Loss: 2.152 Vali Acc: 0.311 Test Loss: 2.152 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.9025888442993164
Epoch: 23, Steps: 10 | Train Loss: 0.078 Vali Loss: 2.132 Vali Acc: 0.338 Test Loss: 2.132 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 320452
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.5459418296813965
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.412 Vali Acc: 0.230 Test Loss: 1.412 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 4.055830001831055
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.346 Vali Acc: 0.270 Test Loss: 1.346 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 4.2394328117370605
Epoch: 3, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.247 Vali Acc: 0.419 Test Loss: 1.247 Test Acc: 0.419
Validation loss decreased (-0.270257 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 3.887251615524292
Epoch: 4, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.221 Vali Acc: 0.432 Test Loss: 1.221 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 3.847196340560913
Epoch: 5, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 3.7648754119873047
Epoch: 6, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.140 Vali Acc: 0.473 Test Loss: 1.140 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0613908767700195
Epoch: 7, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 3.9734742641448975
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 4.275633335113525
Epoch: 9, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.962 Vali Acc: 0.554 Test Loss: 0.962 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.35308575630188
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.962 Vali Acc: 0.568 Test Loss: 0.962 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.460401296615601
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.885 Vali Acc: 0.608 Test Loss: 0.885 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608099).  Saving model ...
Epoch: 12 cost time: 4.4748687744140625
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.927 Vali Acc: 0.595 Test Loss: 0.927 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.5624847412109375
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.903 Vali Acc: 0.649 Test Loss: 0.903 Test Acc: 0.649
Validation loss decreased (-0.608099 --> -0.648640).  Saving model ...
Epoch: 14 cost time: 4.303925514221191
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.894 Vali Acc: 0.635 Test Loss: 0.894 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.1314568519592285
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.928 Vali Acc: 0.608 Test Loss: 0.928 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.160405158996582
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.059856176376343
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.915 Vali Acc: 0.635 Test Loss: 0.915 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.9465882778167725
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.919 Vali Acc: 0.635 Test Loss: 0.919 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.363992691040039
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.938 Vali Acc: 0.635 Test Loss: 0.938 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.063600301742554
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.929 Vali Acc: 0.635 Test Loss: 0.929 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.192423343658447
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.932 Vali Acc: 0.635 Test Loss: 0.932 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8807144165039062
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.936 Vali Acc: 0.635 Test Loss: 0.936 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.3560450077056885
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.948 Vali Acc: 0.635 Test Loss: 0.948 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.407560348510742
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.409 Vali Acc: 0.203 Test Loss: 1.409 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 3.8867733478546143
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.339 Vali Acc: 0.297 Test Loss: 1.339 Test Acc: 0.297
Validation loss decreased (-0.202689 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 3.661757469177246
Epoch: 3, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.250 Vali Acc: 0.351 Test Loss: 1.250 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351339).  Saving model ...
Epoch: 4 cost time: 3.91873836517334
Epoch: 4, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.232 Vali Acc: 0.365 Test Loss: 1.232 Test Acc: 0.365
Validation loss decreased (-0.351339 --> -0.364853).  Saving model ...
Epoch: 5 cost time: 3.9461419582366943
Epoch: 5, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.148 Vali Acc: 0.405 Test Loss: 1.148 Test Acc: 0.405
Validation loss decreased (-0.364853 --> -0.405394).  Saving model ...
Epoch: 6 cost time: 3.874619245529175
Epoch: 6, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
Validation loss decreased (-0.405394 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 3.990840196609497
Epoch: 7, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.086 Vali Acc: 0.473 Test Loss: 1.086 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.459735870361328
Epoch: 8, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 3.934898614883423
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 3.955932140350342
Epoch: 10, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.098 Vali Acc: 0.473 Test Loss: 1.098 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.20374321937561
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
Validation loss decreased (-0.499989 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 4.2962799072265625
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.061 Vali Acc: 0.527 Test Loss: 1.061 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.215972185134888
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.024 Vali Acc: 0.541 Test Loss: 1.024 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.147935628890991
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.032 Vali Acc: 0.554 Test Loss: 1.032 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.6933722496032715
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.476491212844849
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.063 Vali Acc: 0.527 Test Loss: 1.063 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.478457450866699
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.053 Vali Acc: 0.541 Test Loss: 1.053 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.702054738998413
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.431759357452393
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.063 Vali Acc: 0.541 Test Loss: 1.063 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.293374538421631
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.63524866104126
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.426805734634399
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.430 Vali Acc: 0.189 Test Loss: 1.430 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 3.707867383956909
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.414 Vali Acc: 0.216 Test Loss: 1.414 Test Acc: 0.216
Validation loss decreased (-0.189175 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 3.8445358276367188
Epoch: 3, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.379 Vali Acc: 0.351 Test Loss: 1.379 Test Acc: 0.351
Validation loss decreased (-0.216202 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 3.9183359146118164
Epoch: 4, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.420 Vali Acc: 0.338 Test Loss: 1.420 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.057932376861572
Epoch: 5, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.407 Vali Acc: 0.378 Test Loss: 1.407 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378364).  Saving model ...
Epoch: 6 cost time: 4.01813006401062
Epoch: 6, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.485 Vali Acc: 0.351 Test Loss: 1.485 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.461912631988525
Epoch: 7, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.484 Vali Acc: 0.365 Test Loss: 1.484 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.2327117919921875
Epoch: 8, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.549 Vali Acc: 0.338 Test Loss: 1.549 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.433508634567261
Epoch: 9, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.626 Vali Acc: 0.378 Test Loss: 1.626 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.3271942138671875
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.690 Vali Acc: 0.365 Test Loss: 1.690 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.156874895095825
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.771 Vali Acc: 0.351 Test Loss: 1.771 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.087031602859497
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.839 Vali Acc: 0.378 Test Loss: 1.839 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.8323140144348145
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.818 Vali Acc: 0.351 Test Loss: 1.818 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.004800081253052
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.885 Vali Acc: 0.351 Test Loss: 1.885 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.9526941776275635
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.904 Vali Acc: 0.365 Test Loss: 1.904 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.513261079788208
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.405 Vali Acc: 0.284 Test Loss: 1.405 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 4.176045656204224
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.419 Vali Acc: 0.257 Test Loss: 1.419 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.840165376663208
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.291335344314575
Epoch: 4, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.444 Vali Acc: 0.216 Test Loss: 1.444 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.0724382400512695
Epoch: 5, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.420 Vali Acc: 0.311 Test Loss: 1.420 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 6 cost time: 4.050875186920166
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.514 Vali Acc: 0.284 Test Loss: 1.514 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8080551624298096
Epoch: 7, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.479 Vali Acc: 0.338 Test Loss: 1.479 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337823).  Saving model ...
Epoch: 8 cost time: 3.8180229663848877
Epoch: 8, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.501 Vali Acc: 0.311 Test Loss: 1.501 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.173711776733398
Epoch: 9, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.607 Vali Acc: 0.297 Test Loss: 1.607 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.747570276260376
Epoch: 10, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.668 Vali Acc: 0.270 Test Loss: 1.668 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.0738608837127686
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.670 Vali Acc: 0.324 Test Loss: 1.670 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.1231865882873535
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.759 Vali Acc: 0.324 Test Loss: 1.759 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7469820976257324
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.819 Vali Acc: 0.270 Test Loss: 1.819 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8762547969818115
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.866 Vali Acc: 0.284 Test Loss: 1.866 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7631914615631104
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.891 Vali Acc: 0.311 Test Loss: 1.891 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8341422080993652
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.909 Vali Acc: 0.284 Test Loss: 1.909 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.362201690673828
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.949 Vali Acc: 0.270 Test Loss: 1.949 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.102524757385254
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.429 Vali Acc: 0.135 Test Loss: 1.429 Test Acc: 0.135
Validation loss decreased (inf --> -0.135121).  Saving model ...
Epoch: 2 cost time: 3.934652328491211
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.432 Vali Acc: 0.216 Test Loss: 1.432 Test Acc: 0.216
Validation loss decreased (-0.135121 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 3.9098074436187744
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 4.127784013748169
Epoch: 4, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.443 Vali Acc: 0.162 Test Loss: 1.443 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.263462781906128
Epoch: 5, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.421 Vali Acc: 0.324 Test Loss: 1.421 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324310).  Saving model ...
Epoch: 6 cost time: 4.112675905227661
Epoch: 6, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.495 Vali Acc: 0.230 Test Loss: 1.495 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.91180157661438
Epoch: 7, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.485 Vali Acc: 0.351 Test Loss: 1.485 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351336).  Saving model ...
Epoch: 8 cost time: 3.9303643703460693
Epoch: 8, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.514 Vali Acc: 0.338 Test Loss: 1.514 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.850351572036743
Epoch: 9, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.598 Vali Acc: 0.297 Test Loss: 1.598 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.038645267486572
Epoch: 10, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.647 Vali Acc: 0.311 Test Loss: 1.647 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.76772141456604
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.712 Vali Acc: 0.297 Test Loss: 1.712 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.30679726600647
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.751 Vali Acc: 0.351 Test Loss: 1.751 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.386366605758667
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.774 Vali Acc: 0.338 Test Loss: 1.774 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.066272020339966
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.860 Vali Acc: 0.324 Test Loss: 1.860 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.067509174346924
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.877 Vali Acc: 0.365 Test Loss: 1.877 Test Acc: 0.365
Validation loss decreased (-0.351336 --> -0.364846).  Saving model ...
Epoch: 16 cost time: 4.246422290802002
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.903 Vali Acc: 0.365 Test Loss: 1.903 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.026040315628052
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.944 Vali Acc: 0.351 Test Loss: 1.944 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.154253959655762
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.972 Vali Acc: 0.378 Test Loss: 1.972 Test Acc: 0.378
Validation loss decreased (-0.364846 --> -0.378359).  Saving model ...
Epoch: 19 cost time: 4.218116998672485
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.970 Vali Acc: 0.351 Test Loss: 1.970 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.01650595664978
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.964 Vali Acc: 0.365 Test Loss: 1.964 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7183330059051514
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.017 Vali Acc: 0.419 Test Loss: 2.017 Test Acc: 0.419
Validation loss decreased (-0.378359 --> -0.418899).  Saving model ...
Epoch: 22 cost time: 4.138526439666748
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.022 Vali Acc: 0.378 Test Loss: 2.022 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.625112295150757
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.026 Vali Acc: 0.392 Test Loss: 2.026 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7481601238250732
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.046 Vali Acc: 0.378 Test Loss: 2.046 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.6234941482543945
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.073 Vali Acc: 0.392 Test Loss: 2.073 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.577842950820923
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.087 Vali Acc: 0.378 Test Loss: 2.087 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.5845530033111572
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.099 Vali Acc: 0.365 Test Loss: 2.099 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.0601654052734375
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.117 Vali Acc: 0.378 Test Loss: 2.117 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.869384288787842
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.122 Vali Acc: 0.365 Test Loss: 2.122 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.8124237060546875
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.140 Vali Acc: 0.365 Test Loss: 2.140 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.95632266998291
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.160 Vali Acc: 0.365 Test Loss: 2.160 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.633216619491577
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.428 Vali Acc: 0.216 Test Loss: 1.428 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.196251392364502
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.452 Vali Acc: 0.243 Test Loss: 1.452 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 3.809476613998413
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.442 Vali Acc: 0.257 Test Loss: 1.442 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256742).  Saving model ...
Epoch: 4 cost time: 4.034197092056274
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.502 Vali Acc: 0.203 Test Loss: 1.502 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.704625129699707
Epoch: 5, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.470 Vali Acc: 0.257 Test Loss: 1.470 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.929687738418579
Epoch: 6, Steps: 10 | Train Loss: 0.766 Vali Loss: 1.564 Vali Acc: 0.162 Test Loss: 1.564 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7045071125030518
Epoch: 7, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.566 Vali Acc: 0.284 Test Loss: 1.566 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283768).  Saving model ...
Epoch: 8 cost time: 3.7266244888305664
Epoch: 8, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.553 Vali Acc: 0.257 Test Loss: 1.553 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.699556589126587
Epoch: 9, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.664 Vali Acc: 0.176 Test Loss: 1.664 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7119293212890625
Epoch: 10, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.722 Vali Acc: 0.243 Test Loss: 1.722 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9642350673675537
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.733 Vali Acc: 0.230 Test Loss: 1.733 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8290817737579346
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.794 Vali Acc: 0.243 Test Loss: 1.794 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.005775451660156
Epoch: 13, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.857 Vali Acc: 0.243 Test Loss: 1.857 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.0831618309021
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.889 Vali Acc: 0.270 Test Loss: 1.889 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7754361629486084
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.970 Vali Acc: 0.257 Test Loss: 1.970 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.977161169052124
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.999 Vali Acc: 0.270 Test Loss: 1.999 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7889084815979004
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.050 Vali Acc: 0.243 Test Loss: 2.050 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.28378378378378377
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.136286020278931
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.411 Vali Acc: 0.257 Test Loss: 1.411 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.774566888809204
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.450 Vali Acc: 0.216 Test Loss: 1.450 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.800264358520508
Epoch: 3, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.418 Vali Acc: 0.230 Test Loss: 1.418 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9243369102478027
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.471 Vali Acc: 0.216 Test Loss: 1.471 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6518406867980957
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.446 Vali Acc: 0.297 Test Loss: 1.446 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297283).  Saving model ...
Epoch: 6 cost time: 3.6399853229522705
Epoch: 6, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.520 Vali Acc: 0.203 Test Loss: 1.520 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.536496639251709
Epoch: 7, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.549 Vali Acc: 0.284 Test Loss: 1.549 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.71642804145813
Epoch: 8, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.048000812530518
Epoch: 9, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.709 Vali Acc: 0.230 Test Loss: 1.709 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9218087196350098
Epoch: 10, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.643 Vali Acc: 0.257 Test Loss: 1.643 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7661900520324707
Epoch: 11, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.800 Vali Acc: 0.149 Test Loss: 1.800 Test Acc: 0.149
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8067944049835205
Epoch: 12, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.761 Vali Acc: 0.297 Test Loss: 1.761 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.9062581062316895
Epoch: 13, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.961 Vali Acc: 0.230 Test Loss: 1.961 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.8492519855499268
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.892 Vali Acc: 0.243 Test Loss: 1.892 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.90799617767334
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.974 Vali Acc: 0.243 Test Loss: 1.974 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.2972972972972973
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.921276092529297
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.365 Vali Acc: 0.297 Test Loss: 1.365 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 3.407552719116211
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.392542839050293
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.360 Vali Acc: 0.351 Test Loss: 1.360 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 3.583608388900757
Epoch: 4, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.906001329421997
Epoch: 5, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.359 Vali Acc: 0.432 Test Loss: 1.359 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 3.7909648418426514
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.053377628326416
Epoch: 7, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.439 Vali Acc: 0.324 Test Loss: 1.439 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.229962587356567
Epoch: 8, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.396 Vali Acc: 0.324 Test Loss: 1.396 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.9448940753936768
Epoch: 9, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.509 Vali Acc: 0.270 Test Loss: 1.509 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.076040267944336
Epoch: 10, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.510 Vali Acc: 0.297 Test Loss: 1.510 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.174180746078491
Epoch: 11, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.568 Vali Acc: 0.257 Test Loss: 1.568 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9686734676361084
Epoch: 12, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.520 Vali Acc: 0.378 Test Loss: 1.520 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.064726829528809
Epoch: 13, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.723 Vali Acc: 0.284 Test Loss: 1.723 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.956650495529175
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.660 Vali Acc: 0.338 Test Loss: 1.660 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.988781452178955
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.721 Vali Acc: 0.311 Test Loss: 1.721 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.366705656051636
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.400 Vali Acc: 0.216 Test Loss: 1.400 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.8895604610443115
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.403 Vali Acc: 0.257 Test Loss: 1.403 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 3.7558515071868896
Epoch: 3, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.359 Vali Acc: 0.297 Test Loss: 1.359 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 3.8411874771118164
Epoch: 4, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.781148672103882
Epoch: 5, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.371 Vali Acc: 0.284 Test Loss: 1.371 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.174187421798706
Epoch: 6, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.358 Vali Acc: 0.257 Test Loss: 1.358 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.201266527175903
Epoch: 7, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.261686563491821
Epoch: 8, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.341 Vali Acc: 0.311 Test Loss: 1.341 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310797).  Saving model ...
Epoch: 9 cost time: 3.994626998901367
Epoch: 9, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.381 Vali Acc: 0.257 Test Loss: 1.381 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.118157386779785
Epoch: 10, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.257908344268799
Epoch: 11, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.344 Vali Acc: 0.311 Test Loss: 1.344 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.181933403015137
Epoch: 12, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.068190336227417
Epoch: 13, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.390 Vali Acc: 0.284 Test Loss: 1.390 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.8911585807800293
Epoch: 14, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.395 Vali Acc: 0.311 Test Loss: 1.395 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.827498197555542
Epoch: 15, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.415 Vali Acc: 0.284 Test Loss: 1.415 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.5633180141448975
Epoch: 16, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.434 Vali Acc: 0.297 Test Loss: 1.434 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5165295600891113
Epoch: 17, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.450 Vali Acc: 0.297 Test Loss: 1.450 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.8246662616729736
Epoch: 18, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.484 Vali Acc: 0.297 Test Loss: 1.484 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.208016633987427
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.446 Vali Acc: 0.176 Test Loss: 1.446 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.9399163722991943
Epoch: 2, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.450 Vali Acc: 0.176 Test Loss: 1.450 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.697497844696045
Epoch: 3, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.410 Vali Acc: 0.257 Test Loss: 1.410 Test Acc: 0.257
Validation loss decreased (-0.175661 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 3.7035369873046875
Epoch: 4, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0299577713012695
Epoch: 5, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
Validation loss decreased (-0.256743 --> -0.270256).  Saving model ...
Epoch: 6 cost time: 4.007575511932373
Epoch: 6, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.284212827682495
Epoch: 7, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.453 Vali Acc: 0.284 Test Loss: 1.453 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283769).  Saving model ...
Epoch: 8 cost time: 4.313557386398315
Epoch: 8, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.394 Vali Acc: 0.284 Test Loss: 1.394 Test Acc: 0.284
Validation loss decreased (-0.283769 --> -0.283770).  Saving model ...
Epoch: 9 cost time: 4.197993040084839
Epoch: 9, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.394 Vali Acc: 0.338 Test Loss: 1.394 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 10 cost time: 3.710010051727295
Epoch: 10, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.455 Vali Acc: 0.311 Test Loss: 1.455 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.995405912399292
Epoch: 11, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.393 Vali Acc: 0.365 Test Loss: 1.393 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 12 cost time: 4.022144317626953
Epoch: 12, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.451 Vali Acc: 0.284 Test Loss: 1.451 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6811602115631104
Epoch: 13, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.424 Vali Acc: 0.324 Test Loss: 1.424 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.022085666656494
Epoch: 14, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.411 Vali Acc: 0.311 Test Loss: 1.411 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.996208667755127
Epoch: 15, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.459 Vali Acc: 0.311 Test Loss: 1.459 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.056991100311279
Epoch: 16, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.450 Vali Acc: 0.297 Test Loss: 1.450 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.820009231567383
Epoch: 17, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.446 Vali Acc: 0.324 Test Loss: 1.446 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.139163017272949
Epoch: 18, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.525 Vali Acc: 0.270 Test Loss: 1.525 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.128879547119141
Epoch: 19, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.458 Vali Acc: 0.378 Test Loss: 1.458 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378364).  Saving model ...
Epoch: 20 cost time: 4.157905578613281
Epoch: 20, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.510 Vali Acc: 0.351 Test Loss: 1.510 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.130311727523804
Epoch: 21, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.546 Vali Acc: 0.324 Test Loss: 1.546 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.089050054550171
Epoch: 22, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.682 Vali Acc: 0.243 Test Loss: 1.682 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7779836654663086
Epoch: 23, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.625 Vali Acc: 0.297 Test Loss: 1.625 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.8201184272766113
Epoch: 24, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.648 Vali Acc: 0.338 Test Loss: 1.648 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.9052395820617676
Epoch: 25, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.958 Vali Acc: 0.216 Test Loss: 1.958 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.031631708145142
Epoch: 26, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.758 Vali Acc: 0.365 Test Loss: 1.758 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.7704739570617676
Epoch: 27, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.877 Vali Acc: 0.216 Test Loss: 1.877 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.774247407913208
Epoch: 28, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.834 Vali Acc: 0.311 Test Loss: 1.834 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.7411038875579834
Epoch: 29, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.979 Vali Acc: 0.257 Test Loss: 1.979 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 487908
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.440141677856445
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.445 Vali Acc: 0.284 Test Loss: 1.445 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 4.093719005584717
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.344 Vali Acc: 0.378 Test Loss: 1.344 Test Acc: 0.378
Validation loss decreased (-0.283769 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 4.117969751358032
Epoch: 3, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.293 Vali Acc: 0.459 Test Loss: 1.293 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 4.152416944503784
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.217 Vali Acc: 0.554 Test Loss: 1.217 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 4.363882064819336
Epoch: 5, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.193 Vali Acc: 0.541 Test Loss: 1.193 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.12752103805542
Epoch: 6, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 4.085208177566528
Epoch: 7, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 4.155892848968506
Epoch: 8, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.230917692184448
Epoch: 9, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.006 Vali Acc: 0.568 Test Loss: 1.006 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.892605781555176
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.020 Vali Acc: 0.527 Test Loss: 1.020 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8177096843719482
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 3.7653579711914062
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.957 Vali Acc: 0.635 Test Loss: 0.957 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 13 cost time: 3.547567129135132
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.951 Vali Acc: 0.635 Test Loss: 0.951 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 14 cost time: 3.571295738220215
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.914 Vali Acc: 0.649 Test Loss: 0.914 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648640).  Saving model ...
Epoch: 15 cost time: 3.7644970417022705
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.934 Vali Acc: 0.662 Test Loss: 0.934 Test Acc: 0.662
Validation loss decreased (-0.648640 --> -0.662153).  Saving model ...
Epoch: 16 cost time: 3.8051369190216064
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.935 Vali Acc: 0.649 Test Loss: 0.935 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6844685077667236
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.961 Vali Acc: 0.622 Test Loss: 0.961 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8326282501220703
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.962 Vali Acc: 0.581 Test Loss: 0.962 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7068536281585693
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.951 Vali Acc: 0.635 Test Loss: 0.951 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.144071340560913
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.957 Vali Acc: 0.622 Test Loss: 0.957 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.005239009857178
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.960 Vali Acc: 0.622 Test Loss: 0.960 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.7712271213531494
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.960 Vali Acc: 0.622 Test Loss: 0.960 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.793074607849121
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.964 Vali Acc: 0.595 Test Loss: 0.964 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.9833767414093018
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.964 Vali Acc: 0.622 Test Loss: 0.964 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.191070556640625
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.978 Vali Acc: 0.608 Test Loss: 0.978 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.222196578979492
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.443 Vali Acc: 0.297 Test Loss: 1.443 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 3.7549595832824707
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 3.894303560256958
Epoch: 3, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.297 Vali Acc: 0.419 Test Loss: 1.297 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 4.097222328186035
Epoch: 4, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 3.7806594371795654
Epoch: 5, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.225 Vali Acc: 0.419 Test Loss: 1.225 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.738452672958374
Epoch: 6, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 3.9241485595703125
Epoch: 7, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.00699257850647
Epoch: 8, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9690940380096436
Epoch: 9, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 4.050202369689941
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.796898365020752
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 4.2968785762786865
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.573976993560791
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.38285231590271
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.056 Vali Acc: 0.662 Test Loss: 1.056 Test Acc: 0.662
Validation loss decreased (-0.621611 --> -0.662152).  Saving model ...
Epoch: 15 cost time: 4.08648419380188
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.024065256118774
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.081 Vali Acc: 0.595 Test Loss: 1.081 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9938290119171143
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.094 Vali Acc: 0.595 Test Loss: 1.094 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8248908519744873
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.098 Vali Acc: 0.622 Test Loss: 1.098 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.943011522293091
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.104 Vali Acc: 0.608 Test Loss: 1.104 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.196098327636719
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.108 Vali Acc: 0.595 Test Loss: 1.108 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.852271556854248
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.111 Vali Acc: 0.608 Test Loss: 1.111 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.016356468200684
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.110 Vali Acc: 0.608 Test Loss: 1.110 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.214751958847046
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.114 Vali Acc: 0.622 Test Loss: 1.114 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.0670342445373535
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.120 Vali Acc: 0.622 Test Loss: 1.120 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.617115497589111
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.456 Vali Acc: 0.216 Test Loss: 1.456 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.29210352897644
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.400 Vali Acc: 0.324 Test Loss: 1.400 Test Acc: 0.324
Validation loss decreased (-0.216202 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 4.244240999221802
Epoch: 3, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.405 Vali Acc: 0.297 Test Loss: 1.405 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.945432662963867
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.402 Vali Acc: 0.365 Test Loss: 1.402 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 4.08643651008606
Epoch: 5, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.434 Vali Acc: 0.324 Test Loss: 1.434 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.984232187271118
Epoch: 6, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.438 Vali Acc: 0.405 Test Loss: 1.438 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405391).  Saving model ...
Epoch: 7 cost time: 3.7856974601745605
Epoch: 7, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.486 Vali Acc: 0.338 Test Loss: 1.486 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.062436580657959
Epoch: 8, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.541 Vali Acc: 0.419 Test Loss: 1.541 Test Acc: 0.419
Validation loss decreased (-0.405391 --> -0.418904).  Saving model ...
Epoch: 9 cost time: 3.8683037757873535
Epoch: 9, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.543 Vali Acc: 0.365 Test Loss: 1.543 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.686798095703125
Epoch: 10, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.665 Vali Acc: 0.405 Test Loss: 1.665 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.029078483581543
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.598 Vali Acc: 0.419 Test Loss: 1.598 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.233002185821533
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.728 Vali Acc: 0.365 Test Loss: 1.728 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.334827899932861
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.766 Vali Acc: 0.405 Test Loss: 1.766 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.392271995544434
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.842 Vali Acc: 0.392 Test Loss: 1.842 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.308185577392578
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.853 Vali Acc: 0.405 Test Loss: 1.853 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.284023284912109
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.844 Vali Acc: 0.405 Test Loss: 1.844 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.341913938522339
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.902 Vali Acc: 0.378 Test Loss: 1.902 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.581932306289673
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.935 Vali Acc: 0.392 Test Loss: 1.935 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.537522315979004
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.439 Vali Acc: 0.243 Test Loss: 1.439 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.9006385803222656
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.395 Vali Acc: 0.297 Test Loss: 1.395 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 3.9746673107147217
Epoch: 3, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.419 Vali Acc: 0.297 Test Loss: 1.419 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9277002811431885
Epoch: 4, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.410 Vali Acc: 0.351 Test Loss: 1.410 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351337).  Saving model ...
Epoch: 5 cost time: 4.197702884674072
Epoch: 5, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.153181552886963
Epoch: 6, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.439 Vali Acc: 0.365 Test Loss: 1.439 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364850).  Saving model ...
Epoch: 7 cost time: 4.408751010894775
Epoch: 7, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.483 Vali Acc: 0.311 Test Loss: 1.483 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.6085734367370605
Epoch: 8, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.563 Vali Acc: 0.324 Test Loss: 1.563 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.406767845153809
Epoch: 9, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.528 Vali Acc: 0.324 Test Loss: 1.528 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.232943058013916
Epoch: 10, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.689 Vali Acc: 0.297 Test Loss: 1.689 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.327063798904419
Epoch: 11, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.622 Vali Acc: 0.351 Test Loss: 1.622 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.034805774688721
Epoch: 12, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.783 Vali Acc: 0.270 Test Loss: 1.783 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.138987302780151
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.768 Vali Acc: 0.324 Test Loss: 1.768 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.569042921066284
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.871 Vali Acc: 0.270 Test Loss: 1.871 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9982688426971436
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.874 Vali Acc: 0.311 Test Loss: 1.874 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8360543251037598
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.898 Vali Acc: 0.311 Test Loss: 1.898 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.765012264251709
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.490 Vali Acc: 0.216 Test Loss: 1.490 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 3.8300445079803467
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.451 Vali Acc: 0.216 Test Loss: 1.451 Test Acc: 0.216
Validation loss decreased (-0.216201 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 3.5133423805236816
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.459 Vali Acc: 0.230 Test Loss: 1.459 Test Acc: 0.230
Validation loss decreased (-0.216202 --> -0.229715).  Saving model ...
Epoch: 4 cost time: 3.5484201908111572
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.452 Vali Acc: 0.257 Test Loss: 1.452 Test Acc: 0.257
Validation loss decreased (-0.229715 --> -0.256742).  Saving model ...
Epoch: 5 cost time: 3.7494356632232666
Epoch: 5, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.472 Vali Acc: 0.297 Test Loss: 1.472 Test Acc: 0.297
Validation loss decreased (-0.256742 --> -0.297283).  Saving model ...
Epoch: 6 cost time: 3.7469894886016846
Epoch: 6, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.480 Vali Acc: 0.311 Test Loss: 1.480 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310796).  Saving model ...
Epoch: 7 cost time: 3.7177340984344482
Epoch: 7, Steps: 10 | Train Loss: 0.627 Vali Loss: 1.539 Vali Acc: 0.378 Test Loss: 1.539 Test Acc: 0.378
Validation loss decreased (-0.310796 --> -0.378363).  Saving model ...
Epoch: 8 cost time: 4.044670343399048
Epoch: 8, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.579 Vali Acc: 0.324 Test Loss: 1.579 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.164079904556274
Epoch: 9, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.564 Vali Acc: 0.378 Test Loss: 1.564 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8229942321777344
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.704 Vali Acc: 0.338 Test Loss: 1.704 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7439441680908203
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.701 Vali Acc: 0.324 Test Loss: 1.701 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.731355905532837
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.815 Vali Acc: 0.351 Test Loss: 1.815 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.686464309692383
Epoch: 13, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.829 Vali Acc: 0.324 Test Loss: 1.829 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.608405351638794
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.944 Vali Acc: 0.351 Test Loss: 1.944 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.732048988342285
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.940 Vali Acc: 0.338 Test Loss: 1.940 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.500774621963501
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.955 Vali Acc: 0.338 Test Loss: 1.955 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.595351457595825
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.000 Vali Acc: 0.351 Test Loss: 2.000 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.823437690734863
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.493 Vali Acc: 0.189 Test Loss: 1.493 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 4.352731943130493
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.454 Vali Acc: 0.216 Test Loss: 1.454 Test Acc: 0.216
Validation loss decreased (-0.189174 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 4.5014941692352295
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.497 Vali Acc: 0.189 Test Loss: 1.497 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.34691309928894
Epoch: 4, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.496 Vali Acc: 0.203 Test Loss: 1.496 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.2908971309661865
Epoch: 5, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.517 Vali Acc: 0.203 Test Loss: 1.517 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.120473623275757
Epoch: 6, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.566 Vali Acc: 0.176 Test Loss: 1.566 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.4579691886901855
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.590 Vali Acc: 0.243 Test Loss: 1.590 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243227).  Saving model ...
Epoch: 8 cost time: 4.566056489944458
Epoch: 8, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.669 Vali Acc: 0.230 Test Loss: 1.669 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.349112033843994
Epoch: 9, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.626 Vali Acc: 0.243 Test Loss: 1.626 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.054164409637451
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.777 Vali Acc: 0.216 Test Loss: 1.777 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.03031849861145
Epoch: 11, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.690 Vali Acc: 0.230 Test Loss: 1.690 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.36452841758728
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.831 Vali Acc: 0.216 Test Loss: 1.831 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.105285406112671
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.831 Vali Acc: 0.243 Test Loss: 1.831 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.008824586868286
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.922 Vali Acc: 0.230 Test Loss: 1.922 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.8504855632781982
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.937 Vali Acc: 0.243 Test Loss: 1.937 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.224437475204468
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.971 Vali Acc: 0.216 Test Loss: 1.971 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.702526807785034
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.048 Vali Acc: 0.216 Test Loss: 2.048 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.24324324324324326
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.349677324295044
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.463 Vali Acc: 0.284 Test Loss: 1.463 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 3.7507526874542236
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.433 Vali Acc: 0.230 Test Loss: 1.433 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.90995717048645
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.480 Vali Acc: 0.216 Test Loss: 1.480 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6643075942993164
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.480 Vali Acc: 0.189 Test Loss: 1.480 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6491785049438477
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.490 Vali Acc: 0.203 Test Loss: 1.490 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8437001705169678
Epoch: 6, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.526 Vali Acc: 0.189 Test Loss: 1.526 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.553192377090454
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.563 Vali Acc: 0.230 Test Loss: 1.563 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.469906806945801
Epoch: 8, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.637 Vali Acc: 0.189 Test Loss: 1.637 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.792997360229492
Epoch: 9, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.610 Vali Acc: 0.243 Test Loss: 1.610 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.735926866531372
Epoch: 10, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.735 Vali Acc: 0.270 Test Loss: 1.735 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5830063819885254
Epoch: 11, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.656 Vali Acc: 0.230 Test Loss: 1.656 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.28378378378378377
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.508925199508667
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.454 Vali Acc: 0.230 Test Loss: 1.454 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 3.9220774173736572
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.407 Vali Acc: 0.216 Test Loss: 1.407 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.250879287719727
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.440 Vali Acc: 0.216 Test Loss: 1.440 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.0232017040252686
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.436 Vali Acc: 0.257 Test Loss: 1.436 Test Acc: 0.257
Validation loss decreased (-0.229715 --> -0.256742).  Saving model ...
Epoch: 5 cost time: 4.238157033920288
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.438 Vali Acc: 0.257 Test Loss: 1.438 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9353442192077637
Epoch: 6, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.184523105621338
Epoch: 7, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.464 Vali Acc: 0.324 Test Loss: 1.464 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324310).  Saving model ...
Epoch: 8 cost time: 3.4198062419891357
Epoch: 8, Steps: 10 | Train Loss: 0.644 Vali Loss: 1.515 Vali Acc: 0.216 Test Loss: 1.515 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6992642879486084
Epoch: 9, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.522 Vali Acc: 0.270 Test Loss: 1.522 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.127048492431641
Epoch: 10, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.578 Vali Acc: 0.284 Test Loss: 1.578 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.538256883621216
Epoch: 11, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.554 Vali Acc: 0.297 Test Loss: 1.554 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.703461170196533
Epoch: 12, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.666 Vali Acc: 0.216 Test Loss: 1.666 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.037795305252075
Epoch: 13, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.621 Vali Acc: 0.270 Test Loss: 1.621 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.9643681049346924
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.731 Vali Acc: 0.297 Test Loss: 1.731 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7342634201049805
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.737 Vali Acc: 0.270 Test Loss: 1.737 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8578600883483887
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.763 Vali Acc: 0.297 Test Loss: 1.763 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.9864752292633057
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.796 Vali Acc: 0.270 Test Loss: 1.796 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.018914461135864
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.428 Vali Acc: 0.216 Test Loss: 1.428 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.065692186355591
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.414 Vali Acc: 0.243 Test Loss: 1.414 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 3.985294818878174
Epoch: 3, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.427 Vali Acc: 0.230 Test Loss: 1.427 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7870593070983887
Epoch: 4, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 5 cost time: 3.930201292037964
Epoch: 5, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.388 Vali Acc: 0.297 Test Loss: 1.388 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 6 cost time: 4.571590185165405
Epoch: 6, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.430 Vali Acc: 0.284 Test Loss: 1.430 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8792665004730225
Epoch: 7, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.384 Vali Acc: 0.351 Test Loss: 1.384 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 8 cost time: 3.960761785507202
Epoch: 8, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.375 Vali Acc: 0.338 Test Loss: 1.375 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.815668821334839
Epoch: 9, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.453 Vali Acc: 0.243 Test Loss: 1.453 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7794415950775146
Epoch: 10, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.362 Vali Acc: 0.324 Test Loss: 1.362 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.793687343597412
Epoch: 11, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.425 Vali Acc: 0.257 Test Loss: 1.425 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.676790237426758
Epoch: 12, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.955461025238037
Epoch: 13, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.396 Vali Acc: 0.284 Test Loss: 1.396 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7762138843536377
Epoch: 14, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.385 Vali Acc: 0.311 Test Loss: 1.385 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.498633623123169
Epoch: 15, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.615525007247925
Epoch: 16, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.411 Vali Acc: 0.324 Test Loss: 1.411 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.536005973815918
Epoch: 17, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.480 Vali Acc: 0.270 Test Loss: 1.480 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.993586301803589
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.481 Vali Acc: 0.189 Test Loss: 1.481 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 3.5629465579986572
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.457 Vali Acc: 0.216 Test Loss: 1.457 Test Acc: 0.216
Validation loss decreased (-0.189174 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 3.9736878871917725
Epoch: 3, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.462 Vali Acc: 0.230 Test Loss: 1.462 Test Acc: 0.230
Validation loss decreased (-0.216202 --> -0.229715).  Saving model ...
Epoch: 4 cost time: 3.4177746772766113
Epoch: 4, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.443 Vali Acc: 0.216 Test Loss: 1.443 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7655422687530518
Epoch: 5, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.433 Vali Acc: 0.216 Test Loss: 1.433 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8059704303741455
Epoch: 6, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.433 Vali Acc: 0.189 Test Loss: 1.433 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8957486152648926
Epoch: 7, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 8 cost time: 3.8038010597229004
Epoch: 8, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.416 Vali Acc: 0.351 Test Loss: 1.416 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351337).  Saving model ...
Epoch: 9 cost time: 3.76729679107666
Epoch: 9, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.456 Vali Acc: 0.216 Test Loss: 1.456 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6691296100616455
Epoch: 10, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.391 Vali Acc: 0.365 Test Loss: 1.391 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364851).  Saving model ...
Epoch: 11 cost time: 3.521759033203125
Epoch: 11, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6648073196411133
Epoch: 12, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.418 Vali Acc: 0.284 Test Loss: 1.418 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5631914138793945
Epoch: 13, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.395 Vali Acc: 0.257 Test Loss: 1.395 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5032193660736084
Epoch: 14, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.433 Vali Acc: 0.270 Test Loss: 1.433 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4606411457061768
Epoch: 15, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.429 Vali Acc: 0.284 Test Loss: 1.429 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7286489009857178
Epoch: 16, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.401 Vali Acc: 0.338 Test Loss: 1.401 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.8273983001708984
Epoch: 17, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.451 Vali Acc: 0.270 Test Loss: 1.451 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.8605594635009766
Epoch: 18, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.935912847518921
Epoch: 19, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.552 Vali Acc: 0.230 Test Loss: 1.552 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9222218990325928
Epoch: 20, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.522 Vali Acc: 0.284 Test Loss: 1.522 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 291300
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.424192190170288
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.446 Vali Acc: 0.203 Test Loss: 1.446 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 3.627016067504883
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.366 Vali Acc: 0.324 Test Loss: 1.366 Test Acc: 0.324
Validation loss decreased (-0.202688 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 3.759401321411133
Epoch: 3, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.317 Vali Acc: 0.365 Test Loss: 1.317 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 3.7859504222869873
Epoch: 4, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 3.6649255752563477
Epoch: 5, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.243 Vali Acc: 0.405 Test Loss: 1.243 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.695610523223877
Epoch: 6, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 3.4818809032440186
Epoch: 7, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.118 Vali Acc: 0.527 Test Loss: 1.118 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 3.6995527744293213
Epoch: 8, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.068 Vali Acc: 0.527 Test Loss: 1.068 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 3.730067491531372
Epoch: 9, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.055 Vali Acc: 0.527 Test Loss: 1.055 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 3.85011625289917
Epoch: 10, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.014 Vali Acc: 0.622 Test Loss: 1.014 Test Acc: 0.622
Validation loss decreased (-0.527016 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 3.9143571853637695
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9995310306549072
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.980 Vali Acc: 0.595 Test Loss: 0.980 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.677725076675415
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.966 Vali Acc: 0.635 Test Loss: 0.966 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 3.6428043842315674
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.999 Vali Acc: 0.635 Test Loss: 0.999 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7795791625976562
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6596596240997314
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.954 Vali Acc: 0.622 Test Loss: 0.954 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6404612064361572
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.974 Vali Acc: 0.635 Test Loss: 0.974 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.7233705520629883
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.971 Vali Acc: 0.635 Test Loss: 0.971 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.53523325920105
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.967 Vali Acc: 0.662 Test Loss: 0.967 Test Acc: 0.662
Validation loss decreased (-0.635125 --> -0.662152).  Saving model ...
Epoch: 20 cost time: 3.492009162902832
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.962 Vali Acc: 0.649 Test Loss: 0.962 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5144691467285156
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.971 Vali Acc: 0.662 Test Loss: 0.971 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.544708251953125
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.975 Vali Acc: 0.649 Test Loss: 0.975 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3430685997009277
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.584484815597534
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.961 Vali Acc: 0.649 Test Loss: 0.961 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.5200366973876953
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.973 Vali Acc: 0.649 Test Loss: 0.973 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.6935157775878906
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.981 Vali Acc: 0.676 Test Loss: 0.981 Test Acc: 0.676
Validation loss decreased (-0.662152 --> -0.675666).  Saving model ...
Epoch: 27 cost time: 3.5164976119995117
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.983 Vali Acc: 0.676 Test Loss: 0.983 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.562706232070923
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.976 Vali Acc: 0.676 Test Loss: 0.976 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 29 cost time: 3.6466336250305176
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.974 Vali Acc: 0.649 Test Loss: 0.974 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7744944095611572
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.978 Vali Acc: 0.676 Test Loss: 0.978 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7619826793670654
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.980 Vali Acc: 0.676 Test Loss: 0.980 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.918712615966797
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.983 Vali Acc: 0.676 Test Loss: 0.983 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.8871099948883057
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.991 Vali Acc: 0.676 Test Loss: 0.991 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.9514551162719727
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.990 Vali Acc: 0.676 Test Loss: 0.990 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.734389543533325
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.994 Vali Acc: 0.676 Test Loss: 0.994 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.680523633956909
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.997 Vali Acc: 0.662 Test Loss: 0.997 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.6088931560516357
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.998 Vali Acc: 0.662 Test Loss: 0.998 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.443716049194336
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.002 Vali Acc: 0.662 Test Loss: 1.002 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.257649898529053
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.859499931335449
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.345 Vali Acc: 0.378 Test Loss: 1.345 Test Acc: 0.378
Validation loss decreased (-0.243229 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 3.8474695682525635
Epoch: 3, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.302 Vali Acc: 0.446 Test Loss: 1.302 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 4.05988073348999
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 4.186188220977783
Epoch: 5, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.259 Vali Acc: 0.392 Test Loss: 1.259 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.022221803665161
Epoch: 6, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 4.036248683929443
Epoch: 7, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 3.9151153564453125
Epoch: 8, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.04353404045105
Epoch: 9, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 3.921905517578125
Epoch: 10, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 3.706526756286621
Epoch: 11, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9118666648864746
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 4.222247838973999
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 3.984787702560425
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.159 Vali Acc: 0.568 Test Loss: 1.159 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8134613037109375
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9039604663848877
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.117 Vali Acc: 0.581 Test Loss: 1.117 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 4.1612548828125
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.934168577194214
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.138 Vali Acc: 0.554 Test Loss: 1.138 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.047613143920898
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8235671520233154
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.130 Vali Acc: 0.595 Test Loss: 1.130 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 21 cost time: 4.034499883651733
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.145 Vali Acc: 0.581 Test Loss: 1.145 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6781888008117676
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.145 Vali Acc: 0.581 Test Loss: 1.145 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.993295192718506
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.130 Vali Acc: 0.595 Test Loss: 1.130 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.8083150386810303
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8646647930145264
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.152 Vali Acc: 0.595 Test Loss: 1.152 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.4730098247528076
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.157 Vali Acc: 0.581 Test Loss: 1.157 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5156259536743164
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.158 Vali Acc: 0.595 Test Loss: 1.158 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5337467193603516
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.155 Vali Acc: 0.595 Test Loss: 1.155 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.5064029693603516
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.5250329971313477
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.161 Vali Acc: 0.608 Test Loss: 1.161 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 31 cost time: 4.083295106887817
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.168 Vali Acc: 0.622 Test Loss: 1.168 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621610).  Saving model ...
Epoch: 32 cost time: 3.7524781227111816
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.164 Vali Acc: 0.608 Test Loss: 1.164 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.710163116455078
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.168 Vali Acc: 0.622 Test Loss: 1.168 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.98722243309021
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.169 Vali Acc: 0.622 Test Loss: 1.169 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.345180034637451
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.174 Vali Acc: 0.622 Test Loss: 1.174 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.7755582332611084
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.178 Vali Acc: 0.622 Test Loss: 1.178 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.9385721683502197
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.176 Vali Acc: 0.608 Test Loss: 1.176 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.7880940437316895
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.180 Vali Acc: 0.622 Test Loss: 1.180 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.7896883487701416
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.187 Vali Acc: 0.622 Test Loss: 1.187 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.8592751026153564
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.190 Vali Acc: 0.635 Test Loss: 1.190 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635123).  Saving model ...
Epoch: 41 cost time: 4.155142068862915
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.191 Vali Acc: 0.622 Test Loss: 1.191 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.7916080951690674
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.195 Vali Acc: 0.635 Test Loss: 1.195 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.8858137130737305
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.202 Vali Acc: 0.622 Test Loss: 1.202 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.7257847785949707
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.208 Vali Acc: 0.622 Test Loss: 1.208 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.8560354709625244
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.214 Vali Acc: 0.635 Test Loss: 1.214 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.6188416481018066
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.211 Vali Acc: 0.635 Test Loss: 1.211 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.6418228149414062
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.219 Vali Acc: 0.608 Test Loss: 1.219 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.8666441440582275
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.218 Vali Acc: 0.608 Test Loss: 1.218 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 4.158534526824951
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.214 Vali Acc: 0.635 Test Loss: 1.214 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.998823404312134
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.215 Vali Acc: 0.635 Test Loss: 1.215 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.118642568588257
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.447 Vali Acc: 0.257 Test Loss: 1.447 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.6033246517181396
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.412 Vali Acc: 0.297 Test Loss: 1.412 Test Acc: 0.297
Validation loss decreased (-0.256742 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 3.488895893096924
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.420 Vali Acc: 0.284 Test Loss: 1.420 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.85431170463562
Epoch: 4, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.391 Vali Acc: 0.338 Test Loss: 1.391 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 3.7084121704101562
Epoch: 5, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.481 Vali Acc: 0.297 Test Loss: 1.481 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4084906578063965
Epoch: 6, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.434 Vali Acc: 0.419 Test Loss: 1.434 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418905).  Saving model ...
Epoch: 7 cost time: 3.2854151725769043
Epoch: 7, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.495 Vali Acc: 0.365 Test Loss: 1.495 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2538411617279053
Epoch: 8, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.521 Vali Acc: 0.365 Test Loss: 1.521 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3409030437469482
Epoch: 9, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.565 Vali Acc: 0.365 Test Loss: 1.565 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.270662546157837
Epoch: 10, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.610 Vali Acc: 0.338 Test Loss: 1.610 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3597464561462402
Epoch: 11, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.712 Vali Acc: 0.365 Test Loss: 1.712 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.489516258239746
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.752 Vali Acc: 0.351 Test Loss: 1.752 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.789379119873047
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.795 Vali Acc: 0.338 Test Loss: 1.795 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.815882444381714
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.852 Vali Acc: 0.351 Test Loss: 1.852 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.880572557449341
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.864 Vali Acc: 0.351 Test Loss: 1.864 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.7000558376312256
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.899 Vali Acc: 0.365 Test Loss: 1.899 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.480778694152832
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.436 Vali Acc: 0.216 Test Loss: 1.436 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.9064440727233887
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.419 Vali Acc: 0.257 Test Loss: 1.419 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 3.534559726715088
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.443 Vali Acc: 0.230 Test Loss: 1.443 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6560630798339844
Epoch: 4, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.410 Vali Acc: 0.324 Test Loss: 1.410 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 3.5172955989837646
Epoch: 5, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.519 Vali Acc: 0.216 Test Loss: 1.519 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5534286499023438
Epoch: 6, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.447 Vali Acc: 0.324 Test Loss: 1.447 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.656165599822998
Epoch: 7, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.495 Vali Acc: 0.284 Test Loss: 1.495 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.343060255050659
Epoch: 8, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.507 Vali Acc: 0.270 Test Loss: 1.507 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.576920747756958
Epoch: 9, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.541 Vali Acc: 0.284 Test Loss: 1.541 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6475682258605957
Epoch: 10, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.573 Vali Acc: 0.270 Test Loss: 1.573 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6479766368865967
Epoch: 11, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.678 Vali Acc: 0.270 Test Loss: 1.678 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6656036376953125
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.681 Vali Acc: 0.270 Test Loss: 1.681 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.812739849090576
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.835 Vali Acc: 0.311 Test Loss: 1.835 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.7707014083862305
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.818 Vali Acc: 0.284 Test Loss: 1.818 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.32432432432432434
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.152839183807373
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.447 Vali Acc: 0.216 Test Loss: 1.447 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.4714503288269043
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 3.4495248794555664
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.434 Vali Acc: 0.243 Test Loss: 1.434 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4602365493774414
Epoch: 4, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.397 Vali Acc: 0.324 Test Loss: 1.397 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 3.3563404083251953
Epoch: 5, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.491 Vali Acc: 0.338 Test Loss: 1.491 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337823).  Saving model ...
Epoch: 6 cost time: 3.3754003047943115
Epoch: 6, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.456 Vali Acc: 0.284 Test Loss: 1.456 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3260440826416016
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.518 Vali Acc: 0.311 Test Loss: 1.518 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4091737270355225
Epoch: 8, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.543 Vali Acc: 0.311 Test Loss: 1.543 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5442874431610107
Epoch: 9, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.580 Vali Acc: 0.297 Test Loss: 1.580 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6670634746551514
Epoch: 10, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.648 Vali Acc: 0.311 Test Loss: 1.648 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.476590394973755
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.722 Vali Acc: 0.324 Test Loss: 1.722 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.380009651184082
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.787 Vali Acc: 0.297 Test Loss: 1.787 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5236761569976807
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.862 Vali Acc: 0.378 Test Loss: 1.862 Test Acc: 0.378
Validation loss decreased (-0.337823 --> -0.378360).  Saving model ...
Epoch: 14 cost time: 3.23427152633667
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.912 Vali Acc: 0.378 Test Loss: 1.912 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.518944025039673
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.953 Vali Acc: 0.324 Test Loss: 1.953 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5327420234680176
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.978 Vali Acc: 0.378 Test Loss: 1.978 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4540953636169434
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.004 Vali Acc: 0.365 Test Loss: 2.004 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.331731081008911
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.060 Vali Acc: 0.365 Test Loss: 2.060 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2566916942596436
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.091 Vali Acc: 0.378 Test Loss: 2.091 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.12638783454895
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.123 Vali Acc: 0.365 Test Loss: 2.123 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.3546390533447266
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.163 Vali Acc: 0.351 Test Loss: 2.163 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.164916753768921
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.174 Vali Acc: 0.365 Test Loss: 2.174 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1729984283447266
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.184 Vali Acc: 0.378 Test Loss: 2.184 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.9841272830963135
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.419 Vali Acc: 0.216 Test Loss: 1.419 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.25297212600708
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 4.078432321548462
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.455 Vali Acc: 0.189 Test Loss: 1.455 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.285386562347412
Epoch: 4, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.404 Vali Acc: 0.311 Test Loss: 1.404 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 3.884695291519165
Epoch: 5, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.536 Vali Acc: 0.162 Test Loss: 1.536 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9952008724212646
Epoch: 6, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.465 Vali Acc: 0.257 Test Loss: 1.465 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.901301860809326
Epoch: 7, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.555 Vali Acc: 0.203 Test Loss: 1.555 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.243088483810425
Epoch: 8, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.561 Vali Acc: 0.257 Test Loss: 1.561 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.898313283920288
Epoch: 9, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.611 Vali Acc: 0.230 Test Loss: 1.611 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8806655406951904
Epoch: 10, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.679 Vali Acc: 0.243 Test Loss: 1.679 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.772535800933838
Epoch: 11, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.710 Vali Acc: 0.243 Test Loss: 1.710 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.8558053970336914
Epoch: 12, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.767 Vali Acc: 0.216 Test Loss: 1.767 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.019695281982422
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.877 Vali Acc: 0.230 Test Loss: 1.877 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.824742555618286
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.876 Vali Acc: 0.297 Test Loss: 1.876 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.971034288406372
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.437 Vali Acc: 0.189 Test Loss: 1.437 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 3.5784146785736084
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.434 Vali Acc: 0.297 Test Loss: 1.434 Test Acc: 0.297
Validation loss decreased (-0.189175 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 3.841520071029663
Epoch: 3, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.467 Vali Acc: 0.230 Test Loss: 1.467 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.846797466278076
Epoch: 4, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.420 Vali Acc: 0.311 Test Loss: 1.420 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 3.7252609729766846
Epoch: 5, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.559 Vali Acc: 0.176 Test Loss: 1.559 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.074552774429321
Epoch: 6, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.473 Vali Acc: 0.216 Test Loss: 1.473 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5930278301239014
Epoch: 7, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.548 Vali Acc: 0.203 Test Loss: 1.548 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5682694911956787
Epoch: 8, Steps: 10 | Train Loss: 0.771 Vali Loss: 1.516 Vali Acc: 0.203 Test Loss: 1.516 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4760172367095947
Epoch: 9, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.600 Vali Acc: 0.203 Test Loss: 1.600 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5691099166870117
Epoch: 10, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.630 Vali Acc: 0.270 Test Loss: 1.630 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.389050006866455
Epoch: 11, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.666 Vali Acc: 0.216 Test Loss: 1.666 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.4287092685699463
Epoch: 12, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.761 Vali Acc: 0.203 Test Loss: 1.761 Test Acc: 0.203
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.6431679725646973
Epoch: 13, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.818 Vali Acc: 0.243 Test Loss: 1.818 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.5380067825317383
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.823 Vali Acc: 0.216 Test Loss: 1.823 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.092597961425781
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.475 Vali Acc: 0.216 Test Loss: 1.475 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 3.6879916191101074
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.457 Vali Acc: 0.270 Test Loss: 1.457 Test Acc: 0.270
Validation loss decreased (-0.216201 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 3.502567768096924
Epoch: 3, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.483 Vali Acc: 0.216 Test Loss: 1.483 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.623931884765625
Epoch: 4, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 3.591156244277954
Epoch: 5, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.540 Vali Acc: 0.176 Test Loss: 1.540 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.66965651512146
Epoch: 6, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.456 Vali Acc: 0.284 Test Loss: 1.456 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5914909839630127
Epoch: 7, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.511 Vali Acc: 0.216 Test Loss: 1.511 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5311944484710693
Epoch: 8, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.486 Vali Acc: 0.257 Test Loss: 1.486 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.734309673309326
Epoch: 9, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.522 Vali Acc: 0.257 Test Loss: 1.522 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.750763177871704
Epoch: 10, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.529 Vali Acc: 0.284 Test Loss: 1.529 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5556344985961914
Epoch: 11, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.592 Vali Acc: 0.230 Test Loss: 1.592 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.5358636379241943
Epoch: 12, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.616 Vali Acc: 0.270 Test Loss: 1.616 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.493149518966675
Epoch: 13, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.707 Vali Acc: 0.257 Test Loss: 1.707 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.584838390350342
Epoch: 14, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.667 Vali Acc: 0.324 Test Loss: 1.667 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324308).  Saving model ...
Epoch: 15 cost time: 3.804955244064331
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.718 Vali Acc: 0.324 Test Loss: 1.718 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.76867413520813
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.773 Vali Acc: 0.311 Test Loss: 1.773 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7600488662719727
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.801 Vali Acc: 0.324 Test Loss: 1.801 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6235671043395996
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.866 Vali Acc: 0.324 Test Loss: 1.866 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.8870790004730225
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.865 Vali Acc: 0.338 Test Loss: 1.865 Test Acc: 0.338
Validation loss decreased (-0.324308 --> -0.337819).  Saving model ...
Epoch: 20 cost time: 3.768432378768921
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.891 Vali Acc: 0.338 Test Loss: 1.891 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.059656858444214
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.904 Vali Acc: 0.324 Test Loss: 1.904 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6982228755950928
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.928 Vali Acc: 0.311 Test Loss: 1.928 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5775020122528076
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.961 Vali Acc: 0.338 Test Loss: 1.961 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5117621421813965
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.951 Vali Acc: 0.324 Test Loss: 1.951 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.42805552482605
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.984 Vali Acc: 0.324 Test Loss: 1.984 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4142117500305176
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.997 Vali Acc: 0.297 Test Loss: 1.997 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.402323007583618
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.005 Vali Acc: 0.324 Test Loss: 2.005 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.6418514251708984
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.016 Vali Acc: 0.324 Test Loss: 2.016 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.428429126739502
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.023 Vali Acc: 0.338 Test Loss: 2.023 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.353837251663208
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.461 Vali Acc: 0.230 Test Loss: 1.461 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 3.8590102195739746
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 4.439455270767212
Epoch: 3, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.463 Vali Acc: 0.257 Test Loss: 1.463 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256742).  Saving model ...
Epoch: 4 cost time: 3.955761671066284
Epoch: 4, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.402 Vali Acc: 0.257 Test Loss: 1.402 Test Acc: 0.257
Validation loss decreased (-0.256742 --> -0.256743).  Saving model ...
Epoch: 5 cost time: 4.232880353927612
Epoch: 5, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.461 Vali Acc: 0.270 Test Loss: 1.461 Test Acc: 0.270
Validation loss decreased (-0.256743 --> -0.270256).  Saving model ...
Epoch: 6 cost time: 3.687957525253296
Epoch: 6, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270256).  Saving model ...
Epoch: 7 cost time: 4.059791326522827
Epoch: 7, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.436 Vali Acc: 0.230 Test Loss: 1.436 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.912987232208252
Epoch: 8, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.383 Vali Acc: 0.351 Test Loss: 1.383 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 9 cost time: 3.910165309906006
Epoch: 9, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.418 Vali Acc: 0.297 Test Loss: 1.418 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6687068939208984
Epoch: 10, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.382 Vali Acc: 0.284 Test Loss: 1.382 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.706347942352295
Epoch: 11, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.523810625076294
Epoch: 12, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.431 Vali Acc: 0.243 Test Loss: 1.431 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.778701066970825
Epoch: 13, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.366 Vali Acc: 0.338 Test Loss: 1.366 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.993645191192627
Epoch: 14, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.403 Vali Acc: 0.284 Test Loss: 1.403 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8666000366210938
Epoch: 15, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.416 Vali Acc: 0.311 Test Loss: 1.416 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.8921327590942383
Epoch: 16, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.451 Vali Acc: 0.297 Test Loss: 1.451 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.7724244594573975
Epoch: 17, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.408 Vali Acc: 0.311 Test Loss: 1.408 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.665447473526001
Epoch: 18, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.493 Vali Acc: 0.297 Test Loss: 1.493 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.815528631210327
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.476 Vali Acc: 0.257 Test Loss: 1.476 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.4228835105895996
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.449 Vali Acc: 0.284 Test Loss: 1.449 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 3.661696195602417
Epoch: 3, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.452 Vali Acc: 0.257 Test Loss: 1.452 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.744912624359131
Epoch: 4, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.430 Vali Acc: 0.297 Test Loss: 1.430 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 3.5398454666137695
Epoch: 5, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.481 Vali Acc: 0.216 Test Loss: 1.481 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6532022953033447
Epoch: 6, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9036359786987305
Epoch: 7, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.549919843673706
Epoch: 8, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.406 Vali Acc: 0.284 Test Loss: 1.406 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5628225803375244
Epoch: 9, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.471 Vali Acc: 0.216 Test Loss: 1.471 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4859018325805664
Epoch: 10, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.437 Vali Acc: 0.297 Test Loss: 1.437 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6995840072631836
Epoch: 11, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.443 Vali Acc: 0.243 Test Loss: 1.443 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2269532680511475
Epoch: 12, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.444 Vali Acc: 0.230 Test Loss: 1.444 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.40376615524292
Epoch: 13, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.360 Vali Acc: 0.378 Test Loss: 1.360 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 14 cost time: 3.424065113067627
Epoch: 14, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5951032638549805
Epoch: 15, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3877310752868652
Epoch: 16, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.7505075931549072
Epoch: 17, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5762274265289307
Epoch: 18, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.435 Vali Acc: 0.216 Test Loss: 1.435 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.5361580848693848
Epoch: 19, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.415 Vali Acc: 0.338 Test Loss: 1.415 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.766342878341675
Epoch: 20, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.462 Vali Acc: 0.270 Test Loss: 1.462 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.579943895339966
Epoch: 21, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.655930519104004
Epoch: 22, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.452 Vali Acc: 0.284 Test Loss: 1.452 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.592864751815796
Epoch: 23, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.520 Vali Acc: 0.311 Test Loss: 1.520 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 192996
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.2904579639434814
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.405 Vali Acc: 0.284 Test Loss: 1.405 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.365722179412842
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.362 Vali Acc: 0.378 Test Loss: 1.362 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 3.3491640090942383
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 3.2781035900115967
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.271 Vali Acc: 0.446 Test Loss: 1.271 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 3.394091844558716
Epoch: 5, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.139 Vali Acc: 0.568 Test Loss: 1.139 Test Acc: 0.568
Validation loss decreased (-0.445933 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 3.5739693641662598
Epoch: 6, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.298692226409912
Epoch: 7, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.079 Vali Acc: 0.595 Test Loss: 1.079 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 3.70181941986084
Epoch: 8, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.071 Vali Acc: 0.595 Test Loss: 1.071 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 3.5937397480010986
Epoch: 9, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.561293840408325
Epoch: 10, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 4.075632572174072
Epoch: 11, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.030 Vali Acc: 0.554 Test Loss: 1.030 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.995542526245117
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.979 Vali Acc: 0.649 Test Loss: 0.979 Test Acc: 0.649
Validation loss decreased (-0.608098 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 4.089246034622192
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.974 Vali Acc: 0.635 Test Loss: 0.974 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.404144048690796
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.968 Vali Acc: 0.608 Test Loss: 0.968 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.989598512649536
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.974 Vali Acc: 0.622 Test Loss: 0.974 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.073697566986084
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.955 Vali Acc: 0.635 Test Loss: 0.955 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8995511531829834
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.957 Vali Acc: 0.622 Test Loss: 0.957 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.213098764419556
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.957 Vali Acc: 0.635 Test Loss: 0.957 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.925447940826416
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.952 Vali Acc: 0.622 Test Loss: 0.952 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.116858005523682
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.959 Vali Acc: 0.635 Test Loss: 0.959 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.061373710632324
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.968 Vali Acc: 0.622 Test Loss: 0.968 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.243755578994751
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.961 Vali Acc: 0.622 Test Loss: 0.961 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.259082317352295
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.910344123840332
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.354 Vali Acc: 0.338 Test Loss: 1.354 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 4.19770073890686
Epoch: 3, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.265 Vali Acc: 0.392 Test Loss: 1.265 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 3.9717655181884766
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.295 Vali Acc: 0.419 Test Loss: 1.295 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 4.110999822616577
Epoch: 5, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 4.128515958786011
Epoch: 6, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.246 Vali Acc: 0.459 Test Loss: 1.246 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.689225435256958
Epoch: 7, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 3.8960764408111572
Epoch: 8, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.145080327987671
Epoch: 9, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8817243576049805
Epoch: 10, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.117 Vali Acc: 0.486 Test Loss: 1.117 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8946144580841064
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.162 Vali Acc: 0.486 Test Loss: 1.162 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.858520269393921
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.125 Vali Acc: 0.473 Test Loss: 1.125 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7114081382751465
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.148 Vali Acc: 0.473 Test Loss: 1.148 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.0705406665802
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 3.9123759269714355
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9032490253448486
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.2667107582092285
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.033578395843506
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.409744024276733
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7217395305633545
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.248879909515381
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.211 Vali Acc: 0.514 Test Loss: 1.211 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.494899272918701
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.201 Vali Acc: 0.527 Test Loss: 1.201 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8966598510742188
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7104039192199707
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.527 Test Loss: 1.218 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.789397478103638
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.7548723220825195
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.418 Vali Acc: 0.284 Test Loss: 1.418 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 3.9277257919311523
Epoch: 3, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.376 Vali Acc: 0.351 Test Loss: 1.376 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 4.152550935745239
Epoch: 4, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.455 Vali Acc: 0.297 Test Loss: 1.455 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9133198261260986
Epoch: 5, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.382 Vali Acc: 0.365 Test Loss: 1.382 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364851).  Saving model ...
Epoch: 6 cost time: 3.7814114093780518
Epoch: 6, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.507 Vali Acc: 0.324 Test Loss: 1.507 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8419604301452637
Epoch: 7, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.443 Vali Acc: 0.324 Test Loss: 1.443 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.685109853744507
Epoch: 8, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.546 Vali Acc: 0.324 Test Loss: 1.546 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.847229480743408
Epoch: 9, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.580 Vali Acc: 0.324 Test Loss: 1.580 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9830689430236816
Epoch: 10, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.573 Vali Acc: 0.365 Test Loss: 1.573 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9001264572143555
Epoch: 11, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.660 Vali Acc: 0.338 Test Loss: 1.660 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.655405044555664
Epoch: 12, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.713 Vali Acc: 0.338 Test Loss: 1.713 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.7129392623901367
Epoch: 13, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.769 Vali Acc: 0.338 Test Loss: 1.769 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7274696826934814
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.832 Vali Acc: 0.324 Test Loss: 1.832 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.628878116607666
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.873 Vali Acc: 0.338 Test Loss: 1.873 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.112883806228638
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.421 Vali Acc: 0.270 Test Loss: 1.421 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.690664768218994
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.437 Vali Acc: 0.203 Test Loss: 1.437 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6588568687438965
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5889363288879395
Epoch: 4, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.479 Vali Acc: 0.216 Test Loss: 1.479 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6840016841888428
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.403 Vali Acc: 0.311 Test Loss: 1.403 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 6 cost time: 3.703087329864502
Epoch: 6, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.540 Vali Acc: 0.203 Test Loss: 1.540 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5974645614624023
Epoch: 7, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.447 Vali Acc: 0.338 Test Loss: 1.447 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337823).  Saving model ...
Epoch: 8 cost time: 3.48332142829895
Epoch: 8, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.529 Vali Acc: 0.243 Test Loss: 1.529 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2816760540008545
Epoch: 9, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.584 Vali Acc: 0.270 Test Loss: 1.584 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.546034574508667
Epoch: 10, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.581 Vali Acc: 0.311 Test Loss: 1.581 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.555880546569824
Epoch: 11, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.646 Vali Acc: 0.324 Test Loss: 1.646 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2982192039489746
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.721 Vali Acc: 0.230 Test Loss: 1.721 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.799260139465332
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.742 Vali Acc: 0.324 Test Loss: 1.742 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.607658624649048
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.837 Vali Acc: 0.230 Test Loss: 1.837 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7754528522491455
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.839 Vali Acc: 0.284 Test Loss: 1.839 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8636677265167236
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.893 Vali Acc: 0.284 Test Loss: 1.893 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.742269277572632
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.976 Vali Acc: 0.297 Test Loss: 1.976 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.512205600738525
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.429 Vali Acc: 0.230 Test Loss: 1.429 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 3.911102533340454
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.442 Vali Acc: 0.284 Test Loss: 1.442 Test Acc: 0.284
Validation loss decreased (-0.229715 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 3.8115878105163574
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.404 Vali Acc: 0.270 Test Loss: 1.404 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.979344606399536
Epoch: 4, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.489 Vali Acc: 0.257 Test Loss: 1.489 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8261213302612305
Epoch: 5, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.409 Vali Acc: 0.257 Test Loss: 1.409 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6671395301818848
Epoch: 6, Steps: 10 | Train Loss: 0.804 Vali Loss: 1.508 Vali Acc: 0.311 Test Loss: 1.508 Test Acc: 0.311
Validation loss decreased (-0.283769 --> -0.310796).  Saving model ...
Epoch: 7 cost time: 3.657644033432007
Epoch: 7, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.470 Vali Acc: 0.311 Test Loss: 1.470 Test Acc: 0.311
Validation loss decreased (-0.310796 --> -0.310796).  Saving model ...
Epoch: 8 cost time: 4.048433303833008
Epoch: 8, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.550 Vali Acc: 0.324 Test Loss: 1.550 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324309).  Saving model ...
Epoch: 9 cost time: 3.7054617404937744
Epoch: 9, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.622 Vali Acc: 0.338 Test Loss: 1.622 Test Acc: 0.338
Validation loss decreased (-0.324309 --> -0.337822).  Saving model ...
Epoch: 10 cost time: 3.9962410926818848
Epoch: 10, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.610 Vali Acc: 0.311 Test Loss: 1.610 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.899852752685547
Epoch: 11, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.697 Vali Acc: 0.365 Test Loss: 1.697 Test Acc: 0.365
Validation loss decreased (-0.337822 --> -0.364848).  Saving model ...
Epoch: 12 cost time: 4.1061177253723145
Epoch: 12, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.772 Vali Acc: 0.297 Test Loss: 1.772 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.155774831771851
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.815 Vali Acc: 0.338 Test Loss: 1.815 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.116923809051514
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.898 Vali Acc: 0.324 Test Loss: 1.898 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9664385318756104
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.923 Vali Acc: 0.338 Test Loss: 1.923 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.197050094604492
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.948 Vali Acc: 0.324 Test Loss: 1.948 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.305286407470703
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 2.035 Vali Acc: 0.338 Test Loss: 2.035 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.210896253585815
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.999 Vali Acc: 0.338 Test Loss: 1.999 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.804150342941284
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.041 Vali Acc: 0.311 Test Loss: 2.041 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.164502859115601
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.064 Vali Acc: 0.311 Test Loss: 2.064 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.6840853691101074
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.085 Vali Acc: 0.284 Test Loss: 2.085 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.36486486486486486
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.038928508758545
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.385 Vali Acc: 0.284 Test Loss: 1.385 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.6078925132751465
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.425 Vali Acc: 0.351 Test Loss: 1.425 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 3.772305488586426
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.845195770263672
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.486 Vali Acc: 0.230 Test Loss: 1.486 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.914846658706665
Epoch: 5, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.410 Vali Acc: 0.284 Test Loss: 1.410 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8125433921813965
Epoch: 6, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.530 Vali Acc: 0.203 Test Loss: 1.530 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8212950229644775
Epoch: 7, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.485 Vali Acc: 0.338 Test Loss: 1.485 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8471314907073975
Epoch: 8, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.560 Vali Acc: 0.257 Test Loss: 1.560 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.206608533859253
Epoch: 9, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.605 Vali Acc: 0.243 Test Loss: 1.605 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8730928897857666
Epoch: 10, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.604 Vali Acc: 0.270 Test Loss: 1.604 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7801997661590576
Epoch: 11, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.646 Vali Acc: 0.284 Test Loss: 1.646 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5370078086853027
Epoch: 12, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.781 Vali Acc: 0.257 Test Loss: 1.781 Test Acc: 0.257
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.9328672885894775
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.422 Vali Acc: 0.230 Test Loss: 1.422 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 3.860488176345825
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.431 Vali Acc: 0.243 Test Loss: 1.431 Test Acc: 0.243
Validation loss decreased (-0.229716 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 3.8761096000671387
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 3.648919105529785
Epoch: 4, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.505 Vali Acc: 0.203 Test Loss: 1.505 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9287850856781006
Epoch: 5, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.442 Vali Acc: 0.284 Test Loss: 1.442 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283769).  Saving model ...
Epoch: 6 cost time: 3.824254274368286
Epoch: 6, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.510 Vali Acc: 0.257 Test Loss: 1.510 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.003222465515137
Epoch: 7, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.481 Vali Acc: 0.230 Test Loss: 1.481 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9159436225891113
Epoch: 8, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.539 Vali Acc: 0.257 Test Loss: 1.539 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.9535694122314453
Epoch: 9, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.590 Vali Acc: 0.230 Test Loss: 1.590 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.008001804351807
Epoch: 10, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.587 Vali Acc: 0.257 Test Loss: 1.587 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.8024675846099854
Epoch: 11, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.682 Vali Acc: 0.270 Test Loss: 1.682 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.6335506439208984
Epoch: 12, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.693 Vali Acc: 0.203 Test Loss: 1.693 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.777653455734253
Epoch: 13, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.714 Vali Acc: 0.311 Test Loss: 1.714 Test Acc: 0.311
Validation loss decreased (-0.283769 --> -0.310794).  Saving model ...
Epoch: 14 cost time: 3.4979147911071777
Epoch: 14, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.842 Vali Acc: 0.270 Test Loss: 1.842 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.068891286849976
Epoch: 15, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.853 Vali Acc: 0.243 Test Loss: 1.853 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6767005920410156
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.957 Vali Acc: 0.284 Test Loss: 1.957 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.668975591659546
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.999 Vali Acc: 0.230 Test Loss: 1.999 Test Acc: 0.230
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5762321949005127
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.967 Vali Acc: 0.297 Test Loss: 1.967 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.0218586921691895
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.129 Vali Acc: 0.284 Test Loss: 2.129 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.33594012260437
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.107 Vali Acc: 0.284 Test Loss: 2.107 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.7695956230163574
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.111 Vali Acc: 0.284 Test Loss: 2.111 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.271419286727905
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.152 Vali Acc: 0.270 Test Loss: 2.152 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.088485956192017
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.180 Vali Acc: 0.270 Test Loss: 2.180 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3108108108108108
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.2717225551605225
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.905024528503418
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.446 Vali Acc: 0.216 Test Loss: 1.446 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7343225479125977
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.406 Vali Acc: 0.243 Test Loss: 1.406 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 3.590393543243408
Epoch: 4, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.481 Vali Acc: 0.203 Test Loss: 1.481 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.430715322494507
Epoch: 5, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.408 Vali Acc: 0.338 Test Loss: 1.408 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 3.884669065475464
Epoch: 6, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.505 Vali Acc: 0.284 Test Loss: 1.505 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.522608995437622
Epoch: 7, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.430 Vali Acc: 0.297 Test Loss: 1.430 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.71708083152771
Epoch: 8, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8574702739715576
Epoch: 9, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.543 Vali Acc: 0.311 Test Loss: 1.543 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.923813581466675
Epoch: 10, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.491 Vali Acc: 0.243 Test Loss: 1.491 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.1432952880859375
Epoch: 11, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.542 Vali Acc: 0.243 Test Loss: 1.542 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.331154823303223
Epoch: 12, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.633 Vali Acc: 0.257 Test Loss: 1.633 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.570495843887329
Epoch: 13, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.562 Vali Acc: 0.338 Test Loss: 1.562 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5643062591552734
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.724 Vali Acc: 0.257 Test Loss: 1.724 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.494243621826172
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.666 Vali Acc: 0.297 Test Loss: 1.666 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.602375507354736
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.392 Vali Acc: 0.284 Test Loss: 1.392 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.2459356784820557
Epoch: 2, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.407 Vali Acc: 0.297 Test Loss: 1.407 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 3.1596529483795166
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.382 Vali Acc: 0.311 Test Loss: 1.382 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 3.0788025856018066
Epoch: 4, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.417 Vali Acc: 0.338 Test Loss: 1.417 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 3.0563220977783203
Epoch: 5, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 3.4229142665863037
Epoch: 6, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.378321886062622
Epoch: 7, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.382 Vali Acc: 0.243 Test Loss: 1.382 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.28784441947937
Epoch: 8, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.342 Vali Acc: 0.311 Test Loss: 1.342 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2674434185028076
Epoch: 9, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3231453895568848
Epoch: 10, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.363 Vali Acc: 0.311 Test Loss: 1.363 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.484616279602051
Epoch: 11, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5061981678009033
Epoch: 12, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.381 Vali Acc: 0.297 Test Loss: 1.381 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.332320213317871
Epoch: 13, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.416 Vali Acc: 0.257 Test Loss: 1.416 Test Acc: 0.257
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.179433584213257
Epoch: 14, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.412 Vali Acc: 0.284 Test Loss: 1.412 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0764410495758057
Epoch: 15, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.437 Vali Acc: 0.230 Test Loss: 1.437 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.362060308456421
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.450 Vali Acc: 0.203 Test Loss: 1.450 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 3.741680145263672
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.463 Vali Acc: 0.216 Test Loss: 1.463 Test Acc: 0.216
Validation loss decreased (-0.202688 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 3.8763389587402344
Epoch: 3, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.442 Vali Acc: 0.243 Test Loss: 1.442 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 3.8563718795776367
Epoch: 4, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.496 Vali Acc: 0.189 Test Loss: 1.496 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.074831962585449
Epoch: 5, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.423 Vali Acc: 0.270 Test Loss: 1.423 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 6 cost time: 4.1505444049835205
Epoch: 6, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.465 Vali Acc: 0.216 Test Loss: 1.465 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.232744455337524
Epoch: 7, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.836777925491333
Epoch: 8, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.410 Vali Acc: 0.324 Test Loss: 1.410 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 9 cost time: 4.003600597381592
Epoch: 9, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.516 Vali Acc: 0.243 Test Loss: 1.516 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9258339405059814
Epoch: 10, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.417 Vali Acc: 0.351 Test Loss: 1.417 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351337).  Saving model ...
Epoch: 11 cost time: 3.710261344909668
Epoch: 11, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.434 Vali Acc: 0.270 Test Loss: 1.434 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8140904903411865
Epoch: 12, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.448 Vali Acc: 0.297 Test Loss: 1.448 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.860304594039917
Epoch: 13, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.425 Vali Acc: 0.284 Test Loss: 1.425 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5925168991088867
Epoch: 14, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.440 Vali Acc: 0.311 Test Loss: 1.440 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.126872777938843
Epoch: 15, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.460 Vali Acc: 0.243 Test Loss: 1.460 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5740268230438232
Epoch: 16, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.483 Vali Acc: 0.297 Test Loss: 1.483 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.868694543838501
Epoch: 17, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.542 Vali Acc: 0.243 Test Loss: 1.542 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.294281482696533
Epoch: 18, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.457 Vali Acc: 0.297 Test Loss: 1.457 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.330984830856323
Epoch: 19, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.561 Vali Acc: 0.216 Test Loss: 1.561 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.382858991622925
Epoch: 20, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.485 Vali Acc: 0.297 Test Loss: 1.485 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 143844
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7947773933410645
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.2189085483551025
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.319 Vali Acc: 0.351 Test Loss: 1.319 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 3.3062775135040283
Epoch: 3, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.249 Vali Acc: 0.419 Test Loss: 1.249 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 3.293490409851074
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 3.2194485664367676
Epoch: 5, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 3.2824132442474365
Epoch: 6, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 3.4393527507781982
Epoch: 7, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.501922845840454
Epoch: 8, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 3.4559991359710693
Epoch: 9, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7084457874298096
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.045 Vali Acc: 0.581 Test Loss: 1.045 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 3.797451972961426
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8482987880706787
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.002 Vali Acc: 0.568 Test Loss: 1.002 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5335726737976074
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.026 Vali Acc: 0.568 Test Loss: 1.026 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3319876194000244
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.443188428878784
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.010 Vali Acc: 0.568 Test Loss: 1.010 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.547093391418457
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.5396533012390137
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3265597820281982
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.040 Vali Acc: 0.568 Test Loss: 1.040 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.3141558170318604
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.035 Vali Acc: 0.568 Test Loss: 1.035 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1591055393218994
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.741373062133789
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.382 Vali Acc: 0.243 Test Loss: 1.382 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.4461543560028076
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.323 Vali Acc: 0.324 Test Loss: 1.323 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 3.5387887954711914
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.252 Vali Acc: 0.405 Test Loss: 1.252 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 3.4556989669799805
Epoch: 4, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.205 Vali Acc: 0.405 Test Loss: 1.205 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 3.453359603881836
Epoch: 5, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.186 Vali Acc: 0.419 Test Loss: 1.186 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 6 cost time: 3.432558059692383
Epoch: 6, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.418907 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 3.511050224304199
Epoch: 7, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.165 Vali Acc: 0.473 Test Loss: 1.165 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.625244617462158
Epoch: 8, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 3.5156569480895996
Epoch: 9, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.176 Vali Acc: 0.459 Test Loss: 1.176 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.677765130996704
Epoch: 10, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6810243129730225
Epoch: 11, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3580503463745117
Epoch: 12, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.116 Vali Acc: 0.514 Test Loss: 1.116 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5277597904205322
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5229148864746094
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.516362428665161
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.353269338607788
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.7764391899108887
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.5876803398132324
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.071463108062744
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.661754846572876
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.378 Vali Acc: 0.284 Test Loss: 1.378 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 3.620728015899658
Epoch: 3, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.359 Vali Acc: 0.284 Test Loss: 1.359 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 3.723513126373291
Epoch: 4, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 3.4623734951019287
Epoch: 5, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.387 Vali Acc: 0.338 Test Loss: 1.387 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.856558322906494
Epoch: 6, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.442 Vali Acc: 0.351 Test Loss: 1.442 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.845477819442749
Epoch: 7, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.477 Vali Acc: 0.365 Test Loss: 1.477 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364850).  Saving model ...
Epoch: 8 cost time: 3.9892125129699707
Epoch: 8, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.472 Vali Acc: 0.378 Test Loss: 1.472 Test Acc: 0.378
Validation loss decreased (-0.364850 --> -0.378364).  Saving model ...
Epoch: 9 cost time: 3.726228713989258
Epoch: 9, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.580 Vali Acc: 0.338 Test Loss: 1.580 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9882419109344482
Epoch: 10, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.564 Vali Acc: 0.351 Test Loss: 1.564 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.819195508956909
Epoch: 11, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.643 Vali Acc: 0.392 Test Loss: 1.643 Test Acc: 0.392
Validation loss decreased (-0.378364 --> -0.391875).  Saving model ...
Epoch: 12 cost time: 3.772738456726074
Epoch: 12, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.664 Vali Acc: 0.365 Test Loss: 1.664 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.137029409408569
Epoch: 13, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.776 Vali Acc: 0.392 Test Loss: 1.776 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.973128318786621
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.829 Vali Acc: 0.392 Test Loss: 1.829 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5946903228759766
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.836 Vali Acc: 0.351 Test Loss: 1.836 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.610208034515381
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.895 Vali Acc: 0.378 Test Loss: 1.895 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.875138759613037
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.921 Vali Acc: 0.378 Test Loss: 1.921 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.5704286098480225
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.956 Vali Acc: 0.378 Test Loss: 1.956 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.866901397705078
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.977 Vali Acc: 0.378 Test Loss: 1.977 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.78012752532959
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.013 Vali Acc: 0.378 Test Loss: 2.013 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.5985472202301025
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.035 Vali Acc: 0.392 Test Loss: 2.035 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3918918918918919
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.886678695678711
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.423 Vali Acc: 0.284 Test Loss: 1.423 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.7707571983337402
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.416 Vali Acc: 0.270 Test Loss: 1.416 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8307456970214844
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.417 Vali Acc: 0.311 Test Loss: 1.417 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 4.280207395553589
Epoch: 4, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.433 Vali Acc: 0.297 Test Loss: 1.433 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.949162244796753
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.453 Vali Acc: 0.297 Test Loss: 1.453 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.359921455383301
Epoch: 6, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.493 Vali Acc: 0.324 Test Loss: 1.493 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324309).  Saving model ...
Epoch: 7 cost time: 3.7179853916168213
Epoch: 7, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.516 Vali Acc: 0.311 Test Loss: 1.516 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5458743572235107
Epoch: 8, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.493 Vali Acc: 0.324 Test Loss: 1.493 Test Acc: 0.324
Validation loss decreased (-0.324309 --> -0.324309).  Saving model ...
Epoch: 9 cost time: 3.5323290824890137
Epoch: 9, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.587 Vali Acc: 0.270 Test Loss: 1.587 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.144724130630493
Epoch: 10, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.593 Vali Acc: 0.311 Test Loss: 1.593 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6433794498443604
Epoch: 11, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.633 Vali Acc: 0.311 Test Loss: 1.633 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4062182903289795
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.636 Vali Acc: 0.351 Test Loss: 1.636 Test Acc: 0.351
Validation loss decreased (-0.324309 --> -0.351335).  Saving model ...
Epoch: 13 cost time: 3.5004160404205322
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.784 Vali Acc: 0.338 Test Loss: 1.784 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.567326307296753
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.754 Vali Acc: 0.338 Test Loss: 1.754 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6183836460113525
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.810 Vali Acc: 0.338 Test Loss: 1.810 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.685112953186035
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.840 Vali Acc: 0.365 Test Loss: 1.840 Test Acc: 0.365
Validation loss decreased (-0.351335 --> -0.364846).  Saving model ...
Epoch: 17 cost time: 3.6112945079803467
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.889 Vali Acc: 0.351 Test Loss: 1.889 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4771952629089355
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.926 Vali Acc: 0.351 Test Loss: 1.926 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.676344633102417
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.967 Vali Acc: 0.324 Test Loss: 1.967 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5809195041656494
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.004 Vali Acc: 0.351 Test Loss: 2.004 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.4625468254089355
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.995 Vali Acc: 0.378 Test Loss: 1.995 Test Acc: 0.378
Validation loss decreased (-0.364846 --> -0.378358).  Saving model ...
Epoch: 22 cost time: 3.5849409103393555
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.027 Vali Acc: 0.338 Test Loss: 2.027 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3947980403900146
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.061 Vali Acc: 0.351 Test Loss: 2.061 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7495973110198975
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.072 Vali Acc: 0.365 Test Loss: 2.072 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4967892169952393
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.091 Vali Acc: 0.338 Test Loss: 2.091 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.653233766555786
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.121 Vali Acc: 0.338 Test Loss: 2.121 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.752307891845703
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.121 Vali Acc: 0.351 Test Loss: 2.121 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.7444684505462646
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.149 Vali Acc: 0.351 Test Loss: 2.149 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.786278486251831
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.162 Vali Acc: 0.351 Test Loss: 2.162 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.7564022541046143
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.161 Vali Acc: 0.351 Test Loss: 2.161 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.678044557571411
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.176 Vali Acc: 0.338 Test Loss: 2.176 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.3783783783783784
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.304832458496094
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.422 Vali Acc: 0.203 Test Loss: 1.422 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 3.9129390716552734
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.401 Vali Acc: 0.257 Test Loss: 1.401 Test Acc: 0.257
Validation loss decreased (-0.202688 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 3.751115083694458
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.406 Vali Acc: 0.311 Test Loss: 1.406 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 3.5664854049682617
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.405 Vali Acc: 0.338 Test Loss: 1.405 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 3.7571651935577393
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.431 Vali Acc: 0.338 Test Loss: 1.431 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1874260902404785
Epoch: 6, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.459 Vali Acc: 0.378 Test Loss: 1.459 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378364).  Saving model ...
Epoch: 7 cost time: 4.0903120040893555
Epoch: 7, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.477 Vali Acc: 0.365 Test Loss: 1.477 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.0840373039245605
Epoch: 8, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.494 Vali Acc: 0.351 Test Loss: 1.494 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6148667335510254
Epoch: 9, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.581 Vali Acc: 0.311 Test Loss: 1.581 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.919668197631836
Epoch: 10, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.600 Vali Acc: 0.365 Test Loss: 1.600 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.279419422149658
Epoch: 11, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.679 Vali Acc: 0.284 Test Loss: 1.679 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.965078830718994
Epoch: 12, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.675 Vali Acc: 0.378 Test Loss: 1.675 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7387959957122803
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.780 Vali Acc: 0.338 Test Loss: 1.780 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.660306692123413
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.810 Vali Acc: 0.392 Test Loss: 1.810 Test Acc: 0.392
Validation loss decreased (-0.378364 --> -0.391874).  Saving model ...
Epoch: 15 cost time: 3.9016661643981934
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.856 Vali Acc: 0.392 Test Loss: 1.856 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.591122627258301
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.893 Vali Acc: 0.405 Test Loss: 1.893 Test Acc: 0.405
Validation loss decreased (-0.391874 --> -0.405386).  Saving model ...
Epoch: 17 cost time: 3.655097723007202
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.941 Vali Acc: 0.392 Test Loss: 1.941 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5517044067382812
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.979 Vali Acc: 0.392 Test Loss: 1.979 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4776387214660645
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.012 Vali Acc: 0.378 Test Loss: 2.012 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3510873317718506
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.046 Vali Acc: 0.405 Test Loss: 2.046 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6224727630615234
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.046 Vali Acc: 0.419 Test Loss: 2.046 Test Acc: 0.419
Validation loss decreased (-0.405386 --> -0.418898).  Saving model ...
Epoch: 22 cost time: 3.5270144939422607
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.087 Vali Acc: 0.365 Test Loss: 2.087 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.338148593902588
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.104 Vali Acc: 0.419 Test Loss: 2.104 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1575229167938232
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.126 Vali Acc: 0.419 Test Loss: 2.126 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8326282501220703
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.146 Vali Acc: 0.405 Test Loss: 2.146 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.710188865661621
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.166 Vali Acc: 0.392 Test Loss: 2.166 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.96919846534729
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.182 Vali Acc: 0.419 Test Loss: 2.182 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.592339277267456
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.201 Vali Acc: 0.392 Test Loss: 2.201 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.958341360092163
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.196 Vali Acc: 0.392 Test Loss: 2.196 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.884551763534546
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.220 Vali Acc: 0.405 Test Loss: 2.220 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.8281726837158203
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.227 Vali Acc: 0.419 Test Loss: 2.227 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4189189189189189
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.023462295532227
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.430 Vali Acc: 0.243 Test Loss: 1.430 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.5895156860351562
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.430 Vali Acc: 0.230 Test Loss: 1.430 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8504858016967773
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.429 Vali Acc: 0.257 Test Loss: 1.429 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256742).  Saving model ...
Epoch: 4 cost time: 3.5959043502807617
Epoch: 4, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.429 Vali Acc: 0.257 Test Loss: 1.429 Test Acc: 0.257
Validation loss decreased (-0.256742 --> -0.256742).  Saving model ...
Epoch: 5 cost time: 3.822342872619629
Epoch: 5, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.461 Vali Acc: 0.270 Test Loss: 1.461 Test Acc: 0.270
Validation loss decreased (-0.256742 --> -0.270256).  Saving model ...
Epoch: 6 cost time: 3.6440861225128174
Epoch: 6, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.483 Vali Acc: 0.284 Test Loss: 1.483 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283769).  Saving model ...
Epoch: 7 cost time: 3.5268049240112305
Epoch: 7, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.517 Vali Acc: 0.270 Test Loss: 1.517 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.758626937866211
Epoch: 8, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.520 Vali Acc: 0.270 Test Loss: 1.520 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.845942735671997
Epoch: 9, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.594 Vali Acc: 0.230 Test Loss: 1.594 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6492183208465576
Epoch: 10, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.597 Vali Acc: 0.270 Test Loss: 1.597 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.671041250228882
Epoch: 11, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.664 Vali Acc: 0.284 Test Loss: 1.664 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9581782817840576
Epoch: 12, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.630 Vali Acc: 0.324 Test Loss: 1.630 Test Acc: 0.324
Validation loss decreased (-0.283769 --> -0.324308).  Saving model ...
Epoch: 13 cost time: 3.9703259468078613
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.763 Vali Acc: 0.243 Test Loss: 1.763 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4536662101745605
Epoch: 14, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.759 Vali Acc: 0.338 Test Loss: 1.759 Test Acc: 0.338
Validation loss decreased (-0.324308 --> -0.337820).  Saving model ...
Epoch: 15 cost time: 3.6532528400421143
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.816 Vali Acc: 0.297 Test Loss: 1.816 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3710498809814453
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.869 Vali Acc: 0.311 Test Loss: 1.869 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.417799472808838
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.905 Vali Acc: 0.284 Test Loss: 1.905 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6837754249572754
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.935 Vali Acc: 0.324 Test Loss: 1.935 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.715191125869751
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.994 Vali Acc: 0.257 Test Loss: 1.994 Test Acc: 0.257
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.648352861404419
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.005 Vali Acc: 0.257 Test Loss: 2.005 Test Acc: 0.257
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.5732505321502686
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.997 Vali Acc: 0.338 Test Loss: 1.997 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.8283185958862305
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.056 Vali Acc: 0.243 Test Loss: 2.056 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.584419012069702
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.074 Vali Acc: 0.243 Test Loss: 2.074 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7643425464630127
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.075 Vali Acc: 0.284 Test Loss: 2.075 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.33783783783783783
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.090074062347412
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.433 Vali Acc: 0.284 Test Loss: 1.433 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 3.747694730758667
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.425 Vali Acc: 0.257 Test Loss: 1.425 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.594942331314087
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.429 Vali Acc: 0.230 Test Loss: 1.429 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.604553461074829
Epoch: 4, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.452 Vali Acc: 0.297 Test Loss: 1.452 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 3.6123905181884766
Epoch: 5, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.508 Vali Acc: 0.270 Test Loss: 1.508 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7702205181121826
Epoch: 6, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.479 Vali Acc: 0.189 Test Loss: 1.479 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.627068042755127
Epoch: 7, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.535 Vali Acc: 0.284 Test Loss: 1.535 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7444887161254883
Epoch: 8, Steps: 10 | Train Loss: 0.766 Vali Loss: 1.518 Vali Acc: 0.189 Test Loss: 1.518 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8465394973754883
Epoch: 9, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.565 Vali Acc: 0.203 Test Loss: 1.565 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.287322759628296
Epoch: 10, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.564 Vali Acc: 0.216 Test Loss: 1.564 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.9066321849823
Epoch: 11, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.640 Vali Acc: 0.230 Test Loss: 1.640 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.95579195022583
Epoch: 12, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.622 Vali Acc: 0.230 Test Loss: 1.622 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.7755367755889893
Epoch: 13, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.762 Vali Acc: 0.257 Test Loss: 1.762 Test Acc: 0.257
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.0673441886901855
Epoch: 14, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.767 Vali Acc: 0.230 Test Loss: 1.767 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.2972972972972973
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.000002384185791
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.415 Vali Acc: 0.203 Test Loss: 1.415 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 3.5629026889801025
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.393 Vali Acc: 0.311 Test Loss: 1.393 Test Acc: 0.311
Validation loss decreased (-0.202689 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 3.4881794452667236
Epoch: 3, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.380 Vali Acc: 0.297 Test Loss: 1.380 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.265016794204712
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4086878299713135
Epoch: 5, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.409 Vali Acc: 0.257 Test Loss: 1.409 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6704025268554688
Epoch: 6, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.390 Vali Acc: 0.338 Test Loss: 1.390 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 7 cost time: 3.5262880325317383
Epoch: 7, Steps: 10 | Train Loss: 0.807 Vali Loss: 1.420 Vali Acc: 0.338 Test Loss: 1.420 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6517364978790283
Epoch: 8, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.400 Vali Acc: 0.324 Test Loss: 1.400 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6918976306915283
Epoch: 9, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.456 Vali Acc: 0.270 Test Loss: 1.456 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7573845386505127
Epoch: 10, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.446 Vali Acc: 0.311 Test Loss: 1.446 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8454995155334473
Epoch: 11, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.512 Vali Acc: 0.297 Test Loss: 1.512 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9340946674346924
Epoch: 12, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.495 Vali Acc: 0.311 Test Loss: 1.495 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.072795152664185
Epoch: 13, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.613 Vali Acc: 0.243 Test Loss: 1.613 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.023929119110107
Epoch: 14, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.535 Vali Acc: 0.351 Test Loss: 1.535 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351336).  Saving model ...
Epoch: 15 cost time: 4.0613181591033936
Epoch: 15, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.606 Vali Acc: 0.338 Test Loss: 1.606 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.769124746322632
Epoch: 16, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.670 Vali Acc: 0.324 Test Loss: 1.670 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4889190196990967
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.649 Vali Acc: 0.284 Test Loss: 1.649 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.53598690032959
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.694 Vali Acc: 0.324 Test Loss: 1.694 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5104284286499023
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.739 Vali Acc: 0.311 Test Loss: 1.739 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.798251152038574
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.765 Vali Acc: 0.284 Test Loss: 1.765 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6249701976776123
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.739 Vali Acc: 0.351 Test Loss: 1.739 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.290537118911743
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.808 Vali Acc: 0.270 Test Loss: 1.808 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.4876785278320312
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.819 Vali Acc: 0.284 Test Loss: 1.819 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.8894333839416504
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.824 Vali Acc: 0.311 Test Loss: 1.824 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.8927161693573
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.458 Vali Acc: 0.176 Test Loss: 1.458 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.549623489379883
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.448 Vali Acc: 0.230 Test Loss: 1.448 Test Acc: 0.230
Validation loss decreased (-0.175661 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 3.5782270431518555
Epoch: 3, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.421 Vali Acc: 0.257 Test Loss: 1.421 Test Acc: 0.257
Validation loss decreased (-0.229715 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 3.8461532592773438
Epoch: 4, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4849367141723633
Epoch: 5, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.347604990005493
Epoch: 6, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.399 Vali Acc: 0.284 Test Loss: 1.399 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 7 cost time: 3.5281789302825928
Epoch: 7, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.433 Vali Acc: 0.257 Test Loss: 1.433 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.366565704345703
Epoch: 8, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.406 Vali Acc: 0.297 Test Loss: 1.406 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 9 cost time: 3.5021824836730957
Epoch: 9, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.393 Vali Acc: 0.297 Test Loss: 1.393 Test Acc: 0.297
Validation loss decreased (-0.297283 --> -0.297283).  Saving model ...
Epoch: 10 cost time: 3.528499126434326
Epoch: 10, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.464 Vali Acc: 0.230 Test Loss: 1.464 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5021374225616455
Epoch: 11, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.401 Vali Acc: 0.338 Test Loss: 1.401 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 12 cost time: 3.3559114933013916
Epoch: 12, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.405 Vali Acc: 0.324 Test Loss: 1.405 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7081828117370605
Epoch: 13, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.414 Vali Acc: 0.351 Test Loss: 1.414 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351337).  Saving model ...
Epoch: 14 cost time: 3.717581272125244
Epoch: 14, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.444 Vali Acc: 0.270 Test Loss: 1.444 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.761150360107422
Epoch: 15, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.424 Vali Acc: 0.324 Test Loss: 1.424 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6446852684020996
Epoch: 16, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.446 Vali Acc: 0.284 Test Loss: 1.446 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.749969959259033
Epoch: 17, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.447 Vali Acc: 0.324 Test Loss: 1.447 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6187996864318848
Epoch: 18, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.466 Vali Acc: 0.324 Test Loss: 1.466 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6476492881774902
Epoch: 19, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.506 Vali Acc: 0.338 Test Loss: 1.506 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.6776950359344482
Epoch: 20, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.564 Vali Acc: 0.257 Test Loss: 1.564 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6380717754364014
Epoch: 21, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.588 Vali Acc: 0.243 Test Loss: 1.588 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.424396514892578
Epoch: 22, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.598 Vali Acc: 0.297 Test Loss: 1.598 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3749005794525146
Epoch: 23, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.643 Vali Acc: 0.297 Test Loss: 1.643 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.35135135135135137
model parameter : 119268
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 58, 72, 74, 76, 88, 97, 104, 108, 122, 126, 132, 133, 139, 148, 153, 162, 172, 178, 181, 183, 196, 199]
fourier enhanced block used!
modes=32, index=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 67, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 44, 45, 46, 52, 56, 61, 62, 64, 68, 69, 74, 75, 76, 80, 82, 86, 88, 92, 93, 97]
modes_kv=32, index_kv=[1, 20, 26, 28, 31, 32, 43, 45, 46, 52, 57, 60, 62, 70, 81, 91, 93, 111, 114, 126, 130, 134, 143, 145, 152, 164, 167, 169, 170, 171, 173, 177]
>>>>>>>start training : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.990416049957275
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.368 Vali Acc: 0.311 Test Loss: 1.368 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 3.441310167312622
Epoch: 2, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.338 Vali Acc: 0.378 Test Loss: 1.338 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 3.639272928237915
Epoch: 3, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.341 Vali Acc: 0.351 Test Loss: 1.341 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6524434089660645
Epoch: 4, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.354 Vali Acc: 0.351 Test Loss: 1.354 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7809112071990967
Epoch: 5, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.356 Vali Acc: 0.378 Test Loss: 1.356 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.884484052658081
Epoch: 6, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.319 Vali Acc: 0.378 Test Loss: 1.319 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 3.684739828109741
Epoch: 7, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.343 Vali Acc: 0.378 Test Loss: 1.343 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.922518014907837
Epoch: 8, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.369 Vali Acc: 0.378 Test Loss: 1.369 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.161855936050415
Epoch: 9, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 10 cost time: 4.080010652542114
Epoch: 10, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.368 Vali Acc: 0.365 Test Loss: 1.368 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6847307682037354
Epoch: 11, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.324 Vali Acc: 0.365 Test Loss: 1.324 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.74981951713562
Epoch: 12, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.330 Vali Acc: 0.392 Test Loss: 1.330 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5395727157592773
Epoch: 13, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.333 Vali Acc: 0.351 Test Loss: 1.333 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9377634525299072
Epoch: 14, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.348 Vali Acc: 0.324 Test Loss: 1.348 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.531959056854248
Epoch: 15, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.338 Vali Acc: 0.365 Test Loss: 1.338 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8183963298797607
Epoch: 16, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.335 Vali Acc: 0.405 Test Loss: 1.335 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.4585540294647217
Epoch: 17, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.341 Vali Acc: 0.338 Test Loss: 1.341 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.68080997467041
Epoch: 18, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.371 Vali Acc: 0.338 Test Loss: 1.371 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.862301826477051
Epoch: 19, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.377 Vali Acc: 0.365 Test Loss: 1.377 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_FEDformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.43243243243243246
model parameter : 119268
model size : 1.70MB
