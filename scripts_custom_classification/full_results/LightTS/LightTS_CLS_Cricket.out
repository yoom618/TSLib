Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6008398532867432
Epoch: 1, Steps: 7 | Train Loss: 2.590 Vali Loss: 2.313 Vali Acc: 0.125 Test Loss: 2.313 Test Acc: 0.125
Validation loss decreased (inf --> -0.124977).  Saving model ...
Epoch: 2 cost time: 0.3697991371154785
Epoch: 2, Steps: 7 | Train Loss: 1.992 Vali Loss: 1.549 Vali Acc: 0.750 Test Loss: 1.549 Test Acc: 0.750
Validation loss decreased (-0.124977 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.42920875549316406
Epoch: 3, Steps: 7 | Train Loss: 1.067 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
Validation loss decreased (-0.749985 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.3799622058868408
Epoch: 4, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.44663357734680176
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.40853190422058105
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.389 Vali Acc: 0.833 Test Loss: 0.389 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4491915702819824
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.401 Vali Acc: 0.847 Test Loss: 0.401 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4052717685699463
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.379 Vali Acc: 0.847 Test Loss: 0.379 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3806796073913574
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.39144444465637207
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.42484188079833984
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.41327977180480957
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.4002652168273926
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.48943638801574707
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4470248222351074
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.37993717193603516
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.44013476371765137
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4731731414794922
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.49101877212524414
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.43287181854248047
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.475658655166626
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.45508289337158203
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5306119918823242
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1851808
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs399_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4853665828704834
Epoch: 1, Steps: 7 | Train Loss: 2.511 Vali Loss: 2.259 Vali Acc: 0.347 Test Loss: 2.259 Test Acc: 0.347
Validation loss decreased (inf --> -0.347200).  Saving model ...
Epoch: 2 cost time: 0.39820337295532227
Epoch: 2, Steps: 7 | Train Loss: 1.949 Vali Loss: 1.518 Vali Acc: 0.764 Test Loss: 1.518 Test Acc: 0.764
Validation loss decreased (-0.347200 --> -0.763874).  Saving model ...
Epoch: 3 cost time: 0.44365787506103516
Epoch: 3, Steps: 7 | Train Loss: 1.028 Vali Loss: 0.871 Vali Acc: 0.875 Test Loss: 0.871 Test Acc: 0.875
Validation loss decreased (-0.763874 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.3788871765136719
Epoch: 4, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.514 Vali Acc: 0.903 Test Loss: 0.514 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 0.40241408348083496
Epoch: 5, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.399 Vali Acc: 0.847 Test Loss: 0.399 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4371471405029297
Epoch: 6, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.40263795852661133
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5011329650878906
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.49828100204467773
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4237353801727295
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4213399887084961
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.43936777114868164
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.46791791915893555
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.49599289894104004
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4922006130218506
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.381411075592041
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs399_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1799425
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7171854972839355
Epoch: 1, Steps: 7 | Train Loss: 2.521 Vali Loss: 2.305 Vali Acc: 0.236 Test Loss: 2.305 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.49179649353027344
Epoch: 2, Steps: 7 | Train Loss: 1.951 Vali Loss: 1.535 Vali Acc: 0.736 Test Loss: 1.535 Test Acc: 0.736
Validation loss decreased (-0.236088 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.46825742721557617
Epoch: 3, Steps: 7 | Train Loss: 1.034 Vali Loss: 0.884 Vali Acc: 0.875 Test Loss: 0.884 Test Acc: 0.875
Validation loss decreased (-0.736096 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.5652914047241211
Epoch: 4, Steps: 7 | Train Loss: 0.406 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.50421142578125
Epoch: 5, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.508220911026001
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6021134853363037
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4720287322998047
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5898466110229492
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5139832496643066
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.505422830581665
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.4732198715209961
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5248720645904541
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.5294735431671143
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.5068368911743164
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.6351981163024902
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6004774570465088
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.5592825412750244
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.6098048686981201
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.5500044822692871
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.492448091506958
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5884401798248291
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.5163888931274414
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.4878499507904053
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.467177152633667
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4579498767852783
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5611720085144043
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5268092155456543
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.5314624309539795
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.6003482341766357
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.5492513179779053
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.5390152931213379
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.5290403366088867
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.44509458541870117
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5563919544219971
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.5431458950042725
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5414857864379883
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.568958044052124
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4504246711730957
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.7286121845245361
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5049252510070801
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.47197628021240234
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.6794917583465576
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6076991558074951
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.5329835414886475
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.518441915512085
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.45400238037109375
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 48 cost time: 0.5087094306945801
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.49915194511413574
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.567814826965332
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.4844338893890381
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.5803618431091309
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.498399019241333
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6719441413879395
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 55 cost time: 0.556757926940918
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 56 cost time: 0.6677234172821045
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 0.5873777866363525
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 58 cost time: 0.5363278388977051
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6449651718139648
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.527672290802002
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 0.5757877826690674
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.508699893951416
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6214327812194824
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.6369814872741699
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 65 cost time: 0.5149586200714111
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 66 cost time: 0.6416094303131104
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 67 cost time: 0.6449010372161865
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 68 cost time: 0.5010082721710205
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 0.5955047607421875
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.5337438583374023
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.4947388172149658
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5983586311340332
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5280671119689941
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7159161567687988
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.49504828453063965
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 76 cost time: 0.6685791015625
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6408615112304688
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 78 cost time: 0.5520527362823486
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 79 cost time: 0.583392858505249
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 80 cost time: 0.61210036277771
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 81 cost time: 0.5351216793060303
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.5762226581573486
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 83 cost time: 0.533851146697998
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 84 cost time: 0.598783016204834
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.5860378742218018
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.5049605369567871
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.5826961994171143
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.5282585620880127
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.5025558471679688
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.5105717182159424
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.520819902420044
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.5252630710601807
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.6323115825653076
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 94 cost time: 0.5344982147216797
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.5777959823608398
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.6887271404266357
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.6535558700561523
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 98 cost time: 0.5603022575378418
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.6821377277374268
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.5947999954223633
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1777690
model size : 6.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7966926097869873
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.318 Vali Acc: 0.236 Test Loss: 2.318 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.6616160869598389
Epoch: 2, Steps: 7 | Train Loss: 1.941 Vali Loss: 1.570 Vali Acc: 0.708 Test Loss: 1.570 Test Acc: 0.708
Validation loss decreased (-0.236088 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.501701831817627
Epoch: 3, Steps: 7 | Train Loss: 1.051 Vali Loss: 0.917 Vali Acc: 0.847 Test Loss: 0.917 Test Acc: 0.847
Validation loss decreased (-0.708318 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.623319149017334
Epoch: 4, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.5383481979370117
Epoch: 5, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.6135115623474121
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.6135847568511963
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.7020409107208252
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.6401369571685791
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.699923038482666
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.6201794147491455
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.574580192565918
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.5957286357879639
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6984364986419678
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6268162727355957
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7723815441131592
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6521198749542236
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.6599783897399902
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.5954880714416504
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6773972511291504
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.5545709133148193
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5759282112121582
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5480210781097412
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.503626823425293
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5765094757080078
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5549814701080322
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.47016334533691406
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6065998077392578
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6703610420227051
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5490632057189941
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7252140045166016
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.677905797958374
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6373414993286133
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1762352
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9239082336425781
Epoch: 1, Steps: 7 | Train Loss: 2.657 Vali Loss: 2.428 Vali Acc: 0.056 Test Loss: 2.428 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.547318696975708
Epoch: 2, Steps: 7 | Train Loss: 2.076 Vali Loss: 1.676 Vali Acc: 0.639 Test Loss: 1.676 Test Acc: 0.639
Validation loss decreased (-0.055531 --> -0.638872).  Saving model ...
Epoch: 3 cost time: 0.595494270324707
Epoch: 3, Steps: 7 | Train Loss: 1.128 Vali Loss: 1.002 Vali Acc: 0.792 Test Loss: 1.002 Test Acc: 0.792
Validation loss decreased (-0.638872 --> -0.791657).  Saving model ...
Epoch: 4 cost time: 0.46309781074523926
Epoch: 4, Steps: 7 | Train Loss: 0.457 Vali Loss: 0.639 Vali Acc: 0.778 Test Loss: 0.639 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5392251014709473
Epoch: 5, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
Validation loss decreased (-0.791657 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 0.5520362854003906
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.46480512619018555
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.446 Vali Acc: 0.861 Test Loss: 0.446 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.5685133934020996
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.5762913227081299
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.6134922504425049
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.5102691650390625
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.6759295463562012
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.56553053855896
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5784957408905029
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6855185031890869
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5599124431610107
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6131410598754883
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5100984573364258
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5764923095703125
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7029275894165039
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5135619640350342
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 1752138
model size : 6.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9026105403900146
Epoch: 1, Steps: 7 | Train Loss: 2.461 Vali Loss: 2.253 Vali Acc: 0.306 Test Loss: 2.253 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 0.5562191009521484
Epoch: 2, Steps: 7 | Train Loss: 1.879 Vali Loss: 1.503 Vali Acc: 0.819 Test Loss: 1.503 Test Acc: 0.819
Validation loss decreased (-0.305533 --> -0.819429).  Saving model ...
Epoch: 3 cost time: 0.6129105091094971
Epoch: 3, Steps: 7 | Train Loss: 0.978 Vali Loss: 0.839 Vali Acc: 0.875 Test Loss: 0.839 Test Acc: 0.875
Validation loss decreased (-0.819429 --> -0.874992).  Saving model ...
Epoch: 4 cost time: 0.49735307693481445
Epoch: 4, Steps: 7 | Train Loss: 0.383 Vali Loss: 0.500 Vali Acc: 0.903 Test Loss: 0.500 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 0.6382837295532227
Epoch: 5, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.417 Vali Acc: 0.903 Test Loss: 0.417 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.5083634853363037
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.5683002471923828
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.528404712677002
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.5284063816070557
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.5685586929321289
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.540024995803833
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.5565762519836426
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5176944732666016
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6338422298431396
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.558173418045044
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5874419212341309
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5384230613708496
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6167447566986084
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6126246452331543
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4988384246826172
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5830142498016357
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5627298355102539
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.514047384262085
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1741153
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7549116611480713
Epoch: 1, Steps: 7 | Train Loss: 2.592 Vali Loss: 2.362 Vali Acc: 0.222 Test Loss: 2.362 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 0.5728001594543457
Epoch: 2, Steps: 7 | Train Loss: 1.983 Vali Loss: 1.557 Vali Acc: 0.708 Test Loss: 1.557 Test Acc: 0.708
Validation loss decreased (-0.222199 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.5884122848510742
Epoch: 3, Steps: 7 | Train Loss: 1.038 Vali Loss: 0.911 Vali Acc: 0.819 Test Loss: 0.911 Test Acc: 0.819
Validation loss decreased (-0.708318 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.5989980697631836
Epoch: 4, Steps: 7 | Train Loss: 0.407 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 0.5465981960296631
Epoch: 5, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 0.6028895378112793
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.406 Vali Acc: 0.861 Test Loss: 0.406 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.6981010437011719
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.6304562091827393
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6426165103912354
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7202703952789307
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5926947593688965
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6679246425628662
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6320576667785645
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6264290809631348
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6189141273498535
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.5259771347045898
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.650047779083252
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6087796688079834
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5557107925415039
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.698779821395874
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.710162878036499
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.5602948665618896
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6082487106323242
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.5949068069458008
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.5909285545349121
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.5709171295166016
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5477476119995117
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5885183811187744
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6136329174041748
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6306140422821045
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4885845184326172
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5816285610198975
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5266304016113281
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.5279312133789062
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.6029617786407471
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6902339458465576
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5840909481048584
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5240874290466309
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.6008179187774658
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.5008280277252197
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6415755748748779
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5974650382995605
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5265376567840576
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6883401870727539
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5421273708343506
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.594970703125
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.723585844039917
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.551217794418335
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5935530662536621
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.634807825088501
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6031975746154785
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5608391761779785
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.47874951362609863
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.49391961097717285
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.5603406429290771
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.6019022464752197
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6459429264068604
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5613620281219482
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.5521421432495117
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5600545406341553
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5311267375946045
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.7025399208068848
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.6325159072875977
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.641869068145752
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.6642603874206543
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7101006507873535
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5974593162536621
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.6221966743469238
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.5673809051513672
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.6479027271270752
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.7122273445129395
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.701296329498291
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.6392276287078857
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.7424707412719727
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.6824212074279785
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 76 cost time: 0.7007131576538086
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.665851354598999
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.6506199836730957
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.545586347579956
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.678058385848999
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.5871129035949707
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.5394370555877686
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.6989595890045166
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.5671336650848389
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.6310040950775146
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 86 cost time: 0.6368012428283691
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7087671756744385
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.5170905590057373
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.5615322589874268
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.6302571296691895
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.6016538143157959
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 92 cost time: 0.5687789916992188
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.5738396644592285
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.5818078517913818
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.553398847579956
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.6465473175048828
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 0.654205322265625
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 0.56787109375
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 0.7296631336212158
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 0.6504788398742676
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1739402
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7099874019622803
Epoch: 1, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.258 Vali Acc: 0.417 Test Loss: 2.258 Test Acc: 0.417
Validation loss decreased (inf --> -0.416644).  Saving model ...
Epoch: 2 cost time: 0.7080585956573486
Epoch: 2, Steps: 7 | Train Loss: 1.849 Vali Loss: 1.509 Vali Acc: 0.750 Test Loss: 1.509 Test Acc: 0.750
Validation loss decreased (-0.416644 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.5527060031890869
Epoch: 3, Steps: 7 | Train Loss: 0.988 Vali Loss: 0.869 Vali Acc: 0.847 Test Loss: 0.869 Test Acc: 0.847
Validation loss decreased (-0.749985 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 0.6600208282470703
Epoch: 4, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 0.5913629531860352
Epoch: 5, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.5686702728271484
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.538285493850708
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6571593284606934
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6554017066955566
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6476631164550781
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6409454345703125
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5643227100372314
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5787785053253174
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6357591152191162
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6012477874755859
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5514910221099854
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.6642229557037354
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.6004676818847656
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.5952835083007812
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.6096963882446289
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.6677470207214355
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6315863132476807
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.6000888347625732
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.6978168487548828
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5582969188690186
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.615527868270874
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.661036491394043
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.536431074142456
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5763475894927979
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.707564115524292
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6635546684265137
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7376537322998047
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.682807207107544
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.6170666217803955
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.6279397010803223
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6223185062408447
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7150332927703857
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6629371643066406
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.6612992286682129
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.6089200973510742
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6446130275726318
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.610865592956543
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5426573753356934
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6073510646820068
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5813007354736328
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5831761360168457
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5714662075042725
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.620725154876709
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4740273952484131
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1731497
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8339159488677979
Epoch: 1, Steps: 7 | Train Loss: 2.408 Vali Loss: 2.225 Vali Acc: 0.319 Test Loss: 2.225 Test Acc: 0.319
Validation loss decreased (inf --> -0.319422).  Saving model ...
Epoch: 2 cost time: 0.48204469680786133
Epoch: 2, Steps: 7 | Train Loss: 1.876 Vali Loss: 1.540 Vali Acc: 0.694 Test Loss: 1.540 Test Acc: 0.694
Validation loss decreased (-0.319422 --> -0.694429).  Saving model ...
Epoch: 3 cost time: 0.5437960624694824
Epoch: 3, Steps: 7 | Train Loss: 1.008 Vali Loss: 0.877 Vali Acc: 0.792 Test Loss: 0.877 Test Acc: 0.792
Validation loss decreased (-0.694429 --> -0.791658).  Saving model ...
Epoch: 4 cost time: 0.5538716316223145
Epoch: 4, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.791658 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.5811257362365723
Epoch: 5, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5205228328704834
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.6949079036712646
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.5587584972381592
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6877923011779785
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6172893047332764
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.6771256923675537
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.5968272686004639
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.5544915199279785
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.630728006362915
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6287891864776611
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5605158805847168
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5608313083648682
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6968145370483398
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.6790602207183838
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5733187198638916
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.5499234199523926
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7074627876281738
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6713223457336426
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5640482902526855
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6942789554595947
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.7569305896759033
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.7968857288360596
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6842353343963623
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7702164649963379
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7170772552490234
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.6175413131713867
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.7293243408203125
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.6617085933685303
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.642585277557373
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.5387229919433594
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.6948518753051758
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.663811206817627
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.6700930595397949
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6680104732513428
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6634304523468018
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6193752288818359
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.7112002372741699
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6706626415252686
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7035007476806641
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.6709282398223877
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.7068040370941162
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6954038143157959
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5728161334991455
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.6461570262908936
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.7580623626708984
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.7397112846374512
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7101376056671143
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7264630794525146
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.7317941188812256
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.6550693511962891
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7579813003540039
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.6773743629455566
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.6804018020629883
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.8829991817474365
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7131178379058838
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.8082294464111328
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.6857345104217529
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.6226093769073486
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.697777271270752
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7339468002319336
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5994842052459717
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.8136637210845947
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.8052482604980469
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.6583437919616699
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.7062714099884033
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.7438066005706787
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.6981849670410156
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.7526283264160156
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.5808484554290771
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.7523362636566162
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6218822002410889
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7291722297668457
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.6833450794219971
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7263367176055908
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.7008364200592041
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.6740126609802246
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.7812919616699219
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.6769185066223145
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.7123103141784668
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.7789685726165771
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.8118000030517578
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.6863751411437988
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.750190019607544
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.6793034076690674
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1731802
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7399652004241943
Epoch: 1, Steps: 7 | Train Loss: 2.522 Vali Loss: 2.326 Vali Acc: 0.208 Test Loss: 2.326 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.5627703666687012
Epoch: 2, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.520 Vali Acc: 0.708 Test Loss: 1.520 Test Acc: 0.708
Validation loss decreased (-0.208310 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.5106141567230225
Epoch: 3, Steps: 7 | Train Loss: 1.036 Vali Loss: 0.871 Vali Acc: 0.847 Test Loss: 0.871 Test Acc: 0.847
Validation loss decreased (-0.708318 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 0.5576663017272949
Epoch: 4, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.5501964092254639
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.430 Vali Acc: 0.847 Test Loss: 0.430 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5556032657623291
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 0.5033478736877441
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 0.49186038970947266
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 0.5616812705993652
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 0.6193058490753174
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.6129045486450195
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.4986002445220947
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.5279419422149658
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.6352345943450928
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.4894404411315918
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.5557479858398438
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.6368968486785889
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.5596873760223389
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.5469746589660645
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.622969388961792
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5789995193481445
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5773205757141113
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.509483814239502
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5329151153564453
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5181536674499512
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.5054707527160645
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5854654312133789
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6175754070281982
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.5073909759521484
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.5137314796447754
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5134522914886475
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6279206275939941
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.6599674224853516
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6077420711517334
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6749792098999023
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.5523145198822021
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.5720562934875488
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.6148653030395508
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.5217490196228027
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.5747313499450684
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6064746379852295
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4899280071258545
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.5979001522064209
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5823116302490234
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4818394184112549
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.43515944480895996
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4888031482696533
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.546720027923584
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.46558690071105957
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5319156646728516
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.577401876449585
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.5679419040679932
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.558884859085083
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.5335030555725098
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.538079023361206
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.6212503910064697
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.5477347373962402
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.5564661026000977
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6110939979553223
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5375022888183594
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.5220446586608887
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.5365352630615234
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.4760167598724365
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.4690535068511963
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5737295150756836
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6343059539794922
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5098240375518799
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.5054497718811035
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 0.5746181011199951
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.467268705368042
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.39101362228393555
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5319678783416748
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.7900710105895996
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 74 cost time: 0.56233811378479
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.5047945976257324
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 76 cost time: 0.5397958755493164
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 77 cost time: 0.5034630298614502
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.4543778896331787
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 79 cost time: 0.5266580581665039
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 80 cost time: 0.524728536605835
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 81 cost time: 0.4892294406890869
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.49446630477905273
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 83 cost time: 0.5464828014373779
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 84 cost time: 0.4411921501159668
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 85 cost time: 0.5673010349273682
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 86 cost time: 0.5365588665008545
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 87 cost time: 0.4965357780456543
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 88 cost time: 0.519803524017334
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 89 cost time: 0.6009666919708252
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 90 cost time: 0.47695422172546387
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 91 cost time: 0.5347485542297363
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 92 cost time: 0.5962533950805664
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 93 cost time: 0.44192934036254883
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 94 cost time: 0.5098111629486084
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 95 cost time: 0.5799694061279297
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 96 cost time: 0.4990365505218506
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 97 cost time: 0.5261476039886475
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 98 cost time: 0.4955601692199707
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 99 cost time: 0.4665851593017578
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 100 cost time: 0.47000980377197266
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1727835
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7348227500915527
Epoch: 1, Steps: 7 | Train Loss: 2.503 Vali Loss: 2.352 Vali Acc: 0.208 Test Loss: 2.352 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.6385347843170166
Epoch: 2, Steps: 7 | Train Loss: 1.943 Vali Loss: 1.587 Vali Acc: 0.708 Test Loss: 1.587 Test Acc: 0.708
Validation loss decreased (-0.208310 --> -0.708317).  Saving model ...
Epoch: 3 cost time: 0.4876558780670166
Epoch: 3, Steps: 7 | Train Loss: 1.038 Vali Loss: 0.912 Vali Acc: 0.861 Test Loss: 0.912 Test Acc: 0.861
Validation loss decreased (-0.708317 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.7233223915100098
Epoch: 4, Steps: 7 | Train Loss: 0.396 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.6547539234161377
Epoch: 5, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.53767991065979
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.630178689956665
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.6188950538635254
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5367424488067627
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6786844730377197
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5303759574890137
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5100607872009277
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6153297424316406
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6395585536956787
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.523651123046875
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6784589290618896
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6092264652252197
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.743549108505249
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6391470432281494
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7626805305480957
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5708520412445068
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6331572532653809
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6475670337677002
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5104279518127441
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1726778
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1011903285980225
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 2.242 Vali Acc: 0.333 Test Loss: 2.242 Test Acc: 0.333
Validation loss decreased (inf --> -0.333311).  Saving model ...
Epoch: 2 cost time: 0.6978681087493896
Epoch: 2, Steps: 7 | Train Loss: 1.852 Vali Loss: 1.516 Vali Acc: 0.764 Test Loss: 1.516 Test Acc: 0.764
Validation loss decreased (-0.333311 --> -0.763874).  Saving model ...
Epoch: 3 cost time: 0.5495960712432861
Epoch: 3, Steps: 7 | Train Loss: 0.960 Vali Loss: 0.889 Vali Acc: 0.833 Test Loss: 0.889 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.6493086814880371
Epoch: 4, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.5861866474151611
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.616281270980835
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5441408157348633
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.585193395614624
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.614861249923706
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.5761988162994385
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.5753486156463623
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.568199634552002
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.6014225482940674
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.4912393093109131
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.5550618171691895
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.5743491649627686
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.5114996433258057
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5486516952514648
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 19 cost time: 0.5244901180267334
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.48778343200683594
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4925856590270996
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.5780925750732422
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.5015764236450195
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.526561975479126
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5184690952301025
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.5175673961639404
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5462930202484131
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5148420333862305
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5695176124572754
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.5144040584564209
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.6103575229644775
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5249512195587158
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5652883052825928
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5621106624603271
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5932600498199463
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.500347375869751
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.5156548023223877
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5948202610015869
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6035561561584473
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.756206750869751
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6209776401519775
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.5155062675476074
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5128519535064697
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.594862699508667
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.571394681930542
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.628737211227417
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5254013538360596
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5749373435974121
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5455875396728516
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.5601239204406738
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.6241915225982666
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.4746823310852051
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5900416374206543
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.5499534606933594
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.5743527412414551
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.5772309303283691
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6626646518707275
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.5372419357299805
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.43520379066467285
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 0.5467190742492676
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6053504943847656
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.4889211654663086
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.5766558647155762
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 0.5708372592926025
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.5788335800170898
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5418832302093506
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.5001084804534912
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.5509746074676514
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.528090238571167
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.7048847675323486
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 0.5778188705444336
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5924336910247803
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7083456516265869
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 0.6517479419708252
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 0.4574921131134033
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6176016330718994
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 0.6468038558959961
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 0.6252129077911377
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 0.6419298648834229
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 0.6293578147888184
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5772323608398438
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.6769354343414307
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 0.5925307273864746
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 84 cost time: 0.5540788173675537
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.63201904296875
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.6626508235931396
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 87 cost time: 0.6262936592102051
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 88 cost time: 0.5303184986114502
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 89 cost time: 0.6948068141937256
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 90 cost time: 0.6463654041290283
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 91 cost time: 0.57920241355896
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 92 cost time: 0.5458393096923828
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.708277702331543
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 94 cost time: 0.6347732543945312
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 95 cost time: 0.5097229480743408
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 96 cost time: 0.5836961269378662
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 97 cost time: 0.6040859222412109
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.5358622074127197
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 99 cost time: 0.6214244365692139
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.5185146331787109
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1735813
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6447269916534424
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.312 Vali Acc: 0.292 Test Loss: 2.312 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 0.45426368713378906
Epoch: 2, Steps: 7 | Train Loss: 1.910 Vali Loss: 1.548 Vali Acc: 0.653 Test Loss: 1.548 Test Acc: 0.653
Validation loss decreased (-0.291644 --> -0.652762).  Saving model ...
Epoch: 3 cost time: 0.4716188907623291
Epoch: 3, Steps: 7 | Train Loss: 1.002 Vali Loss: 0.915 Vali Acc: 0.806 Test Loss: 0.915 Test Acc: 0.806
Validation loss decreased (-0.652762 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 0.6047704219818115
Epoch: 4, Steps: 7 | Train Loss: 0.397 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
Validation loss decreased (-0.805546 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 0.6619086265563965
Epoch: 5, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
Validation loss decreased (-0.819438 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.534477710723877
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.5641682147979736
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7096550464630127
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.847 Test Loss: 0.341 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5133039951324463
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.847 Test Loss: 0.321 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6666066646575928
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6263847351074219
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6653478145599365
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6563551425933838
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.6259512901306152
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7154231071472168
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7448892593383789
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6880733966827393
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.621840238571167
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5899181365966797
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6699612140655518
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5744295120239258
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5985124111175537
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5377531051635742
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5623159408569336
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5837087631225586
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.534820556640625
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1728094
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0394058227539062
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.403 Vali Acc: 0.139 Test Loss: 2.403 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.6741228103637695
Epoch: 2, Steps: 7 | Train Loss: 2.004 Vali Loss: 1.609 Vali Acc: 0.625 Test Loss: 1.609 Test Acc: 0.625
Validation loss decreased (-0.138865 --> -0.624984).  Saving model ...
Epoch: 3 cost time: 0.508542537689209
Epoch: 3, Steps: 7 | Train Loss: 1.083 Vali Loss: 0.945 Vali Acc: 0.778 Test Loss: 0.945 Test Acc: 0.778
Validation loss decreased (-0.624984 --> -0.777768).  Saving model ...
Epoch: 4 cost time: 0.5543458461761475
Epoch: 4, Steps: 7 | Train Loss: 0.433 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
Validation loss decreased (-0.777768 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 0.5644083023071289
Epoch: 5, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.426 Vali Acc: 0.847 Test Loss: 0.426 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 0.7445168495178223
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.395 Vali Acc: 0.847 Test Loss: 0.395 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.577747106552124
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 0.581596851348877
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.4757680892944336
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.6506435871124268
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7851603031158447
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6124918460845947
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8220579624176025
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6000123023986816
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5975852012634277
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7288703918457031
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5382909774780273
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.504096269607544
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.551400899887085
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.5194301605224609
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.513962984085083
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.6155941486358643
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.638716459274292
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6045205593109131
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.795335054397583
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.592829704284668
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5637228488922119
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7295641899108887
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7028875350952148
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6181745529174805
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.6427595615386963
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.5532395839691162
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5254051685333252
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5830461978912354
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.662459135055542
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6528313159942627
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.6062991619110107
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5500919818878174
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.5469489097595215
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.6075546741485596
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6180024147033691
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6804671287536621
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5940237045288086
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5343446731567383
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.6236968040466309
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6994271278381348
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6671428680419922
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.6191868782043457
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.5906000137329102
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6441493034362793
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.5858919620513916
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.5078954696655273
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.5896198749542236
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.5979609489440918
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.5719399452209473
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6089234352111816
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5204367637634277
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6139523983001709
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6245114803314209
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.5212926864624023
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.6814074516296387
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.5466158390045166
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.663567304611206
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6255207061767578
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6312170028686523
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.5217297077178955
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.6126127243041992
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6104974746704102
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5927891731262207
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.7698428630828857
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.6128520965576172
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6333603858947754
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6013975143432617
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5429246425628662
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.6576924324035645
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.5678341388702393
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.6599476337432861
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.5414097309112549
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.639855146408081
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.598893404006958
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1721832
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6301343441009521
Epoch: 1, Steps: 7 | Train Loss: 2.354 Vali Loss: 2.097 Vali Acc: 0.431 Test Loss: 2.097 Test Acc: 0.431
Validation loss decreased (inf --> -0.430535).  Saving model ...
Epoch: 2 cost time: 0.7734782695770264
Epoch: 2, Steps: 7 | Train Loss: 1.817 Vali Loss: 1.381 Vali Acc: 0.764 Test Loss: 1.381 Test Acc: 0.764
Validation loss decreased (-0.430535 --> -0.763875).  Saving model ...
Epoch: 3 cost time: 0.4575943946838379
Epoch: 3, Steps: 7 | Train Loss: 0.949 Vali Loss: 0.815 Vali Acc: 0.847 Test Loss: 0.815 Test Acc: 0.847
Validation loss decreased (-0.763875 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 0.5800938606262207
Epoch: 4, Steps: 7 | Train Loss: 0.369 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 0.6822848320007324
Epoch: 5, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4976465702056885
Epoch: 6, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.370 Vali Acc: 0.847 Test Loss: 0.370 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5785796642303467
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.363 Vali Acc: 0.847 Test Loss: 0.363 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6219046115875244
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.326 Vali Acc: 0.847 Test Loss: 0.326 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5364339351654053
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7933712005615234
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.5775918960571289
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5638844966888428
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5970408916473389
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5964846611022949
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5153789520263672
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.875 Test Loss: 0.272 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5830173492431641
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5073816776275635
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.6440441608428955
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.5036780834197998
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.5662312507629395
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.5297808647155762
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.8169636726379395
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6478002071380615
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.5531558990478516
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.6406176090240479
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.6841139793395996
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.609586238861084
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.699193000793457
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7420415878295898
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.5624129772186279
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.5831456184387207
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5970077514648438
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5388495922088623
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5514826774597168
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5511918067932129
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.647392988204956
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7161707878112793
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6182637214660645
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5751843452453613
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6320571899414062
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1720618
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8637917041778564
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.358 Vali Acc: 0.222 Test Loss: 2.358 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 0.5530421733856201
Epoch: 2, Steps: 7 | Train Loss: 1.983 Vali Loss: 1.572 Vali Acc: 0.722 Test Loss: 1.572 Test Acc: 0.722
Validation loss decreased (-0.222199 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.6812858581542969
Epoch: 3, Steps: 7 | Train Loss: 1.065 Vali Loss: 0.942 Vali Acc: 0.819 Test Loss: 0.942 Test Acc: 0.819
Validation loss decreased (-0.722207 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.588836669921875
Epoch: 4, Steps: 7 | Train Loss: 0.456 Vali Loss: 0.639 Vali Acc: 0.847 Test Loss: 0.639 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 0.5187733173370361
Epoch: 5, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.469 Vali Acc: 0.861 Test Loss: 0.469 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.5820226669311523
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.4804999828338623
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4677391052246094
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.5997269153594971
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.5442507266998291
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.5965120792388916
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6412787437438965
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6044831275939941
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5798423290252686
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7978851795196533
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7050831317901611
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5523512363433838
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.6074721813201904
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5506832599639893
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5835607051849365
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.743664026260376
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7087604999542236
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6214284896850586
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.6702070236206055
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.6832089424133301
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.5649378299713135
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7056167125701904
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.5964188575744629
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.5689241886138916
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.521857738494873
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.5325131416320801
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.7499575614929199
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5317783355712891
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7119174003601074
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6477251052856445
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6722404956817627
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.5577688217163086
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.7054791450500488
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7062299251556396
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6652569770812988
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6145267486572266
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9163250923156738
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.6449687480926514
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.759415864944458
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6528050899505615
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7574777603149414
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.68788743019104
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6516067981719971
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.6348772048950195
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7938365936279297
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6187057495117188
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7053778171539307
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8236827850341797
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7526335716247559
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.7408134937286377
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7869279384613037
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7811460494995117
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.7824997901916504
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1728043
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7579951286315918
Epoch: 1, Steps: 7 | Train Loss: 2.493 Vali Loss: 2.294 Vali Acc: 0.236 Test Loss: 2.294 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.5525693893432617
Epoch: 2, Steps: 7 | Train Loss: 1.917 Vali Loss: 1.552 Vali Acc: 0.722 Test Loss: 1.552 Test Acc: 0.722
Validation loss decreased (-0.236088 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.5350227355957031
Epoch: 3, Steps: 7 | Train Loss: 1.047 Vali Loss: 0.889 Vali Acc: 0.833 Test Loss: 0.889 Test Acc: 0.833
Validation loss decreased (-0.722207 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.5102486610412598
Epoch: 4, Steps: 7 | Train Loss: 0.412 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.5151467323303223
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.425 Vali Acc: 0.847 Test Loss: 0.425 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6205153465270996
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.390 Vali Acc: 0.847 Test Loss: 0.390 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.44666552543640137
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.6407761573791504
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.6284210681915283
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.847 Test Loss: 0.326 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6097471714019775
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6604385375976562
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.5761585235595703
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.603506326675415
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.7191295623779297
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.5884318351745605
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.5324532985687256
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.6935200691223145
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5426232814788818
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5755925178527832
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6060616970062256
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.6212258338928223
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.5335276126861572
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5855185985565186
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5561010837554932
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.583026647567749
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5668001174926758
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.631105899810791
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6054520606994629
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.5834755897521973
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.6341991424560547
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.724872350692749
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.5573530197143555
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6560349464416504
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.6101157665252686
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6087050437927246
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.6554853916168213
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.4817218780517578
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5435616970062256
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5031812191009521
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.673865795135498
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5663959980010986
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5516092777252197
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5783472061157227
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6162986755371094
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.5037977695465088
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.5678527355194092
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.5897767543792725
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.5661535263061523
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.545109748840332
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.5181877613067627
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6169416904449463
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5438392162322998
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5729069709777832
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5093538761138916
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5431983470916748
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.6122965812683105
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 57 cost time: 0.5395388603210449
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.5889739990234375
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5888328552246094
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6419458389282227
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.5776863098144531
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.588756799697876
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.570681095123291
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5799846649169922
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.5728025436401367
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.5627567768096924
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6182260513305664
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5742518901824951
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6219193935394287
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5822558403015137
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7098972797393799
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.7119410037994385
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5746428966522217
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.6375100612640381
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.5661983489990234
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6494026184082031
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.5699591636657715
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.6277265548706055
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.5841262340545654
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 80 cost time: 0.570908784866333
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 81 cost time: 0.5092267990112305
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.5629091262817383
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.6147422790527344
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.4996187686920166
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7493689060211182
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.7106106281280518
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.6620321273803711
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.5287985801696777
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.5628247261047363
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.5982005596160889
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1725896
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8264069557189941
Epoch: 1, Steps: 7 | Train Loss: 2.420 Vali Loss: 2.217 Vali Acc: 0.347 Test Loss: 2.217 Test Acc: 0.347
Validation loss decreased (inf --> -0.347200).  Saving model ...
Epoch: 2 cost time: 0.47138261795043945
Epoch: 2, Steps: 7 | Train Loss: 1.841 Vali Loss: 1.482 Vali Acc: 0.750 Test Loss: 1.482 Test Acc: 0.750
Validation loss decreased (-0.347200 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.5594933032989502
Epoch: 3, Steps: 7 | Train Loss: 0.972 Vali Loss: 0.818 Vali Acc: 0.861 Test Loss: 0.818 Test Acc: 0.861
Validation loss decreased (-0.749985 --> -0.861103).  Saving model ...
Epoch: 4 cost time: 0.5768373012542725
Epoch: 4, Steps: 7 | Train Loss: 0.368 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 0.5786375999450684
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.553311824798584
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.378 Vali Acc: 0.847 Test Loss: 0.378 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6899914741516113
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5719671249389648
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6438720226287842
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.5778777599334717
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6560919284820557
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5897908210754395
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5469763278961182
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5165176391601562
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5053825378417969
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5504693984985352
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5558929443359375
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.560413122177124
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6961662769317627
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4964437484741211
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1714177
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.759880781173706
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.339 Vali Acc: 0.208 Test Loss: 2.339 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.6242015361785889
Epoch: 2, Steps: 7 | Train Loss: 2.007 Vali Loss: 1.554 Vali Acc: 0.736 Test Loss: 1.554 Test Acc: 0.736
Validation loss decreased (-0.208310 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.5410263538360596
Epoch: 3, Steps: 7 | Train Loss: 1.094 Vali Loss: 0.907 Vali Acc: 0.819 Test Loss: 0.907 Test Acc: 0.819
Validation loss decreased (-0.736096 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.4960918426513672
Epoch: 4, Steps: 7 | Train Loss: 0.460 Vali Loss: 0.554 Vali Acc: 0.889 Test Loss: 0.554 Test Acc: 0.889
Validation loss decreased (-0.819435 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 0.5794084072113037
Epoch: 5, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.421 Vali Acc: 0.861 Test Loss: 0.421 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.556166410446167
Epoch: 6, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.5428133010864258
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.5153708457946777
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.5500259399414062
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5197780132293701
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5461623668670654
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5777857303619385
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4899153709411621
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.48580145835876465
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5247676372528076
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5386862754821777
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4704110622406006
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5063388347625732
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1717082
model size : 6.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0434508323669434
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.307 Vali Acc: 0.319 Test Loss: 2.307 Test Acc: 0.319
Validation loss decreased (inf --> -0.319421).  Saving model ...
Epoch: 2 cost time: 0.7380414009094238
Epoch: 2, Steps: 7 | Train Loss: 1.890 Vali Loss: 1.525 Vali Acc: 0.750 Test Loss: 1.525 Test Acc: 0.750
Validation loss decreased (-0.319421 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.6087405681610107
Epoch: 3, Steps: 7 | Train Loss: 0.994 Vali Loss: 0.893 Vali Acc: 0.861 Test Loss: 0.893 Test Acc: 0.861
Validation loss decreased (-0.749985 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.6677963733673096
Epoch: 4, Steps: 7 | Train Loss: 0.401 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.6001551151275635
Epoch: 5, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.449 Vali Acc: 0.847 Test Loss: 0.449 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5619328022003174
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.6197545528411865
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.5740318298339844
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4906175136566162
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.6796848773956299
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5854842662811279
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5943713188171387
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6697261333465576
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5712287425994873
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6022439002990723
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.5612368583679199
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5948214530944824
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5846631526947021
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5303912162780762
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6129755973815918
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.509894609451294
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5457000732421875
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5867691040039062
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6705918312072754
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6335515975952148
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm512_cs57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1712809
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9813077449798584
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.318 Vali Acc: 0.194 Test Loss: 2.318 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.6024477481842041
Epoch: 2, Steps: 7 | Train Loss: 1.922 Vali Loss: 1.594 Vali Acc: 0.722 Test Loss: 1.594 Test Acc: 0.722
Validation loss decreased (-0.194421 --> -0.722206).  Saving model ...
Epoch: 3 cost time: 0.7087514400482178
Epoch: 3, Steps: 7 | Train Loss: 1.014 Vali Loss: 0.906 Vali Acc: 0.833 Test Loss: 0.906 Test Acc: 0.833
Validation loss decreased (-0.722206 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.5576071739196777
Epoch: 4, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.574 Vali Acc: 0.875 Test Loss: 0.574 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.5505263805389404
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.6104731559753418
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5697262287139893
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5972564220428467
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5047130584716797
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.65860915184021
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.891075611114502
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.7811837196350098
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.7156128883361816
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.5745654106140137
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6065883636474609
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6459352970123291
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5633132457733154
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6943643093109131
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6068389415740967
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5264918804168701
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7897579669952393
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6688921451568604
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6797728538513184
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1662656
model size : 6.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs399_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9105682373046875
Epoch: 1, Steps: 7 | Train Loss: 2.480 Vali Loss: 2.323 Vali Acc: 0.292 Test Loss: 2.323 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 0.5952200889587402
Epoch: 2, Steps: 7 | Train Loss: 1.926 Vali Loss: 1.547 Vali Acc: 0.722 Test Loss: 1.547 Test Acc: 0.722
Validation loss decreased (-0.291643 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.6515991687774658
Epoch: 3, Steps: 7 | Train Loss: 1.008 Vali Loss: 0.892 Vali Acc: 0.819 Test Loss: 0.892 Test Acc: 0.819
Validation loss decreased (-0.722207 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 0.632784366607666
Epoch: 4, Steps: 7 | Train Loss: 0.386 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.5553793907165527
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7124300003051758
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.386 Vali Acc: 0.847 Test Loss: 0.386 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6856145858764648
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.5619182586669922
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.5444128513336182
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.574044942855835
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.7005138397216797
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.5402159690856934
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.6344649791717529
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.6361434459686279
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.6188111305236816
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.6591966152191162
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6161699295043945
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6170554161071777
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5678386688232422
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6634032726287842
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.5397565364837646
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.582249641418457
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.6580276489257812
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7007448673248291
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.6079287528991699
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.6292963027954102
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.6236534118652344
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.5777647495269775
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4276463985443115
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5141651630401611
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.52414870262146
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.5322673320770264
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.6608397960662842
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.52213454246521
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6166872978210449
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6664283275604248
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.5701522827148438
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6637213230133057
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.6257662773132324
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.5847578048706055
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7673909664154053
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6544268131256104
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.599299430847168
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.6824395656585693
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.528313159942627
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6455142498016357
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.52237868309021
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5801961421966553
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6534044742584229
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6796133518218994
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6494565010070801
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5614922046661377
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.5198962688446045
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 54 cost time: 0.5381691455841064
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6547729969024658
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6779336929321289
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.629706621170044
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.7271907329559326
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.579779863357544
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 60 cost time: 0.6313204765319824
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5524721145629883
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5284459590911865
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5967519283294678
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.5341753959655762
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.699669599533081
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.634925365447998
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 67 cost time: 0.4862093925476074
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5676040649414062
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5315713882446289
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6883935928344727
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5901384353637695
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5731382369995117
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.6266143321990967
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.6748275756835938
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 75 cost time: 0.667966365814209
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 76 cost time: 0.6296970844268799
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.5884850025177002
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.6152787208557129
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.5138700008392334
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.5972182750701904
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.538975715637207
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.5386989116668701
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.5271925926208496
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.5785481929779053
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.5039446353912354
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs399_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1635873
model size : 6.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8751590251922607
Epoch: 1, Steps: 7 | Train Loss: 2.503 Vali Loss: 2.240 Vali Acc: 0.222 Test Loss: 2.240 Test Acc: 0.222
Validation loss decreased (inf --> -0.222200).  Saving model ...
Epoch: 2 cost time: 0.7142832279205322
Epoch: 2, Steps: 7 | Train Loss: 1.956 Vali Loss: 1.497 Vali Acc: 0.736 Test Loss: 1.497 Test Acc: 0.736
Validation loss decreased (-0.222200 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.5189347267150879
Epoch: 3, Steps: 7 | Train Loss: 1.042 Vali Loss: 0.902 Vali Acc: 0.875 Test Loss: 0.902 Test Acc: 0.875
Validation loss decreased (-0.736096 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.6078252792358398
Epoch: 4, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.515 Vali Acc: 0.917 Test Loss: 0.515 Test Acc: 0.917
Validation loss decreased (-0.874991 --> -0.916662).  Saving model ...
Epoch: 5 cost time: 0.590153694152832
Epoch: 5, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.6578464508056641
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.6220550537109375
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5993943214416504
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.5434927940368652
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5538849830627441
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5687849521636963
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6138548851013184
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6529150009155273
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5681374073028564
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5643126964569092
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5949511528015137
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4908130168914795
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.614534854888916
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1626810
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8277218341827393
Epoch: 1, Steps: 7 | Train Loss: 2.484 Vali Loss: 2.279 Vali Acc: 0.250 Test Loss: 2.279 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 0.4873664379119873
Epoch: 2, Steps: 7 | Train Loss: 1.911 Vali Loss: 1.502 Vali Acc: 0.708 Test Loss: 1.502 Test Acc: 0.708
Validation loss decreased (-0.249977 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.5441060066223145
Epoch: 3, Steps: 7 | Train Loss: 1.010 Vali Loss: 0.855 Vali Acc: 0.861 Test Loss: 0.855 Test Acc: 0.861
Validation loss decreased (-0.708318 --> -0.861103).  Saving model ...
Epoch: 4 cost time: 0.5691101551055908
Epoch: 4, Steps: 7 | Train Loss: 0.372 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6827335357666016
Epoch: 5, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5769550800323486
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.345 Vali Acc: 0.847 Test Loss: 0.345 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6334998607635498
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.6300373077392578
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.5964491367340088
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.6076240539550781
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7687196731567383
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6349287033081055
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.683884859085083
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.861 Test Loss: 0.275 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6929061412811279
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.696782112121582
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6286947727203369
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6142151355743408
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.861 Test Loss: 0.261 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.629263162612915
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.563478946685791
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 1619152
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7283775806427002
Epoch: 1, Steps: 7 | Train Loss: 2.433 Vali Loss: 2.277 Vali Acc: 0.319 Test Loss: 2.277 Test Acc: 0.319
Validation loss decreased (inf --> -0.319422).  Saving model ...
Epoch: 2 cost time: 0.4907238483428955
Epoch: 2, Steps: 7 | Train Loss: 1.844 Vali Loss: 1.516 Vali Acc: 0.708 Test Loss: 1.516 Test Acc: 0.708
Validation loss decreased (-0.319422 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.5989558696746826
Epoch: 3, Steps: 7 | Train Loss: 0.982 Vali Loss: 0.918 Vali Acc: 0.819 Test Loss: 0.918 Test Acc: 0.819
Validation loss decreased (-0.708318 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.5125856399536133
Epoch: 4, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.598 Vali Acc: 0.847 Test Loss: 0.598 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 0.628171443939209
Epoch: 5, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.6551070213317871
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.425 Vali Acc: 0.847 Test Loss: 0.425 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5342316627502441
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.5987582206726074
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5840494632720947
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7341775894165039
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.7341194152832031
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5454485416412354
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6136431694030762
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6047770977020264
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5599668025970459
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5968878269195557
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.582101583480835
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6127827167510986
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5792627334594727
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6679117679595947
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5394916534423828
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6301195621490479
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1614058
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9254612922668457
Epoch: 1, Steps: 7 | Train Loss: 2.357 Vali Loss: 2.173 Vali Acc: 0.375 Test Loss: 2.173 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 0.603886604309082
Epoch: 2, Steps: 7 | Train Loss: 1.792 Vali Loss: 1.428 Vali Acc: 0.819 Test Loss: 1.428 Test Acc: 0.819
Validation loss decreased (-0.374978 --> -0.819430).  Saving model ...
Epoch: 3 cost time: 0.6471483707427979
Epoch: 3, Steps: 7 | Train Loss: 0.940 Vali Loss: 0.827 Vali Acc: 0.847 Test Loss: 0.827 Test Acc: 0.847
Validation loss decreased (-0.819430 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 0.5624563694000244
Epoch: 4, Steps: 7 | Train Loss: 0.384 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.7162129878997803
Epoch: 5, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
Validation loss decreased (-0.861106 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.5004374980926514
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5484530925750732
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.47362399101257324
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.5790655612945557
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6213717460632324
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5723135471343994
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.5699107646942139
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5315849781036377
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6495015621185303
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.5510578155517578
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.5542223453521729
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.5389041900634766
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.524843692779541
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.5608077049255371
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.6997270584106445
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6270246505737305
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6142914295196533
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5489692687988281
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.5835065841674805
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5360004901885986
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5249662399291992
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6987557411193848
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6714951992034912
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5463054180145264
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7130131721496582
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7300946712493896
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.49496889114379883
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.5428047180175781
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6014175415039062
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.5100293159484863
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.5635056495666504
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5690209865570068
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5934543609619141
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6285784244537354
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5306508541107178
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.6104130744934082
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6929655075073242
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5057494640350342
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5578808784484863
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5332040786743164
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5813314914703369
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7217121124267578
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.5676882266998291
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.6342868804931641
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5203816890716553
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6051733493804932
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.598332405090332
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.5529050827026367
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4527614116668701
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7839946746826172
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.550926685333252
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5495905876159668
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6203460693359375
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5446157455444336
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6054284572601318
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5143451690673828
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.5602836608886719
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1606785
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.903566837310791
Epoch: 1, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.186 Vali Acc: 0.458 Test Loss: 2.186 Test Acc: 0.458
Validation loss decreased (inf --> -0.458311).  Saving model ...
Epoch: 2 cost time: 0.5998246669769287
Epoch: 2, Steps: 7 | Train Loss: 1.888 Vali Loss: 1.459 Vali Acc: 0.750 Test Loss: 1.459 Test Acc: 0.750
Validation loss decreased (-0.458311 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.558659553527832
Epoch: 3, Steps: 7 | Train Loss: 1.010 Vali Loss: 0.847 Vali Acc: 0.861 Test Loss: 0.847 Test Acc: 0.861
Validation loss decreased (-0.749985 --> -0.861103).  Saving model ...
Epoch: 4 cost time: 0.6840972900390625
Epoch: 4, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.472078800201416
Epoch: 5, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.5116465091705322
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 7 cost time: 0.575080156326294
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.553952693939209
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5642569065093994
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.5226955413818359
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.5269026756286621
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.875 Test Loss: 0.271 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.4998817443847656
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.875 Test Loss: 0.267 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.6105747222900391
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.875 Test Loss: 0.266 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.5395481586456299
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.5612964630126953
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5812995433807373
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6599459648132324
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.5923514366149902
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.590491533279419
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.576566219329834
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.5924391746520996
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5373778343200684
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4558849334716797
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6365771293640137
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.570850133895874
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.5447797775268555
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5492844581604004
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.5401854515075684
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.5713350772857666
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6714920997619629
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.5368852615356445
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.5753660202026367
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5387313365936279
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6174612045288086
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6640303134918213
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6148481369018555
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.5137336254119873
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5706808567047119
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.49979305267333984
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5277323722839355
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5947856903076172
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.6513192653656006
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.5578999519348145
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.5691640377044678
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.6321911811828613
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5242209434509277
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5602560043334961
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.637049674987793
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.597130537033081
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.5543422698974609
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 0.6241202354431152
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 0.580106258392334
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5600931644439697
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6465408802032471
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6844265460968018
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5559887886047363
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.6465904712677002
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5925865173339844
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.6345789432525635
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.6207566261291504
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 0.579552412033081
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6510369777679443
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.6144313812255859
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6246979236602783
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5918395519256592
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.6307187080383301
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5088045597076416
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.5028975009918213
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.47852134704589844
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.525399923324585
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5642151832580566
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 0.5950391292572021
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 0.5499975681304932
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 0.6034812927246094
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 0.5370984077453613
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7181286811828613
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.5993063449859619
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.5670168399810791
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.7357094287872314
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.6761734485626221
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.6474273204803467
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.5819242000579834
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.6376194953918457
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.6146755218505859
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1607722
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.874018669128418
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.294 Vali Acc: 0.194 Test Loss: 2.294 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 0.7151939868927002
Epoch: 2, Steps: 7 | Train Loss: 1.991 Vali Loss: 1.541 Vali Acc: 0.764 Test Loss: 1.541 Test Acc: 0.764
Validation loss decreased (-0.194422 --> -0.763873).  Saving model ...
Epoch: 3 cost time: 0.9074478149414062
Epoch: 3, Steps: 7 | Train Loss: 1.074 Vali Loss: 0.908 Vali Acc: 0.792 Test Loss: 0.908 Test Acc: 0.792
Validation loss decreased (-0.763873 --> -0.791658).  Saving model ...
Epoch: 4 cost time: 0.5990307331085205
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.592 Vali Acc: 0.889 Test Loss: 0.592 Test Acc: 0.889
Validation loss decreased (-0.791658 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 0.6754939556121826
Epoch: 5, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.5890183448791504
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.396 Vali Acc: 0.847 Test Loss: 0.396 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5978047847747803
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.364 Vali Acc: 0.847 Test Loss: 0.364 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6085996627807617
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5695030689239502
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.52066969871521
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6828346252441406
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5854854583740234
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5244095325469971
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.652271032333374
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6503734588623047
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5481431484222412
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5414395332336426
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.588554859161377
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.528287410736084
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6101934909820557
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5885450839996338
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.581005334854126
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.58477783203125
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5635521411895752
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5850706100463867
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7312350273132324
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6936991214752197
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.536428689956665
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6318161487579346
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5459680557250977
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.6380615234375
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5672850608825684
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.5298490524291992
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5939798355102539
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.572314977645874
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.6806430816650391
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.6049816608428955
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6623389720916748
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.653684139251709
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5684769153594971
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5374758243560791
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.681220293045044
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5309984683990479
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5419235229492188
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.525503396987915
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.4929184913635254
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6313769817352295
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6473278999328613
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.522406816482544
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 0.654719352722168
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6310420036315918
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.6591010093688965
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.5794274806976318
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7579467296600342
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 55 cost time: 0.5691063404083252
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5558512210845947
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5754120349884033
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 58 cost time: 0.5332634449005127
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6209883689880371
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 60 cost time: 0.5112414360046387
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7411634922027588
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 62 cost time: 0.6102118492126465
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 63 cost time: 0.5617647171020508
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6292901039123535
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 65 cost time: 0.6342473030090332
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 66 cost time: 0.6772665977478027
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5823290348052979
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5710322856903076
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5790627002716064
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5538926124572754
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6098506450653076
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.6206362247467041
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.555579423904419
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.5902965068817139
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.6399178504943848
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1601993
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.785888433456421
Epoch: 1, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.276 Vali Acc: 0.181 Test Loss: 2.276 Test Acc: 0.181
Validation loss decreased (inf --> -0.180533).  Saving model ...
Epoch: 2 cost time: 0.5817797183990479
Epoch: 2, Steps: 7 | Train Loss: 1.947 Vali Loss: 1.548 Vali Acc: 0.736 Test Loss: 1.548 Test Acc: 0.736
Validation loss decreased (-0.180533 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.5296008586883545
Epoch: 3, Steps: 7 | Train Loss: 1.037 Vali Loss: 0.918 Vali Acc: 0.819 Test Loss: 0.918 Test Acc: 0.819
Validation loss decreased (-0.736096 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.49984312057495117
Epoch: 4, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.7768526077270508
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.419 Vali Acc: 0.819 Test Loss: 0.419 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7164545059204102
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.369 Vali Acc: 0.861 Test Loss: 0.369 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.5932114124298096
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5985486507415771
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.847 Test Loss: 0.335 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5520229339599609
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.332 Vali Acc: 0.847 Test Loss: 0.332 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6141445636749268
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 0.5696554183959961
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5883355140686035
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6541566848754883
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.49272656440734863
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.7008199691772461
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5914278030395508
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5938940048217773
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.6092040538787842
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.5636279582977295
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.6000406742095947
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.7404305934906006
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.7458298206329346
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.6676051616668701
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.5840232372283936
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5318417549133301
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7289450168609619
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.6227257251739502
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.654179573059082
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.6082494258880615
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.7695200443267822
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5995748043060303
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.677405595779419
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.6083390712738037
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7170829772949219
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5973756313323975
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5349202156066895
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.5855147838592529
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6204812526702881
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.6297297477722168
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.5120186805725098
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.720529317855835
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6838624477386475
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.8058359622955322
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.5870745182037354
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.7007427215576172
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6981010437011719
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6538028717041016
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7145705223083496
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5128624439239502
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 0.5950801372528076
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.6494741439819336
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.7150344848632812
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.6231212615966797
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 54 cost time: 0.6063811779022217
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.538135290145874
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6311960220336914
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6162765026092529
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.46364593505859375
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5972719192504883
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5315062999725342
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 0.5582938194274902
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 62 cost time: 0.7793116569519043
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5723211765289307
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 64 cost time: 0.6329154968261719
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.546738862991333
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.4736790657043457
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6133246421813965
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5207574367523193
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.5711550712585449
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.5906224250793457
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 71 cost time: 0.5873162746429443
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 72 cost time: 0.45653772354125977
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.5008699893951416
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5203914642333984
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.5524692535400391
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.5539300441741943
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.6549575328826904
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5315401554107666
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.5741872787475586
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.5958755016326904
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.5930092334747314
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 82 cost time: 0.5321974754333496
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 83 cost time: 0.5300073623657227
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7523353099822998
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.5904815196990967
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.5961160659790039
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 87 cost time: 0.614513635635376
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.6446340084075928
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.6560325622558594
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.6183347702026367
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.6407206058502197
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 92 cost time: 0.5259175300598145
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 93 cost time: 0.5853381156921387
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 94 cost time: 0.4533100128173828
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.5546724796295166
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5351252555847168
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.45221757888793945
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.5737791061401367
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.6203594207763672
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 100 cost time: 0.48916006088256836
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1603962
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.089993715286255
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.250 Vali Acc: 0.194 Test Loss: 2.250 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 0.5382263660430908
Epoch: 2, Steps: 7 | Train Loss: 1.870 Vali Loss: 1.513 Vali Acc: 0.750 Test Loss: 1.513 Test Acc: 0.750
Validation loss decreased (-0.194422 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.5381109714508057
Epoch: 3, Steps: 7 | Train Loss: 1.015 Vali Loss: 0.870 Vali Acc: 0.875 Test Loss: 0.870 Test Acc: 0.875
Validation loss decreased (-0.749985 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.55039381980896
Epoch: 4, Steps: 7 | Train Loss: 0.409 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5396163463592529
Epoch: 5, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6016013622283936
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.5788726806640625
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.5853545665740967
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.545405387878418
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.5337607860565186
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.49236416816711426
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.5449831485748291
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6027166843414307
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.558908224105835
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.561985969543457
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.861 Test Loss: 0.282 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5167253017425537
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5627045631408691
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.580773115158081
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6277360916137695
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.586998701095581
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.5657808780670166
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6122937202453613
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5718443393707275
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.875 Test Loss: 0.272 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 24 cost time: 0.5402727127075195
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.875 Test Loss: 0.271 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 0.5864403247833252
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.875 Test Loss: 0.270 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.6239199638366699
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.5429580211639404
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.6206893920898438
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.557103157043457
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.519892692565918
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6394252777099609
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.5691883563995361
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5357449054718018
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.5448524951934814
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5758805274963379
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.47572827339172363
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5441668033599854
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5844368934631348
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5380935668945312
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.6393098831176758
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.549363374710083
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.5993568897247314
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5822103023529053
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6068041324615479
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5834743976593018
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6190996170043945
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6424016952514648
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.4967806339263916
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.6133301258087158
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.744312047958374
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5803728103637695
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6691839694976807
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7024085521697998
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5404200553894043
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.6294264793395996
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7949724197387695
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.6591598987579346
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.6392292976379395
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6712346076965332
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7232067584991455
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6542701721191406
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5549616813659668
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.60697340965271
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.6440305709838867
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.5988650321960449
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.5775926113128662
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6196451187133789
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6358869075775146
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5445330142974854
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5582425594329834
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6199719905853271
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.7104825973510742
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5896015167236328
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.6846516132354736
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.7422945499420166
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1601403
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8028688430786133
Epoch: 1, Steps: 7 | Train Loss: 2.455 Vali Loss: 2.226 Vali Acc: 0.250 Test Loss: 2.226 Test Acc: 0.250
Validation loss decreased (inf --> -0.249978).  Saving model ...
Epoch: 2 cost time: 0.5147953033447266
Epoch: 2, Steps: 7 | Train Loss: 1.876 Vali Loss: 1.465 Vali Acc: 0.722 Test Loss: 1.465 Test Acc: 0.722
Validation loss decreased (-0.249978 --> -0.722208).  Saving model ...
Epoch: 3 cost time: 0.8147869110107422
Epoch: 3, Steps: 7 | Train Loss: 0.980 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
Validation loss decreased (-0.722208 --> -0.833325).  Saving model ...
Epoch: 4 cost time: 0.593820333480835
Epoch: 4, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 0.6175639629364014
Epoch: 5, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 0.6302981376647949
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.6023585796356201
Epoch: 7, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.5053842067718506
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.336 Vali Acc: 0.847 Test Loss: 0.336 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6001405715942383
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7048294544219971
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.847 Test Loss: 0.318 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5358729362487793
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.6491670608520508
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.5802783966064453
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6484105587005615
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6321053504943848
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5816230773925781
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6050012111663818
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6146078109741211
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6233189105987549
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7510082721710205
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.756354570388794
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6861400604248047
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 1601498
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8618106842041016
Epoch: 1, Steps: 7 | Train Loss: 2.441 Vali Loss: 2.243 Vali Acc: 0.347 Test Loss: 2.243 Test Acc: 0.347
Validation loss decreased (inf --> -0.347200).  Saving model ...
Epoch: 2 cost time: 0.5566043853759766
Epoch: 2, Steps: 7 | Train Loss: 1.915 Vali Loss: 1.545 Vali Acc: 0.750 Test Loss: 1.545 Test Acc: 0.750
Validation loss decreased (-0.347200 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.7377705574035645
Epoch: 3, Steps: 7 | Train Loss: 1.035 Vali Loss: 0.897 Vali Acc: 0.847 Test Loss: 0.897 Test Acc: 0.847
Validation loss decreased (-0.749985 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.5813853740692139
Epoch: 4, Steps: 7 | Train Loss: 0.412 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5198533535003662
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 0.5620450973510742
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.5345237255096436
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.5476536750793457
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.45917248725891113
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.4930708408355713
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.525615930557251
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4700934886932373
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.847 Test Loss: 0.310 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5540714263916016
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5615534782409668
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5872316360473633
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.512622594833374
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5123374462127686
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6055190563201904
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5685422420501709
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1611429
model size : 6.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6447837352752686
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.233 Vali Acc: 0.333 Test Loss: 2.233 Test Acc: 0.333
Validation loss decreased (inf --> -0.333311).  Saving model ...
Epoch: 2 cost time: 0.6550753116607666
Epoch: 2, Steps: 7 | Train Loss: 1.965 Vali Loss: 1.477 Vali Acc: 0.847 Test Loss: 1.477 Test Acc: 0.847
Validation loss decreased (-0.333311 --> -0.847207).  Saving model ...
Epoch: 3 cost time: 0.5615904331207275
Epoch: 3, Steps: 7 | Train Loss: 1.054 Vali Loss: 0.871 Vali Acc: 0.875 Test Loss: 0.871 Test Acc: 0.875
Validation loss decreased (-0.847207 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.5376102924346924
Epoch: 4, Steps: 7 | Train Loss: 0.411 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.5770151615142822
Epoch: 5, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.4887430667877197
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.6230635643005371
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.5304679870605469
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.5130276679992676
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.47665977478027344
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.4952237606048584
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5281908512115479
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.5824484825134277
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.5567727088928223
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6133453845977783
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6213955879211426
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5614850521087646
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6367650032043457
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5852422714233398
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6382195949554443
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5891964435577393
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4854393005371094
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4971747398376465
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.5752930641174316
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.5178287029266357
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5843408107757568
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.451430082321167
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5608775615692139
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.4982600212097168
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.513206958770752
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5392944812774658
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5405077934265137
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4874293804168701
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.5182521343231201
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.5576903820037842
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.6071267127990723
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5213491916656494
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6368260383605957
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5579442977905273
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5248591899871826
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.5302951335906982
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.5186865329742432
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5441927909851074
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7699904441833496
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5767524242401123
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5460836887359619
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5025746822357178
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.6487090587615967
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6417667865753174
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.50335693359375
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6305310726165771
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5005679130554199
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5493624210357666
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.42546701431274414
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.6635143756866455
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6461131572723389
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.4721512794494629
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6811184883117676
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5349276065826416
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.4759211540222168
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.5121173858642578
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.5662970542907715
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.5791621208190918
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5532641410827637
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1604606
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.736142873764038
Epoch: 1, Steps: 7 | Train Loss: 2.533 Vali Loss: 2.358 Vali Acc: 0.236 Test Loss: 2.358 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.5426731109619141
Epoch: 2, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.569 Vali Acc: 0.708 Test Loss: 1.569 Test Acc: 0.708
Validation loss decreased (-0.236088 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.4762582778930664
Epoch: 3, Steps: 7 | Train Loss: 1.040 Vali Loss: 0.905 Vali Acc: 0.819 Test Loss: 0.905 Test Acc: 0.819
Validation loss decreased (-0.708318 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.6334526538848877
Epoch: 4, Steps: 7 | Train Loss: 0.401 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
Validation loss decreased (-0.819435 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.6035284996032715
Epoch: 5, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.585003137588501
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6638209819793701
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5576095581054688
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5910329818725586
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.5371980667114258
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.5852706432342529
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.5452094078063965
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.6176841259002686
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.595909595489502
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.6501643657684326
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5095505714416504
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6476030349731445
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5145227909088135
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6565549373626709
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.5001697540283203
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.6247937679290771
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.5597922801971436
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6666653156280518
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7050955295562744
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6923568248748779
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7122828960418701
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5509154796600342
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5423598289489746
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.534613847732544
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5600471496582031
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.5545759201049805
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.5636177062988281
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.610609769821167
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5827710628509521
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6410336494445801
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5652492046356201
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.5776212215423584
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5883481502532959
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.8061511516571045
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6529505252838135
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.7560422420501709
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.6416764259338379
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.6670076847076416
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7710955142974854
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5977628231048584
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.653264045715332
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6924467086791992
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.6669692993164062
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8376295566558838
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.7549688816070557
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6677956581115723
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6221404075622559
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.60636305809021
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.6624720096588135
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7711591720581055
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8820769786834717
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6357386112213135
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.7793939113616943
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.715080976486206
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.7485558986663818
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.708439826965332
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.8225295543670654
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7463364601135254
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.6810739040374756
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6138243675231934
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8134644031524658
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.706418514251709
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.7151751518249512
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 0.8648066520690918
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7796444892883301
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8781223297119141
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7245213985443115
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6913173198699951
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.6983718872070312
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.8368120193481445
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.7370190620422363
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.6942896842956543
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.8024029731750488
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1599112
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8464558124542236
Epoch: 1, Steps: 7 | Train Loss: 2.384 Vali Loss: 2.224 Vali Acc: 0.306 Test Loss: 2.224 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 0.5243978500366211
Epoch: 2, Steps: 7 | Train Loss: 1.831 Vali Loss: 1.519 Vali Acc: 0.750 Test Loss: 1.519 Test Acc: 0.750
Validation loss decreased (-0.305533 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.4699685573577881
Epoch: 3, Steps: 7 | Train Loss: 0.973 Vali Loss: 0.882 Vali Acc: 0.847 Test Loss: 0.882 Test Acc: 0.847
Validation loss decreased (-0.749985 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.523693323135376
Epoch: 4, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4911973476409912
Epoch: 5, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.5340619087219238
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.6366329193115234
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.347 Vali Acc: 0.847 Test Loss: 0.347 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6345498561859131
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.847 Test Loss: 0.298 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6056976318359375
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.5917375087738037
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.6075694561004639
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5942535400390625
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5796973705291748
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.5440618991851807
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6848840713500977
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5161051750183105
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5734906196594238
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6054689884185791
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6408519744873047
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5520703792572021
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5874061584472656
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6069095134735107
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6187717914581299
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1598538
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9693105220794678
Epoch: 1, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.285 Vali Acc: 0.319 Test Loss: 2.285 Test Acc: 0.319
Validation loss decreased (inf --> -0.319422).  Saving model ...
Epoch: 2 cost time: 0.7611656188964844
Epoch: 2, Steps: 7 | Train Loss: 1.883 Vali Loss: 1.546 Vali Acc: 0.722 Test Loss: 1.546 Test Acc: 0.722
Validation loss decreased (-0.319422 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.5821390151977539
Epoch: 3, Steps: 7 | Train Loss: 1.004 Vali Loss: 0.868 Vali Acc: 0.833 Test Loss: 0.868 Test Acc: 0.833
Validation loss decreased (-0.722207 --> -0.833325).  Saving model ...
Epoch: 4 cost time: 0.6649105548858643
Epoch: 4, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.561 Vali Acc: 0.847 Test Loss: 0.561 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 0.4525294303894043
Epoch: 5, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.642737865447998
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 0.7650876045227051
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6397299766540527
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7132186889648438
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.336 Vali Acc: 0.861 Test Loss: 0.336 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 0.6009492874145508
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.5881361961364746
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5923295021057129
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.49577832221984863
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.5945961475372314
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.6442975997924805
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.5383002758026123
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5470826625823975
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.5354166030883789
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.5488021373748779
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6526753902435303
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6988799571990967
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5379290580749512
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.5935611724853516
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6137418746948242
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5799562931060791
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5956900119781494
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5908088684082031
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5433666706085205
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5241079330444336
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.5271480083465576
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5988888740539551
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.5821826457977295
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5236353874206543
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.5884253978729248
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5794370174407959
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6087014675140381
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.588637113571167
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5225510597229004
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.5300414562225342
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.5827147960662842
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6215729713439941
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6067583560943604
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5890357494354248
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.6517696380615234
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5212728977203369
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6094763278961182
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7052524089813232
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6323323249816895
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7672603130340576
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6653652191162109
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5775792598724365
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6846702098846436
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5711288452148438
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1606475
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6554780006408691
Epoch: 1, Steps: 7 | Train Loss: 2.531 Vali Loss: 2.332 Vali Acc: 0.083 Test Loss: 2.332 Test Acc: 0.083
Validation loss decreased (inf --> -0.083310).  Saving model ...
Epoch: 2 cost time: 0.5457212924957275
Epoch: 2, Steps: 7 | Train Loss: 1.937 Vali Loss: 1.585 Vali Acc: 0.653 Test Loss: 1.585 Test Acc: 0.653
Validation loss decreased (-0.083310 --> -0.652762).  Saving model ...
Epoch: 3 cost time: 0.5200297832489014
Epoch: 3, Steps: 7 | Train Loss: 1.053 Vali Loss: 0.936 Vali Acc: 0.792 Test Loss: 0.936 Test Acc: 0.792
Validation loss decreased (-0.652762 --> -0.791657).  Saving model ...
Epoch: 4 cost time: 0.5156826972961426
Epoch: 4, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.571 Vali Acc: 0.847 Test Loss: 0.571 Test Acc: 0.847
Validation loss decreased (-0.791657 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 0.5215108394622803
Epoch: 5, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5082471370697021
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.395 Vali Acc: 0.847 Test Loss: 0.395 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.6390314102172852
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6461782455444336
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.356 Vali Acc: 0.847 Test Loss: 0.356 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847219).  Saving model ...
Epoch: 9 cost time: 0.6105606555938721
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.847 Test Loss: 0.348 Test Acc: 0.847
Validation loss decreased (-0.847219 --> -0.847219).  Saving model ...
Epoch: 10 cost time: 0.5124907493591309
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
Validation loss decreased (-0.847219 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 0.5242321491241455
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 0.5017735958099365
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.4969189167022705
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.5166094303131104
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5992178916931152
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.6978914737701416
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5762600898742676
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 0.5257642269134521
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6375672817230225
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.665590763092041
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.597466230392456
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.6743817329406738
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.6285281181335449
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 24 cost time: 0.5206036567687988
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 0.6377332210540771
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.6133298873901367
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 0.6246044635772705
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6480851173400879
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 29 cost time: 0.5988538265228271
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.49976491928100586
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6254656314849854
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5922038555145264
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.588982105255127
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 34 cost time: 0.6360411643981934
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 35 cost time: 0.6274926662445068
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 36 cost time: 0.7189288139343262
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 37 cost time: 0.6649024486541748
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.5650207996368408
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5735251903533936
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.48746752738952637
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 41 cost time: 0.502204179763794
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 42 cost time: 0.5432872772216797
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5864675045013428
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 44 cost time: 0.48436546325683594
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 45 cost time: 0.5254039764404297
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 46 cost time: 0.5237348079681396
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 47 cost time: 0.47887611389160156
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 48 cost time: 0.5063290596008301
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5240077972412109
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5951862335205078
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 51 cost time: 0.6347448825836182
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 52 cost time: 0.6004009246826172
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.5831444263458252
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5438601970672607
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5721888542175293
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7694962024688721
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 0.623744010925293
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 58 cost time: 0.5810403823852539
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 59 cost time: 0.5624096393585205
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5744080543518066
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5899114608764648
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.6118597984313965
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 63 cost time: 0.6033766269683838
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5432846546173096
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 65 cost time: 0.6564335823059082
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5839624404907227
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5310389995574951
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 68 cost time: 0.5369021892547607
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.601902961730957
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5255672931671143
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 71 cost time: 0.6946201324462891
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.48523950576782227
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5028707981109619
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 74 cost time: 0.570176362991333
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7611432075500488
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6128044128417969
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 77 cost time: 0.6370432376861572
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 78 cost time: 0.6461834907531738
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.5446438789367676
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.5141074657440186
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.7351183891296387
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.8152837753295898
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.5391855239868164
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.5635037422180176
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.6350679397583008
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.6104974746704102
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.6730477809906006
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1604840
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8992807865142822
Epoch: 1, Steps: 7 | Train Loss: 2.471 Vali Loss: 2.294 Vali Acc: 0.236 Test Loss: 2.294 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.5737874507904053
Epoch: 2, Steps: 7 | Train Loss: 1.902 Vali Loss: 1.534 Vali Acc: 0.778 Test Loss: 1.534 Test Acc: 0.778
Validation loss decreased (-0.236088 --> -0.777762).  Saving model ...
Epoch: 3 cost time: 0.7018928527832031
Epoch: 3, Steps: 7 | Train Loss: 1.015 Vali Loss: 0.894 Vali Acc: 0.875 Test Loss: 0.894 Test Acc: 0.875
Validation loss decreased (-0.777762 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.5007455348968506
Epoch: 4, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 0.5898447036743164
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.6039056777954102
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7151284217834473
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6461989879608154
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5892972946166992
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5867156982421875
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4871554374694824
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5219156742095947
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5500874519348145
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.5042095184326172
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6808514595031738
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5699102878570557
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5818328857421875
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7557451725006104
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.7434654235839844
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.5952663421630859
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.9776678085327148
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6702880859375
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.6384916305541992
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6517593860626221
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5520033836364746
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6845743656158447
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.6458091735839844
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7525856494903564
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.7934861183166504
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.7835187911987305
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.6398377418518066
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.8756453990936279
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7538552284240723
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7774360179901123
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7917582988739014
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6665759086608887
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.7437546253204346
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7762911319732666
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.6977865695953369
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.8527383804321289
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6959402561187744
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8811652660369873
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6590268611907959
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.63340163230896
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.7639181613922119
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.7123939990997314
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.6152174472808838
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7051548957824707
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.686427116394043
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 0.5795929431915283
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.8502435684204102
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.6915688514709473
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.7972698211669922
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8216879367828369
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 55 cost time: 0.6722757816314697
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.7503829002380371
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6722521781921387
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6804084777832031
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6993699073791504
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.676872730255127
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.7193431854248047
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.6541907787322998
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6480741500854492
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7885167598724365
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6560704708099365
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.5987710952758789
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.6757063865661621
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.6950616836547852
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.7534477710723877
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.6243886947631836
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.8049495220184326
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1593633
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8959908485412598
Epoch: 1, Steps: 7 | Train Loss: 2.479 Vali Loss: 2.246 Vali Acc: 0.389 Test Loss: 2.246 Test Acc: 0.389
Validation loss decreased (inf --> -0.388866).  Saving model ...
Epoch: 2 cost time: 0.5154283046722412
Epoch: 2, Steps: 7 | Train Loss: 1.939 Vali Loss: 1.503 Vali Acc: 0.722 Test Loss: 1.503 Test Acc: 0.722
Validation loss decreased (-0.388866 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.6338882446289062
Epoch: 3, Steps: 7 | Train Loss: 1.028 Vali Loss: 0.897 Vali Acc: 0.819 Test Loss: 0.897 Test Acc: 0.819
Validation loss decreased (-0.722207 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.5359702110290527
Epoch: 4, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.819435 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 0.6082127094268799
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.6231646537780762
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5773966312408447
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4913361072540283
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.325 Vali Acc: 0.847 Test Loss: 0.325 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.652073860168457
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.7287259101867676
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5201547145843506
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6655290126800537
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6946597099304199
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5675227642059326
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6846885681152344
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7232489585876465
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6003551483154297
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.691215991973877
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7214236259460449
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1596922
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8127837181091309
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.326 Vali Acc: 0.236 Test Loss: 2.326 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.5462532043457031
Epoch: 2, Steps: 7 | Train Loss: 1.995 Vali Loss: 1.547 Vali Acc: 0.681 Test Loss: 1.547 Test Acc: 0.681
Validation loss decreased (-0.236088 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.5645277500152588
Epoch: 3, Steps: 7 | Train Loss: 1.037 Vali Loss: 0.918 Vali Acc: 0.833 Test Loss: 0.918 Test Acc: 0.833
Validation loss decreased (-0.680540 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.5627412796020508
Epoch: 4, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.5656085014343262
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5449297428131104
Epoch: 6, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 0.5430803298950195
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.49843454360961914
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4990246295928955
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.590355634689331
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.5860600471496582
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.5652387142181396
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.6269824504852295
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6364595890045166
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.539038896560669
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.6937007904052734
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.6295773983001709
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5859577655792236
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.5376479625701904
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.6739423274993896
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.4903678894042969
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.6789922714233398
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.5706679821014404
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.47457027435302734
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.4800093173980713
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.5182886123657227
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.5154414176940918
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5228769779205322
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5665900707244873
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.5060789585113525
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.5887210369110107
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.5607461929321289
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.5620937347412109
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.597923994064331
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5905904769897461
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.6344969272613525
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.5962214469909668
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5868265628814697
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6062161922454834
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.5992636680603027
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 0.6244208812713623
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5990040302276611
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6289536952972412
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.5902550220489502
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.5693068504333496
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5994799137115479
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6043100357055664
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5955266952514648
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.4622373580932617
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5385785102844238
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.4977757930755615
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.5317332744598389
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 0.5486047267913818
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 54 cost time: 0.5662846565246582
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5877130031585693
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.545710563659668
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6370441913604736
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5956034660339355
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 59 cost time: 0.5784547328948975
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6211996078491211
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6800925731658936
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5616731643676758
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6629858016967773
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.6762533187866211
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 65 cost time: 0.5571994781494141
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.622626543045044
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6585903167724609
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 68 cost time: 0.5935273170471191
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 69 cost time: 0.6616747379302979
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 70 cost time: 0.5645723342895508
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 71 cost time: 0.5360214710235596
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5956418514251709
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6391727924346924
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5980808734893799
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.6022300720214844
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 76 cost time: 0.5587365627288818
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 77 cost time: 0.572284460067749
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.5973291397094727
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.603884220123291
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.6436455249786377
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5648183822631836
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.5816936492919922
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.5993521213531494
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.4975917339324951
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.5025653839111328
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.5604977607727051
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm256_cs57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1593033
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.854543924331665
Epoch: 1, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.266 Vali Acc: 0.306 Test Loss: 2.266 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 0.6187925338745117
Epoch: 2, Steps: 7 | Train Loss: 1.898 Vali Loss: 1.542 Vali Acc: 0.681 Test Loss: 1.542 Test Acc: 0.681
Validation loss decreased (-0.305533 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.5757932662963867
Epoch: 3, Steps: 7 | Train Loss: 1.002 Vali Loss: 0.900 Vali Acc: 0.792 Test Loss: 0.900 Test Acc: 0.792
Validation loss decreased (-0.680540 --> -0.791658).  Saving model ...
Epoch: 4 cost time: 0.5815885066986084
Epoch: 4, Steps: 7 | Train Loss: 0.408 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.791658 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.48096537590026855
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.5766892433166504
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.6519312858581543
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.572089433670044
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5361227989196777
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5921750068664551
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5719799995422363
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.570061206817627
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.505425214767456
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5557675361633301
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5537416934967041
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6543781757354736
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5118012428283691
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.6084940433502197
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.597069501876831
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.585660457611084
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6007819175720215
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.6092991828918457
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5851006507873535
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6919586658477783
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.5401155948638916
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5725293159484863
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5383329391479492
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.520505428314209
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.6113669872283936
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6083314418792725
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.5129895210266113
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5737950801849365
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5827751159667969
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.5856401920318604
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.5481188297271729
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6135733127593994
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5762226581573486
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6781501770019531
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5527031421661377
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.5935039520263672
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.640261173248291
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5916564464569092
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.5602209568023682
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.590289831161499
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.5838601589202881
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6025874614715576
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6216230392456055
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.5857465267181396
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.5483579635620117
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6887564659118652
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5865750312805176
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7224478721618652
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.6397068500518799
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.6510889530181885
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.5866029262542725
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6542904376983643
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.6508345603942871
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.6014468669891357
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.46966123580932617
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5579802989959717
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5756053924560547
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5028119087219238
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6671502590179443
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5663506984710693
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.5396342277526855
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.6139781475067139
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5498261451721191
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.642625093460083
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1586512
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs399_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9296293258666992
Epoch: 1, Steps: 7 | Train Loss: 2.394 Vali Loss: 2.164 Vali Acc: 0.403 Test Loss: 2.164 Test Acc: 0.403
Validation loss decreased (inf --> -0.402756).  Saving model ...
Epoch: 2 cost time: 0.6288197040557861
Epoch: 2, Steps: 7 | Train Loss: 1.846 Vali Loss: 1.431 Vali Acc: 0.806 Test Loss: 1.431 Test Acc: 0.806
Validation loss decreased (-0.402756 --> -0.805541).  Saving model ...
Epoch: 3 cost time: 0.5988583564758301
Epoch: 3, Steps: 7 | Train Loss: 0.982 Vali Loss: 0.803 Vali Acc: 0.875 Test Loss: 0.803 Test Acc: 0.875
Validation loss decreased (-0.805541 --> -0.874992).  Saving model ...
Epoch: 4 cost time: 0.6292176246643066
Epoch: 4, Steps: 7 | Train Loss: 0.380 Vali Loss: 0.535 Vali Acc: 0.903 Test Loss: 0.535 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 0.615572452545166
Epoch: 5, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6159336566925049
Epoch: 6, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.46984386444091797
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5544271469116211
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.328 Vali Acc: 0.847 Test Loss: 0.328 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5514190196990967
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4431774616241455
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.43920183181762695
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48426365852355957
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4999983310699463
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5608539581298828
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6056885719299316
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.552168607711792
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5773131847381592
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6626644134521484
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6409709453582764
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.517852783203125
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs399_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1572529
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7603545188903809
Epoch: 1, Steps: 7 | Train Loss: 2.382 Vali Loss: 2.237 Vali Acc: 0.417 Test Loss: 2.237 Test Acc: 0.417
Validation loss decreased (inf --> -0.416644).  Saving model ...
Epoch: 2 cost time: 0.5810933113098145
Epoch: 2, Steps: 7 | Train Loss: 1.843 Vali Loss: 1.503 Vali Acc: 0.764 Test Loss: 1.503 Test Acc: 0.764
Validation loss decreased (-0.416644 --> -0.763874).  Saving model ...
Epoch: 3 cost time: 0.5546252727508545
Epoch: 3, Steps: 7 | Train Loss: 0.972 Vali Loss: 0.869 Vali Acc: 0.847 Test Loss: 0.869 Test Acc: 0.847
Validation loss decreased (-0.763874 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 0.6562612056732178
Epoch: 4, Steps: 7 | Train Loss: 0.387 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 0.703317403793335
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.6103217601776123
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.47359657287597656
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.374 Vali Acc: 0.847 Test Loss: 0.374 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5707108974456787
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 0.4952359199523926
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 0.6048052310943604
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.5568385124206543
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5107676982879639
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.621406078338623
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6928737163543701
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5999212265014648
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6075954437255859
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.504246711730957
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5744004249572754
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5064597129821777
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6595704555511475
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1569802
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7910890579223633
Epoch: 1, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.323 Vali Acc: 0.208 Test Loss: 2.323 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.4600369930267334
Epoch: 2, Steps: 7 | Train Loss: 1.915 Vali Loss: 1.556 Vali Acc: 0.736 Test Loss: 1.556 Test Acc: 0.736
Validation loss decreased (-0.208310 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.6312336921691895
Epoch: 3, Steps: 7 | Train Loss: 1.002 Vali Loss: 0.885 Vali Acc: 0.861 Test Loss: 0.885 Test Acc: 0.861
Validation loss decreased (-0.736096 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.5252373218536377
Epoch: 4, Steps: 7 | Train Loss: 0.380 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4940779209136963
Epoch: 5, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.569451093673706
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.5199940204620361
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.47429656982421875
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.351 Vali Acc: 0.847 Test Loss: 0.351 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.500908613204956
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.334 Vali Acc: 0.847 Test Loss: 0.334 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.572047233581543
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5440242290496826
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.5136990547180176
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.593303918838501
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.5361201763153076
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.6073892116546631
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.5785784721374512
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.588759183883667
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 0.4665853977203369
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 19 cost time: 0.49811863899230957
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.6205282211303711
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.5669786930084229
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.48526573181152344
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5490760803222656
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.577124834060669
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5437514781951904
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.5255587100982666
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5731606483459473
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5308535099029541
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.5337743759155273
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7029011249542236
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.4733865261077881
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5393502712249756
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5632038116455078
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5630171298980713
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.5369594097137451
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.5822494029998779
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5415017604827881
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5109663009643555
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.6958210468292236
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5507664680480957
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6037869453430176
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6805784702301025
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.5788917541503906
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4759666919708252
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6073226928710938
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6217505931854248
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.5672531127929688
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.6356642246246338
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.625138521194458
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.6091392040252686
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6367034912109375
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.6125800609588623
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5217597484588623
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.6531081199645996
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6710140705108643
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.6322071552276611
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5899198055267334
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.570023775100708
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5988421440124512
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5334396362304688
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.6062099933624268
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.616410493850708
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5530385971069336
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.535588264465332
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.5615885257720947
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6271600723266602
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.6577208042144775
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.6123015880584717
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.483325719833374
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 0.5535707473754883
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.6222836971282959
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6797220706939697
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5064277648925781
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5473790168762207
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.5300471782684326
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.5329067707061768
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.6044261455535889
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.5559203624725342
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.530930757522583
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.6382870674133301
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1565984
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7661242485046387
Epoch: 1, Steps: 7 | Train Loss: 2.479 Vali Loss: 2.284 Vali Acc: 0.264 Test Loss: 2.284 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.6024918556213379
Epoch: 2, Steps: 7 | Train Loss: 1.935 Vali Loss: 1.510 Vali Acc: 0.694 Test Loss: 1.510 Test Acc: 0.694
Validation loss decreased (-0.263866 --> -0.694429).  Saving model ...
Epoch: 3 cost time: 0.5689890384674072
Epoch: 3, Steps: 7 | Train Loss: 1.047 Vali Loss: 0.888 Vali Acc: 0.833 Test Loss: 0.888 Test Acc: 0.833
Validation loss decreased (-0.694429 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.6218767166137695
Epoch: 4, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.5653231143951416
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6251893043518066
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.6298656463623047
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.6484513282775879
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.6141119003295898
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.5532104969024658
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.70908522605896
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.6005449295043945
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5262022018432617
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6014444828033447
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6023240089416504
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5312325954437256
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6275806427001953
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5422027111053467
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6292481422424316
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6779439449310303
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.6075530052185059
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6903529167175293
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.7210409641265869
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.5917651653289795
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.7623918056488037
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.6728091239929199
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.6239175796508789
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.5541715621948242
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6277520656585693
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.6396808624267578
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6709158420562744
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5841901302337646
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6303119659423828
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6550543308258057
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.621675968170166
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5434174537658691
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5379135608673096
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6554954051971436
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5378165245056152
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1563450
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6523265838623047
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.293 Vali Acc: 0.208 Test Loss: 2.293 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.5877695083618164
Epoch: 2, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.515 Vali Acc: 0.819 Test Loss: 1.515 Test Acc: 0.819
Validation loss decreased (-0.208310 --> -0.819429).  Saving model ...
Epoch: 3 cost time: 0.5681447982788086
Epoch: 3, Steps: 7 | Train Loss: 1.029 Vali Loss: 0.868 Vali Acc: 0.889 Test Loss: 0.868 Test Acc: 0.889
Validation loss decreased (-0.819429 --> -0.888880).  Saving model ...
Epoch: 4 cost time: 0.5220017433166504
Epoch: 4, Steps: 7 | Train Loss: 0.419 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.63736891746521
Epoch: 5, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5457475185394287
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5160655975341797
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.325 Vali Acc: 0.847 Test Loss: 0.325 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6051590442657471
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.560896635055542
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.594912052154541
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.6033544540405273
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5989587306976318
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5827045440673828
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6184237003326416
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.49079275131225586
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5364711284637451
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5274991989135742
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.5310981273651123
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.5986332893371582
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.5295207500457764
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5813789367675781
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5798838138580322
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.584162712097168
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6117415428161621
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5403397083282471
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.5185244083404541
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.5959639549255371
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.5348291397094727
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.4848942756652832
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6166660785675049
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.5094296932220459
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5970022678375244
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5578186511993408
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.46273207664489746
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5093543529510498
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.5516223907470703
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5446205139160156
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5706322193145752
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.614680290222168
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5471758842468262
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.597710132598877
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.5333669185638428
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5334985256195068
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.4634878635406494
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4725065231323242
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.9021351337432861
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.4727809429168701
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6504032611846924
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.6246809959411621
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.6348810195922852
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6369421482086182
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5877957344055176
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5751962661743164
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5976667404174805
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5369131565093994
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.6390523910522461
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5539164543151855
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.6090738773345947
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.5327341556549072
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1558033
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7361395359039307
Epoch: 1, Steps: 7 | Train Loss: 2.371 Vali Loss: 2.229 Vali Acc: 0.375 Test Loss: 2.229 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 0.6313726902008057
Epoch: 2, Steps: 7 | Train Loss: 1.840 Vali Loss: 1.494 Vali Acc: 0.750 Test Loss: 1.494 Test Acc: 0.750
Validation loss decreased (-0.374978 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.6383175849914551
Epoch: 3, Steps: 7 | Train Loss: 0.967 Vali Loss: 0.831 Vali Acc: 0.875 Test Loss: 0.831 Test Acc: 0.875
Validation loss decreased (-0.749985 --> -0.874992).  Saving model ...
Epoch: 4 cost time: 0.5900418758392334
Epoch: 4, Steps: 7 | Train Loss: 0.372 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5717723369598389
Epoch: 5, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.532942533493042
Epoch: 6, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5349719524383545
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.627957820892334
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.5890624523162842
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.5890712738037109
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.5159015655517578
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5281209945678711
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6750614643096924
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.5610578060150146
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.565131425857544
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5953965187072754
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.6796927452087402
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.5924422740936279
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.6820371150970459
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.6533553600311279
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.5451309680938721
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6549668312072754
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.5360524654388428
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6365251541137695
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.6325914859771729
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.6381268501281738
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6150839328765869
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5961086750030518
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.5166282653808594
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.6339535713195801
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.5263350009918213
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.5522949695587158
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.6256399154663086
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6798272132873535
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7357058525085449
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.58349609375
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.5738630294799805
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.5753512382507324
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6592364311218262
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.5296075344085693
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.5508632659912109
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5838494300842285
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6860122680664062
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5715141296386719
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5590026378631592
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6030120849609375
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.5030608177185059
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.5388636589050293
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5678281784057617
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.486588716506958
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.6436741352081299
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7123394012451172
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.6150703430175781
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6376445293426514
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5528075695037842
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5515100955963135
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6401751041412354
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5978536605834961
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5977611541748047
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6739869117736816
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5747466087341309
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.7138679027557373
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.5993092060089111
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5621345043182373
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5776510238647461
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5942702293395996
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5596261024475098
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.5913138389587402
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.6474275588989258
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5816597938537598
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.5419597625732422
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.5915365219116211
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1560314
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6010589599609375
Epoch: 1, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.264 Vali Acc: 0.264 Test Loss: 2.264 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.6222445964813232
Epoch: 2, Steps: 7 | Train Loss: 1.886 Vali Loss: 1.525 Vali Acc: 0.764 Test Loss: 1.525 Test Acc: 0.764
Validation loss decreased (-0.263866 --> -0.763874).  Saving model ...
Epoch: 3 cost time: 0.586024284362793
Epoch: 3, Steps: 7 | Train Loss: 1.008 Vali Loss: 0.901 Vali Acc: 0.806 Test Loss: 0.901 Test Acc: 0.806
Validation loss decreased (-0.763874 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 0.4989597797393799
Epoch: 4, Steps: 7 | Train Loss: 0.409 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.7476437091827393
Epoch: 5, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.6261141300201416
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5818459987640381
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5786945819854736
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.5290851593017578
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.47469425201416016
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.5594484806060791
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6500089168548584
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5154829025268555
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8117318153381348
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5108251571655273
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6654324531555176
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7140130996704102
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6691248416900635
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6057045459747314
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6908402442932129
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1555673
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8967835903167725
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.305 Vali Acc: 0.194 Test Loss: 2.305 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.6007742881774902
Epoch: 2, Steps: 7 | Train Loss: 1.979 Vali Loss: 1.544 Vali Acc: 0.736 Test Loss: 1.544 Test Acc: 0.736
Validation loss decreased (-0.194421 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.5607199668884277
Epoch: 3, Steps: 7 | Train Loss: 1.064 Vali Loss: 0.900 Vali Acc: 0.819 Test Loss: 0.900 Test Acc: 0.819
Validation loss decreased (-0.736096 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.6407783031463623
Epoch: 4, Steps: 7 | Train Loss: 0.444 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.6165931224822998
Epoch: 5, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.441 Vali Acc: 0.889 Test Loss: 0.441 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.5183315277099609
Epoch: 6, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.5709104537963867
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6974513530731201
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.606386661529541
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6215338706970215
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6395978927612305
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6574161052703857
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7515323162078857
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6060786247253418
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6500449180603027
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6075534820556641
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1558474
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7549598217010498
Epoch: 1, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.281 Vali Acc: 0.292 Test Loss: 2.281 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 0.6730630397796631
Epoch: 2, Steps: 7 | Train Loss: 1.903 Vali Loss: 1.521 Vali Acc: 0.792 Test Loss: 1.521 Test Acc: 0.792
Validation loss decreased (-0.291644 --> -0.791651).  Saving model ...
Epoch: 3 cost time: 0.6756551265716553
Epoch: 3, Steps: 7 | Train Loss: 1.026 Vali Loss: 0.868 Vali Acc: 0.861 Test Loss: 0.868 Test Acc: 0.861
Validation loss decreased (-0.791651 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.5493819713592529
Epoch: 4, Steps: 7 | Train Loss: 0.412 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5213100910186768
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.6906471252441406
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.5052459239959717
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6485683917999268
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.847 Test Loss: 0.311 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.52349853515625
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5471811294555664
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5742318630218506
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5866255760192871
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6113097667694092
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.5158379077911377
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5823290348052979
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6304106712341309
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5521981716156006
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5154173374176025
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6119542121887207
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.544323205947876
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5356283187866211
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6128232479095459
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5911881923675537
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.875 Test Loss: 0.269 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1556619
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5778696537017822
Epoch: 1, Steps: 7 | Train Loss: 2.504 Vali Loss: 2.250 Vali Acc: 0.264 Test Loss: 2.250 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.5431184768676758
Epoch: 2, Steps: 7 | Train Loss: 1.912 Vali Loss: 1.466 Vali Acc: 0.833 Test Loss: 1.466 Test Acc: 0.833
Validation loss decreased (-0.263866 --> -0.833319).  Saving model ...
Epoch: 3 cost time: 0.5972330570220947
Epoch: 3, Steps: 7 | Train Loss: 1.001 Vali Loss: 0.829 Vali Acc: 0.917 Test Loss: 0.829 Test Acc: 0.917
Validation loss decreased (-0.833319 --> -0.916658).  Saving model ...
Epoch: 4 cost time: 0.5770246982574463
Epoch: 4, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5490961074829102
Epoch: 5, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
Validation loss decreased (-0.916658 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.49099135398864746
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6041092872619629
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5636899471282959
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.6245808601379395
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.48692917823791504
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.5349090099334717
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.5778014659881592
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.5826799869537354
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5458841323852539
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6611111164093018
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.6947815418243408
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6723506450653076
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6919763088226318
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7928111553192139
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5966832637786865
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5693328380584717
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.5489404201507568
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.579930305480957
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6539721488952637
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5547053813934326
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6094019412994385
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6929857730865479
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6507291793823242
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.773195743560791
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6316108703613281
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.655684232711792
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5718464851379395
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1557290
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.845022201538086
Epoch: 1, Steps: 7 | Train Loss: 2.358 Vali Loss: 2.181 Vali Acc: 0.431 Test Loss: 2.181 Test Acc: 0.431
Validation loss decreased (inf --> -0.430534).  Saving model ...
Epoch: 2 cost time: 0.5473768711090088
Epoch: 2, Steps: 7 | Train Loss: 1.826 Vali Loss: 1.463 Vali Acc: 0.764 Test Loss: 1.463 Test Acc: 0.764
Validation loss decreased (-0.430534 --> -0.763874).  Saving model ...
Epoch: 3 cost time: 0.5616085529327393
Epoch: 3, Steps: 7 | Train Loss: 0.961 Vali Loss: 0.871 Vali Acc: 0.847 Test Loss: 0.871 Test Acc: 0.847
Validation loss decreased (-0.763874 --> -0.847214).  Saving model ...
Epoch: 4 cost time: 0.6031975746154785
Epoch: 4, Steps: 7 | Train Loss: 0.383 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.523963451385498
Epoch: 5, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.5334875583648682
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.6864778995513916
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5408761501312256
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.5782105922698975
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.6845345497131348
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.6943438053131104
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.6144742965698242
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6682431697845459
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.49746251106262207
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.6024580001831055
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5617475509643555
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.7228724956512451
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.802544355392456
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.6123459339141846
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7946116924285889
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.634474515914917
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.600461483001709
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.655937671661377
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5791079998016357
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6376819610595703
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5700769424438477
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5699961185455322
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6304168701171875
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6236023902893066
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.7186329364776611
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.6504161357879639
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.6597042083740234
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.646597146987915
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.615894079208374
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7468729019165039
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5679948329925537
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5109105110168457
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6030528545379639
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.6463713645935059
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6148207187652588
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 0.566051721572876
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.566084623336792
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.54453444480896
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.6723573207855225
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6848480701446533
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.607987642288208
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6815540790557861
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6645317077636719
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.493727445602417
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5531682968139648
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.5523180961608887
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5762288570404053
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6350786685943604
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.64306640625
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 55 cost time: 0.6821599006652832
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 56 cost time: 0.5760936737060547
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.639411211013794
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6377036571502686
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7092111110687256
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6783454418182373
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 0.7061293125152588
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5731034278869629
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6561169624328613
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 64 cost time: 0.7821164131164551
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5283286571502686
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5726549625396729
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.648914098739624
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.6380681991577148
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.6802492141723633
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.5819711685180664
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.7909195423126221
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.5937702655792236
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 73 cost time: 0.8100607395172119
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 74 cost time: 0.573035478591919
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.6566007137298584
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6148955821990967
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.6655030250549316
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.6886641979217529
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.6365005970001221
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.6963975429534912
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.8622403144836426
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.7874495983123779
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.6540966033935547
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1567669
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8559677600860596
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.386 Vali Acc: 0.222 Test Loss: 2.386 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.5497488975524902
Epoch: 2, Steps: 7 | Train Loss: 1.998 Vali Loss: 1.606 Vali Acc: 0.708 Test Loss: 1.606 Test Acc: 0.708
Validation loss decreased (-0.222198 --> -0.708317).  Saving model ...
Epoch: 3 cost time: 0.6162707805633545
Epoch: 3, Steps: 7 | Train Loss: 1.072 Vali Loss: 0.944 Vali Acc: 0.806 Test Loss: 0.944 Test Acc: 0.806
Validation loss decreased (-0.708317 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 0.610647439956665
Epoch: 4, Steps: 7 | Train Loss: 0.423 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.805546 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 0.5914280414581299
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.407 Vali Acc: 0.806 Test Loss: 0.407 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5206277370452881
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.366 Vali Acc: 0.847 Test Loss: 0.366 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847219).  Saving model ...
Epoch: 7 cost time: 0.6597938537597656
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.847219 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.5639185905456543
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5527482032775879
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.5438063144683838
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.6283998489379883
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5821747779846191
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5805895328521729
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.7427723407745361
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6286797523498535
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.5489120483398438
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5450394153594971
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.6207270622253418
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5581967830657959
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6560463905334473
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.627234935760498
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5989508628845215
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5946760177612305
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.6284897327423096
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5731551647186279
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.45012617111206055
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.5014767646789551
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5921103954315186
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.6989254951477051
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.5096194744110107
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.610116720199585
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6786763668060303
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6028923988342285
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5951638221740723
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5064914226531982
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6622288227081299
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5855774879455566
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5696597099304199
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.4748091697692871
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.46730971336364746
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5038456916809082
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.649066686630249
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.645867109298706
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.5854213237762451
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7240488529205322
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5735917091369629
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.571246862411499
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6749260425567627
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5670223236083984
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8119444847106934
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.5952212810516357
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5713379383087158
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6643939018249512
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6047477722167969
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5715346336364746
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5583992004394531
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5907795429229736
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.6829078197479248
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.5097405910491943
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.4565460681915283
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.4642360210418701
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5911521911621094
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.534203290939331
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.5113627910614014
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.5929245948791504
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.5894765853881836
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 67 cost time: 0.5281286239624023
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 68 cost time: 0.5017609596252441
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.534564733505249
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5347437858581543
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5975844860076904
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.4744110107421875
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.6202788352966309
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.5290436744689941
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.5434095859527588
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.4711732864379883
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.6314692497253418
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1561294
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.011052131652832
Epoch: 1, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.307 Vali Acc: 0.208 Test Loss: 2.307 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.5458846092224121
Epoch: 2, Steps: 7 | Train Loss: 1.890 Vali Loss: 1.556 Vali Acc: 0.708 Test Loss: 1.556 Test Acc: 0.708
Validation loss decreased (-0.208310 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.5517973899841309
Epoch: 3, Steps: 7 | Train Loss: 0.990 Vali Loss: 0.880 Vali Acc: 0.847 Test Loss: 0.880 Test Acc: 0.847
Validation loss decreased (-0.708318 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.6344878673553467
Epoch: 4, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
Validation loss decreased (-0.847213 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 0.5461089611053467
Epoch: 5, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.578249454498291
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.5735652446746826
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6458351612091064
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.46706271171569824
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5232462882995605
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5878205299377441
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.49353981018066406
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5308153629302979
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5569643974304199
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.582892894744873
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5628616809844971
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1556184
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8447675704956055
Epoch: 1, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.307 Vali Acc: 0.194 Test Loss: 2.307 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.4893484115600586
Epoch: 2, Steps: 7 | Train Loss: 1.923 Vali Loss: 1.579 Vali Acc: 0.667 Test Loss: 1.579 Test Acc: 0.667
Validation loss decreased (-0.194421 --> -0.666651).  Saving model ...
Epoch: 3 cost time: 0.482651948928833
Epoch: 3, Steps: 7 | Train Loss: 1.017 Vali Loss: 0.938 Vali Acc: 0.819 Test Loss: 0.938 Test Acc: 0.819
Validation loss decreased (-0.666651 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 0.4988105297088623
Epoch: 4, Steps: 7 | Train Loss: 0.407 Vali Loss: 0.550 Vali Acc: 0.847 Test Loss: 0.550 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 0.45321106910705566
Epoch: 5, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.5613737106323242
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.5831260681152344
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.49764418601989746
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5972707271575928
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6696937084197998
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7189455032348633
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.49022340774536133
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6585712432861328
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.5223774909973145
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.5477862358093262
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6174793243408203
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6400389671325684
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6392769813537598
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.6601202487945557
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.593578577041626
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.5279579162597656
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6681125164031982
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5895981788635254
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6374456882476807
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5083210468292236
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.5462570190429688
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6754465103149414
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5066976547241211
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6969082355499268
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5678834915161133
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.5723841190338135
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5592925548553467
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.6701078414916992
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6284308433532715
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6238269805908203
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7270796298980713
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7242782115936279
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.632098913192749
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7015552520751953
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.577866792678833
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5553634166717529
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.5266802310943604
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.5934998989105225
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4944636821746826
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5294983386993408
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5863339900970459
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6085882186889648
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.48922061920166016
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5323464870452881
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6447992324829102
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.45832347869873047
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5156893730163574
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.493579626083374
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.6921777725219727
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5372405052185059
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6471438407897949
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5656616687774658
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5283024311065674
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.473463773727417
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5577423572540283
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.6387302875518799
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5454976558685303
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.5380010604858398
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1555930
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7699835300445557
Epoch: 1, Steps: 7 | Train Loss: 2.442 Vali Loss: 2.264 Vali Acc: 0.264 Test Loss: 2.264 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.5666861534118652
Epoch: 2, Steps: 7 | Train Loss: 1.892 Vali Loss: 1.531 Vali Acc: 0.750 Test Loss: 1.531 Test Acc: 0.750
Validation loss decreased (-0.263866 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.6786394119262695
Epoch: 3, Steps: 7 | Train Loss: 0.996 Vali Loss: 0.901 Vali Acc: 0.806 Test Loss: 0.901 Test Acc: 0.806
Validation loss decreased (-0.749985 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 0.6308016777038574
Epoch: 4, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 0.5081627368927002
Epoch: 5, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.6110172271728516
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.455 Vali Acc: 0.847 Test Loss: 0.455 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6678516864776611
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4535715579986572
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6249620914459229
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.555077314376831
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.4788682460784912
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.5946028232574463
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6562809944152832
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.5156610012054443
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.5911474227905273
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5216512680053711
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.548607349395752
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5066423416137695
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5340001583099365
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5752050876617432
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6038265228271484
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.490161657333374
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6141667366027832
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5252113342285156
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.5154750347137451
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5709340572357178
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5203511714935303
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.61175537109375
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6423320770263672
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.576103687286377
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6275203227996826
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5297915935516357
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5942654609680176
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.6087350845336914
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.49532294273376465
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.5398988723754883
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5849020481109619
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5342442989349365
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5733432769775391
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7072234153747559
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5827383995056152
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5644667148590088
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.6255810260772705
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5648717880249023
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6284997463226318
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.5176408290863037
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.567319393157959
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.759087324142456
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6897449493408203
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6230692863464355
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8587517738342285
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6772415637969971
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.7163805961608887
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8999078273773193
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.7531750202178955
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1564123
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1312060356140137
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.339 Vali Acc: 0.222 Test Loss: 2.339 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 0.6552770137786865
Epoch: 2, Steps: 7 | Train Loss: 1.998 Vali Loss: 1.580 Vali Acc: 0.625 Test Loss: 1.580 Test Acc: 0.625
Validation loss decreased (-0.222199 --> -0.624984).  Saving model ...
Epoch: 3 cost time: 0.6472890377044678
Epoch: 3, Steps: 7 | Train Loss: 1.076 Vali Loss: 0.896 Vali Acc: 0.861 Test Loss: 0.896 Test Acc: 0.861
Validation loss decreased (-0.624984 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.8057186603546143
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.7146093845367432
Epoch: 5, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.7524666786193848
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.5991415977478027
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.7027251720428467
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.7163646221160889
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8938984870910645
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7074446678161621
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7148959636688232
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.67191481590271
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6344153881072998
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7152743339538574
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.7864818572998047
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.592496395111084
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7861781120300293
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8615207672119141
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7596030235290527
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7986705303192139
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6846344470977783
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7326679229736328
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.7668027877807617
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.7070286273956299
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.581444501876831
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5965127944946289
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8561239242553711
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6928174495697021
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6409018039703369
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6520390510559082
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7422008514404297
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7127540111541748
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.7817592620849609
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7519230842590332
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7443513870239258
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8115670680999756
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.6483941078186035
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6048262119293213
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.6702530384063721
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.6616082191467285
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.5795583724975586
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.6915385723114014
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7838151454925537
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7734518051147461
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.5675482749938965
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9515194892883301
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6853494644165039
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7248585224151611
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6953635215759277
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7786760330200195
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.7301387786865234
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.6366603374481201
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.7680835723876953
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.8635179996490479
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9600152969360352
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7697856426239014
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8534581661224365
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7417728900909424
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.690302848815918
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7805700302124023
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 0.595245361328125
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 0.9288864135742188
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9785668849945068
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 0.8404116630554199
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 0.6735508441925049
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9237544536590576
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6166236400604248
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9249775409698486
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8615272045135498
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.8823764324188232
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.812065839767456
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.967090368270874
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.8245699405670166
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.8779511451721191
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1562744
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3928799629211426
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.223 Vali Acc: 0.250 Test Loss: 2.223 Test Acc: 0.250
Validation loss decreased (inf --> -0.249978).  Saving model ...
Epoch: 2 cost time: 0.9691219329833984
Epoch: 2, Steps: 7 | Train Loss: 1.863 Vali Loss: 1.498 Vali Acc: 0.722 Test Loss: 1.498 Test Acc: 0.722
Validation loss decreased (-0.249978 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.8869895935058594
Epoch: 3, Steps: 7 | Train Loss: 1.001 Vali Loss: 0.875 Vali Acc: 0.833 Test Loss: 0.875 Test Acc: 0.833
Validation loss decreased (-0.722207 --> -0.833325).  Saving model ...
Epoch: 4 cost time: 0.8550620079040527
Epoch: 4, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.864264965057373
Epoch: 5, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9076025485992432
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.425 Vali Acc: 0.847 Test Loss: 0.425 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7442328929901123
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.8151919841766357
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.7993590831756592
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.9100968837738037
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.0183210372924805
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.0649487972259521
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.9585678577423096
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8620808124542236
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7668192386627197
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7435574531555176
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8968544006347656
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.875248908996582
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.882427453994751
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.007272481918335
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.7754957675933838
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.721153974533081
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7884185314178467
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.923161506652832
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9305219650268555
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.7750158309936523
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.6741230487823486
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.6880300045013428
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8364405632019043
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 0.7858552932739258
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 0.8559548854827881
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7339942455291748
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8285465240478516
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.817359209060669
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.9550914764404297
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7292892932891846
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.9602651596069336
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 1.060614824295044
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8143937587738037
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8439357280731201
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 0.8288986682891846
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.882206916809082
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 1.036963939666748
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 1.191058874130249
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8979747295379639
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.8523473739624023
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8762052059173584
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0413901805877686
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.8187088966369629
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 50 cost time: 0.6507537364959717
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.707082986831665
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8203606605529785
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 53 cost time: 1.1238532066345215
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0157525539398193
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0106911659240723
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9340646266937256
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 0.7790589332580566
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 58 cost time: 0.8736286163330078
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 59 cost time: 0.9138774871826172
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 60 cost time: 0.8260726928710938
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 1.0193374156951904
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9360566139221191
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 63 cost time: 0.7902228832244873
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 64 cost time: 0.7932398319244385
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8836550712585449
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0868117809295654
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.7405421733856201
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.6652743816375732
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.9642908573150635
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.8585267066955566
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 71 cost time: 0.7799465656280518
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7146263122558594
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.955939531326294
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 74 cost time: 0.9749808311462402
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7610824108123779
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9071872234344482
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.7863597869873047
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.6101720333099365
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 79 cost time: 0.678839921951294
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1211533546447754
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.801013708114624
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9775245189666748
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.9869194030761719
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.030937671661377
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.765618085861206
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.8247194290161133
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.7890608310699463
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.8517775535583496
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1551793
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4596481323242188
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.264 Vali Acc: 0.264 Test Loss: 2.264 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.8511419296264648
Epoch: 2, Steps: 7 | Train Loss: 1.907 Vali Loss: 1.525 Vali Acc: 0.736 Test Loss: 1.525 Test Acc: 0.736
Validation loss decreased (-0.263866 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.9330382347106934
Epoch: 3, Steps: 7 | Train Loss: 1.015 Vali Loss: 0.890 Vali Acc: 0.847 Test Loss: 0.890 Test Acc: 0.847
Validation loss decreased (-0.736096 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.9911222457885742
Epoch: 4, Steps: 7 | Train Loss: 0.402 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.8832528591156006
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.7166616916656494
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.22214674949646
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7142295837402344
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.343 Vali Acc: 0.847 Test Loss: 0.343 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8832900524139404
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8848707675933838
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.8655388355255127
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.1501970291137695
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9785768985748291
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8553657531738281
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8381466865539551
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.7675259113311768
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7169332504272461
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8353631496429443
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7859244346618652
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8472850322723389
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7048449516296387
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.8130972385406494
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.8340237140655518
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.8211455345153809
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8247404098510742
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9595143795013428
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.8770015239715576
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6499264240264893
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 1.4086477756500244
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.7216427326202393
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.006408929824829
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.9666340351104736
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.801645040512085
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.7691535949707031
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9420351982116699
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0738036632537842
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8223385810852051
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9815576076507568
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.9053325653076172
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.8357033729553223
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.954404354095459
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.8478472232818604
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8167164325714111
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7172183990478516
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.7427873611450195
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.929593563079834
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.8164336681365967
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7970643043518066
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9556357860565186
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9542114734649658
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8276219367980957
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9788699150085449
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9629926681518555
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.866572380065918
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.9834485054016113
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8129868507385254
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1555274
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1702516078948975
Epoch: 1, Steps: 7 | Train Loss: 2.598 Vali Loss: 2.389 Vali Acc: 0.222 Test Loss: 2.389 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.677419900894165
Epoch: 2, Steps: 7 | Train Loss: 1.981 Vali Loss: 1.562 Vali Acc: 0.694 Test Loss: 1.562 Test Acc: 0.694
Validation loss decreased (-0.222198 --> -0.694429).  Saving model ...
Epoch: 3 cost time: 0.595543622970581
Epoch: 3, Steps: 7 | Train Loss: 1.055 Vali Loss: 0.908 Vali Acc: 0.833 Test Loss: 0.908 Test Acc: 0.833
Validation loss decreased (-0.694429 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.609637975692749
Epoch: 4, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.8183503150939941
Epoch: 5, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.578829288482666
Epoch: 6, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7438821792602539
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.390 Vali Acc: 0.847 Test Loss: 0.390 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9676775932312012
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.364 Vali Acc: 0.847 Test Loss: 0.364 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0054082870483398
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.8554840087890625
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.9931776523590088
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.6532063484191895
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.7116608619689941
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8155684471130371
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.7172880172729492
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.902698278427124
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7557973861694336
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8982739448547363
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0363855361938477
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9679334163665771
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.785139799118042
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7899610996246338
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8236331939697266
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.686612606048584
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm128_cs57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1551577
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5538582801818848
Epoch: 1, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.389 Vali Acc: 0.139 Test Loss: 2.389 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.7119193077087402
Epoch: 2, Steps: 7 | Train Loss: 1.980 Vali Loss: 1.600 Vali Acc: 0.778 Test Loss: 1.600 Test Acc: 0.778
Validation loss decreased (-0.138865 --> -0.777762).  Saving model ...
Epoch: 3 cost time: 0.7258038520812988
Epoch: 3, Steps: 7 | Train Loss: 1.058 Vali Loss: 0.945 Vali Acc: 0.833 Test Loss: 0.945 Test Acc: 0.833
Validation loss decreased (-0.777762 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.7089731693267822
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.602886438369751
Epoch: 5, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.9392590522766113
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.431 Vali Acc: 0.847 Test Loss: 0.431 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7738814353942871
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.398 Vali Acc: 0.819 Test Loss: 0.398 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6509597301483154
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.394 Vali Acc: 0.819 Test Loss: 0.394 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7942941188812256
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.382 Vali Acc: 0.847 Test Loss: 0.382 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7136545181274414
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.847 Test Loss: 0.361 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6697773933410645
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.7777919769287109
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.7652690410614014
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7834806442260742
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7071585655212402
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 16 cost time: 0.7275803089141846
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.6667437553405762
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7234365940093994
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6978466510772705
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0240345001220703
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7640445232391357
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.7989692687988281
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7595102787017822
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1022989749908447
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8303921222686768
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.843958854675293
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7059955596923828
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8589744567871094
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7862987518310547
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7991936206817627
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7703676223754883
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 1553048
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs399_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2391016483306885
Epoch: 1, Steps: 7 | Train Loss: 2.511 Vali Loss: 2.371 Vali Acc: 0.236 Test Loss: 2.371 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.7891449928283691
Epoch: 2, Steps: 7 | Train Loss: 1.921 Vali Loss: 1.543 Vali Acc: 0.806 Test Loss: 1.543 Test Acc: 0.806
Validation loss decreased (-0.236087 --> -0.805540).  Saving model ...
Epoch: 3 cost time: 0.7113525867462158
Epoch: 3, Steps: 7 | Train Loss: 1.023 Vali Loss: 0.848 Vali Acc: 0.889 Test Loss: 0.848 Test Acc: 0.889
Validation loss decreased (-0.805540 --> -0.888880).  Saving model ...
Epoch: 4 cost time: 0.6978371143341064
Epoch: 4, Steps: 7 | Train Loss: 0.390 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7589216232299805
Epoch: 5, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.64654541015625
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8444466590881348
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7982265949249268
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8583729267120361
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.6717195510864258
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6487560272216797
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.7889621257781982
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.720989465713501
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7275369167327881
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9299352169036865
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7807488441467285
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6977510452270508
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7175946235656738
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7363767623901367
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6541953086853027
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8255147933959961
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs399_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1545465
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7973530292510986
Epoch: 1, Steps: 7 | Train Loss: 2.419 Vali Loss: 2.251 Vali Acc: 0.361 Test Loss: 2.251 Test Acc: 0.361
Validation loss decreased (inf --> -0.361089).  Saving model ...
Epoch: 2 cost time: 0.7491803169250488
Epoch: 2, Steps: 7 | Train Loss: 1.844 Vali Loss: 1.512 Vali Acc: 0.806 Test Loss: 1.512 Test Acc: 0.806
Validation loss decreased (-0.361089 --> -0.805540).  Saving model ...
Epoch: 3 cost time: 0.7394983768463135
Epoch: 3, Steps: 7 | Train Loss: 0.986 Vali Loss: 0.872 Vali Acc: 0.861 Test Loss: 0.872 Test Acc: 0.861
Validation loss decreased (-0.805540 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.7721376419067383
Epoch: 4, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.8080167770385742
Epoch: 5, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0050082206726074
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.6109225749969482
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8413505554199219
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7510840892791748
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7178812026977539
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8057842254638672
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0340802669525146
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7010378837585449
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8713357448577881
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8481366634368896
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6363277435302734
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1545906
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4956119060516357
Epoch: 1, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.349 Vali Acc: 0.208 Test Loss: 2.349 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.8980429172515869
Epoch: 2, Steps: 7 | Train Loss: 2.017 Vali Loss: 1.589 Vali Acc: 0.736 Test Loss: 1.589 Test Acc: 0.736
Validation loss decreased (-0.208310 --> -0.736095).  Saving model ...
Epoch: 3 cost time: 0.7559688091278076
Epoch: 3, Steps: 7 | Train Loss: 1.099 Vali Loss: 0.921 Vali Acc: 0.861 Test Loss: 0.921 Test Acc: 0.861
Validation loss decreased (-0.736095 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.8661069869995117
Epoch: 4, Steps: 7 | Train Loss: 0.440 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.7169570922851562
Epoch: 5, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.7206485271453857
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.8465449810028076
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7646899223327637
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.6729826927185059
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.7733275890350342
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.8174309730529785
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7419314384460449
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6875271797180176
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.875 Test Loss: 0.267 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8130595684051514
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.875 Test Loss: 0.263 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.641148567199707
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.875 Test Loss: 0.260 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6552271842956543
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.875 Test Loss: 0.258 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6381981372833252
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9555888175964355
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7406527996063232
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0677845478057861
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1544008
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2766711711883545
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.277 Vali Acc: 0.264 Test Loss: 2.277 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.733191967010498
Epoch: 2, Steps: 7 | Train Loss: 1.980 Vali Loss: 1.501 Vali Acc: 0.736 Test Loss: 1.501 Test Acc: 0.736
Validation loss decreased (-0.263866 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.7393002510070801
Epoch: 3, Steps: 7 | Train Loss: 1.060 Vali Loss: 0.894 Vali Acc: 0.861 Test Loss: 0.894 Test Acc: 0.861
Validation loss decreased (-0.736096 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.8380527496337891
Epoch: 4, Steps: 7 | Train Loss: 0.433 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.717808723449707
Epoch: 5, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.8020093441009521
Epoch: 6, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8002057075500488
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8032023906707764
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7542624473571777
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8548996448516846
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0073435306549072
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.1016736030578613
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.9425742626190186
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.776543140411377
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.1342484951019287
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7154312133789062
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.727508544921875
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7340362071990967
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0845577716827393
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8175992965698242
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9112541675567627
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8871309757232666
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8355238437652588
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8616414070129395
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1542754
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4463753700256348
Epoch: 1, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.391 Vali Acc: 0.139 Test Loss: 2.391 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.8185708522796631
Epoch: 2, Steps: 7 | Train Loss: 1.965 Vali Loss: 1.595 Vali Acc: 0.681 Test Loss: 1.595 Test Acc: 0.681
Validation loss decreased (-0.138865 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.9944593906402588
Epoch: 3, Steps: 7 | Train Loss: 1.054 Vali Loss: 0.943 Vali Acc: 0.833 Test Loss: 0.943 Test Acc: 0.833
Validation loss decreased (-0.680540 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.762439489364624
Epoch: 4, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.8118381500244141
Epoch: 5, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.7542707920074463
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.380 Vali Acc: 0.847 Test Loss: 0.380 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.917327880859375
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9216206073760986
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8699121475219727
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.334 Vali Acc: 0.847 Test Loss: 0.334 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9610452651977539
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7899675369262695
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7681870460510254
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.6804721355438232
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9196102619171143
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9544005393981934
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2333283424377441
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.9392645359039307
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 1.0300962924957275
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9252521991729736
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8832547664642334
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.7578108310699463
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.8352816104888916
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6671488285064697
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.840648889541626
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 0.6707355976104736
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.5897226333618164
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 0.6455976963043213
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6899383068084717
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8228957653045654
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.7256186008453369
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.6410348415374756
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6824758052825928
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.967242956161499
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7384610176086426
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0104994773864746
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.701848030090332
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6737804412841797
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 38 cost time: 0.7958090305328369
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 39 cost time: 0.8276293277740479
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7990131378173828
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 41 cost time: 0.7741246223449707
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.812659740447998
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9084279537200928
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 44 cost time: 0.936394214630127
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 45 cost time: 0.9018449783325195
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9747436046600342
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8016018867492676
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0515761375427246
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.901019811630249
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8012387752532959
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8472559452056885
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0904972553253174
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9276115894317627
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8439521789550781
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0113332271575928
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9217102527618408
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.6407101154327393
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.7449684143066406
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1538265
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4538192749023438
Epoch: 1, Steps: 7 | Train Loss: 2.503 Vali Loss: 2.334 Vali Acc: 0.222 Test Loss: 2.334 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 0.8031308650970459
Epoch: 2, Steps: 7 | Train Loss: 1.947 Vali Loss: 1.626 Vali Acc: 0.722 Test Loss: 1.626 Test Acc: 0.722
Validation loss decreased (-0.222199 --> -0.722206).  Saving model ...
Epoch: 3 cost time: 0.6538166999816895
Epoch: 3, Steps: 7 | Train Loss: 1.071 Vali Loss: 0.975 Vali Acc: 0.806 Test Loss: 0.975 Test Acc: 0.806
Validation loss decreased (-0.722206 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 0.6693925857543945
Epoch: 4, Steps: 7 | Train Loss: 0.449 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
Validation loss decreased (-0.805546 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.7337119579315186
Epoch: 5, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.7154700756072998
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.7876615524291992
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.811241626739502
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.346 Vali Acc: 0.861 Test Loss: 0.346 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8207778930664062
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.847 Test Loss: 0.339 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7153918743133545
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7511818408966064
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8860244750976562
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9801461696624756
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0964598655700684
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8938345909118652
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.315274953842163
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.7504019737243652
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.8573460578918457
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9332866668701172
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.7693133354187012
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.916705846786499
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.7605011463165283
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9905550479888916
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8442747592926025
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.9376819133758545
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.7705695629119873
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 1.021003246307373
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.9711580276489258
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 0.9230000972747803
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9195826053619385
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8219757080078125
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.8461329936981201
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.7010045051574707
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.9465851783752441
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 1.1269395351409912
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.9049797058105469
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7168676853179932
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9198822975158691
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.7886345386505127
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6877710819244385
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1118464469909668
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0142102241516113
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7683901786804199
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.983959436416626
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.7110776901245117
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7619366645812988
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0981669425964355
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 48 cost time: 0.8407258987426758
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9576520919799805
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9181797504425049
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9589142799377441
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1298470497131348
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1419308185577393
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0404407978057861
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6945161819458008
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.983468770980835
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 0.8063657283782959
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.109057903289795
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.909186601638794
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.0807592868804932
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.0668368339538574
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.079106330871582
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 1.175175666809082
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.402897596359253
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.7970688343048096
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 0.6399805545806885
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0363144874572754
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0879542827606201
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0142388343811035
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.2238047122955322
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.007960319519043
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.9142591953277588
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.0507993698120117
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.9431972503662109
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.6896333694458008
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1541218
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.888012409210205
Epoch: 1, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.198 Vali Acc: 0.250 Test Loss: 2.198 Test Acc: 0.250
Validation loss decreased (inf --> -0.249978).  Saving model ...
Epoch: 2 cost time: 0.7072858810424805
Epoch: 2, Steps: 7 | Train Loss: 1.876 Vali Loss: 1.460 Vali Acc: 0.778 Test Loss: 1.460 Test Acc: 0.778
Validation loss decreased (-0.249978 --> -0.777763).  Saving model ...
Epoch: 3 cost time: 0.7706120014190674
Epoch: 3, Steps: 7 | Train Loss: 0.995 Vali Loss: 0.845 Vali Acc: 0.903 Test Loss: 0.845 Test Acc: 0.903
Validation loss decreased (-0.777763 --> -0.902769).  Saving model ...
Epoch: 4 cost time: 0.8145852088928223
Epoch: 4, Steps: 7 | Train Loss: 0.382 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6965456008911133
Epoch: 5, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.838998556137085
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.7333788871765137
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.346 Vali Acc: 0.861 Test Loss: 0.346 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7878978252410889
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7829678058624268
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7605595588684082
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7922289371490479
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2513206005096436
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8942327499389648
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7860972881317139
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7696986198425293
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7810239791870117
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1537121
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6287267208099365
Epoch: 1, Steps: 7 | Train Loss: 2.559 Vali Loss: 2.405 Vali Acc: 0.278 Test Loss: 2.405 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 0.7897984981536865
Epoch: 2, Steps: 7 | Train Loss: 1.975 Vali Loss: 1.605 Vali Acc: 0.681 Test Loss: 1.605 Test Acc: 0.681
Validation loss decreased (-0.277754 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.8330259323120117
Epoch: 3, Steps: 7 | Train Loss: 1.052 Vali Loss: 0.938 Vali Acc: 0.847 Test Loss: 0.938 Test Acc: 0.847
Validation loss decreased (-0.680540 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 1.1296451091766357
Epoch: 4, Steps: 7 | Train Loss: 0.431 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.8786287307739258
Epoch: 5, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.9229891300201416
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.0363078117370605
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.1166095733642578
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.8666183948516846
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.8298008441925049
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.0283911228179932
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.13877272605896
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.9178009033203125
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9585170745849609
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9570708274841309
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8195312023162842
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.997370719909668
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8207802772521973
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.9464011192321777
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.8786256313323975
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.8629333972930908
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.749183177947998
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8807907104492188
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9653570652008057
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.7676100730895996
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7921032905578613
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.216336965560913
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.9567010402679443
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9865243434906006
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9043657779693604
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.159287929534912
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.7317924499511719
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.9377713203430176
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9419260025024414
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8619239330291748
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 1.0321478843688965
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.9968454837799072
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.725299596786499
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.8393356800079346
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.8765718936920166
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.731989860534668
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7930324077606201
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8854410648345947
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9030728340148926
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8916406631469727
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.774055004119873
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 1.1708011627197266
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.8270182609558105
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8382668495178223
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0997540950775146
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9526152610778809
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8081226348876953
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6829090118408203
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.8150784969329834
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.7460851669311523
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.7451605796813965
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8392243385314941
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.8875200748443604
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9049854278564453
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8099732398986816
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9147837162017822
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.726158618927002
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.1430447101593018
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.8131248950958252
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8515253067016602
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.720660924911499
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 0.6139118671417236
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 0.6912360191345215
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.7963817119598389
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 0.7066805362701416
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8860635757446289
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8978354930877686
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.8604981899261475
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7507936954498291
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.7466754913330078
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.6495997905731201
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.8345510959625244
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.0124967098236084
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.0257782936096191
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1540338
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3747026920318604
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 2.329 Vali Acc: 0.236 Test Loss: 2.329 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 0.7055153846740723
Epoch: 2, Steps: 7 | Train Loss: 1.913 Vali Loss: 1.600 Vali Acc: 0.681 Test Loss: 1.600 Test Acc: 0.681
Validation loss decreased (-0.236088 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.9163234233856201
Epoch: 3, Steps: 7 | Train Loss: 1.014 Vali Loss: 0.941 Vali Acc: 0.806 Test Loss: 0.941 Test Acc: 0.806
Validation loss decreased (-0.680540 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 0.7695026397705078
Epoch: 4, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.568 Vali Acc: 0.889 Test Loss: 0.568 Test Acc: 0.889
Validation loss decreased (-0.805546 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 0.5940959453582764
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.592583179473877
Epoch: 6, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5236074924468994
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6115860939025879
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6444203853607178
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8348960876464844
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.847 Test Loss: 0.384 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8729476928710938
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.878422737121582
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7457046508789062
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6862940788269043
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1538835
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.444974422454834
Epoch: 1, Steps: 7 | Train Loss: 2.426 Vali Loss: 2.242 Vali Acc: 0.292 Test Loss: 2.242 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 0.7168138027191162
Epoch: 2, Steps: 7 | Train Loss: 1.852 Vali Loss: 1.473 Vali Acc: 0.806 Test Loss: 1.473 Test Acc: 0.806
Validation loss decreased (-0.291644 --> -0.805541).  Saving model ...
Epoch: 3 cost time: 0.7553188800811768
Epoch: 3, Steps: 7 | Train Loss: 0.983 Vali Loss: 0.820 Vali Acc: 0.889 Test Loss: 0.820 Test Acc: 0.889
Validation loss decreased (-0.805541 --> -0.888881).  Saving model ...
Epoch: 4 cost time: 0.7539551258087158
Epoch: 4, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0388579368591309
Epoch: 5, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.0824339389801025
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 0.8251488208770752
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7174835205078125
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8993725776672363
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.8100316524505615
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6509504318237305
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.714313268661499
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0124998092651367
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.875 Test Loss: 0.259 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8272826671600342
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.875 Test Loss: 0.260 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9304056167602539
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.875 Test Loss: 0.260 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9360735416412354
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.875 Test Loss: 0.257 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0305449962615967
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.875 Test Loss: 0.254 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0076994895935059
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.875 Test Loss: 0.253 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6916458606719971
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.875 Test Loss: 0.252 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1539794
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.534099578857422
Epoch: 1, Steps: 7 | Train Loss: 2.478 Vali Loss: 2.325 Vali Acc: 0.194 Test Loss: 2.325 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.7501423358917236
Epoch: 2, Steps: 7 | Train Loss: 1.910 Vali Loss: 1.563 Vali Acc: 0.736 Test Loss: 1.563 Test Acc: 0.736
Validation loss decreased (-0.194421 --> -0.736095).  Saving model ...
Epoch: 3 cost time: 0.6768016815185547
Epoch: 3, Steps: 7 | Train Loss: 1.041 Vali Loss: 0.960 Vali Acc: 0.861 Test Loss: 0.960 Test Acc: 0.861
Validation loss decreased (-0.736095 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.7544646263122559
Epoch: 4, Steps: 7 | Train Loss: 0.422 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.6250619888305664
Epoch: 5, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.757493257522583
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8104875087738037
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6623179912567139
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7859401702880859
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6583597660064697
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.5898711681365967
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7127399444580078
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6979804039001465
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8543753623962402
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8533437252044678
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6758072376251221
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8758628368377686
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9946701526641846
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6052210330963135
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9482333660125732
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1550397
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0427420139312744
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.299 Vali Acc: 0.208 Test Loss: 2.299 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.7628958225250244
Epoch: 2, Steps: 7 | Train Loss: 1.943 Vali Loss: 1.558 Vali Acc: 0.681 Test Loss: 1.558 Test Acc: 0.681
Validation loss decreased (-0.208310 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.6812825202941895
Epoch: 3, Steps: 7 | Train Loss: 1.030 Vali Loss: 0.901 Vali Acc: 0.792 Test Loss: 0.901 Test Acc: 0.792
Validation loss decreased (-0.680540 --> -0.791658).  Saving model ...
Epoch: 4 cost time: 0.6014301776885986
Epoch: 4, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
Validation loss decreased (-0.791658 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.948432207107544
Epoch: 5, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.424 Vali Acc: 0.847 Test Loss: 0.424 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.866750955581665
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6439316272735596
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.7313621044158936
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 0.6074998378753662
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 0.6599206924438477
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.6555368900299072
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.8283815383911133
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.8927187919616699
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6950585842132568
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.8013639450073242
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.7022745609283447
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.7327253818511963
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.744025468826294
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9302153587341309
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8082222938537598
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.7161760330200195
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.7577779293060303
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6760008335113525
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7107264995574951
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.7389354705810547
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.7716431617736816
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8028402328491211
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9502239227294922
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.8046281337738037
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7401514053344727
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.7256379127502441
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6895687580108643
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6753804683685303
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.8052501678466797
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.7156157493591309
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8219578266143799
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6158361434936523
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7595646381378174
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.8086850643157959
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8488731384277344
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.6085855960845947
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7749383449554443
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6930983066558838
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7048251628875732
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7589900493621826
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.5865890979766846
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.6793415546417236
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.6521565914154053
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.636932373046875
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.7794523239135742
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7151374816894531
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.148820400238037
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9865748882293701
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7194817066192627
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.7276718616485596
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.6907742023468018
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.7806313037872314
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.7128193378448486
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.963451623916626
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1544246
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2130415439605713
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.347 Vali Acc: 0.194 Test Loss: 2.347 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.956493616104126
Epoch: 2, Steps: 7 | Train Loss: 1.997 Vali Loss: 1.555 Vali Acc: 0.722 Test Loss: 1.555 Test Acc: 0.722
Validation loss decreased (-0.194421 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.7086789608001709
Epoch: 3, Steps: 7 | Train Loss: 1.054 Vali Loss: 0.899 Vali Acc: 0.875 Test Loss: 0.899 Test Acc: 0.875
Validation loss decreased (-0.722207 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.8144845962524414
Epoch: 4, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8376893997192383
Epoch: 5, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8171606063842773
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874997).  Saving model ...
Epoch: 7 cost time: 0.7831556797027588
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.6846449375152588
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.6925537586212158
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.6596465110778809
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.6452713012695312
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.8119661808013916
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.6848936080932617
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.7899801731109619
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.7055144309997559
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.8762571811676025
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.843468427658081
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9377412796020508
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.7837395668029785
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8352370262145996
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7770485877990723
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8241109848022461
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.7724473476409912
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0069966316223145
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.7613022327423096
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.914750337600708
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 1.021615743637085
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8083720207214355
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.017850637435913
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7156810760498047
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8402667045593262
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 0.6595118045806885
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 1.1817960739135742
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7228822708129883
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8548529148101807
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.8381593227386475
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7846193313598633
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8390641212463379
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.8197641372680664
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.6928813457489014
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8625802993774414
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0670268535614014
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.8953382968902588
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1077830791473389
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8594264984130859
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.7743196487426758
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.8371880054473877
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 48 cost time: 0.9877748489379883
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.6965727806091309
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9188492298126221
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 51 cost time: 0.760296106338501
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 52 cost time: 0.7209458351135254
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6891601085662842
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7544949054718018
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.875598669052124
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 56 cost time: 0.7324116230010986
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 0.963123083114624
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7982678413391113
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7514889240264893
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9669134616851807
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 61 cost time: 0.799396276473999
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8262119293212891
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7820720672607422
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.6934258937835693
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8379025459289551
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.9945957660675049
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.794569730758667
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.7345607280731201
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.7656140327453613
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.866569995880127
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1539328
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.639828681945801
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.293 Vali Acc: 0.250 Test Loss: 2.293 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 0.7701799869537354
Epoch: 2, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.532 Vali Acc: 0.736 Test Loss: 1.532 Test Acc: 0.736
Validation loss decreased (-0.249977 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.6880769729614258
Epoch: 3, Steps: 7 | Train Loss: 1.043 Vali Loss: 0.885 Vali Acc: 0.833 Test Loss: 0.885 Test Acc: 0.833
Validation loss decreased (-0.736096 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 1.0911033153533936
Epoch: 4, Steps: 7 | Train Loss: 0.417 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
Validation loss decreased (-0.833324 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.7609577178955078
Epoch: 5, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.7377791404724121
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.7427942752838135
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8340730667114258
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6947977542877197
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7761812210083008
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.7377195358276367
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7668910026550293
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9378597736358643
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6722309589385986
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8400318622589111
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8935675621032715
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6231241226196289
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6837255954742432
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9286603927612305
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7817280292510986
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1539234
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.419161558151245
Epoch: 1, Steps: 7 | Train Loss: 2.492 Vali Loss: 2.365 Vali Acc: 0.167 Test Loss: 2.365 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.7195291519165039
Epoch: 2, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.612 Vali Acc: 0.736 Test Loss: 1.612 Test Acc: 0.736
Validation loss decreased (-0.166643 --> -0.736095).  Saving model ...
Epoch: 3 cost time: 0.8698301315307617
Epoch: 3, Steps: 7 | Train Loss: 1.037 Vali Loss: 0.941 Vali Acc: 0.806 Test Loss: 0.941 Test Acc: 0.806
Validation loss decreased (-0.736095 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 0.7723255157470703
Epoch: 4, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
Validation loss decreased (-0.805546 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.8366832733154297
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7981321811676025
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.401 Vali Acc: 0.847 Test Loss: 0.401 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9343714714050293
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.8355379104614258
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.6405599117279053
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.6938719749450684
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6348915100097656
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8807499408721924
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8546459674835205
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7246870994567871
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7999289035797119
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8229758739471436
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8623402118682861
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6595838069915771
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6706387996673584
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8599252700805664
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8208820819854736
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7182612419128418
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1547555
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.309386968612671
Epoch: 1, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.252 Vali Acc: 0.236 Test Loss: 2.252 Test Acc: 0.236
Validation loss decreased (inf --> -0.236089).  Saving model ...
Epoch: 2 cost time: 0.6407473087310791
Epoch: 2, Steps: 7 | Train Loss: 1.893 Vali Loss: 1.513 Vali Acc: 0.736 Test Loss: 1.513 Test Acc: 0.736
Validation loss decreased (-0.236089 --> -0.736096).  Saving model ...
Epoch: 3 cost time: 0.7460429668426514
Epoch: 3, Steps: 7 | Train Loss: 1.012 Vali Loss: 0.893 Vali Acc: 0.819 Test Loss: 0.893 Test Acc: 0.819
Validation loss decreased (-0.736096 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 0.6570312976837158
Epoch: 4, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
Validation loss decreased (-0.819436 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 0.7770588397979736
Epoch: 5, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.461 Vali Acc: 0.833 Test Loss: 0.461 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7539410591125488
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.406 Vali Acc: 0.847 Test Loss: 0.406 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8149826526641846
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6237287521362305
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.6916706562042236
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.8283283710479736
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6439990997314453
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7992422580718994
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6493868827819824
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7951586246490479
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7699642181396484
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8042938709259033
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7382452487945557
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8321876525878906
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9985206127166748
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1546304
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.100121259689331
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.358 Vali Acc: 0.167 Test Loss: 2.358 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.91306471824646
Epoch: 2, Steps: 7 | Train Loss: 1.959 Vali Loss: 1.587 Vali Acc: 0.778 Test Loss: 1.587 Test Acc: 0.778
Validation loss decreased (-0.166643 --> -0.777762).  Saving model ...
Epoch: 3 cost time: 0.7529010772705078
Epoch: 3, Steps: 7 | Train Loss: 1.046 Vali Loss: 0.922 Vali Acc: 0.806 Test Loss: 0.922 Test Acc: 0.806
Validation loss decreased (-0.777762 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 0.6799743175506592
Epoch: 4, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
Validation loss decreased (-0.805546 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.7855067253112793
Epoch: 5, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.0456483364105225
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.9504857063293457
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.322 Vali Acc: 0.847 Test Loss: 0.322 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.850182294845581
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0552904605865479
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.8525409698486328
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.7210192680358887
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9661891460418701
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.766146183013916
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9996232986450195
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7614724636077881
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9100551605224609
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.7358148097991943
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9326727390289307
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.865302324295044
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7850861549377441
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7805576324462891
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7951383590698242
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9218745231628418
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8275620937347412
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0721924304962158
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6998035907745361
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1535481
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.217197895050049
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.408 Vali Acc: 0.111 Test Loss: 2.408 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.6540155410766602
Epoch: 2, Steps: 7 | Train Loss: 1.955 Vali Loss: 1.597 Vali Acc: 0.708 Test Loss: 1.597 Test Acc: 0.708
Validation loss decreased (-0.111087 --> -0.708317).  Saving model ...
Epoch: 3 cost time: 0.7657887935638428
Epoch: 3, Steps: 7 | Train Loss: 1.032 Vali Loss: 0.915 Vali Acc: 0.861 Test Loss: 0.915 Test Acc: 0.861
Validation loss decreased (-0.708317 --> -0.861102).  Saving model ...
Epoch: 4 cost time: 0.7622582912445068
Epoch: 4, Steps: 7 | Train Loss: 0.426 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.8610630035400391
Epoch: 5, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.0148699283599854
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.73471999168396
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.9377999305725098
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.6699025630950928
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.7200226783752441
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.7812342643737793
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.6996419429779053
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.759549617767334
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2225394248962402
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0734257698059082
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8021390438079834
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9129776954650879
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.959907054901123
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7513437271118164
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6604533195495605
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8276584148406982
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8557162284851074
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.7745201587677002
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9225540161132812
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9184455871582031
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 1.0186631679534912
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2776968479156494
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8070321083068848
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.766571044921875
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.745887279510498
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.7566616535186768
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8565673828125
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8687131404876709
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 1.04270339012146
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.839733362197876
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8864457607269287
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8095669746398926
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8026394844055176
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7362561225891113
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8733434677124023
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7494735717773438
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7589857578277588
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0778887271881104
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1539058
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.957960605621338
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.308 Vali Acc: 0.194 Test Loss: 2.308 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.8747830390930176
Epoch: 2, Steps: 7 | Train Loss: 1.995 Vali Loss: 1.563 Vali Acc: 0.736 Test Loss: 1.563 Test Acc: 0.736
Validation loss decreased (-0.194421 --> -0.736095).  Saving model ...
Epoch: 3 cost time: 0.910292387008667
Epoch: 3, Steps: 7 | Train Loss: 1.093 Vali Loss: 0.888 Vali Acc: 0.875 Test Loss: 0.888 Test Acc: 0.875
Validation loss decreased (-0.736095 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 1.0263481140136719
Epoch: 4, Steps: 7 | Train Loss: 0.431 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8804728984832764
Epoch: 5, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.95809006690979
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.8565680980682373
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3523733615875244
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.833 Test Loss: 0.333 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9915173053741455
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.337 Vali Acc: 0.847 Test Loss: 0.337 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0475716590881348
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.847 Test Loss: 0.320 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8856227397918701
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.015998363494873
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.8904049396514893
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.9565863609313965
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.967432975769043
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.9129295349121094
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.0424025058746338
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.0651063919067383
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1750640869140625
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9301483631134033
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.9717211723327637
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1990931034088135
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.330906867980957
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 1.1336719989776611
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.1602370738983154
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0127086639404297
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.9123961925506592
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.9320681095123291
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.7680997848510742
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8400387763977051
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.7054533958435059
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8309404850006104
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8190364837646484
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.7606112957000732
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6058146953582764
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7545750141143799
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9761772155761719
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1051785945892334
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.846912145614624
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8195276260375977
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7413783073425293
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.6997978687286377
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.8698046207427979
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.241332769393921
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7530019283294678
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.16249418258667
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9142496585845947
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8889262676239014
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.013322353363037
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7650415897369385
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.1963021755218506
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2151401042938232
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8632645606994629
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9202439785003662
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2011029720306396
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7896382808685303
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.835857629776001
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.7802178859710693
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8451542854309082
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1294834613800049
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm64_cs57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1535457
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs599_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4763071537017822
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.437 Vali Acc: 0.111 Test Loss: 2.437 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.0850675106048584
Epoch: 2, Steps: 7 | Train Loss: 1.954 Vali Loss: 1.655 Vali Acc: 0.667 Test Loss: 1.655 Test Acc: 0.667
Validation loss decreased (-0.111087 --> -0.666650).  Saving model ...
Epoch: 3 cost time: 0.8431150913238525
Epoch: 3, Steps: 7 | Train Loss: 1.060 Vali Loss: 0.946 Vali Acc: 0.792 Test Loss: 0.946 Test Acc: 0.792
Validation loss decreased (-0.666650 --> -0.791657).  Saving model ...
Epoch: 4 cost time: 0.8916423320770264
Epoch: 4, Steps: 7 | Train Loss: 0.419 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
Validation loss decreased (-0.791657 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.6436684131622314
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.7742135524749756
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6283049583435059
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0373663902282715
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8643836975097656
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.0039598941802979
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.960557222366333
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8693921566009521
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.8249194622039795
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.0063767433166504
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.958763837814331
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.007204294204712
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0396552085876465
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2206051349639893
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7975165843963623
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.8383626937866211
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.0065796375274658
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.881540060043335
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.9409084320068359
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8202626705169678
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0163137912750244
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9079704284667969
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.8256251811981201
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9416110515594482
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8425500392913818
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 1.0286579132080078
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.8408322334289551
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 1.121253490447998
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.9635112285614014
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.052746057510376
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7732362747192383
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7929844856262207
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.8422608375549316
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1403965950012207
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.950359582901001
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1054635047912598
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7446327209472656
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7536144256591797
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7462165355682373
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0307669639587402
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8929722309112549
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 1.0183064937591553
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 1.0134012699127197
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.7248365879058838
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1552355289459229
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9475486278533936
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.20473313331604
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.789635419845581
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.7183504104614258
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9208583831787109
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.7978100776672363
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.7128455638885498
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.9541947841644287
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs599_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1537468
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs399_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.886199951171875
Epoch: 1, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.257 Vali Acc: 0.264 Test Loss: 2.257 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 1.1223180294036865
Epoch: 2, Steps: 7 | Train Loss: 1.907 Vali Loss: 1.521 Vali Acc: 0.681 Test Loss: 1.521 Test Acc: 0.681
Validation loss decreased (-0.263866 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.8803958892822266
Epoch: 3, Steps: 7 | Train Loss: 1.009 Vali Loss: 0.908 Vali Acc: 0.792 Test Loss: 0.908 Test Acc: 0.792
Validation loss decreased (-0.680540 --> -0.791658).  Saving model ...
Epoch: 4 cost time: 1.0740392208099365
Epoch: 4, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
Validation loss decreased (-0.791658 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 0.6426668167114258
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.446 Vali Acc: 0.847 Test Loss: 0.446 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6960968971252441
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.7018570899963379
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.7521908283233643
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9706580638885498
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 1.0802814960479736
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.646486759185791
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8168127536773682
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.9225709438323975
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6729235649108887
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.846750020980835
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.67867112159729
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9508209228515625
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7858965396881104
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7809774875640869
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7194969654083252
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8405361175537109
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7420072555541992
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.7511389255523682
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.7514922618865967
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7442440986633301
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7582130432128906
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8647372722625732
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.23883056640625
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9305741786956787
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9570262432098389
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8385128974914551
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9436755180358887
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.8132314682006836
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8447253704071045
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.780919075012207
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.7712283134460449
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6921031475067139
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.007150650024414
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.838259220123291
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7821044921875
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7720091342926025
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.7809913158416748
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.787431001663208
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8719747066497803
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6730532646179199
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9052670001983643
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.8242125511169434
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7992017269134521
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7540102005004883
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7093784809112549
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.8224656581878662
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.6247780323028564
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7435228824615479
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8538658618927002
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 0.7402210235595703
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 56 cost time: 0.84525465965271
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0152194499969482
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9229040145874023
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7552323341369629
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7309424877166748
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 61 cost time: 0.7375955581665039
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.8311998844146729
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 0.7547569274902344
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7849736213684082
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 65 cost time: 0.6863999366760254
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7640767097473145
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6863317489624023
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8616256713867188
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.7748599052429199
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.616243839263916
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.7474925518035889
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 72 cost time: 0.8411660194396973
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.8984253406524658
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.902493953704834
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 75 cost time: 0.7135913372039795
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.9504799842834473
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.8379924297332764
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.8203191757202148
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.7874822616577148
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.8069429397583008
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.7570972442626953
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.8013250827789307
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.8752467632293701
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 1.0553455352783203
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs399_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1533085
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.657292604446411
Epoch: 1, Steps: 7 | Train Loss: 2.649 Vali Loss: 2.387 Vali Acc: 0.139 Test Loss: 2.387 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.7623088359832764
Epoch: 2, Steps: 7 | Train Loss: 2.055 Vali Loss: 1.605 Vali Acc: 0.750 Test Loss: 1.605 Test Acc: 0.750
Validation loss decreased (-0.138865 --> -0.749984).  Saving model ...
Epoch: 3 cost time: 0.8594708442687988
Epoch: 3, Steps: 7 | Train Loss: 1.103 Vali Loss: 0.902 Vali Acc: 0.875 Test Loss: 0.902 Test Acc: 0.875
Validation loss decreased (-0.749984 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.9651610851287842
Epoch: 4, Steps: 7 | Train Loss: 0.435 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.7226912975311279
Epoch: 5, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.7359609603881836
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.9042859077453613
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.71736741065979
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7797677516937256
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.7557113170623779
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7952401638031006
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.7206604480743408
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8530879020690918
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.794959306716919
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.7158961296081543
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.8079712390899658
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.8247323036193848
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.0412065982818604
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.6902904510498047
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.851121187210083
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0166187286376953
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.7650914192199707
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.6786203384399414
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8614621162414551
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8667140007019043
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.7562785148620605
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7279343605041504
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.7237608432769775
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7238914966583252
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6318008899688721
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.8094978332519531
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7563004493713379
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.8375661373138428
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.7967934608459473
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7208125591278076
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.7749366760253906
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.7774367332458496
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.165661096572876
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.7282447814941406
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.9095568656921387
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6859922409057617
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7945008277893066
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6657798290252686
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9652309417724609
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0637998580932617
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7952873706817627
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8176734447479248
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8816213607788086
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8115434646606445
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1535110
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.801215410232544
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.346 Vali Acc: 0.250 Test Loss: 2.346 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 0.8795888423919678
Epoch: 2, Steps: 7 | Train Loss: 1.999 Vali Loss: 1.573 Vali Acc: 0.708 Test Loss: 1.573 Test Acc: 0.708
Validation loss decreased (-0.249977 --> -0.708318).  Saving model ...
Epoch: 3 cost time: 0.7806265354156494
Epoch: 3, Steps: 7 | Train Loss: 1.086 Vali Loss: 0.920 Vali Acc: 0.847 Test Loss: 0.920 Test Acc: 0.847
Validation loss decreased (-0.708318 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.5933210849761963
Epoch: 4, Steps: 7 | Train Loss: 0.456 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.6444876194000244
Epoch: 5, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.8357741832733154
Epoch: 6, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.0827555656433105
Epoch: 7, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 1.0007977485656738
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.8470621109008789
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9606378078460693
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.006951093673706
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.9685704708099365
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.999983549118042
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.9394943714141846
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9798669815063477
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9478893280029297
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9743087291717529
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.006906509399414
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1920006275177002
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9734597206115723
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0870726108551025
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8391494750976562
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0412206649780273
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9407849311828613
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1534172
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8027119636535645
Epoch: 1, Steps: 7 | Train Loss: 2.479 Vali Loss: 2.327 Vali Acc: 0.292 Test Loss: 2.327 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 0.943903923034668
Epoch: 2, Steps: 7 | Train Loss: 1.916 Vali Loss: 1.577 Vali Acc: 0.736 Test Loss: 1.577 Test Acc: 0.736
Validation loss decreased (-0.291643 --> -0.736095).  Saving model ...
Epoch: 3 cost time: 1.0292320251464844
Epoch: 3, Steps: 7 | Train Loss: 1.046 Vali Loss: 0.929 Vali Acc: 0.819 Test Loss: 0.929 Test Acc: 0.819
Validation loss decreased (-0.736095 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 1.0295205116271973
Epoch: 4, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.579 Vali Acc: 0.875 Test Loss: 0.579 Test Acc: 0.875
Validation loss decreased (-0.819435 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 1.1064839363098145
Epoch: 5, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.086284875869751
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.9145004749298096
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9073140621185303
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0707578659057617
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.562026023864746
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2869195938110352
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2218053340911865
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0240581035614014
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9141318798065186
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2262179851531982
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9895627498626709
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1533558
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.124016523361206
Epoch: 1, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.352 Vali Acc: 0.167 Test Loss: 2.352 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.9775445461273193
Epoch: 2, Steps: 7 | Train Loss: 1.915 Vali Loss: 1.570 Vali Acc: 0.736 Test Loss: 1.570 Test Acc: 0.736
Validation loss decreased (-0.166643 --> -0.736095).  Saving model ...
Epoch: 3 cost time: 0.8524279594421387
Epoch: 3, Steps: 7 | Train Loss: 1.022 Vali Loss: 0.915 Vali Acc: 0.819 Test Loss: 0.915 Test Acc: 0.819
Validation loss decreased (-0.736095 --> -0.819435).  Saving model ...
Epoch: 4 cost time: 1.0154645442962646
Epoch: 4, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 1.0125696659088135
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.9894857406616211
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.8955433368682861
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.847 Test Loss: 0.355 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0892980098724365
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8263087272644043
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.353 Vali Acc: 0.847 Test Loss: 0.353 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8335845470428467
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1718180179595947
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.0532526969909668
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.9267566204071045
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.8988032341003418
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.1845698356628418
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.789569616317749
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9155092239379883
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1999619007110596
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1626570224761963
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.875 Test Loss: 0.280 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.836359977722168
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0058128833770752
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.086496114730835
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9554502964019775
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8888883590698242
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0022714138031006
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1529533
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.795872449874878
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.388 Vali Acc: 0.208 Test Loss: 2.388 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.9696142673492432
Epoch: 2, Steps: 7 | Train Loss: 2.023 Vali Loss: 1.634 Vali Acc: 0.639 Test Loss: 1.634 Test Acc: 0.639
Validation loss decreased (-0.208309 --> -0.638873).  Saving model ...
Epoch: 3 cost time: 0.8665549755096436
Epoch: 3, Steps: 7 | Train Loss: 1.100 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
Validation loss decreased (-0.638873 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 1.1029016971588135
Epoch: 4, Steps: 7 | Train Loss: 0.446 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
Validation loss decreased (-0.749991 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 0.7660894393920898
Epoch: 5, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.801640510559082
Epoch: 6, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.390 Vali Acc: 0.847 Test Loss: 0.390 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0643045902252197
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.9030270576477051
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.8780577182769775
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 10 cost time: 0.9661614894866943
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.9783456325531006
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 1.3630597591400146
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 1.046727180480957
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.9245679378509521
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 0.8922159671783447
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8988609313964844
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.7883939743041992
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.7755570411682129
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9693541526794434
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.163841724395752
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9523932933807373
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9734587669372559
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.8238687515258789
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.7832169532775879
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0247652530670166
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.046661376953125
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 1.3160367012023926
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8619906902313232
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9282920360565186
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.00783109664917
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 31 cost time: 1.1431384086608887
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4154269695281982
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3082976341247559
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.002849817276001
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.8132181167602539
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.8249034881591797
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.7221345901489258
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.8202078342437744
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.7364597320556641
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9291386604309082
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.065481185913086
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0572052001953125
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.191368579864502
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0423085689544678
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1415460109710693
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.9013128280639648
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0634987354278564
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 1.1745405197143555
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.9789144992828369
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1849339008331299
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0167791843414307
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0378367900848389
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1513006687164307
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1442911624908447
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2050483226776123
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.033050298690796
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7493035793304443
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 58 cost time: 0.940936803817749
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 1.0432713031768799
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1056969165802002
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9217171669006348
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 62 cost time: 0.9488351345062256
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 63 cost time: 1.010157823562622
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7687211036682129
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9057281017303467
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.0405454635620117
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9321510791778564
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.7125425338745117
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.9144833087921143
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 70 cost time: 1.1616566181182861
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8799107074737549
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.2563798427581787
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 73 cost time: 0.7183952331542969
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0376546382904053
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8193588256835938
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.046738624572754
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.8250484466552734
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.9856421947479248
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.9578330516815186
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.8887655735015869
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.7112996578216553
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.8848564624786377
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1532822
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.941676378250122
Epoch: 1, Steps: 7 | Train Loss: 2.537 Vali Loss: 2.327 Vali Acc: 0.236 Test Loss: 2.327 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 1.0401453971862793
Epoch: 2, Steps: 7 | Train Loss: 1.957 Vali Loss: 1.561 Vali Acc: 0.764 Test Loss: 1.561 Test Acc: 0.764
Validation loss decreased (-0.236088 --> -0.763873).  Saving model ...
Epoch: 3 cost time: 0.7342641353607178
Epoch: 3, Steps: 7 | Train Loss: 1.078 Vali Loss: 0.925 Vali Acc: 0.847 Test Loss: 0.925 Test Acc: 0.847
Validation loss decreased (-0.763873 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.7593915462493896
Epoch: 4, Steps: 7 | Train Loss: 0.453 Vali Loss: 0.557 Vali Acc: 0.903 Test Loss: 0.557 Test Acc: 0.903
Validation loss decreased (-0.847213 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 0.7946171760559082
Epoch: 5, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.405 Vali Acc: 0.931 Test Loss: 0.405 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 0.714055061340332
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.809100866317749
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.353 Vali Acc: 0.847 Test Loss: 0.353 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1571803092956543
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7814781665802002
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1095774173736572
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8893561363220215
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8341424465179443
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6794178485870361
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6503889560699463
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8302717208862305
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1528997
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.281616687774658
Epoch: 1, Steps: 7 | Train Loss: 2.442 Vali Loss: 2.303 Vali Acc: 0.250 Test Loss: 2.303 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 1.0498149394989014
Epoch: 2, Steps: 7 | Train Loss: 1.913 Vali Loss: 1.576 Vali Acc: 0.694 Test Loss: 1.576 Test Acc: 0.694
Validation loss decreased (-0.249977 --> -0.694429).  Saving model ...
Epoch: 3 cost time: 0.982313871383667
Epoch: 3, Steps: 7 | Train Loss: 1.046 Vali Loss: 0.916 Vali Acc: 0.833 Test Loss: 0.916 Test Acc: 0.833
Validation loss decreased (-0.694429 --> -0.833324).  Saving model ...
Epoch: 4 cost time: 0.9721894264221191
Epoch: 4, Steps: 7 | Train Loss: 0.423 Vali Loss: 0.609 Vali Acc: 0.847 Test Loss: 0.609 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 0.926915168762207
Epoch: 5, Steps: 7 | Train Loss: 0.162 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.9368278980255127
Epoch: 6, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.8958401679992676
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8425853252410889
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2052812576293945
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0014936923980713
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.9395287036895752
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9276607036590576
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1203594207763672
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.1308109760284424
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1415297985076904
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.167877435684204
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7899477481842041
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8437488079071045
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8594648838043213
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7900049686431885
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.334486722946167
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0440387725830078
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.241546630859375
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1532422
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4222898483276367
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.454 Vali Acc: 0.153 Test Loss: 2.454 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.818500280380249
Epoch: 2, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.654 Vali Acc: 0.625 Test Loss: 1.654 Test Acc: 0.625
Validation loss decreased (-0.152753 --> -0.624983).  Saving model ...
Epoch: 3 cost time: 0.8670346736907959
Epoch: 3, Steps: 7 | Train Loss: 1.092 Vali Loss: 0.994 Vali Acc: 0.778 Test Loss: 0.994 Test Acc: 0.778
Validation loss decreased (-0.624983 --> -0.777768).  Saving model ...
Epoch: 4 cost time: 0.9663650989532471
Epoch: 4, Steps: 7 | Train Loss: 0.451 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
Validation loss decreased (-0.777768 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.9074149131774902
Epoch: 5, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.8394851684570312
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.392 Vali Acc: 0.847 Test Loss: 0.392 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7781808376312256
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9288041591644287
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6949465274810791
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.847 Test Loss: 0.333 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.716620683670044
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.847 Test Loss: 0.323 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7406384944915771
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.812828779220581
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6778368949890137
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9154787063598633
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9307467937469482
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1531095
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.152083158493042
Epoch: 1, Steps: 7 | Train Loss: 2.636 Vali Loss: 2.436 Vali Acc: 0.125 Test Loss: 2.436 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.9868209362030029
Epoch: 2, Steps: 7 | Train Loss: 2.051 Vali Loss: 1.636 Vali Acc: 0.694 Test Loss: 1.636 Test Acc: 0.694
Validation loss decreased (-0.124976 --> -0.694428).  Saving model ...
Epoch: 3 cost time: 0.9204652309417725
Epoch: 3, Steps: 7 | Train Loss: 1.135 Vali Loss: 0.963 Vali Acc: 0.764 Test Loss: 0.963 Test Acc: 0.764
Validation loss decreased (-0.694428 --> -0.763879).  Saving model ...
Epoch: 4 cost time: 1.0606813430786133
Epoch: 4, Steps: 7 | Train Loss: 0.449 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
Validation loss decreased (-0.763879 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 1.1394588947296143
Epoch: 5, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.7809202671051025
Epoch: 6, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 1.0119168758392334
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1585180759429932
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9773619174957275
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.336 Vali Acc: 0.847 Test Loss: 0.336 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9126729965209961
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.0465617179870605
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 1.023843765258789
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 13 cost time: 0.8783180713653564
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 1.2427842617034912
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 1.2630858421325684
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.45725679397583
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1248137950897217
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9733281135559082
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 19 cost time: 1.0980606079101562
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 1.0788733959197998
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.9312701225280762
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 1.2612595558166504
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9553532600402832
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2329535484313965
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 0.8810379505157471
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 26 cost time: 0.966928243637085
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 1.1644835472106934
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 28 cost time: 0.9910018444061279
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8415741920471191
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 1.0364348888397217
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 1.020554780960083
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 1.0108237266540527
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 33 cost time: 0.9522628784179688
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.8921444416046143
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 1.0671494007110596
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9872400760650635
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.281489372253418
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9744505882263184
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.8771624565124512
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 1.2774672508239746
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 1.1277813911437988
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.8303005695343018
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1629185676574707
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0538277626037598
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1370468139648438
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1725153923034668
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 1.211240291595459
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3280467987060547
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 49 cost time: 0.8522188663482666
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0031776428222656
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1959571838378906
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7605457305908203
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9301092624664307
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.6078152656555176
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.273116111755371
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.17319917678833
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 57 cost time: 1.02797269821167
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2193658351898193
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1069746017456055
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.039968729019165
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9633746147155762
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.1750147342681885
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.0220942497253418
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.15053129196167
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 65 cost time: 1.0793519020080566
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 66 cost time: 1.0760564804077148
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2970740795135498
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0734689235687256
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9738016128540039
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.092729091644287
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.0320441722869873
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.220978021621704
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.1677308082580566
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 74 cost time: 1.0564484596252441
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.3516349792480469
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9422030448913574
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9623715877532959
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.1451740264892578
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.9205646514892578
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.2105364799499512
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.845940113067627
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.8056230545043945
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.1898131370544434
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 84 cost time: 1.0541152954101562
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.0746605396270752
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.2827911376953125
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.9303982257843018
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.3534436225891113
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.8384156227111816
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.447800874710083
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 1.0095772743225098
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 1.5216972827911377
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.9931848049163818
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1532198
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1229333877563477
Epoch: 1, Steps: 7 | Train Loss: 2.405 Vali Loss: 2.278 Vali Acc: 0.306 Test Loss: 2.278 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 1.172339677810669
Epoch: 2, Steps: 7 | Train Loss: 1.852 Vali Loss: 1.542 Vali Acc: 0.667 Test Loss: 1.542 Test Acc: 0.667
Validation loss decreased (-0.305533 --> -0.666651).  Saving model ...
Epoch: 3 cost time: 1.3017997741699219
Epoch: 3, Steps: 7 | Train Loss: 1.009 Vali Loss: 0.915 Vali Acc: 0.847 Test Loss: 0.915 Test Acc: 0.847
Validation loss decreased (-0.666651 --> -0.847213).  Saving model ...
Epoch: 4 cost time: 0.9581027030944824
Epoch: 4, Steps: 7 | Train Loss: 0.406 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0012571811676025
Epoch: 5, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.485 Vali Acc: 0.861 Test Loss: 0.485 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.9501965045928955
Epoch: 6, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.8940765857696533
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.9365403652191162
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.9778001308441162
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.930610179901123
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9933772087097168
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8646345138549805
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2732083797454834
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9282078742980957
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.917219877243042
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9720983505249023
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7438805103302002
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8183417320251465
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.195127010345459
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1542913
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1848957538604736
Epoch: 1, Steps: 7 | Train Loss: 2.486 Vali Loss: 2.268 Vali Acc: 0.319 Test Loss: 2.268 Test Acc: 0.319
Validation loss decreased (inf --> -0.319422).  Saving model ...
Epoch: 2 cost time: 1.188488483428955
Epoch: 2, Steps: 7 | Train Loss: 1.913 Vali Loss: 1.515 Vali Acc: 0.722 Test Loss: 1.515 Test Acc: 0.722
Validation loss decreased (-0.319422 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 0.8971819877624512
Epoch: 3, Steps: 7 | Train Loss: 1.027 Vali Loss: 0.877 Vali Acc: 0.875 Test Loss: 0.877 Test Acc: 0.875
Validation loss decreased (-0.722207 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.878643274307251
Epoch: 4, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.567 Vali Acc: 0.903 Test Loss: 0.567 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 0.7572076320648193
Epoch: 5, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9447426795959473
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9491608142852783
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9988420009613037
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3992176055908203
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1581735610961914
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7856760025024414
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.297149896621704
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.0427916049957275
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.8751752376556396
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.7780473232269287
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.8960700035095215
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.1439464092254639
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.8717446327209473
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9485468864440918
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2132446765899658
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0525319576263428
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.212789535522461
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.9997847080230713
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1901752948760986
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 1.0371718406677246
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.9190316200256348
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.8890745639801025
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 1.0078487396240234
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8330018520355225
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 1.0854442119598389
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0886056423187256
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 1.0009171962738037
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.8700532913208008
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 1.218428373336792
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.9265062808990479
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9173915386199951
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3649461269378662
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.9481618404388428
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9152936935424805
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 1.1253268718719482
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.811058759689331
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.837364912033081
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8190324306488037
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8744328022003174
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9306750297546387
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1779935359954834
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.049333095550537
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8919351100921631
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1350829601287842
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0828797817230225
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1536874
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.122999906539917
Epoch: 1, Steps: 7 | Train Loss: 2.523 Vali Loss: 2.269 Vali Acc: 0.278 Test Loss: 2.269 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 1.2099826335906982
Epoch: 2, Steps: 7 | Train Loss: 1.955 Vali Loss: 1.528 Vali Acc: 0.722 Test Loss: 1.528 Test Acc: 0.722
Validation loss decreased (-0.277755 --> -0.722207).  Saving model ...
Epoch: 3 cost time: 1.1668977737426758
Epoch: 3, Steps: 7 | Train Loss: 1.040 Vali Loss: 0.894 Vali Acc: 0.819 Test Loss: 0.894 Test Acc: 0.819
Validation loss decreased (-0.722207 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 0.7526767253875732
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 0.9179649353027344
Epoch: 5, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
Validation loss decreased (-0.861106 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.8760130405426025
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8483319282531738
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8276729583740234
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9412403106689453
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9127306938171387
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.006392002105713
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0920357704162598
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.341700553894043
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.9708402156829834
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.955003023147583
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2301809787750244
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9349644184112549
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9491329193115234
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0329558849334717
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9624807834625244
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9181411266326904
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8721251487731934
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.022287130355835
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8096849918365479
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1532052
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.303055763244629
Epoch: 1, Steps: 7 | Train Loss: 2.492 Vali Loss: 2.208 Vali Acc: 0.333 Test Loss: 2.208 Test Acc: 0.333
Validation loss decreased (inf --> -0.333311).  Saving model ...
Epoch: 2 cost time: 0.7892084121704102
Epoch: 2, Steps: 7 | Train Loss: 1.903 Vali Loss: 1.466 Vali Acc: 0.778 Test Loss: 1.466 Test Acc: 0.778
Validation loss decreased (-0.333311 --> -0.777763).  Saving model ...
Epoch: 3 cost time: 1.0045390129089355
Epoch: 3, Steps: 7 | Train Loss: 1.016 Vali Loss: 0.852 Vali Acc: 0.875 Test Loss: 0.852 Test Acc: 0.875
Validation loss decreased (-0.777763 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 0.996941328048706
Epoch: 4, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9557271003723145
Epoch: 5, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.7402431964874268
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 0.8055830001831055
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.2170238494873047
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8988242149353027
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.7919573783874512
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.8398532867431641
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9273715019226074
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8266422748565674
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.0417640209197998
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.30409574508667
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.0242445468902588
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.2111051082611084
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.1457319259643555
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9172313213348389
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.9743702411651611
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.9005260467529297
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.4627306461334229
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.160909652709961
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9398036003112793
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9375088214874268
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4042730331420898
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.2140231132507324
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7834327220916748
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 1.2369158267974854
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9573616981506348
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.903 Test Loss: 0.234 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.76474928855896
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.6948089599609375
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.7807364463806152
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.8859262466430664
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.8860819339752197
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.9264025688171387
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.246140718460083
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8884334564208984
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2416481971740723
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.961503267288208
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9098620414733887
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.9516899585723877
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7797327041625977
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2424359321594238
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0164010524749756
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0274834632873535
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0685503482818604
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9996199607849121
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9645256996154785
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9334523677825928
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9662737846374512
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 52 cost time: 0.9588773250579834
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 53 cost time: 0.9967985153198242
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 0.9651720523834229
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 0.934272050857544
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9046027660369873
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.018502950668335
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1948072910308838
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9298415184020996
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9786407947540283
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7708063125610352
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 1.0917878150939941
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.972989559173584
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2434391975402832
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8976924419403076
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9581074714660645
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 1.0413198471069336
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.025313377380371
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 0.8495151996612549
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6866257190704346
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.872208833694458
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.1209688186645508
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.974311113357544
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.0025367736816406
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.0409657955169678
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.2141034603118896
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.9253668785095215
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.0253124237060547
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1532038
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.54404354095459
Epoch: 1, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.316 Vali Acc: 0.194 Test Loss: 2.316 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.8874433040618896
Epoch: 2, Steps: 7 | Train Loss: 1.898 Vali Loss: 1.520 Vali Acc: 0.681 Test Loss: 1.520 Test Acc: 0.681
Validation loss decreased (-0.194421 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.6373088359832764
Epoch: 3, Steps: 7 | Train Loss: 0.997 Vali Loss: 0.843 Vali Acc: 0.903 Test Loss: 0.843 Test Acc: 0.903
Validation loss decreased (-0.680540 --> -0.902769).  Saving model ...
Epoch: 4 cost time: 1.0733668804168701
Epoch: 4, Steps: 7 | Train Loss: 0.397 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9026682376861572
Epoch: 5, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.421 Vali Acc: 0.861 Test Loss: 0.421 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8305890560150146
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.1207225322723389
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8406407833099365
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8110551834106445
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8545281887054443
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1873624324798584
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8477072715759277
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9671313762664795
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9490790367126465
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9031276702880859
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7187991142272949
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1540423
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4826059341430664
Epoch: 1, Steps: 7 | Train Loss: 2.438 Vali Loss: 2.221 Vali Acc: 0.361 Test Loss: 2.221 Test Acc: 0.361
Validation loss decreased (inf --> -0.361089).  Saving model ...
Epoch: 2 cost time: 0.6485323905944824
Epoch: 2, Steps: 7 | Train Loss: 1.867 Vali Loss: 1.470 Vali Acc: 0.667 Test Loss: 1.470 Test Acc: 0.667
Validation loss decreased (-0.361089 --> -0.666652).  Saving model ...
Epoch: 3 cost time: 0.8452298641204834
Epoch: 3, Steps: 7 | Train Loss: 0.987 Vali Loss: 0.847 Vali Acc: 0.861 Test Loss: 0.847 Test Acc: 0.861
Validation loss decreased (-0.666652 --> -0.861103).  Saving model ...
Epoch: 4 cost time: 0.9518876075744629
Epoch: 4, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 0.7898352146148682
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.830427885055542
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.8286166191101074
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 1.0418262481689453
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.8628787994384766
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.1222271919250488
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.9819760322570801
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.8657915592193604
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9400553703308105
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0511891841888428
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0248119831085205
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.867882490158081
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1081268787384033
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0873334407806396
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8504095077514648
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8741991519927979
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0370235443115234
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9529805183410645
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7958204746246338
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7511656284332275
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1539236
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4829442501068115
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.343 Vali Acc: 0.181 Test Loss: 2.343 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 1.258629560470581
Epoch: 2, Steps: 7 | Train Loss: 1.986 Vali Loss: 1.574 Vali Acc: 0.694 Test Loss: 1.574 Test Acc: 0.694
Validation loss decreased (-0.180532 --> -0.694429).  Saving model ...
Epoch: 3 cost time: 0.6834776401519775
Epoch: 3, Steps: 7 | Train Loss: 1.058 Vali Loss: 0.926 Vali Acc: 0.806 Test Loss: 0.926 Test Acc: 0.806
Validation loss decreased (-0.694429 --> -0.805546).  Saving model ...
Epoch: 4 cost time: 0.7409400939941406
Epoch: 4, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.558 Vali Acc: 0.847 Test Loss: 0.558 Test Acc: 0.847
Validation loss decreased (-0.805546 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 1.1926860809326172
Epoch: 5, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 0.7272896766662598
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.388 Vali Acc: 0.847 Test Loss: 0.388 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.8169553279876709
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1069307327270508
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 1.0460186004638672
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.2358407974243164
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.9348609447479248
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.8821854591369629
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6699609756469727
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.8982715606689453
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8648488521575928
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8354446887969971
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7784571647644043
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.875 Test Loss: 0.286 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9885256290435791
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0168821811676025
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8482213020324707
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.7776298522949219
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.7980747222900391
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.6133546829223633
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.9538865089416504
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8511857986450195
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.7192041873931885
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0285968780517578
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.7896521091461182
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.938408613204956
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.8475909233093262
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8761494159698486
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.8306968212127686
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9198923110961914
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.892385721206665
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.761775016784668
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.8394300937652588
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 1.0472404956817627
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 1.1218225955963135
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.83038330078125
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.9409816265106201
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 1.0453460216522217
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.8048233985900879
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7905819416046143
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.7979776859283447
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0350561141967773
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8901770114898682
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1146519184112549
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9350473880767822
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8737096786499023
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.8353688716888428
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 51 cost time: 0.9496181011199951
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8387665748596191
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 53 cost time: 0.690192461013794
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 54 cost time: 0.6947407722473145
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 55 cost time: 1.0014677047729492
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0973708629608154
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7967569828033447
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.201545000076294
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 59 cost time: 0.9333102703094482
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 60 cost time: 0.838897705078125
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0035138130187988
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9288022518157959
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8563923835754395
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 64 cost time: 0.8129544258117676
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9477474689483643
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 66 cost time: 1.1208734512329102
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9914524555206299
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9559743404388428
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 69 cost time: 1.0108866691589355
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.927260160446167
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 71 cost time: 0.6399006843566895
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9317004680633545
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.8383960723876953
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9952216148376465
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.0667219161987305
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.0404620170593262
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 77 cost time: 1.0069358348846436
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 78 cost time: 0.7101473808288574
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 79 cost time: 0.7843475341796875
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9206597805023193
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.7692275047302246
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9076125621795654
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.8550903797149658
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.9421818256378174
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.7291607856750488
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.1711673736572266
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.0733954906463623
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.0187568664550781
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1528477
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2573885917663574
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.283 Vali Acc: 0.250 Test Loss: 2.283 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 1.0394151210784912
Epoch: 2, Steps: 7 | Train Loss: 1.961 Vali Loss: 1.524 Vali Acc: 0.750 Test Loss: 1.524 Test Acc: 0.750
Validation loss decreased (-0.249977 --> -0.749985).  Saving model ...
Epoch: 3 cost time: 0.7963910102844238
Epoch: 3, Steps: 7 | Train Loss: 1.047 Vali Loss: 0.862 Vali Acc: 0.875 Test Loss: 0.862 Test Acc: 0.875
Validation loss decreased (-0.749985 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 1.0854697227478027
Epoch: 4, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.517 Vali Acc: 0.903 Test Loss: 0.517 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 1.1360738277435303
Epoch: 5, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.255366325378418
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9933323860168457
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.143014669418335
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.1446080207824707
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0047175884246826
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8938381671905518
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7037384510040283
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7530167102813721
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.998314380645752
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0826892852783203
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.870689868927002
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8911972045898438
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0251717567443848
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.099306583404541
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1532102
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.714020013809204
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.330 Vali Acc: 0.333 Test Loss: 2.330 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 0.7337210178375244
Epoch: 2, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.589 Vali Acc: 0.681 Test Loss: 1.589 Test Acc: 0.681
Validation loss decreased (-0.333310 --> -0.680540).  Saving model ...
Epoch: 3 cost time: 0.8770580291748047
Epoch: 3, Steps: 7 | Train Loss: 1.055 Vali Loss: 0.885 Vali Acc: 0.917 Test Loss: 0.885 Test Acc: 0.917
Validation loss decreased (-0.680540 --> -0.916658).  Saving model ...
Epoch: 4 cost time: 0.9466023445129395
Epoch: 4, Steps: 7 | Train Loss: 0.417 Vali Loss: 0.546 Vali Acc: 0.903 Test Loss: 0.546 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1554195880889893
Epoch: 5, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.061434030532837
Epoch: 6, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9392862319946289
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9944512844085693
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0162353515625
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0311002731323242
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9479796886444092
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1119718551635742
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7401149272918701
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916658 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.9816374778747559
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9579687118530273
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0266594886779785
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.141357183456421
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1183137893676758
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8816697597503662
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.061701774597168
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.715653657913208
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.118915319442749
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0600016117095947
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_LightTS_UEA_ftM_sl1197_ll0_pl0_dm32_cs57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1528549
model size : 5.84MB
