Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5799992084503174
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.632 Vali Acc: 0.712 Test Loss: 0.632 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.8613011837005615
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.617 Vali Acc: 0.761 Test Loss: 0.617 Test Acc: 0.761
Validation loss decreased (-0.712189 --> -0.760969).  Saving model ...
Epoch: 3 cost time: 0.8024349212646484
Epoch: 3, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9890954494476318
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.758 Vali Acc: 0.766 Test Loss: 0.758 Test Acc: 0.766
Validation loss decreased (-0.760969 --> -0.765846).  Saving model ...
Epoch: 5 cost time: 1.0517001152038574
Epoch: 5, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.717 Vali Acc: 0.746 Test Loss: 0.717 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8952395915985107
Epoch: 6, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.753 Vali Acc: 0.693 Test Loss: 0.753 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8254454135894775
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.816 Vali Acc: 0.727 Test Loss: 0.816 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.970921516418457
Epoch: 8, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.926 Vali Acc: 0.751 Test Loss: 0.926 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9190623760223389
Epoch: 9, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.926 Vali Acc: 0.737 Test Loss: 0.926 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1400020122528076
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.997 Vali Acc: 0.712 Test Loss: 0.997 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9394829273223877
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.040 Vali Acc: 0.688 Test Loss: 1.040 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8584709167480469
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.220 Vali Acc: 0.712 Test Loss: 1.220 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0875153541564941
Epoch: 13, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.484 Vali Acc: 0.751 Test Loss: 1.484 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.91117262840271
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.303 Vali Acc: 0.693 Test Loss: 1.303 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 395540
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7827234268188477
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.8965284824371338
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 0.9404911994934082
Epoch: 3, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.630 Vali Acc: 0.766 Test Loss: 0.630 Test Acc: 0.766
Validation loss decreased (-0.726823 --> -0.765847).  Saving model ...
Epoch: 4 cost time: 1.0825932025909424
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.655 Vali Acc: 0.751 Test Loss: 0.655 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9128646850585938
Epoch: 5, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0617146492004395
Epoch: 6, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0017824172973633
Epoch: 7, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.820 Vali Acc: 0.732 Test Loss: 0.820 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1301054954528809
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.952 Vali Acc: 0.751 Test Loss: 0.952 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1550793647766113
Epoch: 9, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.067 Vali Acc: 0.751 Test Loss: 1.067 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.044708490371704
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.990 Vali Acc: 0.737 Test Loss: 0.990 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9749081134796143
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.939 Vali Acc: 0.688 Test Loss: 0.939 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.027590274810791
Epoch: 12, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.025 Vali Acc: 0.673 Test Loss: 1.025 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1031529903411865
Epoch: 13, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.227 Vali Acc: 0.722 Test Loss: 1.227 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 377741
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs102_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.168020009994507
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0171246528625488
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.044842004776001
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 0.9181835651397705
Epoch: 4, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2066476345062256
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.754 Vali Acc: 0.761 Test Loss: 0.754 Test Acc: 0.761
Validation loss decreased (-0.746335 --> -0.760968).  Saving model ...
Epoch: 6 cost time: 1.199418306350708
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.717 Vali Acc: 0.746 Test Loss: 0.717 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2131640911102295
Epoch: 7, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.888 Vali Acc: 0.766 Test Loss: 0.888 Test Acc: 0.766
Validation loss decreased (-0.760968 --> -0.765845).  Saving model ...
Epoch: 8 cost time: 1.2230103015899658
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.839 Vali Acc: 0.727 Test Loss: 0.839 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1097354888916016
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.915 Vali Acc: 0.732 Test Loss: 0.915 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.069688320159912
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.999 Vali Acc: 0.702 Test Loss: 0.999 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9784090518951416
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.152 Vali Acc: 0.751 Test Loss: 1.152 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0910110473632812
Epoch: 12, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.176 Vali Acc: 0.707 Test Loss: 1.176 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2133862972259521
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.192 Vali Acc: 0.727 Test Loss: 1.192 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0426173210144043
Epoch: 14, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.481 Vali Acc: 0.746 Test Loss: 1.481 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.066753625869751
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.368 Vali Acc: 0.722 Test Loss: 1.368 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.21756911277771
Epoch: 16, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.532 Vali Acc: 0.746 Test Loss: 1.532 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1924219131469727
Epoch: 17, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.322 Vali Acc: 0.610 Test Loss: 1.322 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs102_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 370526
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1183969974517822
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.627 Vali Acc: 0.707 Test Loss: 0.627 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.1532659530639648
Epoch: 2, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (-0.707311 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.0308887958526611
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.896364688873291
Epoch: 4, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.611 Vali Acc: 0.751 Test Loss: 0.611 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9403388500213623
Epoch: 5, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.696 Vali Acc: 0.756 Test Loss: 0.696 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3806426525115967
Epoch: 6, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.769 Vali Acc: 0.766 Test Loss: 0.769 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765846).  Saving model ...
Epoch: 7 cost time: 1.1907546520233154
Epoch: 7, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.801 Vali Acc: 0.741 Test Loss: 0.801 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3080482482910156
Epoch: 8, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.870 Vali Acc: 0.746 Test Loss: 0.870 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1422410011291504
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.923 Vali Acc: 0.707 Test Loss: 0.923 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1292991638183594
Epoch: 10, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.927 Vali Acc: 0.673 Test Loss: 0.927 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9876003265380859
Epoch: 11, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.160 Vali Acc: 0.732 Test Loss: 1.160 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.082350730895996
Epoch: 12, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.232 Vali Acc: 0.722 Test Loss: 1.232 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3158166408538818
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.227 Vali Acc: 0.698 Test Loss: 1.227 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4346678256988525
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.259 Vali Acc: 0.659 Test Loss: 1.259 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0596685409545898
Epoch: 15, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.419 Vali Acc: 0.683 Test Loss: 1.419 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2468183040618896
Epoch: 16, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.606 Vali Acc: 0.707 Test Loss: 1.606 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 363957
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.772905111312866
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.9852809906005859
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.706 Vali Acc: 0.741 Test Loss: 0.706 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741456).  Saving model ...
Epoch: 3 cost time: 0.9537811279296875
Epoch: 3, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.599 Vali Acc: 0.751 Test Loss: 0.599 Test Acc: 0.751
Validation loss decreased (-0.741456 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.9021215438842773
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1040046215057373
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0038552284240723
Epoch: 6, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.738 Vali Acc: 0.741 Test Loss: 0.738 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8524975776672363
Epoch: 7, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.766 Vali Acc: 0.746 Test Loss: 0.766 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8897600173950195
Epoch: 8, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.195 Vali Acc: 0.741 Test Loss: 1.195 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8393106460571289
Epoch: 9, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.880 Vali Acc: 0.712 Test Loss: 0.880 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9647922515869141
Epoch: 10, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.968 Vali Acc: 0.727 Test Loss: 0.968 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3780841827392578
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.967 Vali Acc: 0.659 Test Loss: 0.967 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3438310623168945
Epoch: 12, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.299 Vali Acc: 0.741 Test Loss: 1.299 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.139643907546997
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.199 Vali Acc: 0.717 Test Loss: 1.199 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 361870
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1012496948242188
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.625 Vali Acc: 0.707 Test Loss: 0.625 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 0.9767587184906006
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
Validation loss decreased (-0.707311 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 1.0312151908874512
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.624 Vali Acc: 0.756 Test Loss: 0.624 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 1.284177303314209
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.683 Vali Acc: 0.732 Test Loss: 0.683 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0963406562805176
Epoch: 5, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.705 Vali Acc: 0.741 Test Loss: 0.705 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0607385635375977
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.929 Vali Acc: 0.741 Test Loss: 0.929 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0351669788360596
Epoch: 7, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.786 Vali Acc: 0.737 Test Loss: 0.786 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2507612705230713
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.833 Vali Acc: 0.727 Test Loss: 0.833 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0410373210906982
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.952 Vali Acc: 0.722 Test Loss: 0.952 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1928315162658691
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.044 Vali Acc: 0.732 Test Loss: 1.044 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2558574676513672
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.028 Vali Acc: 0.717 Test Loss: 1.028 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0586907863616943
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.022 Vali Acc: 0.673 Test Loss: 1.022 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.040330410003662
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.226 Vali Acc: 0.707 Test Loss: 1.226 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 358530
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8545026779174805
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.633 Vali Acc: 0.712 Test Loss: 0.633 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.7361104488372803
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 0.9788289070129395
Epoch: 3, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.711 Vali Acc: 0.741 Test Loss: 0.711 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741456).  Saving model ...
Epoch: 4 cost time: 0.8932006359100342
Epoch: 4, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.656 Vali Acc: 0.732 Test Loss: 0.656 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2654733657836914
Epoch: 5, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.729 Vali Acc: 0.746 Test Loss: 0.729 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746334).  Saving model ...
Epoch: 6 cost time: 1.0490772724151611
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.786 Vali Acc: 0.751 Test Loss: 0.786 Test Acc: 0.751
Validation loss decreased (-0.746334 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 0.8849542140960693
Epoch: 7, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.760 Vali Acc: 0.659 Test Loss: 0.760 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0750408172607422
Epoch: 8, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.919 Vali Acc: 0.727 Test Loss: 0.919 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9156780242919922
Epoch: 9, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.118 Vali Acc: 0.722 Test Loss: 1.118 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9909121990203857
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.020 Vali Acc: 0.707 Test Loss: 1.020 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.133331298828125
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.191 Vali Acc: 0.727 Test Loss: 1.191 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9722411632537842
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.143 Vali Acc: 0.663 Test Loss: 1.143 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8230633735656738
Epoch: 13, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.324 Vali Acc: 0.702 Test Loss: 1.324 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.85984206199646
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.312 Vali Acc: 0.649 Test Loss: 1.312 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9308183193206787
Epoch: 15, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.534 Vali Acc: 0.673 Test Loss: 1.534 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8827970027923584
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.631 Vali Acc: 0.683 Test Loss: 1.631 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 357582
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5590662956237793
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 0.9621853828430176
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.559 Vali Acc: 0.732 Test Loss: 0.559 Test Acc: 0.732
Validation loss decreased (-0.721944 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.7606048583984375
Epoch: 3, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760969).  Saving model ...
Epoch: 4 cost time: 0.8636291027069092
Epoch: 4, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.648 Vali Acc: 0.761 Test Loss: 0.648 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8368198871612549
Epoch: 5, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.822 Vali Acc: 0.746 Test Loss: 0.822 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0242884159088135
Epoch: 6, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.652 Vali Acc: 0.712 Test Loss: 0.652 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.041553020477295
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.802 Vali Acc: 0.751 Test Loss: 0.802 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9476890563964844
Epoch: 8, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.146 Vali Acc: 0.751 Test Loss: 1.146 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8503594398498535
Epoch: 9, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.822 Vali Acc: 0.673 Test Loss: 0.822 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8476555347442627
Epoch: 10, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.003 Vali Acc: 0.732 Test Loss: 1.003 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9132146835327148
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.096 Vali Acc: 0.727 Test Loss: 1.096 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1758110523223877
Epoch: 12, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.050 Vali Acc: 0.707 Test Loss: 1.050 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1352715492248535
Epoch: 13, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.206 Vali Acc: 0.712 Test Loss: 1.206 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 354869
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.810042381286621
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0458576679229736
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.1593706607818604
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.610 Vali Acc: 0.746 Test Loss: 0.610 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.136988878250122
Epoch: 4, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0734333992004395
Epoch: 5, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9529585838317871
Epoch: 6, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.778 Vali Acc: 0.746 Test Loss: 0.778 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8837976455688477
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1136786937713623
Epoch: 8, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.954 Vali Acc: 0.727 Test Loss: 0.954 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8301613330841064
Epoch: 9, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.067 Vali Acc: 0.741 Test Loss: 1.067 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1584296226501465
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.021 Vali Acc: 0.698 Test Loss: 1.021 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8512470722198486
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.034 Vali Acc: 0.678 Test Loss: 1.034 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.023665189743042
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.176 Vali Acc: 0.712 Test Loss: 1.176 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9375717639923096
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.412 Vali Acc: 0.737 Test Loss: 1.412 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 355912
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2118356227874756
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.661 Vali Acc: 0.712 Test Loss: 0.661 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.934180498123169
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 0.9424896240234375
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
Validation loss decreased (-0.731701 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 0.9543399810791016
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.649 Vali Acc: 0.751 Test Loss: 0.649 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9737207889556885
Epoch: 5, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.063708782196045
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.735 Vali Acc: 0.688 Test Loss: 0.735 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7994949817657471
Epoch: 7, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.956 Vali Acc: 0.746 Test Loss: 0.956 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0824689865112305
Epoch: 8, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.006 Vali Acc: 0.741 Test Loss: 1.006 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1566112041473389
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.922 Vali Acc: 0.683 Test Loss: 0.922 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9939596652984619
Epoch: 10, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.213 Vali Acc: 0.737 Test Loss: 1.213 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0124735832214355
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.067 Vali Acc: 0.673 Test Loss: 1.067 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8610296249389648
Epoch: 12, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.129 Vali Acc: 0.678 Test Loss: 1.129 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9463050365447998
Epoch: 13, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.231 Vali Acc: 0.702 Test Loss: 1.231 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 353719
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.705493450164795
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.651 Vali Acc: 0.712 Test Loss: 0.651 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0515565872192383
Epoch: 2, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.4147131443023682
Epoch: 3, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.194425344467163
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.030236005783081
Epoch: 5, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0225303173065186
Epoch: 6, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.793 Vali Acc: 0.737 Test Loss: 0.793 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0190844535827637
Epoch: 7, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.791 Vali Acc: 0.727 Test Loss: 0.791 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0030529499053955
Epoch: 8, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.866 Vali Acc: 0.751 Test Loss: 0.866 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751211).  Saving model ...
Epoch: 9 cost time: 1.0252320766448975
Epoch: 9, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.975 Vali Acc: 0.737 Test Loss: 0.975 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1150736808776855
Epoch: 10, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.043 Vali Acc: 0.732 Test Loss: 1.043 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0140836238861084
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.100 Vali Acc: 0.707 Test Loss: 1.100 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0237982273101807
Epoch: 12, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.532 Vali Acc: 0.771 Test Loss: 1.532 Test Acc: 0.771
Validation loss decreased (-0.751211 --> -0.770716).  Saving model ...
Epoch: 13 cost time: 1.0859458446502686
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.384 Vali Acc: 0.722 Test Loss: 1.384 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1576275825500488
Epoch: 14, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.365 Vali Acc: 0.649 Test Loss: 1.365 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.131277322769165
Epoch: 15, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.636 Vali Acc: 0.688 Test Loss: 1.636 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.191835880279541
Epoch: 16, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.757 Vali Acc: 0.688 Test Loss: 1.757 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0955250263214111
Epoch: 17, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.882 Vali Acc: 0.678 Test Loss: 1.882 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9751038551330566
Epoch: 18, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.032 Vali Acc: 0.693 Test Loss: 2.032 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1815214157104492
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.107 Vali Acc: 0.673 Test Loss: 2.107 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0569207668304443
Epoch: 20, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.235 Vali Acc: 0.683 Test Loss: 2.235 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9152078628540039
Epoch: 21, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.361 Vali Acc: 0.693 Test Loss: 2.361 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2886011600494385
Epoch: 22, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.410 Vali Acc: 0.688 Test Loss: 2.410 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 353406
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0468831062316895
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.712 Vali Acc: 0.712 Test Loss: 0.712 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 0.9765088558197021
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.603 Vali Acc: 0.732 Test Loss: 0.603 Test Acc: 0.732
Validation loss decreased (-0.712188 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.1246225833892822
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.684 Vali Acc: 0.727 Test Loss: 0.684 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.215268850326538
Epoch: 4, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.667 Vali Acc: 0.732 Test Loss: 0.667 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0141983032226562
Epoch: 5, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.710 Vali Acc: 0.737 Test Loss: 0.710 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736578).  Saving model ...
Epoch: 6 cost time: 1.1036067008972168
Epoch: 6, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.775 Vali Acc: 0.737 Test Loss: 0.775 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0638015270233154
Epoch: 7, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.910 Vali Acc: 0.737 Test Loss: 0.910 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9656531810760498
Epoch: 8, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.220 Vali Acc: 0.732 Test Loss: 1.220 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0360767841339111
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.039 Vali Acc: 0.732 Test Loss: 1.039 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0083022117614746
Epoch: 10, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.035 Vali Acc: 0.683 Test Loss: 1.035 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9084916114807129
Epoch: 11, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.136 Vali Acc: 0.707 Test Loss: 1.136 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0510497093200684
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.244 Vali Acc: 0.707 Test Loss: 1.244 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0252406597137451
Epoch: 13, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.359 Vali Acc: 0.702 Test Loss: 1.359 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0041608810424805
Epoch: 14, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.359 Vali Acc: 0.698 Test Loss: 1.359 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0140352249145508
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.456 Vali Acc: 0.698 Test Loss: 1.456 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 356188
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.777646541595459
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.923851728439331
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9600143432617188
Epoch: 3, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.612 Vali Acc: 0.766 Test Loss: 0.612 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.148911952972412
Epoch: 4, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9373712539672852
Epoch: 5, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.202366828918457
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.705 Vali Acc: 0.717 Test Loss: 0.705 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0603852272033691
Epoch: 7, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.900 Vali Acc: 0.746 Test Loss: 0.900 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9247028827667236
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.839 Vali Acc: 0.698 Test Loss: 0.839 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.065596103668213
Epoch: 9, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.863 Vali Acc: 0.654 Test Loss: 0.863 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.21872878074646
Epoch: 10, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.011 Vali Acc: 0.707 Test Loss: 1.011 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9116926193237305
Epoch: 11, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.112 Vali Acc: 0.722 Test Loss: 1.112 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4950900077819824
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.205 Vali Acc: 0.722 Test Loss: 1.205 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1651537418365479
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.104 Vali Acc: 0.663 Test Loss: 1.104 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 351428
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6543312072753906
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.699 Vali Acc: 0.722 Test Loss: 0.699 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 0.8071155548095703
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.2066617012023926
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.604 Vali Acc: 0.771 Test Loss: 0.604 Test Acc: 0.771
Validation loss decreased (-0.721945 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 0.8119466304779053
Epoch: 4, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.633 Vali Acc: 0.751 Test Loss: 0.633 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.071258544921875
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.654 Vali Acc: 0.707 Test Loss: 0.654 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.054917573928833
Epoch: 6, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.727 Vali Acc: 0.732 Test Loss: 0.727 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.971898078918457
Epoch: 7, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.816 Vali Acc: 0.732 Test Loss: 0.816 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.447995662689209
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.864 Vali Acc: 0.717 Test Loss: 0.864 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1038117408752441
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.876 Vali Acc: 0.644 Test Loss: 0.876 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1887197494506836
Epoch: 10, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.274 Vali Acc: 0.722 Test Loss: 1.274 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2720577716827393
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.047 Vali Acc: 0.702 Test Loss: 1.047 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1395237445831299
Epoch: 12, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.964 Vali Acc: 0.644 Test Loss: 0.964 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0489180088043213
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.096 Vali Acc: 0.702 Test Loss: 1.096 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 350573
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.348665952682495
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.670 Vali Acc: 0.732 Test Loss: 0.670 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.1879732608795166
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.3101606369018555
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.611 Vali Acc: 0.741 Test Loss: 0.611 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 0.8598122596740723
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 0.8364672660827637
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.653 Vali Acc: 0.741 Test Loss: 0.653 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8201873302459717
Epoch: 6, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760968).  Saving model ...
Epoch: 7 cost time: 0.9272313117980957
Epoch: 7, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.853 Vali Acc: 0.732 Test Loss: 0.853 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9167261123657227
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.842 Vali Acc: 0.737 Test Loss: 0.842 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9856460094451904
Epoch: 9, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.867 Vali Acc: 0.693 Test Loss: 0.867 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0273821353912354
Epoch: 10, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.991 Vali Acc: 0.712 Test Loss: 0.991 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9390747547149658
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.065 Vali Acc: 0.707 Test Loss: 1.065 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8224802017211914
Epoch: 12, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.169 Vali Acc: 0.698 Test Loss: 1.169 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8649241924285889
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.158 Vali Acc: 0.678 Test Loss: 1.158 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9500460624694824
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.506 Vali Acc: 0.702 Test Loss: 1.506 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.826669454574585
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.113 Vali Acc: 0.688 Test Loss: 1.113 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9120087623596191
Epoch: 16, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.461 Vali Acc: 0.693 Test Loss: 1.461 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 354838
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9702208042144775
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.661 Vali Acc: 0.722 Test Loss: 0.661 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.020437240600586
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.8686332702636719
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760969).  Saving model ...
Epoch: 4 cost time: 1.4872124195098877
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.690 Vali Acc: 0.756 Test Loss: 0.690 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9829976558685303
Epoch: 5, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.809 Vali Acc: 0.751 Test Loss: 0.809 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8880453109741211
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.728 Vali Acc: 0.746 Test Loss: 0.728 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.106151819229126
Epoch: 7, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.901 Vali Acc: 0.771 Test Loss: 0.901 Test Acc: 0.771
Validation loss decreased (-0.760969 --> -0.770723).  Saving model ...
Epoch: 8 cost time: 0.9010305404663086
Epoch: 8, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.981 Vali Acc: 0.751 Test Loss: 0.981 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9651391506195068
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.021 Vali Acc: 0.746 Test Loss: 1.021 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9655551910400391
Epoch: 10, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.106 Vali Acc: 0.741 Test Loss: 1.106 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.897834300994873
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.197 Vali Acc: 0.746 Test Loss: 1.197 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9061708450317383
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.283 Vali Acc: 0.746 Test Loss: 1.283 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.929255485534668
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.147 Vali Acc: 0.727 Test Loss: 1.147 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8552329540252686
Epoch: 14, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.168 Vali Acc: 0.707 Test Loss: 1.168 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7858269214630127
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.153 Vali Acc: 0.707 Test Loss: 1.153 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8496556282043457
Epoch: 16, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.299 Vali Acc: 0.722 Test Loss: 1.299 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.264484167098999
Epoch: 17, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.229 Vali Acc: 0.678 Test Loss: 1.229 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 351156
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1506941318511963
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0765535831451416
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.1114795207977295
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
Validation loss decreased (-0.731701 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.8816773891448975
Epoch: 4, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.601 Vali Acc: 0.756 Test Loss: 0.601 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.891406774520874
Epoch: 5, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.678 Vali Acc: 0.727 Test Loss: 0.678 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8976712226867676
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.724 Vali Acc: 0.732 Test Loss: 0.724 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9195723533630371
Epoch: 7, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.760 Vali Acc: 0.707 Test Loss: 0.760 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0125994682312012
Epoch: 8, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.826 Vali Acc: 0.712 Test Loss: 0.826 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9491629600524902
Epoch: 9, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.081 Vali Acc: 0.746 Test Loss: 1.081 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9028768539428711
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.255 Vali Acc: 0.727 Test Loss: 1.255 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1130211353302002
Epoch: 11, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.875 Vali Acc: 0.683 Test Loss: 0.875 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0198757648468018
Epoch: 12, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.942 Vali Acc: 0.693 Test Loss: 0.942 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0531244277954102
Epoch: 13, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.133 Vali Acc: 0.712 Test Loss: 1.133 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 353404
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8679685592651367
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0317778587341309
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.9028644561767578
Epoch: 3, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.9918842315673828
Epoch: 4, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.594 Vali Acc: 0.766 Test Loss: 0.594 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 0.9286179542541504
Epoch: 5, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.654 Vali Acc: 0.761 Test Loss: 0.654 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1125609874725342
Epoch: 6, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.790 Vali Acc: 0.751 Test Loss: 0.790 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2551977634429932
Epoch: 7, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.814 Vali Acc: 0.756 Test Loss: 0.814 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3677430152893066
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.863 Vali Acc: 0.712 Test Loss: 0.863 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.273939847946167
Epoch: 9, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.979 Vali Acc: 0.756 Test Loss: 0.979 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1733920574188232
Epoch: 10, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.976 Vali Acc: 0.707 Test Loss: 0.976 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.904536247253418
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.089 Vali Acc: 0.698 Test Loss: 1.089 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0321590900421143
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.146 Vali Acc: 0.712 Test Loss: 1.146 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3903992176055908
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.346 Vali Acc: 0.746 Test Loss: 1.346 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0828499794006348
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.067 Vali Acc: 0.702 Test Loss: 1.067 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 354846
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6372458934783936
Epoch: 1, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.699 Vali Acc: 0.722 Test Loss: 0.699 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.1882879734039307
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
Validation loss decreased (-0.721944 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.0219638347625732
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.0063860416412354
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.638 Vali Acc: 0.746 Test Loss: 0.638 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8003334999084473
Epoch: 5, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.686 Vali Acc: 0.751 Test Loss: 0.686 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9263317584991455
Epoch: 6, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.768 Vali Acc: 0.741 Test Loss: 0.768 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8012499809265137
Epoch: 7, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.937 Vali Acc: 0.737 Test Loss: 0.937 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8075644969940186
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.816 Vali Acc: 0.722 Test Loss: 0.816 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7675752639770508
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.994 Vali Acc: 0.732 Test Loss: 0.994 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8459594249725342
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.185 Vali Acc: 0.741 Test Loss: 1.185 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7662482261657715
Epoch: 11, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.139 Vali Acc: 0.727 Test Loss: 1.139 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9321110248565674
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.190 Vali Acc: 0.712 Test Loss: 1.190 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9485082626342773
Epoch: 13, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.154 Vali Acc: 0.654 Test Loss: 1.154 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 355482
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.742295026779175
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0492608547210693
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 0.928015947341919
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.624 Vali Acc: 0.761 Test Loss: 0.624 Test Acc: 0.761
Validation loss decreased (-0.736579 --> -0.760969).  Saving model ...
Epoch: 4 cost time: 1.0229003429412842
Epoch: 4, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.617 Vali Acc: 0.737 Test Loss: 0.617 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9598085880279541
Epoch: 5, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.706 Vali Acc: 0.732 Test Loss: 0.706 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0106127262115479
Epoch: 6, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.725 Vali Acc: 0.722 Test Loss: 0.725 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9083971977233887
Epoch: 7, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.866 Vali Acc: 0.732 Test Loss: 0.866 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0515570640563965
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8596525192260742
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.877 Vali Acc: 0.688 Test Loss: 0.877 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9372491836547852
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.992 Vali Acc: 0.707 Test Loss: 0.992 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9209120273590088
Epoch: 11, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.507 Vali Acc: 0.737 Test Loss: 1.507 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0832631587982178
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.047 Vali Acc: 0.654 Test Loss: 1.047 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0710625648498535
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.357 Vali Acc: 0.732 Test Loss: 1.357 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm512_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 355312
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8977835178375244
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3222005367279053
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.604 Vali Acc: 0.741 Test Loss: 0.604 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.0928642749786377
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.601 Vali Acc: 0.746 Test Loss: 0.601 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 0.8131284713745117
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.720 Vali Acc: 0.756 Test Loss: 0.720 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756090).  Saving model ...
Epoch: 5 cost time: 1.022129774093628
Epoch: 5, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1834561824798584
Epoch: 6, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.819 Vali Acc: 0.751 Test Loss: 0.819 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2269933223724365
Epoch: 7, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.843 Vali Acc: 0.751 Test Loss: 0.843 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1544005870819092
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.885 Vali Acc: 0.727 Test Loss: 0.885 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1834805011749268
Epoch: 9, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.924 Vali Acc: 0.673 Test Loss: 0.924 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.067291259765625
Epoch: 10, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.992 Vali Acc: 0.702 Test Loss: 0.992 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0327708721160889
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.122 Vali Acc: 0.717 Test Loss: 1.122 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0505704879760742
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.332 Vali Acc: 0.751 Test Loss: 1.332 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0710439682006836
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.301 Vali Acc: 0.717 Test Loss: 1.301 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1088666915893555
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.446 Vali Acc: 0.741 Test Loss: 1.446 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 282420
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8463287353515625
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.1033670902252197
Epoch: 2, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.9391191005706787
Epoch: 3, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 1.3769214153289795
Epoch: 4, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9256727695465088
Epoch: 5, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.823 Vali Acc: 0.737 Test Loss: 0.823 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9489285945892334
Epoch: 6, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.752 Vali Acc: 0.756 Test Loss: 0.752 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9993546009063721
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.682 Vali Acc: 0.629 Test Loss: 0.682 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0771465301513672
Epoch: 8, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.795 Vali Acc: 0.741 Test Loss: 0.795 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1315531730651855
Epoch: 9, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.853 Vali Acc: 0.741 Test Loss: 0.853 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0319838523864746
Epoch: 10, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.948 Vali Acc: 0.737 Test Loss: 0.948 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0995757579803467
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.033 Vali Acc: 0.732 Test Loss: 1.033 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0499389171600342
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.095 Vali Acc: 0.732 Test Loss: 1.095 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9587728977203369
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.133 Vali Acc: 0.722 Test Loss: 1.133 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 273325
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs102_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.496236562728882
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.652 Vali Acc: 0.707 Test Loss: 0.652 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 0.9233951568603516
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.578 Vali Acc: 0.751 Test Loss: 0.578 Test Acc: 0.751
Validation loss decreased (-0.707311 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 0.8539047241210938
Epoch: 3, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9718499183654785
Epoch: 4, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.267521619796753
Epoch: 5, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.750 Vali Acc: 0.741 Test Loss: 0.750 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0262451171875
Epoch: 6, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.739 Vali Acc: 0.727 Test Loss: 0.739 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.953768253326416
Epoch: 7, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.708 Vali Acc: 0.668 Test Loss: 0.708 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0730900764465332
Epoch: 8, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.767 Vali Acc: 0.712 Test Loss: 0.767 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1485531330108643
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.964 Vali Acc: 0.737 Test Loss: 0.964 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1766119003295898
Epoch: 10, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.044 Vali Acc: 0.746 Test Loss: 1.044 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0702857971191406
Epoch: 11, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.943 Vali Acc: 0.673 Test Loss: 0.943 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.280043125152588
Epoch: 12, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.068 Vali Acc: 0.702 Test Loss: 1.068 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs102_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 270334
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6764204502105713
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0387656688690186
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.0169312953948975
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
Validation loss decreased (-0.731701 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 1.137578010559082
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9937422275543213
Epoch: 5, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.663 Vali Acc: 0.722 Test Loss: 0.663 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.024620532989502
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8138015270233154
Epoch: 7, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.742 Vali Acc: 0.707 Test Loss: 0.742 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.02486252784729
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.911 Vali Acc: 0.746 Test Loss: 0.911 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.044780969619751
Epoch: 9, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.917 Vali Acc: 0.741 Test Loss: 0.917 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.192577600479126
Epoch: 10, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.803 Vali Acc: 0.678 Test Loss: 0.803 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9061031341552734
Epoch: 11, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.068 Vali Acc: 0.746 Test Loss: 1.068 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1765203475952148
Epoch: 12, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.093 Vali Acc: 0.737 Test Loss: 1.093 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9822559356689453
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.113 Vali Acc: 0.717 Test Loss: 1.113 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 266453
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0804309844970703
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 1.0257458686828613
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
Validation loss decreased (-0.717066 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 0.8587508201599121
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.040731430053711
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.600 Vali Acc: 0.702 Test Loss: 0.600 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.008575677871704
Epoch: 5, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756091).  Saving model ...
Epoch: 6 cost time: 1.3883485794067383
Epoch: 6, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.874 Vali Acc: 0.741 Test Loss: 0.874 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2791414260864258
Epoch: 7, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.695 Vali Acc: 0.693 Test Loss: 0.695 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.032944679260254
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.800 Vali Acc: 0.732 Test Loss: 0.800 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.049696445465088
Epoch: 9, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.130 Vali Acc: 0.732 Test Loss: 1.130 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0037367343902588
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.979 Vali Acc: 0.732 Test Loss: 0.979 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1908798217773438
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.982 Vali Acc: 0.698 Test Loss: 0.982 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9420902729034424
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.247 Vali Acc: 0.732 Test Loss: 1.247 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9141020774841309
Epoch: 13, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.119 Vali Acc: 0.698 Test Loss: 1.119 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0016286373138428
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.199 Vali Acc: 0.707 Test Loss: 1.199 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9512450695037842
Epoch: 15, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.204 Vali Acc: 0.702 Test Loss: 1.204 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 266030
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.452239751815796
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2125623226165771
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.08250093460083
Epoch: 3, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 0.8432350158691406
Epoch: 4, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
Validation loss decreased (-0.751213 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 0.9836905002593994
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.637 Vali Acc: 0.761 Test Loss: 0.637 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9604499340057373
Epoch: 6, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.774 Vali Acc: 0.751 Test Loss: 0.774 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0807900428771973
Epoch: 7, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.799 Vali Acc: 0.707 Test Loss: 0.799 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.150047779083252
Epoch: 8, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.835 Vali Acc: 0.746 Test Loss: 0.835 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.009941577911377
Epoch: 9, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.200 Vali Acc: 0.766 Test Loss: 1.200 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765842).  Saving model ...
Epoch: 10 cost time: 1.0864272117614746
Epoch: 10, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.934 Vali Acc: 0.727 Test Loss: 0.934 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1417701244354248
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.932 Vali Acc: 0.707 Test Loss: 0.932 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8918571472167969
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.026 Vali Acc: 0.707 Test Loss: 1.026 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0890214443206787
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.335 Vali Acc: 0.756 Test Loss: 1.335 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2245640754699707
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.090 Vali Acc: 0.688 Test Loss: 1.090 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2938127517700195
Epoch: 15, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.233 Vali Acc: 0.707 Test Loss: 1.233 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4689366817474365
Epoch: 16, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.345 Vali Acc: 0.722 Test Loss: 1.345 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0527598857879639
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.246 Vali Acc: 0.712 Test Loss: 1.246 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.255481481552124
Epoch: 18, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.410 Vali Acc: 0.712 Test Loss: 1.410 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9329812526702881
Epoch: 19, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.809 Vali Acc: 0.751 Test Loss: 1.809 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 263970
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.471895217895508
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.738 Vali Acc: 0.722 Test Loss: 0.738 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.1017754077911377
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
Validation loss decreased (-0.721944 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 0.8168492317199707
Epoch: 3, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0102746486663818
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.588 Vali Acc: 0.751 Test Loss: 0.588 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 0.9055206775665283
Epoch: 5, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.653 Vali Acc: 0.751 Test Loss: 0.653 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8101704120635986
Epoch: 6, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.786 Vali Acc: 0.737 Test Loss: 0.786 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8204855918884277
Epoch: 7, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.891 Vali Acc: 0.741 Test Loss: 0.891 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9845457077026367
Epoch: 8, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.828 Vali Acc: 0.654 Test Loss: 0.828 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7583310604095459
Epoch: 9, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.843 Vali Acc: 0.693 Test Loss: 0.843 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8553116321563721
Epoch: 10, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.959 Vali Acc: 0.707 Test Loss: 0.959 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8843729496002197
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.017 Vali Acc: 0.702 Test Loss: 1.017 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9209072589874268
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.134 Vali Acc: 0.712 Test Loss: 1.134 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0865023136138916
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.149 Vali Acc: 0.698 Test Loss: 1.149 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1156795024871826
Epoch: 14, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.078 Vali Acc: 0.688 Test Loss: 1.078 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 263918
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.839266538619995
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 0.9615938663482666
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.717066 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 0.9199111461639404
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.610 Vali Acc: 0.766 Test Loss: 0.610 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 0.8107976913452148
Epoch: 4, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.687 Vali Acc: 0.756 Test Loss: 0.687 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9373772144317627
Epoch: 5, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.695 Vali Acc: 0.746 Test Loss: 0.695 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8833041191101074
Epoch: 6, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.711 Vali Acc: 0.688 Test Loss: 0.711 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.919935941696167
Epoch: 7, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.761 Vali Acc: 0.707 Test Loss: 0.761 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.978095531463623
Epoch: 8, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.924 Vali Acc: 0.751 Test Loss: 0.924 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9712381362915039
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.851 Vali Acc: 0.702 Test Loss: 0.851 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8929040431976318
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.900 Vali Acc: 0.702 Test Loss: 0.900 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.109334945678711
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.342 Vali Acc: 0.756 Test Loss: 1.342 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0270287990570068
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.011 Vali Acc: 0.698 Test Loss: 1.011 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8158838748931885
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.032 Vali Acc: 0.678 Test Loss: 1.032 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 261973
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2520878314971924
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.625 Vali Acc: 0.707 Test Loss: 0.625 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 0.8546547889709473
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
Validation loss decreased (-0.707311 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.8261077404022217
Epoch: 3, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.0670011043548584
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.602 Vali Acc: 0.751 Test Loss: 0.602 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0555894374847412
Epoch: 5, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.670 Vali Acc: 0.766 Test Loss: 0.670 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 6 cost time: 1.1407980918884277
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.716 Vali Acc: 0.751 Test Loss: 0.716 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9744150638580322
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.705 Vali Acc: 0.693 Test Loss: 0.705 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1848499774932861
Epoch: 8, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.847 Vali Acc: 0.741 Test Loss: 0.847 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0092005729675293
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.169 Vali Acc: 0.746 Test Loss: 1.169 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9981379508972168
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.972 Vali Acc: 0.746 Test Loss: 0.972 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1571698188781738
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.942 Vali Acc: 0.732 Test Loss: 0.942 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0377190113067627
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.016 Vali Acc: 0.722 Test Loss: 1.016 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9917998313903809
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.910 Vali Acc: 0.683 Test Loss: 0.910 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9703927040100098
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.068 Vali Acc: 0.727 Test Loss: 1.068 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9765384197235107
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.473 Vali Acc: 0.751 Test Loss: 1.473 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 263528
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0574700832366943
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0761747360229492
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.563 Vali Acc: 0.746 Test Loss: 0.563 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.955920934677124
Epoch: 3, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 0.8544859886169434
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.575 Vali Acc: 0.741 Test Loss: 0.575 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7751433849334717
Epoch: 5, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1851565837860107
Epoch: 6, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.782 Vali Acc: 0.737 Test Loss: 0.782 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8064384460449219
Epoch: 7, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.812 Vali Acc: 0.751 Test Loss: 0.812 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7635555267333984
Epoch: 8, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.925 Vali Acc: 0.746 Test Loss: 0.925 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0401461124420166
Epoch: 9, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.917 Vali Acc: 0.732 Test Loss: 0.917 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.024092197418213
Epoch: 10, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.239 Vali Acc: 0.746 Test Loss: 1.239 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9496817588806152
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.069 Vali Acc: 0.712 Test Loss: 1.069 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0062103271484375
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.036 Vali Acc: 0.698 Test Loss: 1.036 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8637700080871582
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.021 Vali Acc: 0.698 Test Loss: 1.021 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 261847
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7425336837768555
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.0383920669555664
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 0.9763801097869873
Epoch: 3, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.639 Vali Acc: 0.756 Test Loss: 0.639 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 0.870873212814331
Epoch: 4, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.640 Vali Acc: 0.761 Test Loss: 0.640 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760969).  Saving model ...
Epoch: 5 cost time: 1.1073801517486572
Epoch: 5, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.646 Vali Acc: 0.741 Test Loss: 0.646 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9573493003845215
Epoch: 6, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0527665615081787
Epoch: 7, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.750 Vali Acc: 0.746 Test Loss: 0.750 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0352957248687744
Epoch: 8, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.831 Vali Acc: 0.746 Test Loss: 0.831 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9803726673126221
Epoch: 9, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.924 Vali Acc: 0.746 Test Loss: 0.924 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9716992378234863
Epoch: 10, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.918 Vali Acc: 0.712 Test Loss: 0.918 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9797356128692627
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.000 Vali Acc: 0.717 Test Loss: 1.000 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9647653102874756
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.194 Vali Acc: 0.746 Test Loss: 1.194 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0475850105285645
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.260 Vali Acc: 0.741 Test Loss: 1.260 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0855939388275146
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.150 Vali Acc: 0.673 Test Loss: 1.150 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 261918
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.960043430328369
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.621 Vali Acc: 0.707 Test Loss: 0.621 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.0227789878845215
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
Validation loss decreased (-0.707311 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.0672810077667236
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.655 Vali Acc: 0.741 Test Loss: 0.655 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 1.0516972541809082
Epoch: 4, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.641 Vali Acc: 0.751 Test Loss: 0.641 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 1.2303671836853027
Epoch: 5, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.209507942199707
Epoch: 6, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.684 Vali Acc: 0.707 Test Loss: 0.684 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1494190692901611
Epoch: 7, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.805 Vali Acc: 0.751 Test Loss: 0.805 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0770535469055176
Epoch: 8, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.825 Vali Acc: 0.746 Test Loss: 0.825 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1286847591400146
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.787 Vali Acc: 0.673 Test Loss: 0.787 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0349376201629639
Epoch: 10, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.146 Vali Acc: 0.751 Test Loss: 1.146 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9624650478363037
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.032 Vali Acc: 0.717 Test Loss: 1.032 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2083253860473633
Epoch: 12, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.985 Vali Acc: 0.693 Test Loss: 0.985 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.15444016456604
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.244 Vali Acc: 0.737 Test Loss: 1.244 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1887025833129883
Epoch: 14, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.223 Vali Acc: 0.712 Test Loss: 1.223 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 264956
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.344935178756714
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8601577281951904
Epoch: 2, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.596 Vali Acc: 0.732 Test Loss: 0.596 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 0.8614587783813477
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.600 Vali Acc: 0.766 Test Loss: 0.600 Test Acc: 0.766
Validation loss decreased (-0.731701 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 0.8871192932128906
Epoch: 4, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.600 Vali Acc: 0.756 Test Loss: 0.600 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8326513767242432
Epoch: 5, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.652 Vali Acc: 0.741 Test Loss: 0.652 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7618629932403564
Epoch: 6, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.739 Vali Acc: 0.751 Test Loss: 0.739 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1699399948120117
Epoch: 7, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1155555248260498
Epoch: 8, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.823 Vali Acc: 0.751 Test Loss: 0.823 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9467923641204834
Epoch: 9, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.000 Vali Acc: 0.732 Test Loss: 1.000 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.244600534439087
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.920 Vali Acc: 0.707 Test Loss: 0.920 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9831323623657227
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.989 Vali Acc: 0.707 Test Loss: 0.989 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8663108348846436
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.000 Vali Acc: 0.722 Test Loss: 1.000 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8822767734527588
Epoch: 13, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.247 Vali Acc: 0.722 Test Loss: 1.247 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 260580
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.936829090118408
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.9628150463104248
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.9636590480804443
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 0.9313435554504395
Epoch: 4, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0375189781188965
Epoch: 5, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2257773876190186
Epoch: 6, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.722 Vali Acc: 0.702 Test Loss: 0.722 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2269833087921143
Epoch: 7, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.797 Vali Acc: 0.732 Test Loss: 0.797 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0352354049682617
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.930 Vali Acc: 0.751 Test Loss: 0.930 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8788700103759766
Epoch: 9, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.899 Vali Acc: 0.741 Test Loss: 0.899 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4320826530456543
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.988 Vali Acc: 0.663 Test Loss: 0.988 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9651823043823242
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.182 Vali Acc: 0.737 Test Loss: 1.182 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1943728923797607
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.170 Vali Acc: 0.712 Test Loss: 1.170 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9992885589599609
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.229 Vali Acc: 0.712 Test Loss: 1.229 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 259981
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.387929677963257
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3006360530853271
Epoch: 2, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.6599583625793457
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.643 Vali Acc: 0.756 Test Loss: 0.643 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 1.1798126697540283
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1598045825958252
Epoch: 5, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1489789485931396
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.760 Vali Acc: 0.751 Test Loss: 0.760 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0864672660827637
Epoch: 7, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.796 Vali Acc: 0.727 Test Loss: 0.796 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3212366104125977
Epoch: 8, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.239549160003662
Epoch: 9, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.951 Vali Acc: 0.727 Test Loss: 0.951 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.401001214981079
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.948 Vali Acc: 0.688 Test Loss: 0.948 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3979525566101074
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.971 Vali Acc: 0.673 Test Loss: 0.971 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3271684646606445
Epoch: 12, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.072 Vali Acc: 0.668 Test Loss: 1.072 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.282196044921875
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.362 Vali Acc: 0.732 Test Loss: 1.362 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 264374
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7023277282714844
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.737 Vali Acc: 0.707 Test Loss: 0.737 Test Acc: 0.707
Validation loss decreased (inf --> -0.707310).  Saving model ...
Epoch: 2 cost time: 1.0922605991363525
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
Validation loss decreased (-0.707310 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 1.1512913703918457
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.673 Vali Acc: 0.741 Test Loss: 0.673 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0736029148101807
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1733977794647217
Epoch: 5, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1091184616088867
Epoch: 6, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9699606895446777
Epoch: 7, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.800 Vali Acc: 0.727 Test Loss: 0.800 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0419251918792725
Epoch: 8, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.792 Vali Acc: 0.737 Test Loss: 0.792 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1282525062561035
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.938 Vali Acc: 0.751 Test Loss: 0.938 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751210).  Saving model ...
Epoch: 10 cost time: 1.1115212440490723
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.147 Vali Acc: 0.737 Test Loss: 1.147 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3637886047363281
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.055 Vali Acc: 0.712 Test Loss: 1.055 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0553548336029053
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.048 Vali Acc: 0.683 Test Loss: 1.048 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0312528610229492
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.104 Vali Acc: 0.698 Test Loss: 1.104 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.167264699935913
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.386 Vali Acc: 0.751 Test Loss: 1.386 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.932321310043335
Epoch: 15, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.399 Vali Acc: 0.727 Test Loss: 1.399 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.172480583190918
Epoch: 16, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.257 Vali Acc: 0.668 Test Loss: 1.257 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3273909091949463
Epoch: 17, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.283 Vali Acc: 0.659 Test Loss: 1.283 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1746852397918701
Epoch: 18, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.418 Vali Acc: 0.722 Test Loss: 1.418 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1984798908233643
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.717 Vali Acc: 0.746 Test Loss: 1.717 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 260948
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4006946086883545
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.626 Vali Acc: 0.707 Test Loss: 0.626 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.3566665649414062
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.594 Vali Acc: 0.761 Test Loss: 0.594 Test Acc: 0.761
Validation loss decreased (-0.707311 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.1307413578033447
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.614 Vali Acc: 0.756 Test Loss: 0.614 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1786794662475586
Epoch: 4, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.723 Vali Acc: 0.741 Test Loss: 0.723 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.359809398651123
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.724 Vali Acc: 0.746 Test Loss: 0.724 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2543625831604004
Epoch: 6, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.784 Vali Acc: 0.751 Test Loss: 0.784 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1996965408325195
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.843 Vali Acc: 0.751 Test Loss: 0.843 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.124276876449585
Epoch: 8, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.021 Vali Acc: 0.737 Test Loss: 1.021 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0078587532043457
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.990 Vali Acc: 0.727 Test Loss: 0.990 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.153822660446167
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.222 Vali Acc: 0.737 Test Loss: 1.222 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.008338451385498
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.019 Vali Acc: 0.707 Test Loss: 1.019 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1272528171539307
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.004 Vali Acc: 0.683 Test Loss: 1.004 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 263324
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.612950563430786
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.673 Vali Acc: 0.717 Test Loss: 0.673 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 1.2106132507324219
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.593 Vali Acc: 0.756 Test Loss: 0.593 Test Acc: 0.756
Validation loss decreased (-0.717066 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2015833854675293
Epoch: 3, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5151822566986084
Epoch: 4, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.673 Vali Acc: 0.751 Test Loss: 0.673 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9701542854309082
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.671 Vali Acc: 0.756 Test Loss: 0.671 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9610857963562012
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.748 Vali Acc: 0.751 Test Loss: 0.748 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1690242290496826
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.775 Vali Acc: 0.707 Test Loss: 0.775 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4517557621002197
Epoch: 8, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.811 Vali Acc: 0.639 Test Loss: 0.811 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2023959159851074
Epoch: 9, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.120 Vali Acc: 0.741 Test Loss: 1.120 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2490770816802979
Epoch: 10, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.032 Vali Acc: 0.737 Test Loss: 1.032 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5692710876464844
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.952 Vali Acc: 0.707 Test Loss: 0.952 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1103534698486328
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.173 Vali Acc: 0.732 Test Loss: 1.173 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 264894
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4607603549957275
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.606 Vali Acc: 0.712 Test Loss: 0.606 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.2313013076782227
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.587 Vali Acc: 0.741 Test Loss: 0.587 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.3521592617034912
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.1634259223937988
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3608980178833008
Epoch: 5, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.656 Vali Acc: 0.746 Test Loss: 0.656 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3946032524108887
Epoch: 6, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.893 Vali Acc: 0.741 Test Loss: 0.893 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4008550643920898
Epoch: 7, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.751 Vali Acc: 0.693 Test Loss: 0.751 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0689969062805176
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.860 Vali Acc: 0.702 Test Loss: 0.860 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0024254322052002
Epoch: 9, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3250811100006104
Epoch: 10, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.056 Vali Acc: 0.732 Test Loss: 1.056 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1445131301879883
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.071 Vali Acc: 0.688 Test Loss: 1.071 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2068097591400146
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.315 Vali Acc: 0.741 Test Loss: 1.315 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.292858362197876
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.306 Vali Acc: 0.712 Test Loss: 1.306 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 265658
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.541834592819214
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.650 Vali Acc: 0.712 Test Loss: 0.650 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.9880602359771729
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.2254583835601807
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.662 Vali Acc: 0.761 Test Loss: 0.662 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760969).  Saving model ...
Epoch: 4 cost time: 0.8817100524902344
Epoch: 4, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2168774604797363
Epoch: 5, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.758 Vali Acc: 0.741 Test Loss: 0.758 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1139323711395264
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.816 Vali Acc: 0.737 Test Loss: 0.816 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8637962341308594
Epoch: 7, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.836 Vali Acc: 0.732 Test Loss: 0.836 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9515964984893799
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.897 Vali Acc: 0.712 Test Loss: 0.897 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.018047571182251
Epoch: 9, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.076 Vali Acc: 0.751 Test Loss: 1.076 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9856593608856201
Epoch: 10, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.242 Vali Acc: 0.746 Test Loss: 1.242 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1499042510986328
Epoch: 11, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.978 Vali Acc: 0.673 Test Loss: 0.978 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2530508041381836
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.023 Vali Acc: 0.688 Test Loss: 1.023 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0181159973144531
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.183 Vali Acc: 0.702 Test Loss: 1.183 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm256_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 265616
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8256309032440186
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3492908477783203
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.2838032245635986
Epoch: 3, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.580 Vali Acc: 0.741 Test Loss: 0.580 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.174497365951538
Epoch: 4, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760969).  Saving model ...
Epoch: 5 cost time: 1.0983779430389404
Epoch: 5, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.691 Vali Acc: 0.698 Test Loss: 0.691 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1850924491882324
Epoch: 6, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.795 Vali Acc: 0.678 Test Loss: 0.795 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3055884838104248
Epoch: 7, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.910 Vali Acc: 0.746 Test Loss: 0.910 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3047845363616943
Epoch: 8, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.970 Vali Acc: 0.737 Test Loss: 0.970 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1217522621154785
Epoch: 9, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.891 Vali Acc: 0.737 Test Loss: 0.891 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.076416015625
Epoch: 10, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.074 Vali Acc: 0.746 Test Loss: 1.074 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.057088851928711
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.001 Vali Acc: 0.727 Test Loss: 1.001 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1537680625915527
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.013 Vali Acc: 0.717 Test Loss: 1.013 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.251664161682129
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.103 Vali Acc: 0.732 Test Loss: 1.103 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.495302438735962
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.529 Vali Acc: 0.737 Test Loss: 1.529 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 244292
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.480487585067749
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0407567024230957
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.0159671306610107
Epoch: 3, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.587 Vali Acc: 0.756 Test Loss: 0.587 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.0465476512908936
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0610339641571045
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1221508979797363
Epoch: 6, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.796 Vali Acc: 0.751 Test Loss: 0.796 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2722835540771484
Epoch: 7, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.813 Vali Acc: 0.732 Test Loss: 0.813 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1663742065429688
Epoch: 8, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.890 Vali Acc: 0.756 Test Loss: 0.890 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.365297794342041
Epoch: 9, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.065 Vali Acc: 0.746 Test Loss: 1.065 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0478274822235107
Epoch: 10, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.067 Vali Acc: 0.771 Test Loss: 1.067 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770721).  Saving model ...
Epoch: 11 cost time: 0.9422643184661865
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.980 Vali Acc: 0.683 Test Loss: 0.980 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.941185474395752
Epoch: 12, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.984 Vali Acc: 0.663 Test Loss: 0.984 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9167087078094482
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.197 Vali Acc: 0.722 Test Loss: 1.197 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0934970378875732
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.409 Vali Acc: 0.741 Test Loss: 1.409 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3071420192718506
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.250 Vali Acc: 0.707 Test Loss: 1.250 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2171759605407715
Epoch: 16, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.354 Vali Acc: 0.722 Test Loss: 1.354 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3844032287597656
Epoch: 17, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.362 Vali Acc: 0.712 Test Loss: 1.362 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2555968761444092
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.348 Vali Acc: 0.683 Test Loss: 1.348 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1653790473937988
Epoch: 19, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.630 Vali Acc: 0.722 Test Loss: 1.630 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0296916961669922
Epoch: 20, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.408 Vali Acc: 0.688 Test Loss: 1.408 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 239549
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs102_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1719167232513428
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.605 Vali Acc: 0.712 Test Loss: 0.605 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0044772624969482
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.594 Vali Acc: 0.737 Test Loss: 0.594 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 0.995624303817749
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.630 Vali Acc: 0.756 Test Loss: 0.630 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 0.9319422245025635
Epoch: 4, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1327216625213623
Epoch: 5, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1161582469940186
Epoch: 6, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760968).  Saving model ...
Epoch: 7 cost time: 0.902639627456665
Epoch: 7, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.894 Vali Acc: 0.659 Test Loss: 0.894 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2429356575012207
Epoch: 8, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.989 Vali Acc: 0.741 Test Loss: 0.989 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8850603103637695
Epoch: 9, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.035 Vali Acc: 0.746 Test Loss: 1.035 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9714610576629639
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.044 Vali Acc: 0.688 Test Loss: 1.044 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8753311634063721
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.065 Vali Acc: 0.707 Test Loss: 1.065 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9613628387451172
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.329 Vali Acc: 0.746 Test Loss: 1.329 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0518734455108643
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.023 Vali Acc: 0.698 Test Loss: 1.023 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9772505760192871
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.283 Vali Acc: 0.732 Test Loss: 1.283 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0892014503479004
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.256 Vali Acc: 0.702 Test Loss: 1.256 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1294152736663818
Epoch: 16, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.339 Vali Acc: 0.712 Test Loss: 1.339 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs102_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 238670
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8128089904785156
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.1264805793762207
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.0206570625305176
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.656 Vali Acc: 0.751 Test Loss: 0.656 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 1.1712782382965088
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.617 Vali Acc: 0.737 Test Loss: 0.617 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.255112886428833
Epoch: 5, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.646 Vali Acc: 0.746 Test Loss: 0.646 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0314598083496094
Epoch: 6, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1076810359954834
Epoch: 7, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.800 Vali Acc: 0.732 Test Loss: 0.800 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1655850410461426
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.829 Vali Acc: 0.737 Test Loss: 0.829 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.101503849029541
Epoch: 9, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.901 Vali Acc: 0.741 Test Loss: 0.901 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1440682411193848
Epoch: 10, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.099 Vali Acc: 0.746 Test Loss: 1.099 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0475437641143799
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.012 Vali Acc: 0.712 Test Loss: 1.012 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1701810359954834
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.101 Vali Acc: 0.722 Test Loss: 1.101 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2247631549835205
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.169 Vali Acc: 0.712 Test Loss: 1.169 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 236133
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.249622583389282
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.670 Vali Acc: 0.717 Test Loss: 0.670 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 1.627185583114624
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
Validation loss decreased (-0.717066 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.6066968441009521
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.635 Vali Acc: 0.766 Test Loss: 0.635 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765847).  Saving model ...
Epoch: 4 cost time: 1.7486481666564941
Epoch: 4, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.606 Vali Acc: 0.756 Test Loss: 0.606 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.595167636871338
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.740 Vali Acc: 0.741 Test Loss: 0.740 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4181742668151855
Epoch: 6, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9265789985656738
Epoch: 7, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.915 Vali Acc: 0.756 Test Loss: 0.915 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.261819839477539
Epoch: 8, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.197 Vali Acc: 0.751 Test Loss: 1.197 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3142235279083252
Epoch: 9, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.019 Vali Acc: 0.756 Test Loss: 1.019 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6553914546966553
Epoch: 10, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.160 Vali Acc: 0.756 Test Loss: 1.160 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6347830295562744
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.079 Vali Acc: 0.702 Test Loss: 1.079 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2850596904754639
Epoch: 12, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.150 Vali Acc: 0.712 Test Loss: 1.150 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2734262943267822
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.155 Vali Acc: 0.634 Test Loss: 1.155 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 236542
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1637701988220215
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.5964078903198242
Epoch: 2, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.609 Vali Acc: 0.732 Test Loss: 0.609 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.0260827541351318
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.676 Vali Acc: 0.732 Test Loss: 0.676 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5190224647521973
Epoch: 4, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.587 Vali Acc: 0.741 Test Loss: 0.587 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.2606451511383057
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 1.528395652770996
Epoch: 6, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756090).  Saving model ...
Epoch: 7 cost time: 1.72578763961792
Epoch: 7, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.771 Vali Acc: 0.732 Test Loss: 0.771 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3684208393096924
Epoch: 8, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.890 Vali Acc: 0.741 Test Loss: 0.890 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.329742431640625
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.877 Vali Acc: 0.683 Test Loss: 0.877 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1204590797424316
Epoch: 10, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.929 Vali Acc: 0.702 Test Loss: 0.929 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.183361291885376
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.225 Vali Acc: 0.741 Test Loss: 1.225 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4305977821350098
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.050 Vali Acc: 0.707 Test Loss: 1.050 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0731897354125977
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.093 Vali Acc: 0.717 Test Loss: 1.093 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.088557243347168
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.152 Vali Acc: 0.698 Test Loss: 1.152 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5062997341156006
Epoch: 15, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.222 Vali Acc: 0.702 Test Loss: 1.222 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1969919204711914
Epoch: 16, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.306 Vali Acc: 0.717 Test Loss: 1.306 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 235122
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4776041507720947
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3692924976348877
Epoch: 2, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.3641197681427002
Epoch: 3, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.07448410987854
Epoch: 4, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.657 Vali Acc: 0.751 Test Loss: 0.657 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 1.3403677940368652
Epoch: 5, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.413137674331665
Epoch: 6, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.684 Vali Acc: 0.722 Test Loss: 0.684 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.167815923690796
Epoch: 7, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.787 Vali Acc: 0.746 Test Loss: 0.787 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0579407215118408
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.875 Vali Acc: 0.737 Test Loss: 0.875 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9432113170623779
Epoch: 9, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2191877365112305
Epoch: 10, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.003 Vali Acc: 0.727 Test Loss: 1.003 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.030195713043213
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.103 Vali Acc: 0.722 Test Loss: 1.103 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2168703079223633
Epoch: 12, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.103 Vali Acc: 0.698 Test Loss: 1.103 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9867045879364014
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.193 Vali Acc: 0.702 Test Loss: 1.193 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1687769889831543
Epoch: 14, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.229 Vali Acc: 0.693 Test Loss: 1.229 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 235518
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6406219005584717
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.617 Vali Acc: 0.707 Test Loss: 0.617 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.5023221969604492
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
Validation loss decreased (-0.707311 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.129112958908081
Epoch: 3, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.616 Vali Acc: 0.746 Test Loss: 0.616 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3912711143493652
Epoch: 4, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 5 cost time: 1.1965961456298828
Epoch: 5, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
Validation loss decreased (-0.751212 --> -0.751213).  Saving model ...
Epoch: 6 cost time: 1.1274373531341553
Epoch: 6, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756090).  Saving model ...
Epoch: 7 cost time: 1.4222016334533691
Epoch: 7, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5619959831237793
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.848 Vali Acc: 0.737 Test Loss: 0.848 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1669256687164307
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.952 Vali Acc: 0.737 Test Loss: 0.952 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3815617561340332
Epoch: 10, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.987 Vali Acc: 0.663 Test Loss: 0.987 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4145472049713135
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.128 Vali Acc: 0.722 Test Loss: 1.128 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1759240627288818
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.463 Vali Acc: 0.732 Test Loss: 1.463 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2011935710906982
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.486 Vali Acc: 0.737 Test Loss: 1.486 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0196747779846191
Epoch: 14, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.365 Vali Acc: 0.727 Test Loss: 1.365 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8849105834960938
Epoch: 15, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.223 Vali Acc: 0.698 Test Loss: 1.223 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6178865432739258
Epoch: 16, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.627 Vali Acc: 0.727 Test Loss: 1.627 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 233957
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.792879581451416
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0094482898712158
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.0891685485839844
Epoch: 3, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.168593406677246
Epoch: 4, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.612 Vali Acc: 0.746 Test Loss: 0.612 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1199686527252197
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.635 Vali Acc: 0.751 Test Loss: 0.635 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.450754165649414
Epoch: 6, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.731 Vali Acc: 0.746 Test Loss: 0.731 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2871100902557373
Epoch: 7, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760968).  Saving model ...
Epoch: 8 cost time: 1.1142971515655518
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.858 Vali Acc: 0.737 Test Loss: 0.858 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9719159603118896
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.929 Vali Acc: 0.727 Test Loss: 0.929 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4272246360778809
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.989 Vali Acc: 0.732 Test Loss: 0.989 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2221755981445312
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.209 Vali Acc: 0.741 Test Loss: 1.209 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6253349781036377
Epoch: 12, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.019 Vali Acc: 0.663 Test Loss: 1.019 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3755993843078613
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.038 Vali Acc: 0.654 Test Loss: 1.038 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.228140115737915
Epoch: 14, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.337 Vali Acc: 0.707 Test Loss: 1.337 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.116487979888916
Epoch: 15, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.800 Vali Acc: 0.741 Test Loss: 1.800 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1495232582092285
Epoch: 16, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.219 Vali Acc: 0.688 Test Loss: 1.219 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3076426982879639
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.452 Vali Acc: 0.712 Test Loss: 1.452 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 235768
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.013832092285156
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.626 Vali Acc: 0.712 Test Loss: 0.626 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0760517120361328
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.0583369731903076
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.628 Vali Acc: 0.751 Test Loss: 0.628 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3479163646697998
Epoch: 4, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.653 Vali Acc: 0.751 Test Loss: 0.653 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3006157875061035
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0990228652954102
Epoch: 6, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.792 Vali Acc: 0.741 Test Loss: 0.792 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2761776447296143
Epoch: 7, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.839 Vali Acc: 0.756 Test Loss: 0.839 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756089).  Saving model ...
Epoch: 8 cost time: 1.210296630859375
Epoch: 8, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.107 Vali Acc: 0.741 Test Loss: 1.107 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2628388404846191
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2527661323547363
Epoch: 10, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.946 Vali Acc: 0.712 Test Loss: 0.946 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4543561935424805
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.297 Vali Acc: 0.746 Test Loss: 1.297 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3324148654937744
Epoch: 12, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.398 Vali Acc: 0.737 Test Loss: 1.398 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5500819683074951
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.242 Vali Acc: 0.712 Test Loss: 1.242 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2167224884033203
Epoch: 14, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.249 Vali Acc: 0.698 Test Loss: 1.249 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.06699800491333
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.352 Vali Acc: 0.707 Test Loss: 1.352 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4740729331970215
Epoch: 16, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.257 Vali Acc: 0.683 Test Loss: 1.257 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3705012798309326
Epoch: 17, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.382 Vali Acc: 0.712 Test Loss: 1.382 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 234343
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0022706985473633
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.610 Vali Acc: 0.717 Test Loss: 0.610 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2294714450836182
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.598 Vali Acc: 0.771 Test Loss: 0.598 Test Acc: 0.771
Validation loss decreased (-0.717067 --> -0.770726).  Saving model ...
Epoch: 3 cost time: 1.1334114074707031
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1280457973480225
Epoch: 4, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.652 Vali Acc: 0.746 Test Loss: 0.652 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0939712524414062
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.698 Vali Acc: 0.741 Test Loss: 0.698 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0921409130096436
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.692 Vali Acc: 0.688 Test Loss: 0.692 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0668621063232422
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.740 Vali Acc: 0.712 Test Loss: 0.740 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1402685642242432
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.905 Vali Acc: 0.746 Test Loss: 0.905 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1482319831848145
Epoch: 9, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.014 Vali Acc: 0.746 Test Loss: 1.014 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0441482067108154
Epoch: 10, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.997 Vali Acc: 0.732 Test Loss: 0.997 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0872042179107666
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.371 Vali Acc: 0.741 Test Loss: 1.371 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.915412187576294
Epoch: 12, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.115 Vali Acc: 0.698 Test Loss: 1.115 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 234606
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.116227865219116
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.642 Vali Acc: 0.712 Test Loss: 0.642 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.189453363418579
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
Validation loss decreased (-0.712189 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.3279650211334229
Epoch: 3, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.580 Vali Acc: 0.766 Test Loss: 0.580 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.2333638668060303
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.619 Vali Acc: 0.732 Test Loss: 0.619 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1806113719940186
Epoch: 5, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.159064769744873
Epoch: 6, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3761627674102783
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.696 Vali Acc: 0.712 Test Loss: 0.696 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3768415451049805
Epoch: 8, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.707 Vali Acc: 0.678 Test Loss: 0.707 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.174459457397461
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.864 Vali Acc: 0.707 Test Loss: 0.864 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.138777494430542
Epoch: 10, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.970 Vali Acc: 0.732 Test Loss: 0.970 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2637200355529785
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.001 Vali Acc: 0.639 Test Loss: 1.001 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1216776371002197
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.024 Vali Acc: 0.702 Test Loss: 1.024 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5076797008514404
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.324 Vali Acc: 0.741 Test Loss: 1.324 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 237772
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.13404107093811
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.639 Vali Acc: 0.712 Test Loss: 0.639 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1970765590667725
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.563 Vali Acc: 0.766 Test Loss: 0.563 Test Acc: 0.766
Validation loss decreased (-0.712189 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 1.2356092929840088
Epoch: 3, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.119462251663208
Epoch: 4, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.595 Vali Acc: 0.766 Test Loss: 0.595 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.319044589996338
Epoch: 5, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2744483947753906
Epoch: 6, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.775 Vali Acc: 0.746 Test Loss: 0.775 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3338375091552734
Epoch: 7, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.798 Vali Acc: 0.771 Test Loss: 0.798 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770724).  Saving model ...
Epoch: 8 cost time: 1.3254895210266113
Epoch: 8, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.850 Vali Acc: 0.746 Test Loss: 0.850 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1948761940002441
Epoch: 9, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.966 Vali Acc: 0.746 Test Loss: 0.966 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2765789031982422
Epoch: 10, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.006 Vali Acc: 0.727 Test Loss: 1.006 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.168053150177002
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.959 Vali Acc: 0.698 Test Loss: 0.959 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.396188735961914
Epoch: 12, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.099 Vali Acc: 0.702 Test Loss: 1.099 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4374175071716309
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.113 Vali Acc: 0.698 Test Loss: 1.113 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.562540054321289
Epoch: 14, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.378 Vali Acc: 0.732 Test Loss: 1.378 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3460917472839355
Epoch: 15, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.468 Vali Acc: 0.732 Test Loss: 1.468 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.367457389831543
Epoch: 16, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.260 Vali Acc: 0.683 Test Loss: 1.260 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3865952491760254
Epoch: 17, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.334 Vali Acc: 0.722 Test Loss: 1.334 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 233588
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.837005853652954
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.656 Vali Acc: 0.712 Test Loss: 0.656 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.2382879257202148
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.559 Vali Acc: 0.746 Test Loss: 0.559 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.1150026321411133
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.642 Vali Acc: 0.751 Test Loss: 0.642 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 1.110461711883545
Epoch: 4, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.563 Vali Acc: 0.746 Test Loss: 0.563 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.302410364151001
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.735 Vali Acc: 0.737 Test Loss: 0.735 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2745239734649658
Epoch: 6, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.668 Vali Acc: 0.712 Test Loss: 0.668 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1155025959014893
Epoch: 7, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0269625186920166
Epoch: 8, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.932 Vali Acc: 0.737 Test Loss: 0.932 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0860064029693604
Epoch: 9, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.988 Vali Acc: 0.756 Test Loss: 0.988 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756088).  Saving model ...
Epoch: 10 cost time: 0.9391162395477295
Epoch: 10, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.000 Vali Acc: 0.727 Test Loss: 1.000 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.316335678100586
Epoch: 11, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.976 Vali Acc: 0.698 Test Loss: 0.976 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4512255191802979
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.298 Vali Acc: 0.751 Test Loss: 1.298 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.265855312347412
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.261 Vali Acc: 0.712 Test Loss: 1.261 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0139257907867432
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.034 Vali Acc: 0.649 Test Loss: 1.034 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0374059677124023
Epoch: 15, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.258 Vali Acc: 0.707 Test Loss: 1.258 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1879034042358398
Epoch: 16, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.398 Vali Acc: 0.717 Test Loss: 1.398 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9525320529937744
Epoch: 17, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.446 Vali Acc: 0.722 Test Loss: 1.446 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0883502960205078
Epoch: 18, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.541 Vali Acc: 0.722 Test Loss: 1.541 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.139941930770874
Epoch: 19, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.226 Vali Acc: 0.639 Test Loss: 1.226 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 233117
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4267077445983887
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.4383182525634766
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.581 Vali Acc: 0.761 Test Loss: 0.581 Test Acc: 0.761
Validation loss decreased (-0.717067 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 1.187673807144165
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.085465908050537
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0580987930297852
Epoch: 5, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.782 Vali Acc: 0.746 Test Loss: 0.782 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1194913387298584
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.866 Vali Acc: 0.751 Test Loss: 0.866 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.143040418624878
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.778 Vali Acc: 0.678 Test Loss: 0.778 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9474081993103027
Epoch: 8, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.713 Vali Acc: 0.707 Test Loss: 0.713 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1919260025024414
Epoch: 9, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.937 Vali Acc: 0.746 Test Loss: 0.937 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0770487785339355
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.057 Vali Acc: 0.746 Test Loss: 1.057 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1542632579803467
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0829613208770752
Epoch: 12, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.009 Vali Acc: 0.595 Test Loss: 1.009 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 237574
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.961453676223755
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.612 Vali Acc: 0.712 Test Loss: 0.612 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.9615910053253174
Epoch: 2, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 0.9792027473449707
Epoch: 3, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.4002211093902588
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.726 Vali Acc: 0.732 Test Loss: 0.726 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1080272197723389
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0641238689422607
Epoch: 6, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.710 Vali Acc: 0.712 Test Loss: 0.710 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0560684204101562
Epoch: 7, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.754 Vali Acc: 0.732 Test Loss: 0.754 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.181297779083252
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.901 Vali Acc: 0.732 Test Loss: 0.901 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8333292007446289
Epoch: 9, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.936 Vali Acc: 0.746 Test Loss: 0.936 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9516689777374268
Epoch: 10, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.945 Vali Acc: 0.727 Test Loss: 0.945 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0635271072387695
Epoch: 11, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.975 Vali Acc: 0.624 Test Loss: 0.975 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0293643474578857
Epoch: 12, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.045 Vali Acc: 0.717 Test Loss: 1.045 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9440100193023682
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.093 Vali Acc: 0.702 Test Loss: 1.093 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 234276
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0855183601379395
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3690986633300781
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 1.3227577209472656
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.660 Vali Acc: 0.746 Test Loss: 0.660 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3954381942749023
Epoch: 4, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.633 Vali Acc: 0.717 Test Loss: 0.633 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2460598945617676
Epoch: 5, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.884 Vali Acc: 0.741 Test Loss: 0.884 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6115810871124268
Epoch: 6, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.789 Vali Acc: 0.737 Test Loss: 0.789 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1742289066314697
Epoch: 7, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.755 Vali Acc: 0.688 Test Loss: 0.755 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0776784420013428
Epoch: 8, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.949 Vali Acc: 0.741 Test Loss: 0.949 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2237746715545654
Epoch: 9, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.982 Vali Acc: 0.741 Test Loss: 0.982 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5387165546417236
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.041 Vali Acc: 0.722 Test Loss: 1.041 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.418835163116455
Epoch: 11, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.092 Vali Acc: 0.688 Test Loss: 1.092 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1593961715698242
Epoch: 12, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.124 Vali Acc: 0.712 Test Loss: 1.124 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 236716
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1594245433807373
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.9951469898223877
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.879422664642334
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.608 Vali Acc: 0.741 Test Loss: 0.608 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1851813793182373
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4486324787139893
Epoch: 5, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.705 Vali Acc: 0.741 Test Loss: 0.705 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.592571496963501
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.735 Vali Acc: 0.737 Test Loss: 0.735 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3761632442474365
Epoch: 7, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.813 Vali Acc: 0.751 Test Loss: 0.813 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751211).  Saving model ...
Epoch: 8 cost time: 1.4998183250427246
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.751 Vali Acc: 0.727 Test Loss: 0.751 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3286921977996826
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.996 Vali Acc: 0.756 Test Loss: 0.996 Test Acc: 0.756
Validation loss decreased (-0.751211 --> -0.756088).  Saving model ...
Epoch: 10 cost time: 1.0050878524780273
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.022 Vali Acc: 0.741 Test Loss: 1.022 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2601304054260254
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.956 Vali Acc: 0.654 Test Loss: 0.956 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4210724830627441
Epoch: 12, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.185 Vali Acc: 0.741 Test Loss: 1.185 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0735523700714111
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.179 Vali Acc: 0.717 Test Loss: 1.179 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.198713779449463
Epoch: 14, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.113 Vali Acc: 0.693 Test Loss: 1.113 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.21588134765625
Epoch: 15, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.349 Vali Acc: 0.737 Test Loss: 1.349 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7386062145233154
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.347 Vali Acc: 0.712 Test Loss: 1.347 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1352534294128418
Epoch: 17, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.644 Vali Acc: 0.746 Test Loss: 1.644 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1428935527801514
Epoch: 18, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.894 Vali Acc: 0.746 Test Loss: 1.894 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.012815237045288
Epoch: 19, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.408 Vali Acc: 0.673 Test Loss: 1.408 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 238350
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6941885948181152
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.633 Vali Acc: 0.707 Test Loss: 0.633 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.4745230674743652
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.575 Vali Acc: 0.741 Test Loss: 0.575 Test Acc: 0.741
Validation loss decreased (-0.707311 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.2081608772277832
Epoch: 3, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.4986402988433838
Epoch: 4, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.578 Vali Acc: 0.751 Test Loss: 0.578 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.4563159942626953
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4109468460083008
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2174420356750488
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.713 Vali Acc: 0.678 Test Loss: 0.713 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.527205467224121
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.773 Vali Acc: 0.741 Test Loss: 0.773 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.114945888519287
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.872 Vali Acc: 0.649 Test Loss: 0.872 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4669623374938965
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.904 Vali Acc: 0.737 Test Loss: 0.904 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.218883991241455
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.994 Vali Acc: 0.732 Test Loss: 0.994 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4002819061279297
Epoch: 12, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.043 Vali Acc: 0.727 Test Loss: 1.043 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.093860149383545
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.078 Vali Acc: 0.693 Test Loss: 1.078 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4592456817626953
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.139 Vali Acc: 0.722 Test Loss: 1.139 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 239178
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8378140926361084
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.677 Vali Acc: 0.732 Test Loss: 0.677 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.1916520595550537
Epoch: 2, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.5112323760986328
Epoch: 3, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.580 Vali Acc: 0.756 Test Loss: 0.580 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.1415083408355713
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3220994472503662
Epoch: 5, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.681 Vali Acc: 0.751 Test Loss: 0.681 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0344092845916748
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.109609603881836
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.734 Vali Acc: 0.741 Test Loss: 0.734 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.287398338317871
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.678 Vali Acc: 0.688 Test Loss: 0.678 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2849018573760986
Epoch: 9, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.693 Vali Acc: 0.707 Test Loss: 0.693 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.530416488647461
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.048 Vali Acc: 0.756 Test Loss: 1.048 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6977429389953613
Epoch: 11, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.111 Vali Acc: 0.756 Test Loss: 1.111 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4415524005889893
Epoch: 12, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.875 Vali Acc: 0.737 Test Loss: 0.875 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3545360565185547
Epoch: 13, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.960 Vali Acc: 0.712 Test Loss: 0.960 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm128_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 239200
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.043426752090454
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.229921579360962
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 0.9035186767578125
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.686 Vali Acc: 0.741 Test Loss: 0.686 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.012497901916504
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0573952198028564
Epoch: 5, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.712 Vali Acc: 0.737 Test Loss: 0.712 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.078608751296997
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0873000621795654
Epoch: 7, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.903 Vali Acc: 0.732 Test Loss: 0.903 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1849279403686523
Epoch: 8, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.968 Vali Acc: 0.737 Test Loss: 0.968 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0406079292297363
Epoch: 9, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.902 Vali Acc: 0.751 Test Loss: 0.902 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751210).  Saving model ...
Epoch: 10 cost time: 1.0043578147888184
Epoch: 10, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.782 Vali Acc: 0.702 Test Loss: 0.782 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.167574405670166
Epoch: 11, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.959 Vali Acc: 0.722 Test Loss: 0.959 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0224049091339111
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.003 Vali Acc: 0.663 Test Loss: 1.003 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5023493766784668
Epoch: 13, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.015 Vali Acc: 0.688 Test Loss: 1.015 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1074578762054443
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.136 Vali Acc: 0.717 Test Loss: 1.136 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1043856143951416
Epoch: 15, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.331 Vali Acc: 0.737 Test Loss: 1.331 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.183835506439209
Epoch: 16, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.226 Vali Acc: 0.698 Test Loss: 1.226 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3081669807434082
Epoch: 17, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.222 Vali Acc: 0.678 Test Loss: 1.222 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5423917770385742
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.304 Vali Acc: 0.717 Test Loss: 1.304 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.274402141571045
Epoch: 19, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.287 Vali Acc: 0.702 Test Loss: 1.287 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 229836
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5985002517700195
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.4083821773529053
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.634 Vali Acc: 0.732 Test Loss: 0.634 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.18080735206604
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.4596951007843018
Epoch: 4, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0768523216247559
Epoch: 5, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1577281951904297
Epoch: 6, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.702 Vali Acc: 0.732 Test Loss: 0.702 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1986644268035889
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.314542293548584
Epoch: 8, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.734 Vali Acc: 0.702 Test Loss: 0.734 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3396801948547363
Epoch: 9, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.736 Vali Acc: 0.702 Test Loss: 0.736 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.494199514389038
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.911 Vali Acc: 0.732 Test Loss: 0.911 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3295719623565674
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.005 Vali Acc: 0.698 Test Loss: 1.005 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2841944694519043
Epoch: 12, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.967 Vali Acc: 0.741 Test Loss: 0.967 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.131758451461792
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.065 Vali Acc: 0.727 Test Loss: 1.065 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 227269
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs102_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1834356784820557
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.610 Vali Acc: 0.712 Test Loss: 0.610 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1763386726379395
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.2518155574798584
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.583 Vali Acc: 0.746 Test Loss: 0.583 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.0917696952819824
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 1.026365041732788
Epoch: 5, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.625 Vali Acc: 0.741 Test Loss: 0.625 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1065120697021484
Epoch: 6, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.814 Vali Acc: 0.732 Test Loss: 0.814 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0551729202270508
Epoch: 7, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.856 Vali Acc: 0.737 Test Loss: 0.856 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3244121074676514
Epoch: 8, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.889 Vali Acc: 0.761 Test Loss: 0.889 Test Acc: 0.761
Validation loss decreased (-0.751213 --> -0.760967).  Saving model ...
Epoch: 9 cost time: 1.273345947265625
Epoch: 9, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.812 Vali Acc: 0.683 Test Loss: 0.812 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2861440181732178
Epoch: 10, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.912 Vali Acc: 0.644 Test Loss: 0.912 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.607645034790039
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.924 Vali Acc: 0.698 Test Loss: 0.924 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0413475036621094
Epoch: 12, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.078 Vali Acc: 0.688 Test Loss: 1.078 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0492489337921143
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.157 Vali Acc: 0.683 Test Loss: 1.157 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.279015064239502
Epoch: 14, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.138 Vali Acc: 0.678 Test Loss: 1.138 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0713887214660645
Epoch: 15, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.264 Vali Acc: 0.712 Test Loss: 1.264 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8600654602050781
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.590 Vali Acc: 0.746 Test Loss: 1.590 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.115621566772461
Epoch: 17, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.321 Vali Acc: 0.712 Test Loss: 1.321 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3196938037872314
Epoch: 18, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.279 Vali Acc: 0.688 Test Loss: 1.279 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs102_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 227446
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.641124963760376
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.584 Vali Acc: 0.727 Test Loss: 0.584 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.2237086296081543
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2495110034942627
Epoch: 3, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.645 Vali Acc: 0.732 Test Loss: 0.645 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 1.3295726776123047
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.4285917282104492
Epoch: 5, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.657 Vali Acc: 0.746 Test Loss: 0.657 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.327470064163208
Epoch: 6, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.770 Vali Acc: 0.737 Test Loss: 0.770 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5857141017913818
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.864 Vali Acc: 0.741 Test Loss: 0.864 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2271690368652344
Epoch: 8, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.853 Vali Acc: 0.639 Test Loss: 0.853 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4624583721160889
Epoch: 9, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.810 Vali Acc: 0.727 Test Loss: 0.810 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0954325199127197
Epoch: 10, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.059 Vali Acc: 0.771 Test Loss: 1.059 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770721).  Saving model ...
Epoch: 11 cost time: 1.193559169769287
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.220 Vali Acc: 0.741 Test Loss: 1.220 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1338698863983154
Epoch: 12, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.272 Vali Acc: 0.756 Test Loss: 1.272 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.948838472366333
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.066 Vali Acc: 0.654 Test Loss: 1.066 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.451007604598999
Epoch: 14, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.144 Vali Acc: 0.683 Test Loss: 1.144 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.318976640701294
Epoch: 15, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.343 Vali Acc: 0.707 Test Loss: 1.343 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5858302116394043
Epoch: 16, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.337 Vali Acc: 0.707 Test Loss: 1.337 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.439525842666626
Epoch: 17, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.307 Vali Acc: 0.673 Test Loss: 1.307 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4753036499023438
Epoch: 18, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.574 Vali Acc: 0.737 Test Loss: 1.574 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4077956676483154
Epoch: 19, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.549 Vali Acc: 0.712 Test Loss: 1.549 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5642497539520264
Epoch: 20, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.460 Vali Acc: 0.654 Test Loss: 1.460 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 225581
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4942827224731445
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.625 Vali Acc: 0.712 Test Loss: 0.625 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.2937257289886475
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.139681339263916
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.620 Vali Acc: 0.771 Test Loss: 0.620 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 1.1459112167358398
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.979762077331543
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.643 Vali Acc: 0.741 Test Loss: 0.643 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3790345191955566
Epoch: 6, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.792 Vali Acc: 0.751 Test Loss: 0.792 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1125948429107666
Epoch: 7, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.711 Vali Acc: 0.683 Test Loss: 0.711 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2787983417510986
Epoch: 8, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.838 Vali Acc: 0.673 Test Loss: 0.838 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0986895561218262
Epoch: 9, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.917 Vali Acc: 0.668 Test Loss: 0.917 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2257096767425537
Epoch: 10, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.973 Vali Acc: 0.712 Test Loss: 0.973 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6580007076263428
Epoch: 11, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.971 Vali Acc: 0.678 Test Loss: 0.971 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1339731216430664
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.096 Vali Acc: 0.668 Test Loss: 1.096 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1696255207061768
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.043 Vali Acc: 0.702 Test Loss: 1.043 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 226406
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2999427318573
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.607 Vali Acc: 0.712 Test Loss: 0.607 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.3714394569396973
Epoch: 2, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.618 Vali Acc: 0.771 Test Loss: 0.618 Test Acc: 0.771
Validation loss decreased (-0.712189 --> -0.770726).  Saving model ...
Epoch: 3 cost time: 1.1713957786560059
Epoch: 3, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1207873821258545
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2653584480285645
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.638 Vali Acc: 0.766 Test Loss: 0.638 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1126320362091064
Epoch: 6, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1503667831420898
Epoch: 7, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.786 Vali Acc: 0.741 Test Loss: 0.786 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.115694284439087
Epoch: 8, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.913 Vali Acc: 0.751 Test Loss: 0.913 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3666086196899414
Epoch: 9, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.966 Vali Acc: 0.741 Test Loss: 0.966 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1507420539855957
Epoch: 10, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.129 Vali Acc: 0.751 Test Loss: 1.129 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0455145835876465
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.071 Vali Acc: 0.727 Test Loss: 1.071 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0844075679779053
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.031 Vali Acc: 0.717 Test Loss: 1.031 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 225306
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2649881839752197
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3730838298797607
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.596 Vali Acc: 0.732 Test Loss: 0.596 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.1966431140899658
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.654 Vali Acc: 0.668 Test Loss: 0.654 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3472349643707275
Epoch: 4, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.2746410369873047
Epoch: 5, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.766 Vali Acc: 0.741 Test Loss: 0.766 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1439263820648193
Epoch: 6, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.702 Vali Acc: 0.737 Test Loss: 0.702 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9890508651733398
Epoch: 7, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.796 Vali Acc: 0.741 Test Loss: 0.796 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.036942481994629
Epoch: 8, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.818 Vali Acc: 0.732 Test Loss: 0.818 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.18990159034729
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.011 Vali Acc: 0.624 Test Loss: 1.011 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.205099105834961
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.939 Vali Acc: 0.678 Test Loss: 0.939 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7203516960144043
Epoch: 11, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.057 Vali Acc: 0.717 Test Loss: 1.057 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1367642879486084
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.222 Vali Acc: 0.732 Test Loss: 1.222 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4781444072723389
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.477 Vali Acc: 0.737 Test Loss: 1.477 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1420202255249023
Epoch: 14, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.219 Vali Acc: 0.702 Test Loss: 1.219 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 225926
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.955467939376831
Epoch: 1, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.104645013809204
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.274907112121582
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.558 Vali Acc: 0.766 Test Loss: 0.558 Test Acc: 0.766
Validation loss decreased (-0.731701 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.1640331745147705
Epoch: 4, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9738495349884033
Epoch: 5, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.851 Vali Acc: 0.746 Test Loss: 0.851 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1241722106933594
Epoch: 6, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.842 Vali Acc: 0.746 Test Loss: 0.842 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2221879959106445
Epoch: 7, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.790 Vali Acc: 0.746 Test Loss: 0.790 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9473650455474854
Epoch: 8, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.882 Vali Acc: 0.751 Test Loss: 0.882 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.104722499847412
Epoch: 9, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.876 Vali Acc: 0.737 Test Loss: 0.876 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5841913223266602
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0854206085205078
Epoch: 11, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.109 Vali Acc: 0.644 Test Loss: 1.109 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2262747287750244
Epoch: 12, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.110 Vali Acc: 0.702 Test Loss: 1.110 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.978928804397583
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.133 Vali Acc: 0.698 Test Loss: 1.133 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 224557
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1940979957580566
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2408318519592285
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.588 Vali Acc: 0.756 Test Loss: 0.588 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.9518470764160156
Epoch: 3, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1094789505004883
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1111550331115723
Epoch: 5, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.663 Vali Acc: 0.746 Test Loss: 0.663 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9008221626281738
Epoch: 6, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.631 Vali Acc: 0.698 Test Loss: 0.631 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.106835126876831
Epoch: 7, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0709595680236816
Epoch: 8, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.828 Vali Acc: 0.737 Test Loss: 0.828 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.189408540725708
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.820 Vali Acc: 0.615 Test Loss: 0.820 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0897958278656006
Epoch: 10, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.966 Vali Acc: 0.683 Test Loss: 0.966 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4645745754241943
Epoch: 11, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.138 Vali Acc: 0.737 Test Loss: 1.138 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2613823413848877
Epoch: 12, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.173 Vali Acc: 0.737 Test Loss: 1.173 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 226496
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3569107055664062
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2095839977264404
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.247694492340088
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.628 Vali Acc: 0.751 Test Loss: 0.628 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 1.2387146949768066
Epoch: 4, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3859288692474365
Epoch: 5, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.749 Vali Acc: 0.615 Test Loss: 0.749 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2166292667388916
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.636 Vali Acc: 0.751 Test Loss: 0.636 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.126983880996704
Epoch: 7, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2148199081420898
Epoch: 8, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.766 Vali Acc: 0.746 Test Loss: 0.766 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4740447998046875
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.795 Vali Acc: 0.722 Test Loss: 0.795 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4219701290130615
Epoch: 10, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.924 Vali Acc: 0.698 Test Loss: 0.924 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0826480388641357
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.058 Vali Acc: 0.737 Test Loss: 1.058 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4782419204711914
Epoch: 12, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.197 Vali Acc: 0.737 Test Loss: 1.197 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3810548782348633
Epoch: 13, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.106 Vali Acc: 0.673 Test Loss: 1.106 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 225199
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.726111888885498
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.618 Vali Acc: 0.712 Test Loss: 0.618 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0042202472686768
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.098820686340332
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.9926104545593262
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.3924882411956787
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.709 Vali Acc: 0.746 Test Loss: 0.709 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9525220394134521
Epoch: 6, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.736 Vali Acc: 0.727 Test Loss: 0.736 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9847085475921631
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.852 Vali Acc: 0.717 Test Loss: 0.852 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1049885749816895
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.948 Vali Acc: 0.727 Test Loss: 0.948 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5295119285583496
Epoch: 9, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.875 Vali Acc: 0.732 Test Loss: 0.875 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1411380767822266
Epoch: 10, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.098 Vali Acc: 0.722 Test Loss: 1.098 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4768736362457275
Epoch: 11, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.328 Vali Acc: 0.737 Test Loss: 1.328 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0934264659881592
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.267 Vali Acc: 0.717 Test Loss: 1.267 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4011247158050537
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.122 Vali Acc: 0.678 Test Loss: 1.122 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.211397409439087
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.430 Vali Acc: 0.717 Test Loss: 1.430 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 225558
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2585012912750244
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.601 Vali Acc: 0.712 Test Loss: 0.601 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1494786739349365
Epoch: 2, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.9010624885559082
Epoch: 3, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.703 Vali Acc: 0.766 Test Loss: 0.703 Test Acc: 0.766
Validation loss decreased (-0.721945 --> -0.765847).  Saving model ...
Epoch: 4 cost time: 0.9032073020935059
Epoch: 4, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.160963773727417
Epoch: 5, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.763 Vali Acc: 0.615 Test Loss: 0.763 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3533368110656738
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.798 Vali Acc: 0.659 Test Loss: 0.798 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3857204914093018
Epoch: 7, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.835 Vali Acc: 0.732 Test Loss: 0.835 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2377347946166992
Epoch: 8, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.872 Vali Acc: 0.741 Test Loss: 0.872 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.274911642074585
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.962 Vali Acc: 0.707 Test Loss: 0.962 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.322169303894043
Epoch: 10, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.022 Vali Acc: 0.751 Test Loss: 1.022 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1443488597869873
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.213 Vali Acc: 0.751 Test Loss: 1.213 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9806065559387207
Epoch: 12, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.286 Vali Acc: 0.756 Test Loss: 1.286 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.452625036239624
Epoch: 13, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.409 Vali Acc: 0.756 Test Loss: 1.409 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 228788
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2407350540161133
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0166399478912354
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.1665868759155273
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.647 Vali Acc: 0.746 Test Loss: 0.647 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.1461453437805176
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5656383037567139
Epoch: 5, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 0.9699459075927734
Epoch: 6, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2383453845977783
Epoch: 7, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.316028356552124
Epoch: 8, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.796 Vali Acc: 0.639 Test Loss: 0.796 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2221455574035645
Epoch: 9, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.699 Vali Acc: 0.698 Test Loss: 0.699 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1887056827545166
Epoch: 10, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.859 Vali Acc: 0.639 Test Loss: 0.859 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5150411128997803
Epoch: 11, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.920 Vali Acc: 0.673 Test Loss: 0.920 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5505762100219727
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.006 Vali Acc: 0.683 Test Loss: 1.006 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2783212661743164
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.113 Vali Acc: 0.737 Test Loss: 1.113 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.722139835357666
Epoch: 14, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.430 Vali Acc: 0.746 Test Loss: 1.430 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.363879680633545
Epoch: 15, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.339 Vali Acc: 0.717 Test Loss: 1.339 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 224700
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.137458086013794
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.664 Vali Acc: 0.712 Test Loss: 0.664 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 0.8458042144775391
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.666 Vali Acc: 0.727 Test Loss: 0.666 Test Acc: 0.727
Validation loss decreased (-0.712188 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.0060153007507324
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.1965177059173584
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.638 Vali Acc: 0.751 Test Loss: 0.638 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 0.8170833587646484
Epoch: 5, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.772 Vali Acc: 0.737 Test Loss: 0.772 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0194385051727295
Epoch: 6, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.709 Vali Acc: 0.746 Test Loss: 0.709 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.109281301498413
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.772 Vali Acc: 0.751 Test Loss: 0.772 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0718791484832764
Epoch: 8, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.897 Vali Acc: 0.722 Test Loss: 0.897 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1762006282806396
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.000 Vali Acc: 0.741 Test Loss: 1.000 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9860494136810303
Epoch: 10, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.071 Vali Acc: 0.741 Test Loss: 1.071 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4020202159881592
Epoch: 11, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.036 Vali Acc: 0.737 Test Loss: 1.036 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.157872200012207
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.104 Vali Acc: 0.746 Test Loss: 1.104 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0259392261505127
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.132 Vali Acc: 0.688 Test Loss: 1.132 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1593358516693115
Epoch: 14, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.152 Vali Acc: 0.712 Test Loss: 1.152 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 224293
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8448069095611572
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 0.8272314071655273
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.0704600811004639
Epoch: 3, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5207371711730957
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1963527202606201
Epoch: 5, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9247214794158936
Epoch: 6, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.670 Vali Acc: 0.707 Test Loss: 0.670 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.169384479522705
Epoch: 7, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.690 Vali Acc: 0.634 Test Loss: 0.690 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5421814918518066
Epoch: 8, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.795 Vali Acc: 0.741 Test Loss: 0.795 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4370043277740479
Epoch: 9, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.865 Vali Acc: 0.746 Test Loss: 0.865 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4653823375701904
Epoch: 10, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.825 Vali Acc: 0.712 Test Loss: 0.825 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2378849983215332
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.942 Vali Acc: 0.702 Test Loss: 0.942 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3094377517700195
Epoch: 12, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 228782
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7499213218688965
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.606 Vali Acc: 0.712 Test Loss: 0.606 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.046271800994873
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.715 Vali Acc: 0.732 Test Loss: 0.715 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731700).  Saving model ...
Epoch: 3 cost time: 1.1083908081054688
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.636 Vali Acc: 0.727 Test Loss: 0.636 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2423179149627686
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
Validation loss decreased (-0.731700 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.2114660739898682
Epoch: 5, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.740 Vali Acc: 0.693 Test Loss: 0.740 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.278470754623413
Epoch: 6, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.727 Vali Acc: 0.722 Test Loss: 0.727 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0863759517669678
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9722747802734375
Epoch: 8, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.987 Vali Acc: 0.751 Test Loss: 0.987 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751210).  Saving model ...
Epoch: 9 cost time: 1.5349550247192383
Epoch: 9, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.005 Vali Acc: 0.737 Test Loss: 1.005 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.526432752609253
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.332 Vali Acc: 0.756 Test Loss: 1.332 Test Acc: 0.756
Validation loss decreased (-0.751210 --> -0.756084).  Saving model ...
Epoch: 11 cost time: 1.4345321655273438
Epoch: 11, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.077 Vali Acc: 0.693 Test Loss: 1.077 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1834933757781982
Epoch: 12, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.192 Vali Acc: 0.732 Test Loss: 1.192 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.312570571899414
Epoch: 13, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.794 Vali Acc: 0.751 Test Loss: 1.794 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0695080757141113
Epoch: 14, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.381 Vali Acc: 0.727 Test Loss: 1.381 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1531472206115723
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.230 Vali Acc: 0.712 Test Loss: 1.230 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2839953899383545
Epoch: 16, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.553 Vali Acc: 0.741 Test Loss: 1.553 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1649022102355957
Epoch: 17, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.425 Vali Acc: 0.707 Test Loss: 1.425 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3291082382202148
Epoch: 18, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.541 Vali Acc: 0.741 Test Loss: 1.541 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1067800521850586
Epoch: 19, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.381 Vali Acc: 0.678 Test Loss: 1.381 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1129348278045654
Epoch: 20, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.517 Vali Acc: 0.702 Test Loss: 1.517 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 225548
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.507742166519165
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.876732349395752
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 0.9221413135528564
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.623 Vali Acc: 0.751 Test Loss: 0.623 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 0.8182828426361084
Epoch: 4, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8978102207183838
Epoch: 5, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.687 Vali Acc: 0.698 Test Loss: 0.687 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0962677001953125
Epoch: 6, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.678 Vali Acc: 0.702 Test Loss: 0.678 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9849531650543213
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.765 Vali Acc: 0.712 Test Loss: 0.765 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0665738582611084
Epoch: 8, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.894 Vali Acc: 0.737 Test Loss: 0.894 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8677070140838623
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.072 Vali Acc: 0.746 Test Loss: 1.072 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0341942310333252
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.078 Vali Acc: 0.746 Test Loss: 1.078 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9763612747192383
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.018 Vali Acc: 0.712 Test Loss: 1.018 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.013429880142212
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.097 Vali Acc: 0.620 Test Loss: 1.097 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9083783626556396
Epoch: 13, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.113 Vali Acc: 0.673 Test Loss: 1.113 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 228020
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.712397813796997
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1032423973083496
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.1160955429077148
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.3222944736480713
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.618 Vali Acc: 0.717 Test Loss: 0.618 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.392310619354248
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.630 Vali Acc: 0.712 Test Loss: 0.630 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0178158283233643
Epoch: 6, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0088050365447998
Epoch: 7, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.726 Vali Acc: 0.737 Test Loss: 0.726 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1912527084350586
Epoch: 8, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.846 Vali Acc: 0.732 Test Loss: 0.846 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1452486515045166
Epoch: 9, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.849 Vali Acc: 0.712 Test Loss: 0.849 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1627709865570068
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.953 Vali Acc: 0.727 Test Loss: 0.953 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1047754287719727
Epoch: 11, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.027 Vali Acc: 0.707 Test Loss: 1.027 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2469689846038818
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.016 Vali Acc: 0.585 Test Loss: 1.016 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4045138359069824
Epoch: 13, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.017 Vali Acc: 0.683 Test Loss: 1.017 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 229686
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.478361129760742
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.206932544708252
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.9052708148956299
Epoch: 3, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.2013111114501953
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.073385238647461
Epoch: 5, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.690 Vali Acc: 0.741 Test Loss: 0.690 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 0.9464142322540283
Epoch: 6, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.222118616104126
Epoch: 7, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.767 Vali Acc: 0.683 Test Loss: 0.767 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8726511001586914
Epoch: 8, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.826 Vali Acc: 0.693 Test Loss: 0.826 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0865108966827393
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.952 Vali Acc: 0.624 Test Loss: 0.952 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1537103652954102
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.942 Vali Acc: 0.693 Test Loss: 0.942 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8656926155090332
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.045 Vali Acc: 0.756 Test Loss: 1.045 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756087).  Saving model ...
Epoch: 12 cost time: 0.9179768562316895
Epoch: 12, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.289 Vali Acc: 0.746 Test Loss: 1.289 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.973236083984375
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.044 Vali Acc: 0.712 Test Loss: 1.044 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0597069263458252
Epoch: 14, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.124 Vali Acc: 0.683 Test Loss: 1.124 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7989058494567871
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.217 Vali Acc: 0.722 Test Loss: 1.217 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8801918029785156
Epoch: 16, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.264 Vali Acc: 0.712 Test Loss: 1.264 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.008467674255371
Epoch: 17, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.219 Vali Acc: 0.693 Test Loss: 1.219 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9794211387634277
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.305 Vali Acc: 0.722 Test Loss: 1.305 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.059427261352539
Epoch: 19, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.413 Vali Acc: 0.722 Test Loss: 1.413 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1552810668945312
Epoch: 20, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.409 Vali Acc: 0.707 Test Loss: 1.409 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.870807409286499
Epoch: 21, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.372 Vali Acc: 0.712 Test Loss: 1.372 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 230546
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7285654544830322
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.8127937316894531
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 0.8871252536773682
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.606 Vali Acc: 0.732 Test Loss: 0.606 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.794356107711792
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.706 Vali Acc: 0.673 Test Loss: 0.706 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9323418140411377
Epoch: 5, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.699 Vali Acc: 0.746 Test Loss: 0.699 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9478294849395752
Epoch: 6, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 0.9091293811798096
Epoch: 7, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.714 Vali Acc: 0.727 Test Loss: 0.714 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9541778564453125
Epoch: 8, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.788 Vali Acc: 0.693 Test Loss: 0.788 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.05275559425354
Epoch: 9, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.936 Vali Acc: 0.717 Test Loss: 0.936 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9102699756622314
Epoch: 10, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8180313110351562
Epoch: 11, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.037 Vali Acc: 0.649 Test Loss: 1.037 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.003295660018921
Epoch: 12, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.182 Vali Acc: 0.737 Test Loss: 1.182 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9010608196258545
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.231 Vali Acc: 0.737 Test Loss: 1.231 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8620846271514893
Epoch: 14, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.452 Vali Acc: 0.737 Test Loss: 1.452 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8509488105773926
Epoch: 15, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.333 Vali Acc: 0.727 Test Loss: 1.333 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0867681503295898
Epoch: 16, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.367 Vali Acc: 0.707 Test Loss: 1.367 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm64_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 230600
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2074737548828125
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.621 Vali Acc: 0.717 Test Loss: 0.621 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0258195400238037
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 0.9575333595275879
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.605 Vali Acc: 0.766 Test Loss: 0.605 Test Acc: 0.766
Validation loss decreased (-0.726823 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 0.9039568901062012
Epoch: 4, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.630 Vali Acc: 0.766 Test Loss: 0.630 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9426677227020264
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.727 Vali Acc: 0.746 Test Loss: 0.727 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8293545246124268
Epoch: 6, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.176 Vali Acc: 0.732 Test Loss: 1.176 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9450953006744385
Epoch: 7, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.846 Vali Acc: 0.751 Test Loss: 0.846 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2576656341552734
Epoch: 8, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.860 Vali Acc: 0.741 Test Loss: 0.860 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9805896282196045
Epoch: 9, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.801 Vali Acc: 0.741 Test Loss: 0.801 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1320834159851074
Epoch: 10, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.110 Vali Acc: 0.751 Test Loss: 1.110 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9890537261962891
Epoch: 11, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.102 Vali Acc: 0.751 Test Loss: 1.102 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9603590965270996
Epoch: 12, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.269 Vali Acc: 0.746 Test Loss: 1.269 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8179786205291748
Epoch: 13, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.079 Vali Acc: 0.717 Test Loss: 1.079 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 223760
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7523839473724365
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2607145309448242
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.1299405097961426
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.9265923500061035
Epoch: 4, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.595 Vali Acc: 0.741 Test Loss: 0.595 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8918919563293457
Epoch: 5, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 0.908637523651123
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1314330101013184
Epoch: 7, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.817 Vali Acc: 0.741 Test Loss: 0.817 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.123878002166748
Epoch: 8, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.802 Vali Acc: 0.727 Test Loss: 0.802 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8878045082092285
Epoch: 9, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.883 Vali Acc: 0.751 Test Loss: 0.883 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8918783664703369
Epoch: 10, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.836 Vali Acc: 0.732 Test Loss: 0.836 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1983118057250977
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.957 Vali Acc: 0.634 Test Loss: 0.957 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1095314025878906
Epoch: 12, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.056 Vali Acc: 0.741 Test Loss: 1.056 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9443612098693848
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.059 Vali Acc: 0.688 Test Loss: 1.059 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2305541038513184
Epoch: 14, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.139 Vali Acc: 0.673 Test Loss: 1.139 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0176515579223633
Epoch: 15, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.159 Vali Acc: 0.649 Test Loss: 1.159 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 222281
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs102_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2226624488830566
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2793190479278564
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.0094473361968994
Epoch: 3, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
Validation loss decreased (-0.731701 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 0.8374886512756348
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7992980480194092
Epoch: 5, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.125786304473877
Epoch: 6, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.954 Vali Acc: 0.732 Test Loss: 0.954 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0703649520874023
Epoch: 7, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.951 Vali Acc: 0.732 Test Loss: 0.951 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2002058029174805
Epoch: 8, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.798 Vali Acc: 0.688 Test Loss: 0.798 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0022356510162354
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.850 Vali Acc: 0.717 Test Loss: 0.850 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9667091369628906
Epoch: 10, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.962 Vali Acc: 0.737 Test Loss: 0.962 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.956000804901123
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.040 Vali Acc: 0.741 Test Loss: 1.040 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9919865131378174
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.130 Vali Acc: 0.678 Test Loss: 1.130 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9042577743530273
Epoch: 13, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.268 Vali Acc: 0.727 Test Loss: 1.268 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs102_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 222986
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.046261787414551
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.635 Vali Acc: 0.712 Test Loss: 0.635 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.2935478687286377
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.2673487663269043
Epoch: 3, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.563 Vali Acc: 0.761 Test Loss: 0.563 Test Acc: 0.761
Validation loss decreased (-0.731701 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.0470216274261475
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.661 Vali Acc: 0.751 Test Loss: 0.661 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.066512107849121
Epoch: 5, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.641 Vali Acc: 0.712 Test Loss: 0.641 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8776044845581055
Epoch: 6, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.635 Vali Acc: 0.712 Test Loss: 0.635 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3886659145355225
Epoch: 7, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.692 Vali Acc: 0.678 Test Loss: 0.692 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1807341575622559
Epoch: 8, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.839 Vali Acc: 0.634 Test Loss: 0.839 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5250627994537354
Epoch: 9, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.741 Vali Acc: 0.683 Test Loss: 0.741 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.431718111038208
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.920 Vali Acc: 0.732 Test Loss: 0.920 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9975700378417969
Epoch: 11, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.967 Vali Acc: 0.712 Test Loss: 0.967 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1394407749176025
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.993 Vali Acc: 0.673 Test Loss: 0.993 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0392253398895264
Epoch: 13, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.100 Vali Acc: 0.727 Test Loss: 1.100 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 221457
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7495505809783936
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.0163087844848633
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0275394916534424
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.638 Vali Acc: 0.751 Test Loss: 0.638 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 1.0600266456604004
Epoch: 4, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.596 Vali Acc: 0.741 Test Loss: 0.596 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3619134426116943
Epoch: 5, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.800 Vali Acc: 0.732 Test Loss: 0.800 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1590020656585693
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.842 Vali Acc: 0.732 Test Loss: 0.842 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.307774543762207
Epoch: 7, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.750 Vali Acc: 0.732 Test Loss: 0.750 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4667246341705322
Epoch: 8, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.775 Vali Acc: 0.673 Test Loss: 0.775 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9984245300292969
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.872 Vali Acc: 0.654 Test Loss: 0.872 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2938671112060547
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.936 Vali Acc: 0.727 Test Loss: 0.936 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2673039436340332
Epoch: 11, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3104133605957031
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.067 Vali Acc: 0.727 Test Loss: 1.067 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3696115016937256
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.047 Vali Acc: 0.693 Test Loss: 1.047 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 222490
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8900887966156006
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.617 Vali Acc: 0.717 Test Loss: 0.617 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.9676642417907715
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.584 Vali Acc: 0.751 Test Loss: 0.584 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.0107028484344482
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.641 Vali Acc: 0.698 Test Loss: 0.641 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0043411254882812
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.625 Vali Acc: 0.741 Test Loss: 0.625 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9919681549072266
Epoch: 5, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.001176357269287
Epoch: 6, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.758 Vali Acc: 0.683 Test Loss: 0.758 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0430254936218262
Epoch: 7, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.949 Vali Acc: 0.493 Test Loss: 0.949 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9470417499542236
Epoch: 8, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.747 Vali Acc: 0.693 Test Loss: 0.747 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.98048996925354
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.910 Vali Acc: 0.737 Test Loss: 0.910 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9753456115722656
Epoch: 10, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.884 Vali Acc: 0.712 Test Loss: 0.884 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7690293788909912
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.979 Vali Acc: 0.688 Test Loss: 0.979 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9559340476989746
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.123 Vali Acc: 0.624 Test Loss: 1.123 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 221550
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.591276168823242
Epoch: 1, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.666 Vali Acc: 0.712 Test Loss: 0.666 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 1.1352667808532715
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (-0.712188 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.8304762840270996
Epoch: 3, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.672 Vali Acc: 0.732 Test Loss: 0.672 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 1.0654890537261963
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.623 Vali Acc: 0.761 Test Loss: 0.623 Test Acc: 0.761
Validation loss decreased (-0.731701 --> -0.760969).  Saving model ...
Epoch: 5 cost time: 0.8343260288238525
Epoch: 5, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.623 Vali Acc: 0.688 Test Loss: 0.623 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9286417961120605
Epoch: 6, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.698 Vali Acc: 0.756 Test Loss: 0.698 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.283341884613037
Epoch: 7, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.763 Vali Acc: 0.698 Test Loss: 0.763 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9780914783477783
Epoch: 8, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.872 Vali Acc: 0.751 Test Loss: 0.872 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9147653579711914
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.852 Vali Acc: 0.737 Test Loss: 0.852 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7719032764434814
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.844 Vali Acc: 0.707 Test Loss: 0.844 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.84332275390625
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.005 Vali Acc: 0.702 Test Loss: 1.005 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8042750358581543
Epoch: 12, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.275 Vali Acc: 0.746 Test Loss: 1.275 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7825732231140137
Epoch: 13, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.276 Vali Acc: 0.717 Test Loss: 1.276 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8164851665496826
Epoch: 14, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.376 Vali Acc: 0.746 Test Loss: 1.376 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 222282
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.26369571685791
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.9713938236236572
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.573 Vali Acc: 0.761 Test Loss: 0.573 Test Acc: 0.761
Validation loss decreased (-0.717067 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 0.9152219295501709
Epoch: 3, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.605 Vali Acc: 0.732 Test Loss: 0.605 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6301920413970947
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.678 Vali Acc: 0.766 Test Loss: 0.678 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 5 cost time: 0.8011562824249268
Epoch: 5, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.678 Vali Acc: 0.751 Test Loss: 0.678 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9353363513946533
Epoch: 6, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.753 Vali Acc: 0.737 Test Loss: 0.753 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1023457050323486
Epoch: 7, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.934 Vali Acc: 0.737 Test Loss: 0.934 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9384009838104248
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.940 Vali Acc: 0.732 Test Loss: 0.940 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9013519287109375
Epoch: 9, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0606067180633545
Epoch: 10, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.977 Vali Acc: 0.741 Test Loss: 0.977 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9153234958648682
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8039937019348145
Epoch: 12, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.036 Vali Acc: 0.717 Test Loss: 1.036 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0263996124267578
Epoch: 13, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.179 Vali Acc: 0.722 Test Loss: 1.179 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9482965469360352
Epoch: 14, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.197 Vali Acc: 0.722 Test Loss: 1.197 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 221009
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8798577785491943
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.620 Vali Acc: 0.717 Test Loss: 0.620 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.036262035369873
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.676 Vali Acc: 0.722 Test Loss: 0.676 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 0.8468499183654785
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
Validation loss decreased (-0.721944 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 0.862220287322998
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.1149072647094727
Epoch: 5, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.669 Vali Acc: 0.722 Test Loss: 0.669 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0452542304992676
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.997 Vali Acc: 0.746 Test Loss: 0.997 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0673799514770508
Epoch: 7, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.064 Vali Acc: 0.746 Test Loss: 1.064 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.098942518234253
Epoch: 8, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.938 Vali Acc: 0.746 Test Loss: 0.938 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0082623958587646
Epoch: 9, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.888 Vali Acc: 0.746 Test Loss: 0.888 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.048750638961792
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.076 Vali Acc: 0.741 Test Loss: 1.076 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8694131374359131
Epoch: 11, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.245 Vali Acc: 0.746 Test Loss: 1.245 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8967156410217285
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.150 Vali Acc: 0.727 Test Loss: 1.150 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.350574254989624
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.306 Vali Acc: 0.722 Test Loss: 1.306 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8132171630859375
Epoch: 14, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.304 Vali Acc: 0.717 Test Loss: 1.304 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 223012
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.920552968978882
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 0.970301628112793
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.8201460838317871
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 0.8606369495391846
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 0.8675658702850342
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.694 Vali Acc: 0.741 Test Loss: 0.694 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.944861650466919
Epoch: 6, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.769 Vali Acc: 0.722 Test Loss: 0.769 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1370384693145752
Epoch: 7, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8681344985961914
Epoch: 8, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.843 Vali Acc: 0.722 Test Loss: 0.843 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8740665912628174
Epoch: 9, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.910 Vali Acc: 0.673 Test Loss: 0.910 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9305684566497803
Epoch: 10, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0620169639587402
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.024 Vali Acc: 0.659 Test Loss: 1.024 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1519901752471924
Epoch: 12, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.130 Vali Acc: 0.702 Test Loss: 1.130 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8616042137145996
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.082 Vali Acc: 0.702 Test Loss: 1.082 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9001772403717041
Epoch: 14, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.125 Vali Acc: 0.707 Test Loss: 1.125 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 221779
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.988760232925415
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.8736865520477295
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 0.8400981426239014
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.584 Vali Acc: 0.756 Test Loss: 0.584 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.9318020343780518
Epoch: 4, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0505132675170898
Epoch: 5, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1898961067199707
Epoch: 6, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.961200475692749
Epoch: 7, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.799 Vali Acc: 0.615 Test Loss: 0.799 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2371807098388672
Epoch: 8, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.925 Vali Acc: 0.488 Test Loss: 0.925 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.836972713470459
Epoch: 9, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.864 Vali Acc: 0.649 Test Loss: 0.864 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1017327308654785
Epoch: 10, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.801 Vali Acc: 0.668 Test Loss: 0.801 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.018144130706787
Epoch: 11, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.922 Vali Acc: 0.659 Test Loss: 0.922 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0086026191711426
Epoch: 12, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.912 Vali Acc: 0.707 Test Loss: 0.912 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2463040351867676
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.993 Vali Acc: 0.678 Test Loss: 0.993 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 222186
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.103461980819702
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2029213905334473
Epoch: 2, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0231444835662842
Epoch: 3, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.737 Vali Acc: 0.571 Test Loss: 0.737 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.011143684387207
Epoch: 4, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.851 Vali Acc: 0.732 Test Loss: 0.851 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731699).  Saving model ...
Epoch: 5 cost time: 0.7872872352600098
Epoch: 5, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.812 Vali Acc: 0.741 Test Loss: 0.812 Test Acc: 0.741
Validation loss decreased (-0.731699 --> -0.741455).  Saving model ...
Epoch: 6 cost time: 1.1526579856872559
Epoch: 6, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.598 Vali Acc: 0.751 Test Loss: 0.598 Test Acc: 0.751
Validation loss decreased (-0.741455 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.0980579853057861
Epoch: 7, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.830 Vali Acc: 0.737 Test Loss: 0.830 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0655920505523682
Epoch: 8, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.857 Vali Acc: 0.659 Test Loss: 0.857 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9273664951324463
Epoch: 9, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.894 Vali Acc: 0.732 Test Loss: 0.894 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8638648986816406
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.962 Vali Acc: 0.746 Test Loss: 0.962 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9855449199676514
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.011 Vali Acc: 0.693 Test Loss: 1.011 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9383232593536377
Epoch: 12, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.075 Vali Acc: 0.688 Test Loss: 1.075 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.872969388961792
Epoch: 13, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.142 Vali Acc: 0.683 Test Loss: 1.142 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0907037258148193
Epoch: 14, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.299 Vali Acc: 0.659 Test Loss: 1.299 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1140093803405762
Epoch: 15, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.337 Vali Acc: 0.717 Test Loss: 1.337 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.129713535308838
Epoch: 16, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.620 Vali Acc: 0.732 Test Loss: 1.620 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 225448
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7832536697387695
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.8796138763427734
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 0.8879189491271973
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.664 Vali Acc: 0.737 Test Loss: 0.664 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 0.9584922790527344
Epoch: 4, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.1395552158355713
Epoch: 5, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8725306987762451
Epoch: 6, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.741 Vali Acc: 0.693 Test Loss: 0.741 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2795910835266113
Epoch: 7, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.759 Vali Acc: 0.756 Test Loss: 0.759 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756090).  Saving model ...
Epoch: 8 cost time: 1.2031679153442383
Epoch: 8, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.758 Vali Acc: 0.737 Test Loss: 0.758 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.021042823791504
Epoch: 9, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.892 Vali Acc: 0.732 Test Loss: 0.892 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0769710540771484
Epoch: 10, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.930 Vali Acc: 0.654 Test Loss: 0.930 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0345549583435059
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.012 Vali Acc: 0.634 Test Loss: 1.012 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9538366794586182
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.106 Vali Acc: 0.639 Test Loss: 1.106 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9098203182220459
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.165 Vali Acc: 0.732 Test Loss: 1.165 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2030384540557861
Epoch: 14, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.283 Vali Acc: 0.732 Test Loss: 1.283 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.143862247467041
Epoch: 15, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.258 Vali Acc: 0.712 Test Loss: 1.258 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1160624027252197
Epoch: 16, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.439 Vali Acc: 0.717 Test Loss: 1.439 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9241912364959717
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.258 Vali Acc: 0.717 Test Loss: 1.258 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 221408
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.441145420074463
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.591 Vali Acc: 0.712 Test Loss: 0.591 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.8339543342590332
Epoch: 2, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
Validation loss decreased (-0.712189 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 0.7516846656799316
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.593 Vali Acc: 0.766 Test Loss: 0.593 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 0.9655683040618896
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.745 Vali Acc: 0.741 Test Loss: 0.745 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7478058338165283
Epoch: 5, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.641 Vali Acc: 0.756 Test Loss: 0.641 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9074585437774658
Epoch: 6, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.667 Vali Acc: 0.732 Test Loss: 0.667 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.029158592224121
Epoch: 7, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.769 Vali Acc: 0.746 Test Loss: 0.769 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.899796724319458
Epoch: 8, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.793 Vali Acc: 0.741 Test Loss: 0.793 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9309093952178955
Epoch: 9, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.937 Vali Acc: 0.746 Test Loss: 0.937 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7753500938415527
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.021 Vali Acc: 0.746 Test Loss: 1.021 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0464551448822021
Epoch: 11, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.163 Vali Acc: 0.737 Test Loss: 1.163 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8974318504333496
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.316 Vali Acc: 0.741 Test Loss: 1.316 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0810632705688477
Epoch: 13, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.219 Vali Acc: 0.727 Test Loss: 1.219 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 221033
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.894780397415161
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.597 Vali Acc: 0.712 Test Loss: 0.597 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0817160606384277
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.657 Vali Acc: 0.712 Test Loss: 0.657 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8315303325653076
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.639 Vali Acc: 0.741 Test Loss: 0.639 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 0.8946807384490967
Epoch: 4, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.645 Vali Acc: 0.737 Test Loss: 0.645 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0009737014770508
Epoch: 5, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.578 Vali Acc: 0.698 Test Loss: 0.578 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0368916988372803
Epoch: 6, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.696 Vali Acc: 0.698 Test Loss: 0.696 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.103421926498413
Epoch: 7, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.788 Vali Acc: 0.654 Test Loss: 0.788 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8946316242218018
Epoch: 8, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.831 Vali Acc: 0.732 Test Loss: 0.831 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9458467960357666
Epoch: 9, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.985 Vali Acc: 0.737 Test Loss: 0.985 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9369635581970215
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.934 Vali Acc: 0.732 Test Loss: 0.934 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9988768100738525
Epoch: 11, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.999 Vali Acc: 0.722 Test Loss: 0.999 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2912499904632568
Epoch: 12, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.166 Vali Acc: 0.722 Test Loss: 1.166 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.096252679824829
Epoch: 13, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.108 Vali Acc: 0.717 Test Loss: 1.108 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 225538
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8083276748657227
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1791913509368896
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.0574724674224854
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.31624436378479
Epoch: 4, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.627 Vali Acc: 0.751 Test Loss: 0.627 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 1.1513793468475342
Epoch: 5, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1735987663269043
Epoch: 6, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.746 Vali Acc: 0.741 Test Loss: 0.746 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9325153827667236
Epoch: 7, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.776 Vali Acc: 0.712 Test Loss: 0.776 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0779430866241455
Epoch: 8, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.973 Vali Acc: 0.663 Test Loss: 0.973 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1703784465789795
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.841 Vali Acc: 0.634 Test Loss: 0.841 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0307209491729736
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.173 Vali Acc: 0.727 Test Loss: 1.173 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9727084636688232
Epoch: 11, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.328 Vali Acc: 0.732 Test Loss: 1.328 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1535310745239258
Epoch: 12, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.389 Vali Acc: 0.732 Test Loss: 1.389 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0019519329071045
Epoch: 13, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.307 Vali Acc: 0.707 Test Loss: 1.307 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0679457187652588
Epoch: 14, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.298 Vali Acc: 0.717 Test Loss: 1.298 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 222336
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.294588088989258
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.628 Vali Acc: 0.707 Test Loss: 0.628 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 0.9907646179199219
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
Validation loss decreased (-0.707311 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.0690710544586182
Epoch: 3, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.741458 --> -0.775604).  Saving model ...
Epoch: 4 cost time: 0.9566974639892578
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.573 Vali Acc: 0.771 Test Loss: 0.573 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9097476005554199
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9894187450408936
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.135349988937378
Epoch: 7, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8474092483520508
Epoch: 8, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.861 Vali Acc: 0.741 Test Loss: 0.861 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2729992866516113
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8948647975921631
Epoch: 10, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.842 Vali Acc: 0.737 Test Loss: 0.842 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9292562007904053
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.980 Vali Acc: 0.741 Test Loss: 0.980 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.035961627960205
Epoch: 12, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.099 Vali Acc: 0.751 Test Loss: 1.099 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9193077087402344
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.986 Vali Acc: 0.634 Test Loss: 0.986 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 224824
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.036714553833008
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.7835628986358643
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 0.9552512168884277
Epoch: 3, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.782 Vali Acc: 0.727 Test Loss: 0.782 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0263023376464844
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.683 Vali Acc: 0.732 Test Loss: 0.683 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1900808811187744
Epoch: 5, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 0.7572042942047119
Epoch: 6, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.706 Vali Acc: 0.732 Test Loss: 0.706 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.79435133934021
Epoch: 7, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.719 Vali Acc: 0.693 Test Loss: 0.719 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7963311672210693
Epoch: 8, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.867 Vali Acc: 0.756 Test Loss: 0.867 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756089).  Saving model ...
Epoch: 9 cost time: 0.8460288047790527
Epoch: 9, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.097 Vali Acc: 0.741 Test Loss: 1.097 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.017913818359375
Epoch: 10, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.036 Vali Acc: 0.746 Test Loss: 1.036 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9458324909210205
Epoch: 11, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.044 Vali Acc: 0.732 Test Loss: 1.044 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8630008697509766
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.034 Vali Acc: 0.727 Test Loss: 1.034 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.162062644958496
Epoch: 13, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.137 Vali Acc: 0.605 Test Loss: 1.137 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8098666667938232
Epoch: 14, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.219 Vali Acc: 0.727 Test Loss: 1.219 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9904241561889648
Epoch: 15, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.302 Vali Acc: 0.688 Test Loss: 1.302 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.006885290145874
Epoch: 16, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.220 Vali Acc: 0.693 Test Loss: 1.220 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8237462043762207
Epoch: 17, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.159 Vali Acc: 0.634 Test Loss: 1.159 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7661705017089844
Epoch: 18, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.138 Vali Acc: 0.698 Test Loss: 1.138 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 226506
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2009057998657227
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.8069510459899902
Epoch: 2, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.715 Vali Acc: 0.702 Test Loss: 0.715 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8379008769989014
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
Validation loss decreased (-0.712189 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 0.7696404457092285
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.629 Vali Acc: 0.693 Test Loss: 0.629 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0001776218414307
Epoch: 5, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.686 Vali Acc: 0.761 Test Loss: 0.686 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 6 cost time: 1.0113141536712646
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.760969 --> -0.760969).  Saving model ...
Epoch: 7 cost time: 0.9806983470916748
Epoch: 7, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.816612958908081
Epoch: 8, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.972 Vali Acc: 0.746 Test Loss: 0.972 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9899964332580566
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.904 Vali Acc: 0.766 Test Loss: 0.904 Test Acc: 0.766
Validation loss decreased (-0.760969 --> -0.765845).  Saving model ...
Epoch: 10 cost time: 1.0268044471740723
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.011 Vali Acc: 0.756 Test Loss: 1.011 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4094576835632324
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.040 Vali Acc: 0.722 Test Loss: 1.040 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9306507110595703
Epoch: 12, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.088 Vali Acc: 0.707 Test Loss: 1.088 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.081533432006836
Epoch: 13, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.223 Vali Acc: 0.712 Test Loss: 1.223 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1249287128448486
Epoch: 14, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.772 Vali Acc: 0.727 Test Loss: 1.772 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9623880386352539
Epoch: 15, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.537 Vali Acc: 0.741 Test Loss: 1.537 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9741635322570801
Epoch: 16, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.510 Vali Acc: 0.712 Test Loss: 1.510 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0489501953125
Epoch: 17, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.506 Vali Acc: 0.639 Test Loss: 1.506 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1685230731964111
Epoch: 18, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.485 Vali Acc: 0.707 Test Loss: 1.485 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8390469551086426
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.645 Vali Acc: 0.722 Test Loss: 1.645 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 227382
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.942087411880493
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.8855030536651611
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.669 Vali Acc: 0.717 Test Loss: 0.669 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717066).  Saving model ...
Epoch: 3 cost time: 0.8203890323638916
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
Validation loss decreased (-0.717066 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 0.9749550819396973
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 0.8214924335479736
Epoch: 5, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.830834150314331
Epoch: 6, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.642 Vali Acc: 0.727 Test Loss: 0.642 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8535778522491455
Epoch: 7, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.797 Vali Acc: 0.702 Test Loss: 0.797 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7683727741241455
Epoch: 8, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.709 Vali Acc: 0.698 Test Loss: 0.709 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1496086120605469
Epoch: 9, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9030070304870605
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.901 Vali Acc: 0.732 Test Loss: 0.901 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9696860313415527
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.963 Vali Acc: 0.698 Test Loss: 0.963 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9357085227966309
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.013 Vali Acc: 0.702 Test Loss: 1.013 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9854240417480469
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.169 Vali Acc: 0.663 Test Loss: 1.169 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0468060970306396
Epoch: 14, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.193 Vali Acc: 0.732 Test Loss: 1.193 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_LightTS_UEA_ftM_sl405_ll0_pl0_dm32_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 227452
model size : 0.88MB
