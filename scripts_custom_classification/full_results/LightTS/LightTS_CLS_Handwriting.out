Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.343264579772949
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.331 Vali Acc: 0.047 Test Loss: 3.331 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.699073076248169
Epoch: 2, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.319 Vali Acc: 0.049 Test Loss: 3.319 Test Acc: 0.049
Validation loss decreased (-0.047026 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.7407443523406982
Epoch: 3, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.304 Vali Acc: 0.058 Test Loss: 3.304 Test Acc: 0.058
Validation loss decreased (-0.049379 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.6676115989685059
Epoch: 4, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.290 Vali Acc: 0.068 Test Loss: 3.290 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 0.7570815086364746
Epoch: 5, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.277 Vali Acc: 0.076 Test Loss: 3.277 Test Acc: 0.076
Validation loss decreased (-0.068202 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.8400232791900635
Epoch: 6, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.268 Vali Acc: 0.082 Test Loss: 3.268 Test Acc: 0.082
Validation loss decreased (-0.076438 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 0.7487881183624268
Epoch: 7, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.262 Vali Acc: 0.099 Test Loss: 3.262 Test Acc: 0.099
Validation loss decreased (-0.082320 --> -0.098791).  Saving model ...
Epoch: 8 cost time: 0.6848406791687012
Epoch: 8, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.261 Vali Acc: 0.105 Test Loss: 3.261 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104673).  Saving model ...
Epoch: 9 cost time: 0.6991961002349854
Epoch: 9, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.251 Vali Acc: 0.114 Test Loss: 3.251 Test Acc: 0.114
Validation loss decreased (-0.104673 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 0.8602297306060791
Epoch: 10, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.253 Vali Acc: 0.116 Test Loss: 3.253 Test Acc: 0.116
Validation loss decreased (-0.114085 --> -0.116438).  Saving model ...
Epoch: 11 cost time: 0.7363669872283936
Epoch: 11, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.257 Vali Acc: 0.124 Test Loss: 3.257 Test Acc: 0.124
Validation loss decreased (-0.116438 --> -0.123497).  Saving model ...
Epoch: 12 cost time: 0.7420146465301514
Epoch: 12, Steps: 10 | Train Loss: 2.245 Vali Loss: 3.269 Vali Acc: 0.134 Test Loss: 3.269 Test Acc: 0.134
Validation loss decreased (-0.123497 --> -0.134085).  Saving model ...
Epoch: 13 cost time: 0.6898458003997803
Epoch: 13, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.284 Vali Acc: 0.151 Test Loss: 3.284 Test Acc: 0.151
Validation loss decreased (-0.134085 --> -0.150555).  Saving model ...
Epoch: 14 cost time: 0.7016255855560303
Epoch: 14, Steps: 10 | Train Loss: 1.883 Vali Loss: 3.338 Vali Acc: 0.160 Test Loss: 3.338 Test Acc: 0.160
Validation loss decreased (-0.150555 --> -0.159967).  Saving model ...
Epoch: 15 cost time: 0.6770813465118408
Epoch: 15, Steps: 10 | Train Loss: 1.744 Vali Loss: 3.433 Vali Acc: 0.168 Test Loss: 3.433 Test Acc: 0.168
Validation loss decreased (-0.159967 --> -0.168201).  Saving model ...
Epoch: 16 cost time: 0.680060625076294
Epoch: 16, Steps: 10 | Train Loss: 1.540 Vali Loss: 3.520 Vali Acc: 0.180 Test Loss: 3.520 Test Acc: 0.180
Validation loss decreased (-0.168201 --> -0.179965).  Saving model ...
Epoch: 17 cost time: 0.773449182510376
Epoch: 17, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.636 Vali Acc: 0.186 Test Loss: 3.636 Test Acc: 0.186
Validation loss decreased (-0.179965 --> -0.185846).  Saving model ...
Epoch: 18 cost time: 0.584540843963623
Epoch: 18, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.778 Vali Acc: 0.192 Test Loss: 3.778 Test Acc: 0.192
Validation loss decreased (-0.185846 --> -0.191727).  Saving model ...
Epoch: 19 cost time: 0.7192504405975342
Epoch: 19, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.915 Vali Acc: 0.195 Test Loss: 3.915 Test Acc: 0.195
Validation loss decreased (-0.191727 --> -0.195255).  Saving model ...
Epoch: 20 cost time: 0.6825776100158691
Epoch: 20, Steps: 10 | Train Loss: 0.931 Vali Loss: 4.114 Vali Acc: 0.184 Test Loss: 4.114 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7593052387237549
Epoch: 21, Steps: 10 | Train Loss: 0.753 Vali Loss: 4.272 Vali Acc: 0.193 Test Loss: 4.272 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5845808982849121
Epoch: 22, Steps: 10 | Train Loss: 0.635 Vali Loss: 4.552 Vali Acc: 0.192 Test Loss: 4.552 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8233699798583984
Epoch: 23, Steps: 10 | Train Loss: 0.475 Vali Loss: 4.812 Vali Acc: 0.196 Test Loss: 4.812 Test Acc: 0.196
Validation loss decreased (-0.195255 --> -0.196422).  Saving model ...
Epoch: 24 cost time: 0.8560543060302734
Epoch: 24, Steps: 10 | Train Loss: 0.406 Vali Loss: 5.272 Vali Acc: 0.199 Test Loss: 5.272 Test Acc: 0.199
Validation loss decreased (-0.196422 --> -0.198771).  Saving model ...
Epoch: 25 cost time: 0.7509729862213135
Epoch: 25, Steps: 10 | Train Loss: 0.294 Vali Loss: 5.543 Vali Acc: 0.185 Test Loss: 5.543 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9095897674560547
Epoch: 26, Steps: 10 | Train Loss: 0.203 Vali Loss: 5.922 Vali Acc: 0.187 Test Loss: 5.922 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7061340808868408
Epoch: 27, Steps: 10 | Train Loss: 0.143 Vali Loss: 6.349 Vali Acc: 0.191 Test Loss: 6.349 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7003097534179688
Epoch: 28, Steps: 10 | Train Loss: 0.097 Vali Loss: 6.882 Vali Acc: 0.185 Test Loss: 6.882 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7564432621002197
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 7.307 Vali Acc: 0.186 Test Loss: 7.307 Test Acc: 0.186
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7702839374542236
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 7.690 Vali Acc: 0.186 Test Loss: 7.690 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9427423477172852
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 8.058 Vali Acc: 0.182 Test Loss: 8.058 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6307845115661621
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 8.301 Vali Acc: 0.187 Test Loss: 8.301 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.858128547668457
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 8.584 Vali Acc: 0.186 Test Loss: 8.584 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8168845176696777
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 8.889 Vali Acc: 0.186 Test Loss: 8.889 Test Acc: 0.186
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1988235294117647
model parameter : 163704
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6921486854553223
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.323 Vali Acc: 0.034 Test Loss: 3.323 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.9325225353240967
Epoch: 2, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.311 Vali Acc: 0.041 Test Loss: 3.311 Test Acc: 0.041
Validation loss decreased (-0.034084 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.8408863544464111
Epoch: 3, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.297 Vali Acc: 0.045 Test Loss: 3.297 Test Acc: 0.045
Validation loss decreased (-0.041143 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.8609943389892578
Epoch: 4, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.283 Vali Acc: 0.054 Test Loss: 3.283 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.80464768409729
Epoch: 5, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.270 Vali Acc: 0.064 Test Loss: 3.270 Test Acc: 0.064
Validation loss decreased (-0.054085 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.9019691944122314
Epoch: 6, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.263 Vali Acc: 0.072 Test Loss: 3.263 Test Acc: 0.072
Validation loss decreased (-0.063497 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.8051838874816895
Epoch: 7, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.256 Vali Acc: 0.081 Test Loss: 3.256 Test Acc: 0.081
Validation loss decreased (-0.071732 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.6306004524230957
Epoch: 8, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.248 Vali Acc: 0.094 Test Loss: 3.248 Test Acc: 0.094
Validation loss decreased (-0.081144 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.7840538024902344
Epoch: 9, Steps: 10 | Train Loss: 2.626 Vali Loss: 3.247 Vali Acc: 0.102 Test Loss: 3.247 Test Acc: 0.102
Validation loss decreased (-0.094085 --> -0.102320).  Saving model ...
Epoch: 10 cost time: 0.7188684940338135
Epoch: 10, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.245 Vali Acc: 0.108 Test Loss: 3.245 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.9689009189605713
Epoch: 11, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.251 Vali Acc: 0.108 Test Loss: 3.251 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8149940967559814
Epoch: 12, Steps: 10 | Train Loss: 2.305 Vali Loss: 3.246 Vali Acc: 0.118 Test Loss: 3.246 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 0.9695558547973633
Epoch: 13, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.244 Vali Acc: 0.121 Test Loss: 3.244 Test Acc: 0.121
Validation loss decreased (-0.117615 --> -0.121144).  Saving model ...
Epoch: 14 cost time: 0.8906376361846924
Epoch: 14, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.262 Vali Acc: 0.138 Test Loss: 3.262 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137614).  Saving model ...
Epoch: 15 cost time: 0.9087042808532715
Epoch: 15, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.282 Vali Acc: 0.145 Test Loss: 3.282 Test Acc: 0.145
Validation loss decreased (-0.137614 --> -0.144673).  Saving model ...
Epoch: 16 cost time: 1.1357665061950684
Epoch: 16, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.337 Vali Acc: 0.151 Test Loss: 3.337 Test Acc: 0.151
Validation loss decreased (-0.144673 --> -0.150555).  Saving model ...
Epoch: 17 cost time: 0.8444514274597168
Epoch: 17, Steps: 10 | Train Loss: 1.586 Vali Loss: 3.423 Vali Acc: 0.164 Test Loss: 3.423 Test Acc: 0.164
Validation loss decreased (-0.150555 --> -0.163495).  Saving model ...
Epoch: 18 cost time: 0.8174450397491455
Epoch: 18, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.501 Vali Acc: 0.168 Test Loss: 3.501 Test Acc: 0.168
Validation loss decreased (-0.163495 --> -0.168200).  Saving model ...
Epoch: 19 cost time: 0.6654050350189209
Epoch: 19, Steps: 10 | Train Loss: 1.311 Vali Loss: 3.605 Vali Acc: 0.171 Test Loss: 3.605 Test Acc: 0.171
Validation loss decreased (-0.168200 --> -0.170552).  Saving model ...
Epoch: 20 cost time: 0.9170663356781006
Epoch: 20, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.714 Vali Acc: 0.172 Test Loss: 3.714 Test Acc: 0.172
Validation loss decreased (-0.170552 --> -0.171728).  Saving model ...
Epoch: 21 cost time: 0.8480572700500488
Epoch: 21, Steps: 10 | Train Loss: 1.014 Vali Loss: 3.870 Vali Acc: 0.188 Test Loss: 3.870 Test Acc: 0.188
Validation loss decreased (-0.171728 --> -0.188197).  Saving model ...
Epoch: 22 cost time: 1.0112547874450684
Epoch: 22, Steps: 10 | Train Loss: 0.826 Vali Loss: 4.097 Vali Acc: 0.185 Test Loss: 4.097 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7909190654754639
Epoch: 23, Steps: 10 | Train Loss: 0.690 Vali Loss: 4.283 Vali Acc: 0.188 Test Loss: 4.283 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9507672786712646
Epoch: 24, Steps: 10 | Train Loss: 0.568 Vali Loss: 4.524 Vali Acc: 0.185 Test Loss: 4.524 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2039353847503662
Epoch: 25, Steps: 10 | Train Loss: 0.470 Vali Loss: 4.766 Vali Acc: 0.182 Test Loss: 4.766 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9620487689971924
Epoch: 26, Steps: 10 | Train Loss: 0.389 Vali Loss: 5.145 Vali Acc: 0.185 Test Loss: 5.145 Test Acc: 0.185
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9552013874053955
Epoch: 27, Steps: 10 | Train Loss: 0.259 Vali Loss: 5.482 Vali Acc: 0.180 Test Loss: 5.482 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7866373062133789
Epoch: 28, Steps: 10 | Train Loss: 0.202 Vali Loss: 5.864 Vali Acc: 0.186 Test Loss: 5.864 Test Acc: 0.186
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8249897956848145
Epoch: 29, Steps: 10 | Train Loss: 0.120 Vali Loss: 6.326 Vali Acc: 0.180 Test Loss: 6.326 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7692670822143555
Epoch: 30, Steps: 10 | Train Loss: 0.083 Vali Loss: 6.672 Vali Acc: 0.187 Test Loss: 6.672 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8047168254852295
Epoch: 31, Steps: 10 | Train Loss: 0.052 Vali Loss: 7.151 Vali Acc: 0.188 Test Loss: 7.151 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18823529411764706
model parameter : 157470
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.295699119567871
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.355 Vali Acc: 0.027 Test Loss: 3.355 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 0.9218595027923584
Epoch: 2, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.343 Vali Acc: 0.027 Test Loss: 3.343 Test Acc: 0.027
Validation loss decreased (-0.027025 --> -0.027025).  Saving model ...
Epoch: 3 cost time: 0.9621038436889648
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.329 Vali Acc: 0.035 Test Loss: 3.329 Test Acc: 0.035
Validation loss decreased (-0.027025 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 0.8330740928649902
Epoch: 4, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.314 Vali Acc: 0.041 Test Loss: 3.314 Test Acc: 0.041
Validation loss decreased (-0.035261 --> -0.041143).  Saving model ...
Epoch: 5 cost time: 0.8374438285827637
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.302 Vali Acc: 0.051 Test Loss: 3.302 Test Acc: 0.051
Validation loss decreased (-0.041143 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 0.7747726440429688
Epoch: 6, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.294 Vali Acc: 0.053 Test Loss: 3.294 Test Acc: 0.053
Validation loss decreased (-0.050555 --> -0.052908).  Saving model ...
Epoch: 7 cost time: 0.9813101291656494
Epoch: 7, Steps: 10 | Train Loss: 2.815 Vali Loss: 3.289 Vali Acc: 0.060 Test Loss: 3.289 Test Acc: 0.060
Validation loss decreased (-0.052908 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 0.8735740184783936
Epoch: 8, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.290 Vali Acc: 0.073 Test Loss: 3.290 Test Acc: 0.073
Validation loss decreased (-0.059967 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 0.9254488945007324
Epoch: 9, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.283 Vali Acc: 0.079 Test Loss: 3.283 Test Acc: 0.079
Validation loss decreased (-0.072908 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 0.84572434425354
Epoch: 10, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.274 Vali Acc: 0.095 Test Loss: 3.274 Test Acc: 0.095
Validation loss decreased (-0.078791 --> -0.095261).  Saving model ...
Epoch: 11 cost time: 0.8340065479278564
Epoch: 11, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.273 Vali Acc: 0.101 Test Loss: 3.273 Test Acc: 0.101
Validation loss decreased (-0.095261 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 1.153019905090332
Epoch: 12, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.270 Vali Acc: 0.106 Test Loss: 3.270 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105850).  Saving model ...
Epoch: 13 cost time: 0.7494425773620605
Epoch: 13, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.288 Vali Acc: 0.125 Test Loss: 3.288 Test Acc: 0.125
Validation loss decreased (-0.105850 --> -0.124673).  Saving model ...
Epoch: 14 cost time: 0.7763245105743408
Epoch: 14, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.306 Vali Acc: 0.136 Test Loss: 3.306 Test Acc: 0.136
Validation loss decreased (-0.124673 --> -0.136438).  Saving model ...
Epoch: 15 cost time: 0.9134368896484375
Epoch: 15, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.323 Vali Acc: 0.141 Test Loss: 3.323 Test Acc: 0.141
Validation loss decreased (-0.136438 --> -0.141143).  Saving model ...
Epoch: 16 cost time: 0.8536105155944824
Epoch: 16, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.386 Vali Acc: 0.155 Test Loss: 3.386 Test Acc: 0.155
Validation loss decreased (-0.141143 --> -0.155260).  Saving model ...
Epoch: 17 cost time: 0.8597161769866943
Epoch: 17, Steps: 10 | Train Loss: 1.380 Vali Loss: 3.500 Vali Acc: 0.156 Test Loss: 3.500 Test Acc: 0.156
Validation loss decreased (-0.155260 --> -0.156436).  Saving model ...
Epoch: 18 cost time: 0.7661838531494141
Epoch: 18, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.617 Vali Acc: 0.153 Test Loss: 3.617 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8388957977294922
Epoch: 19, Steps: 10 | Train Loss: 1.035 Vali Loss: 3.772 Vali Acc: 0.162 Test Loss: 3.772 Test Acc: 0.162
Validation loss decreased (-0.156436 --> -0.162315).  Saving model ...
Epoch: 20 cost time: 0.674903154373169
Epoch: 20, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.972 Vali Acc: 0.161 Test Loss: 3.972 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.213930606842041
Epoch: 21, Steps: 10 | Train Loss: 0.652 Vali Loss: 4.156 Vali Acc: 0.168 Test Loss: 4.156 Test Acc: 0.168
Validation loss decreased (-0.162315 --> -0.168194).  Saving model ...
Epoch: 22 cost time: 1.2000422477722168
Epoch: 22, Steps: 10 | Train Loss: 0.502 Vali Loss: 4.427 Vali Acc: 0.166 Test Loss: 4.427 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0214321613311768
Epoch: 23, Steps: 10 | Train Loss: 0.399 Vali Loss: 4.509 Vali Acc: 0.166 Test Loss: 4.509 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8600983619689941
Epoch: 24, Steps: 10 | Train Loss: 0.296 Vali Loss: 4.823 Vali Acc: 0.179 Test Loss: 4.823 Test Acc: 0.179
Validation loss decreased (-0.168194 --> -0.178775).  Saving model ...
Epoch: 25 cost time: 0.861872673034668
Epoch: 25, Steps: 10 | Train Loss: 0.210 Vali Loss: 5.033 Vali Acc: 0.173 Test Loss: 5.033 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7941985130310059
Epoch: 26, Steps: 10 | Train Loss: 0.148 Vali Loss: 5.468 Vali Acc: 0.171 Test Loss: 5.468 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.79510498046875
Epoch: 27, Steps: 10 | Train Loss: 0.089 Vali Loss: 5.699 Vali Acc: 0.171 Test Loss: 5.699 Test Acc: 0.171
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.979058027267456
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 6.133 Vali Acc: 0.169 Test Loss: 6.133 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7794656753540039
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 6.431 Vali Acc: 0.175 Test Loss: 6.431 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9969935417175293
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.660 Vali Acc: 0.166 Test Loss: 6.660 Test Acc: 0.166
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7838349342346191
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.939 Vali Acc: 0.169 Test Loss: 6.939 Test Acc: 0.169
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9362397193908691
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.114 Vali Acc: 0.169 Test Loss: 7.114 Test Acc: 0.169
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9203832149505615
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.322 Vali Acc: 0.168 Test Loss: 7.322 Test Acc: 0.168
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7691943645477295
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.501 Vali Acc: 0.171 Test Loss: 7.501 Test Acc: 0.171
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17882352941176471
model parameter : 154008
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4593727588653564
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.317 Vali Acc: 0.031 Test Loss: 3.317 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.8413984775543213
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.306 Vali Acc: 0.035 Test Loss: 3.306 Test Acc: 0.035
Validation loss decreased (-0.030555 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.6727027893066406
Epoch: 3, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.292 Vali Acc: 0.038 Test Loss: 3.292 Test Acc: 0.038
Validation loss decreased (-0.035261 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.7024545669555664
Epoch: 4, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.279 Vali Acc: 0.052 Test Loss: 3.279 Test Acc: 0.052
Validation loss decreased (-0.037614 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.7833831310272217
Epoch: 5, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.267 Vali Acc: 0.067 Test Loss: 3.267 Test Acc: 0.067
Validation loss decreased (-0.051732 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.6933023929595947
Epoch: 6, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.260 Vali Acc: 0.078 Test Loss: 3.260 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 0.8359625339508057
Epoch: 7, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.257 Vali Acc: 0.088 Test Loss: 3.257 Test Acc: 0.088
Validation loss decreased (-0.077614 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 0.9997050762176514
Epoch: 8, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.256 Vali Acc: 0.095 Test Loss: 3.256 Test Acc: 0.095
Validation loss decreased (-0.088203 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 0.9914529323577881
Epoch: 9, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.251 Vali Acc: 0.109 Test Loss: 3.251 Test Acc: 0.109
Validation loss decreased (-0.095262 --> -0.109379).  Saving model ...
Epoch: 10 cost time: 0.8055915832519531
Epoch: 10, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.243 Vali Acc: 0.111 Test Loss: 3.243 Test Acc: 0.111
Validation loss decreased (-0.109379 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 0.7796993255615234
Epoch: 11, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.249 Vali Acc: 0.116 Test Loss: 3.249 Test Acc: 0.116
Validation loss decreased (-0.110556 --> -0.116438).  Saving model ...
Epoch: 12 cost time: 0.8961842060089111
Epoch: 12, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.244 Vali Acc: 0.128 Test Loss: 3.244 Test Acc: 0.128
Validation loss decreased (-0.116438 --> -0.128203).  Saving model ...
Epoch: 13 cost time: 0.7364907264709473
Epoch: 13, Steps: 10 | Train Loss: 2.137 Vali Loss: 3.244 Vali Acc: 0.139 Test Loss: 3.244 Test Acc: 0.139
Validation loss decreased (-0.128203 --> -0.138791).  Saving model ...
Epoch: 14 cost time: 0.838432788848877
Epoch: 14, Steps: 10 | Train Loss: 1.986 Vali Loss: 3.248 Vali Acc: 0.156 Test Loss: 3.248 Test Acc: 0.156
Validation loss decreased (-0.138791 --> -0.156438).  Saving model ...
Epoch: 15 cost time: 0.76434326171875
Epoch: 15, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.264 Vali Acc: 0.168 Test Loss: 3.264 Test Acc: 0.168
Validation loss decreased (-0.156438 --> -0.168203).  Saving model ...
Epoch: 16 cost time: 0.9688498973846436
Epoch: 16, Steps: 10 | Train Loss: 1.653 Vali Loss: 3.318 Vali Acc: 0.173 Test Loss: 3.318 Test Acc: 0.173
Validation loss decreased (-0.168203 --> -0.172908).  Saving model ...
Epoch: 17 cost time: 0.7158923149108887
Epoch: 17, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.367 Vali Acc: 0.181 Test Loss: 3.367 Test Acc: 0.181
Validation loss decreased (-0.172908 --> -0.181143).  Saving model ...
Epoch: 18 cost time: 1.1267988681793213
Epoch: 18, Steps: 10 | Train Loss: 1.354 Vali Loss: 3.502 Vali Acc: 0.189 Test Loss: 3.502 Test Acc: 0.189
Validation loss decreased (-0.181143 --> -0.189377).  Saving model ...
Epoch: 19 cost time: 0.7377457618713379
Epoch: 19, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.591 Vali Acc: 0.201 Test Loss: 3.591 Test Acc: 0.201
Validation loss decreased (-0.189377 --> -0.201141).  Saving model ...
Epoch: 20 cost time: 0.7300996780395508
Epoch: 20, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.749 Vali Acc: 0.209 Test Loss: 3.749 Test Acc: 0.209
Validation loss decreased (-0.201141 --> -0.209374).  Saving model ...
Epoch: 21 cost time: 0.9417533874511719
Epoch: 21, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.909 Vali Acc: 0.216 Test Loss: 3.909 Test Acc: 0.216
Validation loss decreased (-0.209374 --> -0.216431).  Saving model ...
Epoch: 22 cost time: 0.9194049835205078
Epoch: 22, Steps: 10 | Train Loss: 0.693 Vali Loss: 4.054 Vali Acc: 0.220 Test Loss: 4.054 Test Acc: 0.220
Validation loss decreased (-0.216431 --> -0.219959).  Saving model ...
Epoch: 23 cost time: 0.8666641712188721
Epoch: 23, Steps: 10 | Train Loss: 0.647 Vali Loss: 4.211 Vali Acc: 0.228 Test Loss: 4.211 Test Acc: 0.228
Validation loss decreased (-0.219959 --> -0.228193).  Saving model ...
Epoch: 24 cost time: 0.6544408798217773
Epoch: 24, Steps: 10 | Train Loss: 0.455 Vali Loss: 4.435 Vali Acc: 0.226 Test Loss: 4.435 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7580411434173584
Epoch: 25, Steps: 10 | Train Loss: 0.382 Vali Loss: 4.651 Vali Acc: 0.229 Test Loss: 4.651 Test Acc: 0.229
Validation loss decreased (-0.228193 --> -0.229365).  Saving model ...
Epoch: 26 cost time: 0.8238933086395264
Epoch: 26, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.890 Vali Acc: 0.231 Test Loss: 4.890 Test Acc: 0.231
Validation loss decreased (-0.229365 --> -0.230539).  Saving model ...
Epoch: 27 cost time: 0.8547384738922119
Epoch: 27, Steps: 10 | Train Loss: 0.236 Vali Loss: 5.114 Vali Acc: 0.228 Test Loss: 5.114 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7465665340423584
Epoch: 28, Steps: 10 | Train Loss: 0.165 Vali Loss: 5.452 Vali Acc: 0.228 Test Loss: 5.452 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9742488861083984
Epoch: 29, Steps: 10 | Train Loss: 0.118 Vali Loss: 5.875 Vali Acc: 0.220 Test Loss: 5.875 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7230257987976074
Epoch: 30, Steps: 10 | Train Loss: 0.087 Vali Loss: 6.289 Vali Acc: 0.224 Test Loss: 6.289 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8572626113891602
Epoch: 31, Steps: 10 | Train Loss: 0.063 Vali Loss: 6.497 Vali Acc: 0.227 Test Loss: 6.497 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7867956161499023
Epoch: 32, Steps: 10 | Train Loss: 0.043 Vali Loss: 6.778 Vali Acc: 0.224 Test Loss: 6.778 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6270716190338135
Epoch: 33, Steps: 10 | Train Loss: 0.030 Vali Loss: 7.098 Vali Acc: 0.232 Test Loss: 7.098 Test Acc: 0.232
Validation loss decreased (-0.230539 --> -0.231694).  Saving model ...
Epoch: 34 cost time: 0.7892224788665771
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 7.338 Vali Acc: 0.233 Test Loss: 7.338 Test Acc: 0.233
Validation loss decreased (-0.231694 --> -0.232868).  Saving model ...
Epoch: 35 cost time: 0.8070244789123535
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 7.615 Vali Acc: 0.226 Test Loss: 7.615 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8702633380889893
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.795 Vali Acc: 0.229 Test Loss: 7.795 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9049313068389893
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.975 Vali Acc: 0.226 Test Loss: 7.975 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9568912982940674
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 8.124 Vali Acc: 0.228 Test Loss: 8.124 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7365589141845703
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 8.280 Vali Acc: 0.226 Test Loss: 8.280 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7908632755279541
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.418 Vali Acc: 0.227 Test Loss: 8.418 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9172322750091553
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.549 Vali Acc: 0.227 Test Loss: 8.549 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8831658363342285
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.672 Vali Acc: 0.227 Test Loss: 8.672 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8851883411407471
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.797 Vali Acc: 0.228 Test Loss: 8.797 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7158646583557129
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.918 Vali Acc: 0.229 Test Loss: 8.918 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23294117647058823
model parameter : 152694
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7288057804107666
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.350 Vali Acc: 0.036 Test Loss: 3.350 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.8010413646697998
Epoch: 2, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.338 Vali Acc: 0.035 Test Loss: 3.338 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8718657493591309
Epoch: 3, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.324 Vali Acc: 0.036 Test Loss: 3.324 Test Acc: 0.036
Validation loss decreased (-0.036437 --> -0.036437).  Saving model ...
Epoch: 4 cost time: 0.7320907115936279
Epoch: 4, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.310 Vali Acc: 0.049 Test Loss: 3.310 Test Acc: 0.049
Validation loss decreased (-0.036437 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.8341422080993652
Epoch: 5, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.295 Vali Acc: 0.054 Test Loss: 3.295 Test Acc: 0.054
Validation loss decreased (-0.049379 --> -0.054085).  Saving model ...
Epoch: 6 cost time: 0.8622877597808838
Epoch: 6, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.286 Vali Acc: 0.064 Test Loss: 3.286 Test Acc: 0.064
Validation loss decreased (-0.054085 --> -0.063497).  Saving model ...
Epoch: 7 cost time: 0.8009929656982422
Epoch: 7, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.278 Vali Acc: 0.066 Test Loss: 3.278 Test Acc: 0.066
Validation loss decreased (-0.063497 --> -0.065850).  Saving model ...
Epoch: 8 cost time: 0.9849247932434082
Epoch: 8, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.275 Vali Acc: 0.076 Test Loss: 3.275 Test Acc: 0.076
Validation loss decreased (-0.065850 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 0.8720180988311768
Epoch: 9, Steps: 10 | Train Loss: 2.608 Vali Loss: 3.272 Vali Acc: 0.084 Test Loss: 3.272 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 0.9497954845428467
Epoch: 10, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.260 Vali Acc: 0.102 Test Loss: 3.260 Test Acc: 0.102
Validation loss decreased (-0.083497 --> -0.102320).  Saving model ...
Epoch: 11 cost time: 0.8498444557189941
Epoch: 11, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.262 Vali Acc: 0.121 Test Loss: 3.262 Test Acc: 0.121
Validation loss decreased (-0.102320 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 0.8131163120269775
Epoch: 12, Steps: 10 | Train Loss: 2.228 Vali Loss: 3.273 Vali Acc: 0.131 Test Loss: 3.273 Test Acc: 0.131
Validation loss decreased (-0.121144 --> -0.130556).  Saving model ...
Epoch: 13 cost time: 0.990412712097168
Epoch: 13, Steps: 10 | Train Loss: 2.060 Vali Loss: 3.294 Vali Acc: 0.141 Test Loss: 3.294 Test Acc: 0.141
Validation loss decreased (-0.130556 --> -0.141144).  Saving model ...
Epoch: 14 cost time: 0.9797935485839844
Epoch: 14, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.329 Vali Acc: 0.167 Test Loss: 3.329 Test Acc: 0.167
Validation loss decreased (-0.141144 --> -0.167026).  Saving model ...
Epoch: 15 cost time: 1.0521202087402344
Epoch: 15, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.411 Vali Acc: 0.174 Test Loss: 3.411 Test Acc: 0.174
Validation loss decreased (-0.167026 --> -0.174084).  Saving model ...
Epoch: 16 cost time: 0.7661008834838867
Epoch: 16, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.473 Vali Acc: 0.176 Test Loss: 3.473 Test Acc: 0.176
Validation loss decreased (-0.174084 --> -0.176436).  Saving model ...
Epoch: 17 cost time: 0.8424286842346191
Epoch: 17, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.540 Vali Acc: 0.186 Test Loss: 3.540 Test Acc: 0.186
Validation loss decreased (-0.176436 --> -0.185847).  Saving model ...
Epoch: 18 cost time: 0.7710545063018799
Epoch: 18, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.575 Vali Acc: 0.192 Test Loss: 3.575 Test Acc: 0.192
Validation loss decreased (-0.185847 --> -0.191729).  Saving model ...
Epoch: 19 cost time: 0.8982722759246826
Epoch: 19, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.609 Vali Acc: 0.201 Test Loss: 3.609 Test Acc: 0.201
Validation loss decreased (-0.191729 --> -0.201140).  Saving model ...
Epoch: 20 cost time: 0.8177096843719482
Epoch: 20, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.667 Vali Acc: 0.215 Test Loss: 3.667 Test Acc: 0.215
Validation loss decreased (-0.201140 --> -0.215257).  Saving model ...
Epoch: 21 cost time: 0.8369977474212646
Epoch: 21, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.749 Vali Acc: 0.206 Test Loss: 3.749 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.857349157333374
Epoch: 22, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.824 Vali Acc: 0.211 Test Loss: 3.824 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6767816543579102
Epoch: 23, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.982 Vali Acc: 0.212 Test Loss: 3.982 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6883432865142822
Epoch: 24, Steps: 10 | Train Loss: 0.659 Vali Loss: 4.122 Vali Acc: 0.214 Test Loss: 4.122 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7301285266876221
Epoch: 25, Steps: 10 | Train Loss: 0.516 Vali Loss: 4.214 Vali Acc: 0.219 Test Loss: 4.214 Test Acc: 0.219
Validation loss decreased (-0.215257 --> -0.218781).  Saving model ...
Epoch: 26 cost time: 0.9984853267669678
Epoch: 26, Steps: 10 | Train Loss: 0.432 Vali Loss: 4.427 Vali Acc: 0.209 Test Loss: 4.427 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8412246704101562
Epoch: 27, Steps: 10 | Train Loss: 0.377 Vali Loss: 4.622 Vali Acc: 0.219 Test Loss: 4.622 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8452808856964111
Epoch: 28, Steps: 10 | Train Loss: 0.335 Vali Loss: 4.870 Vali Acc: 0.225 Test Loss: 4.870 Test Acc: 0.225
Validation loss decreased (-0.218781 --> -0.224657).  Saving model ...
Epoch: 29 cost time: 0.8109924793243408
Epoch: 29, Steps: 10 | Train Loss: 0.247 Vali Loss: 5.091 Vali Acc: 0.220 Test Loss: 5.091 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9486527442932129
Epoch: 30, Steps: 10 | Train Loss: 0.166 Vali Loss: 5.301 Vali Acc: 0.226 Test Loss: 5.301 Test Acc: 0.226
Validation loss decreased (-0.224657 --> -0.225829).  Saving model ...
Epoch: 31 cost time: 1.0699453353881836
Epoch: 31, Steps: 10 | Train Loss: 0.133 Vali Loss: 5.702 Vali Acc: 0.226 Test Loss: 5.702 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8314805030822754
Epoch: 32, Steps: 10 | Train Loss: 0.108 Vali Loss: 5.978 Vali Acc: 0.229 Test Loss: 5.978 Test Acc: 0.229
Validation loss decreased (-0.225829 --> -0.229352).  Saving model ...
Epoch: 33 cost time: 1.0406734943389893
Epoch: 33, Steps: 10 | Train Loss: 0.061 Vali Loss: 6.218 Vali Acc: 0.220 Test Loss: 6.218 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8420753479003906
Epoch: 34, Steps: 10 | Train Loss: 0.045 Vali Loss: 6.471 Vali Acc: 0.231 Test Loss: 6.471 Test Acc: 0.231
Validation loss decreased (-0.229352 --> -0.230524).  Saving model ...
Epoch: 35 cost time: 0.7464990615844727
Epoch: 35, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.844 Vali Acc: 0.219 Test Loss: 6.844 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8574573993682861
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 7.045 Vali Acc: 0.221 Test Loss: 7.045 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7866580486297607
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.230 Vali Acc: 0.219 Test Loss: 7.230 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9059600830078125
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.437 Vali Acc: 0.215 Test Loss: 7.437 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.088097333908081
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.647 Vali Acc: 0.220 Test Loss: 7.647 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8449568748474121
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 7.824 Vali Acc: 0.228 Test Loss: 7.824 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8324437141418457
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 7.969 Vali Acc: 0.231 Test Loss: 7.969 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8022868633270264
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.117 Vali Acc: 0.227 Test Loss: 8.117 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8140907287597656
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.225 Vali Acc: 0.229 Test Loss: 8.225 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0135841369628906
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.358 Vali Acc: 0.225 Test Loss: 8.358 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23058823529411765
model parameter : 151592
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9342429637908936
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.316 Vali Acc: 0.031 Test Loss: 3.316 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.8989262580871582
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.302 Vali Acc: 0.028 Test Loss: 3.302 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.718163251876831
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.286 Vali Acc: 0.035 Test Loss: 3.286 Test Acc: 0.035
Validation loss decreased (-0.030555 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 0.9851589202880859
Epoch: 4, Steps: 10 | Train Loss: 3.111 Vali Loss: 3.267 Vali Acc: 0.044 Test Loss: 3.267 Test Acc: 0.044
Validation loss decreased (-0.035261 --> -0.043497).  Saving model ...
Epoch: 5 cost time: 0.9799485206604004
Epoch: 5, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.249 Vali Acc: 0.061 Test Loss: 3.249 Test Acc: 0.061
Validation loss decreased (-0.043497 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.8150463104248047
Epoch: 6, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.234 Vali Acc: 0.071 Test Loss: 3.234 Test Acc: 0.071
Validation loss decreased (-0.061144 --> -0.070556).  Saving model ...
Epoch: 7 cost time: 0.7970962524414062
Epoch: 7, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.220 Vali Acc: 0.081 Test Loss: 3.220 Test Acc: 0.081
Validation loss decreased (-0.070556 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.8252363204956055
Epoch: 8, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.214 Vali Acc: 0.089 Test Loss: 3.214 Test Acc: 0.089
Validation loss decreased (-0.081144 --> -0.089380).  Saving model ...
Epoch: 9 cost time: 0.9189443588256836
Epoch: 9, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.213 Vali Acc: 0.100 Test Loss: 3.213 Test Acc: 0.100
Validation loss decreased (-0.089380 --> -0.099968).  Saving model ...
Epoch: 10 cost time: 0.9882473945617676
Epoch: 10, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.225 Vali Acc: 0.106 Test Loss: 3.225 Test Acc: 0.106
Validation loss decreased (-0.099968 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.8477528095245361
Epoch: 11, Steps: 10 | Train Loss: 2.306 Vali Loss: 3.246 Vali Acc: 0.104 Test Loss: 3.246 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9238698482513428
Epoch: 12, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.292 Vali Acc: 0.107 Test Loss: 3.292 Test Acc: 0.107
Validation loss decreased (-0.105850 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 0.8390622138977051
Epoch: 13, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.319 Vali Acc: 0.116 Test Loss: 3.319 Test Acc: 0.116
Validation loss decreased (-0.107026 --> -0.116437).  Saving model ...
Epoch: 14 cost time: 1.0589072704315186
Epoch: 14, Steps: 10 | Train Loss: 1.882 Vali Loss: 3.362 Vali Acc: 0.124 Test Loss: 3.362 Test Acc: 0.124
Validation loss decreased (-0.116437 --> -0.123496).  Saving model ...
Epoch: 15 cost time: 0.6615588665008545
Epoch: 15, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.455 Vali Acc: 0.139 Test Loss: 3.455 Test Acc: 0.139
Validation loss decreased (-0.123496 --> -0.138789).  Saving model ...
Epoch: 16 cost time: 0.8615777492523193
Epoch: 16, Steps: 10 | Train Loss: 1.629 Vali Loss: 3.476 Vali Acc: 0.153 Test Loss: 3.476 Test Acc: 0.153
Validation loss decreased (-0.138789 --> -0.152906).  Saving model ...
Epoch: 17 cost time: 0.8986499309539795
Epoch: 17, Steps: 10 | Train Loss: 1.522 Vali Loss: 3.525 Vali Acc: 0.140 Test Loss: 3.525 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8770999908447266
Epoch: 18, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.571 Vali Acc: 0.165 Test Loss: 3.571 Test Acc: 0.165
Validation loss decreased (-0.152906 --> -0.164670).  Saving model ...
Epoch: 19 cost time: 1.0534892082214355
Epoch: 19, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.658 Vali Acc: 0.182 Test Loss: 3.658 Test Acc: 0.182
Validation loss decreased (-0.164670 --> -0.182316).  Saving model ...
Epoch: 20 cost time: 0.7742974758148193
Epoch: 20, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.715 Vali Acc: 0.167 Test Loss: 3.715 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8670902252197266
Epoch: 21, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.768 Vali Acc: 0.178 Test Loss: 3.768 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1199898719787598
Epoch: 22, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.927 Vali Acc: 0.179 Test Loss: 3.927 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8296201229095459
Epoch: 23, Steps: 10 | Train Loss: 0.736 Vali Loss: 4.071 Vali Acc: 0.175 Test Loss: 4.071 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9845023155212402
Epoch: 24, Steps: 10 | Train Loss: 0.626 Vali Loss: 4.171 Vali Acc: 0.188 Test Loss: 4.171 Test Acc: 0.188
Validation loss decreased (-0.182316 --> -0.188194).  Saving model ...
Epoch: 25 cost time: 1.0538451671600342
Epoch: 25, Steps: 10 | Train Loss: 0.507 Vali Loss: 4.400 Vali Acc: 0.194 Test Loss: 4.400 Test Acc: 0.194
Validation loss decreased (-0.188194 --> -0.194074).  Saving model ...
Epoch: 26 cost time: 0.8010926246643066
Epoch: 26, Steps: 10 | Train Loss: 0.414 Vali Loss: 4.646 Vali Acc: 0.189 Test Loss: 4.646 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9619090557098389
Epoch: 27, Steps: 10 | Train Loss: 0.383 Vali Loss: 4.922 Vali Acc: 0.205 Test Loss: 4.922 Test Acc: 0.205
Validation loss decreased (-0.194074 --> -0.204657).  Saving model ...
Epoch: 28 cost time: 1.0119366645812988
Epoch: 28, Steps: 10 | Train Loss: 0.278 Vali Loss: 5.361 Vali Acc: 0.199 Test Loss: 5.361 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9727709293365479
Epoch: 29, Steps: 10 | Train Loss: 0.197 Vali Loss: 5.472 Vali Acc: 0.207 Test Loss: 5.472 Test Acc: 0.207
Validation loss decreased (-0.204657 --> -0.207004).  Saving model ...
Epoch: 30 cost time: 0.9248058795928955
Epoch: 30, Steps: 10 | Train Loss: 0.148 Vali Loss: 5.901 Vali Acc: 0.207 Test Loss: 5.901 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7411706447601318
Epoch: 31, Steps: 10 | Train Loss: 0.113 Vali Loss: 6.198 Vali Acc: 0.205 Test Loss: 6.198 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9258770942687988
Epoch: 32, Steps: 10 | Train Loss: 0.094 Vali Loss: 6.608 Vali Acc: 0.198 Test Loss: 6.608 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1487019062042236
Epoch: 33, Steps: 10 | Train Loss: 0.057 Vali Loss: 6.858 Vali Acc: 0.202 Test Loss: 6.858 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0539686679840088
Epoch: 34, Steps: 10 | Train Loss: 0.041 Vali Loss: 7.306 Vali Acc: 0.199 Test Loss: 7.306 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9784390926361084
Epoch: 35, Steps: 10 | Train Loss: 0.025 Vali Loss: 7.581 Vali Acc: 0.198 Test Loss: 7.581 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8651683330535889
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.763 Vali Acc: 0.211 Test Loss: 7.763 Test Acc: 0.211
Validation loss decreased (-0.207004 --> -0.210511).  Saving model ...
Epoch: 37 cost time: 0.8025429248809814
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 8.047 Vali Acc: 0.211 Test Loss: 8.047 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7123451232910156
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 8.244 Vali Acc: 0.204 Test Loss: 8.244 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.634453296661377
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.484 Vali Acc: 0.206 Test Loss: 8.484 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6866095066070557
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 8.617 Vali Acc: 0.211 Test Loss: 8.617 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.803809404373169
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.795 Vali Acc: 0.208 Test Loss: 8.795 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8058552742004395
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.935 Vali Acc: 0.213 Test Loss: 8.935 Test Acc: 0.213
Validation loss decreased (-0.210511 --> -0.212852).  Saving model ...
Epoch: 43 cost time: 0.8287224769592285
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 9.076 Vali Acc: 0.213 Test Loss: 9.076 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.000312089920044
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 9.210 Vali Acc: 0.212 Test Loss: 9.210 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8827672004699707
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 9.333 Vali Acc: 0.213 Test Loss: 9.333 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8963191509246826
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 9.448 Vali Acc: 0.216 Test Loss: 9.448 Test Acc: 0.216
Validation loss decreased (-0.212852 --> -0.216376).  Saving model ...
Epoch: 47 cost time: 0.7124907970428467
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 9.558 Vali Acc: 0.212 Test Loss: 9.558 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9195215702056885
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 9.660 Vali Acc: 0.213 Test Loss: 9.660 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9244284629821777
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 9.751 Vali Acc: 0.211 Test Loss: 9.751 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.821519136428833
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 9.868 Vali Acc: 0.212 Test Loss: 9.868 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8970692157745361
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 9.975 Vali Acc: 0.206 Test Loss: 9.975 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0280091762542725
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 10.055 Vali Acc: 0.212 Test Loss: 10.055 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.928330659866333
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 10.141 Vali Acc: 0.212 Test Loss: 10.141 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8120698928833008
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 10.234 Vali Acc: 0.212 Test Loss: 10.234 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0163586139678955
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 10.304 Vali Acc: 0.211 Test Loss: 10.304 Test Acc: 0.211
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8885834217071533
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 10.422 Vali Acc: 0.214 Test Loss: 10.422 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2164705882352941
model parameter : 150294
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.967008352279663
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.282 Vali Acc: 0.048 Test Loss: 3.282 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.6872103214263916
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.271 Vali Acc: 0.056 Test Loss: 3.271 Test Acc: 0.056
Validation loss decreased (-0.048202 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.7644472122192383
Epoch: 3, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.258 Vali Acc: 0.059 Test Loss: 3.258 Test Acc: 0.059
Validation loss decreased (-0.056438 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.718055009841919
Epoch: 4, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.246 Vali Acc: 0.059 Test Loss: 3.246 Test Acc: 0.059
Validation loss decreased (-0.058791 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 0.6396305561065674
Epoch: 5, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.233 Vali Acc: 0.064 Test Loss: 3.233 Test Acc: 0.064
Validation loss decreased (-0.058791 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.8332910537719727
Epoch: 6, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.224 Vali Acc: 0.072 Test Loss: 3.224 Test Acc: 0.072
Validation loss decreased (-0.063497 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.8104426860809326
Epoch: 7, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.218 Vali Acc: 0.091 Test Loss: 3.218 Test Acc: 0.091
Validation loss decreased (-0.071732 --> -0.090556).  Saving model ...
Epoch: 8 cost time: 0.9452762603759766
Epoch: 8, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.217 Vali Acc: 0.105 Test Loss: 3.217 Test Acc: 0.105
Validation loss decreased (-0.090556 --> -0.104674).  Saving model ...
Epoch: 9 cost time: 0.8554699420928955
Epoch: 9, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.218 Vali Acc: 0.121 Test Loss: 3.218 Test Acc: 0.121
Validation loss decreased (-0.104674 --> -0.121144).  Saving model ...
Epoch: 10 cost time: 0.7806894779205322
Epoch: 10, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.225 Vali Acc: 0.124 Test Loss: 3.225 Test Acc: 0.124
Validation loss decreased (-0.121144 --> -0.123497).  Saving model ...
Epoch: 11 cost time: 0.754218339920044
Epoch: 11, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.225 Vali Acc: 0.132 Test Loss: 3.225 Test Acc: 0.132
Validation loss decreased (-0.123497 --> -0.131732).  Saving model ...
Epoch: 12 cost time: 0.8450272083282471
Epoch: 12, Steps: 10 | Train Loss: 2.245 Vali Loss: 3.237 Vali Acc: 0.139 Test Loss: 3.237 Test Acc: 0.139
Validation loss decreased (-0.131732 --> -0.138791).  Saving model ...
Epoch: 13 cost time: 0.7285676002502441
Epoch: 13, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.247 Vali Acc: 0.142 Test Loss: 3.247 Test Acc: 0.142
Validation loss decreased (-0.138791 --> -0.142320).  Saving model ...
Epoch: 14 cost time: 0.7210862636566162
Epoch: 14, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.274 Vali Acc: 0.156 Test Loss: 3.274 Test Acc: 0.156
Validation loss decreased (-0.142320 --> -0.156438).  Saving model ...
Epoch: 15 cost time: 0.7328815460205078
Epoch: 15, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.336 Vali Acc: 0.160 Test Loss: 3.336 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159967).  Saving model ...
Epoch: 16 cost time: 0.8072810173034668
Epoch: 16, Steps: 10 | Train Loss: 1.629 Vali Loss: 3.379 Vali Acc: 0.172 Test Loss: 3.379 Test Acc: 0.172
Validation loss decreased (-0.159967 --> -0.171731).  Saving model ...
Epoch: 17 cost time: 0.8331584930419922
Epoch: 17, Steps: 10 | Train Loss: 1.506 Vali Loss: 3.443 Vali Acc: 0.176 Test Loss: 3.443 Test Acc: 0.176
Validation loss decreased (-0.171731 --> -0.176436).  Saving model ...
Epoch: 18 cost time: 0.6821789741516113
Epoch: 18, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.538 Vali Acc: 0.186 Test Loss: 3.538 Test Acc: 0.186
Validation loss decreased (-0.176436 --> -0.185847).  Saving model ...
Epoch: 19 cost time: 0.8409316539764404
Epoch: 19, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.658 Vali Acc: 0.188 Test Loss: 3.658 Test Acc: 0.188
Validation loss decreased (-0.185847 --> -0.188199).  Saving model ...
Epoch: 20 cost time: 0.6829483509063721
Epoch: 20, Steps: 10 | Train Loss: 1.145 Vali Loss: 3.758 Vali Acc: 0.192 Test Loss: 3.758 Test Acc: 0.192
Validation loss decreased (-0.188199 --> -0.191727).  Saving model ...
Epoch: 21 cost time: 0.6693661212921143
Epoch: 21, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.861 Vali Acc: 0.195 Test Loss: 3.861 Test Acc: 0.195
Validation loss decreased (-0.191727 --> -0.195256).  Saving model ...
Epoch: 22 cost time: 0.7282841205596924
Epoch: 22, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.980 Vali Acc: 0.192 Test Loss: 3.980 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7701156139373779
Epoch: 23, Steps: 10 | Train Loss: 0.729 Vali Loss: 4.123 Vali Acc: 0.201 Test Loss: 4.123 Test Acc: 0.201
Validation loss decreased (-0.195256 --> -0.201135).  Saving model ...
Epoch: 24 cost time: 0.7429592609405518
Epoch: 24, Steps: 10 | Train Loss: 0.598 Vali Loss: 4.368 Vali Acc: 0.206 Test Loss: 4.368 Test Acc: 0.206
Validation loss decreased (-0.201135 --> -0.205839).  Saving model ...
Epoch: 25 cost time: 0.7168426513671875
Epoch: 25, Steps: 10 | Train Loss: 0.492 Vali Loss: 4.536 Vali Acc: 0.194 Test Loss: 4.536 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7849867343902588
Epoch: 26, Steps: 10 | Train Loss: 0.435 Vali Loss: 4.857 Vali Acc: 0.205 Test Loss: 4.857 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6967306137084961
Epoch: 27, Steps: 10 | Train Loss: 0.324 Vali Loss: 5.108 Vali Acc: 0.208 Test Loss: 5.108 Test Acc: 0.208
Validation loss decreased (-0.205839 --> -0.208184).  Saving model ...
Epoch: 28 cost time: 0.6965885162353516
Epoch: 28, Steps: 10 | Train Loss: 0.257 Vali Loss: 5.392 Vali Acc: 0.212 Test Loss: 5.392 Test Acc: 0.212
Validation loss decreased (-0.208184 --> -0.211711).  Saving model ...
Epoch: 29 cost time: 0.8518507480621338
Epoch: 29, Steps: 10 | Train Loss: 0.202 Vali Loss: 5.754 Vali Acc: 0.201 Test Loss: 5.754 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.198807954788208
Epoch: 30, Steps: 10 | Train Loss: 0.146 Vali Loss: 6.005 Vali Acc: 0.220 Test Loss: 6.005 Test Acc: 0.220
Validation loss decreased (-0.211711 --> -0.219940).  Saving model ...
Epoch: 31 cost time: 0.8641037940979004
Epoch: 31, Steps: 10 | Train Loss: 0.111 Vali Loss: 6.430 Vali Acc: 0.212 Test Loss: 6.430 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6951062679290771
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 6.737 Vali Acc: 0.208 Test Loss: 6.737 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7381083965301514
Epoch: 33, Steps: 10 | Train Loss: 0.058 Vali Loss: 7.208 Vali Acc: 0.209 Test Loss: 7.208 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8679332733154297
Epoch: 34, Steps: 10 | Train Loss: 0.043 Vali Loss: 7.382 Vali Acc: 0.212 Test Loss: 7.382 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8196182250976562
Epoch: 35, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.756 Vali Acc: 0.209 Test Loss: 7.756 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8382599353790283
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 8.009 Vali Acc: 0.205 Test Loss: 8.009 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8521819114685059
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 8.361 Vali Acc: 0.206 Test Loss: 8.361 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7140460014343262
Epoch: 38, Steps: 10 | Train Loss: 0.020 Vali Loss: 8.469 Vali Acc: 0.212 Test Loss: 8.469 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.639570951461792
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.872 Vali Acc: 0.207 Test Loss: 8.872 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7440388202667236
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 8.977 Vali Acc: 0.204 Test Loss: 8.977 Test Acc: 0.204
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22
model parameter : 149256
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.411222457885742
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.296 Vali Acc: 0.038 Test Loss: 3.296 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.2072172164916992
Epoch: 2, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.285 Vali Acc: 0.047 Test Loss: 3.285 Test Acc: 0.047
Validation loss decreased (-0.037614 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.8536128997802734
Epoch: 3, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.269 Vali Acc: 0.048 Test Loss: 3.269 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048203).  Saving model ...
Epoch: 4 cost time: 1.091083288192749
Epoch: 4, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.254 Vali Acc: 0.056 Test Loss: 3.254 Test Acc: 0.056
Validation loss decreased (-0.048203 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 1.0053091049194336
Epoch: 5, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.240 Vali Acc: 0.068 Test Loss: 3.240 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 0.8429088592529297
Epoch: 6, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.229 Vali Acc: 0.082 Test Loss: 3.229 Test Acc: 0.082
Validation loss decreased (-0.068203 --> -0.082321).  Saving model ...
Epoch: 7 cost time: 1.2014398574829102
Epoch: 7, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.220 Vali Acc: 0.099 Test Loss: 3.220 Test Acc: 0.099
Validation loss decreased (-0.082321 --> -0.098791).  Saving model ...
Epoch: 8 cost time: 1.1820597648620605
Epoch: 8, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.216 Vali Acc: 0.104 Test Loss: 3.216 Test Acc: 0.104
Validation loss decreased (-0.098791 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.0640783309936523
Epoch: 9, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.223 Vali Acc: 0.101 Test Loss: 3.223 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8196108341217041
Epoch: 10, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.236 Vali Acc: 0.108 Test Loss: 3.236 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.9229156970977783
Epoch: 11, Steps: 10 | Train Loss: 2.295 Vali Loss: 3.260 Vali Acc: 0.114 Test Loss: 3.260 Test Acc: 0.114
Validation loss decreased (-0.108203 --> -0.114085).  Saving model ...
Epoch: 12 cost time: 1.0987756252288818
Epoch: 12, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.268 Vali Acc: 0.118 Test Loss: 3.268 Test Acc: 0.118
Validation loss decreased (-0.114085 --> -0.117614).  Saving model ...
Epoch: 13 cost time: 0.7964630126953125
Epoch: 13, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.307 Vali Acc: 0.122 Test Loss: 3.307 Test Acc: 0.122
Validation loss decreased (-0.117614 --> -0.122320).  Saving model ...
Epoch: 14 cost time: 0.7986176013946533
Epoch: 14, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.365 Vali Acc: 0.133 Test Loss: 3.365 Test Acc: 0.133
Validation loss decreased (-0.122320 --> -0.132908).  Saving model ...
Epoch: 15 cost time: 0.9681296348571777
Epoch: 15, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.427 Vali Acc: 0.145 Test Loss: 3.427 Test Acc: 0.145
Validation loss decreased (-0.132908 --> -0.144672).  Saving model ...
Epoch: 16 cost time: 0.8140888214111328
Epoch: 16, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.480 Vali Acc: 0.155 Test Loss: 3.480 Test Acc: 0.155
Validation loss decreased (-0.144672 --> -0.155259).  Saving model ...
Epoch: 17 cost time: 0.9726943969726562
Epoch: 17, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.569 Vali Acc: 0.164 Test Loss: 3.569 Test Acc: 0.164
Validation loss decreased (-0.155259 --> -0.163494).  Saving model ...
Epoch: 18 cost time: 0.8912782669067383
Epoch: 18, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.745 Vali Acc: 0.174 Test Loss: 3.745 Test Acc: 0.174
Validation loss decreased (-0.163494 --> -0.174080).  Saving model ...
Epoch: 19 cost time: 1.013310194015503
Epoch: 19, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.816 Vali Acc: 0.174 Test Loss: 3.816 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0799391269683838
Epoch: 20, Steps: 10 | Train Loss: 0.894 Vali Loss: 4.037 Vali Acc: 0.178 Test Loss: 4.037 Test Acc: 0.178
Validation loss decreased (-0.174080 --> -0.177607).  Saving model ...
Epoch: 21 cost time: 1.0398004055023193
Epoch: 21, Steps: 10 | Train Loss: 0.688 Vali Loss: 4.138 Vali Acc: 0.182 Test Loss: 4.138 Test Acc: 0.182
Validation loss decreased (-0.177607 --> -0.182312).  Saving model ...
Epoch: 22 cost time: 1.3384313583374023
Epoch: 22, Steps: 10 | Train Loss: 0.605 Vali Loss: 4.361 Vali Acc: 0.200 Test Loss: 4.361 Test Acc: 0.200
Validation loss decreased (-0.182312 --> -0.199956).  Saving model ...
Epoch: 23 cost time: 1.0082511901855469
Epoch: 23, Steps: 10 | Train Loss: 0.456 Vali Loss: 4.531 Vali Acc: 0.195 Test Loss: 4.531 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0841443538665771
Epoch: 24, Steps: 10 | Train Loss: 0.375 Vali Loss: 4.838 Vali Acc: 0.185 Test Loss: 4.838 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9996993541717529
Epoch: 25, Steps: 10 | Train Loss: 0.364 Vali Loss: 5.211 Vali Acc: 0.198 Test Loss: 5.211 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.914867639541626
Epoch: 26, Steps: 10 | Train Loss: 0.216 Vali Loss: 5.460 Vali Acc: 0.187 Test Loss: 5.460 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9069170951843262
Epoch: 27, Steps: 10 | Train Loss: 0.193 Vali Loss: 5.677 Vali Acc: 0.186 Test Loss: 5.677 Test Acc: 0.186
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8427169322967529
Epoch: 28, Steps: 10 | Train Loss: 0.142 Vali Loss: 6.048 Vali Acc: 0.185 Test Loss: 6.048 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9496548175811768
Epoch: 29, Steps: 10 | Train Loss: 0.124 Vali Loss: 6.273 Vali Acc: 0.194 Test Loss: 6.273 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9185631275177002
Epoch: 30, Steps: 10 | Train Loss: 0.079 Vali Loss: 6.671 Vali Acc: 0.182 Test Loss: 6.671 Test Acc: 0.182
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.021568775177002
Epoch: 31, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.952 Vali Acc: 0.182 Test Loss: 6.952 Test Acc: 0.182
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9275510311126709
Epoch: 32, Steps: 10 | Train Loss: 0.055 Vali Loss: 7.225 Vali Acc: 0.188 Test Loss: 7.225 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2
model parameter : 148934
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.166560649871826
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.293 Vali Acc: 0.042 Test Loss: 3.293 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.7975435256958008
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.281 Vali Acc: 0.046 Test Loss: 3.281 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045850).  Saving model ...
Epoch: 3 cost time: 0.8455748558044434
Epoch: 3, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.266 Vali Acc: 0.052 Test Loss: 3.266 Test Acc: 0.052
Validation loss decreased (-0.045850 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.876488208770752
Epoch: 4, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.252 Vali Acc: 0.054 Test Loss: 3.252 Test Acc: 0.054
Validation loss decreased (-0.051732 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.8487412929534912
Epoch: 5, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.239 Vali Acc: 0.075 Test Loss: 3.239 Test Acc: 0.075
Validation loss decreased (-0.054085 --> -0.075262).  Saving model ...
Epoch: 6 cost time: 0.8017361164093018
Epoch: 6, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.229 Vali Acc: 0.089 Test Loss: 3.229 Test Acc: 0.089
Validation loss decreased (-0.075262 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.7533049583435059
Epoch: 7, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.222 Vali Acc: 0.096 Test Loss: 3.222 Test Acc: 0.096
Validation loss decreased (-0.089379 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 0.8059203624725342
Epoch: 8, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.224 Vali Acc: 0.101 Test Loss: 3.224 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 0.8500182628631592
Epoch: 9, Steps: 10 | Train Loss: 2.614 Vali Loss: 3.223 Vali Acc: 0.109 Test Loss: 3.223 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109380).  Saving model ...
Epoch: 10 cost time: 0.8425300121307373
Epoch: 10, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.224 Vali Acc: 0.116 Test Loss: 3.224 Test Acc: 0.116
Validation loss decreased (-0.109380 --> -0.116438).  Saving model ...
Epoch: 11 cost time: 0.7328360080718994
Epoch: 11, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.224 Vali Acc: 0.116 Test Loss: 3.224 Test Acc: 0.116
Validation loss decreased (-0.116438 --> -0.116438).  Saving model ...
Epoch: 12 cost time: 0.8215124607086182
Epoch: 12, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.234 Vali Acc: 0.119 Test Loss: 3.234 Test Acc: 0.119
Validation loss decreased (-0.116438 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.9990360736846924
Epoch: 13, Steps: 10 | Train Loss: 2.126 Vali Loss: 3.229 Vali Acc: 0.139 Test Loss: 3.229 Test Acc: 0.139
Validation loss decreased (-0.118791 --> -0.138791).  Saving model ...
Epoch: 14 cost time: 0.7294228076934814
Epoch: 14, Steps: 10 | Train Loss: 1.992 Vali Loss: 3.252 Vali Acc: 0.140 Test Loss: 3.252 Test Acc: 0.140
Validation loss decreased (-0.138791 --> -0.139967).  Saving model ...
Epoch: 15 cost time: 0.8569033145904541
Epoch: 15, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.286 Vali Acc: 0.155 Test Loss: 3.286 Test Acc: 0.155
Validation loss decreased (-0.139967 --> -0.155261).  Saving model ...
Epoch: 16 cost time: 1.0047714710235596
Epoch: 16, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.369 Vali Acc: 0.164 Test Loss: 3.369 Test Acc: 0.164
Validation loss decreased (-0.155261 --> -0.163496).  Saving model ...
Epoch: 17 cost time: 0.874384880065918
Epoch: 17, Steps: 10 | Train Loss: 1.533 Vali Loss: 3.419 Vali Acc: 0.171 Test Loss: 3.419 Test Acc: 0.171
Validation loss decreased (-0.163496 --> -0.170554).  Saving model ...
Epoch: 18 cost time: 0.8382430076599121
Epoch: 18, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.516 Vali Acc: 0.173 Test Loss: 3.516 Test Acc: 0.173
Validation loss decreased (-0.170554 --> -0.172906).  Saving model ...
Epoch: 19 cost time: 0.957237720489502
Epoch: 19, Steps: 10 | Train Loss: 1.223 Vali Loss: 3.578 Vali Acc: 0.184 Test Loss: 3.578 Test Acc: 0.184
Validation loss decreased (-0.172906 --> -0.183494).  Saving model ...
Epoch: 20 cost time: 0.8743054866790771
Epoch: 20, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.657 Vali Acc: 0.191 Test Loss: 3.657 Test Acc: 0.191
Validation loss decreased (-0.183494 --> -0.190552).  Saving model ...
Epoch: 21 cost time: 0.818457841873169
Epoch: 21, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.768 Vali Acc: 0.185 Test Loss: 3.768 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7163972854614258
Epoch: 22, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.820 Vali Acc: 0.198 Test Loss: 3.820 Test Acc: 0.198
Validation loss decreased (-0.190552 --> -0.197609).  Saving model ...
Epoch: 23 cost time: 0.9067747592926025
Epoch: 23, Steps: 10 | Train Loss: 0.739 Vali Loss: 3.997 Vali Acc: 0.200 Test Loss: 3.997 Test Acc: 0.200
Validation loss decreased (-0.197609 --> -0.199960).  Saving model ...
Epoch: 24 cost time: 0.783627986907959
Epoch: 24, Steps: 10 | Train Loss: 0.610 Vali Loss: 4.187 Vali Acc: 0.196 Test Loss: 4.187 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7498736381530762
Epoch: 25, Steps: 10 | Train Loss: 0.491 Vali Loss: 4.402 Vali Acc: 0.188 Test Loss: 4.402 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0040719509124756
Epoch: 26, Steps: 10 | Train Loss: 0.426 Vali Loss: 4.562 Vali Acc: 0.207 Test Loss: 4.562 Test Acc: 0.207
Validation loss decreased (-0.199960 --> -0.207013).  Saving model ...
Epoch: 27 cost time: 0.7717921733856201
Epoch: 27, Steps: 10 | Train Loss: 0.307 Vali Loss: 4.835 Vali Acc: 0.196 Test Loss: 4.835 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8280811309814453
Epoch: 28, Steps: 10 | Train Loss: 0.229 Vali Loss: 5.083 Vali Acc: 0.209 Test Loss: 5.083 Test Acc: 0.209
Validation loss decreased (-0.207013 --> -0.209361).  Saving model ...
Epoch: 29 cost time: 0.7919058799743652
Epoch: 29, Steps: 10 | Train Loss: 0.169 Vali Loss: 5.579 Vali Acc: 0.189 Test Loss: 5.579 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9492814540863037
Epoch: 30, Steps: 10 | Train Loss: 0.144 Vali Loss: 5.762 Vali Acc: 0.195 Test Loss: 5.762 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9840030670166016
Epoch: 31, Steps: 10 | Train Loss: 0.101 Vali Loss: 6.372 Vali Acc: 0.187 Test Loss: 6.372 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7664728164672852
Epoch: 32, Steps: 10 | Train Loss: 0.082 Vali Loss: 6.387 Vali Acc: 0.200 Test Loss: 6.387 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8495898246765137
Epoch: 33, Steps: 10 | Train Loss: 0.062 Vali Loss: 6.738 Vali Acc: 0.189 Test Loss: 6.738 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7228939533233643
Epoch: 34, Steps: 10 | Train Loss: 0.041 Vali Loss: 6.933 Vali Acc: 0.196 Test Loss: 6.933 Test Acc: 0.196
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8500359058380127
Epoch: 35, Steps: 10 | Train Loss: 0.044 Vali Loss: 7.214 Vali Acc: 0.201 Test Loss: 7.214 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8305191993713379
Epoch: 36, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.356 Vali Acc: 0.202 Test Loss: 7.356 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8650097846984863
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 7.619 Vali Acc: 0.206 Test Loss: 7.619 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8582022190093994
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 7.897 Vali Acc: 0.209 Test Loss: 7.897 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20941176470588235
model parameter : 149784
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.380772113800049
Epoch: 1, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.313 Vali Acc: 0.039 Test Loss: 3.313 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.8215203285217285
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.302 Vali Acc: 0.038 Test Loss: 3.302 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9538125991821289
Epoch: 3, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.288 Vali Acc: 0.045 Test Loss: 3.288 Test Acc: 0.045
Validation loss decreased (-0.038790 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.8214287757873535
Epoch: 4, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.272 Vali Acc: 0.047 Test Loss: 3.272 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.7727937698364258
Epoch: 5, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.259 Vali Acc: 0.056 Test Loss: 3.259 Test Acc: 0.056
Validation loss decreased (-0.047026 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 0.8069717884063721
Epoch: 6, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.248 Vali Acc: 0.078 Test Loss: 3.248 Test Acc: 0.078
Validation loss decreased (-0.056438 --> -0.077615).  Saving model ...
Epoch: 7 cost time: 0.9419915676116943
Epoch: 7, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.238 Vali Acc: 0.087 Test Loss: 3.238 Test Acc: 0.087
Validation loss decreased (-0.077615 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 0.9035191535949707
Epoch: 8, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.237 Vali Acc: 0.096 Test Loss: 3.237 Test Acc: 0.096
Validation loss decreased (-0.087026 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 0.8190152645111084
Epoch: 9, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.234 Vali Acc: 0.101 Test Loss: 3.234 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.7447977066040039
Epoch: 10, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.226 Vali Acc: 0.113 Test Loss: 3.226 Test Acc: 0.113
Validation loss decreased (-0.101144 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 0.7794086933135986
Epoch: 11, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.226 Vali Acc: 0.124 Test Loss: 3.226 Test Acc: 0.124
Validation loss decreased (-0.112909 --> -0.123497).  Saving model ...
Epoch: 12 cost time: 0.9720220565795898
Epoch: 12, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.225 Vali Acc: 0.127 Test Loss: 3.225 Test Acc: 0.127
Validation loss decreased (-0.123497 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 1.056680679321289
Epoch: 13, Steps: 10 | Train Loss: 2.071 Vali Loss: 3.231 Vali Acc: 0.126 Test Loss: 3.231 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6643719673156738
Epoch: 14, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.251 Vali Acc: 0.133 Test Loss: 3.251 Test Acc: 0.133
Validation loss decreased (-0.127027 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.8895645141601562
Epoch: 15, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.275 Vali Acc: 0.146 Test Loss: 3.275 Test Acc: 0.146
Validation loss decreased (-0.132909 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 1.0615131855010986
Epoch: 16, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.339 Vali Acc: 0.151 Test Loss: 3.339 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150555).  Saving model ...
Epoch: 17 cost time: 1.0184721946716309
Epoch: 17, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.408 Vali Acc: 0.166 Test Loss: 3.408 Test Acc: 0.166
Validation loss decreased (-0.150555 --> -0.165848).  Saving model ...
Epoch: 18 cost time: 0.949779748916626
Epoch: 18, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.510 Vali Acc: 0.175 Test Loss: 3.510 Test Acc: 0.175
Validation loss decreased (-0.165848 --> -0.175259).  Saving model ...
Epoch: 19 cost time: 0.8145508766174316
Epoch: 19, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.643 Vali Acc: 0.178 Test Loss: 3.643 Test Acc: 0.178
Validation loss decreased (-0.175259 --> -0.177611).  Saving model ...
Epoch: 20 cost time: 1.0260131359100342
Epoch: 20, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.768 Vali Acc: 0.171 Test Loss: 3.768 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8772964477539062
Epoch: 21, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.965 Vali Acc: 0.173 Test Loss: 3.965 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9988300800323486
Epoch: 22, Steps: 10 | Train Loss: 0.650 Vali Loss: 4.202 Vali Acc: 0.166 Test Loss: 4.202 Test Acc: 0.166
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9017796516418457
Epoch: 23, Steps: 10 | Train Loss: 0.511 Vali Loss: 4.382 Vali Acc: 0.173 Test Loss: 4.382 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1961703300476074
Epoch: 24, Steps: 10 | Train Loss: 0.394 Vali Loss: 4.688 Vali Acc: 0.180 Test Loss: 4.688 Test Acc: 0.180
Validation loss decreased (-0.177611 --> -0.179953).  Saving model ...
Epoch: 25 cost time: 0.9497401714324951
Epoch: 25, Steps: 10 | Train Loss: 0.359 Vali Loss: 4.914 Vali Acc: 0.175 Test Loss: 4.914 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.035984754562378
Epoch: 26, Steps: 10 | Train Loss: 0.244 Vali Loss: 5.280 Vali Acc: 0.165 Test Loss: 5.280 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9755659103393555
Epoch: 27, Steps: 10 | Train Loss: 0.159 Vali Loss: 5.519 Vali Acc: 0.184 Test Loss: 5.519 Test Acc: 0.184
Validation loss decreased (-0.179953 --> -0.183474).  Saving model ...
Epoch: 28 cost time: 0.7561435699462891
Epoch: 28, Steps: 10 | Train Loss: 0.108 Vali Loss: 5.934 Vali Acc: 0.169 Test Loss: 5.934 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0632216930389404
Epoch: 29, Steps: 10 | Train Loss: 0.077 Vali Loss: 6.216 Vali Acc: 0.181 Test Loss: 6.216 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.10811448097229
Epoch: 30, Steps: 10 | Train Loss: 0.055 Vali Loss: 6.827 Vali Acc: 0.160 Test Loss: 6.827 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7570216655731201
Epoch: 31, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.972 Vali Acc: 0.186 Test Loss: 6.972 Test Acc: 0.186
Validation loss decreased (-0.183474 --> -0.185813).  Saving model ...
Epoch: 32 cost time: 0.7981128692626953
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 7.300 Vali Acc: 0.178 Test Loss: 7.300 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8254940509796143
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 7.499 Vali Acc: 0.178 Test Loss: 7.499 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7886073589324951
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.670 Vali Acc: 0.186 Test Loss: 7.670 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9135031700134277
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.903 Vali Acc: 0.174 Test Loss: 7.903 Test Acc: 0.174
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8922903537750244
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 8.069 Vali Acc: 0.182 Test Loss: 8.069 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8634798526763916
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.215 Vali Acc: 0.184 Test Loss: 8.215 Test Acc: 0.184
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7334809303283691
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 8.378 Vali Acc: 0.182 Test Loss: 8.378 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9072277545928955
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.509 Vali Acc: 0.184 Test Loss: 8.509 Test Acc: 0.184
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1078174114227295
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.640 Vali Acc: 0.181 Test Loss: 8.640 Test Acc: 0.181
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1373026371002197
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.766 Vali Acc: 0.178 Test Loss: 8.766 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18588235294117647
model parameter : 148406
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4436635971069336
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.320 Vali Acc: 0.047 Test Loss: 3.320 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.6754388809204102
Epoch: 2, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.308 Vali Acc: 0.049 Test Loss: 3.308 Test Acc: 0.049
Validation loss decreased (-0.047026 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.7394382953643799
Epoch: 3, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.294 Vali Acc: 0.052 Test Loss: 3.294 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.8330373764038086
Epoch: 4, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.280 Vali Acc: 0.055 Test Loss: 3.280 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.7302956581115723
Epoch: 5, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.265 Vali Acc: 0.062 Test Loss: 3.265 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 0.7966787815093994
Epoch: 6, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.253 Vali Acc: 0.074 Test Loss: 3.253 Test Acc: 0.074
Validation loss decreased (-0.062320 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 0.7781102657318115
Epoch: 7, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.243 Vali Acc: 0.084 Test Loss: 3.243 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.7207643985748291
Epoch: 8, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.238 Vali Acc: 0.091 Test Loss: 3.238 Test Acc: 0.091
Validation loss decreased (-0.083497 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.6727714538574219
Epoch: 9, Steps: 10 | Train Loss: 2.622 Vali Loss: 3.238 Vali Acc: 0.094 Test Loss: 3.238 Test Acc: 0.094
Validation loss decreased (-0.090556 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 0.9254806041717529
Epoch: 10, Steps: 10 | Train Loss: 2.503 Vali Loss: 3.245 Vali Acc: 0.100 Test Loss: 3.245 Test Acc: 0.100
Validation loss decreased (-0.094085 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 0.6805384159088135
Epoch: 11, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.252 Vali Acc: 0.105 Test Loss: 3.252 Test Acc: 0.105
Validation loss decreased (-0.099968 --> -0.104673).  Saving model ...
Epoch: 12 cost time: 0.7640211582183838
Epoch: 12, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.264 Vali Acc: 0.115 Test Loss: 3.264 Test Acc: 0.115
Validation loss decreased (-0.104673 --> -0.115261).  Saving model ...
Epoch: 13 cost time: 0.7743532657623291
Epoch: 13, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.280 Vali Acc: 0.119 Test Loss: 3.280 Test Acc: 0.119
Validation loss decreased (-0.115261 --> -0.118791).  Saving model ...
Epoch: 14 cost time: 0.7527015209197998
Epoch: 14, Steps: 10 | Train Loss: 1.940 Vali Loss: 3.324 Vali Acc: 0.125 Test Loss: 3.324 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124673).  Saving model ...
Epoch: 15 cost time: 0.688366174697876
Epoch: 15, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.373 Vali Acc: 0.139 Test Loss: 3.373 Test Acc: 0.139
Validation loss decreased (-0.124673 --> -0.138790).  Saving model ...
Epoch: 16 cost time: 0.7069480419158936
Epoch: 16, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.483 Vali Acc: 0.145 Test Loss: 3.483 Test Acc: 0.145
Validation loss decreased (-0.138790 --> -0.144671).  Saving model ...
Epoch: 17 cost time: 0.6102306842803955
Epoch: 17, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.587 Vali Acc: 0.146 Test Loss: 3.587 Test Acc: 0.146
Validation loss decreased (-0.144671 --> -0.145846).  Saving model ...
Epoch: 18 cost time: 0.8176941871643066
Epoch: 18, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.726 Vali Acc: 0.140 Test Loss: 3.726 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9266386032104492
Epoch: 19, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.877 Vali Acc: 0.158 Test Loss: 3.877 Test Acc: 0.158
Validation loss decreased (-0.145846 --> -0.157608).  Saving model ...
Epoch: 20 cost time: 0.9714841842651367
Epoch: 20, Steps: 10 | Train Loss: 0.898 Vali Loss: 4.032 Vali Acc: 0.158 Test Loss: 4.032 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8297946453094482
Epoch: 21, Steps: 10 | Train Loss: 0.783 Vali Loss: 4.233 Vali Acc: 0.160 Test Loss: 4.233 Test Acc: 0.160
Validation loss decreased (-0.157608 --> -0.159958).  Saving model ...
Epoch: 22 cost time: 0.8168666362762451
Epoch: 22, Steps: 10 | Train Loss: 0.672 Vali Loss: 4.463 Vali Acc: 0.166 Test Loss: 4.463 Test Acc: 0.166
Validation loss decreased (-0.159958 --> -0.165838).  Saving model ...
Epoch: 23 cost time: 0.933525800704956
Epoch: 23, Steps: 10 | Train Loss: 0.491 Vali Loss: 4.732 Vali Acc: 0.164 Test Loss: 4.732 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7560091018676758
Epoch: 24, Steps: 10 | Train Loss: 0.404 Vali Loss: 5.085 Vali Acc: 0.164 Test Loss: 5.085 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7097775936126709
Epoch: 25, Steps: 10 | Train Loss: 0.301 Vali Loss: 5.469 Vali Acc: 0.161 Test Loss: 5.469 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.722883939743042
Epoch: 26, Steps: 10 | Train Loss: 0.224 Vali Loss: 5.912 Vali Acc: 0.167 Test Loss: 5.912 Test Acc: 0.167
Validation loss decreased (-0.165838 --> -0.167000).  Saving model ...
Epoch: 27 cost time: 0.6932597160339355
Epoch: 27, Steps: 10 | Train Loss: 0.168 Vali Loss: 6.265 Vali Acc: 0.160 Test Loss: 6.265 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7156598567962646
Epoch: 28, Steps: 10 | Train Loss: 0.105 Vali Loss: 6.743 Vali Acc: 0.167 Test Loss: 6.743 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7804439067840576
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 7.091 Vali Acc: 0.167 Test Loss: 7.091 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.875607967376709
Epoch: 30, Steps: 10 | Train Loss: 0.065 Vali Loss: 7.642 Vali Acc: 0.161 Test Loss: 7.642 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8370661735534668
Epoch: 31, Steps: 10 | Train Loss: 0.039 Vali Loss: 7.847 Vali Acc: 0.161 Test Loss: 7.847 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8009774684906006
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 8.130 Vali Acc: 0.169 Test Loss: 8.130 Test Acc: 0.169
Validation loss decreased (-0.167000 --> -0.169330).  Saving model ...
Epoch: 33 cost time: 0.7177696228027344
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 8.543 Vali Acc: 0.165 Test Loss: 8.543 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8533756732940674
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 8.750 Vali Acc: 0.161 Test Loss: 8.750 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7116434574127197
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 8.961 Vali Acc: 0.162 Test Loss: 8.961 Test Acc: 0.162
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8147783279418945
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 9.168 Vali Acc: 0.167 Test Loss: 9.168 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7789678573608398
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 9.368 Vali Acc: 0.165 Test Loss: 9.368 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7707862854003906
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 9.568 Vali Acc: 0.165 Test Loss: 9.568 Test Acc: 0.165
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9198808670043945
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 9.736 Vali Acc: 0.164 Test Loss: 9.736 Test Acc: 0.164
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7134542465209961
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 9.915 Vali Acc: 0.160 Test Loss: 9.915 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8674712181091309
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 10.052 Vali Acc: 0.158 Test Loss: 10.052 Test Acc: 0.158
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7754015922546387
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 10.187 Vali Acc: 0.161 Test Loss: 10.187 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.16941176470588235
model parameter : 148504
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.566389799118042
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.309 Vali Acc: 0.048 Test Loss: 3.309 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.7251491546630859
Epoch: 2, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.295 Vali Acc: 0.046 Test Loss: 3.295 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8697719573974609
Epoch: 3, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.278 Vali Acc: 0.051 Test Loss: 3.278 Test Acc: 0.051
Validation loss decreased (-0.048202 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.6889262199401855
Epoch: 4, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.262 Vali Acc: 0.064 Test Loss: 3.262 Test Acc: 0.064
Validation loss decreased (-0.050555 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.786576509475708
Epoch: 5, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.249 Vali Acc: 0.080 Test Loss: 3.249 Test Acc: 0.080
Validation loss decreased (-0.063497 --> -0.079968).  Saving model ...
Epoch: 6 cost time: 0.8052053451538086
Epoch: 6, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.237 Vali Acc: 0.092 Test Loss: 3.237 Test Acc: 0.092
Validation loss decreased (-0.079968 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 0.8005492687225342
Epoch: 7, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.229 Vali Acc: 0.098 Test Loss: 3.229 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097615).  Saving model ...
Epoch: 8 cost time: 0.841522216796875
Epoch: 8, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.223 Vali Acc: 0.101 Test Loss: 3.223 Test Acc: 0.101
Validation loss decreased (-0.097615 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 0.8658490180969238
Epoch: 9, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.222 Vali Acc: 0.106 Test Loss: 3.222 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 0.9085004329681396
Epoch: 10, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.235 Vali Acc: 0.099 Test Loss: 3.235 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7717955112457275
Epoch: 11, Steps: 10 | Train Loss: 2.425 Vali Loss: 3.232 Vali Acc: 0.119 Test Loss: 3.232 Test Acc: 0.119
Validation loss decreased (-0.105850 --> -0.118791).  Saving model ...
Epoch: 12 cost time: 0.783515214920044
Epoch: 12, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.233 Vali Acc: 0.126 Test Loss: 3.233 Test Acc: 0.126
Validation loss decreased (-0.118791 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.6792793273925781
Epoch: 13, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.245 Vali Acc: 0.124 Test Loss: 3.245 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8470296859741211
Epoch: 14, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.256 Vali Acc: 0.124 Test Loss: 3.256 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7936525344848633
Epoch: 15, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.306 Vali Acc: 0.136 Test Loss: 3.306 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 0.6497302055358887
Epoch: 16, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.375 Vali Acc: 0.138 Test Loss: 3.375 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137613).  Saving model ...
Epoch: 17 cost time: 0.6326472759246826
Epoch: 17, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.450 Vali Acc: 0.159 Test Loss: 3.450 Test Acc: 0.159
Validation loss decreased (-0.137613 --> -0.158789).  Saving model ...
Epoch: 18 cost time: 0.8034770488739014
Epoch: 18, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.600 Vali Acc: 0.161 Test Loss: 3.600 Test Acc: 0.161
Validation loss decreased (-0.158789 --> -0.161140).  Saving model ...
Epoch: 19 cost time: 0.827254056930542
Epoch: 19, Steps: 10 | Train Loss: 1.190 Vali Loss: 3.725 Vali Acc: 0.166 Test Loss: 3.725 Test Acc: 0.166
Validation loss decreased (-0.161140 --> -0.165845).  Saving model ...
Epoch: 20 cost time: 0.8932316303253174
Epoch: 20, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.815 Vali Acc: 0.168 Test Loss: 3.815 Test Acc: 0.168
Validation loss decreased (-0.165845 --> -0.168197).  Saving model ...
Epoch: 21 cost time: 0.857783317565918
Epoch: 21, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.948 Vali Acc: 0.175 Test Loss: 3.948 Test Acc: 0.175
Validation loss decreased (-0.168197 --> -0.175255).  Saving model ...
Epoch: 22 cost time: 0.744530439376831
Epoch: 22, Steps: 10 | Train Loss: 0.772 Vali Loss: 4.092 Vali Acc: 0.174 Test Loss: 4.092 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7981326580047607
Epoch: 23, Steps: 10 | Train Loss: 0.678 Vali Loss: 4.283 Vali Acc: 0.171 Test Loss: 4.283 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.917283296585083
Epoch: 24, Steps: 10 | Train Loss: 0.541 Vali Loss: 4.537 Vali Acc: 0.172 Test Loss: 4.537 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9208009243011475
Epoch: 25, Steps: 10 | Train Loss: 0.449 Vali Loss: 4.719 Vali Acc: 0.184 Test Loss: 4.719 Test Acc: 0.184
Validation loss decreased (-0.175255 --> -0.183482).  Saving model ...
Epoch: 26 cost time: 0.8282856941223145
Epoch: 26, Steps: 10 | Train Loss: 0.394 Vali Loss: 5.006 Vali Acc: 0.176 Test Loss: 5.006 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9279048442840576
Epoch: 27, Steps: 10 | Train Loss: 0.300 Vali Loss: 5.278 Vali Acc: 0.175 Test Loss: 5.278 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8329982757568359
Epoch: 28, Steps: 10 | Train Loss: 0.223 Vali Loss: 5.543 Vali Acc: 0.171 Test Loss: 5.543 Test Acc: 0.171
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8935911655426025
Epoch: 29, Steps: 10 | Train Loss: 0.184 Vali Loss: 5.924 Vali Acc: 0.182 Test Loss: 5.924 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0190181732177734
Epoch: 30, Steps: 10 | Train Loss: 0.138 Vali Loss: 6.217 Vali Acc: 0.174 Test Loss: 6.217 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7565422058105469
Epoch: 31, Steps: 10 | Train Loss: 0.095 Vali Loss: 6.486 Vali Acc: 0.173 Test Loss: 6.486 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.80511474609375
Epoch: 32, Steps: 10 | Train Loss: 0.095 Vali Loss: 6.752 Vali Acc: 0.178 Test Loss: 6.752 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9138326644897461
Epoch: 33, Steps: 10 | Train Loss: 0.049 Vali Loss: 7.082 Vali Acc: 0.176 Test Loss: 7.082 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0155103206634521
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 7.366 Vali Acc: 0.179 Test Loss: 7.366 Test Acc: 0.179
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9320011138916016
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 7.730 Vali Acc: 0.178 Test Loss: 7.730 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18352941176470589
model parameter : 148302
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1215155124664307
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.299 Vali Acc: 0.026 Test Loss: 3.299 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 0.6980135440826416
Epoch: 2, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.288 Vali Acc: 0.032 Test Loss: 3.288 Test Acc: 0.032
Validation loss decreased (-0.025849 --> -0.031732).  Saving model ...
Epoch: 3 cost time: 0.633737325668335
Epoch: 3, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.274 Vali Acc: 0.040 Test Loss: 3.274 Test Acc: 0.040
Validation loss decreased (-0.031732 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 0.8266324996948242
Epoch: 4, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.259 Vali Acc: 0.049 Test Loss: 3.259 Test Acc: 0.049
Validation loss decreased (-0.039967 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.5948648452758789
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.246 Vali Acc: 0.058 Test Loss: 3.246 Test Acc: 0.058
Validation loss decreased (-0.049379 --> -0.057615).  Saving model ...
Epoch: 6 cost time: 0.759824275970459
Epoch: 6, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.236 Vali Acc: 0.080 Test Loss: 3.236 Test Acc: 0.080
Validation loss decreased (-0.057615 --> -0.079968).  Saving model ...
Epoch: 7 cost time: 0.7306020259857178
Epoch: 7, Steps: 10 | Train Loss: 2.815 Vali Loss: 3.225 Vali Acc: 0.095 Test Loss: 3.225 Test Acc: 0.095
Validation loss decreased (-0.079968 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.6715753078460693
Epoch: 8, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.223 Vali Acc: 0.099 Test Loss: 3.223 Test Acc: 0.099
Validation loss decreased (-0.095262 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 0.8092114925384521
Epoch: 9, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.220 Vali Acc: 0.107 Test Loss: 3.220 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 0.6827144622802734
Epoch: 10, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.221 Vali Acc: 0.113 Test Loss: 3.221 Test Acc: 0.113
Validation loss decreased (-0.107027 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 0.8089475631713867
Epoch: 11, Steps: 10 | Train Loss: 2.388 Vali Loss: 3.230 Vali Acc: 0.115 Test Loss: 3.230 Test Acc: 0.115
Validation loss decreased (-0.112909 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.7979388236999512
Epoch: 12, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.230 Vali Acc: 0.120 Test Loss: 3.230 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 0.7480931282043457
Epoch: 13, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.235 Vali Acc: 0.126 Test Loss: 3.235 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.867581844329834
Epoch: 14, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.255 Vali Acc: 0.129 Test Loss: 3.255 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129379).  Saving model ...
Epoch: 15 cost time: 0.9955403804779053
Epoch: 15, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.281 Vali Acc: 0.142 Test Loss: 3.281 Test Acc: 0.142
Validation loss decreased (-0.129379 --> -0.142320).  Saving model ...
Epoch: 16 cost time: 0.8812558650970459
Epoch: 16, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.352 Vali Acc: 0.144 Test Loss: 3.352 Test Acc: 0.144
Validation loss decreased (-0.142320 --> -0.143496).  Saving model ...
Epoch: 17 cost time: 0.854250431060791
Epoch: 17, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.450 Vali Acc: 0.153 Test Loss: 3.450 Test Acc: 0.153
Validation loss decreased (-0.143496 --> -0.152907).  Saving model ...
Epoch: 18 cost time: 0.8609504699707031
Epoch: 18, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.575 Vali Acc: 0.149 Test Loss: 3.575 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0217375755310059
Epoch: 19, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.740 Vali Acc: 0.169 Test Loss: 3.740 Test Acc: 0.169
Validation loss decreased (-0.152907 --> -0.169374).  Saving model ...
Epoch: 20 cost time: 0.6788794994354248
Epoch: 20, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.931 Vali Acc: 0.162 Test Loss: 3.931 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.798180103302002
Epoch: 21, Steps: 10 | Train Loss: 0.835 Vali Loss: 4.101 Vali Acc: 0.161 Test Loss: 4.101 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7571206092834473
Epoch: 22, Steps: 10 | Train Loss: 0.665 Vali Loss: 4.415 Vali Acc: 0.161 Test Loss: 4.415 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7718470096588135
Epoch: 23, Steps: 10 | Train Loss: 0.549 Vali Loss: 4.664 Vali Acc: 0.171 Test Loss: 4.664 Test Acc: 0.171
Validation loss decreased (-0.169374 --> -0.170542).  Saving model ...
Epoch: 24 cost time: 0.7206087112426758
Epoch: 24, Steps: 10 | Train Loss: 0.422 Vali Loss: 4.984 Vali Acc: 0.158 Test Loss: 4.984 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7201788425445557
Epoch: 25, Steps: 10 | Train Loss: 0.340 Vali Loss: 5.347 Vali Acc: 0.166 Test Loss: 5.347 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8628783226013184
Epoch: 26, Steps: 10 | Train Loss: 0.260 Vali Loss: 5.770 Vali Acc: 0.175 Test Loss: 5.770 Test Acc: 0.175
Validation loss decreased (-0.170542 --> -0.175236).  Saving model ...
Epoch: 27 cost time: 0.8640015125274658
Epoch: 27, Steps: 10 | Train Loss: 0.213 Vali Loss: 6.064 Vali Acc: 0.169 Test Loss: 6.064 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2955312728881836
Epoch: 28, Steps: 10 | Train Loss: 0.145 Vali Loss: 6.558 Vali Acc: 0.185 Test Loss: 6.558 Test Acc: 0.185
Validation loss decreased (-0.175236 --> -0.184640).  Saving model ...
Epoch: 29 cost time: 0.7998883724212646
Epoch: 29, Steps: 10 | Train Loss: 0.101 Vali Loss: 7.023 Vali Acc: 0.175 Test Loss: 7.023 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8474562168121338
Epoch: 30, Steps: 10 | Train Loss: 0.099 Vali Loss: 7.331 Vali Acc: 0.171 Test Loss: 7.331 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0910050868988037
Epoch: 31, Steps: 10 | Train Loss: 0.069 Vali Loss: 7.695 Vali Acc: 0.174 Test Loss: 7.695 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1085896492004395
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 8.011 Vali Acc: 0.173 Test Loss: 8.011 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0461719036102295
Epoch: 33, Steps: 10 | Train Loss: 0.049 Vali Loss: 8.259 Vali Acc: 0.175 Test Loss: 8.259 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.971595048904419
Epoch: 34, Steps: 10 | Train Loss: 0.049 Vali Loss: 8.470 Vali Acc: 0.171 Test Loss: 8.470 Test Acc: 0.171
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0517160892486572
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 8.824 Vali Acc: 0.182 Test Loss: 8.824 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.150907039642334
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 8.892 Vali Acc: 0.181 Test Loss: 8.892 Test Acc: 0.181
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0539968013763428
Epoch: 37, Steps: 10 | Train Loss: 0.056 Vali Loss: 9.096 Vali Acc: 0.182 Test Loss: 9.096 Test Acc: 0.182
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1895341873168945
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 9.242 Vali Acc: 0.182 Test Loss: 9.242 Test Acc: 0.182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18470588235294116
model parameter : 147800
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0909736156463623
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.311 Vali Acc: 0.041 Test Loss: 3.311 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.7721261978149414
Epoch: 2, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.301 Vali Acc: 0.044 Test Loss: 3.301 Test Acc: 0.044
Validation loss decreased (-0.041143 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.749077558517456
Epoch: 3, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.288 Vali Acc: 0.046 Test Loss: 3.288 Test Acc: 0.046
Validation loss decreased (-0.043496 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 1.076493501663208
Epoch: 4, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.275 Vali Acc: 0.049 Test Loss: 3.275 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.906548261642456
Epoch: 5, Steps: 10 | Train Loss: 3.039 Vali Loss: 3.262 Vali Acc: 0.065 Test Loss: 3.262 Test Acc: 0.065
Validation loss decreased (-0.049379 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 1.1074028015136719
Epoch: 6, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.254 Vali Acc: 0.075 Test Loss: 3.254 Test Acc: 0.075
Validation loss decreased (-0.064673 --> -0.075262).  Saving model ...
Epoch: 7 cost time: 1.3104281425476074
Epoch: 7, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.246 Vali Acc: 0.080 Test Loss: 3.246 Test Acc: 0.080
Validation loss decreased (-0.075262 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 0.7470083236694336
Epoch: 8, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.245 Vali Acc: 0.081 Test Loss: 3.245 Test Acc: 0.081
Validation loss decreased (-0.079968 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 1.0135283470153809
Epoch: 9, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.249 Vali Acc: 0.088 Test Loss: 3.249 Test Acc: 0.088
Validation loss decreased (-0.081144 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 0.8879561424255371
Epoch: 10, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.236 Vali Acc: 0.098 Test Loss: 3.236 Test Acc: 0.098
Validation loss decreased (-0.088203 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 0.9354076385498047
Epoch: 11, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.230 Vali Acc: 0.113 Test Loss: 3.230 Test Acc: 0.113
Validation loss decreased (-0.097615 --> -0.112909).  Saving model ...
Epoch: 12 cost time: 0.9113354682922363
Epoch: 12, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.225 Vali Acc: 0.124 Test Loss: 3.225 Test Acc: 0.124
Validation loss decreased (-0.112909 --> -0.123497).  Saving model ...
Epoch: 13 cost time: 1.1645090579986572
Epoch: 13, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.236 Vali Acc: 0.133 Test Loss: 3.236 Test Acc: 0.133
Validation loss decreased (-0.123497 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.857825756072998
Epoch: 14, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.290 Vali Acc: 0.158 Test Loss: 3.290 Test Acc: 0.158
Validation loss decreased (-0.132909 --> -0.157614).  Saving model ...
Epoch: 15 cost time: 1.2197120189666748
Epoch: 15, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.357 Vali Acc: 0.180 Test Loss: 3.357 Test Acc: 0.180
Validation loss decreased (-0.157614 --> -0.179966).  Saving model ...
Epoch: 16 cost time: 0.899298906326294
Epoch: 16, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.451 Vali Acc: 0.187 Test Loss: 3.451 Test Acc: 0.187
Validation loss decreased (-0.179966 --> -0.187024).  Saving model ...
Epoch: 17 cost time: 1.114377737045288
Epoch: 17, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.515 Vali Acc: 0.205 Test Loss: 3.515 Test Acc: 0.205
Validation loss decreased (-0.187024 --> -0.204671).  Saving model ...
Epoch: 18 cost time: 1.056891679763794
Epoch: 18, Steps: 10 | Train Loss: 1.190 Vali Loss: 3.550 Vali Acc: 0.205 Test Loss: 3.550 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0924420356750488
Epoch: 19, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.633 Vali Acc: 0.212 Test Loss: 3.633 Test Acc: 0.212
Validation loss decreased (-0.204671 --> -0.211728).  Saving model ...
Epoch: 20 cost time: 1.2797276973724365
Epoch: 20, Steps: 10 | Train Loss: 0.896 Vali Loss: 3.748 Vali Acc: 0.211 Test Loss: 3.748 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9941163063049316
Epoch: 21, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.839 Vali Acc: 0.216 Test Loss: 3.839 Test Acc: 0.216
Validation loss decreased (-0.211728 --> -0.216432).  Saving model ...
Epoch: 22 cost time: 1.1157851219177246
Epoch: 22, Steps: 10 | Train Loss: 0.615 Vali Loss: 4.013 Vali Acc: 0.220 Test Loss: 4.013 Test Acc: 0.220
Validation loss decreased (-0.216432 --> -0.219960).  Saving model ...
Epoch: 23 cost time: 1.0884089469909668
Epoch: 23, Steps: 10 | Train Loss: 0.486 Vali Loss: 4.253 Vali Acc: 0.211 Test Loss: 4.253 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9364092350006104
Epoch: 24, Steps: 10 | Train Loss: 0.399 Vali Loss: 4.448 Vali Acc: 0.219 Test Loss: 4.448 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9956707954406738
Epoch: 25, Steps: 10 | Train Loss: 0.294 Vali Loss: 4.800 Vali Acc: 0.221 Test Loss: 4.800 Test Acc: 0.221
Validation loss decreased (-0.219960 --> -0.221128).  Saving model ...
Epoch: 26 cost time: 1.1554300785064697
Epoch: 26, Steps: 10 | Train Loss: 0.244 Vali Loss: 5.007 Vali Acc: 0.225 Test Loss: 5.007 Test Acc: 0.225
Validation loss decreased (-0.221128 --> -0.224656).  Saving model ...
Epoch: 27 cost time: 0.7688724994659424
Epoch: 27, Steps: 10 | Train Loss: 0.189 Vali Loss: 5.382 Vali Acc: 0.226 Test Loss: 5.382 Test Acc: 0.226
Validation loss decreased (-0.224656 --> -0.225829).  Saving model ...
Epoch: 28 cost time: 0.6572105884552002
Epoch: 28, Steps: 10 | Train Loss: 0.134 Vali Loss: 5.609 Vali Acc: 0.222 Test Loss: 5.609 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6893181800842285
Epoch: 29, Steps: 10 | Train Loss: 0.102 Vali Loss: 5.915 Vali Acc: 0.233 Test Loss: 5.915 Test Acc: 0.233
Validation loss decreased (-0.225829 --> -0.232882).  Saving model ...
Epoch: 30 cost time: 1.0261356830596924
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.232 Vali Acc: 0.220 Test Loss: 6.232 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7784903049468994
Epoch: 31, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.493 Vali Acc: 0.227 Test Loss: 6.493 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7668323516845703
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 6.810 Vali Acc: 0.227 Test Loss: 6.810 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1388912200927734
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.954 Vali Acc: 0.233 Test Loss: 6.954 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0637245178222656
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.240 Vali Acc: 0.232 Test Loss: 7.240 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8582794666290283
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 7.418 Vali Acc: 0.233 Test Loss: 7.418 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.889634370803833
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 7.544 Vali Acc: 0.235 Test Loss: 7.544 Test Acc: 0.235
Validation loss decreased (-0.232882 --> -0.235219).  Saving model ...
Epoch: 37 cost time: 1.1429131031036377
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 7.724 Vali Acc: 0.235 Test Loss: 7.724 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9034411907196045
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 7.862 Vali Acc: 0.232 Test Loss: 7.862 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.165590763092041
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 7.996 Vali Acc: 0.234 Test Loss: 7.996 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8600866794586182
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.119 Vali Acc: 0.229 Test Loss: 8.119 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1172780990600586
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.241 Vali Acc: 0.228 Test Loss: 8.241 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.939068078994751
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.361 Vali Acc: 0.232 Test Loss: 8.361 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0414743423461914
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.477 Vali Acc: 0.229 Test Loss: 8.477 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9345848560333252
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.584 Vali Acc: 0.232 Test Loss: 8.584 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9676132202148438
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 8.669 Vali Acc: 0.228 Test Loss: 8.669 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7481746673583984
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 8.758 Vali Acc: 0.227 Test Loss: 8.758 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23529411764705882
model parameter : 148584
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8902323246002197
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.309 Vali Acc: 0.036 Test Loss: 3.309 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.8582704067230225
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.297 Vali Acc: 0.042 Test Loss: 3.297 Test Acc: 0.042
Validation loss decreased (-0.036437 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.9629809856414795
Epoch: 3, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.283 Vali Acc: 0.049 Test Loss: 3.283 Test Acc: 0.049
Validation loss decreased (-0.042320 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.8864128589630127
Epoch: 4, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.271 Vali Acc: 0.058 Test Loss: 3.271 Test Acc: 0.058
Validation loss decreased (-0.049379 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 1.0985305309295654
Epoch: 5, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.257 Vali Acc: 0.078 Test Loss: 3.257 Test Acc: 0.078
Validation loss decreased (-0.057614 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 0.9876101016998291
Epoch: 6, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.250 Vali Acc: 0.081 Test Loss: 3.250 Test Acc: 0.081
Validation loss decreased (-0.077614 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 0.6424856185913086
Epoch: 7, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.245 Vali Acc: 0.087 Test Loss: 3.245 Test Acc: 0.087
Validation loss decreased (-0.081144 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 1.0723011493682861
Epoch: 8, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.242 Vali Acc: 0.096 Test Loss: 3.242 Test Acc: 0.096
Validation loss decreased (-0.087026 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 0.8588628768920898
Epoch: 9, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.243 Vali Acc: 0.099 Test Loss: 3.243 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 1.0635173320770264
Epoch: 10, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.239 Vali Acc: 0.114 Test Loss: 3.239 Test Acc: 0.114
Validation loss decreased (-0.098791 --> -0.114085).  Saving model ...
Epoch: 11 cost time: 0.9118251800537109
Epoch: 11, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.252 Vali Acc: 0.120 Test Loss: 3.252 Test Acc: 0.120
Validation loss decreased (-0.114085 --> -0.119967).  Saving model ...
Epoch: 12 cost time: 1.0162463188171387
Epoch: 12, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.270 Vali Acc: 0.129 Test Loss: 3.270 Test Acc: 0.129
Validation loss decreased (-0.119967 --> -0.129379).  Saving model ...
Epoch: 13 cost time: 1.0763821601867676
Epoch: 13, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.293 Vali Acc: 0.144 Test Loss: 3.293 Test Acc: 0.144
Validation loss decreased (-0.129379 --> -0.143496).  Saving model ...
Epoch: 14 cost time: 0.9407873153686523
Epoch: 14, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.351 Vali Acc: 0.148 Test Loss: 3.351 Test Acc: 0.148
Validation loss decreased (-0.143496 --> -0.148202).  Saving model ...
Epoch: 15 cost time: 0.6433568000793457
Epoch: 15, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.450 Vali Acc: 0.153 Test Loss: 3.450 Test Acc: 0.153
Validation loss decreased (-0.148202 --> -0.152907).  Saving model ...
Epoch: 16 cost time: 0.870983362197876
Epoch: 16, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.558 Vali Acc: 0.164 Test Loss: 3.558 Test Acc: 0.164
Validation loss decreased (-0.152907 --> -0.163494).  Saving model ...
Epoch: 17 cost time: 0.9085075855255127
Epoch: 17, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.659 Vali Acc: 0.164 Test Loss: 3.659 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8983073234558105
Epoch: 18, Steps: 10 | Train Loss: 1.162 Vali Loss: 3.834 Vali Acc: 0.174 Test Loss: 3.834 Test Acc: 0.174
Validation loss decreased (-0.163494 --> -0.174079).  Saving model ...
Epoch: 19 cost time: 0.8140754699707031
Epoch: 19, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.948 Vali Acc: 0.172 Test Loss: 3.948 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8840649127960205
Epoch: 20, Steps: 10 | Train Loss: 0.842 Vali Loss: 4.082 Vali Acc: 0.176 Test Loss: 4.082 Test Acc: 0.176
Validation loss decreased (-0.174079 --> -0.176430).  Saving model ...
Epoch: 21 cost time: 0.7581319808959961
Epoch: 21, Steps: 10 | Train Loss: 0.725 Vali Loss: 4.220 Vali Acc: 0.165 Test Loss: 4.220 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.802743673324585
Epoch: 22, Steps: 10 | Train Loss: 0.615 Vali Loss: 4.458 Vali Acc: 0.180 Test Loss: 4.458 Test Acc: 0.180
Validation loss decreased (-0.176430 --> -0.179955).  Saving model ...
Epoch: 23 cost time: 0.9368352890014648
Epoch: 23, Steps: 10 | Train Loss: 0.453 Vali Loss: 4.680 Vali Acc: 0.182 Test Loss: 4.680 Test Acc: 0.182
Validation loss decreased (-0.179955 --> -0.182306).  Saving model ...
Epoch: 24 cost time: 0.7913095951080322
Epoch: 24, Steps: 10 | Train Loss: 0.361 Vali Loss: 4.982 Vali Acc: 0.180 Test Loss: 4.982 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8444502353668213
Epoch: 25, Steps: 10 | Train Loss: 0.274 Vali Loss: 5.329 Vali Acc: 0.196 Test Loss: 5.329 Test Acc: 0.196
Validation loss decreased (-0.182306 --> -0.196417).  Saving model ...
Epoch: 26 cost time: 0.7350835800170898
Epoch: 26, Steps: 10 | Train Loss: 0.181 Vali Loss: 5.724 Vali Acc: 0.184 Test Loss: 5.724 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0403313636779785
Epoch: 27, Steps: 10 | Train Loss: 0.131 Vali Loss: 6.092 Vali Acc: 0.194 Test Loss: 6.092 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7547755241394043
Epoch: 28, Steps: 10 | Train Loss: 0.071 Vali Loss: 6.538 Vali Acc: 0.198 Test Loss: 6.538 Test Acc: 0.198
Validation loss decreased (-0.196417 --> -0.197582).  Saving model ...
Epoch: 29 cost time: 1.1180601119995117
Epoch: 29, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.924 Vali Acc: 0.194 Test Loss: 6.924 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7712092399597168
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 7.335 Vali Acc: 0.198 Test Loss: 7.335 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0642306804656982
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 7.675 Vali Acc: 0.193 Test Loss: 7.675 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.11202073097229
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.964 Vali Acc: 0.202 Test Loss: 7.964 Test Acc: 0.202
Validation loss decreased (-0.197582 --> -0.202273).  Saving model ...
Epoch: 33 cost time: 1.0119056701660156
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.175 Vali Acc: 0.207 Test Loss: 8.175 Test Acc: 0.207
Validation loss decreased (-0.202273 --> -0.206977).  Saving model ...
Epoch: 34 cost time: 0.8762919902801514
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 8.404 Vali Acc: 0.198 Test Loss: 8.404 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.88252854347229
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.565 Vali Acc: 0.205 Test Loss: 8.565 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8756113052368164
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 8.728 Vali Acc: 0.207 Test Loss: 8.728 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7256026268005371
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 8.896 Vali Acc: 0.202 Test Loss: 8.896 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.859917163848877
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 9.044 Vali Acc: 0.201 Test Loss: 9.044 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8545711040496826
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 9.160 Vali Acc: 0.202 Test Loss: 9.160 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9287314414978027
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 9.289 Vali Acc: 0.202 Test Loss: 9.289 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7779879570007324
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 9.413 Vali Acc: 0.201 Test Loss: 9.413 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0490357875823975
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 9.526 Vali Acc: 0.199 Test Loss: 9.526 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7866008281707764
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 9.641 Vali Acc: 0.201 Test Loss: 9.641 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20705882352941177
model parameter : 147334
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.784898042678833
Epoch: 1, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.324 Vali Acc: 0.034 Test Loss: 3.324 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.995384693145752
Epoch: 2, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.312 Vali Acc: 0.036 Test Loss: 3.312 Test Acc: 0.036
Validation loss decreased (-0.034084 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.7392125129699707
Epoch: 3, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.297 Vali Acc: 0.047 Test Loss: 3.297 Test Acc: 0.047
Validation loss decreased (-0.036437 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.7816410064697266
Epoch: 4, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.283 Vali Acc: 0.060 Test Loss: 3.283 Test Acc: 0.060
Validation loss decreased (-0.047026 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.6808350086212158
Epoch: 5, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.268 Vali Acc: 0.078 Test Loss: 3.268 Test Acc: 0.078
Validation loss decreased (-0.059967 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 0.8164606094360352
Epoch: 6, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.255 Vali Acc: 0.089 Test Loss: 3.255 Test Acc: 0.089
Validation loss decreased (-0.077614 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.693608283996582
Epoch: 7, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.245 Vali Acc: 0.091 Test Loss: 3.245 Test Acc: 0.091
Validation loss decreased (-0.089379 --> -0.090556).  Saving model ...
Epoch: 8 cost time: 0.5530853271484375
Epoch: 8, Steps: 10 | Train Loss: 2.690 Vali Loss: 3.240 Vali Acc: 0.100 Test Loss: 3.240 Test Acc: 0.100
Validation loss decreased (-0.090556 --> -0.099968).  Saving model ...
Epoch: 9 cost time: 0.8286283016204834
Epoch: 9, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.235 Vali Acc: 0.113 Test Loss: 3.235 Test Acc: 0.113
Validation loss decreased (-0.099968 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 0.7250096797943115
Epoch: 10, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.239 Vali Acc: 0.118 Test Loss: 3.239 Test Acc: 0.118
Validation loss decreased (-0.112909 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 0.8342022895812988
Epoch: 11, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.250 Vali Acc: 0.126 Test Loss: 3.250 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125850).  Saving model ...
Epoch: 12 cost time: 0.8661823272705078
Epoch: 12, Steps: 10 | Train Loss: 2.096 Vali Loss: 3.302 Vali Acc: 0.119 Test Loss: 3.302 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0497784614562988
Epoch: 13, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.351 Vali Acc: 0.127 Test Loss: 3.351 Test Acc: 0.127
Validation loss decreased (-0.125850 --> -0.127025).  Saving model ...
Epoch: 14 cost time: 0.9102554321289062
Epoch: 14, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.389 Vali Acc: 0.129 Test Loss: 3.389 Test Acc: 0.129
Validation loss decreased (-0.127025 --> -0.129378).  Saving model ...
Epoch: 15 cost time: 0.7604143619537354
Epoch: 15, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.435 Vali Acc: 0.140 Test Loss: 3.435 Test Acc: 0.140
Validation loss decreased (-0.129378 --> -0.139966).  Saving model ...
Epoch: 16 cost time: 0.639491081237793
Epoch: 16, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.505 Vali Acc: 0.147 Test Loss: 3.505 Test Acc: 0.147
Validation loss decreased (-0.139966 --> -0.147024).  Saving model ...
Epoch: 17 cost time: 0.7661454677581787
Epoch: 17, Steps: 10 | Train Loss: 1.345 Vali Loss: 3.562 Vali Acc: 0.147 Test Loss: 3.562 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9016175270080566
Epoch: 18, Steps: 10 | Train Loss: 1.190 Vali Loss: 3.587 Vali Acc: 0.158 Test Loss: 3.587 Test Acc: 0.158
Validation loss decreased (-0.147024 --> -0.157611).  Saving model ...
Epoch: 19 cost time: 0.8688361644744873
Epoch: 19, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.718 Vali Acc: 0.159 Test Loss: 3.718 Test Acc: 0.159
Validation loss decreased (-0.157611 --> -0.158786).  Saving model ...
Epoch: 20 cost time: 0.8203058242797852
Epoch: 20, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.807 Vali Acc: 0.162 Test Loss: 3.807 Test Acc: 0.162
Validation loss decreased (-0.158786 --> -0.162315).  Saving model ...
Epoch: 21 cost time: 1.1786224842071533
Epoch: 21, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.936 Vali Acc: 0.158 Test Loss: 3.936 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0590369701385498
Epoch: 22, Steps: 10 | Train Loss: 0.645 Vali Loss: 4.122 Vali Acc: 0.160 Test Loss: 4.122 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8538100719451904
Epoch: 23, Steps: 10 | Train Loss: 0.521 Vali Loss: 4.369 Vali Acc: 0.172 Test Loss: 4.369 Test Acc: 0.172
Validation loss decreased (-0.162315 --> -0.171721).  Saving model ...
Epoch: 24 cost time: 0.9741778373718262
Epoch: 24, Steps: 10 | Train Loss: 0.464 Vali Loss: 4.648 Vali Acc: 0.165 Test Loss: 4.648 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7714786529541016
Epoch: 25, Steps: 10 | Train Loss: 0.343 Vali Loss: 4.907 Vali Acc: 0.161 Test Loss: 4.907 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.81968092918396
Epoch: 26, Steps: 10 | Train Loss: 0.326 Vali Loss: 5.260 Vali Acc: 0.161 Test Loss: 5.260 Test Acc: 0.161
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7936127185821533
Epoch: 27, Steps: 10 | Train Loss: 0.187 Vali Loss: 5.619 Vali Acc: 0.158 Test Loss: 5.619 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6921718120574951
Epoch: 28, Steps: 10 | Train Loss: 0.128 Vali Loss: 6.037 Vali Acc: 0.153 Test Loss: 6.037 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8194122314453125
Epoch: 29, Steps: 10 | Train Loss: 0.131 Vali Loss: 6.446 Vali Acc: 0.164 Test Loss: 6.446 Test Acc: 0.164
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7826600074768066
Epoch: 30, Steps: 10 | Train Loss: 0.055 Vali Loss: 6.860 Vali Acc: 0.155 Test Loss: 6.860 Test Acc: 0.155
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1136932373046875
Epoch: 31, Steps: 10 | Train Loss: 0.054 Vali Loss: 7.199 Vali Acc: 0.158 Test Loss: 7.199 Test Acc: 0.158
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8788285255432129
Epoch: 32, Steps: 10 | Train Loss: 0.053 Vali Loss: 7.593 Vali Acc: 0.148 Test Loss: 7.593 Test Acc: 0.148
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9644250869750977
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.898 Vali Acc: 0.142 Test Loss: 7.898 Test Acc: 0.142
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17176470588235293
model parameter : 147078
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.610496759414673
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.338 Vali Acc: 0.031 Test Loss: 3.338 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.7802317142486572
Epoch: 2, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.324 Vali Acc: 0.033 Test Loss: 3.324 Test Acc: 0.033
Validation loss decreased (-0.030555 --> -0.032908).  Saving model ...
Epoch: 3 cost time: 0.8914275169372559
Epoch: 3, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.307 Vali Acc: 0.042 Test Loss: 3.307 Test Acc: 0.042
Validation loss decreased (-0.032908 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 0.9639475345611572
Epoch: 4, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.290 Vali Acc: 0.052 Test Loss: 3.290 Test Acc: 0.052
Validation loss decreased (-0.042320 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.8074383735656738
Epoch: 5, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.274 Vali Acc: 0.065 Test Loss: 3.274 Test Acc: 0.065
Validation loss decreased (-0.051732 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 0.99853515625
Epoch: 6, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.258 Vali Acc: 0.081 Test Loss: 3.258 Test Acc: 0.081
Validation loss decreased (-0.064673 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 0.9665317535400391
Epoch: 7, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.244 Vali Acc: 0.095 Test Loss: 3.244 Test Acc: 0.095
Validation loss decreased (-0.081144 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.8630454540252686
Epoch: 8, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.232 Vali Acc: 0.104 Test Loss: 3.232 Test Acc: 0.104
Validation loss decreased (-0.095262 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.034813642501831
Epoch: 9, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.222 Vali Acc: 0.112 Test Loss: 3.222 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.8868792057037354
Epoch: 10, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.217 Vali Acc: 0.116 Test Loss: 3.217 Test Acc: 0.116
Validation loss decreased (-0.111732 --> -0.116438).  Saving model ...
Epoch: 11 cost time: 0.9073233604431152
Epoch: 11, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.211 Vali Acc: 0.124 Test Loss: 3.211 Test Acc: 0.124
Validation loss decreased (-0.116438 --> -0.123497).  Saving model ...
Epoch: 12 cost time: 0.9021570682525635
Epoch: 12, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.211 Vali Acc: 0.125 Test Loss: 3.211 Test Acc: 0.125
Validation loss decreased (-0.123497 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 0.8358755111694336
Epoch: 13, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.217 Vali Acc: 0.125 Test Loss: 3.217 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7480790615081787
Epoch: 14, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.223 Vali Acc: 0.138 Test Loss: 3.223 Test Acc: 0.138
Validation loss decreased (-0.124674 --> -0.137615).  Saving model ...
Epoch: 15 cost time: 0.8499348163604736
Epoch: 15, Steps: 10 | Train Loss: 1.960 Vali Loss: 3.232 Vali Acc: 0.142 Test Loss: 3.232 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142321).  Saving model ...
Epoch: 16 cost time: 0.8318061828613281
Epoch: 16, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.250 Vali Acc: 0.155 Test Loss: 3.250 Test Acc: 0.155
Validation loss decreased (-0.142321 --> -0.155262).  Saving model ...
Epoch: 17 cost time: 0.8052933216094971
Epoch: 17, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.266 Vali Acc: 0.164 Test Loss: 3.266 Test Acc: 0.164
Validation loss decreased (-0.155262 --> -0.163497).  Saving model ...
Epoch: 18 cost time: 0.8125178813934326
Epoch: 18, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.296 Vali Acc: 0.168 Test Loss: 3.296 Test Acc: 0.168
Validation loss decreased (-0.163497 --> -0.168202).  Saving model ...
Epoch: 19 cost time: 0.8071436882019043
Epoch: 19, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.338 Vali Acc: 0.173 Test Loss: 3.338 Test Acc: 0.173
Validation loss decreased (-0.168202 --> -0.172908).  Saving model ...
Epoch: 20 cost time: 0.6510357856750488
Epoch: 20, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.392 Vali Acc: 0.179 Test Loss: 3.392 Test Acc: 0.179
Validation loss decreased (-0.172908 --> -0.178790).  Saving model ...
Epoch: 21 cost time: 1.1636254787445068
Epoch: 21, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.442 Vali Acc: 0.181 Test Loss: 3.442 Test Acc: 0.181
Validation loss decreased (-0.178790 --> -0.181142).  Saving model ...
Epoch: 22 cost time: 0.8317160606384277
Epoch: 22, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.507 Vali Acc: 0.184 Test Loss: 3.507 Test Acc: 0.184
Validation loss decreased (-0.181142 --> -0.183494).  Saving model ...
Epoch: 23 cost time: 0.962670087814331
Epoch: 23, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.607 Vali Acc: 0.188 Test Loss: 3.607 Test Acc: 0.188
Validation loss decreased (-0.183494 --> -0.188199).  Saving model ...
Epoch: 24 cost time: 0.7352826595306396
Epoch: 24, Steps: 10 | Train Loss: 0.663 Vali Loss: 3.750 Vali Acc: 0.191 Test Loss: 3.750 Test Acc: 0.191
Validation loss decreased (-0.188199 --> -0.190551).  Saving model ...
Epoch: 25 cost time: 0.8857758045196533
Epoch: 25, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.878 Vali Acc: 0.182 Test Loss: 3.878 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8726811408996582
Epoch: 26, Steps: 10 | Train Loss: 0.398 Vali Loss: 4.080 Vali Acc: 0.178 Test Loss: 4.080 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.343977689743042
Epoch: 27, Steps: 10 | Train Loss: 0.302 Vali Loss: 4.294 Vali Acc: 0.182 Test Loss: 4.294 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9064733982086182
Epoch: 28, Steps: 10 | Train Loss: 0.225 Vali Loss: 4.576 Vali Acc: 0.180 Test Loss: 4.576 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9538941383361816
Epoch: 29, Steps: 10 | Train Loss: 0.177 Vali Loss: 4.793 Vali Acc: 0.182 Test Loss: 4.793 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8173394203186035
Epoch: 30, Steps: 10 | Train Loss: 0.121 Vali Loss: 5.070 Vali Acc: 0.175 Test Loss: 5.070 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2448482513427734
Epoch: 31, Steps: 10 | Train Loss: 0.093 Vali Loss: 5.358 Vali Acc: 0.178 Test Loss: 5.358 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1365666389465332
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 5.543 Vali Acc: 0.180 Test Loss: 5.543 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0220603942871094
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.844 Vali Acc: 0.172 Test Loss: 5.844 Test Acc: 0.172
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8850858211517334
Epoch: 34, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.016 Vali Acc: 0.178 Test Loss: 6.016 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19058823529411764
model parameter : 74936
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.415601968765259
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.284 Vali Acc: 0.042 Test Loss: 3.284 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.7220849990844727
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.272 Vali Acc: 0.039 Test Loss: 3.272 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9138453006744385
Epoch: 3, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.258 Vali Acc: 0.040 Test Loss: 3.258 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9678645133972168
Epoch: 4, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.244 Vali Acc: 0.051 Test Loss: 3.244 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050556).  Saving model ...
Epoch: 5 cost time: 0.8793179988861084
Epoch: 5, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.231 Vali Acc: 0.064 Test Loss: 3.231 Test Acc: 0.064
Validation loss decreased (-0.050556 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.942826509475708
Epoch: 6, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.221 Vali Acc: 0.076 Test Loss: 3.221 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.799074649810791
Epoch: 7, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.212 Vali Acc: 0.085 Test Loss: 3.212 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084674).  Saving model ...
Epoch: 8 cost time: 1.0076110363006592
Epoch: 8, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.208 Vali Acc: 0.089 Test Loss: 3.208 Test Acc: 0.089
Validation loss decreased (-0.084674 --> -0.089380).  Saving model ...
Epoch: 9 cost time: 0.9690299034118652
Epoch: 9, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.204 Vali Acc: 0.099 Test Loss: 3.204 Test Acc: 0.099
Validation loss decreased (-0.089380 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 1.006469488143921
Epoch: 10, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.202 Vali Acc: 0.100 Test Loss: 3.202 Test Acc: 0.100
Validation loss decreased (-0.098791 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 0.9240117073059082
Epoch: 11, Steps: 10 | Train Loss: 2.423 Vali Loss: 3.200 Vali Acc: 0.109 Test Loss: 3.200 Test Acc: 0.109
Validation loss decreased (-0.099968 --> -0.109380).  Saving model ...
Epoch: 12 cost time: 1.1703381538391113
Epoch: 12, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.197 Vali Acc: 0.113 Test Loss: 3.197 Test Acc: 0.113
Validation loss decreased (-0.109380 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 0.8524515628814697
Epoch: 13, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.203 Vali Acc: 0.115 Test Loss: 3.203 Test Acc: 0.115
Validation loss decreased (-0.112909 --> -0.115262).  Saving model ...
Epoch: 14 cost time: 0.8743641376495361
Epoch: 14, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.201 Vali Acc: 0.120 Test Loss: 3.201 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 15 cost time: 1.0275580883026123
Epoch: 15, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.203 Vali Acc: 0.127 Test Loss: 3.203 Test Acc: 0.127
Validation loss decreased (-0.119968 --> -0.127027).  Saving model ...
Epoch: 16 cost time: 1.0811176300048828
Epoch: 16, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.211 Vali Acc: 0.139 Test Loss: 3.211 Test Acc: 0.139
Validation loss decreased (-0.127027 --> -0.138791).  Saving model ...
Epoch: 17 cost time: 1.0549042224884033
Epoch: 17, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.222 Vali Acc: 0.146 Test Loss: 3.222 Test Acc: 0.146
Validation loss decreased (-0.138791 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.9072370529174805
Epoch: 18, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.245 Vali Acc: 0.148 Test Loss: 3.245 Test Acc: 0.148
Validation loss decreased (-0.145850 --> -0.148203).  Saving model ...
Epoch: 19 cost time: 1.031895637512207
Epoch: 19, Steps: 10 | Train Loss: 1.537 Vali Loss: 3.275 Vali Acc: 0.154 Test Loss: 3.275 Test Acc: 0.154
Validation loss decreased (-0.148203 --> -0.154085).  Saving model ...
Epoch: 20 cost time: 1.1401190757751465
Epoch: 20, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.318 Vali Acc: 0.159 Test Loss: 3.318 Test Acc: 0.159
Validation loss decreased (-0.154085 --> -0.158790).  Saving model ...
Epoch: 21 cost time: 1.0026273727416992
Epoch: 21, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.350 Vali Acc: 0.168 Test Loss: 3.350 Test Acc: 0.168
Validation loss decreased (-0.158790 --> -0.168202).  Saving model ...
Epoch: 22 cost time: 0.9888787269592285
Epoch: 22, Steps: 10 | Train Loss: 1.140 Vali Loss: 3.387 Vali Acc: 0.174 Test Loss: 3.387 Test Acc: 0.174
Validation loss decreased (-0.168202 --> -0.174084).  Saving model ...
Epoch: 23 cost time: 1.0212280750274658
Epoch: 23, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.499 Vali Acc: 0.180 Test Loss: 3.499 Test Acc: 0.180
Validation loss decreased (-0.174084 --> -0.179965).  Saving model ...
Epoch: 24 cost time: 1.0969207286834717
Epoch: 24, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.542 Vali Acc: 0.181 Test Loss: 3.542 Test Acc: 0.181
Validation loss decreased (-0.179965 --> -0.181141).  Saving model ...
Epoch: 25 cost time: 0.9583346843719482
Epoch: 25, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.662 Vali Acc: 0.174 Test Loss: 3.662 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9867560863494873
Epoch: 26, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.792 Vali Acc: 0.184 Test Loss: 3.792 Test Acc: 0.184
Validation loss decreased (-0.181141 --> -0.183491).  Saving model ...
Epoch: 27 cost time: 0.9474589824676514
Epoch: 27, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.984 Vali Acc: 0.191 Test Loss: 3.984 Test Acc: 0.191
Validation loss decreased (-0.183491 --> -0.190548).  Saving model ...
Epoch: 28 cost time: 1.0602385997772217
Epoch: 28, Steps: 10 | Train Loss: 0.399 Vali Loss: 4.178 Vali Acc: 0.204 Test Loss: 4.178 Test Acc: 0.204
Validation loss decreased (-0.190548 --> -0.203488).  Saving model ...
Epoch: 29 cost time: 0.8364720344543457
Epoch: 29, Steps: 10 | Train Loss: 0.288 Vali Loss: 4.445 Vali Acc: 0.193 Test Loss: 4.445 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1969258785247803
Epoch: 30, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.710 Vali Acc: 0.193 Test Loss: 4.710 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.868600606918335
Epoch: 31, Steps: 10 | Train Loss: 0.166 Vali Loss: 5.010 Vali Acc: 0.187 Test Loss: 5.010 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7506942749023438
Epoch: 32, Steps: 10 | Train Loss: 0.134 Vali Loss: 5.223 Vali Acc: 0.180 Test Loss: 5.223 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.237499475479126
Epoch: 33, Steps: 10 | Train Loss: 0.095 Vali Loss: 5.548 Vali Acc: 0.185 Test Loss: 5.548 Test Acc: 0.185
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0247786045074463
Epoch: 34, Steps: 10 | Train Loss: 0.070 Vali Loss: 5.851 Vali Acc: 0.182 Test Loss: 5.851 Test Acc: 0.182
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.359273910522461
Epoch: 35, Steps: 10 | Train Loss: 0.053 Vali Loss: 6.071 Vali Acc: 0.186 Test Loss: 6.071 Test Acc: 0.186
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.243732213973999
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 6.317 Vali Acc: 0.185 Test Loss: 6.317 Test Acc: 0.185
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3531849384307861
Epoch: 37, Steps: 10 | Train Loss: 0.030 Vali Loss: 6.583 Vali Acc: 0.181 Test Loss: 6.583 Test Acc: 0.181
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0883708000183105
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 6.758 Vali Acc: 0.180 Test Loss: 6.758 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20352941176470588
model parameter : 71902
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6584925651550293
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.339 Vali Acc: 0.053 Test Loss: 3.339 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 1.4730634689331055
Epoch: 2, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.326 Vali Acc: 0.053 Test Loss: 3.326 Test Acc: 0.053
Validation loss decreased (-0.052908 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.3308193683624268
Epoch: 3, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.311 Vali Acc: 0.049 Test Loss: 3.311 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9218916893005371
Epoch: 4, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.297 Vali Acc: 0.047 Test Loss: 3.297 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1872355937957764
Epoch: 5, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.283 Vali Acc: 0.053 Test Loss: 3.283 Test Acc: 0.053
Validation loss decreased (-0.052908 --> -0.052908).  Saving model ...
Epoch: 6 cost time: 1.0209200382232666
Epoch: 6, Steps: 10 | Train Loss: 2.986 Vali Loss: 3.269 Vali Acc: 0.058 Test Loss: 3.269 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 7 cost time: 1.219017505645752
Epoch: 7, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.261 Vali Acc: 0.073 Test Loss: 3.261 Test Acc: 0.073
Validation loss decreased (-0.057614 --> -0.072909).  Saving model ...
Epoch: 8 cost time: 1.2945818901062012
Epoch: 8, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.256 Vali Acc: 0.085 Test Loss: 3.256 Test Acc: 0.085
Validation loss decreased (-0.072909 --> -0.084673).  Saving model ...
Epoch: 9 cost time: 1.1076464653015137
Epoch: 9, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.256 Vali Acc: 0.087 Test Loss: 3.256 Test Acc: 0.087
Validation loss decreased (-0.084673 --> -0.087026).  Saving model ...
Epoch: 10 cost time: 0.8650665283203125
Epoch: 10, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.251 Vali Acc: 0.101 Test Loss: 3.251 Test Acc: 0.101
Validation loss decreased (-0.087026 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 1.0110788345336914
Epoch: 11, Steps: 10 | Train Loss: 2.484 Vali Loss: 3.252 Vali Acc: 0.113 Test Loss: 3.252 Test Acc: 0.113
Validation loss decreased (-0.101144 --> -0.112909).  Saving model ...
Epoch: 12 cost time: 1.025097370147705
Epoch: 12, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.247 Vali Acc: 0.125 Test Loss: 3.247 Test Acc: 0.125
Validation loss decreased (-0.112909 --> -0.124673).  Saving model ...
Epoch: 13 cost time: 1.0914769172668457
Epoch: 13, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.245 Vali Acc: 0.127 Test Loss: 3.245 Test Acc: 0.127
Validation loss decreased (-0.124673 --> -0.127026).  Saving model ...
Epoch: 14 cost time: 1.2308542728424072
Epoch: 14, Steps: 10 | Train Loss: 2.136 Vali Loss: 3.237 Vali Acc: 0.129 Test Loss: 3.237 Test Acc: 0.129
Validation loss decreased (-0.127026 --> -0.129379).  Saving model ...
Epoch: 15 cost time: 1.0055501461029053
Epoch: 15, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.246 Vali Acc: 0.136 Test Loss: 3.246 Test Acc: 0.136
Validation loss decreased (-0.129379 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 1.260922908782959
Epoch: 16, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.248 Vali Acc: 0.144 Test Loss: 3.248 Test Acc: 0.144
Validation loss decreased (-0.136438 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 0.9587161540985107
Epoch: 17, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.255 Vali Acc: 0.147 Test Loss: 3.255 Test Acc: 0.147
Validation loss decreased (-0.143497 --> -0.147026).  Saving model ...
Epoch: 18 cost time: 1.1191415786743164
Epoch: 18, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.261 Vali Acc: 0.159 Test Loss: 3.261 Test Acc: 0.159
Validation loss decreased (-0.147026 --> -0.158791).  Saving model ...
Epoch: 19 cost time: 1.1344149112701416
Epoch: 19, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.294 Vali Acc: 0.169 Test Loss: 3.294 Test Acc: 0.169
Validation loss decreased (-0.158791 --> -0.169379).  Saving model ...
Epoch: 20 cost time: 0.7269868850708008
Epoch: 20, Steps: 10 | Train Loss: 1.440 Vali Loss: 3.331 Vali Acc: 0.173 Test Loss: 3.331 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 21 cost time: 1.1270194053649902
Epoch: 21, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.372 Vali Acc: 0.174 Test Loss: 3.372 Test Acc: 0.174
Validation loss decreased (-0.172908 --> -0.174084).  Saving model ...
Epoch: 22 cost time: 0.8954918384552002
Epoch: 22, Steps: 10 | Train Loss: 1.211 Vali Loss: 3.426 Vali Acc: 0.173 Test Loss: 3.426 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2440197467803955
Epoch: 23, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.476 Vali Acc: 0.178 Test Loss: 3.476 Test Acc: 0.178
Validation loss decreased (-0.174084 --> -0.177612).  Saving model ...
Epoch: 24 cost time: 1.3591618537902832
Epoch: 24, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.569 Vali Acc: 0.191 Test Loss: 3.569 Test Acc: 0.191
Validation loss decreased (-0.177612 --> -0.190553).  Saving model ...
Epoch: 25 cost time: 0.9844937324523926
Epoch: 25, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.669 Vali Acc: 0.188 Test Loss: 3.669 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2084941864013672
Epoch: 26, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.814 Vali Acc: 0.189 Test Loss: 3.814 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1044039726257324
Epoch: 27, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.974 Vali Acc: 0.194 Test Loss: 3.974 Test Acc: 0.194
Validation loss decreased (-0.190553 --> -0.194078).  Saving model ...
Epoch: 28 cost time: 1.2432596683502197
Epoch: 28, Steps: 10 | Train Loss: 0.475 Vali Loss: 4.130 Vali Acc: 0.200 Test Loss: 4.130 Test Acc: 0.200
Validation loss decreased (-0.194078 --> -0.199959).  Saving model ...
Epoch: 29 cost time: 0.8406665325164795
Epoch: 29, Steps: 10 | Train Loss: 0.407 Vali Loss: 4.270 Vali Acc: 0.200 Test Loss: 4.270 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8724734783172607
Epoch: 30, Steps: 10 | Train Loss: 0.341 Vali Loss: 4.475 Vali Acc: 0.195 Test Loss: 4.475 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9332668781280518
Epoch: 31, Steps: 10 | Train Loss: 0.270 Vali Loss: 4.657 Vali Acc: 0.199 Test Loss: 4.657 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0775203704833984
Epoch: 32, Steps: 10 | Train Loss: 0.228 Vali Loss: 4.835 Vali Acc: 0.200 Test Loss: 4.835 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8708348274230957
Epoch: 33, Steps: 10 | Train Loss: 0.181 Vali Loss: 5.028 Vali Acc: 0.191 Test Loss: 5.028 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.088883638381958
Epoch: 34, Steps: 10 | Train Loss: 0.151 Vali Loss: 5.246 Vali Acc: 0.198 Test Loss: 5.246 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8177776336669922
Epoch: 35, Steps: 10 | Train Loss: 0.125 Vali Loss: 5.408 Vali Acc: 0.196 Test Loss: 5.408 Test Acc: 0.196
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.291576623916626
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 5.644 Vali Acc: 0.202 Test Loss: 5.644 Test Acc: 0.202
Validation loss decreased (-0.199959 --> -0.202297).  Saving model ...
Epoch: 37 cost time: 1.221834421157837
Epoch: 37, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.874 Vali Acc: 0.198 Test Loss: 5.874 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0938177108764648
Epoch: 38, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.105 Vali Acc: 0.198 Test Loss: 6.105 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.087717056274414
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 6.280 Vali Acc: 0.195 Test Loss: 6.280 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8899087905883789
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 6.474 Vali Acc: 0.188 Test Loss: 6.474 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1271474361419678
Epoch: 41, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.669 Vali Acc: 0.191 Test Loss: 6.669 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6989901065826416
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 6.855 Vali Acc: 0.191 Test Loss: 6.855 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9804835319519043
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 7.018 Vali Acc: 0.188 Test Loss: 7.018 Test Acc: 0.188
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8203120231628418
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 7.167 Vali Acc: 0.188 Test Loss: 7.167 Test Acc: 0.188
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9419724941253662
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.331 Vali Acc: 0.187 Test Loss: 7.331 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1982247829437256
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 7.498 Vali Acc: 0.188 Test Loss: 7.498 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2023529411764706
model parameter : 70104
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8729746341705322
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.331 Vali Acc: 0.047 Test Loss: 3.331 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.1479833126068115
Epoch: 2, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.321 Vali Acc: 0.047 Test Loss: 3.321 Test Acc: 0.047
Validation loss decreased (-0.047026 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.370323657989502
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.307 Vali Acc: 0.047 Test Loss: 3.307 Test Acc: 0.047
Validation loss decreased (-0.047026 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.9239249229431152
Epoch: 4, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.293 Vali Acc: 0.053 Test Loss: 3.293 Test Acc: 0.053
Validation loss decreased (-0.047026 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.9508235454559326
Epoch: 5, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.280 Vali Acc: 0.061 Test Loss: 3.280 Test Acc: 0.061
Validation loss decreased (-0.052908 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.9567198753356934
Epoch: 6, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.267 Vali Acc: 0.076 Test Loss: 3.267 Test Acc: 0.076
Validation loss decreased (-0.061144 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.8528192043304443
Epoch: 7, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.256 Vali Acc: 0.091 Test Loss: 3.256 Test Acc: 0.091
Validation loss decreased (-0.076438 --> -0.090556).  Saving model ...
Epoch: 8 cost time: 1.0538711547851562
Epoch: 8, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.245 Vali Acc: 0.105 Test Loss: 3.245 Test Acc: 0.105
Validation loss decreased (-0.090556 --> -0.104673).  Saving model ...
Epoch: 9 cost time: 0.9650466442108154
Epoch: 9, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.240 Vali Acc: 0.105 Test Loss: 3.240 Test Acc: 0.105
Validation loss decreased (-0.104673 --> -0.104673).  Saving model ...
Epoch: 10 cost time: 0.8646259307861328
Epoch: 10, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.237 Vali Acc: 0.113 Test Loss: 3.237 Test Acc: 0.113
Validation loss decreased (-0.104673 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 0.875516414642334
Epoch: 11, Steps: 10 | Train Loss: 2.462 Vali Loss: 3.239 Vali Acc: 0.115 Test Loss: 3.239 Test Acc: 0.115
Validation loss decreased (-0.112909 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.924086332321167
Epoch: 12, Steps: 10 | Train Loss: 2.369 Vali Loss: 3.240 Vali Acc: 0.119 Test Loss: 3.240 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.870492696762085
Epoch: 13, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.240 Vali Acc: 0.132 Test Loss: 3.240 Test Acc: 0.132
Validation loss decreased (-0.118791 --> -0.131732).  Saving model ...
Epoch: 14 cost time: 1.0940220355987549
Epoch: 14, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.246 Vali Acc: 0.133 Test Loss: 3.246 Test Acc: 0.133
Validation loss decreased (-0.131732 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.8631069660186768
Epoch: 15, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.247 Vali Acc: 0.138 Test Loss: 3.247 Test Acc: 0.138
Validation loss decreased (-0.132909 --> -0.137615).  Saving model ...
Epoch: 16 cost time: 1.1539361476898193
Epoch: 16, Steps: 10 | Train Loss: 1.916 Vali Loss: 3.256 Vali Acc: 0.144 Test Loss: 3.256 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 1.2200205326080322
Epoch: 17, Steps: 10 | Train Loss: 1.809 Vali Loss: 3.286 Vali Acc: 0.146 Test Loss: 3.286 Test Acc: 0.146
Validation loss decreased (-0.143497 --> -0.145849).  Saving model ...
Epoch: 18 cost time: 0.913754940032959
Epoch: 18, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.308 Vali Acc: 0.149 Test Loss: 3.308 Test Acc: 0.149
Validation loss decreased (-0.145849 --> -0.149379).  Saving model ...
Epoch: 19 cost time: 0.765265941619873
Epoch: 19, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.345 Vali Acc: 0.156 Test Loss: 3.345 Test Acc: 0.156
Validation loss decreased (-0.149379 --> -0.156437).  Saving model ...
Epoch: 20 cost time: 0.77773118019104
Epoch: 20, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.401 Vali Acc: 0.165 Test Loss: 3.401 Test Acc: 0.165
Validation loss decreased (-0.156437 --> -0.164672).  Saving model ...
Epoch: 21 cost time: 0.7838587760925293
Epoch: 21, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.441 Vali Acc: 0.180 Test Loss: 3.441 Test Acc: 0.180
Validation loss decreased (-0.164672 --> -0.179966).  Saving model ...
Epoch: 22 cost time: 0.8611500263214111
Epoch: 22, Steps: 10 | Train Loss: 1.188 Vali Loss: 3.481 Vali Acc: 0.188 Test Loss: 3.481 Test Acc: 0.188
Validation loss decreased (-0.179966 --> -0.188200).  Saving model ...
Epoch: 23 cost time: 0.7656259536743164
Epoch: 23, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.548 Vali Acc: 0.186 Test Loss: 3.548 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0703976154327393
Epoch: 24, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.598 Vali Acc: 0.198 Test Loss: 3.598 Test Acc: 0.198
Validation loss decreased (-0.188200 --> -0.197611).  Saving model ...
Epoch: 25 cost time: 0.9636850357055664
Epoch: 25, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.619 Vali Acc: 0.205 Test Loss: 3.619 Test Acc: 0.205
Validation loss decreased (-0.197611 --> -0.204670).  Saving model ...
Epoch: 26 cost time: 0.9350206851959229
Epoch: 26, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.721 Vali Acc: 0.201 Test Loss: 3.721 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9480757713317871
Epoch: 27, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.837 Vali Acc: 0.206 Test Loss: 3.837 Test Acc: 0.206
Validation loss decreased (-0.204670 --> -0.205844).  Saving model ...
Epoch: 28 cost time: 1.164881706237793
Epoch: 28, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.948 Vali Acc: 0.205 Test Loss: 3.948 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0810496807098389
Epoch: 29, Steps: 10 | Train Loss: 0.525 Vali Loss: 4.109 Vali Acc: 0.206 Test Loss: 4.109 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9891619682312012
Epoch: 30, Steps: 10 | Train Loss: 0.379 Vali Loss: 4.193 Vali Acc: 0.212 Test Loss: 4.193 Test Acc: 0.212
Validation loss decreased (-0.205844 --> -0.211723).  Saving model ...
Epoch: 31 cost time: 1.040858507156372
Epoch: 31, Steps: 10 | Train Loss: 0.322 Vali Loss: 4.406 Vali Acc: 0.212 Test Loss: 4.406 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1166002750396729
Epoch: 32, Steps: 10 | Train Loss: 0.260 Vali Loss: 4.581 Vali Acc: 0.204 Test Loss: 4.581 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8818724155426025
Epoch: 33, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.790 Vali Acc: 0.216 Test Loss: 4.790 Test Acc: 0.216
Validation loss decreased (-0.211723 --> -0.216423).  Saving model ...
Epoch: 34 cost time: 0.7928276062011719
Epoch: 34, Steps: 10 | Train Loss: 0.157 Vali Loss: 5.071 Vali Acc: 0.216 Test Loss: 5.071 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8610396385192871
Epoch: 35, Steps: 10 | Train Loss: 0.122 Vali Loss: 5.323 Vali Acc: 0.206 Test Loss: 5.323 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1787168979644775
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 5.513 Vali Acc: 0.215 Test Loss: 5.513 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3073680400848389
Epoch: 37, Steps: 10 | Train Loss: 0.079 Vali Loss: 5.762 Vali Acc: 0.211 Test Loss: 5.762 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9689579010009766
Epoch: 38, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.965 Vali Acc: 0.208 Test Loss: 5.965 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.013845443725586
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 6.230 Vali Acc: 0.224 Test Loss: 6.230 Test Acc: 0.224
Validation loss decreased (-0.216423 --> -0.223467).  Saving model ...
Epoch: 40 cost time: 1.1195323467254639
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 6.402 Vali Acc: 0.216 Test Loss: 6.402 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1702375411987305
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.550 Vali Acc: 0.216 Test Loss: 6.550 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9693348407745361
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 6.744 Vali Acc: 0.216 Test Loss: 6.744 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8734948635101318
Epoch: 43, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.887 Vali Acc: 0.209 Test Loss: 6.887 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9913783073425293
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 7.125 Vali Acc: 0.212 Test Loss: 7.125 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0306484699249268
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.285 Vali Acc: 0.211 Test Loss: 7.285 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9613187313079834
Epoch: 46, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.394 Vali Acc: 0.215 Test Loss: 7.394 Test Acc: 0.215
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9204730987548828
Epoch: 47, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.558 Vali Acc: 0.214 Test Loss: 7.558 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.4635357856750488
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.680 Vali Acc: 0.213 Test Loss: 7.680 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9806861877441406
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.819 Vali Acc: 0.213 Test Loss: 7.819 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 69686
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.48842716217041
Epoch: 1, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.291 Vali Acc: 0.038 Test Loss: 3.291 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.1968967914581299
Epoch: 2, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.283 Vali Acc: 0.039 Test Loss: 3.283 Test Acc: 0.039
Validation loss decreased (-0.037614 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 0.7263827323913574
Epoch: 3, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.272 Vali Acc: 0.054 Test Loss: 3.272 Test Acc: 0.054
Validation loss decreased (-0.038791 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 0.8355686664581299
Epoch: 4, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.261 Vali Acc: 0.065 Test Loss: 3.261 Test Acc: 0.065
Validation loss decreased (-0.054085 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.0377960205078125
Epoch: 5, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.250 Vali Acc: 0.074 Test Loss: 3.250 Test Acc: 0.074
Validation loss decreased (-0.064673 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 0.9503817558288574
Epoch: 6, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.240 Vali Acc: 0.082 Test Loss: 3.240 Test Acc: 0.082
Validation loss decreased (-0.074085 --> -0.082321).  Saving model ...
Epoch: 7 cost time: 0.8374218940734863
Epoch: 7, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.233 Vali Acc: 0.093 Test Loss: 3.233 Test Acc: 0.093
Validation loss decreased (-0.082321 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 1.198347568511963
Epoch: 8, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.229 Vali Acc: 0.094 Test Loss: 3.229 Test Acc: 0.094
Validation loss decreased (-0.092909 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.8773508071899414
Epoch: 9, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.225 Vali Acc: 0.099 Test Loss: 3.225 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 0.8646430969238281
Epoch: 10, Steps: 10 | Train Loss: 2.541 Vali Loss: 3.223 Vali Acc: 0.098 Test Loss: 3.223 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8299310207366943
Epoch: 11, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.224 Vali Acc: 0.108 Test Loss: 3.224 Test Acc: 0.108
Validation loss decreased (-0.098791 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 1.0453987121582031
Epoch: 12, Steps: 10 | Train Loss: 2.321 Vali Loss: 3.229 Vali Acc: 0.119 Test Loss: 3.229 Test Acc: 0.119
Validation loss decreased (-0.108203 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.9175958633422852
Epoch: 13, Steps: 10 | Train Loss: 2.225 Vali Loss: 3.232 Vali Acc: 0.126 Test Loss: 3.232 Test Acc: 0.126
Validation loss decreased (-0.118791 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.8008394241333008
Epoch: 14, Steps: 10 | Train Loss: 2.114 Vali Loss: 3.237 Vali Acc: 0.132 Test Loss: 3.237 Test Acc: 0.132
Validation loss decreased (-0.125850 --> -0.131732).  Saving model ...
Epoch: 15 cost time: 0.9690155982971191
Epoch: 15, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.243 Vali Acc: 0.139 Test Loss: 3.243 Test Acc: 0.139
Validation loss decreased (-0.131732 --> -0.138791).  Saving model ...
Epoch: 16 cost time: 0.9350121021270752
Epoch: 16, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.252 Vali Acc: 0.151 Test Loss: 3.252 Test Acc: 0.151
Validation loss decreased (-0.138791 --> -0.150556).  Saving model ...
Epoch: 17 cost time: 1.3499374389648438
Epoch: 17, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.256 Vali Acc: 0.155 Test Loss: 3.256 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 18 cost time: 1.0788607597351074
Epoch: 18, Steps: 10 | Train Loss: 1.647 Vali Loss: 3.280 Vali Acc: 0.159 Test Loss: 3.280 Test Acc: 0.159
Validation loss decreased (-0.155262 --> -0.158791).  Saving model ...
Epoch: 19 cost time: 1.08774995803833
Epoch: 19, Steps: 10 | Train Loss: 1.573 Vali Loss: 3.311 Vali Acc: 0.160 Test Loss: 3.311 Test Acc: 0.160
Validation loss decreased (-0.158791 --> -0.159967).  Saving model ...
Epoch: 20 cost time: 0.8750276565551758
Epoch: 20, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.333 Vali Acc: 0.169 Test Loss: 3.333 Test Acc: 0.169
Validation loss decreased (-0.159967 --> -0.169378).  Saving model ...
Epoch: 21 cost time: 0.9256279468536377
Epoch: 21, Steps: 10 | Train Loss: 1.348 Vali Loss: 3.352 Vali Acc: 0.171 Test Loss: 3.352 Test Acc: 0.171
Validation loss decreased (-0.169378 --> -0.170555).  Saving model ...
Epoch: 22 cost time: 1.0327496528625488
Epoch: 22, Steps: 10 | Train Loss: 1.239 Vali Loss: 3.388 Vali Acc: 0.180 Test Loss: 3.388 Test Acc: 0.180
Validation loss decreased (-0.170555 --> -0.179966).  Saving model ...
Epoch: 23 cost time: 1.23622465133667
Epoch: 23, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.452 Vali Acc: 0.176 Test Loss: 3.452 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8941845893859863
Epoch: 24, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.517 Vali Acc: 0.182 Test Loss: 3.517 Test Acc: 0.182
Validation loss decreased (-0.179966 --> -0.182318).  Saving model ...
Epoch: 25 cost time: 0.8162574768066406
Epoch: 25, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.569 Vali Acc: 0.187 Test Loss: 3.569 Test Acc: 0.187
Validation loss decreased (-0.182318 --> -0.187023).  Saving model ...
Epoch: 26 cost time: 0.9513578414916992
Epoch: 26, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.645 Vali Acc: 0.186 Test Loss: 3.645 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1792397499084473
Epoch: 27, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.720 Vali Acc: 0.187 Test Loss: 3.720 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7764356136322021
Epoch: 28, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.830 Vali Acc: 0.187 Test Loss: 3.830 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8486099243164062
Epoch: 29, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.958 Vali Acc: 0.193 Test Loss: 3.958 Test Acc: 0.193
Validation loss decreased (-0.187023 --> -0.192902).  Saving model ...
Epoch: 30 cost time: 0.9753224849700928
Epoch: 30, Steps: 10 | Train Loss: 0.507 Vali Loss: 4.057 Vali Acc: 0.181 Test Loss: 4.057 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8529083728790283
Epoch: 31, Steps: 10 | Train Loss: 0.435 Vali Loss: 4.200 Vali Acc: 0.181 Test Loss: 4.200 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0893871784210205
Epoch: 32, Steps: 10 | Train Loss: 0.398 Vali Loss: 4.381 Vali Acc: 0.175 Test Loss: 4.381 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8943471908569336
Epoch: 33, Steps: 10 | Train Loss: 0.313 Vali Loss: 4.564 Vali Acc: 0.185 Test Loss: 4.564 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2803642749786377
Epoch: 34, Steps: 10 | Train Loss: 0.264 Vali Loss: 4.681 Vali Acc: 0.172 Test Loss: 4.681 Test Acc: 0.172
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9446365833282471
Epoch: 35, Steps: 10 | Train Loss: 0.222 Vali Loss: 4.896 Vali Acc: 0.175 Test Loss: 4.896 Test Acc: 0.175
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.170557975769043
Epoch: 36, Steps: 10 | Train Loss: 0.183 Vali Loss: 5.067 Vali Acc: 0.185 Test Loss: 5.067 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7407429218292236
Epoch: 37, Steps: 10 | Train Loss: 0.160 Vali Loss: 5.322 Vali Acc: 0.178 Test Loss: 5.322 Test Acc: 0.178
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9229395389556885
Epoch: 38, Steps: 10 | Train Loss: 0.127 Vali Loss: 5.440 Vali Acc: 0.185 Test Loss: 5.440 Test Acc: 0.185
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.980292558670044
Epoch: 39, Steps: 10 | Train Loss: 0.108 Vali Loss: 5.692 Vali Acc: 0.184 Test Loss: 5.692 Test Acc: 0.184
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19294117647058823
model parameter : 69224
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.839311122894287
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.322 Vali Acc: 0.034 Test Loss: 3.322 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.9713239669799805
Epoch: 2, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.309 Vali Acc: 0.034 Test Loss: 3.309 Test Acc: 0.034
Validation loss decreased (-0.034084 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 0.9718871116638184
Epoch: 3, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.294 Vali Acc: 0.036 Test Loss: 3.294 Test Acc: 0.036
Validation loss decreased (-0.034085 --> -0.036438).  Saving model ...
Epoch: 4 cost time: 0.9491372108459473
Epoch: 4, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.277 Vali Acc: 0.046 Test Loss: 3.277 Test Acc: 0.046
Validation loss decreased (-0.036438 --> -0.045850).  Saving model ...
Epoch: 5 cost time: 1.1002693176269531
Epoch: 5, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.261 Vali Acc: 0.058 Test Loss: 3.261 Test Acc: 0.058
Validation loss decreased (-0.045850 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 1.1452157497406006
Epoch: 6, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.245 Vali Acc: 0.078 Test Loss: 3.245 Test Acc: 0.078
Validation loss decreased (-0.057614 --> -0.077615).  Saving model ...
Epoch: 7 cost time: 0.8113055229187012
Epoch: 7, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.232 Vali Acc: 0.092 Test Loss: 3.232 Test Acc: 0.092
Validation loss decreased (-0.077615 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 0.866487979888916
Epoch: 8, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.222 Vali Acc: 0.095 Test Loss: 3.222 Test Acc: 0.095
Validation loss decreased (-0.091732 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 0.9756410121917725
Epoch: 9, Steps: 10 | Train Loss: 2.651 Vali Loss: 3.215 Vali Acc: 0.112 Test Loss: 3.215 Test Acc: 0.112
Validation loss decreased (-0.095262 --> -0.111733).  Saving model ...
Epoch: 10 cost time: 1.1051952838897705
Epoch: 10, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.210 Vali Acc: 0.116 Test Loss: 3.210 Test Acc: 0.116
Validation loss decreased (-0.111733 --> -0.116438).  Saving model ...
Epoch: 11 cost time: 0.9554595947265625
Epoch: 11, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.205 Vali Acc: 0.119 Test Loss: 3.205 Test Acc: 0.119
Validation loss decreased (-0.116438 --> -0.118791).  Saving model ...
Epoch: 12 cost time: 1.1223170757293701
Epoch: 12, Steps: 10 | Train Loss: 2.308 Vali Loss: 3.206 Vali Acc: 0.125 Test Loss: 3.206 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 1.0809900760650635
Epoch: 13, Steps: 10 | Train Loss: 2.214 Vali Loss: 3.211 Vali Acc: 0.124 Test Loss: 3.211 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9926724433898926
Epoch: 14, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.214 Vali Acc: 0.124 Test Loss: 3.214 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1738536357879639
Epoch: 15, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.210 Vali Acc: 0.129 Test Loss: 3.210 Test Acc: 0.129
Validation loss decreased (-0.124674 --> -0.129380).  Saving model ...
Epoch: 16 cost time: 1.1110479831695557
Epoch: 16, Steps: 10 | Train Loss: 1.850 Vali Loss: 3.220 Vali Acc: 0.140 Test Loss: 3.220 Test Acc: 0.140
Validation loss decreased (-0.129380 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 1.1206085681915283
Epoch: 17, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.234 Vali Acc: 0.152 Test Loss: 3.234 Test Acc: 0.152
Validation loss decreased (-0.139968 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 0.94020676612854
Epoch: 18, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.270 Vali Acc: 0.164 Test Loss: 3.270 Test Acc: 0.164
Validation loss decreased (-0.151732 --> -0.163497).  Saving model ...
Epoch: 19 cost time: 1.0667669773101807
Epoch: 19, Steps: 10 | Train Loss: 1.445 Vali Loss: 3.290 Vali Acc: 0.169 Test Loss: 3.290 Test Acc: 0.169
Validation loss decreased (-0.163497 --> -0.169379).  Saving model ...
Epoch: 20 cost time: 1.551537275314331
Epoch: 20, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.341 Vali Acc: 0.179 Test Loss: 3.341 Test Acc: 0.179
Validation loss decreased (-0.169379 --> -0.178790).  Saving model ...
Epoch: 21 cost time: 0.9761025905609131
Epoch: 21, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.377 Vali Acc: 0.182 Test Loss: 3.377 Test Acc: 0.182
Validation loss decreased (-0.178790 --> -0.182319).  Saving model ...
Epoch: 22 cost time: 0.8873450756072998
Epoch: 22, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.455 Vali Acc: 0.189 Test Loss: 3.455 Test Acc: 0.189
Validation loss decreased (-0.182319 --> -0.189377).  Saving model ...
Epoch: 23 cost time: 1.1062326431274414
Epoch: 23, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.529 Vali Acc: 0.191 Test Loss: 3.529 Test Acc: 0.191
Validation loss decreased (-0.189377 --> -0.190553).  Saving model ...
Epoch: 24 cost time: 0.8748481273651123
Epoch: 24, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.611 Vali Acc: 0.194 Test Loss: 3.611 Test Acc: 0.194
Validation loss decreased (-0.190553 --> -0.194082).  Saving model ...
Epoch: 25 cost time: 1.0111346244812012
Epoch: 25, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.685 Vali Acc: 0.201 Test Loss: 3.685 Test Acc: 0.201
Validation loss decreased (-0.194082 --> -0.201140).  Saving model ...
Epoch: 26 cost time: 0.8931002616882324
Epoch: 26, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.786 Vali Acc: 0.212 Test Loss: 3.786 Test Acc: 0.212
Validation loss decreased (-0.201140 --> -0.211727).  Saving model ...
Epoch: 27 cost time: 1.0848398208618164
Epoch: 27, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.941 Vali Acc: 0.208 Test Loss: 3.941 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9548189640045166
Epoch: 28, Steps: 10 | Train Loss: 0.432 Vali Loss: 4.108 Vali Acc: 0.209 Test Loss: 4.108 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1523022651672363
Epoch: 29, Steps: 10 | Train Loss: 0.372 Vali Loss: 4.263 Vali Acc: 0.201 Test Loss: 4.263 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2190942764282227
Epoch: 30, Steps: 10 | Train Loss: 0.341 Vali Loss: 4.405 Vali Acc: 0.202 Test Loss: 4.405 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8839850425720215
Epoch: 31, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.636 Vali Acc: 0.192 Test Loss: 4.636 Test Acc: 0.192
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9178638458251953
Epoch: 32, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.835 Vali Acc: 0.195 Test Loss: 4.835 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0195119380950928
Epoch: 33, Steps: 10 | Train Loss: 0.162 Vali Loss: 5.050 Vali Acc: 0.194 Test Loss: 5.050 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0411186218261719
Epoch: 34, Steps: 10 | Train Loss: 0.133 Vali Loss: 5.237 Vali Acc: 0.199 Test Loss: 5.237 Test Acc: 0.199
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2306139469146729
Epoch: 35, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.444 Vali Acc: 0.199 Test Loss: 5.444 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9613592624664307
Epoch: 36, Steps: 10 | Train Loss: 0.078 Vali Loss: 5.688 Vali Acc: 0.198 Test Loss: 5.688 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21176470588235294
model parameter : 68438
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5278160572052
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.320 Vali Acc: 0.026 Test Loss: 3.320 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 1.0546612739562988
Epoch: 2, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.309 Vali Acc: 0.028 Test Loss: 3.309 Test Acc: 0.028
Validation loss decreased (-0.025849 --> -0.028202).  Saving model ...
Epoch: 3 cost time: 1.2750475406646729
Epoch: 3, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.294 Vali Acc: 0.035 Test Loss: 3.294 Test Acc: 0.035
Validation loss decreased (-0.028202 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 0.8733582496643066
Epoch: 4, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.278 Vali Acc: 0.045 Test Loss: 3.278 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 0.8657457828521729
Epoch: 5, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.264 Vali Acc: 0.056 Test Loss: 3.264 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 1.0420684814453125
Epoch: 6, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.249 Vali Acc: 0.072 Test Loss: 3.249 Test Acc: 0.072
Validation loss decreased (-0.056438 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.9390158653259277
Epoch: 7, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.237 Vali Acc: 0.082 Test Loss: 3.237 Test Acc: 0.082
Validation loss decreased (-0.071732 --> -0.082321).  Saving model ...
Epoch: 8 cost time: 0.9158806800842285
Epoch: 8, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.227 Vali Acc: 0.093 Test Loss: 3.227 Test Acc: 0.093
Validation loss decreased (-0.082321 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 1.1174161434173584
Epoch: 9, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.220 Vali Acc: 0.105 Test Loss: 3.220 Test Acc: 0.105
Validation loss decreased (-0.092909 --> -0.104674).  Saving model ...
Epoch: 10 cost time: 1.024571180343628
Epoch: 10, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.216 Vali Acc: 0.108 Test Loss: 3.216 Test Acc: 0.108
Validation loss decreased (-0.104674 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.9011144638061523
Epoch: 11, Steps: 10 | Train Loss: 2.457 Vali Loss: 3.211 Vali Acc: 0.120 Test Loss: 3.211 Test Acc: 0.120
Validation loss decreased (-0.108203 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.8414993286132812
Epoch: 12, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.214 Vali Acc: 0.124 Test Loss: 3.214 Test Acc: 0.124
Validation loss decreased (-0.119968 --> -0.123497).  Saving model ...
Epoch: 13 cost time: 0.866793155670166
Epoch: 13, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.218 Vali Acc: 0.125 Test Loss: 3.218 Test Acc: 0.125
Validation loss decreased (-0.123497 --> -0.124674).  Saving model ...
Epoch: 14 cost time: 0.971106767654419
Epoch: 14, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.224 Vali Acc: 0.133 Test Loss: 3.224 Test Acc: 0.133
Validation loss decreased (-0.124674 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.9767708778381348
Epoch: 15, Steps: 10 | Train Loss: 2.034 Vali Loss: 3.234 Vali Acc: 0.134 Test Loss: 3.234 Test Acc: 0.134
Validation loss decreased (-0.132909 --> -0.134085).  Saving model ...
Epoch: 16 cost time: 0.8459935188293457
Epoch: 16, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.242 Vali Acc: 0.140 Test Loss: 3.242 Test Acc: 0.140
Validation loss decreased (-0.134085 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 1.1288154125213623
Epoch: 17, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.252 Vali Acc: 0.149 Test Loss: 3.252 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 18 cost time: 1.201591968536377
Epoch: 18, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.275 Vali Acc: 0.155 Test Loss: 3.275 Test Acc: 0.155
Validation loss decreased (-0.149379 --> -0.155261).  Saving model ...
Epoch: 19 cost time: 0.9918520450592041
Epoch: 19, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.313 Vali Acc: 0.169 Test Loss: 3.313 Test Acc: 0.169
Validation loss decreased (-0.155261 --> -0.169379).  Saving model ...
Epoch: 20 cost time: 1.1061091423034668
Epoch: 20, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.338 Vali Acc: 0.180 Test Loss: 3.338 Test Acc: 0.180
Validation loss decreased (-0.169379 --> -0.179967).  Saving model ...
Epoch: 21 cost time: 1.1166017055511475
Epoch: 21, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.396 Vali Acc: 0.193 Test Loss: 3.396 Test Acc: 0.193
Validation loss decreased (-0.179967 --> -0.192907).  Saving model ...
Epoch: 22 cost time: 0.9232466220855713
Epoch: 22, Steps: 10 | Train Loss: 1.162 Vali Loss: 3.481 Vali Acc: 0.186 Test Loss: 3.481 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2432868480682373
Epoch: 23, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.559 Vali Acc: 0.189 Test Loss: 3.559 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0950558185577393
Epoch: 24, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.619 Vali Acc: 0.200 Test Loss: 3.619 Test Acc: 0.200
Validation loss decreased (-0.192907 --> -0.199964).  Saving model ...
Epoch: 25 cost time: 0.7998690605163574
Epoch: 25, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.774 Vali Acc: 0.195 Test Loss: 3.774 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.122450351715088
Epoch: 26, Steps: 10 | Train Loss: 0.709 Vali Loss: 3.906 Vali Acc: 0.199 Test Loss: 3.906 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7915303707122803
Epoch: 27, Steps: 10 | Train Loss: 0.624 Vali Loss: 4.035 Vali Acc: 0.201 Test Loss: 4.035 Test Acc: 0.201
Validation loss decreased (-0.199964 --> -0.201136).  Saving model ...
Epoch: 28 cost time: 0.9281144142150879
Epoch: 28, Steps: 10 | Train Loss: 0.522 Vali Loss: 4.192 Vali Acc: 0.202 Test Loss: 4.192 Test Acc: 0.202
Validation loss decreased (-0.201136 --> -0.202311).  Saving model ...
Epoch: 29 cost time: 0.9216773509979248
Epoch: 29, Steps: 10 | Train Loss: 0.470 Vali Loss: 4.313 Vali Acc: 0.201 Test Loss: 4.313 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.083799123764038
Epoch: 30, Steps: 10 | Train Loss: 0.392 Vali Loss: 4.532 Vali Acc: 0.205 Test Loss: 4.532 Test Acc: 0.205
Validation loss decreased (-0.202311 --> -0.204661).  Saving model ...
Epoch: 31 cost time: 1.0276453495025635
Epoch: 31, Steps: 10 | Train Loss: 0.313 Vali Loss: 4.707 Vali Acc: 0.199 Test Loss: 4.707 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.066239595413208
Epoch: 32, Steps: 10 | Train Loss: 0.247 Vali Loss: 4.931 Vali Acc: 0.202 Test Loss: 4.931 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9261703491210938
Epoch: 33, Steps: 10 | Train Loss: 0.192 Vali Loss: 5.162 Vali Acc: 0.199 Test Loss: 5.162 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3279013633728027
Epoch: 34, Steps: 10 | Train Loss: 0.145 Vali Loss: 5.400 Vali Acc: 0.196 Test Loss: 5.400 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.27628493309021
Epoch: 35, Steps: 10 | Train Loss: 0.122 Vali Loss: 5.669 Vali Acc: 0.193 Test Loss: 5.669 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9568593502044678
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.956 Vali Acc: 0.193 Test Loss: 5.956 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0426604747772217
Epoch: 37, Steps: 10 | Train Loss: 0.073 Vali Loss: 6.192 Vali Acc: 0.184 Test Loss: 6.192 Test Acc: 0.184
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1166307926177979
Epoch: 38, Steps: 10 | Train Loss: 0.057 Vali Loss: 6.453 Vali Acc: 0.180 Test Loss: 6.453 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1900694370269775
Epoch: 39, Steps: 10 | Train Loss: 0.047 Vali Loss: 6.655 Vali Acc: 0.184 Test Loss: 6.655 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3848249912261963
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.867 Vali Acc: 0.181 Test Loss: 6.867 Test Acc: 0.181
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20470588235294118
model parameter : 67784
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7664122581481934
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.342 Vali Acc: 0.029 Test Loss: 3.342 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 1.0374202728271484
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.331 Vali Acc: 0.032 Test Loss: 3.331 Test Acc: 0.032
Validation loss decreased (-0.029378 --> -0.031731).  Saving model ...
Epoch: 3 cost time: 0.9743611812591553
Epoch: 3, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.317 Vali Acc: 0.033 Test Loss: 3.317 Test Acc: 0.033
Validation loss decreased (-0.031731 --> -0.032908).  Saving model ...
Epoch: 4 cost time: 0.9176006317138672
Epoch: 4, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.303 Vali Acc: 0.039 Test Loss: 3.303 Test Acc: 0.039
Validation loss decreased (-0.032908 --> -0.038791).  Saving model ...
Epoch: 5 cost time: 1.006850242614746
Epoch: 5, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.286 Vali Acc: 0.053 Test Loss: 3.286 Test Acc: 0.053
Validation loss decreased (-0.038791 --> -0.052908).  Saving model ...
Epoch: 6 cost time: 1.1377005577087402
Epoch: 6, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.271 Vali Acc: 0.061 Test Loss: 3.271 Test Acc: 0.061
Validation loss decreased (-0.052908 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 0.8527793884277344
Epoch: 7, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.257 Vali Acc: 0.069 Test Loss: 3.257 Test Acc: 0.069
Validation loss decreased (-0.061144 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 0.9886856079101562
Epoch: 8, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.246 Vali Acc: 0.087 Test Loss: 3.246 Test Acc: 0.087
Validation loss decreased (-0.069379 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 1.1273915767669678
Epoch: 9, Steps: 10 | Train Loss: 2.714 Vali Loss: 3.236 Vali Acc: 0.082 Test Loss: 3.236 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0807111263275146
Epoch: 10, Steps: 10 | Train Loss: 2.576 Vali Loss: 3.229 Vali Acc: 0.102 Test Loss: 3.229 Test Acc: 0.102
Validation loss decreased (-0.087026 --> -0.102321).  Saving model ...
Epoch: 11 cost time: 1.2298383712768555
Epoch: 11, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.229 Vali Acc: 0.106 Test Loss: 3.229 Test Acc: 0.106
Validation loss decreased (-0.102321 --> -0.105850).  Saving model ...
Epoch: 12 cost time: 0.7907741069793701
Epoch: 12, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.225 Vali Acc: 0.118 Test Loss: 3.225 Test Acc: 0.118
Validation loss decreased (-0.105850 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 1.0111050605773926
Epoch: 13, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.230 Vali Acc: 0.124 Test Loss: 3.230 Test Acc: 0.124
Validation loss decreased (-0.117615 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 1.0243871212005615
Epoch: 14, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.231 Vali Acc: 0.125 Test Loss: 3.231 Test Acc: 0.125
Validation loss decreased (-0.123497 --> -0.124674).  Saving model ...
Epoch: 15 cost time: 1.0081243515014648
Epoch: 15, Steps: 10 | Train Loss: 2.050 Vali Loss: 3.231 Vali Acc: 0.136 Test Loss: 3.231 Test Acc: 0.136
Validation loss decreased (-0.124674 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 1.1234886646270752
Epoch: 16, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.240 Vali Acc: 0.136 Test Loss: 3.240 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7970466613769531
Epoch: 17, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.251 Vali Acc: 0.147 Test Loss: 3.251 Test Acc: 0.147
Validation loss decreased (-0.136438 --> -0.147026).  Saving model ...
Epoch: 18 cost time: 0.945167064666748
Epoch: 18, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.275 Vali Acc: 0.149 Test Loss: 3.275 Test Acc: 0.149
Validation loss decreased (-0.147026 --> -0.149379).  Saving model ...
Epoch: 19 cost time: 0.9869959354400635
Epoch: 19, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.304 Vali Acc: 0.160 Test Loss: 3.304 Test Acc: 0.160
Validation loss decreased (-0.149379 --> -0.159967).  Saving model ...
Epoch: 20 cost time: 1.113943338394165
Epoch: 20, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.359 Vali Acc: 0.166 Test Loss: 3.359 Test Acc: 0.166
Validation loss decreased (-0.159967 --> -0.165849).  Saving model ...
Epoch: 21 cost time: 1.4624814987182617
Epoch: 21, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.414 Vali Acc: 0.165 Test Loss: 3.414 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.083761215209961
Epoch: 22, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.479 Vali Acc: 0.175 Test Loss: 3.479 Test Acc: 0.175
Validation loss decreased (-0.165849 --> -0.175259).  Saving model ...
Epoch: 23 cost time: 0.9358537197113037
Epoch: 23, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.567 Vali Acc: 0.172 Test Loss: 3.567 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9161334037780762
Epoch: 24, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.628 Vali Acc: 0.179 Test Loss: 3.628 Test Acc: 0.179
Validation loss decreased (-0.175259 --> -0.178787).  Saving model ...
Epoch: 25 cost time: 1.1485071182250977
Epoch: 25, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.734 Vali Acc: 0.174 Test Loss: 3.734 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9575247764587402
Epoch: 26, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.780 Vali Acc: 0.182 Test Loss: 3.780 Test Acc: 0.182
Validation loss decreased (-0.178787 --> -0.182315).  Saving model ...
Epoch: 27 cost time: 0.9065918922424316
Epoch: 27, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.897 Vali Acc: 0.186 Test Loss: 3.897 Test Acc: 0.186
Validation loss decreased (-0.182315 --> -0.185843).  Saving model ...
Epoch: 28 cost time: 1.1656208038330078
Epoch: 28, Steps: 10 | Train Loss: 0.576 Vali Loss: 4.022 Vali Acc: 0.185 Test Loss: 4.022 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0085139274597168
Epoch: 29, Steps: 10 | Train Loss: 0.504 Vali Loss: 4.117 Vali Acc: 0.191 Test Loss: 4.117 Test Acc: 0.191
Validation loss decreased (-0.185843 --> -0.190547).  Saving model ...
Epoch: 30 cost time: 0.9657726287841797
Epoch: 30, Steps: 10 | Train Loss: 0.435 Vali Loss: 4.268 Vali Acc: 0.191 Test Loss: 4.268 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7988812923431396
Epoch: 31, Steps: 10 | Train Loss: 0.361 Vali Loss: 4.420 Vali Acc: 0.187 Test Loss: 4.420 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8830139636993408
Epoch: 32, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.564 Vali Acc: 0.195 Test Loss: 4.564 Test Acc: 0.195
Validation loss decreased (-0.190547 --> -0.195248).  Saving model ...
Epoch: 33 cost time: 1.395826816558838
Epoch: 33, Steps: 10 | Train Loss: 0.251 Vali Loss: 4.812 Vali Acc: 0.175 Test Loss: 4.812 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0824000835418701
Epoch: 34, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.865 Vali Acc: 0.194 Test Loss: 4.865 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3334300518035889
Epoch: 35, Steps: 10 | Train Loss: 0.174 Vali Loss: 5.151 Vali Acc: 0.178 Test Loss: 5.151 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8905785083770752
Epoch: 36, Steps: 10 | Train Loss: 0.136 Vali Loss: 5.215 Vali Acc: 0.186 Test Loss: 5.215 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1041758060455322
Epoch: 37, Steps: 10 | Train Loss: 0.113 Vali Loss: 5.445 Vali Acc: 0.182 Test Loss: 5.445 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0139787197113037
Epoch: 38, Steps: 10 | Train Loss: 0.086 Vali Loss: 5.596 Vali Acc: 0.189 Test Loss: 5.596 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9913487434387207
Epoch: 39, Steps: 10 | Train Loss: 0.070 Vali Loss: 5.812 Vali Acc: 0.184 Test Loss: 5.812 Test Acc: 0.184
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0460395812988281
Epoch: 40, Steps: 10 | Train Loss: 0.053 Vali Loss: 6.026 Vali Acc: 0.182 Test Loss: 6.026 Test Acc: 0.182
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1454901695251465
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 6.143 Vali Acc: 0.186 Test Loss: 6.143 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9859850406646729
Epoch: 42, Steps: 10 | Train Loss: 0.035 Vali Loss: 6.334 Vali Acc: 0.188 Test Loss: 6.334 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1952941176470588
model parameter : 67718
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1166231632232666
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.291 Vali Acc: 0.038 Test Loss: 3.291 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.9781208038330078
Epoch: 2, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.280 Vali Acc: 0.034 Test Loss: 3.280 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0771422386169434
Epoch: 3, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.267 Vali Acc: 0.038 Test Loss: 3.267 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.9558920860290527
Epoch: 4, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.253 Vali Acc: 0.040 Test Loss: 3.253 Test Acc: 0.040
Validation loss decreased (-0.037614 --> -0.039967).  Saving model ...
Epoch: 5 cost time: 0.8528890609741211
Epoch: 5, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.239 Vali Acc: 0.051 Test Loss: 3.239 Test Acc: 0.051
Validation loss decreased (-0.039967 --> -0.050556).  Saving model ...
Epoch: 6 cost time: 0.995410680770874
Epoch: 6, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.227 Vali Acc: 0.064 Test Loss: 3.227 Test Acc: 0.064
Validation loss decreased (-0.050556 --> -0.063497).  Saving model ...
Epoch: 7 cost time: 1.147146463394165
Epoch: 7, Steps: 10 | Train Loss: 2.940 Vali Loss: 3.216 Vali Acc: 0.087 Test Loss: 3.216 Test Acc: 0.087
Validation loss decreased (-0.063497 --> -0.087027).  Saving model ...
Epoch: 8 cost time: 1.2504408359527588
Epoch: 8, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.208 Vali Acc: 0.096 Test Loss: 3.208 Test Acc: 0.096
Validation loss decreased (-0.087027 --> -0.096439).  Saving model ...
Epoch: 9 cost time: 0.925757884979248
Epoch: 9, Steps: 10 | Train Loss: 2.713 Vali Loss: 3.203 Vali Acc: 0.109 Test Loss: 3.203 Test Acc: 0.109
Validation loss decreased (-0.096439 --> -0.109380).  Saving model ...
Epoch: 10 cost time: 0.7492883205413818
Epoch: 10, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.203 Vali Acc: 0.112 Test Loss: 3.203 Test Acc: 0.112
Validation loss decreased (-0.109380 --> -0.111733).  Saving model ...
Epoch: 11 cost time: 1.0552563667297363
Epoch: 11, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.204 Vali Acc: 0.116 Test Loss: 3.204 Test Acc: 0.116
Validation loss decreased (-0.111733 --> -0.116439).  Saving model ...
Epoch: 12 cost time: 1.1324000358581543
Epoch: 12, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.206 Vali Acc: 0.127 Test Loss: 3.206 Test Acc: 0.127
Validation loss decreased (-0.116439 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 1.111637830734253
Epoch: 13, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.211 Vali Acc: 0.133 Test Loss: 3.211 Test Acc: 0.133
Validation loss decreased (-0.127027 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 1.1416401863098145
Epoch: 14, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.214 Vali Acc: 0.135 Test Loss: 3.214 Test Acc: 0.135
Validation loss decreased (-0.132909 --> -0.135262).  Saving model ...
Epoch: 15 cost time: 0.7949357032775879
Epoch: 15, Steps: 10 | Train Loss: 2.061 Vali Loss: 3.226 Vali Acc: 0.144 Test Loss: 3.226 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 1.2131447792053223
Epoch: 16, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.244 Vali Acc: 0.148 Test Loss: 3.244 Test Acc: 0.148
Validation loss decreased (-0.143497 --> -0.148203).  Saving model ...
Epoch: 17 cost time: 1.0282535552978516
Epoch: 17, Steps: 10 | Train Loss: 1.834 Vali Loss: 3.258 Vali Acc: 0.151 Test Loss: 3.258 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 1.39378023147583
Epoch: 18, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.282 Vali Acc: 0.159 Test Loss: 3.282 Test Acc: 0.159
Validation loss decreased (-0.150556 --> -0.158791).  Saving model ...
Epoch: 19 cost time: 1.0137665271759033
Epoch: 19, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.310 Vali Acc: 0.161 Test Loss: 3.310 Test Acc: 0.161
Validation loss decreased (-0.158791 --> -0.161143).  Saving model ...
Epoch: 20 cost time: 0.8817338943481445
Epoch: 20, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.348 Vali Acc: 0.174 Test Loss: 3.348 Test Acc: 0.174
Validation loss decreased (-0.161143 --> -0.174084).  Saving model ...
Epoch: 21 cost time: 1.1767072677612305
Epoch: 21, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.404 Vali Acc: 0.176 Test Loss: 3.404 Test Acc: 0.176
Validation loss decreased (-0.174084 --> -0.176437).  Saving model ...
Epoch: 22 cost time: 0.8904151916503906
Epoch: 22, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.478 Vali Acc: 0.172 Test Loss: 3.478 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9640305042266846
Epoch: 23, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.544 Vali Acc: 0.173 Test Loss: 3.544 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0951454639434814
Epoch: 24, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.631 Vali Acc: 0.175 Test Loss: 3.631 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8439698219299316
Epoch: 25, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.709 Vali Acc: 0.176 Test Loss: 3.709 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2715158462524414
Epoch: 26, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.818 Vali Acc: 0.189 Test Loss: 3.818 Test Acc: 0.189
Validation loss decreased (-0.176437 --> -0.189374).  Saving model ...
Epoch: 27 cost time: 0.9821662902832031
Epoch: 27, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.931 Vali Acc: 0.180 Test Loss: 3.931 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8811883926391602
Epoch: 28, Steps: 10 | Train Loss: 0.629 Vali Loss: 4.090 Vali Acc: 0.184 Test Loss: 4.090 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9536316394805908
Epoch: 29, Steps: 10 | Train Loss: 0.536 Vali Loss: 4.225 Vali Acc: 0.185 Test Loss: 4.225 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8876049518585205
Epoch: 30, Steps: 10 | Train Loss: 0.460 Vali Loss: 4.375 Vali Acc: 0.191 Test Loss: 4.375 Test Acc: 0.191
Validation loss decreased (-0.189374 --> -0.190544).  Saving model ...
Epoch: 31 cost time: 0.7153744697570801
Epoch: 31, Steps: 10 | Train Loss: 0.394 Vali Loss: 4.533 Vali Acc: 0.193 Test Loss: 4.533 Test Acc: 0.193
Validation loss decreased (-0.190544 --> -0.192896).  Saving model ...
Epoch: 32 cost time: 1.6665563583374023
Epoch: 32, Steps: 10 | Train Loss: 0.320 Vali Loss: 4.727 Vali Acc: 0.195 Test Loss: 4.727 Test Acc: 0.195
Validation loss decreased (-0.192896 --> -0.195247).  Saving model ...
Epoch: 33 cost time: 0.9186956882476807
Epoch: 33, Steps: 10 | Train Loss: 0.252 Vali Loss: 4.915 Vali Acc: 0.192 Test Loss: 4.915 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1544253826141357
Epoch: 34, Steps: 10 | Train Loss: 0.219 Vali Loss: 5.134 Vali Acc: 0.191 Test Loss: 5.134 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8787400722503662
Epoch: 35, Steps: 10 | Train Loss: 0.163 Vali Loss: 5.385 Vali Acc: 0.189 Test Loss: 5.385 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2024860382080078
Epoch: 36, Steps: 10 | Train Loss: 0.127 Vali Loss: 5.581 Vali Acc: 0.195 Test Loss: 5.581 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2873570919036865
Epoch: 37, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.773 Vali Acc: 0.196 Test Loss: 5.773 Test Acc: 0.196
Validation loss decreased (-0.195247 --> -0.196413).  Saving model ...
Epoch: 38 cost time: 0.9091675281524658
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 6.100 Vali Acc: 0.193 Test Loss: 6.100 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2159442901611328
Epoch: 39, Steps: 10 | Train Loss: 0.063 Vali Loss: 6.332 Vali Acc: 0.189 Test Loss: 6.332 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5563201904296875
Epoch: 40, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.581 Vali Acc: 0.195 Test Loss: 6.581 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0318551063537598
Epoch: 41, Steps: 10 | Train Loss: 0.043 Vali Loss: 6.763 Vali Acc: 0.186 Test Loss: 6.763 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.199530839920044
Epoch: 42, Steps: 10 | Train Loss: 0.033 Vali Loss: 6.949 Vali Acc: 0.188 Test Loss: 6.949 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8777627944946289
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.137 Vali Acc: 0.188 Test Loss: 7.137 Test Acc: 0.188
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8646109104156494
Epoch: 44, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.378 Vali Acc: 0.193 Test Loss: 7.378 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0805864334106445
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 7.516 Vali Acc: 0.194 Test Loss: 7.516 Test Acc: 0.194
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8181166648864746
Epoch: 46, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.694 Vali Acc: 0.191 Test Loss: 7.694 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9049675464630127
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 7.852 Vali Acc: 0.192 Test Loss: 7.852 Test Acc: 0.192
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19647058823529412
model parameter : 68696
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1991984844207764
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.285 Vali Acc: 0.033 Test Loss: 3.285 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.0216522216796875
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.276 Vali Acc: 0.036 Test Loss: 3.276 Test Acc: 0.036
Validation loss decreased (-0.032908 --> -0.036438).  Saving model ...
Epoch: 3 cost time: 1.0872645378112793
Epoch: 3, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.263 Vali Acc: 0.041 Test Loss: 3.263 Test Acc: 0.041
Validation loss decreased (-0.036438 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.9293622970581055
Epoch: 4, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.250 Vali Acc: 0.054 Test Loss: 3.250 Test Acc: 0.054
Validation loss decreased (-0.041144 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.8566617965698242
Epoch: 5, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.236 Vali Acc: 0.069 Test Loss: 3.236 Test Acc: 0.069
Validation loss decreased (-0.054085 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.914741039276123
Epoch: 6, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.224 Vali Acc: 0.076 Test Loss: 3.224 Test Acc: 0.076
Validation loss decreased (-0.069379 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.1843502521514893
Epoch: 7, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.212 Vali Acc: 0.102 Test Loss: 3.212 Test Acc: 0.102
Validation loss decreased (-0.076438 --> -0.102321).  Saving model ...
Epoch: 8 cost time: 0.9867885112762451
Epoch: 8, Steps: 10 | Train Loss: 2.796 Vali Loss: 3.203 Vali Acc: 0.111 Test Loss: 3.203 Test Acc: 0.111
Validation loss decreased (-0.102321 --> -0.110556).  Saving model ...
Epoch: 9 cost time: 1.0254762172698975
Epoch: 9, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.196 Vali Acc: 0.112 Test Loss: 3.196 Test Acc: 0.112
Validation loss decreased (-0.110556 --> -0.111733).  Saving model ...
Epoch: 10 cost time: 1.0246548652648926
Epoch: 10, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.194 Vali Acc: 0.122 Test Loss: 3.194 Test Acc: 0.122
Validation loss decreased (-0.111733 --> -0.122321).  Saving model ...
Epoch: 11 cost time: 1.2270982265472412
Epoch: 11, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.197 Vali Acc: 0.135 Test Loss: 3.197 Test Acc: 0.135
Validation loss decreased (-0.122321 --> -0.135262).  Saving model ...
Epoch: 12 cost time: 0.9753677845001221
Epoch: 12, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.201 Vali Acc: 0.135 Test Loss: 3.201 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9726505279541016
Epoch: 13, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.210 Vali Acc: 0.144 Test Loss: 3.210 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 14 cost time: 0.9167544841766357
Epoch: 14, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.220 Vali Acc: 0.158 Test Loss: 3.220 Test Acc: 0.158
Validation loss decreased (-0.143497 --> -0.157615).  Saving model ...
Epoch: 15 cost time: 0.6919593811035156
Epoch: 15, Steps: 10 | Train Loss: 1.974 Vali Loss: 3.233 Vali Acc: 0.160 Test Loss: 3.233 Test Acc: 0.160
Validation loss decreased (-0.157615 --> -0.159968).  Saving model ...
Epoch: 16 cost time: 1.001753330230713
Epoch: 16, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.261 Vali Acc: 0.162 Test Loss: 3.261 Test Acc: 0.162
Validation loss decreased (-0.159968 --> -0.162320).  Saving model ...
Epoch: 17 cost time: 0.8759806156158447
Epoch: 17, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.309 Vali Acc: 0.172 Test Loss: 3.309 Test Acc: 0.172
Validation loss decreased (-0.162320 --> -0.171732).  Saving model ...
Epoch: 18 cost time: 0.7870268821716309
Epoch: 18, Steps: 10 | Train Loss: 1.590 Vali Loss: 3.352 Vali Acc: 0.175 Test Loss: 3.352 Test Acc: 0.175
Validation loss decreased (-0.171732 --> -0.175261).  Saving model ...
Epoch: 19 cost time: 0.8414857387542725
Epoch: 19, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.426 Vali Acc: 0.178 Test Loss: 3.426 Test Acc: 0.178
Validation loss decreased (-0.175261 --> -0.177613).  Saving model ...
Epoch: 20 cost time: 1.105468988418579
Epoch: 20, Steps: 10 | Train Loss: 1.354 Vali Loss: 3.489 Vali Acc: 0.172 Test Loss: 3.489 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9362664222717285
Epoch: 21, Steps: 10 | Train Loss: 1.232 Vali Loss: 3.575 Vali Acc: 0.174 Test Loss: 3.575 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.866722583770752
Epoch: 22, Steps: 10 | Train Loss: 1.084 Vali Loss: 3.667 Vali Acc: 0.173 Test Loss: 3.667 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8830916881561279
Epoch: 23, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.763 Vali Acc: 0.175 Test Loss: 3.763 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9579603672027588
Epoch: 24, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.917 Vali Acc: 0.175 Test Loss: 3.917 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.174436092376709
Epoch: 25, Steps: 10 | Train Loss: 0.778 Vali Loss: 4.060 Vali Acc: 0.180 Test Loss: 4.060 Test Acc: 0.180
Validation loss decreased (-0.177613 --> -0.179959).  Saving model ...
Epoch: 26 cost time: 0.8506238460540771
Epoch: 26, Steps: 10 | Train Loss: 0.677 Vali Loss: 4.259 Vali Acc: 0.173 Test Loss: 4.259 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9762265682220459
Epoch: 27, Steps: 10 | Train Loss: 0.637 Vali Loss: 4.408 Vali Acc: 0.161 Test Loss: 4.408 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8999049663543701
Epoch: 28, Steps: 10 | Train Loss: 0.515 Vali Loss: 4.607 Vali Acc: 0.169 Test Loss: 4.607 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0580179691314697
Epoch: 29, Steps: 10 | Train Loss: 0.439 Vali Loss: 4.793 Vali Acc: 0.153 Test Loss: 4.793 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7571918964385986
Epoch: 30, Steps: 10 | Train Loss: 0.389 Vali Loss: 4.966 Vali Acc: 0.162 Test Loss: 4.966 Test Acc: 0.162
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8646154403686523
Epoch: 31, Steps: 10 | Train Loss: 0.325 Vali Loss: 5.210 Vali Acc: 0.178 Test Loss: 5.210 Test Acc: 0.178
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8225383758544922
Epoch: 32, Steps: 10 | Train Loss: 0.292 Vali Loss: 5.427 Vali Acc: 0.160 Test Loss: 5.427 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8432526588439941
Epoch: 33, Steps: 10 | Train Loss: 0.232 Vali Loss: 5.660 Vali Acc: 0.160 Test Loss: 5.660 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9195497035980225
Epoch: 34, Steps: 10 | Train Loss: 0.174 Vali Loss: 5.932 Vali Acc: 0.158 Test Loss: 5.932 Test Acc: 0.158
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9532492160797119
Epoch: 35, Steps: 10 | Train Loss: 0.147 Vali Loss: 6.263 Vali Acc: 0.160 Test Loss: 6.263 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18
model parameter : 67574
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.679136276245117
Epoch: 1, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.319 Vali Acc: 0.036 Test Loss: 3.319 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.1025404930114746
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.308 Vali Acc: 0.041 Test Loss: 3.308 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 1.070143699645996
Epoch: 3, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.295 Vali Acc: 0.048 Test Loss: 3.295 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.9701287746429443
Epoch: 4, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.282 Vali Acc: 0.053 Test Loss: 3.282 Test Acc: 0.053
Validation loss decreased (-0.048202 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.9129810333251953
Epoch: 5, Steps: 10 | Train Loss: 3.014 Vali Loss: 3.269 Vali Acc: 0.061 Test Loss: 3.269 Test Acc: 0.061
Validation loss decreased (-0.052908 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.8928582668304443
Epoch: 6, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.258 Vali Acc: 0.073 Test Loss: 3.258 Test Acc: 0.073
Validation loss decreased (-0.061144 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 0.769848108291626
Epoch: 7, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.249 Vali Acc: 0.081 Test Loss: 3.249 Test Acc: 0.081
Validation loss decreased (-0.072909 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 1.2077906131744385
Epoch: 8, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.245 Vali Acc: 0.095 Test Loss: 3.245 Test Acc: 0.095
Validation loss decreased (-0.081144 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 1.1201376914978027
Epoch: 9, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.237 Vali Acc: 0.108 Test Loss: 3.237 Test Acc: 0.108
Validation loss decreased (-0.095262 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 0.720750093460083
Epoch: 10, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.234 Vali Acc: 0.111 Test Loss: 3.234 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 0.9802236557006836
Epoch: 11, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.233 Vali Acc: 0.118 Test Loss: 3.233 Test Acc: 0.118
Validation loss decreased (-0.110556 --> -0.117615).  Saving model ...
Epoch: 12 cost time: 0.9806673526763916
Epoch: 12, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.233 Vali Acc: 0.126 Test Loss: 3.233 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 1.00244140625
Epoch: 13, Steps: 10 | Train Loss: 2.236 Vali Loss: 3.233 Vali Acc: 0.132 Test Loss: 3.233 Test Acc: 0.132
Validation loss decreased (-0.125850 --> -0.131732).  Saving model ...
Epoch: 14 cost time: 0.8730072975158691
Epoch: 14, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.231 Vali Acc: 0.135 Test Loss: 3.231 Test Acc: 0.135
Validation loss decreased (-0.131732 --> -0.135262).  Saving model ...
Epoch: 15 cost time: 0.9921402931213379
Epoch: 15, Steps: 10 | Train Loss: 2.017 Vali Loss: 3.229 Vali Acc: 0.148 Test Loss: 3.229 Test Acc: 0.148
Validation loss decreased (-0.135262 --> -0.148203).  Saving model ...
Epoch: 16 cost time: 0.8647644519805908
Epoch: 16, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.233 Vali Acc: 0.160 Test Loss: 3.233 Test Acc: 0.160
Validation loss decreased (-0.148203 --> -0.159968).  Saving model ...
Epoch: 17 cost time: 1.0457122325897217
Epoch: 17, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.246 Vali Acc: 0.162 Test Loss: 3.246 Test Acc: 0.162
Validation loss decreased (-0.159968 --> -0.162320).  Saving model ...
Epoch: 18 cost time: 0.8845007419586182
Epoch: 18, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.247 Vali Acc: 0.167 Test Loss: 3.247 Test Acc: 0.167
Validation loss decreased (-0.162320 --> -0.167026).  Saving model ...
Epoch: 19 cost time: 1.0758333206176758
Epoch: 19, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.270 Vali Acc: 0.179 Test Loss: 3.270 Test Acc: 0.179
Validation loss decreased (-0.167026 --> -0.178791).  Saving model ...
Epoch: 20 cost time: 0.9715871810913086
Epoch: 20, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.316 Vali Acc: 0.184 Test Loss: 3.316 Test Acc: 0.184
Validation loss decreased (-0.178791 --> -0.183496).  Saving model ...
Epoch: 21 cost time: 0.8630037307739258
Epoch: 21, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.370 Vali Acc: 0.194 Test Loss: 3.370 Test Acc: 0.194
Validation loss decreased (-0.183496 --> -0.194084).  Saving model ...
Epoch: 22 cost time: 1.0606286525726318
Epoch: 22, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.455 Vali Acc: 0.199 Test Loss: 3.455 Test Acc: 0.199
Validation loss decreased (-0.194084 --> -0.198789).  Saving model ...
Epoch: 23 cost time: 0.811530590057373
Epoch: 23, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.565 Vali Acc: 0.205 Test Loss: 3.565 Test Acc: 0.205
Validation loss decreased (-0.198789 --> -0.204670).  Saving model ...
Epoch: 24 cost time: 0.8842329978942871
Epoch: 24, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.692 Vali Acc: 0.196 Test Loss: 3.692 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.922980785369873
Epoch: 25, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.811 Vali Acc: 0.205 Test Loss: 3.811 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0060944557189941
Epoch: 26, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.927 Vali Acc: 0.201 Test Loss: 3.927 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9095301628112793
Epoch: 27, Steps: 10 | Train Loss: 0.521 Vali Loss: 4.045 Vali Acc: 0.204 Test Loss: 4.045 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.062621831893921
Epoch: 28, Steps: 10 | Train Loss: 0.446 Vali Loss: 4.224 Vali Acc: 0.201 Test Loss: 4.224 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9959969520568848
Epoch: 29, Steps: 10 | Train Loss: 0.385 Vali Loss: 4.355 Vali Acc: 0.206 Test Loss: 4.355 Test Acc: 0.206
Validation loss decreased (-0.204670 --> -0.205839).  Saving model ...
Epoch: 30 cost time: 0.9008896350860596
Epoch: 30, Steps: 10 | Train Loss: 0.311 Vali Loss: 4.546 Vali Acc: 0.201 Test Loss: 4.546 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8124592304229736
Epoch: 31, Steps: 10 | Train Loss: 0.276 Vali Loss: 4.708 Vali Acc: 0.202 Test Loss: 4.708 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.96124267578125
Epoch: 32, Steps: 10 | Train Loss: 0.212 Vali Loss: 4.905 Vali Acc: 0.194 Test Loss: 4.905 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1843407154083252
Epoch: 33, Steps: 10 | Train Loss: 0.179 Vali Loss: 5.143 Vali Acc: 0.191 Test Loss: 5.143 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9774074554443359
Epoch: 34, Steps: 10 | Train Loss: 0.145 Vali Loss: 5.364 Vali Acc: 0.199 Test Loss: 5.364 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9820454120635986
Epoch: 35, Steps: 10 | Train Loss: 0.125 Vali Loss: 5.612 Vali Acc: 0.202 Test Loss: 5.612 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.027916669845581
Epoch: 36, Steps: 10 | Train Loss: 0.102 Vali Loss: 5.834 Vali Acc: 0.191 Test Loss: 5.834 Test Acc: 0.191
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.052731990814209
Epoch: 37, Steps: 10 | Train Loss: 0.082 Vali Loss: 6.018 Vali Acc: 0.191 Test Loss: 6.018 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.068540334701538
Epoch: 38, Steps: 10 | Train Loss: 0.069 Vali Loss: 6.251 Vali Acc: 0.195 Test Loss: 6.251 Test Acc: 0.195
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.712430477142334
Epoch: 39, Steps: 10 | Train Loss: 0.055 Vali Loss: 6.426 Vali Acc: 0.198 Test Loss: 6.426 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20588235294117646
model parameter : 67800
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.493845224380493
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.325 Vali Acc: 0.042 Test Loss: 3.325 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.085606575012207
Epoch: 2, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.314 Vali Acc: 0.041 Test Loss: 3.314 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.069715976715088
Epoch: 3, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.301 Vali Acc: 0.044 Test Loss: 3.301 Test Acc: 0.044
Validation loss decreased (-0.042320 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 0.8817670345306396
Epoch: 4, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.284 Vali Acc: 0.049 Test Loss: 3.284 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.8414254188537598
Epoch: 5, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.270 Vali Acc: 0.061 Test Loss: 3.270 Test Acc: 0.061
Validation loss decreased (-0.049379 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.8720026016235352
Epoch: 6, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.255 Vali Acc: 0.064 Test Loss: 3.255 Test Acc: 0.064
Validation loss decreased (-0.061144 --> -0.063497).  Saving model ...
Epoch: 7 cost time: 0.7746646404266357
Epoch: 7, Steps: 10 | Train Loss: 2.857 Vali Loss: 3.245 Vali Acc: 0.072 Test Loss: 3.245 Test Acc: 0.072
Validation loss decreased (-0.063497 --> -0.071732).  Saving model ...
Epoch: 8 cost time: 0.9316205978393555
Epoch: 8, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.235 Vali Acc: 0.095 Test Loss: 3.235 Test Acc: 0.095
Validation loss decreased (-0.071732 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 0.8005924224853516
Epoch: 9, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.229 Vali Acc: 0.101 Test Loss: 3.229 Test Acc: 0.101
Validation loss decreased (-0.095262 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.8496236801147461
Epoch: 10, Steps: 10 | Train Loss: 2.531 Vali Loss: 3.231 Vali Acc: 0.102 Test Loss: 3.231 Test Acc: 0.102
Validation loss decreased (-0.101144 --> -0.102321).  Saving model ...
Epoch: 11 cost time: 1.2017548084259033
Epoch: 11, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.227 Vali Acc: 0.111 Test Loss: 3.227 Test Acc: 0.111
Validation loss decreased (-0.102321 --> -0.110556).  Saving model ...
Epoch: 12 cost time: 1.0985908508300781
Epoch: 12, Steps: 10 | Train Loss: 2.285 Vali Loss: 3.235 Vali Acc: 0.126 Test Loss: 3.235 Test Acc: 0.126
Validation loss decreased (-0.110556 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.9383118152618408
Epoch: 13, Steps: 10 | Train Loss: 2.171 Vali Loss: 3.251 Vali Acc: 0.132 Test Loss: 3.251 Test Acc: 0.132
Validation loss decreased (-0.125850 --> -0.131732).  Saving model ...
Epoch: 14 cost time: 1.0205509662628174
Epoch: 14, Steps: 10 | Train Loss: 2.039 Vali Loss: 3.274 Vali Acc: 0.146 Test Loss: 3.274 Test Acc: 0.146
Validation loss decreased (-0.131732 --> -0.145850).  Saving model ...
Epoch: 15 cost time: 0.7106943130493164
Epoch: 15, Steps: 10 | Train Loss: 1.884 Vali Loss: 3.325 Vali Acc: 0.151 Test Loss: 3.325 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150555).  Saving model ...
Epoch: 16 cost time: 0.9923868179321289
Epoch: 16, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.365 Vali Acc: 0.160 Test Loss: 3.365 Test Acc: 0.160
Validation loss decreased (-0.150555 --> -0.159966).  Saving model ...
Epoch: 17 cost time: 0.9177243709564209
Epoch: 17, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.425 Vali Acc: 0.166 Test Loss: 3.425 Test Acc: 0.166
Validation loss decreased (-0.159966 --> -0.165848).  Saving model ...
Epoch: 18 cost time: 0.9105970859527588
Epoch: 18, Steps: 10 | Train Loss: 1.531 Vali Loss: 3.495 Vali Acc: 0.167 Test Loss: 3.495 Test Acc: 0.167
Validation loss decreased (-0.165848 --> -0.167024).  Saving model ...
Epoch: 19 cost time: 1.0689187049865723
Epoch: 19, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.570 Vali Acc: 0.173 Test Loss: 3.570 Test Acc: 0.173
Validation loss decreased (-0.167024 --> -0.172905).  Saving model ...
Epoch: 20 cost time: 0.8682897090911865
Epoch: 20, Steps: 10 | Train Loss: 1.330 Vali Loss: 3.611 Vali Acc: 0.182 Test Loss: 3.611 Test Acc: 0.182
Validation loss decreased (-0.172905 --> -0.182317).  Saving model ...
Epoch: 21 cost time: 0.8777649402618408
Epoch: 21, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.678 Vali Acc: 0.186 Test Loss: 3.678 Test Acc: 0.186
Validation loss decreased (-0.182317 --> -0.185846).  Saving model ...
Epoch: 22 cost time: 0.9841952323913574
Epoch: 22, Steps: 10 | Train Loss: 1.149 Vali Loss: 3.734 Vali Acc: 0.185 Test Loss: 3.734 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7931840419769287
Epoch: 23, Steps: 10 | Train Loss: 1.061 Vali Loss: 3.807 Vali Acc: 0.189 Test Loss: 3.807 Test Acc: 0.189
Validation loss decreased (-0.185846 --> -0.189374).  Saving model ...
Epoch: 24 cost time: 0.9897191524505615
Epoch: 24, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.903 Vali Acc: 0.188 Test Loss: 3.903 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8214716911315918
Epoch: 25, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.986 Vali Acc: 0.187 Test Loss: 3.986 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8045899868011475
Epoch: 26, Steps: 10 | Train Loss: 0.830 Vali Loss: 4.109 Vali Acc: 0.196 Test Loss: 4.109 Test Acc: 0.196
Validation loss decreased (-0.189374 --> -0.196429).  Saving model ...
Epoch: 27 cost time: 0.8666119575500488
Epoch: 27, Steps: 10 | Train Loss: 0.708 Vali Loss: 4.239 Vali Acc: 0.191 Test Loss: 4.239 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8437108993530273
Epoch: 28, Steps: 10 | Train Loss: 0.636 Vali Loss: 4.411 Vali Acc: 0.189 Test Loss: 4.411 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1196560859680176
Epoch: 29, Steps: 10 | Train Loss: 0.561 Vali Loss: 4.580 Vali Acc: 0.198 Test Loss: 4.580 Test Acc: 0.198
Validation loss decreased (-0.196429 --> -0.197601).  Saving model ...
Epoch: 30 cost time: 0.8450770378112793
Epoch: 30, Steps: 10 | Train Loss: 0.485 Vali Loss: 4.713 Vali Acc: 0.195 Test Loss: 4.713 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8714931011199951
Epoch: 31, Steps: 10 | Train Loss: 0.430 Vali Loss: 4.884 Vali Acc: 0.198 Test Loss: 4.884 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.060995101928711
Epoch: 32, Steps: 10 | Train Loss: 0.354 Vali Loss: 5.055 Vali Acc: 0.195 Test Loss: 5.055 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.057142972946167
Epoch: 33, Steps: 10 | Train Loss: 0.323 Vali Loss: 5.287 Vali Acc: 0.199 Test Loss: 5.287 Test Acc: 0.199
Validation loss decreased (-0.197601 --> -0.198771).  Saving model ...
Epoch: 34 cost time: 0.885967493057251
Epoch: 34, Steps: 10 | Train Loss: 0.280 Vali Loss: 5.515 Vali Acc: 0.194 Test Loss: 5.515 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0086441040039062
Epoch: 35, Steps: 10 | Train Loss: 0.218 Vali Loss: 5.735 Vali Acc: 0.198 Test Loss: 5.735 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7870781421661377
Epoch: 36, Steps: 10 | Train Loss: 0.186 Vali Loss: 6.017 Vali Acc: 0.202 Test Loss: 6.017 Test Acc: 0.202
Validation loss decreased (-0.198771 --> -0.202293).  Saving model ...
Epoch: 37 cost time: 0.7572197914123535
Epoch: 37, Steps: 10 | Train Loss: 0.158 Vali Loss: 6.190 Vali Acc: 0.208 Test Loss: 6.190 Test Acc: 0.208
Validation loss decreased (-0.202293 --> -0.208173).  Saving model ...
Epoch: 38 cost time: 0.9874989986419678
Epoch: 38, Steps: 10 | Train Loss: 0.110 Vali Loss: 6.464 Vali Acc: 0.196 Test Loss: 6.464 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8390524387359619
Epoch: 39, Steps: 10 | Train Loss: 0.086 Vali Loss: 6.790 Vali Acc: 0.199 Test Loss: 6.790 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.655998945236206
Epoch: 40, Steps: 10 | Train Loss: 0.069 Vali Loss: 7.105 Vali Acc: 0.196 Test Loss: 7.105 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8089585304260254
Epoch: 41, Steps: 10 | Train Loss: 0.066 Vali Loss: 7.368 Vali Acc: 0.206 Test Loss: 7.368 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7735469341278076
Epoch: 42, Steps: 10 | Train Loss: 0.059 Vali Loss: 7.604 Vali Acc: 0.195 Test Loss: 7.604 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1654751300811768
Epoch: 43, Steps: 10 | Train Loss: 0.053 Vali Loss: 7.743 Vali Acc: 0.199 Test Loss: 7.743 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1563029289245605
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 8.011 Vali Acc: 0.200 Test Loss: 8.011 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9215099811553955
Epoch: 45, Steps: 10 | Train Loss: 0.025 Vali Loss: 8.265 Vali Acc: 0.198 Test Loss: 8.265 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9555752277374268
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 8.474 Vali Acc: 0.202 Test Loss: 8.474 Test Acc: 0.202
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0284838676452637
Epoch: 47, Steps: 10 | Train Loss: 0.017 Vali Loss: 8.736 Vali Acc: 0.196 Test Loss: 8.736 Test Acc: 0.196
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20823529411764705
model parameter : 67726
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.724468231201172
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.333 Vali Acc: 0.025 Test Loss: 3.333 Test Acc: 0.025
Validation loss decreased (inf --> -0.024673).  Saving model ...
Epoch: 2 cost time: 1.1815755367279053
Epoch: 2, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.321 Vali Acc: 0.027 Test Loss: 3.321 Test Acc: 0.027
Validation loss decreased (-0.024673 --> -0.027026).  Saving model ...
Epoch: 3 cost time: 0.9063961505889893
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.305 Vali Acc: 0.029 Test Loss: 3.305 Test Acc: 0.029
Validation loss decreased (-0.027026 --> -0.029379).  Saving model ...
Epoch: 4 cost time: 0.9065032005310059
Epoch: 4, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.286 Vali Acc: 0.039 Test Loss: 3.286 Test Acc: 0.039
Validation loss decreased (-0.029379 --> -0.038791).  Saving model ...
Epoch: 5 cost time: 0.9272243976593018
Epoch: 5, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.270 Vali Acc: 0.058 Test Loss: 3.270 Test Acc: 0.058
Validation loss decreased (-0.038791 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 0.7473165988922119
Epoch: 6, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.254 Vali Acc: 0.072 Test Loss: 3.254 Test Acc: 0.072
Validation loss decreased (-0.057614 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 1.133193016052246
Epoch: 7, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.240 Vali Acc: 0.082 Test Loss: 3.240 Test Acc: 0.082
Validation loss decreased (-0.071732 --> -0.082321).  Saving model ...
Epoch: 8 cost time: 0.6777372360229492
Epoch: 8, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.227 Vali Acc: 0.093 Test Loss: 3.227 Test Acc: 0.093
Validation loss decreased (-0.082321 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.6682302951812744
Epoch: 9, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.217 Vali Acc: 0.095 Test Loss: 3.217 Test Acc: 0.095
Validation loss decreased (-0.092909 --> -0.095262).  Saving model ...
Epoch: 10 cost time: 0.7127022743225098
Epoch: 10, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.212 Vali Acc: 0.100 Test Loss: 3.212 Test Acc: 0.100
Validation loss decreased (-0.095262 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 0.7920105457305908
Epoch: 11, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.207 Vali Acc: 0.111 Test Loss: 3.207 Test Acc: 0.111
Validation loss decreased (-0.099968 --> -0.110556).  Saving model ...
Epoch: 12 cost time: 1.4138643741607666
Epoch: 12, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.204 Vali Acc: 0.118 Test Loss: 3.204 Test Acc: 0.118
Validation loss decreased (-0.110556 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 0.8771524429321289
Epoch: 13, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.204 Vali Acc: 0.128 Test Loss: 3.204 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 0.9277694225311279
Epoch: 14, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.208 Vali Acc: 0.133 Test Loss: 3.208 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.7839405536651611
Epoch: 15, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.223 Vali Acc: 0.142 Test Loss: 3.223 Test Acc: 0.142
Validation loss decreased (-0.132909 --> -0.142321).  Saving model ...
Epoch: 16 cost time: 1.1394155025482178
Epoch: 16, Steps: 10 | Train Loss: 1.834 Vali Loss: 3.233 Vali Acc: 0.147 Test Loss: 3.233 Test Acc: 0.147
Validation loss decreased (-0.142321 --> -0.147026).  Saving model ...
Epoch: 17 cost time: 0.693838357925415
Epoch: 17, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.256 Vali Acc: 0.152 Test Loss: 3.256 Test Acc: 0.152
Validation loss decreased (-0.147026 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 1.0563206672668457
Epoch: 18, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.297 Vali Acc: 0.166 Test Loss: 3.297 Test Acc: 0.166
Validation loss decreased (-0.151732 --> -0.165849).  Saving model ...
Epoch: 19 cost time: 0.8599328994750977
Epoch: 19, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.331 Vali Acc: 0.172 Test Loss: 3.331 Test Acc: 0.172
Validation loss decreased (-0.165849 --> -0.171731).  Saving model ...
Epoch: 20 cost time: 1.0062358379364014
Epoch: 20, Steps: 10 | Train Loss: 1.349 Vali Loss: 3.398 Vali Acc: 0.167 Test Loss: 3.398 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1108825206756592
Epoch: 21, Steps: 10 | Train Loss: 1.215 Vali Loss: 3.465 Vali Acc: 0.173 Test Loss: 3.465 Test Acc: 0.173
Validation loss decreased (-0.171731 --> -0.172907).  Saving model ...
Epoch: 22 cost time: 0.802574872970581
Epoch: 22, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.550 Vali Acc: 0.179 Test Loss: 3.550 Test Acc: 0.179
Validation loss decreased (-0.172907 --> -0.178788).  Saving model ...
Epoch: 23 cost time: 0.7651340961456299
Epoch: 23, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.665 Vali Acc: 0.178 Test Loss: 3.665 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8293075561523438
Epoch: 24, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.739 Vali Acc: 0.184 Test Loss: 3.739 Test Acc: 0.184
Validation loss decreased (-0.178788 --> -0.183492).  Saving model ...
Epoch: 25 cost time: 0.7465286254882812
Epoch: 25, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.839 Vali Acc: 0.174 Test Loss: 3.839 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9780652523040771
Epoch: 26, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.950 Vali Acc: 0.185 Test Loss: 3.950 Test Acc: 0.185
Validation loss decreased (-0.183492 --> -0.184666).  Saving model ...
Epoch: 27 cost time: 1.0408213138580322
Epoch: 27, Steps: 10 | Train Loss: 0.602 Vali Loss: 4.106 Vali Acc: 0.184 Test Loss: 4.106 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6875581741333008
Epoch: 28, Steps: 10 | Train Loss: 0.531 Vali Loss: 4.232 Vali Acc: 0.179 Test Loss: 4.232 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9499614238739014
Epoch: 29, Steps: 10 | Train Loss: 0.400 Vali Loss: 4.364 Vali Acc: 0.184 Test Loss: 4.364 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0451183319091797
Epoch: 30, Steps: 10 | Train Loss: 0.338 Vali Loss: 4.642 Vali Acc: 0.187 Test Loss: 4.642 Test Acc: 0.187
Validation loss decreased (-0.184666 --> -0.187012).  Saving model ...
Epoch: 31 cost time: 0.8182704448699951
Epoch: 31, Steps: 10 | Train Loss: 0.265 Vali Loss: 4.831 Vali Acc: 0.186 Test Loss: 4.831 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0470192432403564
Epoch: 32, Steps: 10 | Train Loss: 0.217 Vali Loss: 5.013 Vali Acc: 0.188 Test Loss: 5.013 Test Acc: 0.188
Validation loss decreased (-0.187012 --> -0.188185).  Saving model ...
Epoch: 33 cost time: 1.1661922931671143
Epoch: 33, Steps: 10 | Train Loss: 0.164 Vali Loss: 5.264 Vali Acc: 0.188 Test Loss: 5.264 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1307227611541748
Epoch: 34, Steps: 10 | Train Loss: 0.127 Vali Loss: 5.562 Vali Acc: 0.178 Test Loss: 5.562 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.256221055984497
Epoch: 35, Steps: 10 | Train Loss: 0.106 Vali Loss: 5.803 Vali Acc: 0.186 Test Loss: 5.803 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2717022895812988
Epoch: 36, Steps: 10 | Train Loss: 0.079 Vali Loss: 6.083 Vali Acc: 0.179 Test Loss: 6.083 Test Acc: 0.179
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0573501586914062
Epoch: 37, Steps: 10 | Train Loss: 0.081 Vali Loss: 6.304 Vali Acc: 0.180 Test Loss: 6.304 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2021141052246094
Epoch: 38, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.517 Vali Acc: 0.187 Test Loss: 6.517 Test Acc: 0.187
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1661975383758545
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 6.780 Vali Acc: 0.180 Test Loss: 6.780 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1414711475372314
Epoch: 40, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.954 Vali Acc: 0.182 Test Loss: 6.954 Test Acc: 0.182
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9779388904571533
Epoch: 41, Steps: 10 | Train Loss: 0.033 Vali Loss: 7.139 Vali Acc: 0.180 Test Loss: 7.139 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.3238239288330078
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 7.363 Vali Acc: 0.175 Test Loss: 7.363 Test Acc: 0.175
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18823529411764706
model parameter : 67352
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6350722312927246
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.325 Vali Acc: 0.036 Test Loss: 3.325 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.7279922962188721
Epoch: 2, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.313 Vali Acc: 0.036 Test Loss: 3.313 Test Acc: 0.036
Validation loss decreased (-0.036437 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.6403045654296875
Epoch: 3, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.300 Vali Acc: 0.041 Test Loss: 3.300 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 0.8327257633209229
Epoch: 4, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.284 Vali Acc: 0.046 Test Loss: 3.284 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045850).  Saving model ...
Epoch: 5 cost time: 0.9788980484008789
Epoch: 5, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.269 Vali Acc: 0.053 Test Loss: 3.269 Test Acc: 0.053
Validation loss decreased (-0.045850 --> -0.052908).  Saving model ...
Epoch: 6 cost time: 0.811506986618042
Epoch: 6, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.255 Vali Acc: 0.058 Test Loss: 3.255 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057615).  Saving model ...
Epoch: 7 cost time: 0.8058443069458008
Epoch: 7, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.242 Vali Acc: 0.064 Test Loss: 3.242 Test Acc: 0.064
Validation loss decreased (-0.057615 --> -0.063497).  Saving model ...
Epoch: 8 cost time: 0.7484538555145264
Epoch: 8, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.234 Vali Acc: 0.072 Test Loss: 3.234 Test Acc: 0.072
Validation loss decreased (-0.063497 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 0.9672026634216309
Epoch: 9, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.223 Vali Acc: 0.086 Test Loss: 3.223 Test Acc: 0.086
Validation loss decreased (-0.071732 --> -0.085850).  Saving model ...
Epoch: 10 cost time: 0.8863499164581299
Epoch: 10, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.218 Vali Acc: 0.094 Test Loss: 3.218 Test Acc: 0.094
Validation loss decreased (-0.085850 --> -0.094085).  Saving model ...
Epoch: 11 cost time: 0.9348063468933105
Epoch: 11, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.213 Vali Acc: 0.104 Test Loss: 3.213 Test Acc: 0.104
Validation loss decreased (-0.094085 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.7313766479492188
Epoch: 12, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.212 Vali Acc: 0.106 Test Loss: 3.212 Test Acc: 0.106
Validation loss decreased (-0.103497 --> -0.105850).  Saving model ...
Epoch: 13 cost time: 0.8403501510620117
Epoch: 13, Steps: 10 | Train Loss: 2.230 Vali Loss: 3.215 Vali Acc: 0.118 Test Loss: 3.215 Test Acc: 0.118
Validation loss decreased (-0.105850 --> -0.117615).  Saving model ...
Epoch: 14 cost time: 0.7604658603668213
Epoch: 14, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.222 Vali Acc: 0.131 Test Loss: 3.222 Test Acc: 0.131
Validation loss decreased (-0.117615 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.8844566345214844
Epoch: 15, Steps: 10 | Train Loss: 1.976 Vali Loss: 3.241 Vali Acc: 0.133 Test Loss: 3.241 Test Acc: 0.133
Validation loss decreased (-0.130556 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 0.965524435043335
Epoch: 16, Steps: 10 | Train Loss: 1.824 Vali Loss: 3.279 Vali Acc: 0.142 Test Loss: 3.279 Test Acc: 0.142
Validation loss decreased (-0.132909 --> -0.142320).  Saving model ...
Epoch: 17 cost time: 0.860133171081543
Epoch: 17, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.325 Vali Acc: 0.153 Test Loss: 3.325 Test Acc: 0.153
Validation loss decreased (-0.142320 --> -0.152908).  Saving model ...
Epoch: 18 cost time: 0.7233843803405762
Epoch: 18, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.384 Vali Acc: 0.154 Test Loss: 3.384 Test Acc: 0.154
Validation loss decreased (-0.152908 --> -0.154084).  Saving model ...
Epoch: 19 cost time: 0.8250820636749268
Epoch: 19, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.438 Vali Acc: 0.166 Test Loss: 3.438 Test Acc: 0.166
Validation loss decreased (-0.154084 --> -0.165848).  Saving model ...
Epoch: 20 cost time: 0.7163741588592529
Epoch: 20, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.534 Vali Acc: 0.172 Test Loss: 3.534 Test Acc: 0.172
Validation loss decreased (-0.165848 --> -0.171729).  Saving model ...
Epoch: 21 cost time: 0.7290036678314209
Epoch: 21, Steps: 10 | Train Loss: 1.182 Vali Loss: 3.593 Vali Acc: 0.179 Test Loss: 3.593 Test Acc: 0.179
Validation loss decreased (-0.171729 --> -0.178788).  Saving model ...
Epoch: 22 cost time: 0.8732790946960449
Epoch: 22, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.662 Vali Acc: 0.187 Test Loss: 3.662 Test Acc: 0.187
Validation loss decreased (-0.178788 --> -0.187022).  Saving model ...
Epoch: 23 cost time: 0.9138877391815186
Epoch: 23, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.700 Vali Acc: 0.192 Test Loss: 3.700 Test Acc: 0.192
Validation loss decreased (-0.187022 --> -0.191728).  Saving model ...
Epoch: 24 cost time: 1.1019506454467773
Epoch: 24, Steps: 10 | Train Loss: 0.870 Vali Loss: 3.822 Vali Acc: 0.194 Test Loss: 3.822 Test Acc: 0.194
Validation loss decreased (-0.191728 --> -0.194079).  Saving model ...
Epoch: 25 cost time: 0.9327361583709717
Epoch: 25, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.895 Vali Acc: 0.178 Test Loss: 3.895 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9607429504394531
Epoch: 26, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.977 Vali Acc: 0.185 Test Loss: 3.977 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9000422954559326
Epoch: 27, Steps: 10 | Train Loss: 0.600 Vali Loss: 4.089 Vali Acc: 0.192 Test Loss: 4.089 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8055093288421631
Epoch: 28, Steps: 10 | Train Loss: 0.516 Vali Loss: 4.209 Vali Acc: 0.193 Test Loss: 4.209 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.170729398727417
Epoch: 29, Steps: 10 | Train Loss: 0.430 Vali Loss: 4.327 Vali Acc: 0.194 Test Loss: 4.327 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2023067474365234
Epoch: 30, Steps: 10 | Train Loss: 0.385 Vali Loss: 4.445 Vali Acc: 0.198 Test Loss: 4.445 Test Acc: 0.198
Validation loss decreased (-0.194079 --> -0.197603).  Saving model ...
Epoch: 31 cost time: 0.819227933883667
Epoch: 31, Steps: 10 | Train Loss: 0.295 Vali Loss: 4.633 Vali Acc: 0.198 Test Loss: 4.633 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8535363674163818
Epoch: 32, Steps: 10 | Train Loss: 0.259 Vali Loss: 4.831 Vali Acc: 0.204 Test Loss: 4.831 Test Acc: 0.204
Validation loss decreased (-0.197603 --> -0.203481).  Saving model ...
Epoch: 33 cost time: 1.0179643630981445
Epoch: 33, Steps: 10 | Train Loss: 0.197 Vali Loss: 5.002 Vali Acc: 0.201 Test Loss: 5.002 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9566597938537598
Epoch: 34, Steps: 10 | Train Loss: 0.168 Vali Loss: 5.191 Vali Acc: 0.207 Test Loss: 5.191 Test Acc: 0.207
Validation loss decreased (-0.203481 --> -0.207007).  Saving model ...
Epoch: 35 cost time: 1.0931575298309326
Epoch: 35, Steps: 10 | Train Loss: 0.140 Vali Loss: 5.469 Vali Acc: 0.192 Test Loss: 5.469 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9484059810638428
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 5.641 Vali Acc: 0.198 Test Loss: 5.641 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7955572605133057
Epoch: 37, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.889 Vali Acc: 0.196 Test Loss: 5.889 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9399075508117676
Epoch: 38, Steps: 10 | Train Loss: 0.067 Vali Loss: 6.120 Vali Acc: 0.202 Test Loss: 6.120 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.135737657546997
Epoch: 39, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.350 Vali Acc: 0.199 Test Loss: 6.350 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.119605541229248
Epoch: 40, Steps: 10 | Train Loss: 0.047 Vali Loss: 6.475 Vali Acc: 0.206 Test Loss: 6.475 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.707489013671875
Epoch: 41, Steps: 10 | Train Loss: 0.038 Vali Loss: 6.666 Vali Acc: 0.199 Test Loss: 6.666 Test Acc: 0.199
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7753095626831055
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.891 Vali Acc: 0.206 Test Loss: 6.891 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9912827014923096
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 7.026 Vali Acc: 0.209 Test Loss: 7.026 Test Acc: 0.209
Validation loss decreased (-0.207007 --> -0.209342).  Saving model ...
Epoch: 44 cost time: 1.1102938652038574
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 7.154 Vali Acc: 0.206 Test Loss: 7.154 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0721485614776611
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.329 Vali Acc: 0.207 Test Loss: 7.329 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.791240930557251
Epoch: 46, Steps: 10 | Train Loss: 0.014 Vali Loss: 7.482 Vali Acc: 0.202 Test Loss: 7.482 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0339229106903076
Epoch: 47, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.624 Vali Acc: 0.208 Test Loss: 7.624 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2173693180084229
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 7.754 Vali Acc: 0.209 Test Loss: 7.754 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9977908134460449
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 7.874 Vali Acc: 0.208 Test Loss: 7.874 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0129637718200684
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.030 Vali Acc: 0.207 Test Loss: 8.030 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0955655574798584
Epoch: 51, Steps: 10 | Train Loss: 0.009 Vali Loss: 8.165 Vali Acc: 0.209 Test Loss: 8.165 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9556097984313965
Epoch: 52, Steps: 10 | Train Loss: 0.007 Vali Loss: 8.260 Vali Acc: 0.208 Test Loss: 8.260 Test Acc: 0.208
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.8881640434265137
Epoch: 53, Steps: 10 | Train Loss: 0.007 Vali Loss: 8.382 Vali Acc: 0.209 Test Loss: 8.382 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20941176470588235
model parameter : 68264
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.915250539779663
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.309 Vali Acc: 0.046 Test Loss: 3.309 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.1118316650390625
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.299 Vali Acc: 0.056 Test Loss: 3.299 Test Acc: 0.056
Validation loss decreased (-0.045849 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.924034833908081
Epoch: 3, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.286 Vali Acc: 0.060 Test Loss: 3.286 Test Acc: 0.060
Validation loss decreased (-0.056438 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.8813176155090332
Epoch: 4, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.271 Vali Acc: 0.067 Test Loss: 3.271 Test Acc: 0.067
Validation loss decreased (-0.059967 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.756145715713501
Epoch: 5, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.256 Vali Acc: 0.079 Test Loss: 3.256 Test Acc: 0.079
Validation loss decreased (-0.067026 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 1.030102014541626
Epoch: 6, Steps: 10 | Train Loss: 2.961 Vali Loss: 3.241 Vali Acc: 0.085 Test Loss: 3.241 Test Acc: 0.085
Validation loss decreased (-0.078791 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 0.9953558444976807
Epoch: 7, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.230 Vali Acc: 0.093 Test Loss: 3.230 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 1.3622851371765137
Epoch: 8, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.222 Vali Acc: 0.104 Test Loss: 3.222 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 0.9038078784942627
Epoch: 9, Steps: 10 | Train Loss: 2.644 Vali Loss: 3.218 Vali Acc: 0.114 Test Loss: 3.218 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 0.8727853298187256
Epoch: 10, Steps: 10 | Train Loss: 2.515 Vali Loss: 3.219 Vali Acc: 0.112 Test Loss: 3.219 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6659016609191895
Epoch: 11, Steps: 10 | Train Loss: 2.410 Vali Loss: 3.220 Vali Acc: 0.127 Test Loss: 3.220 Test Acc: 0.127
Validation loss decreased (-0.114085 --> -0.127027).  Saving model ...
Epoch: 12 cost time: 0.816662073135376
Epoch: 12, Steps: 10 | Train Loss: 2.274 Vali Loss: 3.233 Vali Acc: 0.141 Test Loss: 3.233 Test Acc: 0.141
Validation loss decreased (-0.127027 --> -0.141144).  Saving model ...
Epoch: 13 cost time: 0.694624662399292
Epoch: 13, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.250 Vali Acc: 0.151 Test Loss: 3.250 Test Acc: 0.151
Validation loss decreased (-0.141144 --> -0.150556).  Saving model ...
Epoch: 14 cost time: 0.8671176433563232
Epoch: 14, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.265 Vali Acc: 0.162 Test Loss: 3.265 Test Acc: 0.162
Validation loss decreased (-0.150556 --> -0.162320).  Saving model ...
Epoch: 15 cost time: 0.7407824993133545
Epoch: 15, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.288 Vali Acc: 0.179 Test Loss: 3.288 Test Acc: 0.179
Validation loss decreased (-0.162320 --> -0.178791).  Saving model ...
Epoch: 16 cost time: 0.7080082893371582
Epoch: 16, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.335 Vali Acc: 0.182 Test Loss: 3.335 Test Acc: 0.182
Validation loss decreased (-0.178791 --> -0.182320).  Saving model ...
Epoch: 17 cost time: 0.8294281959533691
Epoch: 17, Steps: 10 | Train Loss: 1.671 Vali Loss: 3.395 Vali Acc: 0.185 Test Loss: 3.395 Test Acc: 0.185
Validation loss decreased (-0.182320 --> -0.184672).  Saving model ...
Epoch: 18 cost time: 0.7585070133209229
Epoch: 18, Steps: 10 | Train Loss: 1.537 Vali Loss: 3.447 Vali Acc: 0.193 Test Loss: 3.447 Test Acc: 0.193
Validation loss decreased (-0.184672 --> -0.192907).  Saving model ...
Epoch: 19 cost time: 0.8369333744049072
Epoch: 19, Steps: 10 | Train Loss: 1.437 Vali Loss: 3.505 Vali Acc: 0.194 Test Loss: 3.505 Test Acc: 0.194
Validation loss decreased (-0.192907 --> -0.194083).  Saving model ...
Epoch: 20 cost time: 1.1110620498657227
Epoch: 20, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.545 Vali Acc: 0.205 Test Loss: 3.545 Test Acc: 0.205
Validation loss decreased (-0.194083 --> -0.204670).  Saving model ...
Epoch: 21 cost time: 0.8892643451690674
Epoch: 21, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.600 Vali Acc: 0.202 Test Loss: 3.600 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6244549751281738
Epoch: 22, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.665 Vali Acc: 0.212 Test Loss: 3.665 Test Acc: 0.212
Validation loss decreased (-0.204670 --> -0.211728).  Saving model ...
Epoch: 23 cost time: 1.0017831325531006
Epoch: 23, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.690 Vali Acc: 0.215 Test Loss: 3.690 Test Acc: 0.215
Validation loss decreased (-0.211728 --> -0.215257).  Saving model ...
Epoch: 24 cost time: 0.9239592552185059
Epoch: 24, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.764 Vali Acc: 0.219 Test Loss: 3.764 Test Acc: 0.219
Validation loss decreased (-0.215257 --> -0.218786).  Saving model ...
Epoch: 25 cost time: 0.7249600887298584
Epoch: 25, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.837 Vali Acc: 0.219 Test Loss: 3.837 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8553991317749023
Epoch: 26, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.945 Vali Acc: 0.213 Test Loss: 3.945 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.97945237159729
Epoch: 27, Steps: 10 | Train Loss: 0.755 Vali Loss: 4.023 Vali Acc: 0.221 Test Loss: 4.023 Test Acc: 0.221
Validation loss decreased (-0.218786 --> -0.221136).  Saving model ...
Epoch: 28 cost time: 0.7902815341949463
Epoch: 28, Steps: 10 | Train Loss: 0.636 Vali Loss: 4.119 Vali Acc: 0.221 Test Loss: 4.119 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7621803283691406
Epoch: 29, Steps: 10 | Train Loss: 0.589 Vali Loss: 4.188 Vali Acc: 0.222 Test Loss: 4.188 Test Acc: 0.222
Validation loss decreased (-0.221136 --> -0.222311).  Saving model ...
Epoch: 30 cost time: 0.9918239116668701
Epoch: 30, Steps: 10 | Train Loss: 0.527 Vali Loss: 4.330 Vali Acc: 0.221 Test Loss: 4.330 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8206989765167236
Epoch: 31, Steps: 10 | Train Loss: 0.444 Vali Loss: 4.415 Vali Acc: 0.219 Test Loss: 4.415 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7156779766082764
Epoch: 32, Steps: 10 | Train Loss: 0.380 Vali Loss: 4.564 Vali Acc: 0.225 Test Loss: 4.564 Test Acc: 0.225
Validation loss decreased (-0.222311 --> -0.224660).  Saving model ...
Epoch: 33 cost time: 0.7911620140075684
Epoch: 33, Steps: 10 | Train Loss: 0.354 Vali Loss: 4.816 Vali Acc: 0.231 Test Loss: 4.816 Test Acc: 0.231
Validation loss decreased (-0.224660 --> -0.230540).  Saving model ...
Epoch: 34 cost time: 0.8802452087402344
Epoch: 34, Steps: 10 | Train Loss: 0.258 Vali Loss: 4.950 Vali Acc: 0.224 Test Loss: 4.950 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1057167053222656
Epoch: 35, Steps: 10 | Train Loss: 0.234 Vali Loss: 5.157 Vali Acc: 0.227 Test Loss: 5.157 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6388249397277832
Epoch: 36, Steps: 10 | Train Loss: 0.209 Vali Loss: 5.359 Vali Acc: 0.236 Test Loss: 5.359 Test Acc: 0.236
Validation loss decreased (-0.230540 --> -0.236417).  Saving model ...
Epoch: 37 cost time: 0.6827421188354492
Epoch: 37, Steps: 10 | Train Loss: 0.156 Vali Loss: 5.462 Vali Acc: 0.238 Test Loss: 5.462 Test Acc: 0.238
Validation loss decreased (-0.236417 --> -0.237592).  Saving model ...
Epoch: 38 cost time: 0.9494969844818115
Epoch: 38, Steps: 10 | Train Loss: 0.141 Vali Loss: 5.780 Vali Acc: 0.224 Test Loss: 5.780 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8486480712890625
Epoch: 39, Steps: 10 | Train Loss: 0.116 Vali Loss: 5.922 Vali Acc: 0.229 Test Loss: 5.922 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6318421363830566
Epoch: 40, Steps: 10 | Train Loss: 0.088 Vali Loss: 6.033 Vali Acc: 0.233 Test Loss: 6.033 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9118781089782715
Epoch: 41, Steps: 10 | Train Loss: 0.073 Vali Loss: 6.294 Vali Acc: 0.239 Test Loss: 6.294 Test Acc: 0.239
Validation loss decreased (-0.237592 --> -0.238761).  Saving model ...
Epoch: 42 cost time: 1.037182331085205
Epoch: 42, Steps: 10 | Train Loss: 0.062 Vali Loss: 6.446 Vali Acc: 0.229 Test Loss: 6.446 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9703104496002197
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 6.588 Vali Acc: 0.234 Test Loss: 6.588 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9084787368774414
Epoch: 44, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.786 Vali Acc: 0.233 Test Loss: 6.786 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.152186393737793
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.946 Vali Acc: 0.236 Test Loss: 6.946 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.26688814163208
Epoch: 46, Steps: 10 | Train Loss: 0.026 Vali Loss: 7.052 Vali Acc: 0.236 Test Loss: 7.052 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7302696704864502
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 7.237 Vali Acc: 0.234 Test Loss: 7.237 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8547122478485107
Epoch: 48, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.395 Vali Acc: 0.235 Test Loss: 7.395 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8710372447967529
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 7.508 Vali Acc: 0.232 Test Loss: 7.508 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9185278415679932
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 7.630 Vali Acc: 0.227 Test Loss: 7.630 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8667693138122559
Epoch: 51, Steps: 10 | Train Loss: 0.025 Vali Loss: 7.740 Vali Acc: 0.234 Test Loss: 7.740 Test Acc: 0.234
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2388235294117647
model parameter : 67142
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.331339120864868
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.326 Vali Acc: 0.028 Test Loss: 3.326 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.8808455467224121
Epoch: 2, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.316 Vali Acc: 0.033 Test Loss: 3.316 Test Acc: 0.033
Validation loss decreased (-0.028202 --> -0.032908).  Saving model ...
Epoch: 3 cost time: 0.8128180503845215
Epoch: 3, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.302 Vali Acc: 0.041 Test Loss: 3.302 Test Acc: 0.041
Validation loss decreased (-0.032908 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 0.7967839241027832
Epoch: 4, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.288 Vali Acc: 0.044 Test Loss: 3.288 Test Acc: 0.044
Validation loss decreased (-0.041143 --> -0.043497).  Saving model ...
Epoch: 5 cost time: 0.7635602951049805
Epoch: 5, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.272 Vali Acc: 0.064 Test Loss: 3.272 Test Acc: 0.064
Validation loss decreased (-0.043497 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.8361606597900391
Epoch: 6, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.258 Vali Acc: 0.080 Test Loss: 3.258 Test Acc: 0.080
Validation loss decreased (-0.063497 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 0.7616641521453857
Epoch: 7, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.245 Vali Acc: 0.086 Test Loss: 3.245 Test Acc: 0.086
Validation loss decreased (-0.079967 --> -0.085850).  Saving model ...
Epoch: 8 cost time: 0.8825719356536865
Epoch: 8, Steps: 10 | Train Loss: 2.780 Vali Loss: 3.234 Vali Acc: 0.096 Test Loss: 3.234 Test Acc: 0.096
Validation loss decreased (-0.085850 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 1.007185935974121
Epoch: 9, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.224 Vali Acc: 0.112 Test Loss: 3.224 Test Acc: 0.112
Validation loss decreased (-0.096438 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.8126568794250488
Epoch: 10, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.217 Vali Acc: 0.115 Test Loss: 3.217 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 0.6849582195281982
Epoch: 11, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.214 Vali Acc: 0.121 Test Loss: 3.214 Test Acc: 0.121
Validation loss decreased (-0.115262 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 0.7004706859588623
Epoch: 12, Steps: 10 | Train Loss: 2.338 Vali Loss: 3.216 Vali Acc: 0.126 Test Loss: 3.216 Test Acc: 0.126
Validation loss decreased (-0.121144 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.9396364688873291
Epoch: 13, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.223 Vali Acc: 0.133 Test Loss: 3.223 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.6837174892425537
Epoch: 14, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.236 Vali Acc: 0.142 Test Loss: 3.236 Test Acc: 0.142
Validation loss decreased (-0.132909 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 0.8399460315704346
Epoch: 15, Steps: 10 | Train Loss: 1.928 Vali Loss: 3.254 Vali Acc: 0.140 Test Loss: 3.254 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9193034172058105
Epoch: 16, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.278 Vali Acc: 0.152 Test Loss: 3.278 Test Acc: 0.152
Validation loss decreased (-0.142321 --> -0.151732).  Saving model ...
Epoch: 17 cost time: 0.7433791160583496
Epoch: 17, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.327 Vali Acc: 0.155 Test Loss: 3.327 Test Acc: 0.155
Validation loss decreased (-0.151732 --> -0.155261).  Saving model ...
Epoch: 18 cost time: 0.8291220664978027
Epoch: 18, Steps: 10 | Train Loss: 1.460 Vali Loss: 3.388 Vali Acc: 0.161 Test Loss: 3.388 Test Acc: 0.161
Validation loss decreased (-0.155261 --> -0.161143).  Saving model ...
Epoch: 19 cost time: 0.7519857883453369
Epoch: 19, Steps: 10 | Train Loss: 1.299 Vali Loss: 3.455 Vali Acc: 0.162 Test Loss: 3.455 Test Acc: 0.162
Validation loss decreased (-0.161143 --> -0.162318).  Saving model ...
Epoch: 20 cost time: 0.7946979999542236
Epoch: 20, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.536 Vali Acc: 0.165 Test Loss: 3.536 Test Acc: 0.165
Validation loss decreased (-0.162318 --> -0.164671).  Saving model ...
Epoch: 21 cost time: 0.7489371299743652
Epoch: 21, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.653 Vali Acc: 0.169 Test Loss: 3.653 Test Acc: 0.169
Validation loss decreased (-0.164671 --> -0.169375).  Saving model ...
Epoch: 22 cost time: 0.7675759792327881
Epoch: 22, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.797 Vali Acc: 0.165 Test Loss: 3.797 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.754751443862915
Epoch: 23, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.959 Vali Acc: 0.175 Test Loss: 3.959 Test Acc: 0.175
Validation loss decreased (-0.169375 --> -0.175255).  Saving model ...
Epoch: 24 cost time: 0.731616735458374
Epoch: 24, Steps: 10 | Train Loss: 0.596 Vali Loss: 4.134 Vali Acc: 0.168 Test Loss: 4.134 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7550320625305176
Epoch: 25, Steps: 10 | Train Loss: 0.519 Vali Loss: 4.295 Vali Acc: 0.174 Test Loss: 4.295 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6825902462005615
Epoch: 26, Steps: 10 | Train Loss: 0.420 Vali Loss: 4.591 Vali Acc: 0.164 Test Loss: 4.591 Test Acc: 0.164
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6650214195251465
Epoch: 27, Steps: 10 | Train Loss: 0.333 Vali Loss: 4.834 Vali Acc: 0.169 Test Loss: 4.834 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6794533729553223
Epoch: 28, Steps: 10 | Train Loss: 0.263 Vali Loss: 5.152 Vali Acc: 0.172 Test Loss: 5.152 Test Acc: 0.172
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.668367862701416
Epoch: 29, Steps: 10 | Train Loss: 0.210 Vali Loss: 5.459 Vali Acc: 0.162 Test Loss: 5.459 Test Acc: 0.162
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7961804866790771
Epoch: 30, Steps: 10 | Train Loss: 0.158 Vali Loss: 5.778 Vali Acc: 0.159 Test Loss: 5.778 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6509826183319092
Epoch: 31, Steps: 10 | Train Loss: 0.128 Vali Loss: 6.137 Vali Acc: 0.159 Test Loss: 6.137 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.614372968673706
Epoch: 32, Steps: 10 | Train Loss: 0.092 Vali Loss: 6.429 Vali Acc: 0.155 Test Loss: 6.429 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6925160884857178
Epoch: 33, Steps: 10 | Train Loss: 0.074 Vali Loss: 6.773 Vali Acc: 0.162 Test Loss: 6.773 Test Acc: 0.162
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.17529411764705882
model parameter : 67014
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8245961666107178
Epoch: 1, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.309 Vali Acc: 0.053 Test Loss: 3.309 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.8859624862670898
Epoch: 2, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.299 Vali Acc: 0.058 Test Loss: 3.299 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.7142229080200195
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.287 Vali Acc: 0.056 Test Loss: 3.287 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7675085067749023
Epoch: 4, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.274 Vali Acc: 0.067 Test Loss: 3.274 Test Acc: 0.067
Validation loss decreased (-0.057614 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.7934725284576416
Epoch: 5, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.260 Vali Acc: 0.068 Test Loss: 3.260 Test Acc: 0.068
Validation loss decreased (-0.067026 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 1.0303151607513428
Epoch: 6, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.250 Vali Acc: 0.073 Test Loss: 3.250 Test Acc: 0.073
Validation loss decreased (-0.068203 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 0.8381533622741699
Epoch: 7, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.241 Vali Acc: 0.082 Test Loss: 3.241 Test Acc: 0.082
Validation loss decreased (-0.072909 --> -0.082321).  Saving model ...
Epoch: 8 cost time: 0.8452537059783936
Epoch: 8, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.235 Vali Acc: 0.096 Test Loss: 3.235 Test Acc: 0.096
Validation loss decreased (-0.082321 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 0.8417701721191406
Epoch: 9, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.231 Vali Acc: 0.106 Test Loss: 3.231 Test Acc: 0.106
Validation loss decreased (-0.096438 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 0.767986536026001
Epoch: 10, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.228 Vali Acc: 0.118 Test Loss: 3.228 Test Acc: 0.118
Validation loss decreased (-0.105850 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 0.8622400760650635
Epoch: 11, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.229 Vali Acc: 0.116 Test Loss: 3.229 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6858658790588379
Epoch: 12, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.234 Vali Acc: 0.126 Test Loss: 3.234 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.9111495018005371
Epoch: 13, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.241 Vali Acc: 0.135 Test Loss: 3.241 Test Acc: 0.135
Validation loss decreased (-0.125850 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 0.808772087097168
Epoch: 14, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.246 Vali Acc: 0.144 Test Loss: 3.246 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 15 cost time: 0.8630199432373047
Epoch: 15, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.253 Vali Acc: 0.151 Test Loss: 3.253 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 0.6384849548339844
Epoch: 16, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.262 Vali Acc: 0.148 Test Loss: 3.262 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6985187530517578
Epoch: 17, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.280 Vali Acc: 0.152 Test Loss: 3.280 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 0.7003030776977539
Epoch: 18, Steps: 10 | Train Loss: 1.640 Vali Loss: 3.304 Vali Acc: 0.162 Test Loss: 3.304 Test Acc: 0.162
Validation loss decreased (-0.151732 --> -0.162320).  Saving model ...
Epoch: 19 cost time: 0.8008289337158203
Epoch: 19, Steps: 10 | Train Loss: 1.592 Vali Loss: 3.333 Vali Acc: 0.168 Test Loss: 3.333 Test Acc: 0.168
Validation loss decreased (-0.162320 --> -0.168202).  Saving model ...
Epoch: 20 cost time: 0.7867832183837891
Epoch: 20, Steps: 10 | Train Loss: 1.432 Vali Loss: 3.365 Vali Acc: 0.175 Test Loss: 3.365 Test Acc: 0.175
Validation loss decreased (-0.168202 --> -0.175260).  Saving model ...
Epoch: 21 cost time: 0.7470576763153076
Epoch: 21, Steps: 10 | Train Loss: 1.323 Vali Loss: 3.406 Vali Acc: 0.182 Test Loss: 3.406 Test Acc: 0.182
Validation loss decreased (-0.175260 --> -0.182319).  Saving model ...
Epoch: 22 cost time: 0.6786224842071533
Epoch: 22, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.460 Vali Acc: 0.191 Test Loss: 3.460 Test Acc: 0.191
Validation loss decreased (-0.182319 --> -0.190554).  Saving model ...
Epoch: 23 cost time: 0.8308777809143066
Epoch: 23, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.526 Vali Acc: 0.192 Test Loss: 3.526 Test Acc: 0.192
Validation loss decreased (-0.190554 --> -0.191729).  Saving model ...
Epoch: 24 cost time: 0.8278617858886719
Epoch: 24, Steps: 10 | Train Loss: 1.014 Vali Loss: 3.610 Vali Acc: 0.192 Test Loss: 3.610 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7782704830169678
Epoch: 25, Steps: 10 | Train Loss: 0.933 Vali Loss: 3.686 Vali Acc: 0.195 Test Loss: 3.686 Test Acc: 0.195
Validation loss decreased (-0.191729 --> -0.195257).  Saving model ...
Epoch: 26 cost time: 0.885629415512085
Epoch: 26, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.785 Vali Acc: 0.193 Test Loss: 3.785 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7445471286773682
Epoch: 27, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.881 Vali Acc: 0.192 Test Loss: 3.881 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9338841438293457
Epoch: 28, Steps: 10 | Train Loss: 0.664 Vali Loss: 4.001 Vali Acc: 0.187 Test Loss: 4.001 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8416943550109863
Epoch: 29, Steps: 10 | Train Loss: 0.565 Vali Loss: 4.101 Vali Acc: 0.192 Test Loss: 4.101 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8344104290008545
Epoch: 30, Steps: 10 | Train Loss: 0.510 Vali Loss: 4.238 Vali Acc: 0.188 Test Loss: 4.238 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9331393241882324
Epoch: 31, Steps: 10 | Train Loss: 0.416 Vali Loss: 4.380 Vali Acc: 0.188 Test Loss: 4.380 Test Acc: 0.188
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7741508483886719
Epoch: 32, Steps: 10 | Train Loss: 0.393 Vali Loss: 4.516 Vali Acc: 0.181 Test Loss: 4.516 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7660567760467529
Epoch: 33, Steps: 10 | Train Loss: 0.308 Vali Loss: 4.657 Vali Acc: 0.188 Test Loss: 4.657 Test Acc: 0.188
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7792582511901855
Epoch: 34, Steps: 10 | Train Loss: 0.268 Vali Loss: 4.843 Vali Acc: 0.184 Test Loss: 4.843 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7295353412628174
Epoch: 35, Steps: 10 | Train Loss: 0.219 Vali Loss: 4.989 Vali Acc: 0.176 Test Loss: 4.989 Test Acc: 0.176
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.1952941176470588
model parameter : 48984
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5068745613098145
Epoch: 1, Steps: 10 | Train Loss: 3.377 Vali Loss: 3.311 Vali Acc: 0.041 Test Loss: 3.311 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.9305555820465088
Epoch: 2, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.300 Vali Acc: 0.042 Test Loss: 3.300 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.8067588806152344
Epoch: 3, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.286 Vali Acc: 0.048 Test Loss: 3.286 Test Acc: 0.048
Validation loss decreased (-0.042320 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.6944656372070312
Epoch: 4, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.269 Vali Acc: 0.052 Test Loss: 3.269 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.9929399490356445
Epoch: 5, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.253 Vali Acc: 0.071 Test Loss: 3.253 Test Acc: 0.071
Validation loss decreased (-0.051732 --> -0.070556).  Saving model ...
Epoch: 6 cost time: 1.1646900177001953
Epoch: 6, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.237 Vali Acc: 0.082 Test Loss: 3.237 Test Acc: 0.082
Validation loss decreased (-0.070556 --> -0.082321).  Saving model ...
Epoch: 7 cost time: 0.8754568099975586
Epoch: 7, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.223 Vali Acc: 0.098 Test Loss: 3.223 Test Acc: 0.098
Validation loss decreased (-0.082321 --> -0.097615).  Saving model ...
Epoch: 8 cost time: 0.7838685512542725
Epoch: 8, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.210 Vali Acc: 0.106 Test Loss: 3.210 Test Acc: 0.106
Validation loss decreased (-0.097615 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 0.7854721546173096
Epoch: 9, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.200 Vali Acc: 0.098 Test Loss: 3.200 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8398993015289307
Epoch: 10, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.191 Vali Acc: 0.106 Test Loss: 3.191 Test Acc: 0.106
Validation loss decreased (-0.105850 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.7262742519378662
Epoch: 11, Steps: 10 | Train Loss: 2.513 Vali Loss: 3.186 Vali Acc: 0.109 Test Loss: 3.186 Test Acc: 0.109
Validation loss decreased (-0.105850 --> -0.109380).  Saving model ...
Epoch: 12 cost time: 0.7776322364807129
Epoch: 12, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.185 Vali Acc: 0.115 Test Loss: 3.185 Test Acc: 0.115
Validation loss decreased (-0.109380 --> -0.115262).  Saving model ...
Epoch: 13 cost time: 0.8593831062316895
Epoch: 13, Steps: 10 | Train Loss: 2.279 Vali Loss: 3.184 Vali Acc: 0.119 Test Loss: 3.184 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118792).  Saving model ...
Epoch: 14 cost time: 0.8312876224517822
Epoch: 14, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.189 Vali Acc: 0.124 Test Loss: 3.189 Test Acc: 0.124
Validation loss decreased (-0.118792 --> -0.123498).  Saving model ...
Epoch: 15 cost time: 0.7445826530456543
Epoch: 15, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.193 Vali Acc: 0.131 Test Loss: 3.193 Test Acc: 0.131
Validation loss decreased (-0.123498 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 0.9436783790588379
Epoch: 16, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.201 Vali Acc: 0.136 Test Loss: 3.201 Test Acc: 0.136
Validation loss decreased (-0.130556 --> -0.136439).  Saving model ...
Epoch: 17 cost time: 0.7450962066650391
Epoch: 17, Steps: 10 | Train Loss: 1.884 Vali Loss: 3.209 Vali Acc: 0.141 Test Loss: 3.209 Test Acc: 0.141
Validation loss decreased (-0.136439 --> -0.141144).  Saving model ...
Epoch: 18 cost time: 0.7343590259552002
Epoch: 18, Steps: 10 | Train Loss: 1.787 Vali Loss: 3.222 Vali Acc: 0.145 Test Loss: 3.222 Test Acc: 0.145
Validation loss decreased (-0.141144 --> -0.144674).  Saving model ...
Epoch: 19 cost time: 0.6042356491088867
Epoch: 19, Steps: 10 | Train Loss: 1.690 Vali Loss: 3.240 Vali Acc: 0.156 Test Loss: 3.240 Test Acc: 0.156
Validation loss decreased (-0.144674 --> -0.156438).  Saving model ...
Epoch: 20 cost time: 0.6107504367828369
Epoch: 20, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.257 Vali Acc: 0.162 Test Loss: 3.257 Test Acc: 0.162
Validation loss decreased (-0.156438 --> -0.162320).  Saving model ...
Epoch: 21 cost time: 0.8045883178710938
Epoch: 21, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.277 Vali Acc: 0.166 Test Loss: 3.277 Test Acc: 0.166
Validation loss decreased (-0.162320 --> -0.165850).  Saving model ...
Epoch: 22 cost time: 0.8121647834777832
Epoch: 22, Steps: 10 | Train Loss: 1.398 Vali Loss: 3.298 Vali Acc: 0.171 Test Loss: 3.298 Test Acc: 0.171
Validation loss decreased (-0.165850 --> -0.170555).  Saving model ...
Epoch: 23 cost time: 0.6704530715942383
Epoch: 23, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.336 Vali Acc: 0.176 Test Loss: 3.336 Test Acc: 0.176
Validation loss decreased (-0.170555 --> -0.176437).  Saving model ...
Epoch: 24 cost time: 0.8428947925567627
Epoch: 24, Steps: 10 | Train Loss: 1.186 Vali Loss: 3.375 Vali Acc: 0.184 Test Loss: 3.375 Test Acc: 0.184
Validation loss decreased (-0.176437 --> -0.183496).  Saving model ...
Epoch: 25 cost time: 0.7872269153594971
Epoch: 25, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.414 Vali Acc: 0.191 Test Loss: 3.414 Test Acc: 0.191
Validation loss decreased (-0.183496 --> -0.190554).  Saving model ...
Epoch: 26 cost time: 0.7627582550048828
Epoch: 26, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.470 Vali Acc: 0.188 Test Loss: 3.470 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8967721462249756
Epoch: 27, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.539 Vali Acc: 0.189 Test Loss: 3.539 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.802473783493042
Epoch: 28, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.629 Vali Acc: 0.188 Test Loss: 3.629 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0365726947784424
Epoch: 29, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.707 Vali Acc: 0.191 Test Loss: 3.707 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8745899200439453
Epoch: 30, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.780 Vali Acc: 0.189 Test Loss: 3.780 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7932629585266113
Epoch: 31, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.897 Vali Acc: 0.195 Test Loss: 3.897 Test Acc: 0.195
Validation loss decreased (-0.190554 --> -0.195255).  Saving model ...
Epoch: 32 cost time: 0.998894453048706
Epoch: 32, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.994 Vali Acc: 0.201 Test Loss: 3.994 Test Acc: 0.201
Validation loss decreased (-0.195255 --> -0.201137).  Saving model ...
Epoch: 33 cost time: 0.8054323196411133
Epoch: 33, Steps: 10 | Train Loss: 0.459 Vali Loss: 4.085 Vali Acc: 0.194 Test Loss: 4.085 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6986448764801025
Epoch: 34, Steps: 10 | Train Loss: 0.407 Vali Loss: 4.235 Vali Acc: 0.194 Test Loss: 4.235 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9218969345092773
Epoch: 35, Steps: 10 | Train Loss: 0.354 Vali Loss: 4.366 Vali Acc: 0.199 Test Loss: 4.366 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.027590036392212
Epoch: 36, Steps: 10 | Train Loss: 0.299 Vali Loss: 4.485 Vali Acc: 0.195 Test Loss: 4.485 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8730447292327881
Epoch: 37, Steps: 10 | Train Loss: 0.259 Vali Loss: 4.702 Vali Acc: 0.200 Test Loss: 4.702 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9611566066741943
Epoch: 38, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.859 Vali Acc: 0.181 Test Loss: 4.859 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.903486967086792
Epoch: 39, Steps: 10 | Train Loss: 0.185 Vali Loss: 5.003 Vali Acc: 0.198 Test Loss: 5.003 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7936105728149414
Epoch: 40, Steps: 10 | Train Loss: 0.149 Vali Loss: 5.187 Vali Acc: 0.189 Test Loss: 5.187 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8280510902404785
Epoch: 41, Steps: 10 | Train Loss: 0.124 Vali Loss: 5.360 Vali Acc: 0.186 Test Loss: 5.360 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7922573089599609
Epoch: 42, Steps: 10 | Train Loss: 0.100 Vali Loss: 5.515 Vali Acc: 0.189 Test Loss: 5.515 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2011764705882353
model parameter : 47550
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.751035213470459
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.334 Vali Acc: 0.047 Test Loss: 3.334 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.805194616317749
Epoch: 2, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.321 Vali Acc: 0.048 Test Loss: 3.321 Test Acc: 0.048
Validation loss decreased (-0.047025 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.7921240329742432
Epoch: 3, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.305 Vali Acc: 0.051 Test Loss: 3.305 Test Acc: 0.051
Validation loss decreased (-0.048202 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.6970899105072021
Epoch: 4, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.289 Vali Acc: 0.049 Test Loss: 3.289 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.724247932434082
Epoch: 5, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.271 Vali Acc: 0.051 Test Loss: 3.271 Test Acc: 0.051
Validation loss decreased (-0.050555 --> -0.050556).  Saving model ...
Epoch: 6 cost time: 0.8594303131103516
Epoch: 6, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.256 Vali Acc: 0.062 Test Loss: 3.256 Test Acc: 0.062
Validation loss decreased (-0.050556 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 1.153193473815918
Epoch: 7, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.243 Vali Acc: 0.067 Test Loss: 3.243 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 0.7631545066833496
Epoch: 8, Steps: 10 | Train Loss: 2.809 Vali Loss: 3.230 Vali Acc: 0.087 Test Loss: 3.230 Test Acc: 0.087
Validation loss decreased (-0.067026 --> -0.087027).  Saving model ...
Epoch: 9 cost time: 0.8738725185394287
Epoch: 9, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.221 Vali Acc: 0.088 Test Loss: 3.221 Test Acc: 0.088
Validation loss decreased (-0.087027 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 0.9954557418823242
Epoch: 10, Steps: 10 | Train Loss: 2.594 Vali Loss: 3.214 Vali Acc: 0.101 Test Loss: 3.214 Test Acc: 0.101
Validation loss decreased (-0.088203 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.6856184005737305
Epoch: 11, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.208 Vali Acc: 0.125 Test Loss: 3.208 Test Acc: 0.125
Validation loss decreased (-0.101144 --> -0.124674).  Saving model ...
Epoch: 12 cost time: 0.700186014175415
Epoch: 12, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.204 Vali Acc: 0.136 Test Loss: 3.204 Test Acc: 0.136
Validation loss decreased (-0.124674 --> -0.136439).  Saving model ...
Epoch: 13 cost time: 0.8229548931121826
Epoch: 13, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.203 Vali Acc: 0.147 Test Loss: 3.203 Test Acc: 0.147
Validation loss decreased (-0.136439 --> -0.147027).  Saving model ...
Epoch: 14 cost time: 1.2646358013153076
Epoch: 14, Steps: 10 | Train Loss: 2.169 Vali Loss: 3.202 Vali Acc: 0.152 Test Loss: 3.202 Test Acc: 0.152
Validation loss decreased (-0.147027 --> -0.151733).  Saving model ...
Epoch: 15 cost time: 0.9548125267028809
Epoch: 15, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.203 Vali Acc: 0.153 Test Loss: 3.203 Test Acc: 0.153
Validation loss decreased (-0.151733 --> -0.152909).  Saving model ...
Epoch: 16 cost time: 0.779355525970459
Epoch: 16, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.207 Vali Acc: 0.156 Test Loss: 3.207 Test Acc: 0.156
Validation loss decreased (-0.152909 --> -0.156439).  Saving model ...
Epoch: 17 cost time: 0.8577380180358887
Epoch: 17, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.214 Vali Acc: 0.160 Test Loss: 3.214 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 0.8842916488647461
Epoch: 18, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.226 Vali Acc: 0.164 Test Loss: 3.226 Test Acc: 0.164
Validation loss decreased (-0.159968 --> -0.163497).  Saving model ...
Epoch: 19 cost time: 0.9795498847961426
Epoch: 19, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.239 Vali Acc: 0.172 Test Loss: 3.239 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171732).  Saving model ...
Epoch: 20 cost time: 1.0038397312164307
Epoch: 20, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.252 Vali Acc: 0.168 Test Loss: 3.252 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0293896198272705
Epoch: 21, Steps: 10 | Train Loss: 1.441 Vali Loss: 3.273 Vali Acc: 0.178 Test Loss: 3.273 Test Acc: 0.178
Validation loss decreased (-0.171732 --> -0.177614).  Saving model ...
Epoch: 22 cost time: 0.871056079864502
Epoch: 22, Steps: 10 | Train Loss: 1.320 Vali Loss: 3.297 Vali Acc: 0.181 Test Loss: 3.297 Test Acc: 0.181
Validation loss decreased (-0.177614 --> -0.181144).  Saving model ...
Epoch: 23 cost time: 0.8169326782226562
Epoch: 23, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.328 Vali Acc: 0.185 Test Loss: 3.328 Test Acc: 0.185
Validation loss decreased (-0.181144 --> -0.184673).  Saving model ...
Epoch: 24 cost time: 0.8709566593170166
Epoch: 24, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.355 Vali Acc: 0.196 Test Loss: 3.355 Test Acc: 0.196
Validation loss decreased (-0.184673 --> -0.196437).  Saving model ...
Epoch: 25 cost time: 0.7510449886322021
Epoch: 25, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.394 Vali Acc: 0.199 Test Loss: 3.394 Test Acc: 0.199
Validation loss decreased (-0.196437 --> -0.198790).  Saving model ...
Epoch: 26 cost time: 0.7802855968475342
Epoch: 26, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.437 Vali Acc: 0.202 Test Loss: 3.437 Test Acc: 0.202
Validation loss decreased (-0.198790 --> -0.202319).  Saving model ...
Epoch: 27 cost time: 0.763261079788208
Epoch: 27, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.480 Vali Acc: 0.204 Test Loss: 3.480 Test Acc: 0.204
Validation loss decreased (-0.202319 --> -0.203495).  Saving model ...
Epoch: 28 cost time: 0.9913046360015869
Epoch: 28, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.536 Vali Acc: 0.207 Test Loss: 3.536 Test Acc: 0.207
Validation loss decreased (-0.203495 --> -0.207023).  Saving model ...
Epoch: 29 cost time: 0.6871204376220703
Epoch: 29, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.601 Vali Acc: 0.205 Test Loss: 3.601 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6873764991760254
Epoch: 30, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.666 Vali Acc: 0.202 Test Loss: 3.666 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.777677059173584
Epoch: 31, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.741 Vali Acc: 0.207 Test Loss: 3.741 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7738080024719238
Epoch: 32, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.808 Vali Acc: 0.205 Test Loss: 3.808 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8780536651611328
Epoch: 33, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.867 Vali Acc: 0.205 Test Loss: 3.867 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8622329235076904
Epoch: 34, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.960 Vali Acc: 0.206 Test Loss: 3.960 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8787534236907959
Epoch: 35, Steps: 10 | Train Loss: 0.381 Vali Loss: 4.013 Vali Acc: 0.201 Test Loss: 4.013 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8168869018554688
Epoch: 36, Steps: 10 | Train Loss: 0.353 Vali Loss: 4.105 Vali Acc: 0.201 Test Loss: 4.105 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8887381553649902
Epoch: 37, Steps: 10 | Train Loss: 0.320 Vali Loss: 4.193 Vali Acc: 0.196 Test Loss: 4.193 Test Acc: 0.196
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8605554103851318
Epoch: 38, Steps: 10 | Train Loss: 0.275 Vali Loss: 4.271 Vali Acc: 0.204 Test Loss: 4.271 Test Acc: 0.204
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20705882352941177
model parameter : 46584
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6095497608184814
Epoch: 1, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.265 Vali Acc: 0.052 Test Loss: 3.265 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.9565572738647461
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.256 Vali Acc: 0.055 Test Loss: 3.256 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055262).  Saving model ...
Epoch: 3 cost time: 0.5736145973205566
Epoch: 3, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.245 Vali Acc: 0.061 Test Loss: 3.245 Test Acc: 0.061
Validation loss decreased (-0.055262 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.6121811866760254
Epoch: 4, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.233 Vali Acc: 0.072 Test Loss: 3.233 Test Acc: 0.072
Validation loss decreased (-0.061144 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 0.6995530128479004
Epoch: 5, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.221 Vali Acc: 0.089 Test Loss: 3.221 Test Acc: 0.089
Validation loss decreased (-0.071732 --> -0.089380).  Saving model ...
Epoch: 6 cost time: 0.828622579574585
Epoch: 6, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.211 Vali Acc: 0.105 Test Loss: 3.211 Test Acc: 0.105
Validation loss decreased (-0.089380 --> -0.104674).  Saving model ...
Epoch: 7 cost time: 0.7626240253448486
Epoch: 7, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.202 Vali Acc: 0.114 Test Loss: 3.202 Test Acc: 0.114
Validation loss decreased (-0.104674 --> -0.114086).  Saving model ...
Epoch: 8 cost time: 0.8446788787841797
Epoch: 8, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.195 Vali Acc: 0.121 Test Loss: 3.195 Test Acc: 0.121
Validation loss decreased (-0.114086 --> -0.121145).  Saving model ...
Epoch: 9 cost time: 0.8350789546966553
Epoch: 9, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.189 Vali Acc: 0.131 Test Loss: 3.189 Test Acc: 0.131
Validation loss decreased (-0.121145 --> -0.130556).  Saving model ...
Epoch: 10 cost time: 0.7234315872192383
Epoch: 10, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.186 Vali Acc: 0.136 Test Loss: 3.186 Test Acc: 0.136
Validation loss decreased (-0.130556 --> -0.136439).  Saving model ...
Epoch: 11 cost time: 0.7484405040740967
Epoch: 11, Steps: 10 | Train Loss: 2.422 Vali Loss: 3.185 Vali Acc: 0.136 Test Loss: 3.185 Test Acc: 0.136
Validation loss decreased (-0.136439 --> -0.136439).  Saving model ...
Epoch: 12 cost time: 0.8862900733947754
Epoch: 12, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.188 Vali Acc: 0.138 Test Loss: 3.188 Test Acc: 0.138
Validation loss decreased (-0.136439 --> -0.137615).  Saving model ...
Epoch: 13 cost time: 0.9012959003448486
Epoch: 13, Steps: 10 | Train Loss: 2.181 Vali Loss: 3.192 Vali Acc: 0.139 Test Loss: 3.192 Test Acc: 0.139
Validation loss decreased (-0.137615 --> -0.138792).  Saving model ...
Epoch: 14 cost time: 0.709510326385498
Epoch: 14, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.199 Vali Acc: 0.142 Test Loss: 3.199 Test Acc: 0.142
Validation loss decreased (-0.138792 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 0.7735750675201416
Epoch: 15, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.209 Vali Acc: 0.146 Test Loss: 3.209 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 0.8044908046722412
Epoch: 16, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.222 Vali Acc: 0.147 Test Loss: 3.222 Test Acc: 0.147
Validation loss decreased (-0.145850 --> -0.147027).  Saving model ...
Epoch: 17 cost time: 0.98647141456604
Epoch: 17, Steps: 10 | Train Loss: 1.821 Vali Loss: 3.231 Vali Acc: 0.151 Test Loss: 3.231 Test Acc: 0.151
Validation loss decreased (-0.147027 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.8027360439300537
Epoch: 18, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.243 Vali Acc: 0.160 Test Loss: 3.243 Test Acc: 0.160
Validation loss decreased (-0.150556 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 0.6757199764251709
Epoch: 19, Steps: 10 | Train Loss: 1.607 Vali Loss: 3.265 Vali Acc: 0.159 Test Loss: 3.265 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.054506778717041
Epoch: 20, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.284 Vali Acc: 0.165 Test Loss: 3.284 Test Acc: 0.165
Validation loss decreased (-0.159968 --> -0.164673).  Saving model ...
Epoch: 21 cost time: 0.847052812576294
Epoch: 21, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.308 Vali Acc: 0.164 Test Loss: 3.308 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7217998504638672
Epoch: 22, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.338 Vali Acc: 0.165 Test Loss: 3.338 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7984161376953125
Epoch: 23, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.368 Vali Acc: 0.167 Test Loss: 3.368 Test Acc: 0.167
Validation loss decreased (-0.164673 --> -0.167025).  Saving model ...
Epoch: 24 cost time: 1.0576648712158203
Epoch: 24, Steps: 10 | Train Loss: 1.054 Vali Loss: 3.408 Vali Acc: 0.169 Test Loss: 3.408 Test Acc: 0.169
Validation loss decreased (-0.167025 --> -0.169378).  Saving model ...
Epoch: 25 cost time: 0.723966121673584
Epoch: 25, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.437 Vali Acc: 0.169 Test Loss: 3.437 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.748176097869873
Epoch: 26, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.504 Vali Acc: 0.184 Test Loss: 3.504 Test Acc: 0.184
Validation loss decreased (-0.169378 --> -0.183494).  Saving model ...
Epoch: 27 cost time: 0.7603843212127686
Epoch: 27, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.543 Vali Acc: 0.192 Test Loss: 3.543 Test Acc: 0.192
Validation loss decreased (-0.183494 --> -0.191729).  Saving model ...
Epoch: 28 cost time: 0.6976802349090576
Epoch: 28, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.588 Vali Acc: 0.193 Test Loss: 3.588 Test Acc: 0.193
Validation loss decreased (-0.191729 --> -0.192905).  Saving model ...
Epoch: 29 cost time: 0.6628603935241699
Epoch: 29, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.658 Vali Acc: 0.200 Test Loss: 3.658 Test Acc: 0.200
Validation loss decreased (-0.192905 --> -0.199963).  Saving model ...
Epoch: 30 cost time: 0.7034966945648193
Epoch: 30, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.732 Vali Acc: 0.202 Test Loss: 3.732 Test Acc: 0.202
Validation loss decreased (-0.199963 --> -0.202316).  Saving model ...
Epoch: 31 cost time: 0.7818734645843506
Epoch: 31, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.800 Vali Acc: 0.200 Test Loss: 3.800 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8039791584014893
Epoch: 32, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.858 Vali Acc: 0.208 Test Loss: 3.858 Test Acc: 0.208
Validation loss decreased (-0.202316 --> -0.208197).  Saving model ...
Epoch: 33 cost time: 0.7844438552856445
Epoch: 33, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.941 Vali Acc: 0.205 Test Loss: 3.941 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6549069881439209
Epoch: 34, Steps: 10 | Train Loss: 0.312 Vali Loss: 4.051 Vali Acc: 0.208 Test Loss: 4.051 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.901989221572876
Epoch: 35, Steps: 10 | Train Loss: 0.292 Vali Loss: 4.168 Vali Acc: 0.202 Test Loss: 4.168 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6284193992614746
Epoch: 36, Steps: 10 | Train Loss: 0.246 Vali Loss: 4.217 Vali Acc: 0.208 Test Loss: 4.217 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9175407886505127
Epoch: 37, Steps: 10 | Train Loss: 0.209 Vali Loss: 4.325 Vali Acc: 0.211 Test Loss: 4.325 Test Acc: 0.211
Validation loss decreased (-0.208197 --> -0.210545).  Saving model ...
Epoch: 38 cost time: 0.7091703414916992
Epoch: 38, Steps: 10 | Train Loss: 0.177 Vali Loss: 4.404 Vali Acc: 0.219 Test Loss: 4.404 Test Acc: 0.219
Validation loss decreased (-0.210545 --> -0.218779).  Saving model ...
Epoch: 39 cost time: 0.7324085235595703
Epoch: 39, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.506 Vali Acc: 0.219 Test Loss: 4.506 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.765594482421875
Epoch: 40, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.626 Vali Acc: 0.213 Test Loss: 4.626 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8420476913452148
Epoch: 41, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.692 Vali Acc: 0.219 Test Loss: 4.692 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8384974002838135
Epoch: 42, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.788 Vali Acc: 0.212 Test Loss: 4.788 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8215813636779785
Epoch: 43, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.897 Vali Acc: 0.215 Test Loss: 4.897 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6605892181396484
Epoch: 44, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.969 Vali Acc: 0.214 Test Loss: 4.969 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8117382526397705
Epoch: 45, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.047 Vali Acc: 0.213 Test Loss: 5.047 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8808073997497559
Epoch: 46, Steps: 10 | Train Loss: 0.068 Vali Loss: 5.116 Vali Acc: 0.215 Test Loss: 5.116 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7722959518432617
Epoch: 47, Steps: 10 | Train Loss: 0.059 Vali Loss: 5.208 Vali Acc: 0.208 Test Loss: 5.208 Test Acc: 0.208
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7528631687164307
Epoch: 48, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.312 Vali Acc: 0.211 Test Loss: 5.312 Test Acc: 0.211
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2188235294117647
model parameter : 46614
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.634700298309326
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.319 Vali Acc: 0.042 Test Loss: 3.319 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8024992942810059
Epoch: 2, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.308 Vali Acc: 0.051 Test Loss: 3.308 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.5457980632781982
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.293 Vali Acc: 0.052 Test Loss: 3.293 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.6239871978759766
Epoch: 4, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.276 Vali Acc: 0.061 Test Loss: 3.276 Test Acc: 0.061
Validation loss decreased (-0.051732 --> -0.061144).  Saving model ...
Epoch: 5 cost time: 0.8269038200378418
Epoch: 5, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.259 Vali Acc: 0.064 Test Loss: 3.259 Test Acc: 0.064
Validation loss decreased (-0.061144 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.8120179176330566
Epoch: 6, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.244 Vali Acc: 0.073 Test Loss: 3.244 Test Acc: 0.073
Validation loss decreased (-0.063497 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 0.678978443145752
Epoch: 7, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.229 Vali Acc: 0.095 Test Loss: 3.229 Test Acc: 0.095
Validation loss decreased (-0.072909 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.6689987182617188
Epoch: 8, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.215 Vali Acc: 0.104 Test Loss: 3.215 Test Acc: 0.104
Validation loss decreased (-0.095262 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.1703824996948242
Epoch: 9, Steps: 10 | Train Loss: 2.644 Vali Loss: 3.204 Vali Acc: 0.116 Test Loss: 3.204 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116439).  Saving model ...
Epoch: 10 cost time: 0.7426276206970215
Epoch: 10, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.195 Vali Acc: 0.121 Test Loss: 3.195 Test Acc: 0.121
Validation loss decreased (-0.116439 --> -0.121145).  Saving model ...
Epoch: 11 cost time: 0.7249424457550049
Epoch: 11, Steps: 10 | Train Loss: 2.452 Vali Loss: 3.187 Vali Acc: 0.125 Test Loss: 3.187 Test Acc: 0.125
Validation loss decreased (-0.121145 --> -0.124674).  Saving model ...
Epoch: 12 cost time: 0.9093825817108154
Epoch: 12, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.184 Vali Acc: 0.127 Test Loss: 3.184 Test Acc: 0.127
Validation loss decreased (-0.124674 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 0.6522846221923828
Epoch: 13, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.184 Vali Acc: 0.133 Test Loss: 3.184 Test Acc: 0.133
Validation loss decreased (-0.127027 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 1.0087013244628906
Epoch: 14, Steps: 10 | Train Loss: 2.140 Vali Loss: 3.189 Vali Acc: 0.139 Test Loss: 3.189 Test Acc: 0.139
Validation loss decreased (-0.132909 --> -0.138792).  Saving model ...
Epoch: 15 cost time: 1.0588326454162598
Epoch: 15, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.196 Vali Acc: 0.140 Test Loss: 3.196 Test Acc: 0.140
Validation loss decreased (-0.138792 --> -0.139968).  Saving model ...
Epoch: 16 cost time: 0.8508608341217041
Epoch: 16, Steps: 10 | Train Loss: 1.915 Vali Loss: 3.205 Vali Acc: 0.145 Test Loss: 3.205 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144674).  Saving model ...
Epoch: 17 cost time: 0.8248655796051025
Epoch: 17, Steps: 10 | Train Loss: 1.761 Vali Loss: 3.212 Vali Acc: 0.153 Test Loss: 3.212 Test Acc: 0.153
Validation loss decreased (-0.144674 --> -0.152909).  Saving model ...
Epoch: 18 cost time: 0.9452931880950928
Epoch: 18, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.229 Vali Acc: 0.160 Test Loss: 3.229 Test Acc: 0.160
Validation loss decreased (-0.152909 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 0.8447897434234619
Epoch: 19, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.251 Vali Acc: 0.166 Test Loss: 3.251 Test Acc: 0.166
Validation loss decreased (-0.159968 --> -0.165850).  Saving model ...
Epoch: 20 cost time: 1.084583044052124
Epoch: 20, Steps: 10 | Train Loss: 1.506 Vali Loss: 3.271 Vali Acc: 0.169 Test Loss: 3.271 Test Acc: 0.169
Validation loss decreased (-0.165850 --> -0.169379).  Saving model ...
Epoch: 21 cost time: 0.7571840286254883
Epoch: 21, Steps: 10 | Train Loss: 1.370 Vali Loss: 3.293 Vali Acc: 0.176 Test Loss: 3.293 Test Acc: 0.176
Validation loss decreased (-0.169379 --> -0.176438).  Saving model ...
Epoch: 22 cost time: 0.6931917667388916
Epoch: 22, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.325 Vali Acc: 0.186 Test Loss: 3.325 Test Acc: 0.186
Validation loss decreased (-0.176438 --> -0.185849).  Saving model ...
Epoch: 23 cost time: 0.8284182548522949
Epoch: 23, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.369 Vali Acc: 0.187 Test Loss: 3.369 Test Acc: 0.187
Validation loss decreased (-0.185849 --> -0.187025).  Saving model ...
Epoch: 24 cost time: 0.8440499305725098
Epoch: 24, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.422 Vali Acc: 0.193 Test Loss: 3.422 Test Acc: 0.193
Validation loss decreased (-0.187025 --> -0.192907).  Saving model ...
Epoch: 25 cost time: 0.7616479396820068
Epoch: 25, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.473 Vali Acc: 0.191 Test Loss: 3.473 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.741055965423584
Epoch: 26, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.538 Vali Acc: 0.188 Test Loss: 3.538 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.785672664642334
Epoch: 27, Steps: 10 | Train Loss: 0.858 Vali Loss: 3.603 Vali Acc: 0.187 Test Loss: 3.603 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9773087501525879
Epoch: 28, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.672 Vali Acc: 0.188 Test Loss: 3.672 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7832469940185547
Epoch: 29, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.751 Vali Acc: 0.187 Test Loss: 3.751 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9144937992095947
Epoch: 30, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.851 Vali Acc: 0.187 Test Loss: 3.851 Test Acc: 0.187
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7481124401092529
Epoch: 31, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.925 Vali Acc: 0.187 Test Loss: 3.925 Test Acc: 0.187
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7971069812774658
Epoch: 32, Steps: 10 | Train Loss: 0.512 Vali Loss: 4.017 Vali Acc: 0.192 Test Loss: 4.017 Test Acc: 0.192
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9328513145446777
Epoch: 33, Steps: 10 | Train Loss: 0.455 Vali Loss: 4.118 Vali Acc: 0.189 Test Loss: 4.118 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7808775901794434
Epoch: 34, Steps: 10 | Train Loss: 0.419 Vali Loss: 4.231 Vali Acc: 0.193 Test Loss: 4.231 Test Acc: 0.193
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.19294117647058823
model parameter : 46472
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.307115077972412
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.305 Vali Acc: 0.034 Test Loss: 3.305 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.7801620960235596
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.294 Vali Acc: 0.040 Test Loss: 3.294 Test Acc: 0.040
Validation loss decreased (-0.034085 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.8193130493164062
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.281 Vali Acc: 0.040 Test Loss: 3.281 Test Acc: 0.040
Validation loss decreased (-0.039967 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 0.8114550113677979
Epoch: 4, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.266 Vali Acc: 0.048 Test Loss: 3.266 Test Acc: 0.048
Validation loss decreased (-0.039967 --> -0.048203).  Saving model ...
Epoch: 5 cost time: 1.1018764972686768
Epoch: 5, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.253 Vali Acc: 0.056 Test Loss: 3.253 Test Acc: 0.056
Validation loss decreased (-0.048203 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 0.8309895992279053
Epoch: 6, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.241 Vali Acc: 0.066 Test Loss: 3.241 Test Acc: 0.066
Validation loss decreased (-0.056438 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 0.6912822723388672
Epoch: 7, Steps: 10 | Train Loss: 2.868 Vali Loss: 3.230 Vali Acc: 0.074 Test Loss: 3.230 Test Acc: 0.074
Validation loss decreased (-0.065850 --> -0.074085).  Saving model ...
Epoch: 8 cost time: 0.9651134014129639
Epoch: 8, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.220 Vali Acc: 0.087 Test Loss: 3.220 Test Acc: 0.087
Validation loss decreased (-0.074085 --> -0.087027).  Saving model ...
Epoch: 9 cost time: 0.7967433929443359
Epoch: 9, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.212 Vali Acc: 0.106 Test Loss: 3.212 Test Acc: 0.106
Validation loss decreased (-0.087027 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 0.9632251262664795
Epoch: 10, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.207 Vali Acc: 0.116 Test Loss: 3.207 Test Acc: 0.116
Validation loss decreased (-0.105850 --> -0.116439).  Saving model ...
Epoch: 11 cost time: 0.7309250831604004
Epoch: 11, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.204 Vali Acc: 0.121 Test Loss: 3.204 Test Acc: 0.121
Validation loss decreased (-0.116439 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 0.7873697280883789
Epoch: 12, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.205 Vali Acc: 0.126 Test Loss: 3.205 Test Acc: 0.126
Validation loss decreased (-0.121144 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.9066555500030518
Epoch: 13, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.202 Vali Acc: 0.133 Test Loss: 3.202 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.7962825298309326
Epoch: 14, Steps: 10 | Train Loss: 2.163 Vali Loss: 3.206 Vali Acc: 0.133 Test Loss: 3.206 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8116607666015625
Epoch: 15, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.208 Vali Acc: 0.140 Test Loss: 3.208 Test Acc: 0.140
Validation loss decreased (-0.132909 --> -0.139968).  Saving model ...
Epoch: 16 cost time: 0.7586681842803955
Epoch: 16, Steps: 10 | Train Loss: 1.936 Vali Loss: 3.206 Vali Acc: 0.148 Test Loss: 3.206 Test Acc: 0.148
Validation loss decreased (-0.139968 --> -0.148203).  Saving model ...
Epoch: 17 cost time: 0.7563657760620117
Epoch: 17, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.208 Vali Acc: 0.149 Test Loss: 3.208 Test Acc: 0.149
Validation loss decreased (-0.148203 --> -0.149380).  Saving model ...
Epoch: 18 cost time: 0.9378437995910645
Epoch: 18, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.217 Vali Acc: 0.158 Test Loss: 3.217 Test Acc: 0.158
Validation loss decreased (-0.149380 --> -0.157615).  Saving model ...
Epoch: 19 cost time: 0.7611682415008545
Epoch: 19, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.227 Vali Acc: 0.166 Test Loss: 3.227 Test Acc: 0.166
Validation loss decreased (-0.157615 --> -0.165850).  Saving model ...
Epoch: 20 cost time: 0.7103493213653564
Epoch: 20, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.242 Vali Acc: 0.169 Test Loss: 3.242 Test Acc: 0.169
Validation loss decreased (-0.165850 --> -0.169379).  Saving model ...
Epoch: 21 cost time: 0.8191661834716797
Epoch: 21, Steps: 10 | Train Loss: 1.431 Vali Loss: 3.264 Vali Acc: 0.172 Test Loss: 3.264 Test Acc: 0.172
Validation loss decreased (-0.169379 --> -0.171732).  Saving model ...
Epoch: 22 cost time: 0.8741483688354492
Epoch: 22, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.274 Vali Acc: 0.182 Test Loss: 3.274 Test Acc: 0.182
Validation loss decreased (-0.171732 --> -0.182320).  Saving model ...
Epoch: 23 cost time: 0.9026603698730469
Epoch: 23, Steps: 10 | Train Loss: 1.226 Vali Loss: 3.291 Vali Acc: 0.188 Test Loss: 3.291 Test Acc: 0.188
Validation loss decreased (-0.182320 --> -0.188202).  Saving model ...
Epoch: 24 cost time: 0.9819073677062988
Epoch: 24, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.310 Vali Acc: 0.193 Test Loss: 3.310 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 25 cost time: 1.1540946960449219
Epoch: 25, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.331 Vali Acc: 0.194 Test Loss: 3.331 Test Acc: 0.194
Validation loss decreased (-0.192908 --> -0.194084).  Saving model ...
Epoch: 26 cost time: 1.0506911277770996
Epoch: 26, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.362 Vali Acc: 0.195 Test Loss: 3.362 Test Acc: 0.195
Validation loss decreased (-0.194084 --> -0.195260).  Saving model ...
Epoch: 27 cost time: 0.8558721542358398
Epoch: 27, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.387 Vali Acc: 0.201 Test Loss: 3.387 Test Acc: 0.201
Validation loss decreased (-0.195260 --> -0.201143).  Saving model ...
Epoch: 28 cost time: 0.8707454204559326
Epoch: 28, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.422 Vali Acc: 0.208 Test Loss: 3.422 Test Acc: 0.208
Validation loss decreased (-0.201143 --> -0.208201).  Saving model ...
Epoch: 29 cost time: 0.8178818225860596
Epoch: 29, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.470 Vali Acc: 0.212 Test Loss: 3.470 Test Acc: 0.212
Validation loss decreased (-0.208201 --> -0.211730).  Saving model ...
Epoch: 30 cost time: 0.8177895545959473
Epoch: 30, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.528 Vali Acc: 0.219 Test Loss: 3.528 Test Acc: 0.219
Validation loss decreased (-0.211730 --> -0.218788).  Saving model ...
Epoch: 31 cost time: 0.6758840084075928
Epoch: 31, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.557 Vali Acc: 0.224 Test Loss: 3.557 Test Acc: 0.224
Validation loss decreased (-0.218788 --> -0.223494).  Saving model ...
Epoch: 32 cost time: 0.7366030216217041
Epoch: 32, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.620 Vali Acc: 0.219 Test Loss: 3.620 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8266088962554932
Epoch: 33, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.699 Vali Acc: 0.226 Test Loss: 3.699 Test Acc: 0.226
Validation loss decreased (-0.223494 --> -0.225845).  Saving model ...
Epoch: 34 cost time: 0.8248701095581055
Epoch: 34, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.765 Vali Acc: 0.228 Test Loss: 3.765 Test Acc: 0.228
Validation loss decreased (-0.225845 --> -0.228198).  Saving model ...
Epoch: 35 cost time: 0.7421205043792725
Epoch: 35, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.852 Vali Acc: 0.231 Test Loss: 3.852 Test Acc: 0.231
Validation loss decreased (-0.228198 --> -0.230550).  Saving model ...
Epoch: 36 cost time: 1.1119742393493652
Epoch: 36, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.958 Vali Acc: 0.225 Test Loss: 3.958 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8600866794586182
Epoch: 37, Steps: 10 | Train Loss: 0.245 Vali Loss: 4.048 Vali Acc: 0.232 Test Loss: 4.048 Test Acc: 0.232
Validation loss decreased (-0.230550 --> -0.231724).  Saving model ...
Epoch: 38 cost time: 0.8111646175384521
Epoch: 38, Steps: 10 | Train Loss: 0.216 Vali Loss: 4.121 Vali Acc: 0.231 Test Loss: 4.121 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9457483291625977
Epoch: 39, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.218 Vali Acc: 0.232 Test Loss: 4.218 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1162807941436768
Epoch: 40, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.357 Vali Acc: 0.233 Test Loss: 4.357 Test Acc: 0.233
Validation loss decreased (-0.231724 --> -0.232898).  Saving model ...
Epoch: 41 cost time: 0.8003051280975342
Epoch: 41, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.433 Vali Acc: 0.229 Test Loss: 4.433 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7729711532592773
Epoch: 42, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.567 Vali Acc: 0.227 Test Loss: 4.567 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8462145328521729
Epoch: 43, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.665 Vali Acc: 0.233 Test Loss: 4.665 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8933682441711426
Epoch: 44, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.809 Vali Acc: 0.232 Test Loss: 4.809 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0041828155517578
Epoch: 45, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.883 Vali Acc: 0.233 Test Loss: 4.883 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6637609004974365
Epoch: 46, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.989 Vali Acc: 0.228 Test Loss: 4.989 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6300718784332275
Epoch: 47, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.110 Vali Acc: 0.229 Test Loss: 5.110 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8351247310638428
Epoch: 48, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.229 Vali Acc: 0.229 Test Loss: 5.229 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8763768672943115
Epoch: 49, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.390 Vali Acc: 0.232 Test Loss: 5.390 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6738266944885254
Epoch: 50, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.482 Vali Acc: 0.228 Test Loss: 5.482 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23294117647058823
model parameter : 45942
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3065149784088135
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.321 Vali Acc: 0.045 Test Loss: 3.321 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.914635181427002
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.308 Vali Acc: 0.053 Test Loss: 3.308 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.7759628295898438
Epoch: 3, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.294 Vali Acc: 0.060 Test Loss: 3.294 Test Acc: 0.060
Validation loss decreased (-0.052908 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.8846771717071533
Epoch: 4, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.278 Vali Acc: 0.069 Test Loss: 3.278 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 5 cost time: 0.9265408515930176
Epoch: 5, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.263 Vali Acc: 0.076 Test Loss: 3.263 Test Acc: 0.076
Validation loss decreased (-0.069379 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.5902369022369385
Epoch: 6, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.249 Vali Acc: 0.085 Test Loss: 3.249 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 0.6677699089050293
Epoch: 7, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.239 Vali Acc: 0.085 Test Loss: 3.239 Test Acc: 0.085
Validation loss decreased (-0.084673 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.6451559066772461
Epoch: 8, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.230 Vali Acc: 0.093 Test Loss: 3.230 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.9176506996154785
Epoch: 9, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.223 Vali Acc: 0.104 Test Loss: 3.223 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 10 cost time: 0.6325342655181885
Epoch: 10, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.217 Vali Acc: 0.112 Test Loss: 3.217 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111733).  Saving model ...
Epoch: 11 cost time: 0.9029605388641357
Epoch: 11, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.214 Vali Acc: 0.119 Test Loss: 3.214 Test Acc: 0.119
Validation loss decreased (-0.111733 --> -0.118791).  Saving model ...
Epoch: 12 cost time: 0.6846940517425537
Epoch: 12, Steps: 10 | Train Loss: 2.376 Vali Loss: 3.211 Vali Acc: 0.129 Test Loss: 3.211 Test Acc: 0.129
Validation loss decreased (-0.118791 --> -0.129380).  Saving model ...
Epoch: 13 cost time: 0.5834639072418213
Epoch: 13, Steps: 10 | Train Loss: 2.273 Vali Loss: 3.210 Vali Acc: 0.135 Test Loss: 3.210 Test Acc: 0.135
Validation loss decreased (-0.129380 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 0.6611328125
Epoch: 14, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.216 Vali Acc: 0.139 Test Loss: 3.216 Test Acc: 0.139
Validation loss decreased (-0.135262 --> -0.138791).  Saving model ...
Epoch: 15 cost time: 0.6700406074523926
Epoch: 15, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.222 Vali Acc: 0.140 Test Loss: 3.222 Test Acc: 0.140
Validation loss decreased (-0.138791 --> -0.139968).  Saving model ...
Epoch: 16 cost time: 0.8387675285339355
Epoch: 16, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.225 Vali Acc: 0.144 Test Loss: 3.225 Test Acc: 0.144
Validation loss decreased (-0.139968 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 0.6642100811004639
Epoch: 17, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.234 Vali Acc: 0.151 Test Loss: 3.234 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.8195786476135254
Epoch: 18, Steps: 10 | Train Loss: 1.776 Vali Loss: 3.246 Vali Acc: 0.152 Test Loss: 3.246 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151732).  Saving model ...
Epoch: 19 cost time: 0.7433500289916992
Epoch: 19, Steps: 10 | Train Loss: 1.652 Vali Loss: 3.257 Vali Acc: 0.158 Test Loss: 3.257 Test Acc: 0.158
Validation loss decreased (-0.151732 --> -0.157614).  Saving model ...
Epoch: 20 cost time: 0.7347416877746582
Epoch: 20, Steps: 10 | Train Loss: 1.561 Vali Loss: 3.273 Vali Acc: 0.166 Test Loss: 3.273 Test Acc: 0.166
Validation loss decreased (-0.157614 --> -0.165850).  Saving model ...
Epoch: 21 cost time: 0.9099123477935791
Epoch: 21, Steps: 10 | Train Loss: 1.435 Vali Loss: 3.290 Vali Acc: 0.174 Test Loss: 3.290 Test Acc: 0.174
Validation loss decreased (-0.165850 --> -0.174085).  Saving model ...
Epoch: 22 cost time: 0.7192180156707764
Epoch: 22, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.311 Vali Acc: 0.176 Test Loss: 3.311 Test Acc: 0.176
Validation loss decreased (-0.174085 --> -0.176437).  Saving model ...
Epoch: 23 cost time: 0.8539142608642578
Epoch: 23, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.337 Vali Acc: 0.179 Test Loss: 3.337 Test Acc: 0.179
Validation loss decreased (-0.176437 --> -0.178790).  Saving model ...
Epoch: 24 cost time: 0.7601344585418701
Epoch: 24, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.369 Vali Acc: 0.180 Test Loss: 3.369 Test Acc: 0.180
Validation loss decreased (-0.178790 --> -0.179966).  Saving model ...
Epoch: 25 cost time: 0.7161111831665039
Epoch: 25, Steps: 10 | Train Loss: 1.094 Vali Loss: 3.397 Vali Acc: 0.191 Test Loss: 3.397 Test Acc: 0.191
Validation loss decreased (-0.179966 --> -0.190554).  Saving model ...
Epoch: 26 cost time: 0.6850311756134033
Epoch: 26, Steps: 10 | Train Loss: 1.034 Vali Loss: 3.431 Vali Acc: 0.195 Test Loss: 3.431 Test Acc: 0.195
Validation loss decreased (-0.190554 --> -0.195260).  Saving model ...
Epoch: 27 cost time: 0.7458252906799316
Epoch: 27, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.466 Vali Acc: 0.198 Test Loss: 3.466 Test Acc: 0.198
Validation loss decreased (-0.195260 --> -0.197612).  Saving model ...
Epoch: 28 cost time: 0.8516862392425537
Epoch: 28, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.500 Vali Acc: 0.205 Test Loss: 3.500 Test Acc: 0.205
Validation loss decreased (-0.197612 --> -0.204671).  Saving model ...
Epoch: 29 cost time: 0.9514555931091309
Epoch: 29, Steps: 10 | Train Loss: 0.789 Vali Loss: 3.538 Vali Acc: 0.206 Test Loss: 3.538 Test Acc: 0.206
Validation loss decreased (-0.204671 --> -0.205847).  Saving model ...
Epoch: 30 cost time: 0.752155065536499
Epoch: 30, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.589 Vali Acc: 0.207 Test Loss: 3.589 Test Acc: 0.207
Validation loss decreased (-0.205847 --> -0.207023).  Saving model ...
Epoch: 31 cost time: 1.0727770328521729
Epoch: 31, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.656 Vali Acc: 0.196 Test Loss: 3.656 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6955878734588623
Epoch: 32, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.708 Vali Acc: 0.201 Test Loss: 3.708 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.709989070892334
Epoch: 33, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.775 Vali Acc: 0.201 Test Loss: 3.775 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7164890766143799
Epoch: 34, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.827 Vali Acc: 0.196 Test Loss: 3.827 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8466370105743408
Epoch: 35, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.900 Vali Acc: 0.198 Test Loss: 3.900 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7125382423400879
Epoch: 36, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.975 Vali Acc: 0.196 Test Loss: 3.975 Test Acc: 0.196
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7543728351593018
Epoch: 37, Steps: 10 | Train Loss: 0.370 Vali Loss: 4.060 Vali Acc: 0.198 Test Loss: 4.060 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9280624389648438
Epoch: 38, Steps: 10 | Train Loss: 0.312 Vali Loss: 4.128 Vali Acc: 0.195 Test Loss: 4.128 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7331609725952148
Epoch: 39, Steps: 10 | Train Loss: 0.279 Vali Loss: 4.214 Vali Acc: 0.199 Test Loss: 4.214 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.670403242111206
Epoch: 40, Steps: 10 | Train Loss: 0.239 Vali Loss: 4.314 Vali Acc: 0.194 Test Loss: 4.314 Test Acc: 0.194
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20705882352941177
model parameter : 45480
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.107450485229492
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.297 Vali Acc: 0.053 Test Loss: 3.297 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.6333978176116943
Epoch: 2, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.287 Vali Acc: 0.054 Test Loss: 3.287 Test Acc: 0.054
Validation loss decreased (-0.052908 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.6019458770751953
Epoch: 3, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.273 Vali Acc: 0.061 Test Loss: 3.273 Test Acc: 0.061
Validation loss decreased (-0.054085 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.0733561515808105
Epoch: 4, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.259 Vali Acc: 0.066 Test Loss: 3.259 Test Acc: 0.066
Validation loss decreased (-0.061144 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 0.7991719245910645
Epoch: 5, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.245 Vali Acc: 0.067 Test Loss: 3.245 Test Acc: 0.067
Validation loss decreased (-0.065850 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.5936765670776367
Epoch: 6, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.233 Vali Acc: 0.076 Test Loss: 3.233 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.7219681739807129
Epoch: 7, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.223 Vali Acc: 0.082 Test Loss: 3.223 Test Acc: 0.082
Validation loss decreased (-0.076438 --> -0.082321).  Saving model ...
Epoch: 8 cost time: 0.9693484306335449
Epoch: 8, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.214 Vali Acc: 0.102 Test Loss: 3.214 Test Acc: 0.102
Validation loss decreased (-0.082321 --> -0.102321).  Saving model ...
Epoch: 9 cost time: 0.5781919956207275
Epoch: 9, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.207 Vali Acc: 0.111 Test Loss: 3.207 Test Acc: 0.111
Validation loss decreased (-0.102321 --> -0.110556).  Saving model ...
Epoch: 10 cost time: 0.7141196727752686
Epoch: 10, Steps: 10 | Train Loss: 2.605 Vali Loss: 3.203 Vali Acc: 0.119 Test Loss: 3.203 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118792).  Saving model ...
Epoch: 11 cost time: 0.6713969707489014
Epoch: 11, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.198 Vali Acc: 0.128 Test Loss: 3.198 Test Acc: 0.128
Validation loss decreased (-0.118792 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 0.720473051071167
Epoch: 12, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.197 Vali Acc: 0.131 Test Loss: 3.197 Test Acc: 0.131
Validation loss decreased (-0.128203 --> -0.130556).  Saving model ...
Epoch: 13 cost time: 0.6195032596588135
Epoch: 13, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.198 Vali Acc: 0.135 Test Loss: 3.198 Test Acc: 0.135
Validation loss decreased (-0.130556 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 0.6193463802337646
Epoch: 14, Steps: 10 | Train Loss: 2.180 Vali Loss: 3.201 Vali Acc: 0.139 Test Loss: 3.201 Test Acc: 0.139
Validation loss decreased (-0.135262 --> -0.138792).  Saving model ...
Epoch: 15 cost time: 0.8770463466644287
Epoch: 15, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.206 Vali Acc: 0.147 Test Loss: 3.206 Test Acc: 0.147
Validation loss decreased (-0.138792 --> -0.147027).  Saving model ...
Epoch: 16 cost time: 0.7540631294250488
Epoch: 16, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.213 Vali Acc: 0.153 Test Loss: 3.213 Test Acc: 0.153
Validation loss decreased (-0.147027 --> -0.152909).  Saving model ...
Epoch: 17 cost time: 0.6085894107818604
Epoch: 17, Steps: 10 | Train Loss: 1.879 Vali Loss: 3.220 Vali Acc: 0.165 Test Loss: 3.220 Test Acc: 0.165
Validation loss decreased (-0.152909 --> -0.164674).  Saving model ...
Epoch: 18 cost time: 0.634171724319458
Epoch: 18, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.234 Vali Acc: 0.171 Test Loss: 3.234 Test Acc: 0.171
Validation loss decreased (-0.164674 --> -0.170556).  Saving model ...
Epoch: 19 cost time: 0.6804089546203613
Epoch: 19, Steps: 10 | Train Loss: 1.664 Vali Loss: 3.245 Vali Acc: 0.175 Test Loss: 3.245 Test Acc: 0.175
Validation loss decreased (-0.170556 --> -0.175262).  Saving model ...
Epoch: 20 cost time: 0.6877315044403076
Epoch: 20, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.262 Vali Acc: 0.175 Test Loss: 3.262 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7106442451477051
Epoch: 21, Steps: 10 | Train Loss: 1.460 Vali Loss: 3.278 Vali Acc: 0.182 Test Loss: 3.278 Test Acc: 0.182
Validation loss decreased (-0.175262 --> -0.182320).  Saving model ...
Epoch: 22 cost time: 0.5927164554595947
Epoch: 22, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.309 Vali Acc: 0.182 Test Loss: 3.309 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7404181957244873
Epoch: 23, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.338 Vali Acc: 0.192 Test Loss: 3.338 Test Acc: 0.192
Validation loss decreased (-0.182320 --> -0.191731).  Saving model ...
Epoch: 24 cost time: 0.6043922901153564
Epoch: 24, Steps: 10 | Train Loss: 1.193 Vali Loss: 3.374 Vali Acc: 0.191 Test Loss: 3.374 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7108187675476074
Epoch: 25, Steps: 10 | Train Loss: 1.098 Vali Loss: 3.406 Vali Acc: 0.186 Test Loss: 3.406 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7980883121490479
Epoch: 26, Steps: 10 | Train Loss: 1.007 Vali Loss: 3.449 Vali Acc: 0.201 Test Loss: 3.449 Test Acc: 0.201
Validation loss decreased (-0.191731 --> -0.201142).  Saving model ...
Epoch: 27 cost time: 0.8874495029449463
Epoch: 27, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.505 Vali Acc: 0.209 Test Loss: 3.505 Test Acc: 0.209
Validation loss decreased (-0.201142 --> -0.209377).  Saving model ...
Epoch: 28 cost time: 0.7222716808319092
Epoch: 28, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.572 Vali Acc: 0.200 Test Loss: 3.572 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6918811798095703
Epoch: 29, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.629 Vali Acc: 0.204 Test Loss: 3.629 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6486353874206543
Epoch: 30, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.715 Vali Acc: 0.193 Test Loss: 3.715 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8020014762878418
Epoch: 31, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.790 Vali Acc: 0.192 Test Loss: 3.790 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7075521945953369
Epoch: 32, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.899 Vali Acc: 0.195 Test Loss: 3.899 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8059935569763184
Epoch: 33, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.979 Vali Acc: 0.198 Test Loss: 3.979 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7930300235748291
Epoch: 34, Steps: 10 | Train Loss: 0.437 Vali Loss: 4.098 Vali Acc: 0.196 Test Loss: 4.098 Test Acc: 0.196
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6195454597473145
Epoch: 35, Steps: 10 | Train Loss: 0.372 Vali Loss: 4.179 Vali Acc: 0.199 Test Loss: 4.179 Test Acc: 0.199
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6478071212768555
Epoch: 36, Steps: 10 | Train Loss: 0.331 Vali Loss: 4.301 Vali Acc: 0.192 Test Loss: 4.301 Test Acc: 0.192
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7967214584350586
Epoch: 37, Steps: 10 | Train Loss: 0.290 Vali Loss: 4.413 Vali Acc: 0.194 Test Loss: 4.413 Test Acc: 0.194
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20941176470588235
model parameter : 45542
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1499321460723877
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.299 Vali Acc: 0.032 Test Loss: 3.299 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.8691167831420898
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.289 Vali Acc: 0.036 Test Loss: 3.289 Test Acc: 0.036
Validation loss decreased (-0.031732 --> -0.036438).  Saving model ...
Epoch: 3 cost time: 0.7276654243469238
Epoch: 3, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.277 Vali Acc: 0.039 Test Loss: 3.277 Test Acc: 0.039
Validation loss decreased (-0.036438 --> -0.038791).  Saving model ...
Epoch: 4 cost time: 0.7292747497558594
Epoch: 4, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.264 Vali Acc: 0.046 Test Loss: 3.264 Test Acc: 0.046
Validation loss decreased (-0.038791 --> -0.045850).  Saving model ...
Epoch: 5 cost time: 0.7683274745941162
Epoch: 5, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.252 Vali Acc: 0.054 Test Loss: 3.252 Test Acc: 0.054
Validation loss decreased (-0.045850 --> -0.054085).  Saving model ...
Epoch: 6 cost time: 0.6303422451019287
Epoch: 6, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.241 Vali Acc: 0.061 Test Loss: 3.241 Test Acc: 0.061
Validation loss decreased (-0.054085 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 0.6173555850982666
Epoch: 7, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.231 Vali Acc: 0.066 Test Loss: 3.231 Test Acc: 0.066
Validation loss decreased (-0.061144 --> -0.065850).  Saving model ...
Epoch: 8 cost time: 0.6791603565216064
Epoch: 8, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.223 Vali Acc: 0.076 Test Loss: 3.223 Test Acc: 0.076
Validation loss decreased (-0.065850 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 0.6601080894470215
Epoch: 9, Steps: 10 | Train Loss: 2.684 Vali Loss: 3.217 Vali Acc: 0.085 Test Loss: 3.217 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084674).  Saving model ...
Epoch: 10 cost time: 0.5903341770172119
Epoch: 10, Steps: 10 | Train Loss: 2.600 Vali Loss: 3.216 Vali Acc: 0.095 Test Loss: 3.216 Test Acc: 0.095
Validation loss decreased (-0.084674 --> -0.095262).  Saving model ...
Epoch: 11 cost time: 0.7999606132507324
Epoch: 11, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.211 Vali Acc: 0.106 Test Loss: 3.211 Test Acc: 0.106
Validation loss decreased (-0.095262 --> -0.105850).  Saving model ...
Epoch: 12 cost time: 0.7084343433380127
Epoch: 12, Steps: 10 | Train Loss: 2.378 Vali Loss: 3.210 Vali Acc: 0.114 Test Loss: 3.210 Test Acc: 0.114
Validation loss decreased (-0.105850 --> -0.114086).  Saving model ...
Epoch: 13 cost time: 0.7868907451629639
Epoch: 13, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.211 Vali Acc: 0.118 Test Loss: 3.211 Test Acc: 0.118
Validation loss decreased (-0.114086 --> -0.117615).  Saving model ...
Epoch: 14 cost time: 0.8160562515258789
Epoch: 14, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.211 Vali Acc: 0.120 Test Loss: 3.211 Test Acc: 0.120
Validation loss decreased (-0.117615 --> -0.119968).  Saving model ...
Epoch: 15 cost time: 0.6234641075134277
Epoch: 15, Steps: 10 | Train Loss: 2.048 Vali Loss: 3.217 Vali Acc: 0.126 Test Loss: 3.217 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 16 cost time: 0.7138464450836182
Epoch: 16, Steps: 10 | Train Loss: 1.960 Vali Loss: 3.223 Vali Acc: 0.135 Test Loss: 3.223 Test Acc: 0.135
Validation loss decreased (-0.125850 --> -0.135262).  Saving model ...
Epoch: 17 cost time: 0.8064723014831543
Epoch: 17, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.233 Vali Acc: 0.136 Test Loss: 3.233 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136438).  Saving model ...
Epoch: 18 cost time: 0.6422078609466553
Epoch: 18, Steps: 10 | Train Loss: 1.803 Vali Loss: 3.248 Vali Acc: 0.138 Test Loss: 3.248 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137615).  Saving model ...
Epoch: 19 cost time: 0.6086544990539551
Epoch: 19, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.262 Vali Acc: 0.138 Test Loss: 3.262 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6757903099060059
Epoch: 20, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.279 Vali Acc: 0.148 Test Loss: 3.279 Test Acc: 0.148
Validation loss decreased (-0.137615 --> -0.148203).  Saving model ...
Epoch: 21 cost time: 0.887559175491333
Epoch: 21, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.305 Vali Acc: 0.153 Test Loss: 3.305 Test Acc: 0.153
Validation loss decreased (-0.148203 --> -0.152908).  Saving model ...
Epoch: 22 cost time: 0.8239924907684326
Epoch: 22, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.334 Vali Acc: 0.158 Test Loss: 3.334 Test Acc: 0.158
Validation loss decreased (-0.152908 --> -0.157614).  Saving model ...
Epoch: 23 cost time: 0.7261040210723877
Epoch: 23, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.374 Vali Acc: 0.169 Test Loss: 3.374 Test Acc: 0.169
Validation loss decreased (-0.157614 --> -0.169378).  Saving model ...
Epoch: 24 cost time: 0.8380377292633057
Epoch: 24, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.411 Vali Acc: 0.178 Test Loss: 3.411 Test Acc: 0.178
Validation loss decreased (-0.169378 --> -0.177613).  Saving model ...
Epoch: 25 cost time: 0.7626991271972656
Epoch: 25, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.463 Vali Acc: 0.180 Test Loss: 3.463 Test Acc: 0.180
Validation loss decreased (-0.177613 --> -0.179965).  Saving model ...
Epoch: 26 cost time: 0.7195839881896973
Epoch: 26, Steps: 10 | Train Loss: 0.989 Vali Loss: 3.517 Vali Acc: 0.182 Test Loss: 3.517 Test Acc: 0.182
Validation loss decreased (-0.179965 --> -0.182318).  Saving model ...
Epoch: 27 cost time: 0.8357326984405518
Epoch: 27, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.579 Vali Acc: 0.187 Test Loss: 3.579 Test Acc: 0.187
Validation loss decreased (-0.182318 --> -0.187023).  Saving model ...
Epoch: 28 cost time: 0.6826930046081543
Epoch: 28, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.644 Vali Acc: 0.194 Test Loss: 3.644 Test Acc: 0.194
Validation loss decreased (-0.187023 --> -0.194081).  Saving model ...
Epoch: 29 cost time: 0.600001335144043
Epoch: 29, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.717 Vali Acc: 0.196 Test Loss: 3.717 Test Acc: 0.196
Validation loss decreased (-0.194081 --> -0.196433).  Saving model ...
Epoch: 30 cost time: 0.8660526275634766
Epoch: 30, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.776 Vali Acc: 0.202 Test Loss: 3.776 Test Acc: 0.202
Validation loss decreased (-0.196433 --> -0.202315).  Saving model ...
Epoch: 31 cost time: 0.6027836799621582
Epoch: 31, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.865 Vali Acc: 0.199 Test Loss: 3.865 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6275804042816162
Epoch: 32, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.963 Vali Acc: 0.201 Test Loss: 3.963 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6448569297790527
Epoch: 33, Steps: 10 | Train Loss: 0.481 Vali Loss: 4.042 Vali Acc: 0.207 Test Loss: 4.042 Test Acc: 0.207
Validation loss decreased (-0.202315 --> -0.207018).  Saving model ...
Epoch: 34 cost time: 0.6909317970275879
Epoch: 34, Steps: 10 | Train Loss: 0.435 Vali Loss: 4.164 Vali Acc: 0.200 Test Loss: 4.164 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8089878559112549
Epoch: 35, Steps: 10 | Train Loss: 0.359 Vali Loss: 4.240 Vali Acc: 0.194 Test Loss: 4.240 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6660594940185547
Epoch: 36, Steps: 10 | Train Loss: 0.331 Vali Loss: 4.320 Vali Acc: 0.205 Test Loss: 4.320 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6848692893981934
Epoch: 37, Steps: 10 | Train Loss: 0.285 Vali Loss: 4.487 Vali Acc: 0.202 Test Loss: 4.487 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7267940044403076
Epoch: 38, Steps: 10 | Train Loss: 0.239 Vali Loss: 4.567 Vali Acc: 0.205 Test Loss: 4.567 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6707606315612793
Epoch: 39, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.720 Vali Acc: 0.209 Test Loss: 4.720 Test Acc: 0.209
Validation loss decreased (-0.207018 --> -0.209365).  Saving model ...
Epoch: 40 cost time: 0.6799402236938477
Epoch: 40, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.864 Vali Acc: 0.206 Test Loss: 4.864 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8426513671875
Epoch: 41, Steps: 10 | Train Loss: 0.151 Vali Loss: 5.004 Vali Acc: 0.204 Test Loss: 5.004 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8126704692840576
Epoch: 42, Steps: 10 | Train Loss: 0.135 Vali Loss: 5.126 Vali Acc: 0.206 Test Loss: 5.126 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8375370502471924
Epoch: 43, Steps: 10 | Train Loss: 0.113 Vali Loss: 5.216 Vali Acc: 0.212 Test Loss: 5.216 Test Acc: 0.212
Validation loss decreased (-0.209365 --> -0.211713).  Saving model ...
Epoch: 44 cost time: 0.8685574531555176
Epoch: 44, Steps: 10 | Train Loss: 0.095 Vali Loss: 5.379 Vali Acc: 0.207 Test Loss: 5.379 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.725834846496582
Epoch: 45, Steps: 10 | Train Loss: 0.085 Vali Loss: 5.516 Vali Acc: 0.206 Test Loss: 5.516 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8003978729248047
Epoch: 46, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.643 Vali Acc: 0.208 Test Loss: 5.643 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7374019622802734
Epoch: 47, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.729 Vali Acc: 0.207 Test Loss: 5.729 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9913935661315918
Epoch: 48, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.893 Vali Acc: 0.209 Test Loss: 5.893 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6610546112060547
Epoch: 49, Steps: 10 | Train Loss: 0.050 Vali Loss: 6.082 Vali Acc: 0.211 Test Loss: 6.082 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.66168212890625
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 6.117 Vali Acc: 0.213 Test Loss: 6.117 Test Acc: 0.213
Validation loss decreased (-0.211713 --> -0.212880).  Saving model ...
Epoch: 51 cost time: 0.7021908760070801
Epoch: 51, Steps: 10 | Train Loss: 0.041 Vali Loss: 6.199 Vali Acc: 0.209 Test Loss: 6.199 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.72068190574646
Epoch: 52, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.375 Vali Acc: 0.202 Test Loss: 6.375 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6712262630462646
Epoch: 53, Steps: 10 | Train Loss: 0.033 Vali Loss: 6.471 Vali Acc: 0.209 Test Loss: 6.471 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6378819942474365
Epoch: 54, Steps: 10 | Train Loss: 0.029 Vali Loss: 6.558 Vali Acc: 0.212 Test Loss: 6.558 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8297898769378662
Epoch: 55, Steps: 10 | Train Loss: 0.027 Vali Loss: 6.705 Vali Acc: 0.208 Test Loss: 6.705 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6415784358978271
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.803 Vali Acc: 0.207 Test Loss: 6.803 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.7653753757476807
Epoch: 57, Steps: 10 | Train Loss: 0.022 Vali Loss: 6.888 Vali Acc: 0.204 Test Loss: 6.888 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.6320652961730957
Epoch: 58, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.004 Vali Acc: 0.206 Test Loss: 7.004 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.6989805698394775
Epoch: 59, Steps: 10 | Train Loss: 0.019 Vali Loss: 7.088 Vali Acc: 0.206 Test Loss: 7.088 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6448361873626709
Epoch: 60, Steps: 10 | Train Loss: 0.017 Vali Loss: 7.210 Vali Acc: 0.207 Test Loss: 7.210 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21294117647058824
model parameter : 46584
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2505698204040527
Epoch: 1, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.300 Vali Acc: 0.054 Test Loss: 3.300 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.8136749267578125
Epoch: 2, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.289 Vali Acc: 0.062 Test Loss: 3.289 Test Acc: 0.062
Validation loss decreased (-0.054085 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.7597107887268066
Epoch: 3, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.276 Vali Acc: 0.066 Test Loss: 3.276 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065850).  Saving model ...
Epoch: 4 cost time: 0.6752314567565918
Epoch: 4, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.263 Vali Acc: 0.073 Test Loss: 3.263 Test Acc: 0.073
Validation loss decreased (-0.065850 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 0.6606369018554688
Epoch: 5, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.249 Vali Acc: 0.085 Test Loss: 3.249 Test Acc: 0.085
Validation loss decreased (-0.072909 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.7737634181976318
Epoch: 6, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.238 Vali Acc: 0.091 Test Loss: 3.238 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 0.8326401710510254
Epoch: 7, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.228 Vali Acc: 0.099 Test Loss: 3.228 Test Acc: 0.099
Validation loss decreased (-0.090556 --> -0.098791).  Saving model ...
Epoch: 8 cost time: 0.7474451065063477
Epoch: 8, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.221 Vali Acc: 0.106 Test Loss: 3.221 Test Acc: 0.106
Validation loss decreased (-0.098791 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 0.6920311450958252
Epoch: 9, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.215 Vali Acc: 0.113 Test Loss: 3.215 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 0.7502713203430176
Epoch: 10, Steps: 10 | Train Loss: 2.534 Vali Loss: 3.213 Vali Acc: 0.118 Test Loss: 3.213 Test Acc: 0.118
Validation loss decreased (-0.112909 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 0.7014632225036621
Epoch: 11, Steps: 10 | Train Loss: 2.444 Vali Loss: 3.212 Vali Acc: 0.121 Test Loss: 3.212 Test Acc: 0.121
Validation loss decreased (-0.117615 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 0.6763205528259277
Epoch: 12, Steps: 10 | Train Loss: 2.334 Vali Loss: 3.213 Vali Acc: 0.119 Test Loss: 3.213 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.817145824432373
Epoch: 13, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.213 Vali Acc: 0.121 Test Loss: 3.213 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7547147274017334
Epoch: 14, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.214 Vali Acc: 0.129 Test Loss: 3.214 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129380).  Saving model ...
Epoch: 15 cost time: 0.6317174434661865
Epoch: 15, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.219 Vali Acc: 0.134 Test Loss: 3.219 Test Acc: 0.134
Validation loss decreased (-0.129380 --> -0.134085).  Saving model ...
Epoch: 16 cost time: 0.6672701835632324
Epoch: 16, Steps: 10 | Train Loss: 1.959 Vali Loss: 3.231 Vali Acc: 0.142 Test Loss: 3.231 Test Acc: 0.142
Validation loss decreased (-0.134085 --> -0.142321).  Saving model ...
Epoch: 17 cost time: 0.638965368270874
Epoch: 17, Steps: 10 | Train Loss: 1.832 Vali Loss: 3.239 Vali Acc: 0.146 Test Loss: 3.239 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.6903910636901855
Epoch: 18, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.251 Vali Acc: 0.153 Test Loss: 3.251 Test Acc: 0.153
Validation loss decreased (-0.145850 --> -0.152909).  Saving model ...
Epoch: 19 cost time: 0.6432740688323975
Epoch: 19, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.263 Vali Acc: 0.152 Test Loss: 3.263 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8478105068206787
Epoch: 20, Steps: 10 | Train Loss: 1.547 Vali Loss: 3.279 Vali Acc: 0.154 Test Loss: 3.279 Test Acc: 0.154
Validation loss decreased (-0.152909 --> -0.154085).  Saving model ...
Epoch: 21 cost time: 0.7579939365386963
Epoch: 21, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.296 Vali Acc: 0.161 Test Loss: 3.296 Test Acc: 0.161
Validation loss decreased (-0.154085 --> -0.161144).  Saving model ...
Epoch: 22 cost time: 0.5809047222137451
Epoch: 22, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.320 Vali Acc: 0.162 Test Loss: 3.320 Test Acc: 0.162
Validation loss decreased (-0.161144 --> -0.162320).  Saving model ...
Epoch: 23 cost time: 0.7391448020935059
Epoch: 23, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.340 Vali Acc: 0.175 Test Loss: 3.340 Test Acc: 0.175
Validation loss decreased (-0.162320 --> -0.175261).  Saving model ...
Epoch: 24 cost time: 0.8769018650054932
Epoch: 24, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.371 Vali Acc: 0.178 Test Loss: 3.371 Test Acc: 0.178
Validation loss decreased (-0.175261 --> -0.177613).  Saving model ...
Epoch: 25 cost time: 0.741849422454834
Epoch: 25, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.395 Vali Acc: 0.191 Test Loss: 3.395 Test Acc: 0.191
Validation loss decreased (-0.177613 --> -0.190554).  Saving model ...
Epoch: 26 cost time: 0.7696161270141602
Epoch: 26, Steps: 10 | Train Loss: 0.999 Vali Loss: 3.426 Vali Acc: 0.193 Test Loss: 3.426 Test Acc: 0.193
Validation loss decreased (-0.190554 --> -0.192907).  Saving model ...
Epoch: 27 cost time: 0.675264835357666
Epoch: 27, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.462 Vali Acc: 0.199 Test Loss: 3.462 Test Acc: 0.199
Validation loss decreased (-0.192907 --> -0.198789).  Saving model ...
Epoch: 28 cost time: 0.6889066696166992
Epoch: 28, Steps: 10 | Train Loss: 0.889 Vali Loss: 3.501 Vali Acc: 0.195 Test Loss: 3.501 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7691025733947754
Epoch: 29, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.539 Vali Acc: 0.198 Test Loss: 3.539 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6354625225067139
Epoch: 30, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.588 Vali Acc: 0.200 Test Loss: 3.588 Test Acc: 0.200
Validation loss decreased (-0.198789 --> -0.199964).  Saving model ...
Epoch: 31 cost time: 0.7305052280426025
Epoch: 31, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.647 Vali Acc: 0.198 Test Loss: 3.647 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8224043846130371
Epoch: 32, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.705 Vali Acc: 0.193 Test Loss: 3.705 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.628427267074585
Epoch: 33, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.748 Vali Acc: 0.198 Test Loss: 3.748 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6673839092254639
Epoch: 34, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.794 Vali Acc: 0.194 Test Loss: 3.794 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7551515102386475
Epoch: 35, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.864 Vali Acc: 0.213 Test Loss: 3.864 Test Acc: 0.213
Validation loss decreased (-0.199964 --> -0.212903).  Saving model ...
Epoch: 36 cost time: 0.7212350368499756
Epoch: 36, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.930 Vali Acc: 0.207 Test Loss: 3.930 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6219356060028076
Epoch: 37, Steps: 10 | Train Loss: 0.377 Vali Loss: 4.007 Vali Acc: 0.204 Test Loss: 4.007 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6538851261138916
Epoch: 38, Steps: 10 | Train Loss: 0.326 Vali Loss: 4.078 Vali Acc: 0.208 Test Loss: 4.078 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6653680801391602
Epoch: 39, Steps: 10 | Train Loss: 0.280 Vali Loss: 4.144 Vali Acc: 0.209 Test Loss: 4.144 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6982009410858154
Epoch: 40, Steps: 10 | Train Loss: 0.248 Vali Loss: 4.218 Vali Acc: 0.204 Test Loss: 4.218 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7221801280975342
Epoch: 41, Steps: 10 | Train Loss: 0.217 Vali Loss: 4.318 Vali Acc: 0.205 Test Loss: 4.318 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7335050106048584
Epoch: 42, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.404 Vali Acc: 0.200 Test Loss: 4.404 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6637239456176758
Epoch: 43, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.488 Vali Acc: 0.195 Test Loss: 4.488 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6892802715301514
Epoch: 44, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.567 Vali Acc: 0.192 Test Loss: 4.567 Test Acc: 0.192
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7580070495605469
Epoch: 45, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.654 Vali Acc: 0.204 Test Loss: 4.654 Test Acc: 0.204
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21294117647058824
model parameter : 45590
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4461019039154053
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.332 Vali Acc: 0.038 Test Loss: 3.332 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.7462246417999268
Epoch: 2, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.321 Vali Acc: 0.040 Test Loss: 3.321 Test Acc: 0.040
Validation loss decreased (-0.037614 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.5962629318237305
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.307 Vali Acc: 0.044 Test Loss: 3.307 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 0.7914175987243652
Epoch: 4, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.293 Vali Acc: 0.055 Test Loss: 3.293 Test Acc: 0.055
Validation loss decreased (-0.043496 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.7681879997253418
Epoch: 5, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.280 Vali Acc: 0.068 Test Loss: 3.280 Test Acc: 0.068
Validation loss decreased (-0.055261 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 0.7649147510528564
Epoch: 6, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.269 Vali Acc: 0.088 Test Loss: 3.269 Test Acc: 0.088
Validation loss decreased (-0.068202 --> -0.088203).  Saving model ...
Epoch: 7 cost time: 0.6320888996124268
Epoch: 7, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.258 Vali Acc: 0.096 Test Loss: 3.258 Test Acc: 0.096
Validation loss decreased (-0.088203 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 0.7092916965484619
Epoch: 8, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.251 Vali Acc: 0.104 Test Loss: 3.251 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 0.6787900924682617
Epoch: 9, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.246 Vali Acc: 0.113 Test Loss: 3.246 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 0.6949155330657959
Epoch: 10, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.241 Vali Acc: 0.112 Test Loss: 3.241 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7212586402893066
Epoch: 11, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.238 Vali Acc: 0.109 Test Loss: 3.238 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7595844268798828
Epoch: 12, Steps: 10 | Train Loss: 2.378 Vali Loss: 3.239 Vali Acc: 0.122 Test Loss: 3.239 Test Acc: 0.122
Validation loss decreased (-0.112909 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.6666803359985352
Epoch: 13, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.235 Vali Acc: 0.128 Test Loss: 3.235 Test Acc: 0.128
Validation loss decreased (-0.122321 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 0.7011165618896484
Epoch: 14, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.236 Vali Acc: 0.135 Test Loss: 3.236 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 15 cost time: 0.6765086650848389
Epoch: 15, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.242 Vali Acc: 0.144 Test Loss: 3.242 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 0.6884777545928955
Epoch: 16, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.241 Vali Acc: 0.141 Test Loss: 3.241 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7609829902648926
Epoch: 17, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.248 Vali Acc: 0.151 Test Loss: 3.248 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.8787212371826172
Epoch: 18, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.261 Vali Acc: 0.156 Test Loss: 3.261 Test Acc: 0.156
Validation loss decreased (-0.150556 --> -0.156438).  Saving model ...
Epoch: 19 cost time: 0.8177216053009033
Epoch: 19, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.275 Vali Acc: 0.160 Test Loss: 3.275 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159967).  Saving model ...
Epoch: 20 cost time: 0.6759324073791504
Epoch: 20, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.293 Vali Acc: 0.164 Test Loss: 3.293 Test Acc: 0.164
Validation loss decreased (-0.159967 --> -0.163496).  Saving model ...
Epoch: 21 cost time: 0.7018258571624756
Epoch: 21, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.315 Vali Acc: 0.173 Test Loss: 3.315 Test Acc: 0.173
Validation loss decreased (-0.163496 --> -0.172908).  Saving model ...
Epoch: 22 cost time: 0.7688651084899902
Epoch: 22, Steps: 10 | Train Loss: 1.329 Vali Loss: 3.350 Vali Acc: 0.178 Test Loss: 3.350 Test Acc: 0.178
Validation loss decreased (-0.172908 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 0.7600336074829102
Epoch: 23, Steps: 10 | Train Loss: 1.223 Vali Loss: 3.387 Vali Acc: 0.180 Test Loss: 3.387 Test Acc: 0.180
Validation loss decreased (-0.177614 --> -0.179966).  Saving model ...
Epoch: 24 cost time: 0.6991994380950928
Epoch: 24, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.424 Vali Acc: 0.186 Test Loss: 3.424 Test Acc: 0.186
Validation loss decreased (-0.179966 --> -0.185848).  Saving model ...
Epoch: 25 cost time: 0.7300896644592285
Epoch: 25, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.479 Vali Acc: 0.199 Test Loss: 3.479 Test Acc: 0.199
Validation loss decreased (-0.185848 --> -0.198789).  Saving model ...
Epoch: 26 cost time: 0.6622514724731445
Epoch: 26, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.536 Vali Acc: 0.198 Test Loss: 3.536 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6975171566009521
Epoch: 27, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.602 Vali Acc: 0.209 Test Loss: 3.602 Test Acc: 0.209
Validation loss decreased (-0.198789 --> -0.209376).  Saving model ...
Epoch: 28 cost time: 0.6711831092834473
Epoch: 28, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.654 Vali Acc: 0.202 Test Loss: 3.654 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7739803791046143
Epoch: 29, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.697 Vali Acc: 0.206 Test Loss: 3.697 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6529061794281006
Epoch: 30, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.779 Vali Acc: 0.206 Test Loss: 3.779 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7244625091552734
Epoch: 31, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.860 Vali Acc: 0.212 Test Loss: 3.860 Test Acc: 0.212
Validation loss decreased (-0.209376 --> -0.211726).  Saving model ...
Epoch: 32 cost time: 0.7085964679718018
Epoch: 32, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.922 Vali Acc: 0.218 Test Loss: 3.922 Test Acc: 0.218
Validation loss decreased (-0.211726 --> -0.217608).  Saving model ...
Epoch: 33 cost time: 0.7007248401641846
Epoch: 33, Steps: 10 | Train Loss: 0.482 Vali Loss: 4.023 Vali Acc: 0.209 Test Loss: 4.023 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8947963714599609
Epoch: 34, Steps: 10 | Train Loss: 0.437 Vali Loss: 4.131 Vali Acc: 0.218 Test Loss: 4.131 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8369700908660889
Epoch: 35, Steps: 10 | Train Loss: 0.375 Vali Loss: 4.215 Vali Acc: 0.224 Test Loss: 4.215 Test Acc: 0.224
Validation loss decreased (-0.217608 --> -0.223487).  Saving model ...
Epoch: 36 cost time: 0.6762688159942627
Epoch: 36, Steps: 10 | Train Loss: 0.359 Vali Loss: 4.357 Vali Acc: 0.222 Test Loss: 4.357 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6872425079345703
Epoch: 37, Steps: 10 | Train Loss: 0.330 Vali Loss: 4.450 Vali Acc: 0.221 Test Loss: 4.450 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7660441398620605
Epoch: 38, Steps: 10 | Train Loss: 0.262 Vali Loss: 4.589 Vali Acc: 0.224 Test Loss: 4.589 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7973103523254395
Epoch: 39, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.701 Vali Acc: 0.218 Test Loss: 4.701 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7248973846435547
Epoch: 40, Steps: 10 | Train Loss: 0.206 Vali Loss: 4.799 Vali Acc: 0.222 Test Loss: 4.799 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7411770820617676
Epoch: 41, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.944 Vali Acc: 0.219 Test Loss: 4.944 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7894506454467773
Epoch: 42, Steps: 10 | Train Loss: 0.172 Vali Loss: 5.054 Vali Acc: 0.222 Test Loss: 5.054 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7046613693237305
Epoch: 43, Steps: 10 | Train Loss: 0.137 Vali Loss: 5.165 Vali Acc: 0.220 Test Loss: 5.165 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6525511741638184
Epoch: 44, Steps: 10 | Train Loss: 0.120 Vali Loss: 5.258 Vali Acc: 0.224 Test Loss: 5.258 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5930683612823486
Epoch: 45, Steps: 10 | Train Loss: 0.111 Vali Loss: 5.397 Vali Acc: 0.220 Test Loss: 5.397 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 45880
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0844836235046387
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.326 Vali Acc: 0.035 Test Loss: 3.326 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.6223490238189697
Epoch: 2, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.318 Vali Acc: 0.032 Test Loss: 3.318 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6245889663696289
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.305 Vali Acc: 0.038 Test Loss: 3.305 Test Acc: 0.038
Validation loss decreased (-0.035261 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.7478642463684082
Epoch: 4, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.292 Vali Acc: 0.042 Test Loss: 3.292 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 0.7141890525817871
Epoch: 5, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.278 Vali Acc: 0.055 Test Loss: 3.278 Test Acc: 0.055
Validation loss decreased (-0.042320 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 0.6137635707855225
Epoch: 6, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.268 Vali Acc: 0.068 Test Loss: 3.268 Test Acc: 0.068
Validation loss decreased (-0.055261 --> -0.068203).  Saving model ...
Epoch: 7 cost time: 0.8609673976898193
Epoch: 7, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.257 Vali Acc: 0.076 Test Loss: 3.257 Test Acc: 0.076
Validation loss decreased (-0.068203 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 0.6948425769805908
Epoch: 8, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.248 Vali Acc: 0.093 Test Loss: 3.248 Test Acc: 0.093
Validation loss decreased (-0.076438 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.6083798408508301
Epoch: 9, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.241 Vali Acc: 0.107 Test Loss: 3.241 Test Acc: 0.107
Validation loss decreased (-0.092909 --> -0.107026).  Saving model ...
Epoch: 10 cost time: 0.687237024307251
Epoch: 10, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.236 Vali Acc: 0.111 Test Loss: 3.236 Test Acc: 0.111
Validation loss decreased (-0.107026 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 0.6063899993896484
Epoch: 11, Steps: 10 | Train Loss: 2.477 Vali Loss: 3.230 Vali Acc: 0.122 Test Loss: 3.230 Test Acc: 0.122
Validation loss decreased (-0.110556 --> -0.122321).  Saving model ...
Epoch: 12 cost time: 0.6980793476104736
Epoch: 12, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.225 Vali Acc: 0.129 Test Loss: 3.225 Test Acc: 0.129
Validation loss decreased (-0.122321 --> -0.129380).  Saving model ...
Epoch: 13 cost time: 0.6164865493774414
Epoch: 13, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.224 Vali Acc: 0.136 Test Loss: 3.224 Test Acc: 0.136
Validation loss decreased (-0.129380 --> -0.136438).  Saving model ...
Epoch: 14 cost time: 0.6063792705535889
Epoch: 14, Steps: 10 | Train Loss: 2.152 Vali Loss: 3.226 Vali Acc: 0.142 Test Loss: 3.226 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 0.6140649318695068
Epoch: 15, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.229 Vali Acc: 0.140 Test Loss: 3.229 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7368371486663818
Epoch: 16, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.231 Vali Acc: 0.146 Test Loss: 3.231 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145850).  Saving model ...
Epoch: 17 cost time: 0.7061235904693604
Epoch: 17, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.237 Vali Acc: 0.154 Test Loss: 3.237 Test Acc: 0.154
Validation loss decreased (-0.145850 --> -0.154085).  Saving model ...
Epoch: 18 cost time: 0.6204054355621338
Epoch: 18, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.246 Vali Acc: 0.160 Test Loss: 3.246 Test Acc: 0.160
Validation loss decreased (-0.154085 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 0.6276059150695801
Epoch: 19, Steps: 10 | Train Loss: 1.617 Vali Loss: 3.256 Vali Acc: 0.171 Test Loss: 3.256 Test Acc: 0.171
Validation loss decreased (-0.159968 --> -0.170556).  Saving model ...
Epoch: 20 cost time: 0.6046581268310547
Epoch: 20, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.272 Vali Acc: 0.171 Test Loss: 3.272 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6764781475067139
Epoch: 21, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.293 Vali Acc: 0.179 Test Loss: 3.293 Test Acc: 0.179
Validation loss decreased (-0.170556 --> -0.178791).  Saving model ...
Epoch: 22 cost time: 0.7578291893005371
Epoch: 22, Steps: 10 | Train Loss: 1.325 Vali Loss: 3.306 Vali Acc: 0.178 Test Loss: 3.306 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8048548698425293
Epoch: 23, Steps: 10 | Train Loss: 1.259 Vali Loss: 3.329 Vali Acc: 0.188 Test Loss: 3.329 Test Acc: 0.188
Validation loss decreased (-0.178791 --> -0.188202).  Saving model ...
Epoch: 24 cost time: 0.629939079284668
Epoch: 24, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.355 Vali Acc: 0.187 Test Loss: 3.355 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6349427700042725
Epoch: 25, Steps: 10 | Train Loss: 1.066 Vali Loss: 3.370 Vali Acc: 0.199 Test Loss: 3.370 Test Acc: 0.199
Validation loss decreased (-0.188202 --> -0.198790).  Saving model ...
Epoch: 26 cost time: 0.7751789093017578
Epoch: 26, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.398 Vali Acc: 0.206 Test Loss: 3.398 Test Acc: 0.206
Validation loss decreased (-0.198790 --> -0.205848).  Saving model ...
Epoch: 27 cost time: 0.7146503925323486
Epoch: 27, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.431 Vali Acc: 0.202 Test Loss: 3.431 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7975952625274658
Epoch: 28, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.483 Vali Acc: 0.209 Test Loss: 3.483 Test Acc: 0.209
Validation loss decreased (-0.205848 --> -0.209377).  Saving model ...
Epoch: 29 cost time: 0.565624475479126
Epoch: 29, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.542 Vali Acc: 0.209 Test Loss: 3.542 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6453287601470947
Epoch: 30, Steps: 10 | Train Loss: 0.646 Vali Loss: 3.598 Vali Acc: 0.208 Test Loss: 3.598 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8451251983642578
Epoch: 31, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.668 Vali Acc: 0.201 Test Loss: 3.668 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7509181499481201
Epoch: 32, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.762 Vali Acc: 0.200 Test Loss: 3.762 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7608025074005127
Epoch: 33, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.862 Vali Acc: 0.193 Test Loss: 3.862 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6103723049163818
Epoch: 34, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.997 Vali Acc: 0.191 Test Loss: 3.997 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6196613311767578
Epoch: 35, Steps: 10 | Train Loss: 0.284 Vali Loss: 4.105 Vali Acc: 0.189 Test Loss: 4.105 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5964722633361816
Epoch: 36, Steps: 10 | Train Loss: 0.247 Vali Loss: 4.229 Vali Acc: 0.192 Test Loss: 4.229 Test Acc: 0.192
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7153151035308838
Epoch: 37, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.396 Vali Acc: 0.185 Test Loss: 4.396 Test Acc: 0.185
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7387039661407471
Epoch: 38, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.478 Vali Acc: 0.178 Test Loss: 4.478 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20941176470588235
model parameter : 45870
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0104103088378906
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.334 Vali Acc: 0.032 Test Loss: 3.334 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.6691527366638184
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.324 Vali Acc: 0.036 Test Loss: 3.324 Test Acc: 0.036
Validation loss decreased (-0.031731 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.7755129337310791
Epoch: 3, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.310 Vali Acc: 0.040 Test Loss: 3.310 Test Acc: 0.040
Validation loss decreased (-0.036437 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 0.7461810111999512
Epoch: 4, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.298 Vali Acc: 0.051 Test Loss: 3.298 Test Acc: 0.051
Validation loss decreased (-0.039967 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 0.7088172435760498
Epoch: 5, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.285 Vali Acc: 0.064 Test Loss: 3.285 Test Acc: 0.064
Validation loss decreased (-0.050555 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.7817332744598389
Epoch: 6, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.272 Vali Acc: 0.067 Test Loss: 3.272 Test Acc: 0.067
Validation loss decreased (-0.063497 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 0.7435448169708252
Epoch: 7, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.262 Vali Acc: 0.082 Test Loss: 3.262 Test Acc: 0.082
Validation loss decreased (-0.067026 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 0.6898453235626221
Epoch: 8, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.253 Vali Acc: 0.088 Test Loss: 3.253 Test Acc: 0.088
Validation loss decreased (-0.082320 --> -0.088203).  Saving model ...
Epoch: 9 cost time: 0.9251689910888672
Epoch: 9, Steps: 10 | Train Loss: 2.684 Vali Loss: 3.246 Vali Acc: 0.092 Test Loss: 3.246 Test Acc: 0.092
Validation loss decreased (-0.088203 --> -0.091732).  Saving model ...
Epoch: 10 cost time: 0.7882168292999268
Epoch: 10, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.240 Vali Acc: 0.100 Test Loss: 3.240 Test Acc: 0.100
Validation loss decreased (-0.091732 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 0.9818129539489746
Epoch: 11, Steps: 10 | Train Loss: 2.477 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107026).  Saving model ...
Epoch: 12 cost time: 0.73879075050354
Epoch: 12, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.232 Vali Acc: 0.113 Test Loss: 3.232 Test Acc: 0.113
Validation loss decreased (-0.107026 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 0.7294337749481201
Epoch: 13, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.234 Vali Acc: 0.122 Test Loss: 3.234 Test Acc: 0.122
Validation loss decreased (-0.112909 --> -0.122321).  Saving model ...
Epoch: 14 cost time: 0.8841145038604736
Epoch: 14, Steps: 10 | Train Loss: 2.171 Vali Loss: 3.238 Vali Acc: 0.131 Test Loss: 3.238 Test Acc: 0.131
Validation loss decreased (-0.122321 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.7542943954467773
Epoch: 15, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.238 Vali Acc: 0.139 Test Loss: 3.238 Test Acc: 0.139
Validation loss decreased (-0.130556 --> -0.138791).  Saving model ...
Epoch: 16 cost time: 0.7110879421234131
Epoch: 16, Steps: 10 | Train Loss: 1.949 Vali Loss: 3.244 Vali Acc: 0.144 Test Loss: 3.244 Test Acc: 0.144
Validation loss decreased (-0.138791 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 0.664710521697998
Epoch: 17, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.251 Vali Acc: 0.145 Test Loss: 3.251 Test Acc: 0.145
Validation loss decreased (-0.143497 --> -0.144673).  Saving model ...
Epoch: 18 cost time: 1.052560806274414
Epoch: 18, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.258 Vali Acc: 0.152 Test Loss: 3.258 Test Acc: 0.152
Validation loss decreased (-0.144673 --> -0.151732).  Saving model ...
Epoch: 19 cost time: 0.9126870632171631
Epoch: 19, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.275 Vali Acc: 0.165 Test Loss: 3.275 Test Acc: 0.165
Validation loss decreased (-0.151732 --> -0.164673).  Saving model ...
Epoch: 20 cost time: 0.6387622356414795
Epoch: 20, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.291 Vali Acc: 0.165 Test Loss: 3.291 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7712647914886475
Epoch: 21, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.318 Vali Acc: 0.175 Test Loss: 3.318 Test Acc: 0.175
Validation loss decreased (-0.164673 --> -0.175261).  Saving model ...
Epoch: 22 cost time: 0.8621063232421875
Epoch: 22, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.344 Vali Acc: 0.174 Test Loss: 3.344 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7453110218048096
Epoch: 23, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.373 Vali Acc: 0.179 Test Loss: 3.373 Test Acc: 0.179
Validation loss decreased (-0.175261 --> -0.178790).  Saving model ...
Epoch: 24 cost time: 0.7814016342163086
Epoch: 24, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.403 Vali Acc: 0.187 Test Loss: 3.403 Test Acc: 0.187
Validation loss decreased (-0.178790 --> -0.187025).  Saving model ...
Epoch: 25 cost time: 0.6656703948974609
Epoch: 25, Steps: 10 | Train Loss: 1.107 Vali Loss: 3.450 Vali Acc: 0.182 Test Loss: 3.450 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8810665607452393
Epoch: 26, Steps: 10 | Train Loss: 0.988 Vali Loss: 3.482 Vali Acc: 0.188 Test Loss: 3.482 Test Acc: 0.188
Validation loss decreased (-0.187025 --> -0.188200).  Saving model ...
Epoch: 27 cost time: 0.6916520595550537
Epoch: 27, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.519 Vali Acc: 0.189 Test Loss: 3.519 Test Acc: 0.189
Validation loss decreased (-0.188200 --> -0.189377).  Saving model ...
Epoch: 28 cost time: 0.9202394485473633
Epoch: 28, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.588 Vali Acc: 0.189 Test Loss: 3.588 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.713454008102417
Epoch: 29, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.629 Vali Acc: 0.182 Test Loss: 3.629 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7629854679107666
Epoch: 30, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.683 Vali Acc: 0.189 Test Loss: 3.683 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.94191575050354
Epoch: 31, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.776 Vali Acc: 0.186 Test Loss: 3.776 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6498284339904785
Epoch: 32, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.845 Vali Acc: 0.188 Test Loss: 3.845 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6860957145690918
Epoch: 33, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.894 Vali Acc: 0.182 Test Loss: 3.894 Test Acc: 0.182
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8059680461883545
Epoch: 34, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.974 Vali Acc: 0.176 Test Loss: 3.974 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6960093975067139
Epoch: 35, Steps: 10 | Train Loss: 0.407 Vali Loss: 4.090 Vali Acc: 0.179 Test Loss: 4.090 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.849001407623291
Epoch: 36, Steps: 10 | Train Loss: 0.374 Vali Loss: 4.191 Vali Acc: 0.175 Test Loss: 4.191 Test Acc: 0.175
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.013209342956543
Epoch: 37, Steps: 10 | Train Loss: 0.334 Vali Loss: 4.264 Vali Acc: 0.179 Test Loss: 4.264 Test Acc: 0.179
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.18941176470588236
model parameter : 45560
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.439187526702881
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.324 Vali Acc: 0.029 Test Loss: 3.324 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.9102580547332764
Epoch: 2, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.311 Vali Acc: 0.034 Test Loss: 3.311 Test Acc: 0.034
Validation loss decreased (-0.029379 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 0.7831709384918213
Epoch: 3, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.293 Vali Acc: 0.041 Test Loss: 3.293 Test Acc: 0.041
Validation loss decreased (-0.034085 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.6894323825836182
Epoch: 4, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.276 Vali Acc: 0.045 Test Loss: 3.276 Test Acc: 0.045
Validation loss decreased (-0.041144 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 0.7665450572967529
Epoch: 5, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.258 Vali Acc: 0.056 Test Loss: 3.258 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 0.8825442790985107
Epoch: 6, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.244 Vali Acc: 0.066 Test Loss: 3.244 Test Acc: 0.066
Validation loss decreased (-0.056438 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 0.7347791194915771
Epoch: 7, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.231 Vali Acc: 0.080 Test Loss: 3.231 Test Acc: 0.080
Validation loss decreased (-0.065850 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 0.8358306884765625
Epoch: 8, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.219 Vali Acc: 0.089 Test Loss: 3.219 Test Acc: 0.089
Validation loss decreased (-0.079968 --> -0.089380).  Saving model ...
Epoch: 9 cost time: 0.5816166400909424
Epoch: 9, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.209 Vali Acc: 0.101 Test Loss: 3.209 Test Acc: 0.101
Validation loss decreased (-0.089380 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.9249286651611328
Epoch: 10, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.203 Vali Acc: 0.111 Test Loss: 3.203 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 0.9433140754699707
Epoch: 11, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.199 Vali Acc: 0.116 Test Loss: 3.199 Test Acc: 0.116
Validation loss decreased (-0.110556 --> -0.116439).  Saving model ...
Epoch: 12 cost time: 0.6996300220489502
Epoch: 12, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.199 Vali Acc: 0.127 Test Loss: 3.199 Test Acc: 0.127
Validation loss decreased (-0.116439 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 0.8020133972167969
Epoch: 13, Steps: 10 | Train Loss: 2.245 Vali Loss: 3.198 Vali Acc: 0.128 Test Loss: 3.198 Test Acc: 0.128
Validation loss decreased (-0.127027 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 0.7511193752288818
Epoch: 14, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.202 Vali Acc: 0.131 Test Loss: 3.202 Test Acc: 0.131
Validation loss decreased (-0.128203 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.7136836051940918
Epoch: 15, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.213 Vali Acc: 0.133 Test Loss: 3.213 Test Acc: 0.133
Validation loss decreased (-0.130556 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 0.6441135406494141
Epoch: 16, Steps: 10 | Train Loss: 1.949 Vali Loss: 3.227 Vali Acc: 0.148 Test Loss: 3.227 Test Acc: 0.148
Validation loss decreased (-0.132909 --> -0.148203).  Saving model ...
Epoch: 17 cost time: 0.6724827289581299
Epoch: 17, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.237 Vali Acc: 0.160 Test Loss: 3.237 Test Acc: 0.160
Validation loss decreased (-0.148203 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 0.8619308471679688
Epoch: 18, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.256 Vali Acc: 0.159 Test Loss: 3.256 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7489097118377686
Epoch: 19, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.284 Vali Acc: 0.160 Test Loss: 3.284 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6898293495178223
Epoch: 20, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.317 Vali Acc: 0.166 Test Loss: 3.317 Test Acc: 0.166
Validation loss decreased (-0.159968 --> -0.165849).  Saving model ...
Epoch: 21 cost time: 0.8181772232055664
Epoch: 21, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.365 Vali Acc: 0.168 Test Loss: 3.365 Test Acc: 0.168
Validation loss decreased (-0.165849 --> -0.168202).  Saving model ...
Epoch: 22 cost time: 0.7028357982635498
Epoch: 22, Steps: 10 | Train Loss: 1.298 Vali Loss: 3.430 Vali Acc: 0.175 Test Loss: 3.430 Test Acc: 0.175
Validation loss decreased (-0.168202 --> -0.175260).  Saving model ...
Epoch: 23 cost time: 0.6801538467407227
Epoch: 23, Steps: 10 | Train Loss: 1.228 Vali Loss: 3.492 Vali Acc: 0.179 Test Loss: 3.492 Test Acc: 0.179
Validation loss decreased (-0.175260 --> -0.178789).  Saving model ...
Epoch: 24 cost time: 0.7820122241973877
Epoch: 24, Steps: 10 | Train Loss: 1.129 Vali Loss: 3.566 Vali Acc: 0.175 Test Loss: 3.566 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6733834743499756
Epoch: 25, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.634 Vali Acc: 0.179 Test Loss: 3.634 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7259130477905273
Epoch: 26, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.688 Vali Acc: 0.184 Test Loss: 3.688 Test Acc: 0.184
Validation loss decreased (-0.178789 --> -0.183493).  Saving model ...
Epoch: 27 cost time: 0.9633102416992188
Epoch: 27, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.770 Vali Acc: 0.185 Test Loss: 3.770 Test Acc: 0.185
Validation loss decreased (-0.183493 --> -0.184668).  Saving model ...
Epoch: 28 cost time: 0.5832173824310303
Epoch: 28, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.838 Vali Acc: 0.192 Test Loss: 3.838 Test Acc: 0.192
Validation loss decreased (-0.184668 --> -0.191726).  Saving model ...
Epoch: 29 cost time: 0.6721343994140625
Epoch: 29, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.934 Vali Acc: 0.182 Test Loss: 3.934 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6601684093475342
Epoch: 30, Steps: 10 | Train Loss: 0.616 Vali Loss: 4.004 Vali Acc: 0.180 Test Loss: 4.004 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.654111385345459
Epoch: 31, Steps: 10 | Train Loss: 0.571 Vali Loss: 4.132 Vali Acc: 0.185 Test Loss: 4.132 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6882038116455078
Epoch: 32, Steps: 10 | Train Loss: 0.499 Vali Loss: 4.179 Vali Acc: 0.189 Test Loss: 4.179 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6577401161193848
Epoch: 33, Steps: 10 | Train Loss: 0.443 Vali Loss: 4.305 Vali Acc: 0.192 Test Loss: 4.305 Test Acc: 0.192
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6352720260620117
Epoch: 34, Steps: 10 | Train Loss: 0.394 Vali Loss: 4.402 Vali Acc: 0.186 Test Loss: 4.402 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6204471588134766
Epoch: 35, Steps: 10 | Train Loss: 0.352 Vali Loss: 4.505 Vali Acc: 0.194 Test Loss: 4.505 Test Acc: 0.194
Validation loss decreased (-0.191726 --> -0.194073).  Saving model ...
Epoch: 36 cost time: 0.687105655670166
Epoch: 36, Steps: 10 | Train Loss: 0.315 Vali Loss: 4.607 Vali Acc: 0.191 Test Loss: 4.607 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6058828830718994
Epoch: 37, Steps: 10 | Train Loss: 0.261 Vali Loss: 4.778 Vali Acc: 0.198 Test Loss: 4.778 Test Acc: 0.198
Validation loss decreased (-0.194073 --> -0.197599).  Saving model ...
Epoch: 38 cost time: 0.8054258823394775
Epoch: 38, Steps: 10 | Train Loss: 0.239 Vali Loss: 4.873 Vali Acc: 0.192 Test Loss: 4.873 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6482048034667969
Epoch: 39, Steps: 10 | Train Loss: 0.204 Vali Loss: 5.022 Vali Acc: 0.198 Test Loss: 5.022 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.815399169921875
Epoch: 40, Steps: 10 | Train Loss: 0.180 Vali Loss: 5.178 Vali Acc: 0.198 Test Loss: 5.178 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6789674758911133
Epoch: 41, Steps: 10 | Train Loss: 0.145 Vali Loss: 5.290 Vali Acc: 0.200 Test Loss: 5.290 Test Acc: 0.200
Validation loss decreased (-0.197599 --> -0.199947).  Saving model ...
Epoch: 42 cost time: 0.6961984634399414
Epoch: 42, Steps: 10 | Train Loss: 0.131 Vali Loss: 5.455 Vali Acc: 0.193 Test Loss: 5.455 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7993545532226562
Epoch: 43, Steps: 10 | Train Loss: 0.113 Vali Loss: 5.567 Vali Acc: 0.201 Test Loss: 5.567 Test Acc: 0.201
Validation loss decreased (-0.199947 --> -0.201121).  Saving model ...
Epoch: 44 cost time: 0.7922921180725098
Epoch: 44, Steps: 10 | Train Loss: 0.096 Vali Loss: 5.663 Vali Acc: 0.208 Test Loss: 5.663 Test Acc: 0.208
Validation loss decreased (-0.201121 --> -0.208179).  Saving model ...
Epoch: 45 cost time: 0.5826418399810791
Epoch: 45, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.878 Vali Acc: 0.200 Test Loss: 5.878 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.621600866317749
Epoch: 46, Steps: 10 | Train Loss: 0.077 Vali Loss: 5.982 Vali Acc: 0.198 Test Loss: 5.982 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6445727348327637
Epoch: 47, Steps: 10 | Train Loss: 0.064 Vali Loss: 6.141 Vali Acc: 0.198 Test Loss: 6.141 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7371187210083008
Epoch: 48, Steps: 10 | Train Loss: 0.058 Vali Loss: 6.258 Vali Acc: 0.199 Test Loss: 6.258 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7998967170715332
Epoch: 49, Steps: 10 | Train Loss: 0.052 Vali Loss: 6.373 Vali Acc: 0.204 Test Loss: 6.373 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6641266345977783
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 6.514 Vali Acc: 0.201 Test Loss: 6.514 Test Acc: 0.201
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7603213787078857
Epoch: 51, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.656 Vali Acc: 0.199 Test Loss: 6.656 Test Acc: 0.199
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5386595726013184
Epoch: 52, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.781 Vali Acc: 0.201 Test Loss: 6.781 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6630256175994873
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.850 Vali Acc: 0.198 Test Loss: 6.850 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.6166763305664062
Epoch: 54, Steps: 10 | Train Loss: 0.031 Vali Loss: 6.999 Vali Acc: 0.198 Test Loss: 6.999 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20823529411764705
model parameter : 46536
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6666085720062256
Epoch: 1, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.291 Vali Acc: 0.032 Test Loss: 3.291 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.7989046573638916
Epoch: 2, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.282 Vali Acc: 0.035 Test Loss: 3.282 Test Acc: 0.035
Validation loss decreased (-0.031732 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.662569522857666
Epoch: 3, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.270 Vali Acc: 0.046 Test Loss: 3.270 Test Acc: 0.046
Validation loss decreased (-0.035261 --> -0.045850).  Saving model ...
Epoch: 4 cost time: 0.902996301651001
Epoch: 4, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.258 Vali Acc: 0.056 Test Loss: 3.258 Test Acc: 0.056
Validation loss decreased (-0.045850 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.6978957653045654
Epoch: 5, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.246 Vali Acc: 0.068 Test Loss: 3.246 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 0.6732728481292725
Epoch: 6, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.237 Vali Acc: 0.075 Test Loss: 3.237 Test Acc: 0.075
Validation loss decreased (-0.068203 --> -0.075262).  Saving model ...
Epoch: 7 cost time: 0.583791971206665
Epoch: 7, Steps: 10 | Train Loss: 2.818 Vali Loss: 3.228 Vali Acc: 0.084 Test Loss: 3.228 Test Acc: 0.084
Validation loss decreased (-0.075262 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.7186493873596191
Epoch: 8, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.219 Vali Acc: 0.092 Test Loss: 3.219 Test Acc: 0.092
Validation loss decreased (-0.083497 --> -0.091733).  Saving model ...
Epoch: 9 cost time: 0.6191692352294922
Epoch: 9, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.215 Vali Acc: 0.096 Test Loss: 3.215 Test Acc: 0.096
Validation loss decreased (-0.091733 --> -0.096438).  Saving model ...
Epoch: 10 cost time: 0.7480216026306152
Epoch: 10, Steps: 10 | Train Loss: 2.554 Vali Loss: 3.211 Vali Acc: 0.102 Test Loss: 3.211 Test Acc: 0.102
Validation loss decreased (-0.096438 --> -0.102321).  Saving model ...
Epoch: 11 cost time: 0.6598753929138184
Epoch: 11, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.209 Vali Acc: 0.116 Test Loss: 3.209 Test Acc: 0.116
Validation loss decreased (-0.102321 --> -0.116439).  Saving model ...
Epoch: 12 cost time: 0.6496026515960693
Epoch: 12, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.209 Vali Acc: 0.122 Test Loss: 3.209 Test Acc: 0.122
Validation loss decreased (-0.116439 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.6719067096710205
Epoch: 13, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.209 Vali Acc: 0.127 Test Loss: 3.209 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.6266164779663086
Epoch: 14, Steps: 10 | Train Loss: 2.126 Vali Loss: 3.215 Vali Acc: 0.126 Test Loss: 3.215 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6685116291046143
Epoch: 15, Steps: 10 | Train Loss: 1.994 Vali Loss: 3.223 Vali Acc: 0.135 Test Loss: 3.223 Test Acc: 0.135
Validation loss decreased (-0.127027 --> -0.135262).  Saving model ...
Epoch: 16 cost time: 0.6242568492889404
Epoch: 16, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.233 Vali Acc: 0.145 Test Loss: 3.233 Test Acc: 0.145
Validation loss decreased (-0.135262 --> -0.144674).  Saving model ...
Epoch: 17 cost time: 0.6005535125732422
Epoch: 17, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.244 Vali Acc: 0.151 Test Loss: 3.244 Test Acc: 0.151
Validation loss decreased (-0.144674 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.6156575679779053
Epoch: 18, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.256 Vali Acc: 0.158 Test Loss: 3.256 Test Acc: 0.158
Validation loss decreased (-0.150556 --> -0.157614).  Saving model ...
Epoch: 19 cost time: 0.7312288284301758
Epoch: 19, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.273 Vali Acc: 0.162 Test Loss: 3.273 Test Acc: 0.162
Validation loss decreased (-0.157614 --> -0.162320).  Saving model ...
Epoch: 20 cost time: 0.5905168056488037
Epoch: 20, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.291 Vali Acc: 0.166 Test Loss: 3.291 Test Acc: 0.166
Validation loss decreased (-0.162320 --> -0.165849).  Saving model ...
Epoch: 21 cost time: 0.6491944789886475
Epoch: 21, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.314 Vali Acc: 0.167 Test Loss: 3.314 Test Acc: 0.167
Validation loss decreased (-0.165849 --> -0.167026).  Saving model ...
Epoch: 22 cost time: 0.6803791522979736
Epoch: 22, Steps: 10 | Train Loss: 1.316 Vali Loss: 3.346 Vali Acc: 0.174 Test Loss: 3.346 Test Acc: 0.174
Validation loss decreased (-0.167026 --> -0.174084).  Saving model ...
Epoch: 23 cost time: 0.5983803272247314
Epoch: 23, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.380 Vali Acc: 0.169 Test Loss: 3.380 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8072073459625244
Epoch: 24, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.423 Vali Acc: 0.182 Test Loss: 3.423 Test Acc: 0.182
Validation loss decreased (-0.174084 --> -0.182319).  Saving model ...
Epoch: 25 cost time: 0.7662239074707031
Epoch: 25, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.472 Vali Acc: 0.180 Test Loss: 3.472 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8111445903778076
Epoch: 26, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.534 Vali Acc: 0.181 Test Loss: 3.534 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.814286470413208
Epoch: 27, Steps: 10 | Train Loss: 0.849 Vali Loss: 3.593 Vali Acc: 0.182 Test Loss: 3.593 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7271242141723633
Epoch: 28, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.671 Vali Acc: 0.181 Test Loss: 3.671 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8088288307189941
Epoch: 29, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.738 Vali Acc: 0.185 Test Loss: 3.738 Test Acc: 0.185
Validation loss decreased (-0.182319 --> -0.184668).  Saving model ...
Epoch: 30 cost time: 0.6928062438964844
Epoch: 30, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.829 Vali Acc: 0.192 Test Loss: 3.829 Test Acc: 0.192
Validation loss decreased (-0.184668 --> -0.191726).  Saving model ...
Epoch: 31 cost time: 0.7754881381988525
Epoch: 31, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.899 Vali Acc: 0.195 Test Loss: 3.899 Test Acc: 0.195
Validation loss decreased (-0.191726 --> -0.195255).  Saving model ...
Epoch: 32 cost time: 0.6636919975280762
Epoch: 32, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.964 Vali Acc: 0.193 Test Loss: 3.964 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8046565055847168
Epoch: 33, Steps: 10 | Train Loss: 0.472 Vali Loss: 4.011 Vali Acc: 0.192 Test Loss: 4.011 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7701442241668701
Epoch: 34, Steps: 10 | Train Loss: 0.424 Vali Loss: 4.111 Vali Acc: 0.200 Test Loss: 4.111 Test Acc: 0.200
Validation loss decreased (-0.195255 --> -0.199959).  Saving model ...
Epoch: 35 cost time: 0.6995868682861328
Epoch: 35, Steps: 10 | Train Loss: 0.388 Vali Loss: 4.198 Vali Acc: 0.195 Test Loss: 4.198 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6802020072937012
Epoch: 36, Steps: 10 | Train Loss: 0.349 Vali Loss: 4.257 Vali Acc: 0.198 Test Loss: 4.257 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6836445331573486
Epoch: 37, Steps: 10 | Train Loss: 0.316 Vali Loss: 4.355 Vali Acc: 0.199 Test Loss: 4.355 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6885013580322266
Epoch: 38, Steps: 10 | Train Loss: 0.269 Vali Loss: 4.428 Vali Acc: 0.194 Test Loss: 4.428 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6037354469299316
Epoch: 39, Steps: 10 | Train Loss: 0.246 Vali Loss: 4.503 Vali Acc: 0.189 Test Loss: 4.503 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7135491371154785
Epoch: 40, Steps: 10 | Train Loss: 0.213 Vali Loss: 4.621 Vali Acc: 0.193 Test Loss: 4.621 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.747450590133667
Epoch: 41, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.669 Vali Acc: 0.189 Test Loss: 4.669 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6669280529022217
Epoch: 42, Steps: 10 | Train Loss: 0.186 Vali Loss: 4.792 Vali Acc: 0.193 Test Loss: 4.792 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7449805736541748
Epoch: 43, Steps: 10 | Train Loss: 0.158 Vali Loss: 4.842 Vali Acc: 0.193 Test Loss: 4.842 Test Acc: 0.193
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6081154346466064
Epoch: 44, Steps: 10 | Train Loss: 0.133 Vali Loss: 4.956 Vali Acc: 0.188 Test Loss: 4.956 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2
model parameter : 45478
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.055605888366699
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.320 Vali Acc: 0.039 Test Loss: 3.320 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.619603157043457
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.310 Vali Acc: 0.047 Test Loss: 3.310 Test Acc: 0.047
Validation loss decreased (-0.038790 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.7980132102966309
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.298 Vali Acc: 0.048 Test Loss: 3.298 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.7091031074523926
Epoch: 4, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.286 Vali Acc: 0.055 Test Loss: 3.286 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.6336183547973633
Epoch: 5, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.275 Vali Acc: 0.061 Test Loss: 3.275 Test Acc: 0.061
Validation loss decreased (-0.055261 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.6195361614227295
Epoch: 6, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.263 Vali Acc: 0.068 Test Loss: 3.263 Test Acc: 0.068
Validation loss decreased (-0.061144 --> -0.068203).  Saving model ...
Epoch: 7 cost time: 0.6697380542755127
Epoch: 7, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.253 Vali Acc: 0.076 Test Loss: 3.253 Test Acc: 0.076
Validation loss decreased (-0.068203 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 0.7319107055664062
Epoch: 8, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.246 Vali Acc: 0.086 Test Loss: 3.246 Test Acc: 0.086
Validation loss decreased (-0.076438 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 0.5603072643280029
Epoch: 9, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.240 Vali Acc: 0.096 Test Loss: 3.240 Test Acc: 0.096
Validation loss decreased (-0.085850 --> -0.096438).  Saving model ...
Epoch: 10 cost time: 0.6199123859405518
Epoch: 10, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.237 Vali Acc: 0.098 Test Loss: 3.237 Test Acc: 0.098
Validation loss decreased (-0.096438 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 0.5506260395050049
Epoch: 11, Steps: 10 | Train Loss: 2.507 Vali Loss: 3.233 Vali Acc: 0.107 Test Loss: 3.233 Test Acc: 0.107
Validation loss decreased (-0.097615 --> -0.107026).  Saving model ...
Epoch: 12 cost time: 0.7254970073699951
Epoch: 12, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.231 Vali Acc: 0.112 Test Loss: 3.231 Test Acc: 0.112
Validation loss decreased (-0.107026 --> -0.111732).  Saving model ...
Epoch: 13 cost time: 0.6647350788116455
Epoch: 13, Steps: 10 | Train Loss: 2.289 Vali Loss: 3.233 Vali Acc: 0.119 Test Loss: 3.233 Test Acc: 0.119
Validation loss decreased (-0.111732 --> -0.118791).  Saving model ...
Epoch: 14 cost time: 0.9665055274963379
Epoch: 14, Steps: 10 | Train Loss: 2.178 Vali Loss: 3.241 Vali Acc: 0.121 Test Loss: 3.241 Test Acc: 0.121
Validation loss decreased (-0.118791 --> -0.121144).  Saving model ...
Epoch: 15 cost time: 0.6860384941101074
Epoch: 15, Steps: 10 | Train Loss: 2.061 Vali Loss: 3.242 Vali Acc: 0.127 Test Loss: 3.242 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127026).  Saving model ...
Epoch: 16 cost time: 0.6807374954223633
Epoch: 16, Steps: 10 | Train Loss: 1.972 Vali Loss: 3.248 Vali Acc: 0.135 Test Loss: 3.248 Test Acc: 0.135
Validation loss decreased (-0.127026 --> -0.135262).  Saving model ...
Epoch: 17 cost time: 0.6367435455322266
Epoch: 17, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.256 Vali Acc: 0.144 Test Loss: 3.256 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 18 cost time: 0.6685178279876709
Epoch: 18, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.268 Vali Acc: 0.153 Test Loss: 3.268 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152909).  Saving model ...
Epoch: 19 cost time: 0.7143893241882324
Epoch: 19, Steps: 10 | Train Loss: 1.636 Vali Loss: 3.279 Vali Acc: 0.156 Test Loss: 3.279 Test Acc: 0.156
Validation loss decreased (-0.152909 --> -0.156438).  Saving model ...
Epoch: 20 cost time: 0.6606688499450684
Epoch: 20, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.293 Vali Acc: 0.161 Test Loss: 3.293 Test Acc: 0.161
Validation loss decreased (-0.156438 --> -0.161144).  Saving model ...
Epoch: 21 cost time: 0.6443941593170166
Epoch: 21, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.311 Vali Acc: 0.168 Test Loss: 3.311 Test Acc: 0.168
Validation loss decreased (-0.161144 --> -0.168202).  Saving model ...
Epoch: 22 cost time: 0.6506145000457764
Epoch: 22, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.336 Vali Acc: 0.174 Test Loss: 3.336 Test Acc: 0.174
Validation loss decreased (-0.168202 --> -0.174084).  Saving model ...
Epoch: 23 cost time: 0.5246181488037109
Epoch: 23, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.368 Vali Acc: 0.181 Test Loss: 3.368 Test Acc: 0.181
Validation loss decreased (-0.174084 --> -0.181143).  Saving model ...
Epoch: 24 cost time: 0.6105961799621582
Epoch: 24, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.403 Vali Acc: 0.182 Test Loss: 3.403 Test Acc: 0.182
Validation loss decreased (-0.181143 --> -0.182319).  Saving model ...
Epoch: 25 cost time: 0.513608455657959
Epoch: 25, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.434 Vali Acc: 0.182 Test Loss: 3.434 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6360330581665039
Epoch: 26, Steps: 10 | Train Loss: 1.027 Vali Loss: 3.471 Vali Acc: 0.179 Test Loss: 3.471 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5387527942657471
Epoch: 27, Steps: 10 | Train Loss: 0.939 Vali Loss: 3.519 Vali Acc: 0.182 Test Loss: 3.519 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6568765640258789
Epoch: 28, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.550 Vali Acc: 0.186 Test Loss: 3.550 Test Acc: 0.186
Validation loss decreased (-0.182319 --> -0.185847).  Saving model ...
Epoch: 29 cost time: 0.5585689544677734
Epoch: 29, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.599 Vali Acc: 0.189 Test Loss: 3.599 Test Acc: 0.189
Validation loss decreased (-0.185847 --> -0.189376).  Saving model ...
Epoch: 30 cost time: 0.6060307025909424
Epoch: 30, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.657 Vali Acc: 0.193 Test Loss: 3.657 Test Acc: 0.193
Validation loss decreased (-0.189376 --> -0.192905).  Saving model ...
Epoch: 31 cost time: 0.6821560859680176
Epoch: 31, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.707 Vali Acc: 0.186 Test Loss: 3.707 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.734642505645752
Epoch: 32, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.780 Vali Acc: 0.187 Test Loss: 3.780 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.624783992767334
Epoch: 33, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.837 Vali Acc: 0.193 Test Loss: 3.837 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.602301836013794
Epoch: 34, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.918 Vali Acc: 0.193 Test Loss: 3.918 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6671478748321533
Epoch: 35, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.980 Vali Acc: 0.193 Test Loss: 3.980 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5927493572235107
Epoch: 36, Steps: 10 | Train Loss: 0.382 Vali Loss: 4.042 Vali Acc: 0.195 Test Loss: 4.042 Test Acc: 0.195
Validation loss decreased (-0.192905 --> -0.195254).  Saving model ...
Epoch: 37 cost time: 0.5812840461730957
Epoch: 37, Steps: 10 | Train Loss: 0.335 Vali Loss: 4.124 Vali Acc: 0.202 Test Loss: 4.124 Test Acc: 0.202
Validation loss decreased (-0.195254 --> -0.202312).  Saving model ...
Epoch: 38 cost time: 0.6115920543670654
Epoch: 38, Steps: 10 | Train Loss: 0.301 Vali Loss: 4.233 Vali Acc: 0.205 Test Loss: 4.233 Test Acc: 0.205
Validation loss decreased (-0.202312 --> -0.204664).  Saving model ...
Epoch: 39 cost time: 0.7252771854400635
Epoch: 39, Steps: 10 | Train Loss: 0.256 Vali Loss: 4.318 Vali Acc: 0.206 Test Loss: 4.318 Test Acc: 0.206
Validation loss decreased (-0.204664 --> -0.205839).  Saving model ...
Epoch: 40 cost time: 0.7160651683807373
Epoch: 40, Steps: 10 | Train Loss: 0.228 Vali Loss: 4.391 Vali Acc: 0.196 Test Loss: 4.391 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.952955961227417
Epoch: 41, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.464 Vali Acc: 0.201 Test Loss: 4.464 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6638884544372559
Epoch: 42, Steps: 10 | Train Loss: 0.173 Vali Loss: 4.574 Vali Acc: 0.198 Test Loss: 4.574 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7093455791473389
Epoch: 43, Steps: 10 | Train Loss: 0.154 Vali Loss: 4.696 Vali Acc: 0.202 Test Loss: 4.696 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5829176902770996
Epoch: 44, Steps: 10 | Train Loss: 0.133 Vali Loss: 4.755 Vali Acc: 0.201 Test Loss: 4.755 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6914410591125488
Epoch: 45, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.850 Vali Acc: 0.206 Test Loss: 4.850 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7056000232696533
Epoch: 46, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.975 Vali Acc: 0.205 Test Loss: 4.975 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6251716613769531
Epoch: 47, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.978 Vali Acc: 0.204 Test Loss: 4.978 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7592947483062744
Epoch: 48, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.125 Vali Acc: 0.204 Test Loss: 5.125 Test Acc: 0.204
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.752159595489502
Epoch: 49, Steps: 10 | Train Loss: 0.073 Vali Loss: 5.187 Vali Acc: 0.206 Test Loss: 5.187 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20588235294117646
model parameter : 45414
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8809678554534912
Epoch: 1, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.295 Vali Acc: 0.049 Test Loss: 3.295 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.9152088165283203
Epoch: 2, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.284 Vali Acc: 0.054 Test Loss: 3.284 Test Acc: 0.054
Validation loss decreased (-0.049379 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.7296977043151855
Epoch: 3, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.270 Vali Acc: 0.064 Test Loss: 3.270 Test Acc: 0.064
Validation loss decreased (-0.054085 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 0.5839717388153076
Epoch: 4, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.257 Vali Acc: 0.069 Test Loss: 3.257 Test Acc: 0.069
Validation loss decreased (-0.063497 --> -0.069379).  Saving model ...
Epoch: 5 cost time: 0.5697677135467529
Epoch: 5, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.243 Vali Acc: 0.079 Test Loss: 3.243 Test Acc: 0.079
Validation loss decreased (-0.069379 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.7565135955810547
Epoch: 6, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.231 Vali Acc: 0.087 Test Loss: 3.231 Test Acc: 0.087
Validation loss decreased (-0.078791 --> -0.087027).  Saving model ...
Epoch: 7 cost time: 0.7908833026885986
Epoch: 7, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.219 Vali Acc: 0.093 Test Loss: 3.219 Test Acc: 0.093
Validation loss decreased (-0.087027 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 0.6483802795410156
Epoch: 8, Steps: 10 | Train Loss: 2.752 Vali Loss: 3.209 Vali Acc: 0.104 Test Loss: 3.209 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 0.6054298877716064
Epoch: 9, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.202 Vali Acc: 0.112 Test Loss: 3.202 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111733).  Saving model ...
Epoch: 10 cost time: 0.6563749313354492
Epoch: 10, Steps: 10 | Train Loss: 2.574 Vali Loss: 3.196 Vali Acc: 0.121 Test Loss: 3.196 Test Acc: 0.121
Validation loss decreased (-0.111733 --> -0.121145).  Saving model ...
Epoch: 11 cost time: 0.6500763893127441
Epoch: 11, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.191 Vali Acc: 0.125 Test Loss: 3.191 Test Acc: 0.125
Validation loss decreased (-0.121145 --> -0.124674).  Saving model ...
Epoch: 12 cost time: 0.7793545722961426
Epoch: 12, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.191 Vali Acc: 0.131 Test Loss: 3.191 Test Acc: 0.131
Validation loss decreased (-0.124674 --> -0.130556).  Saving model ...
Epoch: 13 cost time: 0.7856884002685547
Epoch: 13, Steps: 10 | Train Loss: 2.265 Vali Loss: 3.190 Vali Acc: 0.138 Test Loss: 3.190 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 14 cost time: 0.6341626644134521
Epoch: 14, Steps: 10 | Train Loss: 2.188 Vali Loss: 3.193 Vali Acc: 0.146 Test Loss: 3.193 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145850).  Saving model ...
Epoch: 15 cost time: 0.5734319686889648
Epoch: 15, Steps: 10 | Train Loss: 2.051 Vali Loss: 3.198 Vali Acc: 0.153 Test Loss: 3.198 Test Acc: 0.153
Validation loss decreased (-0.145850 --> -0.152909).  Saving model ...
Epoch: 16 cost time: 0.5929379463195801
Epoch: 16, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.205 Vali Acc: 0.153 Test Loss: 3.205 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8808808326721191
Epoch: 17, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.213 Vali Acc: 0.156 Test Loss: 3.213 Test Acc: 0.156
Validation loss decreased (-0.152909 --> -0.156438).  Saving model ...
Epoch: 18 cost time: 0.8149282932281494
Epoch: 18, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.223 Vali Acc: 0.164 Test Loss: 3.223 Test Acc: 0.164
Validation loss decreased (-0.156438 --> -0.163497).  Saving model ...
Epoch: 19 cost time: 0.8126909732818604
Epoch: 19, Steps: 10 | Train Loss: 1.653 Vali Loss: 3.236 Vali Acc: 0.166 Test Loss: 3.236 Test Acc: 0.166
Validation loss decreased (-0.163497 --> -0.165850).  Saving model ...
Epoch: 20 cost time: 0.5774753093719482
Epoch: 20, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.254 Vali Acc: 0.171 Test Loss: 3.254 Test Acc: 0.171
Validation loss decreased (-0.165850 --> -0.170556).  Saving model ...
Epoch: 21 cost time: 0.49622511863708496
Epoch: 21, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.273 Vali Acc: 0.179 Test Loss: 3.273 Test Acc: 0.179
Validation loss decreased (-0.170556 --> -0.178791).  Saving model ...
Epoch: 22 cost time: 0.8441464900970459
Epoch: 22, Steps: 10 | Train Loss: 1.379 Vali Loss: 3.295 Vali Acc: 0.178 Test Loss: 3.295 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6268730163574219
Epoch: 23, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.322 Vali Acc: 0.185 Test Loss: 3.322 Test Acc: 0.185
Validation loss decreased (-0.178791 --> -0.184673).  Saving model ...
Epoch: 24 cost time: 0.7040073871612549
Epoch: 24, Steps: 10 | Train Loss: 1.195 Vali Loss: 3.350 Vali Acc: 0.187 Test Loss: 3.350 Test Acc: 0.187
Validation loss decreased (-0.184673 --> -0.187025).  Saving model ...
Epoch: 25 cost time: 0.6323554515838623
Epoch: 25, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.378 Vali Acc: 0.193 Test Loss: 3.378 Test Acc: 0.193
Validation loss decreased (-0.187025 --> -0.192907).  Saving model ...
Epoch: 26 cost time: 0.7998020648956299
Epoch: 26, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.411 Vali Acc: 0.188 Test Loss: 3.411 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7587003707885742
Epoch: 27, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.444 Vali Acc: 0.188 Test Loss: 3.444 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6580638885498047
Epoch: 28, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.476 Vali Acc: 0.198 Test Loss: 3.476 Test Acc: 0.198
Validation loss decreased (-0.192907 --> -0.197612).  Saving model ...
Epoch: 29 cost time: 0.6679692268371582
Epoch: 29, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.508 Vali Acc: 0.199 Test Loss: 3.508 Test Acc: 0.199
Validation loss decreased (-0.197612 --> -0.198788).  Saving model ...
Epoch: 30 cost time: 0.6501569747924805
Epoch: 30, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.552 Vali Acc: 0.198 Test Loss: 3.552 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6878213882446289
Epoch: 31, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.591 Vali Acc: 0.201 Test Loss: 3.591 Test Acc: 0.201
Validation loss decreased (-0.198788 --> -0.201141).  Saving model ...
Epoch: 32 cost time: 0.6647067070007324
Epoch: 32, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.634 Vali Acc: 0.207 Test Loss: 3.634 Test Acc: 0.207
Validation loss decreased (-0.201141 --> -0.207022).  Saving model ...
Epoch: 33 cost time: 0.7550127506256104
Epoch: 33, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.678 Vali Acc: 0.212 Test Loss: 3.678 Test Acc: 0.212
Validation loss decreased (-0.207022 --> -0.211728).  Saving model ...
Epoch: 34 cost time: 0.7428855895996094
Epoch: 34, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.730 Vali Acc: 0.209 Test Loss: 3.730 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6449346542358398
Epoch: 35, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.775 Vali Acc: 0.209 Test Loss: 3.775 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7180867195129395
Epoch: 36, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.836 Vali Acc: 0.205 Test Loss: 3.836 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8473355770111084
Epoch: 37, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.873 Vali Acc: 0.209 Test Loss: 3.873 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.697709321975708
Epoch: 38, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.920 Vali Acc: 0.214 Test Loss: 3.920 Test Acc: 0.214
Validation loss decreased (-0.211728 --> -0.214078).  Saving model ...
Epoch: 39 cost time: 1.1439666748046875
Epoch: 39, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.982 Vali Acc: 0.214 Test Loss: 3.982 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6115143299102783
Epoch: 40, Steps: 10 | Train Loss: 0.303 Vali Loss: 4.051 Vali Acc: 0.215 Test Loss: 4.051 Test Acc: 0.215
Validation loss decreased (-0.214078 --> -0.215254).  Saving model ...
Epoch: 41 cost time: 0.6819751262664795
Epoch: 41, Steps: 10 | Train Loss: 0.281 Vali Loss: 4.106 Vali Acc: 0.218 Test Loss: 4.106 Test Acc: 0.218
Validation loss decreased (-0.215254 --> -0.217606).  Saving model ...
Epoch: 42 cost time: 0.7540051937103271
Epoch: 42, Steps: 10 | Train Loss: 0.252 Vali Loss: 4.153 Vali Acc: 0.216 Test Loss: 4.153 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8403286933898926
Epoch: 43, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.232 Vali Acc: 0.220 Test Loss: 4.232 Test Acc: 0.220
Validation loss decreased (-0.217606 --> -0.219958).  Saving model ...
Epoch: 44 cost time: 0.8433988094329834
Epoch: 44, Steps: 10 | Train Loss: 0.184 Vali Loss: 4.299 Vali Acc: 0.228 Test Loss: 4.299 Test Acc: 0.228
Validation loss decreased (-0.219958 --> -0.228192).  Saving model ...
Epoch: 45 cost time: 0.7620441913604736
Epoch: 45, Steps: 10 | Train Loss: 0.161 Vali Loss: 4.368 Vali Acc: 0.228 Test Loss: 4.368 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7016241550445557
Epoch: 46, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.445 Vali Acc: 0.224 Test Loss: 4.445 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7723281383514404
Epoch: 47, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.520 Vali Acc: 0.228 Test Loss: 4.520 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7544469833374023
Epoch: 48, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.564 Vali Acc: 0.225 Test Loss: 4.564 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7364835739135742
Epoch: 49, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.655 Vali Acc: 0.225 Test Loss: 4.655 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6907138824462891
Epoch: 50, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.748 Vali Acc: 0.220 Test Loss: 4.748 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5932159423828125
Epoch: 51, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.811 Vali Acc: 0.227 Test Loss: 4.811 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6995234489440918
Epoch: 52, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.889 Vali Acc: 0.224 Test Loss: 4.889 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7530882358551025
Epoch: 53, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.955 Vali Acc: 0.228 Test Loss: 4.955 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7217004299163818
Epoch: 54, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.020 Vali Acc: 0.229 Test Loss: 5.020 Test Acc: 0.229
Validation loss decreased (-0.228192 --> -0.229362).  Saving model ...
Epoch: 55 cost time: 0.6837518215179443
Epoch: 55, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.089 Vali Acc: 0.228 Test Loss: 5.089 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5706357955932617
Epoch: 56, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.169 Vali Acc: 0.228 Test Loss: 5.169 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9141790866851807
Epoch: 57, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.246 Vali Acc: 0.228 Test Loss: 5.246 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.692573070526123
Epoch: 58, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.326 Vali Acc: 0.225 Test Loss: 5.326 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8625712394714355
Epoch: 59, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.406 Vali Acc: 0.224 Test Loss: 5.406 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.568986177444458
Epoch: 60, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.475 Vali Acc: 0.224 Test Loss: 5.475 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.6735317707061768
Epoch: 61, Steps: 10 | Train Loss: 0.026 Vali Loss: 5.541 Vali Acc: 0.221 Test Loss: 5.541 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8235478401184082
Epoch: 62, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.607 Vali Acc: 0.227 Test Loss: 5.607 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.6529190540313721
Epoch: 63, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.683 Vali Acc: 0.225 Test Loss: 5.683 Test Acc: 0.225
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.9627463817596436
Epoch: 64, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.740 Vali Acc: 0.228 Test Loss: 5.740 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22941176470588234
model parameter : 40616
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3331985473632812
Epoch: 1, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.337 Vali Acc: 0.034 Test Loss: 3.337 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.6482200622558594
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.326 Vali Acc: 0.038 Test Loss: 3.326 Test Acc: 0.038
Validation loss decreased (-0.034084 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 0.648545503616333
Epoch: 3, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.311 Vali Acc: 0.045 Test Loss: 3.311 Test Acc: 0.045
Validation loss decreased (-0.037614 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.7447826862335205
Epoch: 4, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.297 Vali Acc: 0.055 Test Loss: 3.297 Test Acc: 0.055
Validation loss decreased (-0.044673 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.593496561050415
Epoch: 5, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.283 Vali Acc: 0.056 Test Loss: 3.283 Test Acc: 0.056
Validation loss decreased (-0.055261 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 0.7350578308105469
Epoch: 6, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.269 Vali Acc: 0.073 Test Loss: 3.269 Test Acc: 0.073
Validation loss decreased (-0.056438 --> -0.072908).  Saving model ...
Epoch: 7 cost time: 0.5878748893737793
Epoch: 7, Steps: 10 | Train Loss: 2.841 Vali Loss: 3.260 Vali Acc: 0.078 Test Loss: 3.260 Test Acc: 0.078
Validation loss decreased (-0.072908 --> -0.077614).  Saving model ...
Epoch: 8 cost time: 0.5125865936279297
Epoch: 8, Steps: 10 | Train Loss: 2.740 Vali Loss: 3.250 Vali Acc: 0.085 Test Loss: 3.250 Test Acc: 0.085
Validation loss decreased (-0.077614 --> -0.084673).  Saving model ...
Epoch: 9 cost time: 0.774277925491333
Epoch: 9, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.244 Vali Acc: 0.094 Test Loss: 3.244 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 0.7592110633850098
Epoch: 10, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.239 Vali Acc: 0.105 Test Loss: 3.239 Test Acc: 0.105
Validation loss decreased (-0.094085 --> -0.104673).  Saving model ...
Epoch: 11 cost time: 0.6569106578826904
Epoch: 11, Steps: 10 | Train Loss: 2.417 Vali Loss: 3.235 Vali Acc: 0.118 Test Loss: 3.235 Test Acc: 0.118
Validation loss decreased (-0.104673 --> -0.117615).  Saving model ...
Epoch: 12 cost time: 0.6332492828369141
Epoch: 12, Steps: 10 | Train Loss: 2.338 Vali Loss: 3.234 Vali Acc: 0.126 Test Loss: 3.234 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.7123301029205322
Epoch: 13, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.233 Vali Acc: 0.139 Test Loss: 3.233 Test Acc: 0.139
Validation loss decreased (-0.125850 --> -0.138791).  Saving model ...
Epoch: 14 cost time: 0.6416611671447754
Epoch: 14, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.234 Vali Acc: 0.144 Test Loss: 3.234 Test Acc: 0.144
Validation loss decreased (-0.138791 --> -0.143497).  Saving model ...
Epoch: 15 cost time: 0.6922204494476318
Epoch: 15, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.239 Vali Acc: 0.148 Test Loss: 3.239 Test Acc: 0.148
Validation loss decreased (-0.143497 --> -0.148203).  Saving model ...
Epoch: 16 cost time: 0.7706527709960938
Epoch: 16, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.246 Vali Acc: 0.147 Test Loss: 3.246 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6179399490356445
Epoch: 17, Steps: 10 | Train Loss: 1.800 Vali Loss: 3.260 Vali Acc: 0.151 Test Loss: 3.260 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.6057479381561279
Epoch: 18, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.267 Vali Acc: 0.159 Test Loss: 3.267 Test Acc: 0.159
Validation loss decreased (-0.150556 --> -0.158791).  Saving model ...
Epoch: 19 cost time: 0.6212573051452637
Epoch: 19, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.275 Vali Acc: 0.168 Test Loss: 3.275 Test Acc: 0.168
Validation loss decreased (-0.158791 --> -0.168203).  Saving model ...
Epoch: 20 cost time: 0.5711510181427002
Epoch: 20, Steps: 10 | Train Loss: 1.547 Vali Loss: 3.291 Vali Acc: 0.168 Test Loss: 3.291 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7393767833709717
Epoch: 21, Steps: 10 | Train Loss: 1.443 Vali Loss: 3.311 Vali Acc: 0.165 Test Loss: 3.311 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6769659519195557
Epoch: 22, Steps: 10 | Train Loss: 1.350 Vali Loss: 3.333 Vali Acc: 0.169 Test Loss: 3.333 Test Acc: 0.169
Validation loss decreased (-0.168203 --> -0.169378).  Saving model ...
Epoch: 23 cost time: 0.5503823757171631
Epoch: 23, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.354 Vali Acc: 0.176 Test Loss: 3.354 Test Acc: 0.176
Validation loss decreased (-0.169378 --> -0.176437).  Saving model ...
Epoch: 24 cost time: 0.6074209213256836
Epoch: 24, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.377 Vali Acc: 0.175 Test Loss: 3.377 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5085194110870361
Epoch: 25, Steps: 10 | Train Loss: 1.084 Vali Loss: 3.405 Vali Acc: 0.180 Test Loss: 3.405 Test Acc: 0.180
Validation loss decreased (-0.176437 --> -0.179966).  Saving model ...
Epoch: 26 cost time: 0.6045467853546143
Epoch: 26, Steps: 10 | Train Loss: 1.084 Vali Loss: 3.441 Vali Acc: 0.180 Test Loss: 3.441 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5792863368988037
Epoch: 27, Steps: 10 | Train Loss: 0.949 Vali Loss: 3.462 Vali Acc: 0.186 Test Loss: 3.462 Test Acc: 0.186
Validation loss decreased (-0.179966 --> -0.185848).  Saving model ...
Epoch: 28 cost time: 0.588068962097168
Epoch: 28, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.498 Vali Acc: 0.192 Test Loss: 3.498 Test Acc: 0.192
Validation loss decreased (-0.185848 --> -0.191730).  Saving model ...
Epoch: 29 cost time: 0.6889410018920898
Epoch: 29, Steps: 10 | Train Loss: 0.829 Vali Loss: 3.536 Vali Acc: 0.194 Test Loss: 3.536 Test Acc: 0.194
Validation loss decreased (-0.191730 --> -0.194082).  Saving model ...
Epoch: 30 cost time: 0.7459473609924316
Epoch: 30, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.581 Vali Acc: 0.198 Test Loss: 3.581 Test Acc: 0.198
Validation loss decreased (-0.194082 --> -0.197611).  Saving model ...
Epoch: 31 cost time: 0.570836067199707
Epoch: 31, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.617 Vali Acc: 0.202 Test Loss: 3.617 Test Acc: 0.202
Validation loss decreased (-0.197611 --> -0.202317).  Saving model ...
Epoch: 32 cost time: 0.6297669410705566
Epoch: 32, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.671 Vali Acc: 0.202 Test Loss: 3.671 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6435747146606445
Epoch: 33, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.721 Vali Acc: 0.207 Test Loss: 3.721 Test Acc: 0.207
Validation loss decreased (-0.202317 --> -0.207022).  Saving model ...
Epoch: 34 cost time: 0.8554520606994629
Epoch: 34, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.770 Vali Acc: 0.209 Test Loss: 3.770 Test Acc: 0.209
Validation loss decreased (-0.207022 --> -0.209374).  Saving model ...
Epoch: 35 cost time: 0.6090383529663086
Epoch: 35, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.827 Vali Acc: 0.209 Test Loss: 3.827 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5570785999298096
Epoch: 36, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.889 Vali Acc: 0.212 Test Loss: 3.889 Test Acc: 0.212
Validation loss decreased (-0.209374 --> -0.211726).  Saving model ...
Epoch: 37 cost time: 0.6727292537689209
Epoch: 37, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.950 Vali Acc: 0.206 Test Loss: 3.950 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6136643886566162
Epoch: 38, Steps: 10 | Train Loss: 0.317 Vali Loss: 4.009 Vali Acc: 0.207 Test Loss: 4.009 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6568527221679688
Epoch: 39, Steps: 10 | Train Loss: 0.283 Vali Loss: 4.079 Vali Acc: 0.206 Test Loss: 4.079 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6776843070983887
Epoch: 40, Steps: 10 | Train Loss: 0.244 Vali Loss: 4.161 Vali Acc: 0.209 Test Loss: 4.161 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6078407764434814
Epoch: 41, Steps: 10 | Train Loss: 0.223 Vali Loss: 4.248 Vali Acc: 0.209 Test Loss: 4.248 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.778256893157959
Epoch: 42, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.352 Vali Acc: 0.207 Test Loss: 4.352 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6975803375244141
Epoch: 43, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.434 Vali Acc: 0.205 Test Loss: 4.434 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.721440315246582
Epoch: 44, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.511 Vali Acc: 0.206 Test Loss: 4.511 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7338862419128418
Epoch: 45, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.600 Vali Acc: 0.204 Test Loss: 4.600 Test Acc: 0.204
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6948397159576416
Epoch: 46, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.685 Vali Acc: 0.207 Test Loss: 4.685 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21176470588235294
model parameter : 39982
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9021811485290527
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.315 Vali Acc: 0.028 Test Loss: 3.315 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.5786714553833008
Epoch: 2, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.302 Vali Acc: 0.031 Test Loss: 3.302 Test Acc: 0.031
Validation loss decreased (-0.028202 --> -0.030555).  Saving model ...
Epoch: 3 cost time: 0.698716402053833
Epoch: 3, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.286 Vali Acc: 0.044 Test Loss: 3.286 Test Acc: 0.044
Validation loss decreased (-0.030555 --> -0.043497).  Saving model ...
Epoch: 4 cost time: 0.6002540588378906
Epoch: 4, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.268 Vali Acc: 0.054 Test Loss: 3.268 Test Acc: 0.054
Validation loss decreased (-0.043497 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.7188520431518555
Epoch: 5, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.254 Vali Acc: 0.066 Test Loss: 3.254 Test Acc: 0.066
Validation loss decreased (-0.054085 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 0.6276547908782959
Epoch: 6, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.240 Vali Acc: 0.084 Test Loss: 3.240 Test Acc: 0.084
Validation loss decreased (-0.065850 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 0.6264669895172119
Epoch: 7, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.230 Vali Acc: 0.092 Test Loss: 3.230 Test Acc: 0.092
Validation loss decreased (-0.083497 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 0.6125009059906006
Epoch: 8, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.220 Vali Acc: 0.098 Test Loss: 3.220 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097615).  Saving model ...
Epoch: 9 cost time: 0.7118706703186035
Epoch: 9, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.215 Vali Acc: 0.108 Test Loss: 3.215 Test Acc: 0.108
Validation loss decreased (-0.097615 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 0.5854456424713135
Epoch: 10, Steps: 10 | Train Loss: 2.557 Vali Loss: 3.209 Vali Acc: 0.106 Test Loss: 3.209 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7829525470733643
Epoch: 11, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.207 Vali Acc: 0.109 Test Loss: 3.207 Test Acc: 0.109
Validation loss decreased (-0.108203 --> -0.109380).  Saving model ...
Epoch: 12 cost time: 0.6203584671020508
Epoch: 12, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.200 Vali Acc: 0.125 Test Loss: 3.200 Test Acc: 0.125
Validation loss decreased (-0.109380 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 0.644676685333252
Epoch: 13, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.199 Vali Acc: 0.133 Test Loss: 3.199 Test Acc: 0.133
Validation loss decreased (-0.124674 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.6493964195251465
Epoch: 14, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.198 Vali Acc: 0.136 Test Loss: 3.198 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136439).  Saving model ...
Epoch: 15 cost time: 0.5418059825897217
Epoch: 15, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.198 Vali Acc: 0.147 Test Loss: 3.198 Test Acc: 0.147
Validation loss decreased (-0.136439 --> -0.147027).  Saving model ...
Epoch: 16 cost time: 0.7001132965087891
Epoch: 16, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.197 Vali Acc: 0.154 Test Loss: 3.197 Test Acc: 0.154
Validation loss decreased (-0.147027 --> -0.154086).  Saving model ...
Epoch: 17 cost time: 0.5663092136383057
Epoch: 17, Steps: 10 | Train Loss: 1.858 Vali Loss: 3.203 Vali Acc: 0.156 Test Loss: 3.203 Test Acc: 0.156
Validation loss decreased (-0.154086 --> -0.156439).  Saving model ...
Epoch: 18 cost time: 0.5710940361022949
Epoch: 18, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.216 Vali Acc: 0.160 Test Loss: 3.216 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 0.6478006839752197
Epoch: 19, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.228 Vali Acc: 0.162 Test Loss: 3.228 Test Acc: 0.162
Validation loss decreased (-0.159968 --> -0.162321).  Saving model ...
Epoch: 20 cost time: 0.7702944278717041
Epoch: 20, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.239 Vali Acc: 0.172 Test Loss: 3.239 Test Acc: 0.172
Validation loss decreased (-0.162321 --> -0.171732).  Saving model ...
Epoch: 21 cost time: 0.668628454208374
Epoch: 21, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.258 Vali Acc: 0.178 Test Loss: 3.258 Test Acc: 0.178
Validation loss decreased (-0.171732 --> -0.177614).  Saving model ...
Epoch: 22 cost time: 0.6839759349822998
Epoch: 22, Steps: 10 | Train Loss: 1.382 Vali Loss: 3.275 Vali Acc: 0.182 Test Loss: 3.275 Test Acc: 0.182
Validation loss decreased (-0.177614 --> -0.182320).  Saving model ...
Epoch: 23 cost time: 0.6661214828491211
Epoch: 23, Steps: 10 | Train Loss: 1.281 Vali Loss: 3.293 Vali Acc: 0.174 Test Loss: 3.293 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7456583976745605
Epoch: 24, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.316 Vali Acc: 0.186 Test Loss: 3.316 Test Acc: 0.186
Validation loss decreased (-0.182320 --> -0.185849).  Saving model ...
Epoch: 25 cost time: 0.663754940032959
Epoch: 25, Steps: 10 | Train Loss: 1.110 Vali Loss: 3.340 Vali Acc: 0.181 Test Loss: 3.340 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6474781036376953
Epoch: 26, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.366 Vali Acc: 0.187 Test Loss: 3.366 Test Acc: 0.187
Validation loss decreased (-0.185849 --> -0.187025).  Saving model ...
Epoch: 27 cost time: 0.7171034812927246
Epoch: 27, Steps: 10 | Train Loss: 0.987 Vali Loss: 3.404 Vali Acc: 0.186 Test Loss: 3.404 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9479625225067139
Epoch: 28, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.433 Vali Acc: 0.189 Test Loss: 3.433 Test Acc: 0.189
Validation loss decreased (-0.187025 --> -0.189377).  Saving model ...
Epoch: 29 cost time: 0.8755049705505371
Epoch: 29, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.472 Vali Acc: 0.194 Test Loss: 3.472 Test Acc: 0.194
Validation loss decreased (-0.189377 --> -0.194083).  Saving model ...
Epoch: 30 cost time: 0.6594650745391846
Epoch: 30, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.503 Vali Acc: 0.200 Test Loss: 3.503 Test Acc: 0.200
Validation loss decreased (-0.194083 --> -0.199965).  Saving model ...
Epoch: 31 cost time: 0.5661931037902832
Epoch: 31, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.545 Vali Acc: 0.199 Test Loss: 3.545 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8777518272399902
Epoch: 32, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.578 Vali Acc: 0.201 Test Loss: 3.578 Test Acc: 0.201
Validation loss decreased (-0.199965 --> -0.201141).  Saving model ...
Epoch: 33 cost time: 0.6398382186889648
Epoch: 33, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.620 Vali Acc: 0.201 Test Loss: 3.620 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6903152465820312
Epoch: 34, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.662 Vali Acc: 0.201 Test Loss: 3.662 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.589496374130249
Epoch: 35, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.706 Vali Acc: 0.199 Test Loss: 3.706 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7534263134002686
Epoch: 36, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.760 Vali Acc: 0.207 Test Loss: 3.760 Test Acc: 0.207
Validation loss decreased (-0.201141 --> -0.207021).  Saving model ...
Epoch: 37 cost time: 0.5833854675292969
Epoch: 37, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.812 Vali Acc: 0.205 Test Loss: 3.812 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5465669631958008
Epoch: 38, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.848 Vali Acc: 0.206 Test Loss: 3.848 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5642175674438477
Epoch: 39, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.904 Vali Acc: 0.209 Test Loss: 3.904 Test Acc: 0.209
Validation loss decreased (-0.207021 --> -0.209373).  Saving model ...
Epoch: 40 cost time: 0.6017365455627441
Epoch: 40, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.958 Vali Acc: 0.208 Test Loss: 3.958 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6526477336883545
Epoch: 41, Steps: 10 | Train Loss: 0.312 Vali Loss: 4.038 Vali Acc: 0.209 Test Loss: 4.038 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6228454113006592
Epoch: 42, Steps: 10 | Train Loss: 0.285 Vali Loss: 4.084 Vali Acc: 0.212 Test Loss: 4.084 Test Acc: 0.212
Validation loss decreased (-0.209373 --> -0.211724).  Saving model ...
Epoch: 43 cost time: 0.5858349800109863
Epoch: 43, Steps: 10 | Train Loss: 0.253 Vali Loss: 4.143 Vali Acc: 0.211 Test Loss: 4.143 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6893696784973145
Epoch: 44, Steps: 10 | Train Loss: 0.242 Vali Loss: 4.211 Vali Acc: 0.209 Test Loss: 4.211 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6317710876464844
Epoch: 45, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.252 Vali Acc: 0.215 Test Loss: 4.252 Test Acc: 0.215
Validation loss decreased (-0.211724 --> -0.215252).  Saving model ...
Epoch: 46 cost time: 0.7149755954742432
Epoch: 46, Steps: 10 | Train Loss: 0.189 Vali Loss: 4.314 Vali Acc: 0.219 Test Loss: 4.314 Test Acc: 0.219
Validation loss decreased (-0.215252 --> -0.218780).  Saving model ...
Epoch: 47 cost time: 0.6488230228424072
Epoch: 47, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.404 Vali Acc: 0.215 Test Loss: 4.404 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6278820037841797
Epoch: 48, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.467 Vali Acc: 0.212 Test Loss: 4.467 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5976567268371582
Epoch: 49, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.542 Vali Acc: 0.214 Test Loss: 4.542 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6102335453033447
Epoch: 50, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.608 Vali Acc: 0.216 Test Loss: 4.608 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7156226634979248
Epoch: 51, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.670 Vali Acc: 0.219 Test Loss: 4.670 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7166600227355957
Epoch: 52, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.731 Vali Acc: 0.219 Test Loss: 4.731 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.563636064529419
Epoch: 53, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.800 Vali Acc: 0.214 Test Loss: 4.800 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.6391205787658691
Epoch: 54, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.881 Vali Acc: 0.212 Test Loss: 4.881 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7275688648223877
Epoch: 55, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.967 Vali Acc: 0.213 Test Loss: 4.967 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.7145419120788574
Epoch: 56, Steps: 10 | Train Loss: 0.071 Vali Loss: 5.033 Vali Acc: 0.215 Test Loss: 5.033 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2188235294117647
model parameter : 39432
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0555903911590576
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.314 Vali Acc: 0.052 Test Loss: 3.314 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.6996135711669922
Epoch: 2, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.303 Vali Acc: 0.046 Test Loss: 3.303 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7268128395080566
Epoch: 3, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.288 Vali Acc: 0.041 Test Loss: 3.288 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7197394371032715
Epoch: 4, Steps: 10 | Train Loss: 3.192 Vali Loss: 3.273 Vali Acc: 0.049 Test Loss: 3.273 Test Acc: 0.049
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6702563762664795
Epoch: 5, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.258 Vali Acc: 0.060 Test Loss: 3.258 Test Acc: 0.060
Validation loss decreased (-0.051732 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.7348837852478027
Epoch: 6, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.245 Vali Acc: 0.073 Test Loss: 3.245 Test Acc: 0.073
Validation loss decreased (-0.059967 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 0.6236505508422852
Epoch: 7, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.233 Vali Acc: 0.082 Test Loss: 3.233 Test Acc: 0.082
Validation loss decreased (-0.072909 --> -0.082321).  Saving model ...
Epoch: 8 cost time: 0.6305229663848877
Epoch: 8, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.221 Vali Acc: 0.096 Test Loss: 3.221 Test Acc: 0.096
Validation loss decreased (-0.082321 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 0.6960923671722412
Epoch: 9, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.214 Vali Acc: 0.099 Test Loss: 3.214 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 0.92824387550354
Epoch: 10, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.206 Vali Acc: 0.108 Test Loss: 3.206 Test Acc: 0.108
Validation loss decreased (-0.098791 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.7514519691467285
Epoch: 11, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.200 Vali Acc: 0.115 Test Loss: 3.200 Test Acc: 0.115
Validation loss decreased (-0.108203 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.6173646450042725
Epoch: 12, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.199 Vali Acc: 0.113 Test Loss: 3.199 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6061975955963135
Epoch: 13, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.197 Vali Acc: 0.115 Test Loss: 3.197 Test Acc: 0.115
Validation loss decreased (-0.115262 --> -0.115262).  Saving model ...
Epoch: 14 cost time: 0.6252310276031494
Epoch: 14, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.197 Vali Acc: 0.122 Test Loss: 3.197 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122321).  Saving model ...
Epoch: 15 cost time: 0.6683647632598877
Epoch: 15, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.200 Vali Acc: 0.127 Test Loss: 3.200 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127027).  Saving model ...
Epoch: 16 cost time: 0.5925066471099854
Epoch: 16, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.204 Vali Acc: 0.129 Test Loss: 3.204 Test Acc: 0.129
Validation loss decreased (-0.127027 --> -0.129380).  Saving model ...
Epoch: 17 cost time: 0.5352246761322021
Epoch: 17, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.209 Vali Acc: 0.134 Test Loss: 3.209 Test Acc: 0.134
Validation loss decreased (-0.129380 --> -0.134086).  Saving model ...
Epoch: 18 cost time: 0.712066650390625
Epoch: 18, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.213 Vali Acc: 0.151 Test Loss: 3.213 Test Acc: 0.151
Validation loss decreased (-0.134086 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 0.7082643508911133
Epoch: 19, Steps: 10 | Train Loss: 1.669 Vali Loss: 3.226 Vali Acc: 0.146 Test Loss: 3.226 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6300137042999268
Epoch: 20, Steps: 10 | Train Loss: 1.566 Vali Loss: 3.236 Vali Acc: 0.160 Test Loss: 3.236 Test Acc: 0.160
Validation loss decreased (-0.150556 --> -0.159968).  Saving model ...
Epoch: 21 cost time: 0.6196310520172119
Epoch: 21, Steps: 10 | Train Loss: 1.494 Vali Loss: 3.256 Vali Acc: 0.161 Test Loss: 3.256 Test Acc: 0.161
Validation loss decreased (-0.159968 --> -0.161144).  Saving model ...
Epoch: 22 cost time: 0.6437885761260986
Epoch: 22, Steps: 10 | Train Loss: 1.389 Vali Loss: 3.273 Vali Acc: 0.162 Test Loss: 3.273 Test Acc: 0.162
Validation loss decreased (-0.161144 --> -0.162320).  Saving model ...
Epoch: 23 cost time: 0.5993261337280273
Epoch: 23, Steps: 10 | Train Loss: 1.304 Vali Loss: 3.288 Vali Acc: 0.180 Test Loss: 3.288 Test Acc: 0.180
Validation loss decreased (-0.162320 --> -0.179967).  Saving model ...
Epoch: 24 cost time: 0.6930525302886963
Epoch: 24, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.307 Vali Acc: 0.179 Test Loss: 3.307 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7024736404418945
Epoch: 25, Steps: 10 | Train Loss: 1.106 Vali Loss: 3.331 Vali Acc: 0.188 Test Loss: 3.331 Test Acc: 0.188
Validation loss decreased (-0.179967 --> -0.188202).  Saving model ...
Epoch: 26 cost time: 0.6462841033935547
Epoch: 26, Steps: 10 | Train Loss: 1.035 Vali Loss: 3.356 Vali Acc: 0.193 Test Loss: 3.356 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 27 cost time: 0.7591867446899414
Epoch: 27, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.384 Vali Acc: 0.196 Test Loss: 3.384 Test Acc: 0.196
Validation loss decreased (-0.192908 --> -0.196437).  Saving model ...
Epoch: 28 cost time: 0.5844032764434814
Epoch: 28, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.414 Vali Acc: 0.195 Test Loss: 3.414 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.682499885559082
Epoch: 29, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.444 Vali Acc: 0.198 Test Loss: 3.444 Test Acc: 0.198
Validation loss decreased (-0.196437 --> -0.197613).  Saving model ...
Epoch: 30 cost time: 0.6994330883026123
Epoch: 30, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.481 Vali Acc: 0.198 Test Loss: 3.481 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7711796760559082
Epoch: 31, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.519 Vali Acc: 0.206 Test Loss: 3.519 Test Acc: 0.206
Validation loss decreased (-0.197613 --> -0.205847).  Saving model ...
Epoch: 32 cost time: 0.5265746116638184
Epoch: 32, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.563 Vali Acc: 0.205 Test Loss: 3.563 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.714404821395874
Epoch: 33, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.600 Vali Acc: 0.214 Test Loss: 3.600 Test Acc: 0.214
Validation loss decreased (-0.205847 --> -0.214082).  Saving model ...
Epoch: 34 cost time: 0.7574553489685059
Epoch: 34, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.648 Vali Acc: 0.218 Test Loss: 3.648 Test Acc: 0.218
Validation loss decreased (-0.214082 --> -0.217611).  Saving model ...
Epoch: 35 cost time: 0.6372225284576416
Epoch: 35, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.704 Vali Acc: 0.212 Test Loss: 3.704 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6016662120819092
Epoch: 36, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.769 Vali Acc: 0.215 Test Loss: 3.769 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6039588451385498
Epoch: 37, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.845 Vali Acc: 0.216 Test Loss: 3.845 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6413412094116211
Epoch: 38, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.908 Vali Acc: 0.215 Test Loss: 3.908 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7497498989105225
Epoch: 39, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.975 Vali Acc: 0.213 Test Loss: 3.975 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5839388370513916
Epoch: 40, Steps: 10 | Train Loss: 0.221 Vali Loss: 4.046 Vali Acc: 0.221 Test Loss: 4.046 Test Acc: 0.221
Validation loss decreased (-0.217611 --> -0.221136).  Saving model ...
Epoch: 41 cost time: 0.9798784255981445
Epoch: 41, Steps: 10 | Train Loss: 0.192 Vali Loss: 4.124 Vali Acc: 0.224 Test Loss: 4.124 Test Acc: 0.224
Validation loss decreased (-0.221136 --> -0.223488).  Saving model ...
Epoch: 42 cost time: 0.6538112163543701
Epoch: 42, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.212 Vali Acc: 0.220 Test Loss: 4.212 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7353129386901855
Epoch: 43, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.276 Vali Acc: 0.225 Test Loss: 4.276 Test Acc: 0.225
Validation loss decreased (-0.223488 --> -0.224663).  Saving model ...
Epoch: 44 cost time: 0.7889196872711182
Epoch: 44, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.353 Vali Acc: 0.221 Test Loss: 4.353 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6978023052215576
Epoch: 45, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.417 Vali Acc: 0.225 Test Loss: 4.417 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6734673976898193
Epoch: 46, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.493 Vali Acc: 0.227 Test Loss: 4.493 Test Acc: 0.227
Validation loss decreased (-0.224663 --> -0.227014).  Saving model ...
Epoch: 47 cost time: 0.6543412208557129
Epoch: 47, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.585 Vali Acc: 0.224 Test Loss: 4.585 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6330397129058838
Epoch: 48, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.665 Vali Acc: 0.220 Test Loss: 4.665 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8232142925262451
Epoch: 49, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.756 Vali Acc: 0.215 Test Loss: 4.756 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6286630630493164
Epoch: 50, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.804 Vali Acc: 0.219 Test Loss: 4.804 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.626262903213501
Epoch: 51, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.901 Vali Acc: 0.213 Test Loss: 4.901 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5761399269104004
Epoch: 52, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.981 Vali Acc: 0.213 Test Loss: 4.981 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.6391618251800537
Epoch: 53, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.063 Vali Acc: 0.209 Test Loss: 5.063 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7515616416931152
Epoch: 54, Steps: 10 | Train Loss: 0.042 Vali Loss: 5.146 Vali Acc: 0.208 Test Loss: 5.146 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7746284008026123
Epoch: 55, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.203 Vali Acc: 0.212 Test Loss: 5.203 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.648611307144165
Epoch: 56, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.271 Vali Acc: 0.208 Test Loss: 5.271 Test Acc: 0.208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22705882352941176
model parameter : 39686
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.736290454864502
Epoch: 1, Steps: 10 | Train Loss: 3.364 Vali Loss: 3.321 Vali Acc: 0.028 Test Loss: 3.321 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.7539710998535156
Epoch: 2, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.309 Vali Acc: 0.029 Test Loss: 3.309 Test Acc: 0.029
Validation loss decreased (-0.028202 --> -0.029379).  Saving model ...
Epoch: 3 cost time: 0.7362101078033447
Epoch: 3, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.293 Vali Acc: 0.034 Test Loss: 3.293 Test Acc: 0.034
Validation loss decreased (-0.029379 --> -0.034085).  Saving model ...
Epoch: 4 cost time: 0.5982444286346436
Epoch: 4, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.277 Vali Acc: 0.047 Test Loss: 3.277 Test Acc: 0.047
Validation loss decreased (-0.034085 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.5841302871704102
Epoch: 5, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.261 Vali Acc: 0.055 Test Loss: 3.261 Test Acc: 0.055
Validation loss decreased (-0.047026 --> -0.055262).  Saving model ...
Epoch: 6 cost time: 0.5958113670349121
Epoch: 6, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.246 Vali Acc: 0.072 Test Loss: 3.246 Test Acc: 0.072
Validation loss decreased (-0.055262 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.6345386505126953
Epoch: 7, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.234 Vali Acc: 0.084 Test Loss: 3.234 Test Acc: 0.084
Validation loss decreased (-0.071732 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.9211928844451904
Epoch: 8, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.223 Vali Acc: 0.088 Test Loss: 3.223 Test Acc: 0.088
Validation loss decreased (-0.083497 --> -0.088203).  Saving model ...
Epoch: 9 cost time: 0.5658981800079346
Epoch: 9, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.214 Vali Acc: 0.096 Test Loss: 3.214 Test Acc: 0.096
Validation loss decreased (-0.088203 --> -0.096438).  Saving model ...
Epoch: 10 cost time: 0.7363433837890625
Epoch: 10, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.206 Vali Acc: 0.101 Test Loss: 3.206 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.6261982917785645
Epoch: 11, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.203 Vali Acc: 0.112 Test Loss: 3.203 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111733).  Saving model ...
Epoch: 12 cost time: 0.5508573055267334
Epoch: 12, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.197 Vali Acc: 0.116 Test Loss: 3.197 Test Acc: 0.116
Validation loss decreased (-0.111733 --> -0.116439).  Saving model ...
Epoch: 13 cost time: 0.7499661445617676
Epoch: 13, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.196 Vali Acc: 0.120 Test Loss: 3.196 Test Acc: 0.120
Validation loss decreased (-0.116439 --> -0.119968).  Saving model ...
Epoch: 14 cost time: 0.5638809204101562
Epoch: 14, Steps: 10 | Train Loss: 2.180 Vali Loss: 3.197 Vali Acc: 0.133 Test Loss: 3.197 Test Acc: 0.133
Validation loss decreased (-0.119968 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.5446927547454834
Epoch: 15, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.202 Vali Acc: 0.134 Test Loss: 3.202 Test Acc: 0.134
Validation loss decreased (-0.132909 --> -0.134086).  Saving model ...
Epoch: 16 cost time: 0.5135712623596191
Epoch: 16, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.205 Vali Acc: 0.136 Test Loss: 3.205 Test Acc: 0.136
Validation loss decreased (-0.134086 --> -0.136439).  Saving model ...
Epoch: 17 cost time: 0.5765328407287598
Epoch: 17, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.208 Vali Acc: 0.144 Test Loss: 3.208 Test Acc: 0.144
Validation loss decreased (-0.136439 --> -0.143497).  Saving model ...
Epoch: 18 cost time: 0.6615850925445557
Epoch: 18, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.220 Vali Acc: 0.149 Test Loss: 3.220 Test Acc: 0.149
Validation loss decreased (-0.143497 --> -0.149380).  Saving model ...
Epoch: 19 cost time: 0.6538283824920654
Epoch: 19, Steps: 10 | Train Loss: 1.669 Vali Loss: 3.232 Vali Acc: 0.156 Test Loss: 3.232 Test Acc: 0.156
Validation loss decreased (-0.149380 --> -0.156438).  Saving model ...
Epoch: 20 cost time: 0.49054384231567383
Epoch: 20, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.246 Vali Acc: 0.160 Test Loss: 3.246 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159968).  Saving model ...
Epoch: 21 cost time: 0.6160924434661865
Epoch: 21, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.265 Vali Acc: 0.162 Test Loss: 3.265 Test Acc: 0.162
Validation loss decreased (-0.159968 --> -0.162320).  Saving model ...
Epoch: 22 cost time: 0.6700153350830078
Epoch: 22, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.286 Vali Acc: 0.167 Test Loss: 3.286 Test Acc: 0.167
Validation loss decreased (-0.162320 --> -0.167026).  Saving model ...
Epoch: 23 cost time: 0.6011075973510742
Epoch: 23, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.313 Vali Acc: 0.172 Test Loss: 3.313 Test Acc: 0.172
Validation loss decreased (-0.167026 --> -0.171732).  Saving model ...
Epoch: 24 cost time: 0.6496536731719971
Epoch: 24, Steps: 10 | Train Loss: 1.201 Vali Loss: 3.336 Vali Acc: 0.179 Test Loss: 3.336 Test Acc: 0.179
Validation loss decreased (-0.171732 --> -0.178790).  Saving model ...
Epoch: 25 cost time: 0.6721296310424805
Epoch: 25, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.369 Vali Acc: 0.188 Test Loss: 3.369 Test Acc: 0.188
Validation loss decreased (-0.178790 --> -0.188202).  Saving model ...
Epoch: 26 cost time: 0.6597461700439453
Epoch: 26, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.399 Vali Acc: 0.192 Test Loss: 3.399 Test Acc: 0.192
Validation loss decreased (-0.188202 --> -0.191731).  Saving model ...
Epoch: 27 cost time: 0.8151962757110596
Epoch: 27, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.425 Vali Acc: 0.200 Test Loss: 3.425 Test Acc: 0.200
Validation loss decreased (-0.191731 --> -0.199966).  Saving model ...
Epoch: 28 cost time: 0.7434248924255371
Epoch: 28, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.456 Vali Acc: 0.196 Test Loss: 3.456 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.74853515625
Epoch: 29, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.495 Vali Acc: 0.200 Test Loss: 3.495 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6192986965179443
Epoch: 30, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.527 Vali Acc: 0.205 Test Loss: 3.527 Test Acc: 0.205
Validation loss decreased (-0.199966 --> -0.204671).  Saving model ...
Epoch: 31 cost time: 0.6022982597351074
Epoch: 31, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.566 Vali Acc: 0.204 Test Loss: 3.566 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5845358371734619
Epoch: 32, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.607 Vali Acc: 0.208 Test Loss: 3.607 Test Acc: 0.208
Validation loss decreased (-0.204671 --> -0.208199).  Saving model ...
Epoch: 33 cost time: 0.6578617095947266
Epoch: 33, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.657 Vali Acc: 0.214 Test Loss: 3.657 Test Acc: 0.214
Validation loss decreased (-0.208199 --> -0.214081).  Saving model ...
Epoch: 34 cost time: 0.7177243232727051
Epoch: 34, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.701 Vali Acc: 0.211 Test Loss: 3.701 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.706411600112915
Epoch: 35, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.738 Vali Acc: 0.211 Test Loss: 3.738 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5941300392150879
Epoch: 36, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.799 Vali Acc: 0.215 Test Loss: 3.799 Test Acc: 0.215
Validation loss decreased (-0.214081 --> -0.215256).  Saving model ...
Epoch: 37 cost time: 0.6944077014923096
Epoch: 37, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.858 Vali Acc: 0.219 Test Loss: 3.858 Test Acc: 0.219
Validation loss decreased (-0.215256 --> -0.218785).  Saving model ...
Epoch: 38 cost time: 0.725299596786499
Epoch: 38, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.897 Vali Acc: 0.212 Test Loss: 3.897 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6385343074798584
Epoch: 39, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.955 Vali Acc: 0.220 Test Loss: 3.955 Test Acc: 0.220
Validation loss decreased (-0.218785 --> -0.219960).  Saving model ...
Epoch: 40 cost time: 0.5627627372741699
Epoch: 40, Steps: 10 | Train Loss: 0.314 Vali Loss: 4.018 Vali Acc: 0.222 Test Loss: 4.018 Test Acc: 0.222
Validation loss decreased (-0.219960 --> -0.222313).  Saving model ...
Epoch: 41 cost time: 0.6356894969940186
Epoch: 41, Steps: 10 | Train Loss: 0.290 Vali Loss: 4.062 Vali Acc: 0.225 Test Loss: 4.062 Test Acc: 0.225
Validation loss decreased (-0.222313 --> -0.224665).  Saving model ...
Epoch: 42 cost time: 0.5673294067382812
Epoch: 42, Steps: 10 | Train Loss: 0.263 Vali Loss: 4.116 Vali Acc: 0.224 Test Loss: 4.116 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6667943000793457
Epoch: 43, Steps: 10 | Train Loss: 0.241 Vali Loss: 4.178 Vali Acc: 0.228 Test Loss: 4.178 Test Acc: 0.228
Validation loss decreased (-0.224665 --> -0.228194).  Saving model ...
Epoch: 44 cost time: 0.7472977638244629
Epoch: 44, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.247 Vali Acc: 0.226 Test Loss: 4.247 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5997576713562012
Epoch: 45, Steps: 10 | Train Loss: 0.197 Vali Loss: 4.290 Vali Acc: 0.231 Test Loss: 4.290 Test Acc: 0.231
Validation loss decreased (-0.228194 --> -0.230545).  Saving model ...
Epoch: 46 cost time: 0.6718783378601074
Epoch: 46, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.364 Vali Acc: 0.227 Test Loss: 4.364 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7341108322143555
Epoch: 47, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.423 Vali Acc: 0.226 Test Loss: 4.423 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9188747406005859
Epoch: 48, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.474 Vali Acc: 0.224 Test Loss: 4.474 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7466433048248291
Epoch: 49, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.540 Vali Acc: 0.231 Test Loss: 4.540 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5678842067718506
Epoch: 50, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.608 Vali Acc: 0.224 Test Loss: 4.608 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7749125957489014
Epoch: 51, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.660 Vali Acc: 0.225 Test Loss: 4.660 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6204686164855957
Epoch: 52, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.733 Vali Acc: 0.224 Test Loss: 4.733 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.788959264755249
Epoch: 53, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.805 Vali Acc: 0.233 Test Loss: 4.805 Test Acc: 0.233
Validation loss decreased (-0.230545 --> -0.232893).  Saving model ...
Epoch: 54 cost time: 0.6909499168395996
Epoch: 54, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.838 Vali Acc: 0.224 Test Loss: 4.838 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.76812744140625
Epoch: 55, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.891 Vali Acc: 0.226 Test Loss: 4.891 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7265362739562988
Epoch: 56, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.973 Vali Acc: 0.225 Test Loss: 4.973 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7429237365722656
Epoch: 57, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.046 Vali Acc: 0.224 Test Loss: 5.046 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6500346660614014
Epoch: 58, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.122 Vali Acc: 0.220 Test Loss: 5.122 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.6657850742340088
Epoch: 59, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.175 Vali Acc: 0.222 Test Loss: 5.175 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.7456941604614258
Epoch: 60, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.244 Vali Acc: 0.222 Test Loss: 5.244 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.7457304000854492
Epoch: 61, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.298 Vali Acc: 0.220 Test Loss: 5.298 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.6802804470062256
Epoch: 62, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.354 Vali Acc: 0.218 Test Loss: 5.354 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.629563570022583
Epoch: 63, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.413 Vali Acc: 0.215 Test Loss: 5.413 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23294117647058823
model parameter : 39704
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2985808849334717
Epoch: 1, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.333 Vali Acc: 0.028 Test Loss: 3.333 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.7405812740325928
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.323 Vali Acc: 0.039 Test Loss: 3.323 Test Acc: 0.039
Validation loss decreased (-0.028202 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.8848612308502197
Epoch: 3, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.310 Vali Acc: 0.048 Test Loss: 3.310 Test Acc: 0.048
Validation loss decreased (-0.038790 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.7489135265350342
Epoch: 4, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.296 Vali Acc: 0.059 Test Loss: 3.296 Test Acc: 0.059
Validation loss decreased (-0.048202 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 0.8658075332641602
Epoch: 5, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.281 Vali Acc: 0.076 Test Loss: 3.281 Test Acc: 0.076
Validation loss decreased (-0.058791 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.851027250289917
Epoch: 6, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.270 Vali Acc: 0.087 Test Loss: 3.270 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 0.7070822715759277
Epoch: 7, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.258 Vali Acc: 0.106 Test Loss: 3.258 Test Acc: 0.106
Validation loss decreased (-0.087026 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 0.5653600692749023
Epoch: 8, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.249 Vali Acc: 0.112 Test Loss: 3.249 Test Acc: 0.112
Validation loss decreased (-0.105850 --> -0.111732).  Saving model ...
Epoch: 9 cost time: 0.7041070461273193
Epoch: 9, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.242 Vali Acc: 0.119 Test Loss: 3.242 Test Acc: 0.119
Validation loss decreased (-0.111732 --> -0.118791).  Saving model ...
Epoch: 10 cost time: 0.676992654800415
Epoch: 10, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.238 Vali Acc: 0.120 Test Loss: 3.238 Test Acc: 0.120
Validation loss decreased (-0.118791 --> -0.119968).  Saving model ...
Epoch: 11 cost time: 0.8923413753509521
Epoch: 11, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.234 Vali Acc: 0.129 Test Loss: 3.234 Test Acc: 0.129
Validation loss decreased (-0.119968 --> -0.129379).  Saving model ...
Epoch: 12 cost time: 0.6733860969543457
Epoch: 12, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.232 Vali Acc: 0.135 Test Loss: 3.232 Test Acc: 0.135
Validation loss decreased (-0.129379 --> -0.135262).  Saving model ...
Epoch: 13 cost time: 0.6496119499206543
Epoch: 13, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.232 Vali Acc: 0.140 Test Loss: 3.232 Test Acc: 0.140
Validation loss decreased (-0.135262 --> -0.139968).  Saving model ...
Epoch: 14 cost time: 0.7100644111633301
Epoch: 14, Steps: 10 | Train Loss: 2.101 Vali Loss: 3.234 Vali Acc: 0.148 Test Loss: 3.234 Test Acc: 0.148
Validation loss decreased (-0.139968 --> -0.148203).  Saving model ...
Epoch: 15 cost time: 0.6605982780456543
Epoch: 15, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.240 Vali Acc: 0.149 Test Loss: 3.240 Test Acc: 0.149
Validation loss decreased (-0.148203 --> -0.149379).  Saving model ...
Epoch: 16 cost time: 0.8601813316345215
Epoch: 16, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.245 Vali Acc: 0.149 Test Loss: 3.245 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7517514228820801
Epoch: 17, Steps: 10 | Train Loss: 1.774 Vali Loss: 3.253 Vali Acc: 0.162 Test Loss: 3.253 Test Acc: 0.162
Validation loss decreased (-0.149379 --> -0.162320).  Saving model ...
Epoch: 18 cost time: 0.6692767143249512
Epoch: 18, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.264 Vali Acc: 0.172 Test Loss: 3.264 Test Acc: 0.172
Validation loss decreased (-0.162320 --> -0.171732).  Saving model ...
Epoch: 19 cost time: 0.7425858974456787
Epoch: 19, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.279 Vali Acc: 0.176 Test Loss: 3.279 Test Acc: 0.176
Validation loss decreased (-0.171732 --> -0.176438).  Saving model ...
Epoch: 20 cost time: 0.6651861667633057
Epoch: 20, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.295 Vali Acc: 0.175 Test Loss: 3.295 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9232571125030518
Epoch: 21, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.313 Vali Acc: 0.174 Test Loss: 3.313 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5187101364135742
Epoch: 22, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.334 Vali Acc: 0.184 Test Loss: 3.334 Test Acc: 0.184
Validation loss decreased (-0.176438 --> -0.183496).  Saving model ...
Epoch: 23 cost time: 0.7043817043304443
Epoch: 23, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.348 Vali Acc: 0.188 Test Loss: 3.348 Test Acc: 0.188
Validation loss decreased (-0.183496 --> -0.188202).  Saving model ...
Epoch: 24 cost time: 0.5025272369384766
Epoch: 24, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.369 Vali Acc: 0.191 Test Loss: 3.369 Test Acc: 0.191
Validation loss decreased (-0.188202 --> -0.190555).  Saving model ...
Epoch: 25 cost time: 0.7273256778717041
Epoch: 25, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.396 Vali Acc: 0.196 Test Loss: 3.396 Test Acc: 0.196
Validation loss decreased (-0.190555 --> -0.196437).  Saving model ...
Epoch: 26 cost time: 0.6236276626586914
Epoch: 26, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.421 Vali Acc: 0.201 Test Loss: 3.421 Test Acc: 0.201
Validation loss decreased (-0.196437 --> -0.201142).  Saving model ...
Epoch: 27 cost time: 0.6115016937255859
Epoch: 27, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.451 Vali Acc: 0.199 Test Loss: 3.451 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6379706859588623
Epoch: 28, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.485 Vali Acc: 0.202 Test Loss: 3.485 Test Acc: 0.202
Validation loss decreased (-0.201142 --> -0.202318).  Saving model ...
Epoch: 29 cost time: 0.632479190826416
Epoch: 29, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.512 Vali Acc: 0.207 Test Loss: 3.512 Test Acc: 0.207
Validation loss decreased (-0.202318 --> -0.207024).  Saving model ...
Epoch: 30 cost time: 1.097700834274292
Epoch: 30, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.549 Vali Acc: 0.208 Test Loss: 3.549 Test Acc: 0.208
Validation loss decreased (-0.207024 --> -0.208200).  Saving model ...
Epoch: 31 cost time: 0.6458330154418945
Epoch: 31, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.584 Vali Acc: 0.208 Test Loss: 3.584 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.593275785446167
Epoch: 32, Steps: 10 | Train Loss: 0.663 Vali Loss: 3.623 Vali Acc: 0.207 Test Loss: 3.623 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5781605243682861
Epoch: 33, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.658 Vali Acc: 0.204 Test Loss: 3.658 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9837710857391357
Epoch: 34, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.690 Vali Acc: 0.208 Test Loss: 3.690 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6777303218841553
Epoch: 35, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.728 Vali Acc: 0.205 Test Loss: 3.728 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6669096946716309
Epoch: 36, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.774 Vali Acc: 0.204 Test Loss: 3.774 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.541980504989624
Epoch: 37, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.835 Vali Acc: 0.200 Test Loss: 3.835 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5755331516265869
Epoch: 38, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.874 Vali Acc: 0.198 Test Loss: 3.874 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7423639297485352
Epoch: 39, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.917 Vali Acc: 0.204 Test Loss: 3.917 Test Acc: 0.204
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7623167037963867
Epoch: 40, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.954 Vali Acc: 0.213 Test Loss: 3.954 Test Acc: 0.213
Validation loss decreased (-0.208200 --> -0.212902).  Saving model ...
Epoch: 41 cost time: 0.755150318145752
Epoch: 41, Steps: 10 | Train Loss: 0.332 Vali Loss: 4.016 Vali Acc: 0.201 Test Loss: 4.016 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7988686561584473
Epoch: 42, Steps: 10 | Train Loss: 0.306 Vali Loss: 4.053 Vali Acc: 0.211 Test Loss: 4.053 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6713879108428955
Epoch: 43, Steps: 10 | Train Loss: 0.270 Vali Loss: 4.105 Vali Acc: 0.208 Test Loss: 4.105 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9867055416107178
Epoch: 44, Steps: 10 | Train Loss: 0.266 Vali Loss: 4.147 Vali Acc: 0.209 Test Loss: 4.147 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8967494964599609
Epoch: 45, Steps: 10 | Train Loss: 0.244 Vali Loss: 4.198 Vali Acc: 0.207 Test Loss: 4.198 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6572408676147461
Epoch: 46, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.245 Vali Acc: 0.214 Test Loss: 4.245 Test Acc: 0.214
Validation loss decreased (-0.212902 --> -0.214075).  Saving model ...
Epoch: 47 cost time: 0.6940224170684814
Epoch: 47, Steps: 10 | Train Loss: 0.192 Vali Loss: 4.303 Vali Acc: 0.214 Test Loss: 4.303 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6492035388946533
Epoch: 48, Steps: 10 | Train Loss: 0.177 Vali Loss: 4.354 Vali Acc: 0.211 Test Loss: 4.354 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7089083194732666
Epoch: 49, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.405 Vali Acc: 0.216 Test Loss: 4.405 Test Acc: 0.216
Validation loss decreased (-0.214075 --> -0.216427).  Saving model ...
Epoch: 50 cost time: 0.6196146011352539
Epoch: 50, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.466 Vali Acc: 0.216 Test Loss: 4.466 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6878938674926758
Epoch: 51, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.517 Vali Acc: 0.214 Test Loss: 4.517 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6239869594573975
Epoch: 52, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.567 Vali Acc: 0.215 Test Loss: 4.567 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8072106838226318
Epoch: 53, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.611 Vali Acc: 0.218 Test Loss: 4.611 Test Acc: 0.218
Validation loss decreased (-0.216427 --> -0.217601).  Saving model ...
Epoch: 54 cost time: 0.6848549842834473
Epoch: 54, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.665 Vali Acc: 0.221 Test Loss: 4.665 Test Acc: 0.221
Validation loss decreased (-0.217601 --> -0.221130).  Saving model ...
Epoch: 55 cost time: 0.6033227443695068
Epoch: 55, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.730 Vali Acc: 0.221 Test Loss: 4.730 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7258093357086182
Epoch: 56, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.796 Vali Acc: 0.224 Test Loss: 4.796 Test Acc: 0.224
Validation loss decreased (-0.221130 --> -0.223481).  Saving model ...
Epoch: 57 cost time: 0.6568450927734375
Epoch: 57, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.860 Vali Acc: 0.219 Test Loss: 4.860 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7795844078063965
Epoch: 58, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.902 Vali Acc: 0.220 Test Loss: 4.902 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7642357349395752
Epoch: 59, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.964 Vali Acc: 0.220 Test Loss: 4.964 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.6372354030609131
Epoch: 60, Steps: 10 | Train Loss: 0.059 Vali Loss: 5.015 Vali Acc: 0.224 Test Loss: 5.015 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.7589232921600342
Epoch: 61, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.066 Vali Acc: 0.220 Test Loss: 5.066 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.6840894222259521
Epoch: 62, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.125 Vali Acc: 0.215 Test Loss: 5.125 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.796051025390625
Epoch: 63, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.189 Vali Acc: 0.219 Test Loss: 5.189 Test Acc: 0.219
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.7639541625976562
Epoch: 64, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.222 Vali Acc: 0.221 Test Loss: 5.222 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.8005485534667969
Epoch: 65, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.276 Vali Acc: 0.221 Test Loss: 5.276 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.7652552127838135
Epoch: 66, Steps: 10 | Train Loss: 0.037 Vali Loss: 5.324 Vali Acc: 0.220 Test Loss: 5.324 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 39302
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0970494747161865
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.323 Vali Acc: 0.024 Test Loss: 3.323 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 0.7067666053771973
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.311 Vali Acc: 0.026 Test Loss: 3.311 Test Acc: 0.026
Validation loss decreased (-0.023496 --> -0.025849).  Saving model ...
Epoch: 3 cost time: 0.6106445789337158
Epoch: 3, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.296 Vali Acc: 0.032 Test Loss: 3.296 Test Acc: 0.032
Validation loss decreased (-0.025849 --> -0.031732).  Saving model ...
Epoch: 4 cost time: 0.6053857803344727
Epoch: 4, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.278 Vali Acc: 0.041 Test Loss: 3.278 Test Acc: 0.041
Validation loss decreased (-0.031732 --> -0.041144).  Saving model ...
Epoch: 5 cost time: 0.6176567077636719
Epoch: 5, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.263 Vali Acc: 0.047 Test Loss: 3.263 Test Acc: 0.047
Validation loss decreased (-0.041144 --> -0.047026).  Saving model ...
Epoch: 6 cost time: 0.689368486404419
Epoch: 6, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.249 Vali Acc: 0.058 Test Loss: 3.249 Test Acc: 0.058
Validation loss decreased (-0.047026 --> -0.057615).  Saving model ...
Epoch: 7 cost time: 0.7243566513061523
Epoch: 7, Steps: 10 | Train Loss: 2.857 Vali Loss: 3.235 Vali Acc: 0.078 Test Loss: 3.235 Test Acc: 0.078
Validation loss decreased (-0.057615 --> -0.077615).  Saving model ...
Epoch: 8 cost time: 0.7087304592132568
Epoch: 8, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.223 Vali Acc: 0.085 Test Loss: 3.223 Test Acc: 0.085
Validation loss decreased (-0.077615 --> -0.084674).  Saving model ...
Epoch: 9 cost time: 0.7891016006469727
Epoch: 9, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.214 Vali Acc: 0.092 Test Loss: 3.214 Test Acc: 0.092
Validation loss decreased (-0.084674 --> -0.091733).  Saving model ...
Epoch: 10 cost time: 0.6960208415985107
Epoch: 10, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.206 Vali Acc: 0.098 Test Loss: 3.206 Test Acc: 0.098
Validation loss decreased (-0.091733 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 0.7577846050262451
Epoch: 11, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.203 Vali Acc: 0.112 Test Loss: 3.203 Test Acc: 0.112
Validation loss decreased (-0.097615 --> -0.111733).  Saving model ...
Epoch: 12 cost time: 0.662564754486084
Epoch: 12, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.202 Vali Acc: 0.119 Test Loss: 3.202 Test Acc: 0.119
Validation loss decreased (-0.111733 --> -0.118792).  Saving model ...
Epoch: 13 cost time: 0.7102735042572021
Epoch: 13, Steps: 10 | Train Loss: 2.214 Vali Loss: 3.202 Vali Acc: 0.127 Test Loss: 3.202 Test Acc: 0.127
Validation loss decreased (-0.118792 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.6328537464141846
Epoch: 14, Steps: 10 | Train Loss: 2.145 Vali Loss: 3.208 Vali Acc: 0.134 Test Loss: 3.208 Test Acc: 0.134
Validation loss decreased (-0.127027 --> -0.134086).  Saving model ...
Epoch: 15 cost time: 0.637425422668457
Epoch: 15, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.214 Vali Acc: 0.139 Test Loss: 3.214 Test Acc: 0.139
Validation loss decreased (-0.134086 --> -0.138791).  Saving model ...
Epoch: 16 cost time: 0.6654222011566162
Epoch: 16, Steps: 10 | Train Loss: 1.920 Vali Loss: 3.224 Vali Acc: 0.144 Test Loss: 3.224 Test Acc: 0.144
Validation loss decreased (-0.138791 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 0.7133796215057373
Epoch: 17, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.236 Vali Acc: 0.151 Test Loss: 3.236 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 1.0062251091003418
Epoch: 18, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.253 Vali Acc: 0.154 Test Loss: 3.253 Test Acc: 0.154
Validation loss decreased (-0.150556 --> -0.154085).  Saving model ...
Epoch: 19 cost time: 0.6057257652282715
Epoch: 19, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.266 Vali Acc: 0.167 Test Loss: 3.266 Test Acc: 0.167
Validation loss decreased (-0.154085 --> -0.167026).  Saving model ...
Epoch: 20 cost time: 0.6962170600891113
Epoch: 20, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.284 Vali Acc: 0.171 Test Loss: 3.284 Test Acc: 0.171
Validation loss decreased (-0.167026 --> -0.170555).  Saving model ...
Epoch: 21 cost time: 0.6238613128662109
Epoch: 21, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.305 Vali Acc: 0.171 Test Loss: 3.305 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6352925300598145
Epoch: 22, Steps: 10 | Train Loss: 1.348 Vali Loss: 3.326 Vali Acc: 0.176 Test Loss: 3.326 Test Acc: 0.176
Validation loss decreased (-0.170555 --> -0.176437).  Saving model ...
Epoch: 23 cost time: 0.7595655918121338
Epoch: 23, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.347 Vali Acc: 0.181 Test Loss: 3.347 Test Acc: 0.181
Validation loss decreased (-0.176437 --> -0.181143).  Saving model ...
Epoch: 24 cost time: 0.7828614711761475
Epoch: 24, Steps: 10 | Train Loss: 1.207 Vali Loss: 3.371 Vali Acc: 0.187 Test Loss: 3.371 Test Acc: 0.187
Validation loss decreased (-0.181143 --> -0.187025).  Saving model ...
Epoch: 25 cost time: 0.7054615020751953
Epoch: 25, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.399 Vali Acc: 0.189 Test Loss: 3.399 Test Acc: 0.189
Validation loss decreased (-0.187025 --> -0.189378).  Saving model ...
Epoch: 26 cost time: 0.703632116317749
Epoch: 26, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.429 Vali Acc: 0.192 Test Loss: 3.429 Test Acc: 0.192
Validation loss decreased (-0.189378 --> -0.191730).  Saving model ...
Epoch: 27 cost time: 0.5705215930938721
Epoch: 27, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.461 Vali Acc: 0.192 Test Loss: 3.461 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7466847896575928
Epoch: 28, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.490 Vali Acc: 0.198 Test Loss: 3.490 Test Acc: 0.198
Validation loss decreased (-0.191730 --> -0.197612).  Saving model ...
Epoch: 29 cost time: 0.589745044708252
Epoch: 29, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.525 Vali Acc: 0.200 Test Loss: 3.525 Test Acc: 0.200
Validation loss decreased (-0.197612 --> -0.199965).  Saving model ...
Epoch: 30 cost time: 0.6012129783630371
Epoch: 30, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.556 Vali Acc: 0.204 Test Loss: 3.556 Test Acc: 0.204
Validation loss decreased (-0.199965 --> -0.203494).  Saving model ...
Epoch: 31 cost time: 0.8003652095794678
Epoch: 31, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.593 Vali Acc: 0.206 Test Loss: 3.593 Test Acc: 0.206
Validation loss decreased (-0.203494 --> -0.205846).  Saving model ...
Epoch: 32 cost time: 0.6994848251342773
Epoch: 32, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.633 Vali Acc: 0.201 Test Loss: 3.633 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7420578002929688
Epoch: 33, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.671 Vali Acc: 0.206 Test Loss: 3.671 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6197435855865479
Epoch: 34, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.711 Vali Acc: 0.212 Test Loss: 3.711 Test Acc: 0.212
Validation loss decreased (-0.205846 --> -0.211728).  Saving model ...
Epoch: 35 cost time: 0.5603904724121094
Epoch: 35, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.755 Vali Acc: 0.202 Test Loss: 3.755 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7147059440612793
Epoch: 36, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.797 Vali Acc: 0.201 Test Loss: 3.797 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6182231903076172
Epoch: 37, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.844 Vali Acc: 0.208 Test Loss: 3.844 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6541533470153809
Epoch: 38, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.899 Vali Acc: 0.205 Test Loss: 3.899 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8285665512084961
Epoch: 39, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.947 Vali Acc: 0.205 Test Loss: 3.947 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6317377090454102
Epoch: 40, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.984 Vali Acc: 0.206 Test Loss: 3.984 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7272794246673584
Epoch: 41, Steps: 10 | Train Loss: 0.305 Vali Loss: 4.025 Vali Acc: 0.209 Test Loss: 4.025 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6377999782562256
Epoch: 42, Steps: 10 | Train Loss: 0.283 Vali Loss: 4.083 Vali Acc: 0.209 Test Loss: 4.083 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6483058929443359
Epoch: 43, Steps: 10 | Train Loss: 0.280 Vali Loss: 4.142 Vali Acc: 0.209 Test Loss: 4.142 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8044428825378418
Epoch: 44, Steps: 10 | Train Loss: 0.236 Vali Loss: 4.193 Vali Acc: 0.207 Test Loss: 4.193 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21176470588235294
model parameter : 38936
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3211019039154053
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.319 Vali Acc: 0.040 Test Loss: 3.319 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.8614132404327393
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.308 Vali Acc: 0.041 Test Loss: 3.308 Test Acc: 0.041
Validation loss decreased (-0.039967 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.8621134757995605
Epoch: 3, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.295 Vali Acc: 0.041 Test Loss: 3.295 Test Acc: 0.041
Validation loss decreased (-0.041143 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.6558225154876709
Epoch: 4, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.281 Vali Acc: 0.052 Test Loss: 3.281 Test Acc: 0.052
Validation loss decreased (-0.041144 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.6711199283599854
Epoch: 5, Steps: 10 | Train Loss: 3.065 Vali Loss: 3.269 Vali Acc: 0.061 Test Loss: 3.269 Test Acc: 0.061
Validation loss decreased (-0.051732 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.7434923648834229
Epoch: 6, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.257 Vali Acc: 0.071 Test Loss: 3.257 Test Acc: 0.071
Validation loss decreased (-0.061144 --> -0.070556).  Saving model ...
Epoch: 7 cost time: 0.9674203395843506
Epoch: 7, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.247 Vali Acc: 0.085 Test Loss: 3.247 Test Acc: 0.085
Validation loss decreased (-0.070556 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.6566190719604492
Epoch: 8, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.238 Vali Acc: 0.091 Test Loss: 3.238 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.6044390201568604
Epoch: 9, Steps: 10 | Train Loss: 2.714 Vali Loss: 3.230 Vali Acc: 0.092 Test Loss: 3.230 Test Acc: 0.092
Validation loss decreased (-0.090556 --> -0.091732).  Saving model ...
Epoch: 10 cost time: 0.6547427177429199
Epoch: 10, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.223 Vali Acc: 0.101 Test Loss: 3.223 Test Acc: 0.101
Validation loss decreased (-0.091732 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.6272404193878174
Epoch: 11, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.218 Vali Acc: 0.107 Test Loss: 3.218 Test Acc: 0.107
Validation loss decreased (-0.101144 --> -0.107027).  Saving model ...
Epoch: 12 cost time: 0.7787253856658936
Epoch: 12, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.216 Vali Acc: 0.112 Test Loss: 3.216 Test Acc: 0.112
Validation loss decreased (-0.107027 --> -0.111733).  Saving model ...
Epoch: 13 cost time: 0.6156442165374756
Epoch: 13, Steps: 10 | Train Loss: 2.279 Vali Loss: 3.215 Vali Acc: 0.118 Test Loss: 3.215 Test Acc: 0.118
Validation loss decreased (-0.111733 --> -0.117615).  Saving model ...
Epoch: 14 cost time: 0.7316725254058838
Epoch: 14, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.218 Vali Acc: 0.121 Test Loss: 3.218 Test Acc: 0.121
Validation loss decreased (-0.117615 --> -0.121144).  Saving model ...
Epoch: 15 cost time: 0.7167110443115234
Epoch: 15, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.222 Vali Acc: 0.124 Test Loss: 3.222 Test Acc: 0.124
Validation loss decreased (-0.121144 --> -0.123497).  Saving model ...
Epoch: 16 cost time: 0.7192180156707764
Epoch: 16, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.227 Vali Acc: 0.129 Test Loss: 3.227 Test Acc: 0.129
Validation loss decreased (-0.123497 --> -0.129379).  Saving model ...
Epoch: 17 cost time: 0.7660567760467529
Epoch: 17, Steps: 10 | Train Loss: 1.910 Vali Loss: 3.235 Vali Acc: 0.140 Test Loss: 3.235 Test Acc: 0.140
Validation loss decreased (-0.129379 --> -0.139968).  Saving model ...
Epoch: 18 cost time: 0.650665283203125
Epoch: 18, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.242 Vali Acc: 0.142 Test Loss: 3.242 Test Acc: 0.142
Validation loss decreased (-0.139968 --> -0.142321).  Saving model ...
Epoch: 19 cost time: 0.6121108531951904
Epoch: 19, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.254 Vali Acc: 0.148 Test Loss: 3.254 Test Acc: 0.148
Validation loss decreased (-0.142321 --> -0.148203).  Saving model ...
Epoch: 20 cost time: 0.6081578731536865
Epoch: 20, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.264 Vali Acc: 0.153 Test Loss: 3.264 Test Acc: 0.153
Validation loss decreased (-0.148203 --> -0.152909).  Saving model ...
Epoch: 21 cost time: 0.6431527137756348
Epoch: 21, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.278 Vali Acc: 0.166 Test Loss: 3.278 Test Acc: 0.166
Validation loss decreased (-0.152909 --> -0.165850).  Saving model ...
Epoch: 22 cost time: 0.6134200096130371
Epoch: 22, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.296 Vali Acc: 0.164 Test Loss: 3.296 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6147258281707764
Epoch: 23, Steps: 10 | Train Loss: 1.328 Vali Loss: 3.317 Vali Acc: 0.176 Test Loss: 3.317 Test Acc: 0.176
Validation loss decreased (-0.165850 --> -0.176437).  Saving model ...
Epoch: 24 cost time: 0.8065040111541748
Epoch: 24, Steps: 10 | Train Loss: 1.249 Vali Loss: 3.336 Vali Acc: 0.178 Test Loss: 3.336 Test Acc: 0.178
Validation loss decreased (-0.176437 --> -0.177614).  Saving model ...
Epoch: 25 cost time: 0.7611544132232666
Epoch: 25, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.360 Vali Acc: 0.182 Test Loss: 3.360 Test Acc: 0.182
Validation loss decreased (-0.177614 --> -0.182319).  Saving model ...
Epoch: 26 cost time: 0.6412618160247803
Epoch: 26, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.386 Vali Acc: 0.186 Test Loss: 3.386 Test Acc: 0.186
Validation loss decreased (-0.182319 --> -0.185848).  Saving model ...
Epoch: 27 cost time: 0.77091383934021
Epoch: 27, Steps: 10 | Train Loss: 1.014 Vali Loss: 3.417 Vali Acc: 0.184 Test Loss: 3.417 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8320763111114502
Epoch: 28, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.450 Vali Acc: 0.187 Test Loss: 3.450 Test Acc: 0.187
Validation loss decreased (-0.185848 --> -0.187024).  Saving model ...
Epoch: 29 cost time: 0.6369855403900146
Epoch: 29, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.483 Vali Acc: 0.193 Test Loss: 3.483 Test Acc: 0.193
Validation loss decreased (-0.187024 --> -0.192906).  Saving model ...
Epoch: 30 cost time: 0.6462626457214355
Epoch: 30, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.511 Vali Acc: 0.196 Test Loss: 3.511 Test Acc: 0.196
Validation loss decreased (-0.192906 --> -0.196435).  Saving model ...
Epoch: 31 cost time: 0.7713220119476318
Epoch: 31, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.544 Vali Acc: 0.198 Test Loss: 3.544 Test Acc: 0.198
Validation loss decreased (-0.196435 --> -0.197612).  Saving model ...
Epoch: 32 cost time: 0.6017651557922363
Epoch: 32, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.586 Vali Acc: 0.199 Test Loss: 3.586 Test Acc: 0.199
Validation loss decreased (-0.197612 --> -0.198788).  Saving model ...
Epoch: 33 cost time: 0.6951515674591064
Epoch: 33, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.619 Vali Acc: 0.204 Test Loss: 3.619 Test Acc: 0.204
Validation loss decreased (-0.198788 --> -0.203493).  Saving model ...
Epoch: 34 cost time: 0.7405333518981934
Epoch: 34, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.657 Vali Acc: 0.206 Test Loss: 3.657 Test Acc: 0.206
Validation loss decreased (-0.203493 --> -0.205846).  Saving model ...
Epoch: 35 cost time: 0.845952033996582
Epoch: 35, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.698 Vali Acc: 0.201 Test Loss: 3.698 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.786020040512085
Epoch: 36, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.741 Vali Acc: 0.204 Test Loss: 3.741 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5592236518859863
Epoch: 37, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.789 Vali Acc: 0.201 Test Loss: 3.789 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7081141471862793
Epoch: 38, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.840 Vali Acc: 0.204 Test Loss: 3.840 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6839039325714111
Epoch: 39, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.890 Vali Acc: 0.201 Test Loss: 3.890 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9185605049133301
Epoch: 40, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.949 Vali Acc: 0.206 Test Loss: 3.949 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7215800285339355
Epoch: 41, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.996 Vali Acc: 0.211 Test Loss: 3.996 Test Acc: 0.211
Validation loss decreased (-0.205846 --> -0.210548).  Saving model ...
Epoch: 42 cost time: 0.7859032154083252
Epoch: 42, Steps: 10 | Train Loss: 0.302 Vali Loss: 4.043 Vali Acc: 0.211 Test Loss: 4.043 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9106440544128418
Epoch: 43, Steps: 10 | Train Loss: 0.278 Vali Loss: 4.102 Vali Acc: 0.212 Test Loss: 4.102 Test Acc: 0.212
Validation loss decreased (-0.210548 --> -0.211724).  Saving model ...
Epoch: 44 cost time: 0.7635014057159424
Epoch: 44, Steps: 10 | Train Loss: 0.296 Vali Loss: 4.153 Vali Acc: 0.213 Test Loss: 4.153 Test Acc: 0.213
Validation loss decreased (-0.211724 --> -0.212900).  Saving model ...
Epoch: 45 cost time: 0.7605228424072266
Epoch: 45, Steps: 10 | Train Loss: 0.242 Vali Loss: 4.198 Vali Acc: 0.211 Test Loss: 4.198 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7688894271850586
Epoch: 46, Steps: 10 | Train Loss: 0.215 Vali Loss: 4.258 Vali Acc: 0.209 Test Loss: 4.258 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.01444673538208
Epoch: 47, Steps: 10 | Train Loss: 0.194 Vali Loss: 4.320 Vali Acc: 0.211 Test Loss: 4.320 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9354379177093506
Epoch: 48, Steps: 10 | Train Loss: 0.182 Vali Loss: 4.359 Vali Acc: 0.211 Test Loss: 4.359 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6911196708679199
Epoch: 49, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.406 Vali Acc: 0.215 Test Loss: 4.406 Test Acc: 0.215
Validation loss decreased (-0.212900 --> -0.215250).  Saving model ...
Epoch: 50 cost time: 0.9042270183563232
Epoch: 50, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.458 Vali Acc: 0.209 Test Loss: 4.458 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8310031890869141
Epoch: 51, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.531 Vali Acc: 0.213 Test Loss: 4.531 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7294797897338867
Epoch: 52, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.583 Vali Acc: 0.213 Test Loss: 4.583 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7723102569580078
Epoch: 53, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.650 Vali Acc: 0.213 Test Loss: 4.650 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.6503269672393799
Epoch: 54, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.700 Vali Acc: 0.209 Test Loss: 4.700 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6943316459655762
Epoch: 55, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.762 Vali Acc: 0.209 Test Loss: 4.762 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5945389270782471
Epoch: 56, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.804 Vali Acc: 0.208 Test Loss: 4.804 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.7521302700042725
Epoch: 57, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.859 Vali Acc: 0.206 Test Loss: 4.859 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.8590335845947266
Epoch: 58, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.932 Vali Acc: 0.209 Test Loss: 4.932 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.5915369987487793
Epoch: 59, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.979 Vali Acc: 0.209 Test Loss: 4.979 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21529411764705883
model parameter : 39062
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1193628311157227
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.320 Vali Acc: 0.045 Test Loss: 3.320 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.921154260635376
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.309 Vali Acc: 0.053 Test Loss: 3.309 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.6503582000732422
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.295 Vali Acc: 0.058 Test Loss: 3.295 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.658513069152832
Epoch: 4, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.281 Vali Acc: 0.060 Test Loss: 3.281 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.7948744297027588
Epoch: 5, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.266 Vali Acc: 0.072 Test Loss: 3.266 Test Acc: 0.072
Validation loss decreased (-0.059967 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.9688937664031982
Epoch: 6, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.254 Vali Acc: 0.084 Test Loss: 3.254 Test Acc: 0.084
Validation loss decreased (-0.071732 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 0.9091734886169434
Epoch: 7, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.244 Vali Acc: 0.094 Test Loss: 3.244 Test Acc: 0.094
Validation loss decreased (-0.083497 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 0.6902446746826172
Epoch: 8, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.235 Vali Acc: 0.100 Test Loss: 3.235 Test Acc: 0.100
Validation loss decreased (-0.094085 --> -0.099968).  Saving model ...
Epoch: 9 cost time: 0.8008050918579102
Epoch: 9, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.226 Vali Acc: 0.106 Test Loss: 3.226 Test Acc: 0.106
Validation loss decreased (-0.099968 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 0.6000175476074219
Epoch: 10, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.221 Vali Acc: 0.111 Test Loss: 3.221 Test Acc: 0.111
Validation loss decreased (-0.105850 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 0.8230223655700684
Epoch: 11, Steps: 10 | Train Loss: 2.467 Vali Loss: 3.219 Vali Acc: 0.118 Test Loss: 3.219 Test Acc: 0.118
Validation loss decreased (-0.110556 --> -0.117615).  Saving model ...
Epoch: 12 cost time: 0.9346756935119629
Epoch: 12, Steps: 10 | Train Loss: 2.382 Vali Loss: 3.217 Vali Acc: 0.121 Test Loss: 3.217 Test Acc: 0.121
Validation loss decreased (-0.117615 --> -0.121144).  Saving model ...
Epoch: 13 cost time: 0.7518022060394287
Epoch: 13, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.219 Vali Acc: 0.132 Test Loss: 3.219 Test Acc: 0.132
Validation loss decreased (-0.121144 --> -0.131733).  Saving model ...
Epoch: 14 cost time: 0.6987922191619873
Epoch: 14, Steps: 10 | Train Loss: 2.178 Vali Loss: 3.218 Vali Acc: 0.135 Test Loss: 3.218 Test Acc: 0.135
Validation loss decreased (-0.131733 --> -0.135262).  Saving model ...
Epoch: 15 cost time: 0.9789133071899414
Epoch: 15, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.221 Vali Acc: 0.141 Test Loss: 3.221 Test Acc: 0.141
Validation loss decreased (-0.135262 --> -0.141144).  Saving model ...
Epoch: 16 cost time: 0.8961551189422607
Epoch: 16, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.224 Vali Acc: 0.153 Test Loss: 3.224 Test Acc: 0.153
Validation loss decreased (-0.141144 --> -0.152909).  Saving model ...
Epoch: 17 cost time: 0.7191712856292725
Epoch: 17, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.230 Vali Acc: 0.154 Test Loss: 3.230 Test Acc: 0.154
Validation loss decreased (-0.152909 --> -0.154085).  Saving model ...
Epoch: 18 cost time: 0.6510791778564453
Epoch: 18, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.241 Vali Acc: 0.160 Test Loss: 3.241 Test Acc: 0.160
Validation loss decreased (-0.154085 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 0.7432241439819336
Epoch: 19, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.254 Vali Acc: 0.172 Test Loss: 3.254 Test Acc: 0.172
Validation loss decreased (-0.159968 --> -0.171732).  Saving model ...
Epoch: 20 cost time: 0.7856676578521729
Epoch: 20, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.264 Vali Acc: 0.180 Test Loss: 3.264 Test Acc: 0.180
Validation loss decreased (-0.171732 --> -0.179967).  Saving model ...
Epoch: 21 cost time: 0.6468460559844971
Epoch: 21, Steps: 10 | Train Loss: 1.506 Vali Loss: 3.281 Vali Acc: 0.184 Test Loss: 3.281 Test Acc: 0.184
Validation loss decreased (-0.179967 --> -0.183497).  Saving model ...
Epoch: 22 cost time: 0.7207052707672119
Epoch: 22, Steps: 10 | Train Loss: 1.416 Vali Loss: 3.298 Vali Acc: 0.191 Test Loss: 3.298 Test Acc: 0.191
Validation loss decreased (-0.183497 --> -0.190555).  Saving model ...
Epoch: 23 cost time: 0.6317718029022217
Epoch: 23, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.322 Vali Acc: 0.194 Test Loss: 3.322 Test Acc: 0.194
Validation loss decreased (-0.190555 --> -0.194084).  Saving model ...
Epoch: 24 cost time: 0.8844203948974609
Epoch: 24, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.349 Vali Acc: 0.200 Test Loss: 3.349 Test Acc: 0.200
Validation loss decreased (-0.194084 --> -0.199967).  Saving model ...
Epoch: 25 cost time: 0.975752592086792
Epoch: 25, Steps: 10 | Train Loss: 1.181 Vali Loss: 3.375 Vali Acc: 0.200 Test Loss: 3.375 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8448011875152588
Epoch: 26, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.402 Vali Acc: 0.204 Test Loss: 3.402 Test Acc: 0.204
Validation loss decreased (-0.199967 --> -0.203495).  Saving model ...
Epoch: 27 cost time: 0.8311631679534912
Epoch: 27, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.427 Vali Acc: 0.211 Test Loss: 3.427 Test Acc: 0.211
Validation loss decreased (-0.203495 --> -0.210554).  Saving model ...
Epoch: 28 cost time: 0.6427018642425537
Epoch: 28, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.456 Vali Acc: 0.206 Test Loss: 3.456 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7249255180358887
Epoch: 29, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.486 Vali Acc: 0.211 Test Loss: 3.486 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7887794971466064
Epoch: 30, Steps: 10 | Train Loss: 0.817 Vali Loss: 3.518 Vali Acc: 0.209 Test Loss: 3.518 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6490724086761475
Epoch: 31, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.554 Vali Acc: 0.205 Test Loss: 3.554 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7990038394927979
Epoch: 32, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.594 Vali Acc: 0.213 Test Loss: 3.594 Test Acc: 0.213
Validation loss decreased (-0.210554 --> -0.212905).  Saving model ...
Epoch: 33 cost time: 0.8625190258026123
Epoch: 33, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.623 Vali Acc: 0.211 Test Loss: 3.623 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6884064674377441
Epoch: 34, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.664 Vali Acc: 0.212 Test Loss: 3.664 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7162880897521973
Epoch: 35, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.701 Vali Acc: 0.209 Test Loss: 3.701 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7632524967193604
Epoch: 36, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.749 Vali Acc: 0.214 Test Loss: 3.749 Test Acc: 0.214
Validation loss decreased (-0.212905 --> -0.214080).  Saving model ...
Epoch: 37 cost time: 0.7219972610473633
Epoch: 37, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.787 Vali Acc: 0.214 Test Loss: 3.787 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7016057968139648
Epoch: 38, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.832 Vali Acc: 0.213 Test Loss: 3.832 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6510424613952637
Epoch: 39, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.885 Vali Acc: 0.207 Test Loss: 3.885 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6050305366516113
Epoch: 40, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.930 Vali Acc: 0.212 Test Loss: 3.930 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7558009624481201
Epoch: 41, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.972 Vali Acc: 0.214 Test Loss: 3.972 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6735641956329346
Epoch: 42, Steps: 10 | Train Loss: 0.316 Vali Loss: 4.025 Vali Acc: 0.216 Test Loss: 4.025 Test Acc: 0.216
Validation loss decreased (-0.214080 --> -0.216430).  Saving model ...
Epoch: 43 cost time: 0.6963498592376709
Epoch: 43, Steps: 10 | Train Loss: 0.292 Vali Loss: 4.096 Vali Acc: 0.212 Test Loss: 4.096 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6735811233520508
Epoch: 44, Steps: 10 | Train Loss: 0.260 Vali Loss: 4.138 Vali Acc: 0.214 Test Loss: 4.138 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6850874423980713
Epoch: 45, Steps: 10 | Train Loss: 0.242 Vali Loss: 4.205 Vali Acc: 0.212 Test Loss: 4.205 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6432507038116455
Epoch: 46, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.249 Vali Acc: 0.214 Test Loss: 4.249 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6868319511413574
Epoch: 47, Steps: 10 | Train Loss: 0.194 Vali Loss: 4.301 Vali Acc: 0.212 Test Loss: 4.301 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6053531169891357
Epoch: 48, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.375 Vali Acc: 0.207 Test Loss: 4.375 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.66153883934021
Epoch: 49, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.438 Vali Acc: 0.211 Test Loss: 4.438 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7329673767089844
Epoch: 50, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.508 Vali Acc: 0.211 Test Loss: 4.508 Test Acc: 0.211
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7894253730773926
Epoch: 51, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.580 Vali Acc: 0.209 Test Loss: 4.580 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6030409336090088
Epoch: 52, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.659 Vali Acc: 0.206 Test Loss: 4.659 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2164705882352941
model parameter : 40136
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0280914306640625
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.310 Vali Acc: 0.041 Test Loss: 3.310 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.7548689842224121
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.298 Vali Acc: 0.042 Test Loss: 3.298 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.7268497943878174
Epoch: 3, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.286 Vali Acc: 0.051 Test Loss: 3.286 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.7828567028045654
Epoch: 4, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.273 Vali Acc: 0.066 Test Loss: 3.273 Test Acc: 0.066
Validation loss decreased (-0.050555 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 0.6762180328369141
Epoch: 5, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.261 Vali Acc: 0.080 Test Loss: 3.261 Test Acc: 0.080
Validation loss decreased (-0.065850 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.6886258125305176
Epoch: 6, Steps: 10 | Train Loss: 3.013 Vali Loss: 3.251 Vali Acc: 0.086 Test Loss: 3.251 Test Acc: 0.086
Validation loss decreased (-0.079967 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 0.6635868549346924
Epoch: 7, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.242 Vali Acc: 0.096 Test Loss: 3.242 Test Acc: 0.096
Validation loss decreased (-0.085850 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 0.7706918716430664
Epoch: 8, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.234 Vali Acc: 0.106 Test Loss: 3.234 Test Acc: 0.106
Validation loss decreased (-0.096438 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 0.567009687423706
Epoch: 9, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.232 Vali Acc: 0.113 Test Loss: 3.232 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 0.6776838302612305
Epoch: 10, Steps: 10 | Train Loss: 2.622 Vali Loss: 3.229 Vali Acc: 0.116 Test Loss: 3.229 Test Acc: 0.116
Validation loss decreased (-0.112909 --> -0.116438).  Saving model ...
Epoch: 11 cost time: 0.5452308654785156
Epoch: 11, Steps: 10 | Train Loss: 2.487 Vali Loss: 3.226 Vali Acc: 0.120 Test Loss: 3.226 Test Acc: 0.120
Validation loss decreased (-0.116438 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.6905758380889893
Epoch: 12, Steps: 10 | Train Loss: 2.395 Vali Loss: 3.223 Vali Acc: 0.118 Test Loss: 3.223 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5882978439331055
Epoch: 13, Steps: 10 | Train Loss: 2.303 Vali Loss: 3.224 Vali Acc: 0.126 Test Loss: 3.224 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.7665069103240967
Epoch: 14, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.225 Vali Acc: 0.129 Test Loss: 3.225 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129380).  Saving model ...
Epoch: 15 cost time: 0.5867791175842285
Epoch: 15, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.226 Vali Acc: 0.136 Test Loss: 3.226 Test Acc: 0.136
Validation loss decreased (-0.129380 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 0.5968036651611328
Epoch: 16, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.227 Vali Acc: 0.144 Test Loss: 3.227 Test Acc: 0.144
Validation loss decreased (-0.136438 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 0.6150825023651123
Epoch: 17, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.228 Vali Acc: 0.148 Test Loss: 3.228 Test Acc: 0.148
Validation loss decreased (-0.143497 --> -0.148203).  Saving model ...
Epoch: 18 cost time: 0.7019705772399902
Epoch: 18, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.237 Vali Acc: 0.152 Test Loss: 3.237 Test Acc: 0.152
Validation loss decreased (-0.148203 --> -0.151732).  Saving model ...
Epoch: 19 cost time: 0.8466594219207764
Epoch: 19, Steps: 10 | Train Loss: 1.710 Vali Loss: 3.249 Vali Acc: 0.162 Test Loss: 3.249 Test Acc: 0.162
Validation loss decreased (-0.151732 --> -0.162320).  Saving model ...
Epoch: 20 cost time: 0.7409019470214844
Epoch: 20, Steps: 10 | Train Loss: 1.626 Vali Loss: 3.263 Vali Acc: 0.168 Test Loss: 3.263 Test Acc: 0.168
Validation loss decreased (-0.162320 --> -0.168203).  Saving model ...
Epoch: 21 cost time: 0.6129019260406494
Epoch: 21, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.279 Vali Acc: 0.168 Test Loss: 3.279 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6946651935577393
Epoch: 22, Steps: 10 | Train Loss: 1.395 Vali Loss: 3.302 Vali Acc: 0.174 Test Loss: 3.302 Test Acc: 0.174
Validation loss decreased (-0.168203 --> -0.174085).  Saving model ...
Epoch: 23 cost time: 0.8874280452728271
Epoch: 23, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.327 Vali Acc: 0.175 Test Loss: 3.327 Test Acc: 0.175
Validation loss decreased (-0.174085 --> -0.175261).  Saving model ...
Epoch: 24 cost time: 0.8302595615386963
Epoch: 24, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.347 Vali Acc: 0.175 Test Loss: 3.347 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7262704372406006
Epoch: 25, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.375 Vali Acc: 0.185 Test Loss: 3.375 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184672).  Saving model ...
Epoch: 26 cost time: 0.6106977462768555
Epoch: 26, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.405 Vali Acc: 0.187 Test Loss: 3.405 Test Acc: 0.187
Validation loss decreased (-0.184672 --> -0.187025).  Saving model ...
Epoch: 27 cost time: 0.6254231929779053
Epoch: 27, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.434 Vali Acc: 0.192 Test Loss: 3.434 Test Acc: 0.192
Validation loss decreased (-0.187025 --> -0.191730).  Saving model ...
Epoch: 28 cost time: 0.7384769916534424
Epoch: 28, Steps: 10 | Train Loss: 0.943 Vali Loss: 3.466 Vali Acc: 0.192 Test Loss: 3.466 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6653578281402588
Epoch: 29, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.502 Vali Acc: 0.194 Test Loss: 3.502 Test Acc: 0.194
Validation loss decreased (-0.191730 --> -0.194083).  Saving model ...
Epoch: 30 cost time: 0.6557407379150391
Epoch: 30, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.536 Vali Acc: 0.199 Test Loss: 3.536 Test Acc: 0.199
Validation loss decreased (-0.194083 --> -0.198788).  Saving model ...
Epoch: 31 cost time: 0.6236906051635742
Epoch: 31, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.573 Vali Acc: 0.206 Test Loss: 3.573 Test Acc: 0.206
Validation loss decreased (-0.198788 --> -0.205847).  Saving model ...
Epoch: 32 cost time: 0.5897228717803955
Epoch: 32, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.610 Vali Acc: 0.204 Test Loss: 3.610 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.653731107711792
Epoch: 33, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.654 Vali Acc: 0.205 Test Loss: 3.654 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6112134456634521
Epoch: 34, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.701 Vali Acc: 0.208 Test Loss: 3.701 Test Acc: 0.208
Validation loss decreased (-0.205847 --> -0.208198).  Saving model ...
Epoch: 35 cost time: 0.6868674755096436
Epoch: 35, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.735 Vali Acc: 0.214 Test Loss: 3.735 Test Acc: 0.214
Validation loss decreased (-0.208198 --> -0.214080).  Saving model ...
Epoch: 36 cost time: 0.6344926357269287
Epoch: 36, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.774 Vali Acc: 0.214 Test Loss: 3.774 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6742141246795654
Epoch: 37, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.830 Vali Acc: 0.216 Test Loss: 3.830 Test Acc: 0.216
Validation loss decreased (-0.214080 --> -0.216432).  Saving model ...
Epoch: 38 cost time: 0.5530848503112793
Epoch: 38, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.869 Vali Acc: 0.214 Test Loss: 3.869 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8800971508026123
Epoch: 39, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.916 Vali Acc: 0.216 Test Loss: 3.916 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6377630233764648
Epoch: 40, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.977 Vali Acc: 0.218 Test Loss: 3.977 Test Acc: 0.218
Validation loss decreased (-0.216432 --> -0.217607).  Saving model ...
Epoch: 41 cost time: 0.6473712921142578
Epoch: 41, Steps: 10 | Train Loss: 0.330 Vali Loss: 4.018 Vali Acc: 0.216 Test Loss: 4.018 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5807285308837891
Epoch: 42, Steps: 10 | Train Loss: 0.307 Vali Loss: 4.076 Vali Acc: 0.222 Test Loss: 4.076 Test Acc: 0.222
Validation loss decreased (-0.217607 --> -0.222312).  Saving model ...
Epoch: 43 cost time: 0.5565872192382812
Epoch: 43, Steps: 10 | Train Loss: 0.313 Vali Loss: 4.120 Vali Acc: 0.222 Test Loss: 4.120 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7167439460754395
Epoch: 44, Steps: 10 | Train Loss: 0.247 Vali Loss: 4.197 Vali Acc: 0.216 Test Loss: 4.197 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6229648590087891
Epoch: 45, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.224 Vali Acc: 0.222 Test Loss: 4.224 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6986188888549805
Epoch: 46, Steps: 10 | Train Loss: 0.209 Vali Loss: 4.270 Vali Acc: 0.222 Test Loss: 4.270 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6374702453613281
Epoch: 47, Steps: 10 | Train Loss: 0.189 Vali Loss: 4.329 Vali Acc: 0.218 Test Loss: 4.329 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.696807861328125
Epoch: 48, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.392 Vali Acc: 0.218 Test Loss: 4.392 Test Acc: 0.218
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5812859535217285
Epoch: 49, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.486 Vali Acc: 0.216 Test Loss: 4.486 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7351725101470947
Epoch: 50, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.545 Vali Acc: 0.222 Test Loss: 4.545 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7581279277801514
Epoch: 51, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.582 Vali Acc: 0.224 Test Loss: 4.582 Test Acc: 0.224
Validation loss decreased (-0.222312 --> -0.223484).  Saving model ...
Epoch: 52 cost time: 0.7132205963134766
Epoch: 52, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.634 Vali Acc: 0.220 Test Loss: 4.634 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7301630973815918
Epoch: 53, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.735 Vali Acc: 0.220 Test Loss: 4.735 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6205017566680908
Epoch: 54, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.758 Vali Acc: 0.229 Test Loss: 4.758 Test Acc: 0.229
Validation loss decreased (-0.223484 --> -0.229364).  Saving model ...
Epoch: 55 cost time: 0.7481064796447754
Epoch: 55, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.830 Vali Acc: 0.225 Test Loss: 4.830 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6353440284729004
Epoch: 56, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.891 Vali Acc: 0.226 Test Loss: 4.891 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7781774997711182
Epoch: 57, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.936 Vali Acc: 0.225 Test Loss: 4.936 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6763761043548584
Epoch: 58, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.981 Vali Acc: 0.227 Test Loss: 4.981 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6412806510925293
Epoch: 59, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.037 Vali Acc: 0.228 Test Loss: 5.037 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6551659107208252
Epoch: 60, Steps: 10 | Train Loss: 0.059 Vali Loss: 5.094 Vali Acc: 0.226 Test Loss: 5.094 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8107690811157227
Epoch: 61, Steps: 10 | Train Loss: 0.056 Vali Loss: 5.147 Vali Acc: 0.225 Test Loss: 5.147 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.764167308807373
Epoch: 62, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.201 Vali Acc: 0.228 Test Loss: 5.201 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.5794169902801514
Epoch: 63, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.248 Vali Acc: 0.222 Test Loss: 5.248 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7268767356872559
Epoch: 64, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.292 Vali Acc: 0.225 Test Loss: 5.292 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22941176470588234
model parameter : 39206
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.141784191131592
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.312 Vali Acc: 0.042 Test Loss: 3.312 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.6384580135345459
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.302 Vali Acc: 0.044 Test Loss: 3.302 Test Acc: 0.044
Validation loss decreased (-0.042320 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.6426980495452881
Epoch: 3, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.289 Vali Acc: 0.058 Test Loss: 3.289 Test Acc: 0.058
Validation loss decreased (-0.043496 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.5947272777557373
Epoch: 4, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.275 Vali Acc: 0.064 Test Loss: 3.275 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.6011843681335449
Epoch: 5, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.261 Vali Acc: 0.072 Test Loss: 3.261 Test Acc: 0.072
Validation loss decreased (-0.063497 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.6079034805297852
Epoch: 6, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.249 Vali Acc: 0.076 Test Loss: 3.249 Test Acc: 0.076
Validation loss decreased (-0.071732 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.7467250823974609
Epoch: 7, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.240 Vali Acc: 0.087 Test Loss: 3.240 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 0.6800668239593506
Epoch: 8, Steps: 10 | Train Loss: 2.795 Vali Loss: 3.230 Vali Acc: 0.093 Test Loss: 3.230 Test Acc: 0.093
Validation loss decreased (-0.087026 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.7601134777069092
Epoch: 9, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.224 Vali Acc: 0.099 Test Loss: 3.224 Test Acc: 0.099
Validation loss decreased (-0.092909 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 0.7642858028411865
Epoch: 10, Steps: 10 | Train Loss: 2.608 Vali Loss: 3.219 Vali Acc: 0.106 Test Loss: 3.219 Test Acc: 0.106
Validation loss decreased (-0.098791 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.5563528537750244
Epoch: 11, Steps: 10 | Train Loss: 2.509 Vali Loss: 3.216 Vali Acc: 0.115 Test Loss: 3.216 Test Acc: 0.115
Validation loss decreased (-0.105850 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.731989860534668
Epoch: 12, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.215 Vali Acc: 0.124 Test Loss: 3.215 Test Acc: 0.124
Validation loss decreased (-0.115262 --> -0.123497).  Saving model ...
Epoch: 13 cost time: 0.7559950351715088
Epoch: 13, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.216 Vali Acc: 0.126 Test Loss: 3.216 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.7270710468292236
Epoch: 14, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.218 Vali Acc: 0.129 Test Loss: 3.218 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129380).  Saving model ...
Epoch: 15 cost time: 0.7385368347167969
Epoch: 15, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.227 Vali Acc: 0.131 Test Loss: 3.227 Test Acc: 0.131
Validation loss decreased (-0.129380 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 0.6370735168457031
Epoch: 16, Steps: 10 | Train Loss: 1.940 Vali Loss: 3.233 Vali Acc: 0.136 Test Loss: 3.233 Test Acc: 0.136
Validation loss decreased (-0.130556 --> -0.136438).  Saving model ...
Epoch: 17 cost time: 0.7902209758758545
Epoch: 17, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.244 Vali Acc: 0.144 Test Loss: 3.244 Test Acc: 0.144
Validation loss decreased (-0.136438 --> -0.143497).  Saving model ...
Epoch: 18 cost time: 0.7659521102905273
Epoch: 18, Steps: 10 | Train Loss: 1.761 Vali Loss: 3.254 Vali Acc: 0.147 Test Loss: 3.254 Test Acc: 0.147
Validation loss decreased (-0.143497 --> -0.147026).  Saving model ...
Epoch: 19 cost time: 0.7009832859039307
Epoch: 19, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.272 Vali Acc: 0.149 Test Loss: 3.272 Test Acc: 0.149
Validation loss decreased (-0.147026 --> -0.149379).  Saving model ...
Epoch: 20 cost time: 0.6755437850952148
Epoch: 20, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.291 Vali Acc: 0.158 Test Loss: 3.291 Test Acc: 0.158
Validation loss decreased (-0.149379 --> -0.157614).  Saving model ...
Epoch: 21 cost time: 0.6809468269348145
Epoch: 21, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.309 Vali Acc: 0.161 Test Loss: 3.309 Test Acc: 0.161
Validation loss decreased (-0.157614 --> -0.161143).  Saving model ...
Epoch: 22 cost time: 0.6625652313232422
Epoch: 22, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.330 Vali Acc: 0.162 Test Loss: 3.330 Test Acc: 0.162
Validation loss decreased (-0.161143 --> -0.162320).  Saving model ...
Epoch: 23 cost time: 0.6505012512207031
Epoch: 23, Steps: 10 | Train Loss: 1.329 Vali Loss: 3.357 Vali Acc: 0.169 Test Loss: 3.357 Test Acc: 0.169
Validation loss decreased (-0.162320 --> -0.169378).  Saving model ...
Epoch: 24 cost time: 0.6611926555633545
Epoch: 24, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.389 Vali Acc: 0.178 Test Loss: 3.389 Test Acc: 0.178
Validation loss decreased (-0.169378 --> -0.177613).  Saving model ...
Epoch: 25 cost time: 0.6374542713165283
Epoch: 25, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.417 Vali Acc: 0.184 Test Loss: 3.417 Test Acc: 0.184
Validation loss decreased (-0.177613 --> -0.183495).  Saving model ...
Epoch: 26 cost time: 0.8449132442474365
Epoch: 26, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.447 Vali Acc: 0.193 Test Loss: 3.447 Test Acc: 0.193
Validation loss decreased (-0.183495 --> -0.192907).  Saving model ...
Epoch: 27 cost time: 0.5626420974731445
Epoch: 27, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.490 Vali Acc: 0.189 Test Loss: 3.490 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.672929048538208
Epoch: 28, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.525 Vali Acc: 0.198 Test Loss: 3.525 Test Acc: 0.198
Validation loss decreased (-0.192907 --> -0.197612).  Saving model ...
Epoch: 29 cost time: 0.610759973526001
Epoch: 29, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.580 Vali Acc: 0.196 Test Loss: 3.580 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7001395225524902
Epoch: 30, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.624 Vali Acc: 0.202 Test Loss: 3.624 Test Acc: 0.202
Validation loss decreased (-0.197612 --> -0.202317).  Saving model ...
Epoch: 31 cost time: 0.7709741592407227
Epoch: 31, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.660 Vali Acc: 0.201 Test Loss: 3.660 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7603626251220703
Epoch: 32, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.719 Vali Acc: 0.199 Test Loss: 3.719 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6499252319335938
Epoch: 33, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.788 Vali Acc: 0.196 Test Loss: 3.788 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6294510364532471
Epoch: 34, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.835 Vali Acc: 0.198 Test Loss: 3.835 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7936267852783203
Epoch: 35, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.899 Vali Acc: 0.199 Test Loss: 3.899 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7651448249816895
Epoch: 36, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.952 Vali Acc: 0.205 Test Loss: 3.952 Test Acc: 0.205
Validation loss decreased (-0.202317 --> -0.204666).  Saving model ...
Epoch: 37 cost time: 0.5995826721191406
Epoch: 37, Steps: 10 | Train Loss: 0.422 Vali Loss: 4.054 Vali Acc: 0.198 Test Loss: 4.054 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7523524761199951
Epoch: 38, Steps: 10 | Train Loss: 0.384 Vali Loss: 4.094 Vali Acc: 0.207 Test Loss: 4.094 Test Acc: 0.207
Validation loss decreased (-0.204666 --> -0.207018).  Saving model ...
Epoch: 39 cost time: 0.6421709060668945
Epoch: 39, Steps: 10 | Train Loss: 0.350 Vali Loss: 4.149 Vali Acc: 0.201 Test Loss: 4.149 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6904702186584473
Epoch: 40, Steps: 10 | Train Loss: 0.313 Vali Loss: 4.235 Vali Acc: 0.193 Test Loss: 4.235 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6834964752197266
Epoch: 41, Steps: 10 | Train Loss: 0.277 Vali Loss: 4.301 Vali Acc: 0.195 Test Loss: 4.301 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7429203987121582
Epoch: 42, Steps: 10 | Train Loss: 0.257 Vali Loss: 4.375 Vali Acc: 0.194 Test Loss: 4.375 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7728822231292725
Epoch: 43, Steps: 10 | Train Loss: 0.233 Vali Loss: 4.467 Vali Acc: 0.192 Test Loss: 4.467 Test Acc: 0.192
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7287402153015137
Epoch: 44, Steps: 10 | Train Loss: 0.223 Vali Loss: 4.577 Vali Acc: 0.192 Test Loss: 4.577 Test Acc: 0.192
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6801238059997559
Epoch: 45, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.602 Vali Acc: 0.195 Test Loss: 4.602 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6941893100738525
Epoch: 46, Steps: 10 | Train Loss: 0.179 Vali Loss: 4.668 Vali Acc: 0.193 Test Loss: 4.668 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8429379463195801
Epoch: 47, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.764 Vali Acc: 0.191 Test Loss: 4.764 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.772453784942627
Epoch: 48, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.832 Vali Acc: 0.195 Test Loss: 4.832 Test Acc: 0.195
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20705882352941177
model parameter : 39528
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.433601140975952
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.330 Vali Acc: 0.046 Test Loss: 3.330 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.6595032215118408
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.319 Vali Acc: 0.047 Test Loss: 3.319 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.7099661827087402
Epoch: 3, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.304 Vali Acc: 0.048 Test Loss: 3.304 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.7210695743560791
Epoch: 4, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.288 Vali Acc: 0.046 Test Loss: 3.288 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5470821857452393
Epoch: 5, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.273 Vali Acc: 0.064 Test Loss: 3.273 Test Acc: 0.064
Validation loss decreased (-0.048202 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.5563559532165527
Epoch: 6, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.259 Vali Acc: 0.081 Test Loss: 3.259 Test Acc: 0.081
Validation loss decreased (-0.063497 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 0.6762349605560303
Epoch: 7, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.245 Vali Acc: 0.086 Test Loss: 3.245 Test Acc: 0.086
Validation loss decreased (-0.081144 --> -0.085850).  Saving model ...
Epoch: 8 cost time: 0.6474671363830566
Epoch: 8, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.235 Vali Acc: 0.098 Test Loss: 3.235 Test Acc: 0.098
Validation loss decreased (-0.085850 --> -0.097615).  Saving model ...
Epoch: 9 cost time: 0.5778937339782715
Epoch: 9, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.224 Vali Acc: 0.109 Test Loss: 3.224 Test Acc: 0.109
Validation loss decreased (-0.097615 --> -0.109380).  Saving model ...
Epoch: 10 cost time: 0.7163512706756592
Epoch: 10, Steps: 10 | Train Loss: 2.589 Vali Loss: 3.219 Vali Acc: 0.113 Test Loss: 3.219 Test Acc: 0.113
Validation loss decreased (-0.109380 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 0.7097387313842773
Epoch: 11, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.211 Vali Acc: 0.120 Test Loss: 3.211 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.7837276458740234
Epoch: 12, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.210 Vali Acc: 0.122 Test Loss: 3.210 Test Acc: 0.122
Validation loss decreased (-0.119968 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.8662278652191162
Epoch: 13, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.210 Vali Acc: 0.127 Test Loss: 3.210 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.6375813484191895
Epoch: 14, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.214 Vali Acc: 0.131 Test Loss: 3.214 Test Acc: 0.131
Validation loss decreased (-0.127027 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.8329060077667236
Epoch: 15, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.218 Vali Acc: 0.134 Test Loss: 3.218 Test Acc: 0.134
Validation loss decreased (-0.130556 --> -0.134085).  Saving model ...
Epoch: 16 cost time: 0.6849987506866455
Epoch: 16, Steps: 10 | Train Loss: 1.940 Vali Loss: 3.227 Vali Acc: 0.139 Test Loss: 3.227 Test Acc: 0.139
Validation loss decreased (-0.134085 --> -0.138791).  Saving model ...
Epoch: 17 cost time: 0.8905415534973145
Epoch: 17, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.237 Vali Acc: 0.138 Test Loss: 3.237 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7037651538848877
Epoch: 18, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.249 Vali Acc: 0.145 Test Loss: 3.249 Test Acc: 0.145
Validation loss decreased (-0.138791 --> -0.144673).  Saving model ...
Epoch: 19 cost time: 0.5974197387695312
Epoch: 19, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.266 Vali Acc: 0.147 Test Loss: 3.266 Test Acc: 0.147
Validation loss decreased (-0.144673 --> -0.147026).  Saving model ...
Epoch: 20 cost time: 0.7883975505828857
Epoch: 20, Steps: 10 | Train Loss: 1.592 Vali Loss: 3.281 Vali Acc: 0.153 Test Loss: 3.281 Test Acc: 0.153
Validation loss decreased (-0.147026 --> -0.152908).  Saving model ...
Epoch: 21 cost time: 0.736656904220581
Epoch: 21, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.298 Vali Acc: 0.160 Test Loss: 3.298 Test Acc: 0.160
Validation loss decreased (-0.152908 --> -0.159967).  Saving model ...
Epoch: 22 cost time: 0.6070713996887207
Epoch: 22, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.310 Vali Acc: 0.165 Test Loss: 3.310 Test Acc: 0.165
Validation loss decreased (-0.159967 --> -0.164673).  Saving model ...
Epoch: 23 cost time: 0.7174656391143799
Epoch: 23, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.331 Vali Acc: 0.171 Test Loss: 3.331 Test Acc: 0.171
Validation loss decreased (-0.164673 --> -0.170555).  Saving model ...
Epoch: 24 cost time: 0.6769917011260986
Epoch: 24, Steps: 10 | Train Loss: 1.228 Vali Loss: 3.355 Vali Acc: 0.171 Test Loss: 3.355 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6458501815795898
Epoch: 25, Steps: 10 | Train Loss: 1.173 Vali Loss: 3.378 Vali Acc: 0.182 Test Loss: 3.378 Test Acc: 0.182
Validation loss decreased (-0.170555 --> -0.182319).  Saving model ...
Epoch: 26 cost time: 0.5973927974700928
Epoch: 26, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.406 Vali Acc: 0.182 Test Loss: 3.406 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6483054161071777
Epoch: 27, Steps: 10 | Train Loss: 1.003 Vali Loss: 3.433 Vali Acc: 0.189 Test Loss: 3.433 Test Acc: 0.189
Validation loss decreased (-0.182319 --> -0.189377).  Saving model ...
Epoch: 28 cost time: 0.6268277168273926
Epoch: 28, Steps: 10 | Train Loss: 0.926 Vali Loss: 3.460 Vali Acc: 0.191 Test Loss: 3.460 Test Acc: 0.191
Validation loss decreased (-0.189377 --> -0.190554).  Saving model ...
Epoch: 29 cost time: 0.6424479484558105
Epoch: 29, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.493 Vali Acc: 0.192 Test Loss: 3.493 Test Acc: 0.192
Validation loss decreased (-0.190554 --> -0.191730).  Saving model ...
Epoch: 30 cost time: 0.5437469482421875
Epoch: 30, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.526 Vali Acc: 0.195 Test Loss: 3.526 Test Acc: 0.195
Validation loss decreased (-0.191730 --> -0.195259).  Saving model ...
Epoch: 31 cost time: 0.598346471786499
Epoch: 31, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.552 Vali Acc: 0.206 Test Loss: 3.552 Test Acc: 0.206
Validation loss decreased (-0.195259 --> -0.205847).  Saving model ...
Epoch: 32 cost time: 0.7493772506713867
Epoch: 32, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.582 Vali Acc: 0.204 Test Loss: 3.582 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5532517433166504
Epoch: 33, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.621 Vali Acc: 0.208 Test Loss: 3.621 Test Acc: 0.208
Validation loss decreased (-0.205847 --> -0.208199).  Saving model ...
Epoch: 34 cost time: 0.6611721515655518
Epoch: 34, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.656 Vali Acc: 0.211 Test Loss: 3.656 Test Acc: 0.211
Validation loss decreased (-0.208199 --> -0.210552).  Saving model ...
Epoch: 35 cost time: 0.5043888092041016
Epoch: 35, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.690 Vali Acc: 0.208 Test Loss: 3.690 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6905202865600586
Epoch: 36, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.739 Vali Acc: 0.207 Test Loss: 3.739 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6690518856048584
Epoch: 37, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.782 Vali Acc: 0.208 Test Loss: 3.782 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.777249813079834
Epoch: 38, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.837 Vali Acc: 0.209 Test Loss: 3.837 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6664836406707764
Epoch: 39, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.875 Vali Acc: 0.213 Test Loss: 3.875 Test Acc: 0.213
Validation loss decreased (-0.210552 --> -0.212902).  Saving model ...
Epoch: 40 cost time: 0.5992259979248047
Epoch: 40, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.917 Vali Acc: 0.213 Test Loss: 3.917 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.958392858505249
Epoch: 41, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.976 Vali Acc: 0.214 Test Loss: 3.976 Test Acc: 0.214
Validation loss decreased (-0.212902 --> -0.214078).  Saving model ...
Epoch: 42 cost time: 0.6583967208862305
Epoch: 42, Steps: 10 | Train Loss: 0.301 Vali Loss: 4.023 Vali Acc: 0.215 Test Loss: 4.023 Test Acc: 0.215
Validation loss decreased (-0.214078 --> -0.215254).  Saving model ...
Epoch: 43 cost time: 0.7278273105621338
Epoch: 43, Steps: 10 | Train Loss: 0.279 Vali Loss: 4.064 Vali Acc: 0.220 Test Loss: 4.064 Test Acc: 0.220
Validation loss decreased (-0.215254 --> -0.219959).  Saving model ...
Epoch: 44 cost time: 0.8221282958984375
Epoch: 44, Steps: 10 | Train Loss: 0.259 Vali Loss: 4.114 Vali Acc: 0.218 Test Loss: 4.114 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6892824172973633
Epoch: 45, Steps: 10 | Train Loss: 0.237 Vali Loss: 4.181 Vali Acc: 0.218 Test Loss: 4.181 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7287795543670654
Epoch: 46, Steps: 10 | Train Loss: 0.219 Vali Loss: 4.234 Vali Acc: 0.221 Test Loss: 4.234 Test Acc: 0.221
Validation loss decreased (-0.219959 --> -0.221134).  Saving model ...
Epoch: 47 cost time: 0.9162633419036865
Epoch: 47, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.288 Vali Acc: 0.221 Test Loss: 4.288 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7943029403686523
Epoch: 48, Steps: 10 | Train Loss: 0.184 Vali Loss: 4.338 Vali Acc: 0.224 Test Loss: 4.338 Test Acc: 0.224
Validation loss decreased (-0.221134 --> -0.223486).  Saving model ...
Epoch: 49 cost time: 0.5857160091400146
Epoch: 49, Steps: 10 | Train Loss: 0.161 Vali Loss: 4.395 Vali Acc: 0.220 Test Loss: 4.395 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7978551387786865
Epoch: 50, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.425 Vali Acc: 0.222 Test Loss: 4.425 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5916328430175781
Epoch: 51, Steps: 10 | Train Loss: 0.136 Vali Loss: 4.495 Vali Acc: 0.225 Test Loss: 4.495 Test Acc: 0.225
Validation loss decreased (-0.223486 --> -0.224661).  Saving model ...
Epoch: 52 cost time: 0.6525866985321045
Epoch: 52, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.570 Vali Acc: 0.222 Test Loss: 4.570 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.675978422164917
Epoch: 53, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.641 Vali Acc: 0.224 Test Loss: 4.641 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6795992851257324
Epoch: 54, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.695 Vali Acc: 0.225 Test Loss: 4.695 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6968908309936523
Epoch: 55, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.741 Vali Acc: 0.226 Test Loss: 4.741 Test Acc: 0.226
Validation loss decreased (-0.224661 --> -0.225835).  Saving model ...
Epoch: 56 cost time: 0.7881984710693359
Epoch: 56, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.796 Vali Acc: 0.227 Test Loss: 4.796 Test Acc: 0.227
Validation loss decreased (-0.225835 --> -0.227011).  Saving model ...
Epoch: 57 cost time: 0.6597073078155518
Epoch: 57, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.840 Vali Acc: 0.228 Test Loss: 4.840 Test Acc: 0.228
Validation loss decreased (-0.227011 --> -0.228187).  Saving model ...
Epoch: 58 cost time: 0.6780414581298828
Epoch: 58, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.901 Vali Acc: 0.228 Test Loss: 4.901 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7397677898406982
Epoch: 59, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.962 Vali Acc: 0.228 Test Loss: 4.962 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8014302253723145
Epoch: 60, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.991 Vali Acc: 0.227 Test Loss: 4.991 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8762998580932617
Epoch: 61, Steps: 10 | Train Loss: 0.060 Vali Loss: 5.060 Vali Acc: 0.225 Test Loss: 5.060 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8921017646789551
Epoch: 62, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.110 Vali Acc: 0.225 Test Loss: 5.110 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.75238037109375
Epoch: 63, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.175 Vali Acc: 0.228 Test Loss: 5.175 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8133118152618408
Epoch: 64, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.221 Vali Acc: 0.227 Test Loss: 5.221 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7001242637634277
Epoch: 65, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.261 Vali Acc: 0.232 Test Loss: 5.261 Test Acc: 0.232
Validation loss decreased (-0.228187 --> -0.231712).  Saving model ...
Epoch: 66 cost time: 0.6412670612335205
Epoch: 66, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.308 Vali Acc: 0.229 Test Loss: 5.308 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6768560409545898
Epoch: 67, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.340 Vali Acc: 0.232 Test Loss: 5.340 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7066934108734131
Epoch: 68, Steps: 10 | Train Loss: 0.037 Vali Loss: 5.397 Vali Acc: 0.226 Test Loss: 5.397 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5983843803405762
Epoch: 69, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.462 Vali Acc: 0.226 Test Loss: 5.462 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.6607964038848877
Epoch: 70, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.507 Vali Acc: 0.222 Test Loss: 5.507 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6203346252441406
Epoch: 71, Steps: 10 | Train Loss: 0.030 Vali Loss: 5.548 Vali Acc: 0.224 Test Loss: 5.548 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.7264049053192139
Epoch: 72, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.587 Vali Acc: 0.225 Test Loss: 5.587 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.605473518371582
Epoch: 73, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.632 Vali Acc: 0.222 Test Loss: 5.632 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.6236684322357178
Epoch: 74, Steps: 10 | Train Loss: 0.026 Vali Loss: 5.682 Vali Acc: 0.228 Test Loss: 5.682 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.5773391723632812
Epoch: 75, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.726 Vali Acc: 0.226 Test Loss: 5.726 Test Acc: 0.226
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23176470588235293
model parameter : 39550
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.701831817626953
Epoch: 1, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.321 Vali Acc: 0.031 Test Loss: 3.321 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.8693060874938965
Epoch: 2, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.312 Vali Acc: 0.031 Test Loss: 3.312 Test Acc: 0.031
Validation loss decreased (-0.030555 --> -0.030555).  Saving model ...
Epoch: 3 cost time: 0.5684549808502197
Epoch: 3, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.299 Vali Acc: 0.038 Test Loss: 3.299 Test Acc: 0.038
Validation loss decreased (-0.030555 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.6268303394317627
Epoch: 4, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.285 Vali Acc: 0.047 Test Loss: 3.285 Test Acc: 0.047
Validation loss decreased (-0.037614 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.5661230087280273
Epoch: 5, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.270 Vali Acc: 0.049 Test Loss: 3.270 Test Acc: 0.049
Validation loss decreased (-0.047026 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 0.5953667163848877
Epoch: 6, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.257 Vali Acc: 0.066 Test Loss: 3.257 Test Acc: 0.066
Validation loss decreased (-0.049379 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 0.6128361225128174
Epoch: 7, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.246 Vali Acc: 0.084 Test Loss: 3.246 Test Acc: 0.084
Validation loss decreased (-0.065850 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.6405482292175293
Epoch: 8, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.237 Vali Acc: 0.091 Test Loss: 3.237 Test Acc: 0.091
Validation loss decreased (-0.083497 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.5738985538482666
Epoch: 9, Steps: 10 | Train Loss: 2.664 Vali Loss: 3.230 Vali Acc: 0.093 Test Loss: 3.230 Test Acc: 0.093
Validation loss decreased (-0.090556 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 0.607926607131958
Epoch: 10, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.225 Vali Acc: 0.100 Test Loss: 3.225 Test Acc: 0.100
Validation loss decreased (-0.092909 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 0.6062612533569336
Epoch: 11, Steps: 10 | Train Loss: 2.445 Vali Loss: 3.222 Vali Acc: 0.107 Test Loss: 3.222 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107027).  Saving model ...
Epoch: 12 cost time: 0.7117860317230225
Epoch: 12, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.219 Vali Acc: 0.119 Test Loss: 3.219 Test Acc: 0.119
Validation loss decreased (-0.107027 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.6640732288360596
Epoch: 13, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.216 Vali Acc: 0.126 Test Loss: 3.216 Test Acc: 0.126
Validation loss decreased (-0.118791 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.6088213920593262
Epoch: 14, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.220 Vali Acc: 0.133 Test Loss: 3.220 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.6164286136627197
Epoch: 15, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.223 Vali Acc: 0.141 Test Loss: 3.223 Test Acc: 0.141
Validation loss decreased (-0.132909 --> -0.141144).  Saving model ...
Epoch: 16 cost time: 0.6335556507110596
Epoch: 16, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.229 Vali Acc: 0.140 Test Loss: 3.229 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6550676822662354
Epoch: 17, Steps: 10 | Train Loss: 1.814 Vali Loss: 3.238 Vali Acc: 0.141 Test Loss: 3.238 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6942334175109863
Epoch: 18, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.247 Vali Acc: 0.148 Test Loss: 3.247 Test Acc: 0.148
Validation loss decreased (-0.141144 --> -0.148203).  Saving model ...
Epoch: 19 cost time: 0.7589232921600342
Epoch: 19, Steps: 10 | Train Loss: 1.616 Vali Loss: 3.263 Vali Acc: 0.160 Test Loss: 3.263 Test Acc: 0.160
Validation loss decreased (-0.148203 --> -0.159967).  Saving model ...
Epoch: 20 cost time: 0.7391870021820068
Epoch: 20, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.276 Vali Acc: 0.164 Test Loss: 3.276 Test Acc: 0.164
Validation loss decreased (-0.159967 --> -0.163497).  Saving model ...
Epoch: 21 cost time: 0.6148872375488281
Epoch: 21, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.294 Vali Acc: 0.172 Test Loss: 3.294 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171732).  Saving model ...
Epoch: 22 cost time: 0.5790903568267822
Epoch: 22, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.309 Vali Acc: 0.179 Test Loss: 3.309 Test Acc: 0.179
Validation loss decreased (-0.171732 --> -0.178790).  Saving model ...
Epoch: 23 cost time: 0.7452163696289062
Epoch: 23, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.332 Vali Acc: 0.182 Test Loss: 3.332 Test Acc: 0.182
Validation loss decreased (-0.178790 --> -0.182320).  Saving model ...
Epoch: 24 cost time: 0.6466364860534668
Epoch: 24, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.353 Vali Acc: 0.179 Test Loss: 3.353 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6805238723754883
Epoch: 25, Steps: 10 | Train Loss: 1.140 Vali Loss: 3.379 Vali Acc: 0.179 Test Loss: 3.379 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6636717319488525
Epoch: 26, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.405 Vali Acc: 0.181 Test Loss: 3.405 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5517654418945312
Epoch: 27, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.436 Vali Acc: 0.188 Test Loss: 3.436 Test Acc: 0.188
Validation loss decreased (-0.182320 --> -0.188201).  Saving model ...
Epoch: 28 cost time: 0.6499180793762207
Epoch: 28, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.462 Vali Acc: 0.194 Test Loss: 3.462 Test Acc: 0.194
Validation loss decreased (-0.188201 --> -0.194083).  Saving model ...
Epoch: 29 cost time: 0.7506482601165771
Epoch: 29, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.498 Vali Acc: 0.193 Test Loss: 3.498 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7698760032653809
Epoch: 30, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.532 Vali Acc: 0.196 Test Loss: 3.532 Test Acc: 0.196
Validation loss decreased (-0.194083 --> -0.196435).  Saving model ...
Epoch: 31 cost time: 0.7696137428283691
Epoch: 31, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.562 Vali Acc: 0.198 Test Loss: 3.562 Test Acc: 0.198
Validation loss decreased (-0.196435 --> -0.197611).  Saving model ...
Epoch: 32 cost time: 0.5947883129119873
Epoch: 32, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.593 Vali Acc: 0.207 Test Loss: 3.593 Test Acc: 0.207
Validation loss decreased (-0.197611 --> -0.207023).  Saving model ...
Epoch: 33 cost time: 0.5685455799102783
Epoch: 33, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.638 Vali Acc: 0.202 Test Loss: 3.638 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9492893218994141
Epoch: 34, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.672 Vali Acc: 0.205 Test Loss: 3.672 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8574340343475342
Epoch: 35, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.708 Vali Acc: 0.202 Test Loss: 3.708 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.719200849533081
Epoch: 36, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.738 Vali Acc: 0.207 Test Loss: 3.738 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.627199649810791
Epoch: 37, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.784 Vali Acc: 0.207 Test Loss: 3.784 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.610783576965332
Epoch: 38, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.837 Vali Acc: 0.208 Test Loss: 3.837 Test Acc: 0.208
Validation loss decreased (-0.207023 --> -0.208197).  Saving model ...
Epoch: 39 cost time: 0.61299729347229
Epoch: 39, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.877 Vali Acc: 0.212 Test Loss: 3.877 Test Acc: 0.212
Validation loss decreased (-0.208197 --> -0.211726).  Saving model ...
Epoch: 40 cost time: 0.628748893737793
Epoch: 40, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.924 Vali Acc: 0.214 Test Loss: 3.924 Test Acc: 0.214
Validation loss decreased (-0.211726 --> -0.214078).  Saving model ...
Epoch: 41 cost time: 0.6518471240997314
Epoch: 41, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.987 Vali Acc: 0.208 Test Loss: 3.987 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5787146091461182
Epoch: 42, Steps: 10 | Train Loss: 0.297 Vali Loss: 4.030 Vali Acc: 0.206 Test Loss: 4.030 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.640012264251709
Epoch: 43, Steps: 10 | Train Loss: 0.273 Vali Loss: 4.056 Vali Acc: 0.213 Test Loss: 4.056 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.649289608001709
Epoch: 44, Steps: 10 | Train Loss: 0.242 Vali Loss: 4.099 Vali Acc: 0.215 Test Loss: 4.099 Test Acc: 0.215
Validation loss decreased (-0.214078 --> -0.215253).  Saving model ...
Epoch: 45 cost time: 0.6289160251617432
Epoch: 45, Steps: 10 | Train Loss: 0.219 Vali Loss: 4.153 Vali Acc: 0.211 Test Loss: 4.153 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6635026931762695
Epoch: 46, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.207 Vali Acc: 0.212 Test Loss: 4.207 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5492274761199951
Epoch: 47, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.282 Vali Acc: 0.213 Test Loss: 4.282 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5880167484283447
Epoch: 48, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.308 Vali Acc: 0.215 Test Loss: 4.308 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6368288993835449
Epoch: 49, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.392 Vali Acc: 0.208 Test Loss: 4.392 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6578929424285889
Epoch: 50, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.437 Vali Acc: 0.218 Test Loss: 4.437 Test Acc: 0.218
Validation loss decreased (-0.215253 --> -0.217603).  Saving model ...
Epoch: 51 cost time: 0.5781776905059814
Epoch: 51, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.499 Vali Acc: 0.214 Test Loss: 4.499 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7249722480773926
Epoch: 52, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.532 Vali Acc: 0.213 Test Loss: 4.532 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7205448150634766
Epoch: 53, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.609 Vali Acc: 0.218 Test Loss: 4.609 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5999894142150879
Epoch: 54, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.653 Vali Acc: 0.222 Test Loss: 4.653 Test Acc: 0.222
Validation loss decreased (-0.217603 --> -0.222306).  Saving model ...
Epoch: 55 cost time: 0.6978285312652588
Epoch: 55, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.683 Vali Acc: 0.220 Test Loss: 4.683 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6436624526977539
Epoch: 56, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.780 Vali Acc: 0.215 Test Loss: 4.780 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6400318145751953
Epoch: 57, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.835 Vali Acc: 0.218 Test Loss: 4.835 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.636970043182373
Epoch: 58, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.875 Vali Acc: 0.218 Test Loss: 4.875 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5812950134277344
Epoch: 59, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.933 Vali Acc: 0.216 Test Loss: 4.933 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6034560203552246
Epoch: 60, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.001 Vali Acc: 0.219 Test Loss: 5.001 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7121660709381104
Epoch: 61, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.061 Vali Acc: 0.218 Test Loss: 5.061 Test Acc: 0.218
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.6946840286254883
Epoch: 62, Steps: 10 | Train Loss: 0.047 Vali Loss: 5.096 Vali Acc: 0.216 Test Loss: 5.096 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8398692607879639
Epoch: 63, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.147 Vali Acc: 0.214 Test Loss: 5.147 Test Acc: 0.214
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.6424262523651123
Epoch: 64, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.190 Vali Acc: 0.216 Test Loss: 5.190 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2223529411764706
model parameter : 39272
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0155832767486572
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.316 Vali Acc: 0.035 Test Loss: 3.316 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5811810493469238
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.306 Vali Acc: 0.033 Test Loss: 3.306 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5777974128723145
Epoch: 3, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.293 Vali Acc: 0.039 Test Loss: 3.293 Test Acc: 0.039
Validation loss decreased (-0.035261 --> -0.038791).  Saving model ...
Epoch: 4 cost time: 0.6876988410949707
Epoch: 4, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.279 Vali Acc: 0.046 Test Loss: 3.279 Test Acc: 0.046
Validation loss decreased (-0.038791 --> -0.045850).  Saving model ...
Epoch: 5 cost time: 0.5216116905212402
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.264 Vali Acc: 0.048 Test Loss: 3.264 Test Acc: 0.048
Validation loss decreased (-0.045850 --> -0.048203).  Saving model ...
Epoch: 6 cost time: 0.5544893741607666
Epoch: 6, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.251 Vali Acc: 0.080 Test Loss: 3.251 Test Acc: 0.080
Validation loss decreased (-0.048203 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 0.45891761779785156
Epoch: 7, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.240 Vali Acc: 0.095 Test Loss: 3.240 Test Acc: 0.095
Validation loss decreased (-0.079967 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.6319942474365234
Epoch: 8, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.230 Vali Acc: 0.099 Test Loss: 3.230 Test Acc: 0.099
Validation loss decreased (-0.095262 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 0.6172683238983154
Epoch: 9, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.220 Vali Acc: 0.099 Test Loss: 3.220 Test Acc: 0.099
Validation loss decreased (-0.098791 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 0.6035313606262207
Epoch: 10, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.213 Vali Acc: 0.105 Test Loss: 3.213 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104674).  Saving model ...
Epoch: 11 cost time: 0.6519424915313721
Epoch: 11, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.209 Vali Acc: 0.108 Test Loss: 3.209 Test Acc: 0.108
Validation loss decreased (-0.104674 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 0.4985473155975342
Epoch: 12, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.209 Vali Acc: 0.111 Test Loss: 3.209 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 0.5296087265014648
Epoch: 13, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.209 Vali Acc: 0.119 Test Loss: 3.209 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 14 cost time: 0.7829961776733398
Epoch: 14, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.211 Vali Acc: 0.125 Test Loss: 3.211 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124674).  Saving model ...
Epoch: 15 cost time: 0.7890210151672363
Epoch: 15, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.212 Vali Acc: 0.134 Test Loss: 3.212 Test Acc: 0.134
Validation loss decreased (-0.124674 --> -0.134086).  Saving model ...
Epoch: 16 cost time: 0.5301663875579834
Epoch: 16, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.217 Vali Acc: 0.141 Test Loss: 3.217 Test Acc: 0.141
Validation loss decreased (-0.134086 --> -0.141144).  Saving model ...
Epoch: 17 cost time: 0.6324002742767334
Epoch: 17, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.226 Vali Acc: 0.147 Test Loss: 3.226 Test Acc: 0.147
Validation loss decreased (-0.141144 --> -0.147027).  Saving model ...
Epoch: 18 cost time: 0.6812312602996826
Epoch: 18, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.240 Vali Acc: 0.151 Test Loss: 3.240 Test Acc: 0.151
Validation loss decreased (-0.147027 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 0.5686037540435791
Epoch: 19, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.253 Vali Acc: 0.161 Test Loss: 3.253 Test Acc: 0.161
Validation loss decreased (-0.150556 --> -0.161144).  Saving model ...
Epoch: 20 cost time: 0.6400711536407471
Epoch: 20, Steps: 10 | Train Loss: 1.510 Vali Loss: 3.272 Vali Acc: 0.166 Test Loss: 3.272 Test Acc: 0.166
Validation loss decreased (-0.161144 --> -0.165850).  Saving model ...
Epoch: 21 cost time: 0.628206729888916
Epoch: 21, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.294 Vali Acc: 0.172 Test Loss: 3.294 Test Acc: 0.172
Validation loss decreased (-0.165850 --> -0.171732).  Saving model ...
Epoch: 22 cost time: 0.6011230945587158
Epoch: 22, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.314 Vali Acc: 0.172 Test Loss: 3.314 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6342217922210693
Epoch: 23, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.336 Vali Acc: 0.185 Test Loss: 3.336 Test Acc: 0.185
Validation loss decreased (-0.171732 --> -0.184673).  Saving model ...
Epoch: 24 cost time: 0.6770246028900146
Epoch: 24, Steps: 10 | Train Loss: 1.162 Vali Loss: 3.359 Vali Acc: 0.185 Test Loss: 3.359 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6392004489898682
Epoch: 25, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.393 Vali Acc: 0.188 Test Loss: 3.393 Test Acc: 0.188
Validation loss decreased (-0.184673 --> -0.188201).  Saving model ...
Epoch: 26 cost time: 0.8136427402496338
Epoch: 26, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.428 Vali Acc: 0.191 Test Loss: 3.428 Test Acc: 0.191
Validation loss decreased (-0.188201 --> -0.190554).  Saving model ...
Epoch: 27 cost time: 0.6966550350189209
Epoch: 27, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.467 Vali Acc: 0.193 Test Loss: 3.467 Test Acc: 0.193
Validation loss decreased (-0.190554 --> -0.192907).  Saving model ...
Epoch: 28 cost time: 0.7252824306488037
Epoch: 28, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.496 Vali Acc: 0.194 Test Loss: 3.496 Test Acc: 0.194
Validation loss decreased (-0.192907 --> -0.194083).  Saving model ...
Epoch: 29 cost time: 0.9849550724029541
Epoch: 29, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.530 Vali Acc: 0.196 Test Loss: 3.530 Test Acc: 0.196
Validation loss decreased (-0.194083 --> -0.196435).  Saving model ...
Epoch: 30 cost time: 0.6389119625091553
Epoch: 30, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.570 Vali Acc: 0.198 Test Loss: 3.570 Test Acc: 0.198
Validation loss decreased (-0.196435 --> -0.197611).  Saving model ...
Epoch: 31 cost time: 0.6740109920501709
Epoch: 31, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.611 Vali Acc: 0.201 Test Loss: 3.611 Test Acc: 0.201
Validation loss decreased (-0.197611 --> -0.201140).  Saving model ...
Epoch: 32 cost time: 0.6575801372528076
Epoch: 32, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.655 Vali Acc: 0.204 Test Loss: 3.655 Test Acc: 0.204
Validation loss decreased (-0.201140 --> -0.203493).  Saving model ...
Epoch: 33 cost time: 0.7820720672607422
Epoch: 33, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.699 Vali Acc: 0.204 Test Loss: 3.699 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7654716968536377
Epoch: 34, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.753 Vali Acc: 0.205 Test Loss: 3.753 Test Acc: 0.205
Validation loss decreased (-0.203493 --> -0.204668).  Saving model ...
Epoch: 35 cost time: 0.6032941341400146
Epoch: 35, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.802 Vali Acc: 0.199 Test Loss: 3.802 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6277570724487305
Epoch: 36, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.845 Vali Acc: 0.206 Test Loss: 3.845 Test Acc: 0.206
Validation loss decreased (-0.204668 --> -0.205844).  Saving model ...
Epoch: 37 cost time: 0.6246824264526367
Epoch: 37, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.873 Vali Acc: 0.211 Test Loss: 3.873 Test Acc: 0.211
Validation loss decreased (-0.205844 --> -0.210550).  Saving model ...
Epoch: 38 cost time: 0.6212632656097412
Epoch: 38, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.932 Vali Acc: 0.205 Test Loss: 3.932 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6520717144012451
Epoch: 39, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.983 Vali Acc: 0.207 Test Loss: 3.983 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6708424091339111
Epoch: 40, Steps: 10 | Train Loss: 0.334 Vali Loss: 4.032 Vali Acc: 0.213 Test Loss: 4.032 Test Acc: 0.213
Validation loss decreased (-0.210550 --> -0.212901).  Saving model ...
Epoch: 41 cost time: 0.6475896835327148
Epoch: 41, Steps: 10 | Train Loss: 0.312 Vali Loss: 4.099 Vali Acc: 0.206 Test Loss: 4.099 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6686103343963623
Epoch: 42, Steps: 10 | Train Loss: 0.276 Vali Loss: 4.168 Vali Acc: 0.200 Test Loss: 4.168 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7134323120117188
Epoch: 43, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.219 Vali Acc: 0.196 Test Loss: 4.219 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6130666732788086
Epoch: 44, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.257 Vali Acc: 0.201 Test Loss: 4.257 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6939923763275146
Epoch: 45, Steps: 10 | Train Loss: 0.216 Vali Loss: 4.306 Vali Acc: 0.199 Test Loss: 4.306 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6885061264038086
Epoch: 46, Steps: 10 | Train Loss: 0.205 Vali Loss: 4.367 Vali Acc: 0.200 Test Loss: 4.367 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6100850105285645
Epoch: 47, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.405 Vali Acc: 0.204 Test Loss: 4.405 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7146682739257812
Epoch: 48, Steps: 10 | Train Loss: 0.173 Vali Loss: 4.490 Vali Acc: 0.205 Test Loss: 4.490 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6882219314575195
Epoch: 49, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.515 Vali Acc: 0.199 Test Loss: 4.515 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7450003623962402
Epoch: 50, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.581 Vali Acc: 0.201 Test Loss: 4.581 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21294117647058824
model parameter : 40280
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9610369205474854
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.286 Vali Acc: 0.036 Test Loss: 3.286 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.6141011714935303
Epoch: 2, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.276 Vali Acc: 0.034 Test Loss: 3.276 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6022219657897949
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.263 Vali Acc: 0.041 Test Loss: 3.263 Test Acc: 0.041
Validation loss decreased (-0.036438 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.6547541618347168
Epoch: 4, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.249 Vali Acc: 0.054 Test Loss: 3.249 Test Acc: 0.054
Validation loss decreased (-0.041144 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.6175682544708252
Epoch: 5, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.236 Vali Acc: 0.062 Test Loss: 3.236 Test Acc: 0.062
Validation loss decreased (-0.054085 --> -0.062321).  Saving model ...
Epoch: 6 cost time: 0.4889206886291504
Epoch: 6, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.223 Vali Acc: 0.079 Test Loss: 3.223 Test Acc: 0.079
Validation loss decreased (-0.062321 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.577221155166626
Epoch: 7, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.211 Vali Acc: 0.089 Test Loss: 3.211 Test Acc: 0.089
Validation loss decreased (-0.078791 --> -0.089380).  Saving model ...
Epoch: 8 cost time: 0.6531684398651123
Epoch: 8, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.200 Vali Acc: 0.096 Test Loss: 3.200 Test Acc: 0.096
Validation loss decreased (-0.089380 --> -0.096439).  Saving model ...
Epoch: 9 cost time: 0.673785924911499
Epoch: 9, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.193 Vali Acc: 0.104 Test Loss: 3.193 Test Acc: 0.104
Validation loss decreased (-0.096439 --> -0.103497).  Saving model ...
Epoch: 10 cost time: 0.7581100463867188
Epoch: 10, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.187 Vali Acc: 0.109 Test Loss: 3.187 Test Acc: 0.109
Validation loss decreased (-0.103497 --> -0.109380).  Saving model ...
Epoch: 11 cost time: 0.6577174663543701
Epoch: 11, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.181 Vali Acc: 0.120 Test Loss: 3.181 Test Acc: 0.120
Validation loss decreased (-0.109380 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.6334195137023926
Epoch: 12, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.181 Vali Acc: 0.122 Test Loss: 3.181 Test Acc: 0.122
Validation loss decreased (-0.119968 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.5916814804077148
Epoch: 13, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.182 Vali Acc: 0.132 Test Loss: 3.182 Test Acc: 0.132
Validation loss decreased (-0.122321 --> -0.131733).  Saving model ...
Epoch: 14 cost time: 0.631385326385498
Epoch: 14, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.186 Vali Acc: 0.138 Test Loss: 3.186 Test Acc: 0.138
Validation loss decreased (-0.131733 --> -0.137615).  Saving model ...
Epoch: 15 cost time: 0.6448335647583008
Epoch: 15, Steps: 10 | Train Loss: 2.032 Vali Loss: 3.191 Vali Acc: 0.140 Test Loss: 3.191 Test Acc: 0.140
Validation loss decreased (-0.137615 --> -0.139968).  Saving model ...
Epoch: 16 cost time: 0.5886902809143066
Epoch: 16, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.200 Vali Acc: 0.141 Test Loss: 3.200 Test Acc: 0.141
Validation loss decreased (-0.139968 --> -0.141144).  Saving model ...
Epoch: 17 cost time: 0.6095149517059326
Epoch: 17, Steps: 10 | Train Loss: 1.846 Vali Loss: 3.211 Vali Acc: 0.146 Test Loss: 3.211 Test Acc: 0.146
Validation loss decreased (-0.141144 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.6704592704772949
Epoch: 18, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.223 Vali Acc: 0.151 Test Loss: 3.223 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 0.5644848346710205
Epoch: 19, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.239 Vali Acc: 0.147 Test Loss: 3.239 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5808041095733643
Epoch: 20, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.256 Vali Acc: 0.161 Test Loss: 3.256 Test Acc: 0.161
Validation loss decreased (-0.150556 --> -0.161144).  Saving model ...
Epoch: 21 cost time: 0.6413037776947021
Epoch: 21, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.274 Vali Acc: 0.165 Test Loss: 3.274 Test Acc: 0.165
Validation loss decreased (-0.161144 --> -0.164673).  Saving model ...
Epoch: 22 cost time: 0.7722363471984863
Epoch: 22, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.295 Vali Acc: 0.167 Test Loss: 3.295 Test Acc: 0.167
Validation loss decreased (-0.164673 --> -0.167026).  Saving model ...
Epoch: 23 cost time: 0.6778271198272705
Epoch: 23, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.318 Vali Acc: 0.175 Test Loss: 3.318 Test Acc: 0.175
Validation loss decreased (-0.167026 --> -0.175261).  Saving model ...
Epoch: 24 cost time: 0.5925822257995605
Epoch: 24, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.341 Vali Acc: 0.178 Test Loss: 3.341 Test Acc: 0.178
Validation loss decreased (-0.175261 --> -0.177614).  Saving model ...
Epoch: 25 cost time: 0.5809915065765381
Epoch: 25, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.370 Vali Acc: 0.184 Test Loss: 3.370 Test Acc: 0.184
Validation loss decreased (-0.177614 --> -0.183496).  Saving model ...
Epoch: 26 cost time: 0.49805641174316406
Epoch: 26, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.398 Vali Acc: 0.186 Test Loss: 3.398 Test Acc: 0.186
Validation loss decreased (-0.183496 --> -0.185848).  Saving model ...
Epoch: 27 cost time: 0.6240870952606201
Epoch: 27, Steps: 10 | Train Loss: 0.999 Vali Loss: 3.427 Vali Acc: 0.189 Test Loss: 3.427 Test Acc: 0.189
Validation loss decreased (-0.185848 --> -0.189377).  Saving model ...
Epoch: 28 cost time: 0.5958178043365479
Epoch: 28, Steps: 10 | Train Loss: 0.939 Vali Loss: 3.459 Vali Acc: 0.188 Test Loss: 3.459 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6895720958709717
Epoch: 29, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.480 Vali Acc: 0.189 Test Loss: 3.480 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6194491386413574
Epoch: 30, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.510 Vali Acc: 0.195 Test Loss: 3.510 Test Acc: 0.195
Validation loss decreased (-0.189377 --> -0.195259).  Saving model ...
Epoch: 31 cost time: 0.5912036895751953
Epoch: 31, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.542 Vali Acc: 0.194 Test Loss: 3.542 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7633507251739502
Epoch: 32, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.570 Vali Acc: 0.196 Test Loss: 3.570 Test Acc: 0.196
Validation loss decreased (-0.195259 --> -0.196435).  Saving model ...
Epoch: 33 cost time: 0.5886900424957275
Epoch: 33, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.607 Vali Acc: 0.199 Test Loss: 3.607 Test Acc: 0.199
Validation loss decreased (-0.196435 --> -0.198787).  Saving model ...
Epoch: 34 cost time: 0.5581047534942627
Epoch: 34, Steps: 10 | Train Loss: 0.624 Vali Loss: 3.643 Vali Acc: 0.204 Test Loss: 3.643 Test Acc: 0.204
Validation loss decreased (-0.198787 --> -0.203493).  Saving model ...
Epoch: 35 cost time: 0.5514695644378662
Epoch: 35, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.672 Vali Acc: 0.206 Test Loss: 3.672 Test Acc: 0.206
Validation loss decreased (-0.203493 --> -0.205846).  Saving model ...
Epoch: 36 cost time: 0.5647084712982178
Epoch: 36, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.714 Vali Acc: 0.206 Test Loss: 3.714 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5245473384857178
Epoch: 37, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.753 Vali Acc: 0.209 Test Loss: 3.753 Test Acc: 0.209
Validation loss decreased (-0.205846 --> -0.209374).  Saving model ...
Epoch: 38 cost time: 0.6661994457244873
Epoch: 38, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.789 Vali Acc: 0.209 Test Loss: 3.789 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6539661884307861
Epoch: 39, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.827 Vali Acc: 0.206 Test Loss: 3.827 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6062154769897461
Epoch: 40, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.858 Vali Acc: 0.212 Test Loss: 3.858 Test Acc: 0.212
Validation loss decreased (-0.209374 --> -0.211726).  Saving model ...
Epoch: 41 cost time: 0.6706373691558838
Epoch: 41, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.898 Vali Acc: 0.214 Test Loss: 3.898 Test Acc: 0.214
Validation loss decreased (-0.211726 --> -0.214079).  Saving model ...
Epoch: 42 cost time: 0.664290189743042
Epoch: 42, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.938 Vali Acc: 0.215 Test Loss: 3.938 Test Acc: 0.215
Validation loss decreased (-0.214079 --> -0.215255).  Saving model ...
Epoch: 43 cost time: 0.6984376907348633
Epoch: 43, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.992 Vali Acc: 0.215 Test Loss: 3.992 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.773601770401001
Epoch: 44, Steps: 10 | Train Loss: 0.275 Vali Loss: 4.032 Vali Acc: 0.219 Test Loss: 4.032 Test Acc: 0.219
Validation loss decreased (-0.215255 --> -0.218783).  Saving model ...
Epoch: 45 cost time: 0.5192675590515137
Epoch: 45, Steps: 10 | Train Loss: 0.263 Vali Loss: 4.078 Vali Acc: 0.216 Test Loss: 4.078 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5548996925354004
Epoch: 46, Steps: 10 | Train Loss: 0.233 Vali Loss: 4.120 Vali Acc: 0.224 Test Loss: 4.120 Test Acc: 0.224
Validation loss decreased (-0.218783 --> -0.223488).  Saving model ...
Epoch: 47 cost time: 0.5789656639099121
Epoch: 47, Steps: 10 | Train Loss: 0.213 Vali Loss: 4.177 Vali Acc: 0.220 Test Loss: 4.177 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6917722225189209
Epoch: 48, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.221 Vali Acc: 0.220 Test Loss: 4.221 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6786344051361084
Epoch: 49, Steps: 10 | Train Loss: 0.170 Vali Loss: 4.265 Vali Acc: 0.224 Test Loss: 4.265 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6161141395568848
Epoch: 50, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.323 Vali Acc: 0.222 Test Loss: 4.323 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5587546825408936
Epoch: 51, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.382 Vali Acc: 0.222 Test Loss: 4.382 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6517643928527832
Epoch: 52, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.442 Vali Acc: 0.219 Test Loss: 4.442 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5708529949188232
Epoch: 53, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.482 Vali Acc: 0.226 Test Loss: 4.482 Test Acc: 0.226
Validation loss decreased (-0.223488 --> -0.225838).  Saving model ...
Epoch: 54 cost time: 0.75282883644104
Epoch: 54, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.500 Vali Acc: 0.225 Test Loss: 4.500 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.589393138885498
Epoch: 55, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.553 Vali Acc: 0.225 Test Loss: 4.553 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6886842250823975
Epoch: 56, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.630 Vali Acc: 0.221 Test Loss: 4.630 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.612870454788208
Epoch: 57, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.672 Vali Acc: 0.224 Test Loss: 4.672 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5705513954162598
Epoch: 58, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.703 Vali Acc: 0.219 Test Loss: 4.703 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.6630542278289795
Epoch: 59, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.732 Vali Acc: 0.220 Test Loss: 4.732 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6492199897766113
Epoch: 60, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.803 Vali Acc: 0.221 Test Loss: 4.803 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5698719024658203
Epoch: 61, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.856 Vali Acc: 0.221 Test Loss: 4.856 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.582711935043335
Epoch: 62, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.900 Vali Acc: 0.220 Test Loss: 4.900 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.5615084171295166
Epoch: 63, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.944 Vali Acc: 0.215 Test Loss: 4.944 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22588235294117648
model parameter : 39254
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0228111743927
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.309 Vali Acc: 0.038 Test Loss: 3.309 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.6614007949829102
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.298 Vali Acc: 0.044 Test Loss: 3.298 Test Acc: 0.044
Validation loss decreased (-0.037614 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.5358700752258301
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.283 Vali Acc: 0.045 Test Loss: 3.283 Test Acc: 0.045
Validation loss decreased (-0.043496 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.7382538318634033
Epoch: 4, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.268 Vali Acc: 0.042 Test Loss: 3.268 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6574079990386963
Epoch: 5, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.252 Vali Acc: 0.054 Test Loss: 3.252 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 6 cost time: 0.6154696941375732
Epoch: 6, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.238 Vali Acc: 0.069 Test Loss: 3.238 Test Acc: 0.069
Validation loss decreased (-0.054085 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 0.6079018115997314
Epoch: 7, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.225 Vali Acc: 0.084 Test Loss: 3.225 Test Acc: 0.084
Validation loss decreased (-0.069379 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.720391035079956
Epoch: 8, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.214 Vali Acc: 0.092 Test Loss: 3.214 Test Acc: 0.092
Validation loss decreased (-0.083497 --> -0.091733).  Saving model ...
Epoch: 9 cost time: 0.7012894153594971
Epoch: 9, Steps: 10 | Train Loss: 2.663 Vali Loss: 3.206 Vali Acc: 0.100 Test Loss: 3.206 Test Acc: 0.100
Validation loss decreased (-0.091733 --> -0.099968).  Saving model ...
Epoch: 10 cost time: 0.7153236865997314
Epoch: 10, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.199 Vali Acc: 0.111 Test Loss: 3.199 Test Acc: 0.111
Validation loss decreased (-0.099968 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 0.6349127292633057
Epoch: 11, Steps: 10 | Train Loss: 2.450 Vali Loss: 3.195 Vali Acc: 0.114 Test Loss: 3.195 Test Acc: 0.114
Validation loss decreased (-0.110556 --> -0.114086).  Saving model ...
Epoch: 12 cost time: 0.6542758941650391
Epoch: 12, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.194 Vali Acc: 0.115 Test Loss: 3.194 Test Acc: 0.115
Validation loss decreased (-0.114086 --> -0.115262).  Saving model ...
Epoch: 13 cost time: 0.7891252040863037
Epoch: 13, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.196 Vali Acc: 0.116 Test Loss: 3.196 Test Acc: 0.116
Validation loss decreased (-0.115262 --> -0.116439).  Saving model ...
Epoch: 14 cost time: 0.6847448348999023
Epoch: 14, Steps: 10 | Train Loss: 2.148 Vali Loss: 3.199 Vali Acc: 0.126 Test Loss: 3.199 Test Acc: 0.126
Validation loss decreased (-0.116439 --> -0.125850).  Saving model ...
Epoch: 15 cost time: 0.5476202964782715
Epoch: 15, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.202 Vali Acc: 0.129 Test Loss: 3.202 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129380).  Saving model ...
Epoch: 16 cost time: 0.6112494468688965
Epoch: 16, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.210 Vali Acc: 0.135 Test Loss: 3.210 Test Acc: 0.135
Validation loss decreased (-0.129380 --> -0.135262).  Saving model ...
Epoch: 17 cost time: 0.5601756572723389
Epoch: 17, Steps: 10 | Train Loss: 1.851 Vali Loss: 3.220 Vali Acc: 0.139 Test Loss: 3.220 Test Acc: 0.139
Validation loss decreased (-0.135262 --> -0.138791).  Saving model ...
Epoch: 18 cost time: 0.619612455368042
Epoch: 18, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.232 Vali Acc: 0.140 Test Loss: 3.232 Test Acc: 0.140
Validation loss decreased (-0.138791 --> -0.139968).  Saving model ...
Epoch: 19 cost time: 0.7703518867492676
Epoch: 19, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.247 Vali Acc: 0.149 Test Loss: 3.247 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 20 cost time: 0.6154830455780029
Epoch: 20, Steps: 10 | Train Loss: 1.522 Vali Loss: 3.264 Vali Acc: 0.151 Test Loss: 3.264 Test Acc: 0.151
Validation loss decreased (-0.149379 --> -0.150556).  Saving model ...
Epoch: 21 cost time: 0.5749111175537109
Epoch: 21, Steps: 10 | Train Loss: 1.458 Vali Loss: 3.284 Vali Acc: 0.162 Test Loss: 3.284 Test Acc: 0.162
Validation loss decreased (-0.150556 --> -0.162320).  Saving model ...
Epoch: 22 cost time: 0.5513229370117188
Epoch: 22, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.304 Vali Acc: 0.167 Test Loss: 3.304 Test Acc: 0.167
Validation loss decreased (-0.162320 --> -0.167026).  Saving model ...
Epoch: 23 cost time: 0.6884958744049072
Epoch: 23, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.328 Vali Acc: 0.174 Test Loss: 3.328 Test Acc: 0.174
Validation loss decreased (-0.167026 --> -0.174084).  Saving model ...
Epoch: 24 cost time: 0.6476094722747803
Epoch: 24, Steps: 10 | Train Loss: 1.247 Vali Loss: 3.353 Vali Acc: 0.179 Test Loss: 3.353 Test Acc: 0.179
Validation loss decreased (-0.174084 --> -0.178790).  Saving model ...
Epoch: 25 cost time: 0.6554811000823975
Epoch: 25, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.376 Vali Acc: 0.184 Test Loss: 3.376 Test Acc: 0.184
Validation loss decreased (-0.178790 --> -0.183496).  Saving model ...
Epoch: 26 cost time: 0.7237002849578857
Epoch: 26, Steps: 10 | Train Loss: 1.061 Vali Loss: 3.403 Vali Acc: 0.186 Test Loss: 3.403 Test Acc: 0.186
Validation loss decreased (-0.183496 --> -0.185848).  Saving model ...
Epoch: 27 cost time: 0.7310190200805664
Epoch: 27, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.431 Vali Acc: 0.189 Test Loss: 3.431 Test Acc: 0.189
Validation loss decreased (-0.185848 --> -0.189377).  Saving model ...
Epoch: 28 cost time: 0.625490665435791
Epoch: 28, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.462 Vali Acc: 0.191 Test Loss: 3.462 Test Acc: 0.191
Validation loss decreased (-0.189377 --> -0.190554).  Saving model ...
Epoch: 29 cost time: 0.7107505798339844
Epoch: 29, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.498 Vali Acc: 0.193 Test Loss: 3.498 Test Acc: 0.193
Validation loss decreased (-0.190554 --> -0.192906).  Saving model ...
Epoch: 30 cost time: 0.7708327770233154
Epoch: 30, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.532 Vali Acc: 0.191 Test Loss: 3.532 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5863640308380127
Epoch: 31, Steps: 10 | Train Loss: 0.739 Vali Loss: 3.569 Vali Acc: 0.195 Test Loss: 3.569 Test Acc: 0.195
Validation loss decreased (-0.192906 --> -0.195258).  Saving model ...
Epoch: 32 cost time: 0.707571268081665
Epoch: 32, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.609 Vali Acc: 0.196 Test Loss: 3.609 Test Acc: 0.196
Validation loss decreased (-0.195258 --> -0.196434).  Saving model ...
Epoch: 33 cost time: 0.6270742416381836
Epoch: 33, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.642 Vali Acc: 0.201 Test Loss: 3.642 Test Acc: 0.201
Validation loss decreased (-0.196434 --> -0.201140).  Saving model ...
Epoch: 34 cost time: 0.5443391799926758
Epoch: 34, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.682 Vali Acc: 0.207 Test Loss: 3.682 Test Acc: 0.207
Validation loss decreased (-0.201140 --> -0.207022).  Saving model ...
Epoch: 35 cost time: 0.5926213264465332
Epoch: 35, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.728 Vali Acc: 0.211 Test Loss: 3.728 Test Acc: 0.211
Validation loss decreased (-0.207022 --> -0.210551).  Saving model ...
Epoch: 36 cost time: 0.60347580909729
Epoch: 36, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.771 Vali Acc: 0.213 Test Loss: 3.771 Test Acc: 0.213
Validation loss decreased (-0.210551 --> -0.212903).  Saving model ...
Epoch: 37 cost time: 0.6430544853210449
Epoch: 37, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.827 Vali Acc: 0.209 Test Loss: 3.827 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5794539451599121
Epoch: 38, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.879 Vali Acc: 0.208 Test Loss: 3.879 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7179667949676514
Epoch: 39, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.926 Vali Acc: 0.213 Test Loss: 3.926 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6208527088165283
Epoch: 40, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.987 Vali Acc: 0.213 Test Loss: 3.987 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6409437656402588
Epoch: 41, Steps: 10 | Train Loss: 0.361 Vali Loss: 4.052 Vali Acc: 0.213 Test Loss: 4.052 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5556235313415527
Epoch: 42, Steps: 10 | Train Loss: 0.287 Vali Loss: 4.119 Vali Acc: 0.216 Test Loss: 4.119 Test Acc: 0.216
Validation loss decreased (-0.212903 --> -0.216429).  Saving model ...
Epoch: 43 cost time: 0.5433073043823242
Epoch: 43, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.153 Vali Acc: 0.216 Test Loss: 4.153 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8085508346557617
Epoch: 44, Steps: 10 | Train Loss: 0.245 Vali Loss: 4.203 Vali Acc: 0.221 Test Loss: 4.203 Test Acc: 0.221
Validation loss decreased (-0.216429 --> -0.221134).  Saving model ...
Epoch: 45 cost time: 0.6664958000183105
Epoch: 45, Steps: 10 | Train Loss: 0.225 Vali Loss: 4.262 Vali Acc: 0.219 Test Loss: 4.262 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5721609592437744
Epoch: 46, Steps: 10 | Train Loss: 0.201 Vali Loss: 4.307 Vali Acc: 0.214 Test Loss: 4.307 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5857079029083252
Epoch: 47, Steps: 10 | Train Loss: 0.181 Vali Loss: 4.385 Vali Acc: 0.224 Test Loss: 4.385 Test Acc: 0.224
Validation loss decreased (-0.221134 --> -0.223486).  Saving model ...
Epoch: 48 cost time: 0.5255489349365234
Epoch: 48, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.461 Vali Acc: 0.219 Test Loss: 4.461 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5536818504333496
Epoch: 49, Steps: 10 | Train Loss: 0.158 Vali Loss: 4.532 Vali Acc: 0.216 Test Loss: 4.532 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6771228313446045
Epoch: 50, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.596 Vali Acc: 0.214 Test Loss: 4.596 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5121521949768066
Epoch: 51, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.673 Vali Acc: 0.213 Test Loss: 4.673 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6442370414733887
Epoch: 52, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.725 Vali Acc: 0.212 Test Loss: 4.725 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.57761549949646
Epoch: 53, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.781 Vali Acc: 0.211 Test Loss: 4.781 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.654984712600708
Epoch: 54, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.847 Vali Acc: 0.209 Test Loss: 4.847 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6962592601776123
Epoch: 55, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.879 Vali Acc: 0.212 Test Loss: 4.879 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.5832231044769287
Epoch: 56, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.957 Vali Acc: 0.211 Test Loss: 4.957 Test Acc: 0.211
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5758178234100342
Epoch: 57, Steps: 10 | Train Loss: 0.070 Vali Loss: 5.034 Vali Acc: 0.207 Test Loss: 5.034 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 39222
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs76_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4696671962738037
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.344 Vali Acc: 0.033 Test Loss: 3.344 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.6864027976989746
Epoch: 2, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.328 Vali Acc: 0.035 Test Loss: 3.328 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.6705353260040283
Epoch: 3, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.310 Vali Acc: 0.039 Test Loss: 3.310 Test Acc: 0.039
Validation loss decreased (-0.035261 --> -0.038790).  Saving model ...
Epoch: 4 cost time: 0.7397377490997314
Epoch: 4, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.291 Vali Acc: 0.046 Test Loss: 3.291 Test Acc: 0.046
Validation loss decreased (-0.038790 --> -0.045849).  Saving model ...
Epoch: 5 cost time: 0.6082208156585693
Epoch: 5, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.275 Vali Acc: 0.058 Test Loss: 3.275 Test Acc: 0.058
Validation loss decreased (-0.045849 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 0.6021881103515625
Epoch: 6, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.260 Vali Acc: 0.080 Test Loss: 3.260 Test Acc: 0.080
Validation loss decreased (-0.057614 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 0.608889102935791
Epoch: 7, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.247 Vali Acc: 0.093 Test Loss: 3.247 Test Acc: 0.093
Validation loss decreased (-0.079967 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 0.5871140956878662
Epoch: 8, Steps: 10 | Train Loss: 2.800 Vali Loss: 3.240 Vali Acc: 0.093 Test Loss: 3.240 Test Acc: 0.093
Validation loss decreased (-0.092909 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.5054388046264648
Epoch: 9, Steps: 10 | Train Loss: 2.718 Vali Loss: 3.236 Vali Acc: 0.099 Test Loss: 3.236 Test Acc: 0.099
Validation loss decreased (-0.092909 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 0.6268243789672852
Epoch: 10, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.231 Vali Acc: 0.106 Test Loss: 3.231 Test Acc: 0.106
Validation loss decreased (-0.098791 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.5907149314880371
Epoch: 11, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.227 Vali Acc: 0.113 Test Loss: 3.227 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112909).  Saving model ...
Epoch: 12 cost time: 0.5957422256469727
Epoch: 12, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.226 Vali Acc: 0.121 Test Loss: 3.226 Test Acc: 0.121
Validation loss decreased (-0.112909 --> -0.121144).  Saving model ...
Epoch: 13 cost time: 0.43499159812927246
Epoch: 13, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.224 Vali Acc: 0.129 Test Loss: 3.224 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129380).  Saving model ...
Epoch: 14 cost time: 0.6100752353668213
Epoch: 14, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.221 Vali Acc: 0.131 Test Loss: 3.221 Test Acc: 0.131
Validation loss decreased (-0.129380 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.6216137409210205
Epoch: 15, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.229 Vali Acc: 0.129 Test Loss: 3.229 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6390964984893799
Epoch: 16, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.227 Vali Acc: 0.141 Test Loss: 3.227 Test Acc: 0.141
Validation loss decreased (-0.130556 --> -0.141144).  Saving model ...
Epoch: 17 cost time: 0.6002242565155029
Epoch: 17, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.234 Vali Acc: 0.152 Test Loss: 3.234 Test Acc: 0.152
Validation loss decreased (-0.141144 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 0.5761494636535645
Epoch: 18, Steps: 10 | Train Loss: 1.755 Vali Loss: 3.245 Vali Acc: 0.154 Test Loss: 3.245 Test Acc: 0.154
Validation loss decreased (-0.151732 --> -0.154085).  Saving model ...
Epoch: 19 cost time: 0.6096668243408203
Epoch: 19, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.263 Vali Acc: 0.158 Test Loss: 3.263 Test Acc: 0.158
Validation loss decreased (-0.154085 --> -0.157614).  Saving model ...
Epoch: 20 cost time: 0.605276346206665
Epoch: 20, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.275 Vali Acc: 0.167 Test Loss: 3.275 Test Acc: 0.167
Validation loss decreased (-0.157614 --> -0.167026).  Saving model ...
Epoch: 21 cost time: 0.7503700256347656
Epoch: 21, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.292 Vali Acc: 0.175 Test Loss: 3.292 Test Acc: 0.175
Validation loss decreased (-0.167026 --> -0.175261).  Saving model ...
Epoch: 22 cost time: 0.7411525249481201
Epoch: 22, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.310 Vali Acc: 0.175 Test Loss: 3.310 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5940456390380859
Epoch: 23, Steps: 10 | Train Loss: 1.308 Vali Loss: 3.327 Vali Acc: 0.181 Test Loss: 3.327 Test Acc: 0.181
Validation loss decreased (-0.175261 --> -0.181143).  Saving model ...
Epoch: 24 cost time: 0.547821044921875
Epoch: 24, Steps: 10 | Train Loss: 1.241 Vali Loss: 3.352 Vali Acc: 0.188 Test Loss: 3.352 Test Acc: 0.188
Validation loss decreased (-0.181143 --> -0.188202).  Saving model ...
Epoch: 25 cost time: 0.7109265327453613
Epoch: 25, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.377 Vali Acc: 0.195 Test Loss: 3.377 Test Acc: 0.195
Validation loss decreased (-0.188202 --> -0.195260).  Saving model ...
Epoch: 26 cost time: 0.7520179748535156
Epoch: 26, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.406 Vali Acc: 0.196 Test Loss: 3.406 Test Acc: 0.196
Validation loss decreased (-0.195260 --> -0.196437).  Saving model ...
Epoch: 27 cost time: 0.6867496967315674
Epoch: 27, Steps: 10 | Train Loss: 1.014 Vali Loss: 3.427 Vali Acc: 0.209 Test Loss: 3.427 Test Acc: 0.209
Validation loss decreased (-0.196437 --> -0.209377).  Saving model ...
Epoch: 28 cost time: 0.6216757297515869
Epoch: 28, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.463 Vali Acc: 0.205 Test Loss: 3.463 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6454882621765137
Epoch: 29, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.491 Vali Acc: 0.209 Test Loss: 3.491 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5545642375946045
Epoch: 30, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.521 Vali Acc: 0.209 Test Loss: 3.521 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5918750762939453
Epoch: 31, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.553 Vali Acc: 0.211 Test Loss: 3.553 Test Acc: 0.211
Validation loss decreased (-0.209377 --> -0.210553).  Saving model ...
Epoch: 32 cost time: 0.644629955291748
Epoch: 32, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.594 Vali Acc: 0.214 Test Loss: 3.594 Test Acc: 0.214
Validation loss decreased (-0.210553 --> -0.214082).  Saving model ...
Epoch: 33 cost time: 0.5877561569213867
Epoch: 33, Steps: 10 | Train Loss: 0.669 Vali Loss: 3.629 Vali Acc: 0.212 Test Loss: 3.629 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.513838529586792
Epoch: 34, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.663 Vali Acc: 0.212 Test Loss: 3.663 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6327285766601562
Epoch: 35, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.698 Vali Acc: 0.218 Test Loss: 3.698 Test Acc: 0.218
Validation loss decreased (-0.214082 --> -0.217610).  Saving model ...
Epoch: 36 cost time: 0.5726690292358398
Epoch: 36, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.729 Vali Acc: 0.215 Test Loss: 3.729 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5901017189025879
Epoch: 37, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.775 Vali Acc: 0.216 Test Loss: 3.775 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5444750785827637
Epoch: 38, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.824 Vali Acc: 0.225 Test Loss: 3.824 Test Acc: 0.225
Validation loss decreased (-0.217610 --> -0.224668).  Saving model ...
Epoch: 39 cost time: 0.6043412685394287
Epoch: 39, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.863 Vali Acc: 0.220 Test Loss: 3.863 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6078386306762695
Epoch: 40, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.914 Vali Acc: 0.215 Test Loss: 3.914 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6507837772369385
Epoch: 41, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.956 Vali Acc: 0.220 Test Loss: 3.956 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5767736434936523
Epoch: 42, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.996 Vali Acc: 0.219 Test Loss: 3.996 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6722428798675537
Epoch: 43, Steps: 10 | Train Loss: 0.303 Vali Loss: 4.036 Vali Acc: 0.226 Test Loss: 4.036 Test Acc: 0.226
Validation loss decreased (-0.224668 --> -0.225842).  Saving model ...
Epoch: 44 cost time: 0.6206815242767334
Epoch: 44, Steps: 10 | Train Loss: 0.262 Vali Loss: 4.071 Vali Acc: 0.235 Test Loss: 4.071 Test Acc: 0.235
Validation loss decreased (-0.225842 --> -0.235253).  Saving model ...
Epoch: 45 cost time: 0.5908048152923584
Epoch: 45, Steps: 10 | Train Loss: 0.241 Vali Loss: 4.115 Vali Acc: 0.231 Test Loss: 4.115 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6083884239196777
Epoch: 46, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.188 Vali Acc: 0.231 Test Loss: 4.188 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.551835298538208
Epoch: 47, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.234 Vali Acc: 0.226 Test Loss: 4.234 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5013167858123779
Epoch: 48, Steps: 10 | Train Loss: 0.205 Vali Loss: 4.275 Vali Acc: 0.228 Test Loss: 4.275 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5597391128540039
Epoch: 49, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.366 Vali Acc: 0.231 Test Loss: 4.366 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.703082799911499
Epoch: 50, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.385 Vali Acc: 0.234 Test Loss: 4.385 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.668548583984375
Epoch: 51, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.435 Vali Acc: 0.235 Test Loss: 4.435 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5426476001739502
Epoch: 52, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.538 Vali Acc: 0.235 Test Loss: 4.538 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5574924945831299
Epoch: 53, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.544 Vali Acc: 0.239 Test Loss: 4.544 Test Acc: 0.239
Validation loss decreased (-0.235253 --> -0.238778).  Saving model ...
Epoch: 54 cost time: 0.6165566444396973
Epoch: 54, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.587 Vali Acc: 0.238 Test Loss: 4.587 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6760609149932861
Epoch: 55, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.672 Vali Acc: 0.231 Test Loss: 4.672 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5874919891357422
Epoch: 56, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.732 Vali Acc: 0.231 Test Loss: 4.732 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6302762031555176
Epoch: 57, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.774 Vali Acc: 0.232 Test Loss: 4.774 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5706405639648438
Epoch: 58, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.805 Vali Acc: 0.234 Test Loss: 4.805 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5846335887908936
Epoch: 59, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.867 Vali Acc: 0.231 Test Loss: 4.867 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.591874361038208
Epoch: 60, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.947 Vali Acc: 0.231 Test Loss: 4.947 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.6897082328796387
Epoch: 61, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.993 Vali Acc: 0.228 Test Loss: 4.993 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5841560363769531
Epoch: 62, Steps: 10 | Train Loss: 0.051 Vali Loss: 5.028 Vali Acc: 0.225 Test Loss: 5.028 Test Acc: 0.225
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.46758079528808594
Epoch: 63, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.111 Vali Acc: 0.225 Test Loss: 5.111 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs76_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2388235294117647
model parameter : 37584
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9523780345916748
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.331 Vali Acc: 0.021 Test Loss: 3.331 Test Acc: 0.021
Validation loss decreased (inf --> -0.021143).  Saving model ...
Epoch: 2 cost time: 0.4544978141784668
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.320 Vali Acc: 0.022 Test Loss: 3.320 Test Acc: 0.022
Validation loss decreased (-0.021143 --> -0.022320).  Saving model ...
Epoch: 3 cost time: 0.5743818283081055
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.304 Vali Acc: 0.028 Test Loss: 3.304 Test Acc: 0.028
Validation loss decreased (-0.022320 --> -0.028202).  Saving model ...
Epoch: 4 cost time: 0.5424981117248535
Epoch: 4, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.289 Vali Acc: 0.040 Test Loss: 3.289 Test Acc: 0.040
Validation loss decreased (-0.028202 --> -0.039967).  Saving model ...
Epoch: 5 cost time: 0.5595817565917969
Epoch: 5, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.274 Vali Acc: 0.059 Test Loss: 3.274 Test Acc: 0.059
Validation loss decreased (-0.039967 --> -0.058791).  Saving model ...
Epoch: 6 cost time: 0.6635651588439941
Epoch: 6, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.260 Vali Acc: 0.065 Test Loss: 3.260 Test Acc: 0.065
Validation loss decreased (-0.058791 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 0.5792381763458252
Epoch: 7, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.249 Vali Acc: 0.076 Test Loss: 3.249 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 0.8620438575744629
Epoch: 8, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.239 Vali Acc: 0.091 Test Loss: 3.239 Test Acc: 0.091
Validation loss decreased (-0.076438 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.676354169845581
Epoch: 9, Steps: 10 | Train Loss: 2.671 Vali Loss: 3.233 Vali Acc: 0.094 Test Loss: 3.233 Test Acc: 0.094
Validation loss decreased (-0.090556 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 0.6543059349060059
Epoch: 10, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.230 Vali Acc: 0.101 Test Loss: 3.230 Test Acc: 0.101
Validation loss decreased (-0.094085 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.5687997341156006
Epoch: 11, Steps: 10 | Train Loss: 2.485 Vali Loss: 3.226 Vali Acc: 0.109 Test Loss: 3.226 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109380).  Saving model ...
Epoch: 12 cost time: 0.6185884475708008
Epoch: 12, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.225 Vali Acc: 0.122 Test Loss: 3.225 Test Acc: 0.122
Validation loss decreased (-0.109380 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.6357426643371582
Epoch: 13, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.226 Vali Acc: 0.124 Test Loss: 3.226 Test Acc: 0.124
Validation loss decreased (-0.122321 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 0.6944506168365479
Epoch: 14, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.229 Vali Acc: 0.127 Test Loss: 3.229 Test Acc: 0.127
Validation loss decreased (-0.123497 --> -0.127027).  Saving model ...
Epoch: 15 cost time: 0.7150712013244629
Epoch: 15, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.238 Vali Acc: 0.128 Test Loss: 3.238 Test Acc: 0.128
Validation loss decreased (-0.127027 --> -0.128203).  Saving model ...
Epoch: 16 cost time: 0.6678237915039062
Epoch: 16, Steps: 10 | Train Loss: 1.936 Vali Loss: 3.241 Vali Acc: 0.132 Test Loss: 3.241 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131732).  Saving model ...
Epoch: 17 cost time: 0.6811082363128662
Epoch: 17, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.252 Vali Acc: 0.145 Test Loss: 3.252 Test Acc: 0.145
Validation loss decreased (-0.131732 --> -0.144673).  Saving model ...
Epoch: 18 cost time: 0.6653549671173096
Epoch: 18, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.262 Vali Acc: 0.154 Test Loss: 3.262 Test Acc: 0.154
Validation loss decreased (-0.144673 --> -0.154085).  Saving model ...
Epoch: 19 cost time: 0.7062890529632568
Epoch: 19, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.274 Vali Acc: 0.161 Test Loss: 3.274 Test Acc: 0.161
Validation loss decreased (-0.154085 --> -0.161144).  Saving model ...
Epoch: 20 cost time: 0.5039284229278564
Epoch: 20, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.291 Vali Acc: 0.165 Test Loss: 3.291 Test Acc: 0.165
Validation loss decreased (-0.161144 --> -0.164673).  Saving model ...
Epoch: 21 cost time: 0.6166846752166748
Epoch: 21, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.310 Vali Acc: 0.176 Test Loss: 3.310 Test Acc: 0.176
Validation loss decreased (-0.164673 --> -0.176437).  Saving model ...
Epoch: 22 cost time: 0.7174479961395264
Epoch: 22, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.328 Vali Acc: 0.180 Test Loss: 3.328 Test Acc: 0.180
Validation loss decreased (-0.176437 --> -0.179967).  Saving model ...
Epoch: 23 cost time: 0.6504247188568115
Epoch: 23, Steps: 10 | Train Loss: 1.314 Vali Loss: 3.348 Vali Acc: 0.182 Test Loss: 3.348 Test Acc: 0.182
Validation loss decreased (-0.179967 --> -0.182319).  Saving model ...
Epoch: 24 cost time: 1.066967248916626
Epoch: 24, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.370 Vali Acc: 0.184 Test Loss: 3.370 Test Acc: 0.184
Validation loss decreased (-0.182319 --> -0.183496).  Saving model ...
Epoch: 25 cost time: 0.5223686695098877
Epoch: 25, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.393 Vali Acc: 0.188 Test Loss: 3.393 Test Acc: 0.188
Validation loss decreased (-0.183496 --> -0.188201).  Saving model ...
Epoch: 26 cost time: 0.5954656600952148
Epoch: 26, Steps: 10 | Train Loss: 1.081 Vali Loss: 3.423 Vali Acc: 0.191 Test Loss: 3.423 Test Acc: 0.191
Validation loss decreased (-0.188201 --> -0.190554).  Saving model ...
Epoch: 27 cost time: 0.5923302173614502
Epoch: 27, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.449 Vali Acc: 0.189 Test Loss: 3.449 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7469253540039062
Epoch: 28, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.486 Vali Acc: 0.193 Test Loss: 3.486 Test Acc: 0.193
Validation loss decreased (-0.190554 --> -0.192906).  Saving model ...
Epoch: 29 cost time: 0.6575546264648438
Epoch: 29, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.511 Vali Acc: 0.198 Test Loss: 3.511 Test Acc: 0.198
Validation loss decreased (-0.192906 --> -0.197612).  Saving model ...
Epoch: 30 cost time: 0.5519962310791016
Epoch: 30, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.545 Vali Acc: 0.205 Test Loss: 3.545 Test Acc: 0.205
Validation loss decreased (-0.197612 --> -0.204670).  Saving model ...
Epoch: 31 cost time: 0.5287430286407471
Epoch: 31, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.576 Vali Acc: 0.205 Test Loss: 3.576 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6547112464904785
Epoch: 32, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.613 Vali Acc: 0.201 Test Loss: 3.613 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7601737976074219
Epoch: 33, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.646 Vali Acc: 0.207 Test Loss: 3.646 Test Acc: 0.207
Validation loss decreased (-0.204670 --> -0.207022).  Saving model ...
Epoch: 34 cost time: 0.5962481498718262
Epoch: 34, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.675 Vali Acc: 0.204 Test Loss: 3.675 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6492903232574463
Epoch: 35, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.712 Vali Acc: 0.206 Test Loss: 3.712 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7090673446655273
Epoch: 36, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.752 Vali Acc: 0.204 Test Loss: 3.752 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8289453983306885
Epoch: 37, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.792 Vali Acc: 0.206 Test Loss: 3.792 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6795392036437988
Epoch: 38, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.833 Vali Acc: 0.206 Test Loss: 3.833 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6567392349243164
Epoch: 39, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.869 Vali Acc: 0.208 Test Loss: 3.869 Test Acc: 0.208
Validation loss decreased (-0.207022 --> -0.208197).  Saving model ...
Epoch: 40 cost time: 0.662703275680542
Epoch: 40, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.911 Vali Acc: 0.213 Test Loss: 3.911 Test Acc: 0.213
Validation loss decreased (-0.208197 --> -0.212902).  Saving model ...
Epoch: 41 cost time: 0.6016845703125
Epoch: 41, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.953 Vali Acc: 0.213 Test Loss: 3.953 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6611974239349365
Epoch: 42, Steps: 10 | Train Loss: 0.332 Vali Loss: 4.000 Vali Acc: 0.211 Test Loss: 4.000 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6371889114379883
Epoch: 43, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.038 Vali Acc: 0.211 Test Loss: 4.038 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6652998924255371
Epoch: 44, Steps: 10 | Train Loss: 0.302 Vali Loss: 4.079 Vali Acc: 0.215 Test Loss: 4.079 Test Acc: 0.215
Validation loss decreased (-0.212902 --> -0.215253).  Saving model ...
Epoch: 45 cost time: 0.6743216514587402
Epoch: 45, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.127 Vali Acc: 0.215 Test Loss: 4.127 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6078476905822754
Epoch: 46, Steps: 10 | Train Loss: 0.241 Vali Loss: 4.175 Vali Acc: 0.216 Test Loss: 4.175 Test Acc: 0.216
Validation loss decreased (-0.215253 --> -0.216429).  Saving model ...
Epoch: 47 cost time: 0.6160709857940674
Epoch: 47, Steps: 10 | Train Loss: 0.221 Vali Loss: 4.212 Vali Acc: 0.220 Test Loss: 4.212 Test Acc: 0.220
Validation loss decreased (-0.216429 --> -0.219958).  Saving model ...
Epoch: 48 cost time: 0.705026388168335
Epoch: 48, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.251 Vali Acc: 0.221 Test Loss: 4.251 Test Acc: 0.221
Validation loss decreased (-0.219958 --> -0.221134).  Saving model ...
Epoch: 49 cost time: 0.7952430248260498
Epoch: 49, Steps: 10 | Train Loss: 0.189 Vali Loss: 4.291 Vali Acc: 0.219 Test Loss: 4.291 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6123054027557373
Epoch: 50, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.344 Vali Acc: 0.220 Test Loss: 4.344 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7257962226867676
Epoch: 51, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.361 Vali Acc: 0.221 Test Loss: 4.361 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6240298748016357
Epoch: 52, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.416 Vali Acc: 0.220 Test Loss: 4.416 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.549729585647583
Epoch: 53, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.480 Vali Acc: 0.215 Test Loss: 4.480 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.6064352989196777
Epoch: 54, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.504 Vali Acc: 0.215 Test Loss: 4.504 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.7698266506195068
Epoch: 55, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.551 Vali Acc: 0.216 Test Loss: 4.551 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.5738222599029541
Epoch: 56, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.607 Vali Acc: 0.215 Test Loss: 4.607 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.542837381362915
Epoch: 57, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.630 Vali Acc: 0.209 Test Loss: 4.630 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.8316655158996582
Epoch: 58, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.666 Vali Acc: 0.211 Test Loss: 4.666 Test Acc: 0.211
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2211764705882353
model parameter : 37350
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2741849422454834
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.325 Vali Acc: 0.042 Test Loss: 3.325 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.5857610702514648
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.313 Vali Acc: 0.042 Test Loss: 3.313 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.6200923919677734
Epoch: 3, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.298 Vali Acc: 0.058 Test Loss: 3.298 Test Acc: 0.058
Validation loss decreased (-0.042320 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.6675026416778564
Epoch: 4, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.284 Vali Acc: 0.067 Test Loss: 3.284 Test Acc: 0.067
Validation loss decreased (-0.057614 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.6429133415222168
Epoch: 5, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.272 Vali Acc: 0.076 Test Loss: 3.272 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.6326837539672852
Epoch: 6, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.262 Vali Acc: 0.094 Test Loss: 3.262 Test Acc: 0.094
Validation loss decreased (-0.076438 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 0.6986992359161377
Epoch: 7, Steps: 10 | Train Loss: 2.882 Vali Loss: 3.252 Vali Acc: 0.100 Test Loss: 3.252 Test Acc: 0.100
Validation loss decreased (-0.094085 --> -0.099967).  Saving model ...
Epoch: 8 cost time: 0.5556299686431885
Epoch: 8, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.244 Vali Acc: 0.107 Test Loss: 3.244 Test Acc: 0.107
Validation loss decreased (-0.099967 --> -0.107026).  Saving model ...
Epoch: 9 cost time: 0.6491923332214355
Epoch: 9, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.236 Vali Acc: 0.114 Test Loss: 3.236 Test Acc: 0.114
Validation loss decreased (-0.107026 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 0.7187492847442627
Epoch: 10, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.228 Vali Acc: 0.113 Test Loss: 3.228 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7594232559204102
Epoch: 11, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.220 Vali Acc: 0.121 Test Loss: 3.220 Test Acc: 0.121
Validation loss decreased (-0.114085 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 0.6130862236022949
Epoch: 12, Steps: 10 | Train Loss: 2.378 Vali Loss: 3.216 Vali Acc: 0.128 Test Loss: 3.216 Test Acc: 0.128
Validation loss decreased (-0.121144 --> -0.128203).  Saving model ...
Epoch: 13 cost time: 0.4638640880584717
Epoch: 13, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.217 Vali Acc: 0.133 Test Loss: 3.217 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.6042492389678955
Epoch: 14, Steps: 10 | Train Loss: 2.201 Vali Loss: 3.217 Vali Acc: 0.135 Test Loss: 3.217 Test Acc: 0.135
Validation loss decreased (-0.132909 --> -0.135262).  Saving model ...
Epoch: 15 cost time: 0.5615749359130859
Epoch: 15, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.219 Vali Acc: 0.144 Test Loss: 3.219 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 0.6089980602264404
Epoch: 16, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.225 Vali Acc: 0.153 Test Loss: 3.225 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152909).  Saving model ...
Epoch: 17 cost time: 0.5937244892120361
Epoch: 17, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.229 Vali Acc: 0.161 Test Loss: 3.229 Test Acc: 0.161
Validation loss decreased (-0.152909 --> -0.161144).  Saving model ...
Epoch: 18 cost time: 0.5410988330841064
Epoch: 18, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.234 Vali Acc: 0.171 Test Loss: 3.234 Test Acc: 0.171
Validation loss decreased (-0.161144 --> -0.170556).  Saving model ...
Epoch: 19 cost time: 0.573946475982666
Epoch: 19, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.243 Vali Acc: 0.180 Test Loss: 3.243 Test Acc: 0.180
Validation loss decreased (-0.170556 --> -0.179968).  Saving model ...
Epoch: 20 cost time: 0.7177422046661377
Epoch: 20, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.259 Vali Acc: 0.186 Test Loss: 3.259 Test Acc: 0.186
Validation loss decreased (-0.179968 --> -0.185850).  Saving model ...
Epoch: 21 cost time: 0.639568567276001
Epoch: 21, Steps: 10 | Train Loss: 1.489 Vali Loss: 3.273 Vali Acc: 0.182 Test Loss: 3.273 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5755164623260498
Epoch: 22, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.294 Vali Acc: 0.200 Test Loss: 3.294 Test Acc: 0.200
Validation loss decreased (-0.185850 --> -0.199967).  Saving model ...
Epoch: 23 cost time: 0.6259655952453613
Epoch: 23, Steps: 10 | Train Loss: 1.316 Vali Loss: 3.320 Vali Acc: 0.198 Test Loss: 3.320 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5727014541625977
Epoch: 24, Steps: 10 | Train Loss: 1.235 Vali Loss: 3.340 Vali Acc: 0.206 Test Loss: 3.340 Test Acc: 0.206
Validation loss decreased (-0.199967 --> -0.205849).  Saving model ...
Epoch: 25 cost time: 0.815030574798584
Epoch: 25, Steps: 10 | Train Loss: 1.178 Vali Loss: 3.365 Vali Acc: 0.205 Test Loss: 3.365 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8248946666717529
Epoch: 26, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.394 Vali Acc: 0.207 Test Loss: 3.394 Test Acc: 0.207
Validation loss decreased (-0.205849 --> -0.207025).  Saving model ...
Epoch: 27 cost time: 0.54038405418396
Epoch: 27, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.419 Vali Acc: 0.209 Test Loss: 3.419 Test Acc: 0.209
Validation loss decreased (-0.207025 --> -0.209378).  Saving model ...
Epoch: 28 cost time: 0.6756255626678467
Epoch: 28, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.451 Vali Acc: 0.209 Test Loss: 3.451 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5915553569793701
Epoch: 29, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.479 Vali Acc: 0.208 Test Loss: 3.479 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6716244220733643
Epoch: 30, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.507 Vali Acc: 0.213 Test Loss: 3.507 Test Acc: 0.213
Validation loss decreased (-0.209378 --> -0.212906).  Saving model ...
Epoch: 31 cost time: 0.6524436473846436
Epoch: 31, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.539 Vali Acc: 0.212 Test Loss: 3.539 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6919291019439697
Epoch: 32, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.576 Vali Acc: 0.214 Test Loss: 3.576 Test Acc: 0.214
Validation loss decreased (-0.212906 --> -0.214082).  Saving model ...
Epoch: 33 cost time: 0.5902249813079834
Epoch: 33, Steps: 10 | Train Loss: 0.696 Vali Loss: 3.609 Vali Acc: 0.215 Test Loss: 3.609 Test Acc: 0.215
Validation loss decreased (-0.214082 --> -0.215258).  Saving model ...
Epoch: 34 cost time: 0.5897550582885742
Epoch: 34, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.641 Vali Acc: 0.216 Test Loss: 3.641 Test Acc: 0.216
Validation loss decreased (-0.215258 --> -0.216434).  Saving model ...
Epoch: 35 cost time: 0.659583330154419
Epoch: 35, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.678 Vali Acc: 0.222 Test Loss: 3.678 Test Acc: 0.222
Validation loss decreased (-0.216434 --> -0.222316).  Saving model ...
Epoch: 36 cost time: 0.662315845489502
Epoch: 36, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.715 Vali Acc: 0.219 Test Loss: 3.715 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4984149932861328
Epoch: 37, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.752 Vali Acc: 0.221 Test Loss: 3.752 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5263545513153076
Epoch: 38, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.793 Vali Acc: 0.221 Test Loss: 3.793 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.561784029006958
Epoch: 39, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.831 Vali Acc: 0.219 Test Loss: 3.831 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6299958229064941
Epoch: 40, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.868 Vali Acc: 0.220 Test Loss: 3.868 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7008452415466309
Epoch: 41, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.915 Vali Acc: 0.214 Test Loss: 3.915 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6793003082275391
Epoch: 42, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.950 Vali Acc: 0.215 Test Loss: 3.950 Test Acc: 0.215
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7395343780517578
Epoch: 43, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.988 Vali Acc: 0.218 Test Loss: 3.988 Test Acc: 0.218
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5476443767547607
Epoch: 44, Steps: 10 | Train Loss: 0.255 Vali Loss: 4.035 Vali Acc: 0.218 Test Loss: 4.035 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6856451034545898
Epoch: 45, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.091 Vali Acc: 0.216 Test Loss: 4.091 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2223529411764706
model parameter : 37008
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9633748531341553
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.320 Vali Acc: 0.034 Test Loss: 3.320 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.573261022567749
Epoch: 2, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.309 Vali Acc: 0.036 Test Loss: 3.309 Test Acc: 0.036
Validation loss decreased (-0.034084 --> -0.036438).  Saving model ...
Epoch: 3 cost time: 0.6020972728729248
Epoch: 3, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.295 Vali Acc: 0.051 Test Loss: 3.295 Test Acc: 0.051
Validation loss decreased (-0.036438 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.6031332015991211
Epoch: 4, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.280 Vali Acc: 0.058 Test Loss: 3.280 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.6721038818359375
Epoch: 5, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.266 Vali Acc: 0.064 Test Loss: 3.266 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.6065473556518555
Epoch: 6, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.254 Vali Acc: 0.073 Test Loss: 3.254 Test Acc: 0.073
Validation loss decreased (-0.063497 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 0.6663928031921387
Epoch: 7, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.244 Vali Acc: 0.084 Test Loss: 3.244 Test Acc: 0.084
Validation loss decreased (-0.072909 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.5757718086242676
Epoch: 8, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.234 Vali Acc: 0.089 Test Loss: 3.234 Test Acc: 0.089
Validation loss decreased (-0.083497 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 0.5844075679779053
Epoch: 9, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.227 Vali Acc: 0.096 Test Loss: 3.227 Test Acc: 0.096
Validation loss decreased (-0.089379 --> -0.096438).  Saving model ...
Epoch: 10 cost time: 0.6659691333770752
Epoch: 10, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.222 Vali Acc: 0.104 Test Loss: 3.222 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 0.6074581146240234
Epoch: 11, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.218 Vali Acc: 0.106 Test Loss: 3.218 Test Acc: 0.106
Validation loss decreased (-0.103497 --> -0.105850).  Saving model ...
Epoch: 12 cost time: 0.4697089195251465
Epoch: 12, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.219 Vali Acc: 0.112 Test Loss: 3.219 Test Acc: 0.112
Validation loss decreased (-0.105850 --> -0.111733).  Saving model ...
Epoch: 13 cost time: 0.5494256019592285
Epoch: 13, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.217 Vali Acc: 0.118 Test Loss: 3.217 Test Acc: 0.118
Validation loss decreased (-0.111733 --> -0.117615).  Saving model ...
Epoch: 14 cost time: 0.6731164455413818
Epoch: 14, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.219 Vali Acc: 0.122 Test Loss: 3.219 Test Acc: 0.122
Validation loss decreased (-0.117615 --> -0.122321).  Saving model ...
Epoch: 15 cost time: 0.62101149559021
Epoch: 15, Steps: 10 | Train Loss: 2.091 Vali Loss: 3.222 Vali Acc: 0.133 Test Loss: 3.222 Test Acc: 0.133
Validation loss decreased (-0.122321 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 0.6511569023132324
Epoch: 16, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.225 Vali Acc: 0.140 Test Loss: 3.225 Test Acc: 0.140
Validation loss decreased (-0.132909 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 0.5933492183685303
Epoch: 17, Steps: 10 | Train Loss: 1.872 Vali Loss: 3.233 Vali Acc: 0.147 Test Loss: 3.233 Test Acc: 0.147
Validation loss decreased (-0.139968 --> -0.147026).  Saving model ...
Epoch: 18 cost time: 0.6185755729675293
Epoch: 18, Steps: 10 | Train Loss: 1.796 Vali Loss: 3.242 Vali Acc: 0.149 Test Loss: 3.242 Test Acc: 0.149
Validation loss decreased (-0.147026 --> -0.149379).  Saving model ...
Epoch: 19 cost time: 0.766589879989624
Epoch: 19, Steps: 10 | Train Loss: 1.686 Vali Loss: 3.253 Vali Acc: 0.156 Test Loss: 3.253 Test Acc: 0.156
Validation loss decreased (-0.149379 --> -0.156438).  Saving model ...
Epoch: 20 cost time: 0.5855712890625
Epoch: 20, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.266 Vali Acc: 0.160 Test Loss: 3.266 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159967).  Saving model ...
Epoch: 21 cost time: 0.6553516387939453
Epoch: 21, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.281 Vali Acc: 0.173 Test Loss: 3.281 Test Acc: 0.173
Validation loss decreased (-0.159967 --> -0.172908).  Saving model ...
Epoch: 22 cost time: 0.6253468990325928
Epoch: 22, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.298 Vali Acc: 0.176 Test Loss: 3.298 Test Acc: 0.176
Validation loss decreased (-0.172908 --> -0.176438).  Saving model ...
Epoch: 23 cost time: 0.557842493057251
Epoch: 23, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.320 Vali Acc: 0.179 Test Loss: 3.320 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178790).  Saving model ...
Epoch: 24 cost time: 0.6937565803527832
Epoch: 24, Steps: 10 | Train Loss: 1.257 Vali Loss: 3.341 Vali Acc: 0.181 Test Loss: 3.341 Test Acc: 0.181
Validation loss decreased (-0.178790 --> -0.181143).  Saving model ...
Epoch: 25 cost time: 0.6454980373382568
Epoch: 25, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.371 Vali Acc: 0.187 Test Loss: 3.371 Test Acc: 0.187
Validation loss decreased (-0.181143 --> -0.187025).  Saving model ...
Epoch: 26 cost time: 0.653761625289917
Epoch: 26, Steps: 10 | Train Loss: 1.098 Vali Loss: 3.391 Vali Acc: 0.185 Test Loss: 3.391 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6764898300170898
Epoch: 27, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.419 Vali Acc: 0.189 Test Loss: 3.419 Test Acc: 0.189
Validation loss decreased (-0.187025 --> -0.189378).  Saving model ...
Epoch: 28 cost time: 0.6668426990509033
Epoch: 28, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.447 Vali Acc: 0.193 Test Loss: 3.447 Test Acc: 0.193
Validation loss decreased (-0.189378 --> -0.192907).  Saving model ...
Epoch: 29 cost time: 0.6741530895233154
Epoch: 29, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.478 Vali Acc: 0.192 Test Loss: 3.478 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8361048698425293
Epoch: 30, Steps: 10 | Train Loss: 0.878 Vali Loss: 3.508 Vali Acc: 0.196 Test Loss: 3.508 Test Acc: 0.196
Validation loss decreased (-0.192907 --> -0.196436).  Saving model ...
Epoch: 31 cost time: 0.6252598762512207
Epoch: 31, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.534 Vali Acc: 0.196 Test Loss: 3.534 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6190862655639648
Epoch: 32, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.564 Vali Acc: 0.200 Test Loss: 3.564 Test Acc: 0.200
Validation loss decreased (-0.196436 --> -0.199964).  Saving model ...
Epoch: 33 cost time: 0.6305282115936279
Epoch: 33, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.600 Vali Acc: 0.205 Test Loss: 3.600 Test Acc: 0.205
Validation loss decreased (-0.199964 --> -0.204670).  Saving model ...
Epoch: 34 cost time: 0.59116530418396
Epoch: 34, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.636 Vali Acc: 0.202 Test Loss: 3.636 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6230130195617676
Epoch: 35, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.671 Vali Acc: 0.199 Test Loss: 3.671 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6192169189453125
Epoch: 36, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.704 Vali Acc: 0.198 Test Loss: 3.704 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5865352153778076
Epoch: 37, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.743 Vali Acc: 0.208 Test Loss: 3.743 Test Acc: 0.208
Validation loss decreased (-0.204670 --> -0.208198).  Saving model ...
Epoch: 38 cost time: 0.5278570652008057
Epoch: 38, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.782 Vali Acc: 0.209 Test Loss: 3.782 Test Acc: 0.209
Validation loss decreased (-0.208198 --> -0.209374).  Saving model ...
Epoch: 39 cost time: 0.60243821144104
Epoch: 39, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.821 Vali Acc: 0.206 Test Loss: 3.821 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6881258487701416
Epoch: 40, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.858 Vali Acc: 0.209 Test Loss: 3.858 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5830478668212891
Epoch: 41, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.897 Vali Acc: 0.207 Test Loss: 3.897 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4829561710357666
Epoch: 42, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.936 Vali Acc: 0.211 Test Loss: 3.936 Test Acc: 0.211
Validation loss decreased (-0.209374 --> -0.210549).  Saving model ...
Epoch: 43 cost time: 0.5620517730712891
Epoch: 43, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.983 Vali Acc: 0.212 Test Loss: 3.983 Test Acc: 0.212
Validation loss decreased (-0.210549 --> -0.211725).  Saving model ...
Epoch: 44 cost time: 0.7279465198516846
Epoch: 44, Steps: 10 | Train Loss: 0.276 Vali Loss: 4.025 Vali Acc: 0.220 Test Loss: 4.025 Test Acc: 0.220
Validation loss decreased (-0.211725 --> -0.219960).  Saving model ...
Epoch: 45 cost time: 0.7022073268890381
Epoch: 45, Steps: 10 | Train Loss: 0.260 Vali Loss: 4.068 Vali Acc: 0.219 Test Loss: 4.068 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6466183662414551
Epoch: 46, Steps: 10 | Train Loss: 0.233 Vali Loss: 4.109 Vali Acc: 0.215 Test Loss: 4.109 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7331187725067139
Epoch: 47, Steps: 10 | Train Loss: 0.217 Vali Loss: 4.160 Vali Acc: 0.213 Test Loss: 4.160 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.59623122215271
Epoch: 48, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.200 Vali Acc: 0.212 Test Loss: 4.200 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7369141578674316
Epoch: 49, Steps: 10 | Train Loss: 0.187 Vali Loss: 4.254 Vali Acc: 0.218 Test Loss: 4.254 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6620633602142334
Epoch: 50, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.305 Vali Acc: 0.214 Test Loss: 4.305 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6635887622833252
Epoch: 51, Steps: 10 | Train Loss: 0.157 Vali Loss: 4.348 Vali Acc: 0.213 Test Loss: 4.348 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5888183116912842
Epoch: 52, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.399 Vali Acc: 0.215 Test Loss: 4.399 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6237902641296387
Epoch: 53, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.459 Vali Acc: 0.215 Test Loss: 4.459 Test Acc: 0.215
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.6763298511505127
Epoch: 54, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.489 Vali Acc: 0.215 Test Loss: 4.489 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22
model parameter : 37374
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.363032579421997
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.349 Vali Acc: 0.028 Test Loss: 3.349 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.6384525299072266
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.337 Vali Acc: 0.034 Test Loss: 3.337 Test Acc: 0.034
Validation loss decreased (-0.028202 --> -0.034084).  Saving model ...
Epoch: 3 cost time: 0.515012264251709
Epoch: 3, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.322 Vali Acc: 0.048 Test Loss: 3.322 Test Acc: 0.048
Validation loss decreased (-0.034084 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.587780237197876
Epoch: 4, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.307 Vali Acc: 0.058 Test Loss: 3.307 Test Acc: 0.058
Validation loss decreased (-0.048202 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.6032137870788574
Epoch: 5, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.293 Vali Acc: 0.066 Test Loss: 3.293 Test Acc: 0.066
Validation loss decreased (-0.057614 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 0.7394835948944092
Epoch: 6, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.281 Vali Acc: 0.075 Test Loss: 3.281 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.5569143295288086
Epoch: 7, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.271 Vali Acc: 0.079 Test Loss: 3.271 Test Acc: 0.079
Validation loss decreased (-0.075261 --> -0.078791).  Saving model ...
Epoch: 8 cost time: 0.5825784206390381
Epoch: 8, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.264 Vali Acc: 0.076 Test Loss: 3.264 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7119865417480469
Epoch: 9, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.259 Vali Acc: 0.080 Test Loss: 3.259 Test Acc: 0.080
Validation loss decreased (-0.078791 --> -0.079967).  Saving model ...
Epoch: 10 cost time: 0.7535932064056396
Epoch: 10, Steps: 10 | Train Loss: 2.606 Vali Loss: 3.252 Vali Acc: 0.092 Test Loss: 3.252 Test Acc: 0.092
Validation loss decreased (-0.079967 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 0.7056593894958496
Epoch: 11, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.246 Vali Acc: 0.100 Test Loss: 3.246 Test Acc: 0.100
Validation loss decreased (-0.091732 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 0.5505044460296631
Epoch: 12, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.245 Vali Acc: 0.107 Test Loss: 3.245 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 0.7196133136749268
Epoch: 13, Steps: 10 | Train Loss: 2.334 Vali Loss: 3.242 Vali Acc: 0.108 Test Loss: 3.242 Test Acc: 0.108
Validation loss decreased (-0.107026 --> -0.108203).  Saving model ...
Epoch: 14 cost time: 0.7463204860687256
Epoch: 14, Steps: 10 | Train Loss: 2.188 Vali Loss: 3.241 Vali Acc: 0.116 Test Loss: 3.241 Test Acc: 0.116
Validation loss decreased (-0.108203 --> -0.116438).  Saving model ...
Epoch: 15 cost time: 0.6238601207733154
Epoch: 15, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.244 Vali Acc: 0.127 Test Loss: 3.244 Test Acc: 0.127
Validation loss decreased (-0.116438 --> -0.127026).  Saving model ...
Epoch: 16 cost time: 0.5428330898284912
Epoch: 16, Steps: 10 | Train Loss: 1.977 Vali Loss: 3.246 Vali Acc: 0.136 Test Loss: 3.246 Test Acc: 0.136
Validation loss decreased (-0.127026 --> -0.136438).  Saving model ...
Epoch: 17 cost time: 0.7050542831420898
Epoch: 17, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.254 Vali Acc: 0.146 Test Loss: 3.254 Test Acc: 0.146
Validation loss decreased (-0.136438 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.7186546325683594
Epoch: 18, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.262 Vali Acc: 0.153 Test Loss: 3.262 Test Acc: 0.153
Validation loss decreased (-0.145850 --> -0.152909).  Saving model ...
Epoch: 19 cost time: 0.7098896503448486
Epoch: 19, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.274 Vali Acc: 0.160 Test Loss: 3.274 Test Acc: 0.160
Validation loss decreased (-0.152909 --> -0.159967).  Saving model ...
Epoch: 20 cost time: 0.6434969902038574
Epoch: 20, Steps: 10 | Train Loss: 1.585 Vali Loss: 3.287 Vali Acc: 0.168 Test Loss: 3.287 Test Acc: 0.168
Validation loss decreased (-0.159967 --> -0.168202).  Saving model ...
Epoch: 21 cost time: 0.5922434329986572
Epoch: 21, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.300 Vali Acc: 0.174 Test Loss: 3.300 Test Acc: 0.174
Validation loss decreased (-0.168202 --> -0.174085).  Saving model ...
Epoch: 22 cost time: 0.6502268314361572
Epoch: 22, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.319 Vali Acc: 0.184 Test Loss: 3.319 Test Acc: 0.184
Validation loss decreased (-0.174085 --> -0.183496).  Saving model ...
Epoch: 23 cost time: 0.6105308532714844
Epoch: 23, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.344 Vali Acc: 0.186 Test Loss: 3.344 Test Acc: 0.186
Validation loss decreased (-0.183496 --> -0.185849).  Saving model ...
Epoch: 24 cost time: 0.637521505355835
Epoch: 24, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.365 Vali Acc: 0.191 Test Loss: 3.365 Test Acc: 0.191
Validation loss decreased (-0.185849 --> -0.190555).  Saving model ...
Epoch: 25 cost time: 0.5516414642333984
Epoch: 25, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.390 Vali Acc: 0.195 Test Loss: 3.390 Test Acc: 0.195
Validation loss decreased (-0.190555 --> -0.195260).  Saving model ...
Epoch: 26 cost time: 0.669762134552002
Epoch: 26, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.414 Vali Acc: 0.199 Test Loss: 3.414 Test Acc: 0.199
Validation loss decreased (-0.195260 --> -0.198789).  Saving model ...
Epoch: 27 cost time: 0.7078955173492432
Epoch: 27, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.444 Vali Acc: 0.201 Test Loss: 3.444 Test Acc: 0.201
Validation loss decreased (-0.198789 --> -0.201142).  Saving model ...
Epoch: 28 cost time: 0.6294088363647461
Epoch: 28, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.469 Vali Acc: 0.205 Test Loss: 3.469 Test Acc: 0.205
Validation loss decreased (-0.201142 --> -0.204671).  Saving model ...
Epoch: 29 cost time: 0.6221020221710205
Epoch: 29, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.508 Vali Acc: 0.205 Test Loss: 3.508 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5246620178222656
Epoch: 30, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.536 Vali Acc: 0.209 Test Loss: 3.536 Test Acc: 0.209
Validation loss decreased (-0.204671 --> -0.209376).  Saving model ...
Epoch: 31 cost time: 0.6409146785736084
Epoch: 31, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.575 Vali Acc: 0.213 Test Loss: 3.575 Test Acc: 0.213
Validation loss decreased (-0.209376 --> -0.212905).  Saving model ...
Epoch: 32 cost time: 0.6288175582885742
Epoch: 32, Steps: 10 | Train Loss: 0.683 Vali Loss: 3.613 Vali Acc: 0.212 Test Loss: 3.613 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6956198215484619
Epoch: 33, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.653 Vali Acc: 0.215 Test Loss: 3.653 Test Acc: 0.215
Validation loss decreased (-0.212905 --> -0.215258).  Saving model ...
Epoch: 34 cost time: 0.5865380764007568
Epoch: 34, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.687 Vali Acc: 0.214 Test Loss: 3.687 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6044943332672119
Epoch: 35, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.726 Vali Acc: 0.213 Test Loss: 3.726 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7213239669799805
Epoch: 36, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.767 Vali Acc: 0.209 Test Loss: 3.767 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7134332656860352
Epoch: 37, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.805 Vali Acc: 0.214 Test Loss: 3.805 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6785392761230469
Epoch: 38, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.859 Vali Acc: 0.212 Test Loss: 3.859 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5424308776855469
Epoch: 39, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.906 Vali Acc: 0.215 Test Loss: 3.906 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6479136943817139
Epoch: 40, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.966 Vali Acc: 0.213 Test Loss: 3.966 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7469596862792969
Epoch: 41, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.997 Vali Acc: 0.214 Test Loss: 3.997 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6633403301239014
Epoch: 42, Steps: 10 | Train Loss: 0.330 Vali Loss: 4.052 Vali Acc: 0.218 Test Loss: 4.052 Test Acc: 0.218
Validation loss decreased (-0.215258 --> -0.217607).  Saving model ...
Epoch: 43 cost time: 0.59610915184021
Epoch: 43, Steps: 10 | Train Loss: 0.289 Vali Loss: 4.093 Vali Acc: 0.214 Test Loss: 4.093 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5929856300354004
Epoch: 44, Steps: 10 | Train Loss: 0.269 Vali Loss: 4.140 Vali Acc: 0.214 Test Loss: 4.140 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7448055744171143
Epoch: 45, Steps: 10 | Train Loss: 0.254 Vali Loss: 4.191 Vali Acc: 0.209 Test Loss: 4.191 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6387882232666016
Epoch: 46, Steps: 10 | Train Loss: 0.239 Vali Loss: 4.240 Vali Acc: 0.214 Test Loss: 4.240 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6450650691986084
Epoch: 47, Steps: 10 | Train Loss: 0.222 Vali Loss: 4.296 Vali Acc: 0.214 Test Loss: 4.296 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7384390830993652
Epoch: 48, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.350 Vali Acc: 0.213 Test Loss: 4.350 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6646146774291992
Epoch: 49, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.396 Vali Acc: 0.211 Test Loss: 4.396 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6449151039123535
Epoch: 50, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.445 Vali Acc: 0.215 Test Loss: 4.445 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7302970886230469
Epoch: 51, Steps: 10 | Train Loss: 0.157 Vali Loss: 4.498 Vali Acc: 0.213 Test Loss: 4.498 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6604135036468506
Epoch: 52, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.551 Vali Acc: 0.220 Test Loss: 4.551 Test Acc: 0.220
Validation loss decreased (-0.217607 --> -0.219954).  Saving model ...
Epoch: 53 cost time: 0.5514800548553467
Epoch: 53, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.600 Vali Acc: 0.218 Test Loss: 4.600 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7207369804382324
Epoch: 54, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.659 Vali Acc: 0.216 Test Loss: 4.659 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6209554672241211
Epoch: 55, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.711 Vali Acc: 0.216 Test Loss: 4.711 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7030582427978516
Epoch: 56, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.756 Vali Acc: 0.216 Test Loss: 4.756 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5637319087982178
Epoch: 57, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.801 Vali Acc: 0.218 Test Loss: 4.801 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5885963439941406
Epoch: 58, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.843 Vali Acc: 0.219 Test Loss: 4.843 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6756932735443115
Epoch: 59, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.884 Vali Acc: 0.221 Test Loss: 4.884 Test Acc: 0.221
Validation loss decreased (-0.219954 --> -0.221128).  Saving model ...
Epoch: 60 cost time: 0.6913080215454102
Epoch: 60, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.935 Vali Acc: 0.222 Test Loss: 4.935 Test Acc: 0.222
Validation loss decreased (-0.221128 --> -0.222304).  Saving model ...
Epoch: 61 cost time: 0.8358230590820312
Epoch: 61, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.979 Vali Acc: 0.220 Test Loss: 4.979 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6061246395111084
Epoch: 62, Steps: 10 | Train Loss: 0.079 Vali Loss: 5.028 Vali Acc: 0.215 Test Loss: 5.028 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6978225708007812
Epoch: 63, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.091 Vali Acc: 0.216 Test Loss: 5.091 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8444950580596924
Epoch: 64, Steps: 10 | Train Loss: 0.066 Vali Loss: 5.127 Vali Acc: 0.214 Test Loss: 5.127 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.651198148727417
Epoch: 65, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.160 Vali Acc: 0.218 Test Loss: 5.160 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.6217243671417236
Epoch: 66, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.234 Vali Acc: 0.215 Test Loss: 5.234 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.5782196521759033
Epoch: 67, Steps: 10 | Train Loss: 0.055 Vali Loss: 5.261 Vali Acc: 0.218 Test Loss: 5.261 Test Acc: 0.218
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.8474466800689697
Epoch: 68, Steps: 10 | Train Loss: 0.053 Vali Loss: 5.276 Vali Acc: 0.219 Test Loss: 5.276 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.8073623180389404
Epoch: 69, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.299 Vali Acc: 0.218 Test Loss: 5.299 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.615168571472168
Epoch: 70, Steps: 10 | Train Loss: 0.047 Vali Loss: 5.361 Vali Acc: 0.218 Test Loss: 5.361 Test Acc: 0.218
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2223529411764706
model parameter : 37472
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.79038667678833
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.367 Vali Acc: 0.031 Test Loss: 3.367 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.597212553024292
Epoch: 2, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.353 Vali Acc: 0.035 Test Loss: 3.353 Test Acc: 0.035
Validation loss decreased (-0.030555 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.6074092388153076
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.334 Vali Acc: 0.034 Test Loss: 3.334 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4509296417236328
Epoch: 4, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.317 Vali Acc: 0.041 Test Loss: 3.317 Test Acc: 0.041
Validation loss decreased (-0.035261 --> -0.041143).  Saving model ...
Epoch: 5 cost time: 0.6244361400604248
Epoch: 5, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.300 Vali Acc: 0.045 Test Loss: 3.300 Test Acc: 0.045
Validation loss decreased (-0.041143 --> -0.044673).  Saving model ...
Epoch: 6 cost time: 0.5019478797912598
Epoch: 6, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.282 Vali Acc: 0.052 Test Loss: 3.282 Test Acc: 0.052
Validation loss decreased (-0.044673 --> -0.051732).  Saving model ...
Epoch: 7 cost time: 0.7939932346343994
Epoch: 7, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.267 Vali Acc: 0.067 Test Loss: 3.267 Test Acc: 0.067
Validation loss decreased (-0.051732 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 0.7730300426483154
Epoch: 8, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.254 Vali Acc: 0.076 Test Loss: 3.254 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 0.6945192813873291
Epoch: 9, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.244 Vali Acc: 0.085 Test Loss: 3.244 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 0.8578803539276123
Epoch: 10, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.235 Vali Acc: 0.096 Test Loss: 3.235 Test Acc: 0.096
Validation loss decreased (-0.084673 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.6932482719421387
Epoch: 11, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.229 Vali Acc: 0.111 Test Loss: 3.229 Test Acc: 0.111
Validation loss decreased (-0.096438 --> -0.110556).  Saving model ...
Epoch: 12 cost time: 0.7593700885772705
Epoch: 12, Steps: 10 | Train Loss: 2.403 Vali Loss: 3.227 Vali Acc: 0.120 Test Loss: 3.227 Test Acc: 0.120
Validation loss decreased (-0.110556 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 0.5950050354003906
Epoch: 13, Steps: 10 | Train Loss: 2.289 Vali Loss: 3.226 Vali Acc: 0.126 Test Loss: 3.226 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.6902871131896973
Epoch: 14, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.226 Vali Acc: 0.125 Test Loss: 3.226 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7241740226745605
Epoch: 15, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.231 Vali Acc: 0.126 Test Loss: 3.231 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.641150712966919
Epoch: 16, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.235 Vali Acc: 0.133 Test Loss: 3.235 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 17 cost time: 0.603264331817627
Epoch: 17, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.243 Vali Acc: 0.147 Test Loss: 3.243 Test Acc: 0.147
Validation loss decreased (-0.132909 --> -0.147026).  Saving model ...
Epoch: 18 cost time: 0.5496420860290527
Epoch: 18, Steps: 10 | Train Loss: 1.779 Vali Loss: 3.258 Vali Acc: 0.149 Test Loss: 3.258 Test Acc: 0.149
Validation loss decreased (-0.147026 --> -0.149379).  Saving model ...
Epoch: 19 cost time: 0.6453266143798828
Epoch: 19, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.272 Vali Acc: 0.159 Test Loss: 3.272 Test Acc: 0.159
Validation loss decreased (-0.149379 --> -0.158791).  Saving model ...
Epoch: 20 cost time: 0.6369836330413818
Epoch: 20, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.289 Vali Acc: 0.161 Test Loss: 3.289 Test Acc: 0.161
Validation loss decreased (-0.158791 --> -0.161144).  Saving model ...
Epoch: 21 cost time: 0.7132213115692139
Epoch: 21, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.311 Vali Acc: 0.164 Test Loss: 3.311 Test Acc: 0.164
Validation loss decreased (-0.161144 --> -0.163496).  Saving model ...
Epoch: 22 cost time: 0.5532760620117188
Epoch: 22, Steps: 10 | Train Loss: 1.387 Vali Loss: 3.328 Vali Acc: 0.169 Test Loss: 3.328 Test Acc: 0.169
Validation loss decreased (-0.163496 --> -0.169378).  Saving model ...
Epoch: 23 cost time: 0.6299550533294678
Epoch: 23, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.354 Vali Acc: 0.178 Test Loss: 3.354 Test Acc: 0.178
Validation loss decreased (-0.169378 --> -0.177614).  Saving model ...
Epoch: 24 cost time: 0.5290124416351318
Epoch: 24, Steps: 10 | Train Loss: 1.221 Vali Loss: 3.377 Vali Acc: 0.179 Test Loss: 3.377 Test Acc: 0.179
Validation loss decreased (-0.177614 --> -0.178790).  Saving model ...
Epoch: 25 cost time: 0.5764544010162354
Epoch: 25, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.401 Vali Acc: 0.186 Test Loss: 3.401 Test Acc: 0.186
Validation loss decreased (-0.178790 --> -0.185848).  Saving model ...
Epoch: 26 cost time: 0.621335506439209
Epoch: 26, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.428 Vali Acc: 0.193 Test Loss: 3.428 Test Acc: 0.193
Validation loss decreased (-0.185848 --> -0.192907).  Saving model ...
Epoch: 27 cost time: 0.6860992908477783
Epoch: 27, Steps: 10 | Train Loss: 0.984 Vali Loss: 3.457 Vali Acc: 0.196 Test Loss: 3.457 Test Acc: 0.196
Validation loss decreased (-0.192907 --> -0.196436).  Saving model ...
Epoch: 28 cost time: 0.5176076889038086
Epoch: 28, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.495 Vali Acc: 0.198 Test Loss: 3.495 Test Acc: 0.198
Validation loss decreased (-0.196436 --> -0.197612).  Saving model ...
Epoch: 29 cost time: 0.6084370613098145
Epoch: 29, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.530 Vali Acc: 0.196 Test Loss: 3.530 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7089200019836426
Epoch: 30, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.568 Vali Acc: 0.198 Test Loss: 3.568 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7036857604980469
Epoch: 31, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.599 Vali Acc: 0.200 Test Loss: 3.599 Test Acc: 0.200
Validation loss decreased (-0.197612 --> -0.199964).  Saving model ...
Epoch: 32 cost time: 0.6228771209716797
Epoch: 32, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.636 Vali Acc: 0.202 Test Loss: 3.636 Test Acc: 0.202
Validation loss decreased (-0.199964 --> -0.202317).  Saving model ...
Epoch: 33 cost time: 0.5370962619781494
Epoch: 33, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.674 Vali Acc: 0.207 Test Loss: 3.674 Test Acc: 0.207
Validation loss decreased (-0.202317 --> -0.207022).  Saving model ...
Epoch: 34 cost time: 0.7655541896820068
Epoch: 34, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.722 Vali Acc: 0.208 Test Loss: 3.722 Test Acc: 0.208
Validation loss decreased (-0.207022 --> -0.208198).  Saving model ...
Epoch: 35 cost time: 0.7621011734008789
Epoch: 35, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.761 Vali Acc: 0.212 Test Loss: 3.761 Test Acc: 0.212
Validation loss decreased (-0.208198 --> -0.211727).  Saving model ...
Epoch: 36 cost time: 0.6501405239105225
Epoch: 36, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.808 Vali Acc: 0.209 Test Loss: 3.808 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7086875438690186
Epoch: 37, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.862 Vali Acc: 0.209 Test Loss: 3.862 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9844334125518799
Epoch: 38, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.914 Vali Acc: 0.207 Test Loss: 3.914 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7769765853881836
Epoch: 39, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.952 Vali Acc: 0.213 Test Loss: 3.952 Test Acc: 0.213
Validation loss decreased (-0.211727 --> -0.212902).  Saving model ...
Epoch: 40 cost time: 0.8495612144470215
Epoch: 40, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.988 Vali Acc: 0.212 Test Loss: 3.988 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6771585941314697
Epoch: 41, Steps: 10 | Train Loss: 0.346 Vali Loss: 4.035 Vali Acc: 0.212 Test Loss: 4.035 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5681235790252686
Epoch: 42, Steps: 10 | Train Loss: 0.325 Vali Loss: 4.088 Vali Acc: 0.202 Test Loss: 4.088 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8632891178131104
Epoch: 43, Steps: 10 | Train Loss: 0.295 Vali Loss: 4.134 Vali Acc: 0.200 Test Loss: 4.134 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6004550457000732
Epoch: 44, Steps: 10 | Train Loss: 0.268 Vali Loss: 4.178 Vali Acc: 0.205 Test Loss: 4.178 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7223381996154785
Epoch: 45, Steps: 10 | Train Loss: 0.253 Vali Loss: 4.222 Vali Acc: 0.204 Test Loss: 4.222 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4862518310546875
Epoch: 46, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.273 Vali Acc: 0.206 Test Loss: 4.273 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.608095645904541
Epoch: 47, Steps: 10 | Train Loss: 0.212 Vali Loss: 4.337 Vali Acc: 0.202 Test Loss: 4.337 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.659498929977417
Epoch: 48, Steps: 10 | Train Loss: 0.202 Vali Loss: 4.378 Vali Acc: 0.205 Test Loss: 4.378 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8872735500335693
Epoch: 49, Steps: 10 | Train Loss: 0.183 Vali Loss: 4.432 Vali Acc: 0.200 Test Loss: 4.432 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21294117647058824
model parameter : 37134
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.93656325340271
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.305 Vali Acc: 0.054 Test Loss: 3.305 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.4387931823730469
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.293 Vali Acc: 0.052 Test Loss: 3.293 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5454988479614258
Epoch: 3, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.275 Vali Acc: 0.060 Test Loss: 3.275 Test Acc: 0.060
Validation loss decreased (-0.054085 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.6308720111846924
Epoch: 4, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.257 Vali Acc: 0.071 Test Loss: 3.257 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070556).  Saving model ...
Epoch: 5 cost time: 0.541001558303833
Epoch: 5, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.242 Vali Acc: 0.093 Test Loss: 3.242 Test Acc: 0.093
Validation loss decreased (-0.070556 --> -0.092909).  Saving model ...
Epoch: 6 cost time: 0.46571946144104004
Epoch: 6, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.227 Vali Acc: 0.098 Test Loss: 3.227 Test Acc: 0.098
Validation loss decreased (-0.092909 --> -0.097615).  Saving model ...
Epoch: 7 cost time: 0.5788397789001465
Epoch: 7, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.216 Vali Acc: 0.105 Test Loss: 3.216 Test Acc: 0.105
Validation loss decreased (-0.097615 --> -0.104674).  Saving model ...
Epoch: 8 cost time: 0.5490031242370605
Epoch: 8, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.205 Vali Acc: 0.118 Test Loss: 3.205 Test Acc: 0.118
Validation loss decreased (-0.104674 --> -0.117615).  Saving model ...
Epoch: 9 cost time: 0.5555300712585449
Epoch: 9, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.198 Vali Acc: 0.122 Test Loss: 3.198 Test Acc: 0.122
Validation loss decreased (-0.117615 --> -0.122321).  Saving model ...
Epoch: 10 cost time: 0.4160323143005371
Epoch: 10, Steps: 10 | Train Loss: 2.586 Vali Loss: 3.195 Vali Acc: 0.126 Test Loss: 3.195 Test Acc: 0.126
Validation loss decreased (-0.122321 --> -0.125850).  Saving model ...
Epoch: 11 cost time: 0.5158023834228516
Epoch: 11, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.192 Vali Acc: 0.132 Test Loss: 3.192 Test Acc: 0.132
Validation loss decreased (-0.125850 --> -0.131733).  Saving model ...
Epoch: 12 cost time: 0.5399937629699707
Epoch: 12, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.190 Vali Acc: 0.134 Test Loss: 3.190 Test Acc: 0.134
Validation loss decreased (-0.131733 --> -0.134086).  Saving model ...
Epoch: 13 cost time: 0.693244218826294
Epoch: 13, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.189 Vali Acc: 0.144 Test Loss: 3.189 Test Acc: 0.144
Validation loss decreased (-0.134086 --> -0.143498).  Saving model ...
Epoch: 14 cost time: 0.6013669967651367
Epoch: 14, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.192 Vali Acc: 0.151 Test Loss: 3.192 Test Acc: 0.151
Validation loss decreased (-0.143498 --> -0.150556).  Saving model ...
Epoch: 15 cost time: 0.5286462306976318
Epoch: 15, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.197 Vali Acc: 0.152 Test Loss: 3.197 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151733).  Saving model ...
Epoch: 16 cost time: 0.591742992401123
Epoch: 16, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.201 Vali Acc: 0.152 Test Loss: 3.201 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4979710578918457
Epoch: 17, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.210 Vali Acc: 0.149 Test Loss: 3.210 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6668357849121094
Epoch: 18, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.221 Vali Acc: 0.151 Test Loss: 3.221 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5843865871429443
Epoch: 19, Steps: 10 | Train Loss: 1.677 Vali Loss: 3.236 Vali Acc: 0.151 Test Loss: 3.236 Test Acc: 0.151
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5388405323028564
Epoch: 20, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.251 Vali Acc: 0.156 Test Loss: 3.251 Test Acc: 0.156
Validation loss decreased (-0.151733 --> -0.156438).  Saving model ...
Epoch: 21 cost time: 0.596930980682373
Epoch: 21, Steps: 10 | Train Loss: 1.510 Vali Loss: 3.267 Vali Acc: 0.167 Test Loss: 3.267 Test Acc: 0.167
Validation loss decreased (-0.156438 --> -0.167026).  Saving model ...
Epoch: 22 cost time: 0.6067070960998535
Epoch: 22, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.288 Vali Acc: 0.169 Test Loss: 3.288 Test Acc: 0.169
Validation loss decreased (-0.167026 --> -0.169379).  Saving model ...
Epoch: 23 cost time: 0.77730393409729
Epoch: 23, Steps: 10 | Train Loss: 1.314 Vali Loss: 3.311 Vali Acc: 0.173 Test Loss: 3.311 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 24 cost time: 0.5865700244903564
Epoch: 24, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.329 Vali Acc: 0.176 Test Loss: 3.329 Test Acc: 0.176
Validation loss decreased (-0.172908 --> -0.176437).  Saving model ...
Epoch: 25 cost time: 0.6880197525024414
Epoch: 25, Steps: 10 | Train Loss: 1.168 Vali Loss: 3.350 Vali Acc: 0.187 Test Loss: 3.350 Test Acc: 0.187
Validation loss decreased (-0.176437 --> -0.187025).  Saving model ...
Epoch: 26 cost time: 0.5095696449279785
Epoch: 26, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.376 Vali Acc: 0.191 Test Loss: 3.376 Test Acc: 0.191
Validation loss decreased (-0.187025 --> -0.190554).  Saving model ...
Epoch: 27 cost time: 0.575082540512085
Epoch: 27, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.405 Vali Acc: 0.191 Test Loss: 3.405 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5386130809783936
Epoch: 28, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.437 Vali Acc: 0.200 Test Loss: 3.437 Test Acc: 0.200
Validation loss decreased (-0.190554 --> -0.199966).  Saving model ...
Epoch: 29 cost time: 0.5548765659332275
Epoch: 29, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.472 Vali Acc: 0.202 Test Loss: 3.472 Test Acc: 0.202
Validation loss decreased (-0.199966 --> -0.202318).  Saving model ...
Epoch: 30 cost time: 0.6153452396392822
Epoch: 30, Steps: 10 | Train Loss: 0.830 Vali Loss: 3.505 Vali Acc: 0.201 Test Loss: 3.505 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5053286552429199
Epoch: 31, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.532 Vali Acc: 0.198 Test Loss: 3.532 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5003151893615723
Epoch: 32, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.563 Vali Acc: 0.202 Test Loss: 3.563 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4906611442565918
Epoch: 33, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.593 Vali Acc: 0.207 Test Loss: 3.593 Test Acc: 0.207
Validation loss decreased (-0.202318 --> -0.207023).  Saving model ...
Epoch: 34 cost time: 0.5106790065765381
Epoch: 34, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.624 Vali Acc: 0.209 Test Loss: 3.624 Test Acc: 0.209
Validation loss decreased (-0.207023 --> -0.209376).  Saving model ...
Epoch: 35 cost time: 0.4284400939941406
Epoch: 35, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.654 Vali Acc: 0.212 Test Loss: 3.654 Test Acc: 0.212
Validation loss decreased (-0.209376 --> -0.211728).  Saving model ...
Epoch: 36 cost time: 0.44638800621032715
Epoch: 36, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.695 Vali Acc: 0.213 Test Loss: 3.695 Test Acc: 0.213
Validation loss decreased (-0.211728 --> -0.212904).  Saving model ...
Epoch: 37 cost time: 0.41072654724121094
Epoch: 37, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.736 Vali Acc: 0.214 Test Loss: 3.736 Test Acc: 0.214
Validation loss decreased (-0.212904 --> -0.214080).  Saving model ...
Epoch: 38 cost time: 0.6351432800292969
Epoch: 38, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.775 Vali Acc: 0.218 Test Loss: 3.775 Test Acc: 0.218
Validation loss decreased (-0.214080 --> -0.217609).  Saving model ...
Epoch: 39 cost time: 0.5542335510253906
Epoch: 39, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.820 Vali Acc: 0.206 Test Loss: 3.820 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.526770830154419
Epoch: 40, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.859 Vali Acc: 0.209 Test Loss: 3.859 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.545581579208374
Epoch: 41, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.895 Vali Acc: 0.212 Test Loss: 3.895 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7141234874725342
Epoch: 42, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.933 Vali Acc: 0.211 Test Loss: 3.933 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6493911743164062
Epoch: 43, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.972 Vali Acc: 0.212 Test Loss: 3.972 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6137290000915527
Epoch: 44, Steps: 10 | Train Loss: 0.268 Vali Loss: 4.023 Vali Acc: 0.209 Test Loss: 4.023 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5262830257415771
Epoch: 45, Steps: 10 | Train Loss: 0.246 Vali Loss: 4.061 Vali Acc: 0.213 Test Loss: 4.061 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5655295848846436
Epoch: 46, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.093 Vali Acc: 0.215 Test Loss: 4.093 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5222470760345459
Epoch: 47, Steps: 10 | Train Loss: 0.220 Vali Loss: 4.136 Vali Acc: 0.218 Test Loss: 4.136 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7080011367797852
Epoch: 48, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.178 Vali Acc: 0.209 Test Loss: 4.178 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21764705882352942
model parameter : 36816
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9028348922729492
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.358 Vali Acc: 0.033 Test Loss: 3.358 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.6359508037567139
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.347 Vali Acc: 0.035 Test Loss: 3.347 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.5653543472290039
Epoch: 3, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.334 Vali Acc: 0.041 Test Loss: 3.334 Test Acc: 0.041
Validation loss decreased (-0.035261 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 0.5512721538543701
Epoch: 4, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.320 Vali Acc: 0.047 Test Loss: 3.320 Test Acc: 0.047
Validation loss decreased (-0.041143 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.5074951648712158
Epoch: 5, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.306 Vali Acc: 0.049 Test Loss: 3.306 Test Acc: 0.049
Validation loss decreased (-0.047026 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 0.5822944641113281
Epoch: 6, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.294 Vali Acc: 0.056 Test Loss: 3.294 Test Acc: 0.056
Validation loss decreased (-0.049379 --> -0.056438).  Saving model ...
Epoch: 7 cost time: 0.5378773212432861
Epoch: 7, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.281 Vali Acc: 0.068 Test Loss: 3.281 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068202).  Saving model ...
Epoch: 8 cost time: 0.5762295722961426
Epoch: 8, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.269 Vali Acc: 0.089 Test Loss: 3.269 Test Acc: 0.089
Validation loss decreased (-0.068202 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 0.6283359527587891
Epoch: 9, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.261 Vali Acc: 0.094 Test Loss: 3.261 Test Acc: 0.094
Validation loss decreased (-0.089379 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 0.5834271907806396
Epoch: 10, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.254 Vali Acc: 0.099 Test Loss: 3.254 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 11 cost time: 0.5098788738250732
Epoch: 11, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.248 Vali Acc: 0.101 Test Loss: 3.248 Test Acc: 0.101
Validation loss decreased (-0.098791 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 0.570173978805542
Epoch: 12, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.243 Vali Acc: 0.105 Test Loss: 3.243 Test Acc: 0.105
Validation loss decreased (-0.101144 --> -0.104673).  Saving model ...
Epoch: 13 cost time: 0.6118018627166748
Epoch: 13, Steps: 10 | Train Loss: 2.285 Vali Loss: 3.242 Vali Acc: 0.116 Test Loss: 3.242 Test Acc: 0.116
Validation loss decreased (-0.104673 --> -0.116438).  Saving model ...
Epoch: 14 cost time: 0.7444322109222412
Epoch: 14, Steps: 10 | Train Loss: 2.198 Vali Loss: 3.242 Vali Acc: 0.124 Test Loss: 3.242 Test Acc: 0.124
Validation loss decreased (-0.116438 --> -0.123497).  Saving model ...
Epoch: 15 cost time: 0.5918803215026855
Epoch: 15, Steps: 10 | Train Loss: 2.094 Vali Loss: 3.244 Vali Acc: 0.126 Test Loss: 3.244 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 16 cost time: 0.6747312545776367
Epoch: 16, Steps: 10 | Train Loss: 2.013 Vali Loss: 3.247 Vali Acc: 0.129 Test Loss: 3.247 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129379).  Saving model ...
Epoch: 17 cost time: 0.5286505222320557
Epoch: 17, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.251 Vali Acc: 0.133 Test Loss: 3.251 Test Acc: 0.133
Validation loss decreased (-0.129379 --> -0.132909).  Saving model ...
Epoch: 18 cost time: 0.6423232555389404
Epoch: 18, Steps: 10 | Train Loss: 1.771 Vali Loss: 3.255 Vali Acc: 0.138 Test Loss: 3.255 Test Acc: 0.138
Validation loss decreased (-0.132909 --> -0.137615).  Saving model ...
Epoch: 19 cost time: 0.5533251762390137
Epoch: 19, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.268 Vali Acc: 0.144 Test Loss: 3.268 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 20 cost time: 0.6454908847808838
Epoch: 20, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.279 Vali Acc: 0.153 Test Loss: 3.279 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152908).  Saving model ...
Epoch: 21 cost time: 0.6010501384735107
Epoch: 21, Steps: 10 | Train Loss: 1.511 Vali Loss: 3.294 Vali Acc: 0.164 Test Loss: 3.294 Test Acc: 0.164
Validation loss decreased (-0.152908 --> -0.163496).  Saving model ...
Epoch: 22 cost time: 0.6104245185852051
Epoch: 22, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.308 Vali Acc: 0.174 Test Loss: 3.308 Test Acc: 0.174
Validation loss decreased (-0.163496 --> -0.174085).  Saving model ...
Epoch: 23 cost time: 0.6786162853240967
Epoch: 23, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.324 Vali Acc: 0.178 Test Loss: 3.324 Test Acc: 0.178
Validation loss decreased (-0.174085 --> -0.177614).  Saving model ...
Epoch: 24 cost time: 0.5975914001464844
Epoch: 24, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.342 Vali Acc: 0.185 Test Loss: 3.342 Test Acc: 0.185
Validation loss decreased (-0.177614 --> -0.184672).  Saving model ...
Epoch: 25 cost time: 0.606205940246582
Epoch: 25, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.360 Vali Acc: 0.192 Test Loss: 3.360 Test Acc: 0.192
Validation loss decreased (-0.184672 --> -0.191731).  Saving model ...
Epoch: 26 cost time: 0.4827091693878174
Epoch: 26, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.381 Vali Acc: 0.200 Test Loss: 3.381 Test Acc: 0.200
Validation loss decreased (-0.191731 --> -0.199966).  Saving model ...
Epoch: 27 cost time: 0.60451340675354
Epoch: 27, Steps: 10 | Train Loss: 1.034 Vali Loss: 3.406 Vali Acc: 0.201 Test Loss: 3.406 Test Acc: 0.201
Validation loss decreased (-0.199966 --> -0.201142).  Saving model ...
Epoch: 28 cost time: 0.6289441585540771
Epoch: 28, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.433 Vali Acc: 0.198 Test Loss: 3.433 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6640732288360596
Epoch: 29, Steps: 10 | Train Loss: 0.878 Vali Loss: 3.463 Vali Acc: 0.196 Test Loss: 3.463 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.45339345932006836
Epoch: 30, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.493 Vali Acc: 0.201 Test Loss: 3.493 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5640401840209961
Epoch: 31, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.524 Vali Acc: 0.205 Test Loss: 3.524 Test Acc: 0.205
Validation loss decreased (-0.201142 --> -0.204671).  Saving model ...
Epoch: 32 cost time: 0.6698312759399414
Epoch: 32, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.550 Vali Acc: 0.208 Test Loss: 3.550 Test Acc: 0.208
Validation loss decreased (-0.204671 --> -0.208200).  Saving model ...
Epoch: 33 cost time: 0.7145345211029053
Epoch: 33, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.584 Vali Acc: 0.208 Test Loss: 3.584 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7178311347961426
Epoch: 34, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.613 Vali Acc: 0.211 Test Loss: 3.613 Test Acc: 0.211
Validation loss decreased (-0.208200 --> -0.210552).  Saving model ...
Epoch: 35 cost time: 0.7295503616333008
Epoch: 35, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.648 Vali Acc: 0.213 Test Loss: 3.648 Test Acc: 0.213
Validation loss decreased (-0.210552 --> -0.212905).  Saving model ...
Epoch: 36 cost time: 0.6747839450836182
Epoch: 36, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.679 Vali Acc: 0.211 Test Loss: 3.679 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8914906978607178
Epoch: 37, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.714 Vali Acc: 0.215 Test Loss: 3.714 Test Acc: 0.215
Validation loss decreased (-0.212905 --> -0.215257).  Saving model ...
Epoch: 38 cost time: 0.7258412837982178
Epoch: 38, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.755 Vali Acc: 0.208 Test Loss: 3.755 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7159900665283203
Epoch: 39, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.788 Vali Acc: 0.209 Test Loss: 3.788 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7572741508483887
Epoch: 40, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.819 Vali Acc: 0.212 Test Loss: 3.819 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.736689567565918
Epoch: 41, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.856 Vali Acc: 0.214 Test Loss: 3.856 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7194979190826416
Epoch: 42, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.890 Vali Acc: 0.211 Test Loss: 3.890 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8115358352661133
Epoch: 43, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.928 Vali Acc: 0.216 Test Loss: 3.928 Test Acc: 0.216
Validation loss decreased (-0.215257 --> -0.216431).  Saving model ...
Epoch: 44 cost time: 0.6473517417907715
Epoch: 44, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.968 Vali Acc: 0.220 Test Loss: 3.968 Test Acc: 0.220
Validation loss decreased (-0.216431 --> -0.219960).  Saving model ...
Epoch: 45 cost time: 0.7439100742340088
Epoch: 45, Steps: 10 | Train Loss: 0.275 Vali Loss: 4.004 Vali Acc: 0.222 Test Loss: 4.004 Test Acc: 0.222
Validation loss decreased (-0.219960 --> -0.222313).  Saving model ...
Epoch: 46 cost time: 0.752608060836792
Epoch: 46, Steps: 10 | Train Loss: 0.249 Vali Loss: 4.042 Vali Acc: 0.218 Test Loss: 4.042 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7247235774993896
Epoch: 47, Steps: 10 | Train Loss: 0.229 Vali Loss: 4.081 Vali Acc: 0.220 Test Loss: 4.081 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6266074180603027
Epoch: 48, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.121 Vali Acc: 0.219 Test Loss: 4.121 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.555361270904541
Epoch: 49, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.163 Vali Acc: 0.219 Test Loss: 4.163 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6377944946289062
Epoch: 50, Steps: 10 | Train Loss: 0.220 Vali Loss: 4.200 Vali Acc: 0.216 Test Loss: 4.200 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6826820373535156
Epoch: 51, Steps: 10 | Train Loss: 0.177 Vali Loss: 4.230 Vali Acc: 0.215 Test Loss: 4.230 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.614386796951294
Epoch: 52, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.267 Vali Acc: 0.214 Test Loss: 4.267 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.7241990566253662
Epoch: 53, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.310 Vali Acc: 0.214 Test Loss: 4.310 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6430935859680176
Epoch: 54, Steps: 10 | Train Loss: 0.136 Vali Loss: 4.355 Vali Acc: 0.215 Test Loss: 4.355 Test Acc: 0.215
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.7632341384887695
Epoch: 55, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.398 Vali Acc: 0.216 Test Loss: 4.398 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2223529411764706
model parameter : 36974
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0470998287200928
Epoch: 1, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.320 Vali Acc: 0.041 Test Loss: 3.320 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.6534557342529297
Epoch: 2, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.308 Vali Acc: 0.049 Test Loss: 3.308 Test Acc: 0.049
Validation loss decreased (-0.041143 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.5293185710906982
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.294 Vali Acc: 0.055 Test Loss: 3.294 Test Acc: 0.055
Validation loss decreased (-0.049379 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.5251584053039551
Epoch: 4, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.280 Vali Acc: 0.059 Test Loss: 3.280 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 0.6374077796936035
Epoch: 5, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.265 Vali Acc: 0.069 Test Loss: 3.265 Test Acc: 0.069
Validation loss decreased (-0.058791 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.8051066398620605
Epoch: 6, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.253 Vali Acc: 0.079 Test Loss: 3.253 Test Acc: 0.079
Validation loss decreased (-0.069379 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.5749354362487793
Epoch: 7, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.242 Vali Acc: 0.086 Test Loss: 3.242 Test Acc: 0.086
Validation loss decreased (-0.078791 --> -0.085850).  Saving model ...
Epoch: 8 cost time: 0.5175895690917969
Epoch: 8, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.234 Vali Acc: 0.095 Test Loss: 3.234 Test Acc: 0.095
Validation loss decreased (-0.085850 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 0.640862226486206
Epoch: 9, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.226 Vali Acc: 0.101 Test Loss: 3.226 Test Acc: 0.101
Validation loss decreased (-0.095262 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.6870625019073486
Epoch: 10, Steps: 10 | Train Loss: 2.566 Vali Loss: 3.223 Vali Acc: 0.104 Test Loss: 3.223 Test Acc: 0.104
Validation loss decreased (-0.101144 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 0.6128740310668945
Epoch: 11, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.220 Vali Acc: 0.108 Test Loss: 3.220 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 0.5929431915283203
Epoch: 12, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.220 Vali Acc: 0.116 Test Loss: 3.220 Test Acc: 0.116
Validation loss decreased (-0.108203 --> -0.116438).  Saving model ...
Epoch: 13 cost time: 0.5840275287628174
Epoch: 13, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.219 Vali Acc: 0.122 Test Loss: 3.219 Test Acc: 0.122
Validation loss decreased (-0.116438 --> -0.122321).  Saving model ...
Epoch: 14 cost time: 0.5715577602386475
Epoch: 14, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.222 Vali Acc: 0.125 Test Loss: 3.222 Test Acc: 0.125
Validation loss decreased (-0.122321 --> -0.124674).  Saving model ...
Epoch: 15 cost time: 0.6490762233734131
Epoch: 15, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.222 Vali Acc: 0.127 Test Loss: 3.222 Test Acc: 0.127
Validation loss decreased (-0.124674 --> -0.127027).  Saving model ...
Epoch: 16 cost time: 0.6696090698242188
Epoch: 16, Steps: 10 | Train Loss: 1.941 Vali Loss: 3.229 Vali Acc: 0.133 Test Loss: 3.229 Test Acc: 0.133
Validation loss decreased (-0.127027 --> -0.132909).  Saving model ...
Epoch: 17 cost time: 0.5420694351196289
Epoch: 17, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.236 Vali Acc: 0.142 Test Loss: 3.236 Test Acc: 0.142
Validation loss decreased (-0.132909 --> -0.142321).  Saving model ...
Epoch: 18 cost time: 0.5548512935638428
Epoch: 18, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.243 Vali Acc: 0.153 Test Loss: 3.243 Test Acc: 0.153
Validation loss decreased (-0.142321 --> -0.152909).  Saving model ...
Epoch: 19 cost time: 0.5176985263824463
Epoch: 19, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.254 Vali Acc: 0.162 Test Loss: 3.254 Test Acc: 0.162
Validation loss decreased (-0.152909 --> -0.162320).  Saving model ...
Epoch: 20 cost time: 0.7884602546691895
Epoch: 20, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.267 Vali Acc: 0.168 Test Loss: 3.267 Test Acc: 0.168
Validation loss decreased (-0.162320 --> -0.168203).  Saving model ...
Epoch: 21 cost time: 0.691739559173584
Epoch: 21, Steps: 10 | Train Loss: 1.494 Vali Loss: 3.280 Vali Acc: 0.173 Test Loss: 3.280 Test Acc: 0.173
Validation loss decreased (-0.168203 --> -0.172908).  Saving model ...
Epoch: 22 cost time: 0.6100127696990967
Epoch: 22, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.297 Vali Acc: 0.178 Test Loss: 3.297 Test Acc: 0.178
Validation loss decreased (-0.172908 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 0.6492407321929932
Epoch: 23, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.317 Vali Acc: 0.179 Test Loss: 3.317 Test Acc: 0.179
Validation loss decreased (-0.177614 --> -0.178790).  Saving model ...
Epoch: 24 cost time: 0.6024837493896484
Epoch: 24, Steps: 10 | Train Loss: 1.241 Vali Loss: 3.337 Vali Acc: 0.178 Test Loss: 3.337 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.597233772277832
Epoch: 25, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.361 Vali Acc: 0.185 Test Loss: 3.361 Test Acc: 0.185
Validation loss decreased (-0.178790 --> -0.184672).  Saving model ...
Epoch: 26 cost time: 0.6786658763885498
Epoch: 26, Steps: 10 | Train Loss: 1.054 Vali Loss: 3.385 Vali Acc: 0.186 Test Loss: 3.385 Test Acc: 0.186
Validation loss decreased (-0.184672 --> -0.185849).  Saving model ...
Epoch: 27 cost time: 0.5810291767120361
Epoch: 27, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.409 Vali Acc: 0.188 Test Loss: 3.409 Test Acc: 0.188
Validation loss decreased (-0.185849 --> -0.188201).  Saving model ...
Epoch: 28 cost time: 0.5022792816162109
Epoch: 28, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.436 Vali Acc: 0.192 Test Loss: 3.436 Test Acc: 0.192
Validation loss decreased (-0.188201 --> -0.191730).  Saving model ...
Epoch: 29 cost time: 0.5354490280151367
Epoch: 29, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.465 Vali Acc: 0.192 Test Loss: 3.465 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5683789253234863
Epoch: 30, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.501 Vali Acc: 0.191 Test Loss: 3.501 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7338323593139648
Epoch: 31, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.527 Vali Acc: 0.186 Test Loss: 3.527 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5983960628509521
Epoch: 32, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.558 Vali Acc: 0.191 Test Loss: 3.558 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6939146518707275
Epoch: 33, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.604 Vali Acc: 0.194 Test Loss: 3.604 Test Acc: 0.194
Validation loss decreased (-0.191730 --> -0.194082).  Saving model ...
Epoch: 34 cost time: 0.5339603424072266
Epoch: 34, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.639 Vali Acc: 0.199 Test Loss: 3.639 Test Acc: 0.199
Validation loss decreased (-0.194082 --> -0.198787).  Saving model ...
Epoch: 35 cost time: 0.5937192440032959
Epoch: 35, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.672 Vali Acc: 0.201 Test Loss: 3.672 Test Acc: 0.201
Validation loss decreased (-0.198787 --> -0.201140).  Saving model ...
Epoch: 36 cost time: 0.5588192939758301
Epoch: 36, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.708 Vali Acc: 0.194 Test Loss: 3.708 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5658469200134277
Epoch: 37, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.744 Vali Acc: 0.195 Test Loss: 3.744 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6027846336364746
Epoch: 38, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.782 Vali Acc: 0.195 Test Loss: 3.782 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5331130027770996
Epoch: 39, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.823 Vali Acc: 0.198 Test Loss: 3.823 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5221130847930908
Epoch: 40, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.865 Vali Acc: 0.196 Test Loss: 3.865 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6088554859161377
Epoch: 41, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.911 Vali Acc: 0.200 Test Loss: 3.911 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6153931617736816
Epoch: 42, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.970 Vali Acc: 0.198 Test Loss: 3.970 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5697402954101562
Epoch: 43, Steps: 10 | Train Loss: 0.299 Vali Loss: 4.026 Vali Acc: 0.199 Test Loss: 4.026 Test Acc: 0.199
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5246903896331787
Epoch: 44, Steps: 10 | Train Loss: 0.276 Vali Loss: 4.084 Vali Acc: 0.199 Test Loss: 4.084 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6741626262664795
Epoch: 45, Steps: 10 | Train Loss: 0.252 Vali Loss: 4.118 Vali Acc: 0.200 Test Loss: 4.118 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2011764705882353
model parameter : 38064
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.742114543914795
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.311 Vali Acc: 0.038 Test Loss: 3.311 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.5601356029510498
Epoch: 2, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.299 Vali Acc: 0.042 Test Loss: 3.299 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.547297477722168
Epoch: 3, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.284 Vali Acc: 0.060 Test Loss: 3.284 Test Acc: 0.060
Validation loss decreased (-0.042320 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.5762956142425537
Epoch: 4, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.268 Vali Acc: 0.065 Test Loss: 3.268 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.6439573764801025
Epoch: 5, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.253 Vali Acc: 0.075 Test Loss: 3.253 Test Acc: 0.075
Validation loss decreased (-0.064673 --> -0.075262).  Saving model ...
Epoch: 6 cost time: 0.5379366874694824
Epoch: 6, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.240 Vali Acc: 0.082 Test Loss: 3.240 Test Acc: 0.082
Validation loss decreased (-0.075262 --> -0.082321).  Saving model ...
Epoch: 7 cost time: 0.5890369415283203
Epoch: 7, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.229 Vali Acc: 0.084 Test Loss: 3.229 Test Acc: 0.084
Validation loss decreased (-0.082321 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.5315530300140381
Epoch: 8, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.220 Vali Acc: 0.086 Test Loss: 3.220 Test Acc: 0.086
Validation loss decreased (-0.083497 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 0.5594487190246582
Epoch: 9, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.214 Vali Acc: 0.094 Test Loss: 3.214 Test Acc: 0.094
Validation loss decreased (-0.085850 --> -0.094086).  Saving model ...
Epoch: 10 cost time: 0.5901603698730469
Epoch: 10, Steps: 10 | Train Loss: 2.586 Vali Loss: 3.208 Vali Acc: 0.109 Test Loss: 3.208 Test Acc: 0.109
Validation loss decreased (-0.094086 --> -0.109380).  Saving model ...
Epoch: 11 cost time: 0.5521383285522461
Epoch: 11, Steps: 10 | Train Loss: 2.486 Vali Loss: 3.205 Vali Acc: 0.115 Test Loss: 3.205 Test Acc: 0.115
Validation loss decreased (-0.109380 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.5411572456359863
Epoch: 12, Steps: 10 | Train Loss: 2.392 Vali Loss: 3.200 Vali Acc: 0.126 Test Loss: 3.200 Test Acc: 0.126
Validation loss decreased (-0.115262 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.463364839553833
Epoch: 13, Steps: 10 | Train Loss: 2.289 Vali Loss: 3.199 Vali Acc: 0.138 Test Loss: 3.199 Test Acc: 0.138
Validation loss decreased (-0.125850 --> -0.137615).  Saving model ...
Epoch: 14 cost time: 0.5304727554321289
Epoch: 14, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.202 Vali Acc: 0.144 Test Loss: 3.202 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 15 cost time: 0.6471867561340332
Epoch: 15, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.203 Vali Acc: 0.151 Test Loss: 3.203 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 0.5715441703796387
Epoch: 16, Steps: 10 | Train Loss: 1.945 Vali Loss: 3.209 Vali Acc: 0.152 Test Loss: 3.209 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151733).  Saving model ...
Epoch: 17 cost time: 0.6256124973297119
Epoch: 17, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.218 Vali Acc: 0.160 Test Loss: 3.218 Test Acc: 0.160
Validation loss decreased (-0.151733 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 0.6247859001159668
Epoch: 18, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.225 Vali Acc: 0.165 Test Loss: 3.225 Test Acc: 0.165
Validation loss decreased (-0.159968 --> -0.164674).  Saving model ...
Epoch: 19 cost time: 0.5517380237579346
Epoch: 19, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.238 Vali Acc: 0.171 Test Loss: 3.238 Test Acc: 0.171
Validation loss decreased (-0.164674 --> -0.170556).  Saving model ...
Epoch: 20 cost time: 0.5362482070922852
Epoch: 20, Steps: 10 | Train Loss: 1.566 Vali Loss: 3.250 Vali Acc: 0.178 Test Loss: 3.250 Test Acc: 0.178
Validation loss decreased (-0.170556 --> -0.177615).  Saving model ...
Epoch: 21 cost time: 0.5872578620910645
Epoch: 21, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.265 Vali Acc: 0.180 Test Loss: 3.265 Test Acc: 0.180
Validation loss decreased (-0.177615 --> -0.179967).  Saving model ...
Epoch: 22 cost time: 0.715947151184082
Epoch: 22, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.284 Vali Acc: 0.184 Test Loss: 3.284 Test Acc: 0.184
Validation loss decreased (-0.179967 --> -0.183497).  Saving model ...
Epoch: 23 cost time: 0.5899310111999512
Epoch: 23, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.301 Vali Acc: 0.189 Test Loss: 3.301 Test Acc: 0.189
Validation loss decreased (-0.183497 --> -0.189379).  Saving model ...
Epoch: 24 cost time: 0.5180871486663818
Epoch: 24, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.326 Vali Acc: 0.194 Test Loss: 3.326 Test Acc: 0.194
Validation loss decreased (-0.189379 --> -0.194084).  Saving model ...
Epoch: 25 cost time: 0.4912230968475342
Epoch: 25, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.350 Vali Acc: 0.195 Test Loss: 3.350 Test Acc: 0.195
Validation loss decreased (-0.194084 --> -0.195261).  Saving model ...
Epoch: 26 cost time: 0.6163699626922607
Epoch: 26, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.376 Vali Acc: 0.204 Test Loss: 3.376 Test Acc: 0.204
Validation loss decreased (-0.195261 --> -0.203496).  Saving model ...
Epoch: 27 cost time: 0.5224936008453369
Epoch: 27, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.397 Vali Acc: 0.208 Test Loss: 3.397 Test Acc: 0.208
Validation loss decreased (-0.203496 --> -0.208201).  Saving model ...
Epoch: 28 cost time: 0.5621271133422852
Epoch: 28, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.424 Vali Acc: 0.212 Test Loss: 3.424 Test Acc: 0.212
Validation loss decreased (-0.208201 --> -0.211730).  Saving model ...
Epoch: 29 cost time: 0.47928762435913086
Epoch: 29, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.446 Vali Acc: 0.214 Test Loss: 3.446 Test Acc: 0.214
Validation loss decreased (-0.211730 --> -0.214083).  Saving model ...
Epoch: 30 cost time: 0.5660345554351807
Epoch: 30, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.479 Vali Acc: 0.215 Test Loss: 3.479 Test Acc: 0.215
Validation loss decreased (-0.214083 --> -0.215259).  Saving model ...
Epoch: 31 cost time: 0.6877319812774658
Epoch: 31, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.506 Vali Acc: 0.219 Test Loss: 3.506 Test Acc: 0.219
Validation loss decreased (-0.215259 --> -0.218788).  Saving model ...
Epoch: 32 cost time: 0.5622084140777588
Epoch: 32, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.537 Vali Acc: 0.221 Test Loss: 3.537 Test Acc: 0.221
Validation loss decreased (-0.218788 --> -0.221141).  Saving model ...
Epoch: 33 cost time: 0.5751700401306152
Epoch: 33, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.576 Vali Acc: 0.212 Test Loss: 3.576 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6341409683227539
Epoch: 34, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.611 Vali Acc: 0.213 Test Loss: 3.611 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5385496616363525
Epoch: 35, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.637 Vali Acc: 0.215 Test Loss: 3.637 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5391168594360352
Epoch: 36, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.666 Vali Acc: 0.218 Test Loss: 3.666 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.582953691482544
Epoch: 37, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.700 Vali Acc: 0.221 Test Loss: 3.700 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5878360271453857
Epoch: 38, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.742 Vali Acc: 0.221 Test Loss: 3.742 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6074151992797852
Epoch: 39, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.772 Vali Acc: 0.224 Test Loss: 3.772 Test Acc: 0.224
Validation loss decreased (-0.221141 --> -0.223492).  Saving model ...
Epoch: 40 cost time: 0.5805480480194092
Epoch: 40, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.810 Vali Acc: 0.219 Test Loss: 3.810 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5305123329162598
Epoch: 41, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.842 Vali Acc: 0.226 Test Loss: 3.842 Test Acc: 0.226
Validation loss decreased (-0.223492 --> -0.225844).  Saving model ...
Epoch: 42 cost time: 0.6586647033691406
Epoch: 42, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.880 Vali Acc: 0.226 Test Loss: 3.880 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5959937572479248
Epoch: 43, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.928 Vali Acc: 0.225 Test Loss: 3.928 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6806812286376953
Epoch: 44, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.961 Vali Acc: 0.228 Test Loss: 3.961 Test Acc: 0.228
Validation loss decreased (-0.225844 --> -0.228196).  Saving model ...
Epoch: 45 cost time: 0.6077766418457031
Epoch: 45, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.995 Vali Acc: 0.228 Test Loss: 3.995 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5900352001190186
Epoch: 46, Steps: 10 | Train Loss: 0.228 Vali Loss: 4.021 Vali Acc: 0.224 Test Loss: 4.021 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6134026050567627
Epoch: 47, Steps: 10 | Train Loss: 0.205 Vali Loss: 4.064 Vali Acc: 0.227 Test Loss: 4.064 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6050348281860352
Epoch: 48, Steps: 10 | Train Loss: 0.198 Vali Loss: 4.107 Vali Acc: 0.227 Test Loss: 4.107 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6290216445922852
Epoch: 49, Steps: 10 | Train Loss: 0.180 Vali Loss: 4.141 Vali Acc: 0.228 Test Loss: 4.141 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5588765144348145
Epoch: 50, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.181 Vali Acc: 0.229 Test Loss: 4.181 Test Acc: 0.229
Validation loss decreased (-0.228196 --> -0.229370).  Saving model ...
Epoch: 51 cost time: 0.5618071556091309
Epoch: 51, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.223 Vali Acc: 0.232 Test Loss: 4.223 Test Acc: 0.232
Validation loss decreased (-0.229370 --> -0.231722).  Saving model ...
Epoch: 52 cost time: 0.6278059482574463
Epoch: 52, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.247 Vali Acc: 0.234 Test Loss: 4.247 Test Acc: 0.234
Validation loss decreased (-0.231722 --> -0.234075).  Saving model ...
Epoch: 53 cost time: 0.6598422527313232
Epoch: 53, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.282 Vali Acc: 0.238 Test Loss: 4.282 Test Acc: 0.238
Validation loss decreased (-0.234075 --> -0.237604).  Saving model ...
Epoch: 54 cost time: 0.6383852958679199
Epoch: 54, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.325 Vali Acc: 0.240 Test Loss: 4.325 Test Acc: 0.240
Validation loss decreased (-0.237604 --> -0.239957).  Saving model ...
Epoch: 55 cost time: 0.6042895317077637
Epoch: 55, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.371 Vali Acc: 0.235 Test Loss: 4.371 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.61618971824646
Epoch: 56, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.382 Vali Acc: 0.239 Test Loss: 4.382 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5909717082977295
Epoch: 57, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.438 Vali Acc: 0.240 Test Loss: 4.438 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6116633415222168
Epoch: 58, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.466 Vali Acc: 0.245 Test Loss: 4.466 Test Acc: 0.245
Validation loss decreased (-0.239957 --> -0.244661).  Saving model ...
Epoch: 59 cost time: 0.6425256729125977
Epoch: 59, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.497 Vali Acc: 0.244 Test Loss: 4.497 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5155518054962158
Epoch: 60, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.532 Vali Acc: 0.247 Test Loss: 4.532 Test Acc: 0.247
Validation loss decreased (-0.244661 --> -0.247014).  Saving model ...
Epoch: 61 cost time: 0.5658605098724365
Epoch: 61, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.552 Vali Acc: 0.251 Test Loss: 4.552 Test Acc: 0.251
Validation loss decreased (-0.247014 --> -0.250543).  Saving model ...
Epoch: 62 cost time: 0.5535156726837158
Epoch: 62, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.587 Vali Acc: 0.245 Test Loss: 4.587 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6079263687133789
Epoch: 63, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.629 Vali Acc: 0.247 Test Loss: 4.629 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6937706470489502
Epoch: 64, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.654 Vali Acc: 0.241 Test Loss: 4.654 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.586320161819458
Epoch: 65, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.687 Vali Acc: 0.240 Test Loss: 4.687 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6026215553283691
Epoch: 66, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.714 Vali Acc: 0.245 Test Loss: 4.714 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.6401102542877197
Epoch: 67, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.738 Vali Acc: 0.244 Test Loss: 4.738 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.6492149829864502
Epoch: 68, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.773 Vali Acc: 0.236 Test Loss: 4.773 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.510725736618042
Epoch: 69, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.806 Vali Acc: 0.244 Test Loss: 4.806 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.6767122745513916
Epoch: 70, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.842 Vali Acc: 0.246 Test Loss: 4.842 Test Acc: 0.246
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.5814595222473145
Epoch: 71, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.871 Vali Acc: 0.246 Test Loss: 4.871 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 37166
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.860274314880371
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.326 Vali Acc: 0.024 Test Loss: 3.326 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 0.5293006896972656
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.315 Vali Acc: 0.032 Test Loss: 3.315 Test Acc: 0.032
Validation loss decreased (-0.023496 --> -0.031732).  Saving model ...
Epoch: 3 cost time: 0.5767817497253418
Epoch: 3, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.300 Vali Acc: 0.036 Test Loss: 3.300 Test Acc: 0.036
Validation loss decreased (-0.031732 --> -0.036438).  Saving model ...
Epoch: 4 cost time: 0.4505801200866699
Epoch: 4, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.285 Vali Acc: 0.045 Test Loss: 3.285 Test Acc: 0.045
Validation loss decreased (-0.036438 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 0.4855382442474365
Epoch: 5, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.272 Vali Acc: 0.060 Test Loss: 3.272 Test Acc: 0.060
Validation loss decreased (-0.044673 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.5902330875396729
Epoch: 6, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.258 Vali Acc: 0.075 Test Loss: 3.258 Test Acc: 0.075
Validation loss decreased (-0.059967 --> -0.075262).  Saving model ...
Epoch: 7 cost time: 0.4975261688232422
Epoch: 7, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.247 Vali Acc: 0.086 Test Loss: 3.247 Test Acc: 0.086
Validation loss decreased (-0.075262 --> -0.085850).  Saving model ...
Epoch: 8 cost time: 0.5388362407684326
Epoch: 8, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.239 Vali Acc: 0.096 Test Loss: 3.239 Test Acc: 0.096
Validation loss decreased (-0.085850 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 0.5145606994628906
Epoch: 9, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.232 Vali Acc: 0.104 Test Loss: 3.232 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 10 cost time: 0.5279750823974609
Epoch: 10, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.228 Vali Acc: 0.115 Test Loss: 3.228 Test Acc: 0.115
Validation loss decreased (-0.103497 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 0.5573606491088867
Epoch: 11, Steps: 10 | Train Loss: 2.476 Vali Loss: 3.225 Vali Acc: 0.120 Test Loss: 3.225 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.5600824356079102
Epoch: 12, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.223 Vali Acc: 0.125 Test Loss: 3.223 Test Acc: 0.125
Validation loss decreased (-0.119968 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 0.5752253532409668
Epoch: 13, Steps: 10 | Train Loss: 2.274 Vali Loss: 3.224 Vali Acc: 0.121 Test Loss: 3.224 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5491740703582764
Epoch: 14, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.226 Vali Acc: 0.128 Test Loss: 3.226 Test Acc: 0.128
Validation loss decreased (-0.124674 --> -0.128203).  Saving model ...
Epoch: 15 cost time: 0.6332187652587891
Epoch: 15, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.232 Vali Acc: 0.133 Test Loss: 3.232 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 0.5755767822265625
Epoch: 16, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.236 Vali Acc: 0.132 Test Loss: 3.236 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5759334564208984
Epoch: 17, Steps: 10 | Train Loss: 1.853 Vali Loss: 3.240 Vali Acc: 0.148 Test Loss: 3.240 Test Acc: 0.148
Validation loss decreased (-0.132909 --> -0.148203).  Saving model ...
Epoch: 18 cost time: 0.6048297882080078
Epoch: 18, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.250 Vali Acc: 0.144 Test Loss: 3.250 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6555736064910889
Epoch: 19, Steps: 10 | Train Loss: 1.640 Vali Loss: 3.266 Vali Acc: 0.151 Test Loss: 3.266 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150556).  Saving model ...
Epoch: 20 cost time: 0.5987281799316406
Epoch: 20, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.278 Vali Acc: 0.161 Test Loss: 3.278 Test Acc: 0.161
Validation loss decreased (-0.150556 --> -0.161144).  Saving model ...
Epoch: 21 cost time: 0.4855058193206787
Epoch: 21, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.294 Vali Acc: 0.169 Test Loss: 3.294 Test Acc: 0.169
Validation loss decreased (-0.161144 --> -0.169379).  Saving model ...
Epoch: 22 cost time: 0.46971702575683594
Epoch: 22, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.311 Vali Acc: 0.178 Test Loss: 3.311 Test Acc: 0.178
Validation loss decreased (-0.169379 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 0.5617952346801758
Epoch: 23, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.333 Vali Acc: 0.186 Test Loss: 3.333 Test Acc: 0.186
Validation loss decreased (-0.177614 --> -0.185849).  Saving model ...
Epoch: 24 cost time: 0.578885555267334
Epoch: 24, Steps: 10 | Train Loss: 1.195 Vali Loss: 3.352 Vali Acc: 0.188 Test Loss: 3.352 Test Acc: 0.188
Validation loss decreased (-0.185849 --> -0.188202).  Saving model ...
Epoch: 25 cost time: 0.5328636169433594
Epoch: 25, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.382 Vali Acc: 0.188 Test Loss: 3.382 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4784817695617676
Epoch: 26, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.403 Vali Acc: 0.194 Test Loss: 3.403 Test Acc: 0.194
Validation loss decreased (-0.188202 --> -0.194084).  Saving model ...
Epoch: 27 cost time: 0.538339376449585
Epoch: 27, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.434 Vali Acc: 0.204 Test Loss: 3.434 Test Acc: 0.204
Validation loss decreased (-0.194084 --> -0.203495).  Saving model ...
Epoch: 28 cost time: 0.5388576984405518
Epoch: 28, Steps: 10 | Train Loss: 0.904 Vali Loss: 3.463 Vali Acc: 0.205 Test Loss: 3.463 Test Acc: 0.205
Validation loss decreased (-0.203495 --> -0.204671).  Saving model ...
Epoch: 29 cost time: 0.6358320713043213
Epoch: 29, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.494 Vali Acc: 0.207 Test Loss: 3.494 Test Acc: 0.207
Validation loss decreased (-0.204671 --> -0.207024).  Saving model ...
Epoch: 30 cost time: 0.5134925842285156
Epoch: 30, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.523 Vali Acc: 0.207 Test Loss: 3.523 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5206654071807861
Epoch: 31, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.556 Vali Acc: 0.215 Test Loss: 3.556 Test Acc: 0.215
Validation loss decreased (-0.207024 --> -0.215259).  Saving model ...
Epoch: 32 cost time: 0.5447492599487305
Epoch: 32, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.589 Vali Acc: 0.206 Test Loss: 3.589 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5534257888793945
Epoch: 33, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.621 Vali Acc: 0.207 Test Loss: 3.621 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5620481967926025
Epoch: 34, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.660 Vali Acc: 0.211 Test Loss: 3.660 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6074132919311523
Epoch: 35, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.698 Vali Acc: 0.212 Test Loss: 3.698 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5664939880371094
Epoch: 36, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.742 Vali Acc: 0.206 Test Loss: 3.742 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5907185077667236
Epoch: 37, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.775 Vali Acc: 0.205 Test Loss: 3.775 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5103092193603516
Epoch: 38, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.820 Vali Acc: 0.206 Test Loss: 3.820 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6509311199188232
Epoch: 39, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.862 Vali Acc: 0.209 Test Loss: 3.862 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6334702968597412
Epoch: 40, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.906 Vali Acc: 0.207 Test Loss: 3.906 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6160569190979004
Epoch: 41, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.945 Vali Acc: 0.209 Test Loss: 3.945 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21529411764705883
model parameter : 37504
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8426775932312012
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.314 Vali Acc: 0.044 Test Loss: 3.314 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4863269329071045
Epoch: 2, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.302 Vali Acc: 0.051 Test Loss: 3.302 Test Acc: 0.051
Validation loss decreased (-0.043496 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.4756321907043457
Epoch: 3, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.287 Vali Acc: 0.056 Test Loss: 3.287 Test Acc: 0.056
Validation loss decreased (-0.050555 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 0.5257041454315186
Epoch: 4, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.274 Vali Acc: 0.058 Test Loss: 3.274 Test Acc: 0.058
Validation loss decreased (-0.056438 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.6149749755859375
Epoch: 5, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.260 Vali Acc: 0.064 Test Loss: 3.260 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.5252830982208252
Epoch: 6, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.250 Vali Acc: 0.079 Test Loss: 3.250 Test Acc: 0.079
Validation loss decreased (-0.063497 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.5470743179321289
Epoch: 7, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.240 Vali Acc: 0.092 Test Loss: 3.240 Test Acc: 0.092
Validation loss decreased (-0.078791 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 0.5242557525634766
Epoch: 8, Steps: 10 | Train Loss: 2.802 Vali Loss: 3.235 Vali Acc: 0.099 Test Loss: 3.235 Test Acc: 0.099
Validation loss decreased (-0.091732 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 0.6885662078857422
Epoch: 9, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.227 Vali Acc: 0.107 Test Loss: 3.227 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 0.6621835231781006
Epoch: 10, Steps: 10 | Train Loss: 2.614 Vali Loss: 3.224 Vali Acc: 0.115 Test Loss: 3.224 Test Acc: 0.115
Validation loss decreased (-0.107027 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 0.5674381256103516
Epoch: 11, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.220 Vali Acc: 0.116 Test Loss: 3.220 Test Acc: 0.116
Validation loss decreased (-0.115262 --> -0.116438).  Saving model ...
Epoch: 12 cost time: 0.5624938011169434
Epoch: 12, Steps: 10 | Train Loss: 2.414 Vali Loss: 3.219 Vali Acc: 0.119 Test Loss: 3.219 Test Acc: 0.119
Validation loss decreased (-0.116438 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.6655263900756836
Epoch: 13, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.217 Vali Acc: 0.125 Test Loss: 3.217 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124674).  Saving model ...
Epoch: 14 cost time: 0.6435966491699219
Epoch: 14, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.215 Vali Acc: 0.127 Test Loss: 3.215 Test Acc: 0.127
Validation loss decreased (-0.124674 --> -0.127027).  Saving model ...
Epoch: 15 cost time: 0.5460562705993652
Epoch: 15, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.214 Vali Acc: 0.140 Test Loss: 3.214 Test Acc: 0.140
Validation loss decreased (-0.127027 --> -0.139968).  Saving model ...
Epoch: 16 cost time: 0.5220844745635986
Epoch: 16, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.222 Vali Acc: 0.144 Test Loss: 3.222 Test Acc: 0.144
Validation loss decreased (-0.139968 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 0.5821518898010254
Epoch: 17, Steps: 10 | Train Loss: 1.900 Vali Loss: 3.230 Vali Acc: 0.151 Test Loss: 3.230 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.6579563617706299
Epoch: 18, Steps: 10 | Train Loss: 1.776 Vali Loss: 3.239 Vali Acc: 0.158 Test Loss: 3.239 Test Acc: 0.158
Validation loss decreased (-0.150556 --> -0.157615).  Saving model ...
Epoch: 19 cost time: 0.6563024520874023
Epoch: 19, Steps: 10 | Train Loss: 1.692 Vali Loss: 3.250 Vali Acc: 0.169 Test Loss: 3.250 Test Acc: 0.169
Validation loss decreased (-0.157615 --> -0.169379).  Saving model ...
Epoch: 20 cost time: 0.6370120048522949
Epoch: 20, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.266 Vali Acc: 0.169 Test Loss: 3.266 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5455470085144043
Epoch: 21, Steps: 10 | Train Loss: 1.504 Vali Loss: 3.280 Vali Acc: 0.174 Test Loss: 3.280 Test Acc: 0.174
Validation loss decreased (-0.169379 --> -0.174085).  Saving model ...
Epoch: 22 cost time: 0.5444960594177246
Epoch: 22, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.299 Vali Acc: 0.176 Test Loss: 3.299 Test Acc: 0.176
Validation loss decreased (-0.174085 --> -0.176438).  Saving model ...
Epoch: 23 cost time: 0.6009433269500732
Epoch: 23, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.322 Vali Acc: 0.184 Test Loss: 3.322 Test Acc: 0.184
Validation loss decreased (-0.176438 --> -0.183496).  Saving model ...
Epoch: 24 cost time: 0.7096078395843506
Epoch: 24, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.341 Vali Acc: 0.188 Test Loss: 3.341 Test Acc: 0.188
Validation loss decreased (-0.183496 --> -0.188202).  Saving model ...
Epoch: 25 cost time: 0.6037187576293945
Epoch: 25, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.362 Vali Acc: 0.191 Test Loss: 3.362 Test Acc: 0.191
Validation loss decreased (-0.188202 --> -0.190555).  Saving model ...
Epoch: 26 cost time: 0.5929219722747803
Epoch: 26, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.397 Vali Acc: 0.192 Test Loss: 3.397 Test Acc: 0.192
Validation loss decreased (-0.190555 --> -0.191731).  Saving model ...
Epoch: 27 cost time: 0.47972750663757324
Epoch: 27, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.424 Vali Acc: 0.198 Test Loss: 3.424 Test Acc: 0.198
Validation loss decreased (-0.191731 --> -0.197613).  Saving model ...
Epoch: 28 cost time: 0.5219058990478516
Epoch: 28, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.453 Vali Acc: 0.200 Test Loss: 3.453 Test Acc: 0.200
Validation loss decreased (-0.197613 --> -0.199965).  Saving model ...
Epoch: 29 cost time: 0.7149572372436523
Epoch: 29, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.486 Vali Acc: 0.202 Test Loss: 3.486 Test Acc: 0.202
Validation loss decreased (-0.199965 --> -0.202318).  Saving model ...
Epoch: 30 cost time: 0.559354305267334
Epoch: 30, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.521 Vali Acc: 0.206 Test Loss: 3.521 Test Acc: 0.206
Validation loss decreased (-0.202318 --> -0.205847).  Saving model ...
Epoch: 31 cost time: 0.5382955074310303
Epoch: 31, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.555 Vali Acc: 0.209 Test Loss: 3.555 Test Acc: 0.209
Validation loss decreased (-0.205847 --> -0.209376).  Saving model ...
Epoch: 32 cost time: 0.5988128185272217
Epoch: 32, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.594 Vali Acc: 0.205 Test Loss: 3.594 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6073055267333984
Epoch: 33, Steps: 10 | Train Loss: 0.662 Vali Loss: 3.625 Vali Acc: 0.207 Test Loss: 3.625 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5656571388244629
Epoch: 34, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.662 Vali Acc: 0.208 Test Loss: 3.662 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5794568061828613
Epoch: 35, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.708 Vali Acc: 0.212 Test Loss: 3.708 Test Acc: 0.212
Validation loss decreased (-0.209376 --> -0.211728).  Saving model ...
Epoch: 36 cost time: 0.5724129676818848
Epoch: 36, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.750 Vali Acc: 0.215 Test Loss: 3.750 Test Acc: 0.215
Validation loss decreased (-0.211728 --> -0.215257).  Saving model ...
Epoch: 37 cost time: 0.631854772567749
Epoch: 37, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.789 Vali Acc: 0.214 Test Loss: 3.789 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.608536958694458
Epoch: 38, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.835 Vali Acc: 0.216 Test Loss: 3.835 Test Acc: 0.216
Validation loss decreased (-0.215257 --> -0.216432).  Saving model ...
Epoch: 39 cost time: 0.5425257682800293
Epoch: 39, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.882 Vali Acc: 0.209 Test Loss: 3.882 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6120545864105225
Epoch: 40, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.919 Vali Acc: 0.213 Test Loss: 3.919 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7685716152191162
Epoch: 41, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.967 Vali Acc: 0.218 Test Loss: 3.967 Test Acc: 0.218
Validation loss decreased (-0.216432 --> -0.217607).  Saving model ...
Epoch: 42 cost time: 0.6555325984954834
Epoch: 42, Steps: 10 | Train Loss: 0.372 Vali Loss: 4.017 Vali Acc: 0.215 Test Loss: 4.017 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.660710334777832
Epoch: 43, Steps: 10 | Train Loss: 0.325 Vali Loss: 4.050 Vali Acc: 0.216 Test Loss: 4.050 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5796442031860352
Epoch: 44, Steps: 10 | Train Loss: 0.292 Vali Loss: 4.109 Vali Acc: 0.216 Test Loss: 4.109 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6313731670379639
Epoch: 45, Steps: 10 | Train Loss: 0.258 Vali Loss: 4.166 Vali Acc: 0.218 Test Loss: 4.166 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7635352611541748
Epoch: 46, Steps: 10 | Train Loss: 0.250 Vali Loss: 4.205 Vali Acc: 0.219 Test Loss: 4.205 Test Acc: 0.219
Validation loss decreased (-0.217607 --> -0.218781).  Saving model ...
Epoch: 47 cost time: 0.5840373039245605
Epoch: 47, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.260 Vali Acc: 0.219 Test Loss: 4.260 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5810086727142334
Epoch: 48, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.305 Vali Acc: 0.220 Test Loss: 4.305 Test Acc: 0.220
Validation loss decreased (-0.218781 --> -0.219957).  Saving model ...
Epoch: 49 cost time: 0.5282819271087646
Epoch: 49, Steps: 10 | Train Loss: 0.192 Vali Loss: 4.345 Vali Acc: 0.224 Test Loss: 4.345 Test Acc: 0.224
Validation loss decreased (-0.219957 --> -0.223486).  Saving model ...
Epoch: 50 cost time: 0.5843667984008789
Epoch: 50, Steps: 10 | Train Loss: 0.176 Vali Loss: 4.401 Vali Acc: 0.220 Test Loss: 4.401 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5735185146331787
Epoch: 51, Steps: 10 | Train Loss: 0.164 Vali Loss: 4.446 Vali Acc: 0.218 Test Loss: 4.446 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5486648082733154
Epoch: 52, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.497 Vali Acc: 0.219 Test Loss: 4.497 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5213890075683594
Epoch: 53, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.556 Vali Acc: 0.215 Test Loss: 4.556 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5299451351165771
Epoch: 54, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.610 Vali Acc: 0.219 Test Loss: 4.610 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5280632972717285
Epoch: 55, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.653 Vali Acc: 0.221 Test Loss: 4.653 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.553856372833252
Epoch: 56, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.707 Vali Acc: 0.222 Test Loss: 4.707 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.6745507717132568
Epoch: 57, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.753 Vali Acc: 0.219 Test Loss: 4.753 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.6433541774749756
Epoch: 58, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.825 Vali Acc: 0.215 Test Loss: 4.825 Test Acc: 0.215
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.6868178844451904
Epoch: 59, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.861 Vali Acc: 0.219 Test Loss: 4.861 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 37542
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.836214542388916
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.337 Vali Acc: 0.041 Test Loss: 3.337 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.6500740051269531
Epoch: 2, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.323 Vali Acc: 0.051 Test Loss: 3.323 Test Acc: 0.051
Validation loss decreased (-0.041143 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.6333174705505371
Epoch: 3, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.308 Vali Acc: 0.058 Test Loss: 3.308 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.5293772220611572
Epoch: 4, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.291 Vali Acc: 0.068 Test Loss: 3.291 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 0.6552219390869141
Epoch: 5, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.277 Vali Acc: 0.080 Test Loss: 3.277 Test Acc: 0.080
Validation loss decreased (-0.068202 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.5628859996795654
Epoch: 6, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.262 Vali Acc: 0.088 Test Loss: 3.262 Test Acc: 0.088
Validation loss decreased (-0.079967 --> -0.088203).  Saving model ...
Epoch: 7 cost time: 0.7390613555908203
Epoch: 7, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.249 Vali Acc: 0.095 Test Loss: 3.249 Test Acc: 0.095
Validation loss decreased (-0.088203 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.6521923542022705
Epoch: 8, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.238 Vali Acc: 0.105 Test Loss: 3.238 Test Acc: 0.105
Validation loss decreased (-0.095262 --> -0.104674).  Saving model ...
Epoch: 9 cost time: 0.5051062107086182
Epoch: 9, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.229 Vali Acc: 0.112 Test Loss: 3.229 Test Acc: 0.112
Validation loss decreased (-0.104674 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.5811865329742432
Epoch: 10, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.223 Vali Acc: 0.127 Test Loss: 3.223 Test Acc: 0.127
Validation loss decreased (-0.111732 --> -0.127027).  Saving model ...
Epoch: 11 cost time: 0.6441118717193604
Epoch: 11, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.218 Vali Acc: 0.127 Test Loss: 3.218 Test Acc: 0.127
Validation loss decreased (-0.127027 --> -0.127027).  Saving model ...
Epoch: 12 cost time: 0.6283812522888184
Epoch: 12, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.216 Vali Acc: 0.127 Test Loss: 3.216 Test Acc: 0.127
Validation loss decreased (-0.127027 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 0.5623819828033447
Epoch: 13, Steps: 10 | Train Loss: 2.303 Vali Loss: 3.214 Vali Acc: 0.131 Test Loss: 3.214 Test Acc: 0.131
Validation loss decreased (-0.127027 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 0.572943925857544
Epoch: 14, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.215 Vali Acc: 0.133 Test Loss: 3.215 Test Acc: 0.133
Validation loss decreased (-0.130556 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.559586763381958
Epoch: 15, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.219 Vali Acc: 0.134 Test Loss: 3.219 Test Acc: 0.134
Validation loss decreased (-0.132909 --> -0.134085).  Saving model ...
Epoch: 16 cost time: 0.4947037696838379
Epoch: 16, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.222 Vali Acc: 0.149 Test Loss: 3.222 Test Acc: 0.149
Validation loss decreased (-0.134085 --> -0.149380).  Saving model ...
Epoch: 17 cost time: 0.6098980903625488
Epoch: 17, Steps: 10 | Train Loss: 1.882 Vali Loss: 3.233 Vali Acc: 0.152 Test Loss: 3.233 Test Acc: 0.152
Validation loss decreased (-0.149380 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 0.5628235340118408
Epoch: 18, Steps: 10 | Train Loss: 1.817 Vali Loss: 3.243 Vali Acc: 0.155 Test Loss: 3.243 Test Acc: 0.155
Validation loss decreased (-0.151732 --> -0.155262).  Saving model ...
Epoch: 19 cost time: 0.6189084053039551
Epoch: 19, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.253 Vali Acc: 0.161 Test Loss: 3.253 Test Acc: 0.161
Validation loss decreased (-0.155262 --> -0.161144).  Saving model ...
Epoch: 20 cost time: 0.584522008895874
Epoch: 20, Steps: 10 | Train Loss: 1.607 Vali Loss: 3.271 Vali Acc: 0.165 Test Loss: 3.271 Test Acc: 0.165
Validation loss decreased (-0.161144 --> -0.164673).  Saving model ...
Epoch: 21 cost time: 0.6261589527130127
Epoch: 21, Steps: 10 | Train Loss: 1.498 Vali Loss: 3.286 Vali Acc: 0.171 Test Loss: 3.286 Test Acc: 0.171
Validation loss decreased (-0.164673 --> -0.170555).  Saving model ...
Epoch: 22 cost time: 0.6655011177062988
Epoch: 22, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.300 Vali Acc: 0.178 Test Loss: 3.300 Test Acc: 0.178
Validation loss decreased (-0.170555 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 0.6738524436950684
Epoch: 23, Steps: 10 | Train Loss: 1.304 Vali Loss: 3.321 Vali Acc: 0.180 Test Loss: 3.321 Test Acc: 0.180
Validation loss decreased (-0.177614 --> -0.179967).  Saving model ...
Epoch: 24 cost time: 0.6414139270782471
Epoch: 24, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.346 Vali Acc: 0.182 Test Loss: 3.346 Test Acc: 0.182
Validation loss decreased (-0.179967 --> -0.182319).  Saving model ...
Epoch: 25 cost time: 0.5914185047149658
Epoch: 25, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.375 Vali Acc: 0.188 Test Loss: 3.375 Test Acc: 0.188
Validation loss decreased (-0.182319 --> -0.188202).  Saving model ...
Epoch: 26 cost time: 0.5587611198425293
Epoch: 26, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.400 Vali Acc: 0.194 Test Loss: 3.400 Test Acc: 0.194
Validation loss decreased (-0.188202 --> -0.194084).  Saving model ...
Epoch: 27 cost time: 0.7557101249694824
Epoch: 27, Steps: 10 | Train Loss: 0.989 Vali Loss: 3.427 Vali Acc: 0.194 Test Loss: 3.427 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8125488758087158
Epoch: 28, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.453 Vali Acc: 0.194 Test Loss: 3.453 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6630954742431641
Epoch: 29, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.482 Vali Acc: 0.202 Test Loss: 3.482 Test Acc: 0.202
Validation loss decreased (-0.194084 --> -0.202318).  Saving model ...
Epoch: 30 cost time: 0.5703082084655762
Epoch: 30, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.513 Vali Acc: 0.206 Test Loss: 3.513 Test Acc: 0.206
Validation loss decreased (-0.202318 --> -0.205847).  Saving model ...
Epoch: 31 cost time: 0.5828874111175537
Epoch: 31, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.546 Vali Acc: 0.211 Test Loss: 3.546 Test Acc: 0.211
Validation loss decreased (-0.205847 --> -0.210553).  Saving model ...
Epoch: 32 cost time: 0.5623905658721924
Epoch: 32, Steps: 10 | Train Loss: 0.717 Vali Loss: 3.581 Vali Acc: 0.208 Test Loss: 3.581 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6177756786346436
Epoch: 33, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.616 Vali Acc: 0.209 Test Loss: 3.616 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5028159618377686
Epoch: 34, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.647 Vali Acc: 0.211 Test Loss: 3.647 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5790665149688721
Epoch: 35, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.677 Vali Acc: 0.208 Test Loss: 3.677 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5598568916320801
Epoch: 36, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.711 Vali Acc: 0.207 Test Loss: 3.711 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5574064254760742
Epoch: 37, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.744 Vali Acc: 0.207 Test Loss: 3.744 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5440776348114014
Epoch: 38, Steps: 10 | Train Loss: 0.457 Vali Loss: 3.777 Vali Acc: 0.212 Test Loss: 3.777 Test Acc: 0.212
Validation loss decreased (-0.210553 --> -0.211727).  Saving model ...
Epoch: 39 cost time: 0.5239355564117432
Epoch: 39, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.813 Vali Acc: 0.211 Test Loss: 3.813 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5663802623748779
Epoch: 40, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.849 Vali Acc: 0.214 Test Loss: 3.849 Test Acc: 0.214
Validation loss decreased (-0.211727 --> -0.214079).  Saving model ...
Epoch: 41 cost time: 0.5256307125091553
Epoch: 41, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.886 Vali Acc: 0.212 Test Loss: 3.886 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6542396545410156
Epoch: 42, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.920 Vali Acc: 0.218 Test Loss: 3.920 Test Acc: 0.218
Validation loss decreased (-0.214079 --> -0.217608).  Saving model ...
Epoch: 43 cost time: 0.5919044017791748
Epoch: 43, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.964 Vali Acc: 0.216 Test Loss: 3.964 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6117861270904541
Epoch: 44, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.998 Vali Acc: 0.219 Test Loss: 3.998 Test Acc: 0.219
Validation loss decreased (-0.217608 --> -0.218784).  Saving model ...
Epoch: 45 cost time: 0.5167746543884277
Epoch: 45, Steps: 10 | Train Loss: 0.292 Vali Loss: 4.030 Vali Acc: 0.220 Test Loss: 4.030 Test Acc: 0.220
Validation loss decreased (-0.218784 --> -0.219960).  Saving model ...
Epoch: 46 cost time: 0.5792937278747559
Epoch: 46, Steps: 10 | Train Loss: 0.257 Vali Loss: 4.068 Vali Acc: 0.216 Test Loss: 4.068 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6169061660766602
Epoch: 47, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.109 Vali Acc: 0.215 Test Loss: 4.109 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.528770923614502
Epoch: 48, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.140 Vali Acc: 0.216 Test Loss: 4.140 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5743961334228516
Epoch: 49, Steps: 10 | Train Loss: 0.207 Vali Loss: 4.171 Vali Acc: 0.216 Test Loss: 4.171 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5848374366760254
Epoch: 50, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.201 Vali Acc: 0.218 Test Loss: 4.201 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5548543930053711
Epoch: 51, Steps: 10 | Train Loss: 0.184 Vali Loss: 4.238 Vali Acc: 0.215 Test Loss: 4.238 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5819411277770996
Epoch: 52, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.270 Vali Acc: 0.208 Test Loss: 4.270 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.6080336570739746
Epoch: 53, Steps: 10 | Train Loss: 0.154 Vali Loss: 4.310 Vali Acc: 0.213 Test Loss: 4.310 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6644086837768555
Epoch: 54, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.340 Vali Acc: 0.216 Test Loss: 4.340 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.5277047157287598
Epoch: 55, Steps: 10 | Train Loss: 0.136 Vali Loss: 4.374 Vali Acc: 0.218 Test Loss: 4.374 Test Acc: 0.218
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22
model parameter : 37280
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5025713443756104
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.336 Vali Acc: 0.038 Test Loss: 3.336 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.5009136199951172
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.321 Vali Acc: 0.041 Test Loss: 3.321 Test Acc: 0.041
Validation loss decreased (-0.037614 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.5649259090423584
Epoch: 3, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.303 Vali Acc: 0.042 Test Loss: 3.303 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 0.486891508102417
Epoch: 4, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.287 Vali Acc: 0.052 Test Loss: 3.287 Test Acc: 0.052
Validation loss decreased (-0.042320 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.4690704345703125
Epoch: 5, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.271 Vali Acc: 0.061 Test Loss: 3.271 Test Acc: 0.061
Validation loss decreased (-0.051732 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.5466837882995605
Epoch: 6, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.260 Vali Acc: 0.068 Test Loss: 3.260 Test Acc: 0.068
Validation loss decreased (-0.061144 --> -0.068203).  Saving model ...
Epoch: 7 cost time: 0.6475841999053955
Epoch: 7, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.251 Vali Acc: 0.078 Test Loss: 3.251 Test Acc: 0.078
Validation loss decreased (-0.068203 --> -0.077615).  Saving model ...
Epoch: 8 cost time: 0.5048155784606934
Epoch: 8, Steps: 10 | Train Loss: 2.796 Vali Loss: 3.245 Vali Acc: 0.080 Test Loss: 3.245 Test Acc: 0.080
Validation loss decreased (-0.077615 --> -0.079968).  Saving model ...
Epoch: 9 cost time: 0.697643518447876
Epoch: 9, Steps: 10 | Train Loss: 2.679 Vali Loss: 3.240 Vali Acc: 0.087 Test Loss: 3.240 Test Acc: 0.087
Validation loss decreased (-0.079968 --> -0.087026).  Saving model ...
Epoch: 10 cost time: 0.541273832321167
Epoch: 10, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.235 Vali Acc: 0.099 Test Loss: 3.235 Test Acc: 0.099
Validation loss decreased (-0.087026 --> -0.098791).  Saving model ...
Epoch: 11 cost time: 0.458648681640625
Epoch: 11, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.231 Vali Acc: 0.101 Test Loss: 3.231 Test Acc: 0.101
Validation loss decreased (-0.098791 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 0.6448345184326172
Epoch: 12, Steps: 10 | Train Loss: 2.372 Vali Loss: 3.233 Vali Acc: 0.107 Test Loss: 3.233 Test Acc: 0.107
Validation loss decreased (-0.101144 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 0.5727345943450928
Epoch: 13, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.230 Vali Acc: 0.113 Test Loss: 3.230 Test Acc: 0.113
Validation loss decreased (-0.107026 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 0.4746673107147217
Epoch: 14, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.233 Vali Acc: 0.126 Test Loss: 3.233 Test Acc: 0.126
Validation loss decreased (-0.112909 --> -0.125850).  Saving model ...
Epoch: 15 cost time: 0.5511722564697266
Epoch: 15, Steps: 10 | Train Loss: 2.060 Vali Loss: 3.235 Vali Acc: 0.129 Test Loss: 3.235 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129379).  Saving model ...
Epoch: 16 cost time: 0.47173643112182617
Epoch: 16, Steps: 10 | Train Loss: 1.967 Vali Loss: 3.238 Vali Acc: 0.139 Test Loss: 3.238 Test Acc: 0.139
Validation loss decreased (-0.129379 --> -0.138791).  Saving model ...
Epoch: 17 cost time: 0.628176212310791
Epoch: 17, Steps: 10 | Train Loss: 1.879 Vali Loss: 3.247 Vali Acc: 0.149 Test Loss: 3.247 Test Acc: 0.149
Validation loss decreased (-0.138791 --> -0.149379).  Saving model ...
Epoch: 18 cost time: 0.5516772270202637
Epoch: 18, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.252 Vali Acc: 0.149 Test Loss: 3.252 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.49390506744384766
Epoch: 19, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.264 Vali Acc: 0.154 Test Loss: 3.264 Test Acc: 0.154
Validation loss decreased (-0.149379 --> -0.154085).  Saving model ...
Epoch: 20 cost time: 0.4777984619140625
Epoch: 20, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.283 Vali Acc: 0.161 Test Loss: 3.283 Test Acc: 0.161
Validation loss decreased (-0.154085 --> -0.161144).  Saving model ...
Epoch: 21 cost time: 0.47890710830688477
Epoch: 21, Steps: 10 | Train Loss: 1.508 Vali Loss: 3.302 Vali Acc: 0.168 Test Loss: 3.302 Test Acc: 0.168
Validation loss decreased (-0.161144 --> -0.168202).  Saving model ...
Epoch: 22 cost time: 0.5459322929382324
Epoch: 22, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.325 Vali Acc: 0.179 Test Loss: 3.325 Test Acc: 0.179
Validation loss decreased (-0.168202 --> -0.178790).  Saving model ...
Epoch: 23 cost time: 0.6706912517547607
Epoch: 23, Steps: 10 | Train Loss: 1.313 Vali Loss: 3.342 Vali Acc: 0.181 Test Loss: 3.342 Test Acc: 0.181
Validation loss decreased (-0.178790 --> -0.181143).  Saving model ...
Epoch: 24 cost time: 0.4895780086517334
Epoch: 24, Steps: 10 | Train Loss: 1.280 Vali Loss: 3.360 Vali Acc: 0.187 Test Loss: 3.360 Test Acc: 0.187
Validation loss decreased (-0.181143 --> -0.187025).  Saving model ...
Epoch: 25 cost time: 0.5019481182098389
Epoch: 25, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.381 Vali Acc: 0.193 Test Loss: 3.381 Test Acc: 0.193
Validation loss decreased (-0.187025 --> -0.192907).  Saving model ...
Epoch: 26 cost time: 0.530536413192749
Epoch: 26, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.407 Vali Acc: 0.192 Test Loss: 3.407 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5536172389984131
Epoch: 27, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.433 Vali Acc: 0.198 Test Loss: 3.433 Test Acc: 0.198
Validation loss decreased (-0.192907 --> -0.197613).  Saving model ...
Epoch: 28 cost time: 0.5849533081054688
Epoch: 28, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.467 Vali Acc: 0.207 Test Loss: 3.467 Test Acc: 0.207
Validation loss decreased (-0.197613 --> -0.207024).  Saving model ...
Epoch: 29 cost time: 0.581958532333374
Epoch: 29, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.498 Vali Acc: 0.204 Test Loss: 3.498 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5391812324523926
Epoch: 30, Steps: 10 | Train Loss: 0.817 Vali Loss: 3.525 Vali Acc: 0.209 Test Loss: 3.525 Test Acc: 0.209
Validation loss decreased (-0.207024 --> -0.209377).  Saving model ...
Epoch: 31 cost time: 0.5219106674194336
Epoch: 31, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.562 Vali Acc: 0.209 Test Loss: 3.562 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.584068775177002
Epoch: 32, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.589 Vali Acc: 0.219 Test Loss: 3.589 Test Acc: 0.219
Validation loss decreased (-0.209377 --> -0.218788).  Saving model ...
Epoch: 33 cost time: 0.5688915252685547
Epoch: 33, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.623 Vali Acc: 0.216 Test Loss: 3.623 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5135180950164795
Epoch: 34, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.660 Vali Acc: 0.216 Test Loss: 3.660 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.44252729415893555
Epoch: 35, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.699 Vali Acc: 0.215 Test Loss: 3.699 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.48096585273742676
Epoch: 36, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.737 Vali Acc: 0.221 Test Loss: 3.737 Test Acc: 0.221
Validation loss decreased (-0.218788 --> -0.221139).  Saving model ...
Epoch: 37 cost time: 0.46500372886657715
Epoch: 37, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.768 Vali Acc: 0.221 Test Loss: 3.768 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5583281517028809
Epoch: 38, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.805 Vali Acc: 0.213 Test Loss: 3.805 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6716587543487549
Epoch: 39, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.843 Vali Acc: 0.214 Test Loss: 3.843 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5717926025390625
Epoch: 40, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.882 Vali Acc: 0.216 Test Loss: 3.882 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6067883968353271
Epoch: 41, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.921 Vali Acc: 0.215 Test Loss: 3.921 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5734055042266846
Epoch: 42, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.960 Vali Acc: 0.214 Test Loss: 3.960 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6642518043518066
Epoch: 43, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.987 Vali Acc: 0.212 Test Loss: 3.987 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6059322357177734
Epoch: 44, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.040 Vali Acc: 0.216 Test Loss: 4.040 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5094592571258545
Epoch: 45, Steps: 10 | Train Loss: 0.320 Vali Loss: 4.082 Vali Acc: 0.219 Test Loss: 4.082 Test Acc: 0.219
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.47954893112182617
Epoch: 46, Steps: 10 | Train Loss: 0.266 Vali Loss: 4.122 Vali Acc: 0.216 Test Loss: 4.122 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2211764705882353
model parameter : 38304
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7302803993225098
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.322 Vali Acc: 0.035 Test Loss: 3.322 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5406475067138672
Epoch: 2, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.311 Vali Acc: 0.036 Test Loss: 3.311 Test Acc: 0.036
Validation loss decreased (-0.035261 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.45806026458740234
Epoch: 3, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.297 Vali Acc: 0.038 Test Loss: 3.297 Test Acc: 0.038
Validation loss decreased (-0.036437 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.5099136829376221
Epoch: 4, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.282 Vali Acc: 0.039 Test Loss: 3.282 Test Acc: 0.039
Validation loss decreased (-0.037614 --> -0.038791).  Saving model ...
Epoch: 5 cost time: 0.5129063129425049
Epoch: 5, Steps: 10 | Train Loss: 3.065 Vali Loss: 3.267 Vali Acc: 0.054 Test Loss: 3.267 Test Acc: 0.054
Validation loss decreased (-0.038791 --> -0.054085).  Saving model ...
Epoch: 6 cost time: 0.5361735820770264
Epoch: 6, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.253 Vali Acc: 0.071 Test Loss: 3.253 Test Acc: 0.071
Validation loss decreased (-0.054085 --> -0.070556).  Saving model ...
Epoch: 7 cost time: 0.5076680183410645
Epoch: 7, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.240 Vali Acc: 0.080 Test Loss: 3.240 Test Acc: 0.080
Validation loss decreased (-0.070556 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 0.5754890441894531
Epoch: 8, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.231 Vali Acc: 0.088 Test Loss: 3.231 Test Acc: 0.088
Validation loss decreased (-0.079968 --> -0.088203).  Saving model ...
Epoch: 9 cost time: 0.503223180770874
Epoch: 9, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.223 Vali Acc: 0.107 Test Loss: 3.223 Test Acc: 0.107
Validation loss decreased (-0.088203 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 0.5458424091339111
Epoch: 10, Steps: 10 | Train Loss: 2.602 Vali Loss: 3.218 Vali Acc: 0.113 Test Loss: 3.218 Test Acc: 0.113
Validation loss decreased (-0.107027 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 0.6063945293426514
Epoch: 11, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.213 Vali Acc: 0.125 Test Loss: 3.213 Test Acc: 0.125
Validation loss decreased (-0.112909 --> -0.124674).  Saving model ...
Epoch: 12 cost time: 0.6270303726196289
Epoch: 12, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.210 Vali Acc: 0.122 Test Loss: 3.210 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6349203586578369
Epoch: 13, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.207 Vali Acc: 0.127 Test Loss: 3.207 Test Acc: 0.127
Validation loss decreased (-0.124674 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.5245785713195801
Epoch: 14, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.209 Vali Acc: 0.138 Test Loss: 3.209 Test Acc: 0.138
Validation loss decreased (-0.127027 --> -0.137615).  Saving model ...
Epoch: 15 cost time: 0.608067512512207
Epoch: 15, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.209 Vali Acc: 0.142 Test Loss: 3.209 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142321).  Saving model ...
Epoch: 16 cost time: 0.5815017223358154
Epoch: 16, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.214 Vali Acc: 0.147 Test Loss: 3.214 Test Acc: 0.147
Validation loss decreased (-0.142321 --> -0.147027).  Saving model ...
Epoch: 17 cost time: 0.6206822395324707
Epoch: 17, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.223 Vali Acc: 0.148 Test Loss: 3.223 Test Acc: 0.148
Validation loss decreased (-0.147027 --> -0.148203).  Saving model ...
Epoch: 18 cost time: 0.5307300090789795
Epoch: 18, Steps: 10 | Train Loss: 1.803 Vali Loss: 3.230 Vali Acc: 0.149 Test Loss: 3.230 Test Acc: 0.149
Validation loss decreased (-0.148203 --> -0.149379).  Saving model ...
Epoch: 19 cost time: 0.5569593906402588
Epoch: 19, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.242 Vali Acc: 0.156 Test Loss: 3.242 Test Acc: 0.156
Validation loss decreased (-0.149379 --> -0.156438).  Saving model ...
Epoch: 20 cost time: 0.6416192054748535
Epoch: 20, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.256 Vali Acc: 0.158 Test Loss: 3.256 Test Acc: 0.158
Validation loss decreased (-0.156438 --> -0.157614).  Saving model ...
Epoch: 21 cost time: 0.611083984375
Epoch: 21, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.271 Vali Acc: 0.167 Test Loss: 3.271 Test Acc: 0.167
Validation loss decreased (-0.157614 --> -0.167026).  Saving model ...
Epoch: 22 cost time: 0.5638184547424316
Epoch: 22, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.294 Vali Acc: 0.166 Test Loss: 3.294 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6231300830841064
Epoch: 23, Steps: 10 | Train Loss: 1.298 Vali Loss: 3.311 Vali Acc: 0.169 Test Loss: 3.311 Test Acc: 0.169
Validation loss decreased (-0.167026 --> -0.169379).  Saving model ...
Epoch: 24 cost time: 0.5917437076568604
Epoch: 24, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.336 Vali Acc: 0.173 Test Loss: 3.336 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 25 cost time: 0.49690675735473633
Epoch: 25, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.361 Vali Acc: 0.178 Test Loss: 3.361 Test Acc: 0.178
Validation loss decreased (-0.172908 --> -0.177613).  Saving model ...
Epoch: 26 cost time: 0.5386130809783936
Epoch: 26, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.385 Vali Acc: 0.189 Test Loss: 3.385 Test Acc: 0.189
Validation loss decreased (-0.177613 --> -0.189378).  Saving model ...
Epoch: 27 cost time: 0.5579888820648193
Epoch: 27, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.415 Vali Acc: 0.193 Test Loss: 3.415 Test Acc: 0.193
Validation loss decreased (-0.189378 --> -0.192907).  Saving model ...
Epoch: 28 cost time: 0.4371459484100342
Epoch: 28, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.445 Vali Acc: 0.195 Test Loss: 3.445 Test Acc: 0.195
Validation loss decreased (-0.192907 --> -0.195260).  Saving model ...
Epoch: 29 cost time: 0.4946322441101074
Epoch: 29, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.473 Vali Acc: 0.199 Test Loss: 3.473 Test Acc: 0.199
Validation loss decreased (-0.195260 --> -0.198789).  Saving model ...
Epoch: 30 cost time: 0.5164268016815186
Epoch: 30, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.504 Vali Acc: 0.199 Test Loss: 3.504 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5684776306152344
Epoch: 31, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.539 Vali Acc: 0.208 Test Loss: 3.539 Test Acc: 0.208
Validation loss decreased (-0.198789 --> -0.208200).  Saving model ...
Epoch: 32 cost time: 0.5966763496398926
Epoch: 32, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.574 Vali Acc: 0.204 Test Loss: 3.574 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5763962268829346
Epoch: 33, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.612 Vali Acc: 0.201 Test Loss: 3.612 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5167908668518066
Epoch: 34, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.648 Vali Acc: 0.202 Test Loss: 3.648 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5506227016448975
Epoch: 35, Steps: 10 | Train Loss: 0.580 Vali Loss: 3.694 Vali Acc: 0.204 Test Loss: 3.694 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5849168300628662
Epoch: 36, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.730 Vali Acc: 0.202 Test Loss: 3.730 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6922702789306641
Epoch: 37, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.772 Vali Acc: 0.206 Test Loss: 3.772 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6053318977355957
Epoch: 38, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.814 Vali Acc: 0.214 Test Loss: 3.814 Test Acc: 0.214
Validation loss decreased (-0.208200 --> -0.214080).  Saving model ...
Epoch: 39 cost time: 0.506803035736084
Epoch: 39, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.861 Vali Acc: 0.216 Test Loss: 3.861 Test Acc: 0.216
Validation loss decreased (-0.214080 --> -0.216432).  Saving model ...
Epoch: 40 cost time: 0.5205070972442627
Epoch: 40, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.899 Vali Acc: 0.216 Test Loss: 3.899 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6570723056793213
Epoch: 41, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.926 Vali Acc: 0.216 Test Loss: 3.926 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6574938297271729
Epoch: 42, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.967 Vali Acc: 0.219 Test Loss: 3.967 Test Acc: 0.219
Validation loss decreased (-0.216432 --> -0.218784).  Saving model ...
Epoch: 43 cost time: 0.532203197479248
Epoch: 43, Steps: 10 | Train Loss: 0.280 Vali Loss: 4.019 Vali Acc: 0.219 Test Loss: 4.019 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5096182823181152
Epoch: 44, Steps: 10 | Train Loss: 0.261 Vali Loss: 4.070 Vali Acc: 0.221 Test Loss: 4.070 Test Acc: 0.221
Validation loss decreased (-0.218784 --> -0.221136).  Saving model ...
Epoch: 45 cost time: 0.5121307373046875
Epoch: 45, Steps: 10 | Train Loss: 0.245 Vali Loss: 4.109 Vali Acc: 0.219 Test Loss: 4.109 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5092697143554688
Epoch: 46, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.148 Vali Acc: 0.221 Test Loss: 4.148 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5823819637298584
Epoch: 47, Steps: 10 | Train Loss: 0.202 Vali Loss: 4.198 Vali Acc: 0.220 Test Loss: 4.198 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.582756519317627
Epoch: 48, Steps: 10 | Train Loss: 0.187 Vali Loss: 4.251 Vali Acc: 0.220 Test Loss: 4.251 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.547666072845459
Epoch: 49, Steps: 10 | Train Loss: 0.172 Vali Loss: 4.306 Vali Acc: 0.222 Test Loss: 4.306 Test Acc: 0.222
Validation loss decreased (-0.221136 --> -0.222310).  Saving model ...
Epoch: 50 cost time: 0.5600602626800537
Epoch: 50, Steps: 10 | Train Loss: 0.162 Vali Loss: 4.348 Vali Acc: 0.219 Test Loss: 4.348 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6388931274414062
Epoch: 51, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.397 Vali Acc: 0.224 Test Loss: 4.397 Test Acc: 0.224
Validation loss decreased (-0.222310 --> -0.223485).  Saving model ...
Epoch: 52 cost time: 0.562384843826294
Epoch: 52, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.460 Vali Acc: 0.224 Test Loss: 4.460 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5391297340393066
Epoch: 53, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.519 Vali Acc: 0.215 Test Loss: 4.519 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5920212268829346
Epoch: 54, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.560 Vali Acc: 0.218 Test Loss: 4.560 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6634573936462402
Epoch: 55, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.603 Vali Acc: 0.220 Test Loss: 4.603 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.6980292797088623
Epoch: 56, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.647 Vali Acc: 0.218 Test Loss: 4.647 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.544621467590332
Epoch: 57, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.697 Vali Acc: 0.222 Test Loss: 4.697 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.506758451461792
Epoch: 58, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.745 Vali Acc: 0.218 Test Loss: 4.745 Test Acc: 0.218
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.6217508316040039
Epoch: 59, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.798 Vali Acc: 0.221 Test Loss: 4.798 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.7366106510162354
Epoch: 60, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.852 Vali Acc: 0.222 Test Loss: 4.852 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.546140193939209
Epoch: 61, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.893 Vali Acc: 0.220 Test Loss: 4.893 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 37294
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6633989810943604
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.346 Vali Acc: 0.034 Test Loss: 3.346 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.4483945369720459
Epoch: 2, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.333 Vali Acc: 0.035 Test Loss: 3.333 Test Acc: 0.035
Validation loss decreased (-0.034084 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.5271432399749756
Epoch: 3, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.317 Vali Acc: 0.035 Test Loss: 3.317 Test Acc: 0.035
Validation loss decreased (-0.035261 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 0.5453717708587646
Epoch: 4, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.300 Vali Acc: 0.039 Test Loss: 3.300 Test Acc: 0.039
Validation loss decreased (-0.035261 --> -0.038791).  Saving model ...
Epoch: 5 cost time: 0.5289871692657471
Epoch: 5, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.284 Vali Acc: 0.048 Test Loss: 3.284 Test Acc: 0.048
Validation loss decreased (-0.038791 --> -0.048202).  Saving model ...
Epoch: 6 cost time: 0.45115184783935547
Epoch: 6, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.271 Vali Acc: 0.056 Test Loss: 3.271 Test Acc: 0.056
Validation loss decreased (-0.048202 --> -0.056438).  Saving model ...
Epoch: 7 cost time: 0.46679067611694336
Epoch: 7, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.259 Vali Acc: 0.082 Test Loss: 3.259 Test Acc: 0.082
Validation loss decreased (-0.056438 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 0.5246648788452148
Epoch: 8, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.249 Vali Acc: 0.092 Test Loss: 3.249 Test Acc: 0.092
Validation loss decreased (-0.082320 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.5594463348388672
Epoch: 9, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.241 Vali Acc: 0.095 Test Loss: 3.241 Test Acc: 0.095
Validation loss decreased (-0.091732 --> -0.095262).  Saving model ...
Epoch: 10 cost time: 0.551483154296875
Epoch: 10, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.238 Vali Acc: 0.102 Test Loss: 3.238 Test Acc: 0.102
Validation loss decreased (-0.095262 --> -0.102321).  Saving model ...
Epoch: 11 cost time: 0.5423755645751953
Epoch: 11, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.235 Vali Acc: 0.105 Test Loss: 3.235 Test Acc: 0.105
Validation loss decreased (-0.102321 --> -0.104674).  Saving model ...
Epoch: 12 cost time: 0.5301992893218994
Epoch: 12, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.234 Vali Acc: 0.113 Test Loss: 3.234 Test Acc: 0.113
Validation loss decreased (-0.104674 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 0.5192949771881104
Epoch: 13, Steps: 10 | Train Loss: 2.296 Vali Loss: 3.232 Vali Acc: 0.121 Test Loss: 3.232 Test Acc: 0.121
Validation loss decreased (-0.112909 --> -0.121144).  Saving model ...
Epoch: 14 cost time: 0.6439616680145264
Epoch: 14, Steps: 10 | Train Loss: 2.188 Vali Loss: 3.232 Vali Acc: 0.122 Test Loss: 3.232 Test Acc: 0.122
Validation loss decreased (-0.121144 --> -0.122321).  Saving model ...
Epoch: 15 cost time: 0.5898325443267822
Epoch: 15, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.231 Vali Acc: 0.129 Test Loss: 3.231 Test Acc: 0.129
Validation loss decreased (-0.122321 --> -0.129379).  Saving model ...
Epoch: 16 cost time: 0.5450334548950195
Epoch: 16, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.237 Vali Acc: 0.136 Test Loss: 3.237 Test Acc: 0.136
Validation loss decreased (-0.129379 --> -0.136438).  Saving model ...
Epoch: 17 cost time: 0.5754702091217041
Epoch: 17, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.240 Vali Acc: 0.146 Test Loss: 3.240 Test Acc: 0.146
Validation loss decreased (-0.136438 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.5729217529296875
Epoch: 18, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.248 Vali Acc: 0.154 Test Loss: 3.248 Test Acc: 0.154
Validation loss decreased (-0.145850 --> -0.154085).  Saving model ...
Epoch: 19 cost time: 0.6817083358764648
Epoch: 19, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.260 Vali Acc: 0.152 Test Loss: 3.260 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5741732120513916
Epoch: 20, Steps: 10 | Train Loss: 1.663 Vali Loss: 3.272 Vali Acc: 0.160 Test Loss: 3.272 Test Acc: 0.160
Validation loss decreased (-0.154085 --> -0.159967).  Saving model ...
Epoch: 21 cost time: 0.6058378219604492
Epoch: 21, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.285 Vali Acc: 0.160 Test Loss: 3.285 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5811598300933838
Epoch: 22, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.302 Vali Acc: 0.166 Test Loss: 3.302 Test Acc: 0.166
Validation loss decreased (-0.159967 --> -0.165849).  Saving model ...
Epoch: 23 cost time: 0.5034470558166504
Epoch: 23, Steps: 10 | Train Loss: 1.331 Vali Loss: 3.319 Vali Acc: 0.178 Test Loss: 3.319 Test Acc: 0.178
Validation loss decreased (-0.165849 --> -0.177614).  Saving model ...
Epoch: 24 cost time: 0.5496964454650879
Epoch: 24, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.344 Vali Acc: 0.178 Test Loss: 3.344 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4899251461029053
Epoch: 25, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.363 Vali Acc: 0.187 Test Loss: 3.363 Test Acc: 0.187
Validation loss decreased (-0.177614 --> -0.187025).  Saving model ...
Epoch: 26 cost time: 0.5099260807037354
Epoch: 26, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.388 Vali Acc: 0.188 Test Loss: 3.388 Test Acc: 0.188
Validation loss decreased (-0.187025 --> -0.188201).  Saving model ...
Epoch: 27 cost time: 0.5204372406005859
Epoch: 27, Steps: 10 | Train Loss: 1.029 Vali Loss: 3.413 Vali Acc: 0.191 Test Loss: 3.413 Test Acc: 0.191
Validation loss decreased (-0.188201 --> -0.190554).  Saving model ...
Epoch: 28 cost time: 0.43665146827697754
Epoch: 28, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.439 Vali Acc: 0.196 Test Loss: 3.439 Test Acc: 0.196
Validation loss decreased (-0.190554 --> -0.196436).  Saving model ...
Epoch: 29 cost time: 0.4737429618835449
Epoch: 29, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.468 Vali Acc: 0.200 Test Loss: 3.468 Test Acc: 0.200
Validation loss decreased (-0.196436 --> -0.199965).  Saving model ...
Epoch: 30 cost time: 0.6081268787384033
Epoch: 30, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.499 Vali Acc: 0.196 Test Loss: 3.499 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5086157321929932
Epoch: 31, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.527 Vali Acc: 0.200 Test Loss: 3.527 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.48928356170654297
Epoch: 32, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.554 Vali Acc: 0.202 Test Loss: 3.554 Test Acc: 0.202
Validation loss decreased (-0.199965 --> -0.202317).  Saving model ...
Epoch: 33 cost time: 0.546288013458252
Epoch: 33, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.588 Vali Acc: 0.207 Test Loss: 3.588 Test Acc: 0.207
Validation loss decreased (-0.202317 --> -0.207023).  Saving model ...
Epoch: 34 cost time: 0.5941638946533203
Epoch: 34, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.621 Vali Acc: 0.208 Test Loss: 3.621 Test Acc: 0.208
Validation loss decreased (-0.207023 --> -0.208199).  Saving model ...
Epoch: 35 cost time: 0.5871601104736328
Epoch: 35, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.656 Vali Acc: 0.205 Test Loss: 3.656 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5595362186431885
Epoch: 36, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.688 Vali Acc: 0.204 Test Loss: 3.688 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6093897819519043
Epoch: 37, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.731 Vali Acc: 0.201 Test Loss: 3.731 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5443532466888428
Epoch: 38, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.760 Vali Acc: 0.206 Test Loss: 3.760 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5581471920013428
Epoch: 39, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.799 Vali Acc: 0.206 Test Loss: 3.799 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5938050746917725
Epoch: 40, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.830 Vali Acc: 0.202 Test Loss: 3.830 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5217835903167725
Epoch: 41, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.871 Vali Acc: 0.204 Test Loss: 3.871 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6134252548217773
Epoch: 42, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.903 Vali Acc: 0.207 Test Loss: 3.903 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5251495838165283
Epoch: 43, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.926 Vali Acc: 0.204 Test Loss: 3.926 Test Acc: 0.204
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5938849449157715
Epoch: 44, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.958 Vali Acc: 0.208 Test Loss: 3.958 Test Acc: 0.208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_LightTS_UEA_ftM_sl152_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20823529411764705
model parameter : 37278
model size : 0.15MB
