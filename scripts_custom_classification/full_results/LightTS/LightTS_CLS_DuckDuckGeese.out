Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3696606159210205
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.600 Vali Acc: 0.380 Test Loss: 1.600 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 0.9076271057128906
Epoch: 2, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.551 Vali Acc: 0.380 Test Loss: 1.551 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 0.9768848419189453
Epoch: 3, Steps: 4 | Train Loss: 0.749 Vali Loss: 1.715 Vali Acc: 0.440 Test Loss: 1.715 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439983).  Saving model ...
Epoch: 4 cost time: 1.080495834350586
Epoch: 4, Steps: 4 | Train Loss: 0.435 Vali Loss: 1.745 Vali Acc: 0.540 Test Loss: 1.745 Test Acc: 0.540
Validation loss decreased (-0.439983 --> -0.539983).  Saving model ...
Epoch: 5 cost time: 0.9940426349639893
Epoch: 5, Steps: 4 | Train Loss: 0.185 Vali Loss: 2.212 Vali Acc: 0.500 Test Loss: 2.212 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.953704833984375
Epoch: 6, Steps: 4 | Train Loss: 0.039 Vali Loss: 3.366 Vali Acc: 0.500 Test Loss: 3.366 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0576481819152832
Epoch: 7, Steps: 4 | Train Loss: 0.322 Vali Loss: 3.540 Vali Acc: 0.480 Test Loss: 3.540 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9231555461883545
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.184 Vali Acc: 0.420 Test Loss: 3.184 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9770851135253906
Epoch: 9, Steps: 4 | Train Loss: 0.041 Vali Loss: 3.972 Vali Acc: 0.500 Test Loss: 3.972 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9911870956420898
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.524 Vali Acc: 0.460 Test Loss: 5.524 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8964266777038574
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.458 Vali Acc: 0.460 Test Loss: 5.458 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9687252044677734
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.175 Vali Acc: 0.460 Test Loss: 5.175 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9683952331542969
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.006 Vali Acc: 0.480 Test Loss: 5.006 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9619953632354736
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.927 Vali Acc: 0.460 Test Loss: 4.927 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3850623
model size : 14.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6821000576019287
Epoch: 1, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.603 Vali Acc: 0.300 Test Loss: 1.603 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.011108160018921
Epoch: 2, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.755 Vali Acc: 0.360 Test Loss: 1.755 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359982).  Saving model ...
Epoch: 3 cost time: 0.9998385906219482
Epoch: 3, Steps: 4 | Train Loss: 0.524 Vali Loss: 2.060 Vali Acc: 0.380 Test Loss: 2.060 Test Acc: 0.380
Validation loss decreased (-0.359982 --> -0.379979).  Saving model ...
Epoch: 4 cost time: 1.1369385719299316
Epoch: 4, Steps: 4 | Train Loss: 0.391 Vali Loss: 2.268 Vali Acc: 0.460 Test Loss: 2.268 Test Acc: 0.460
Validation loss decreased (-0.379979 --> -0.459977).  Saving model ...
Epoch: 5 cost time: 1.1120429039001465
Epoch: 5, Steps: 4 | Train Loss: 0.125 Vali Loss: 3.114 Vali Acc: 0.440 Test Loss: 3.114 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1987380981445312
Epoch: 6, Steps: 4 | Train Loss: 0.092 Vali Loss: 3.659 Vali Acc: 0.460 Test Loss: 3.659 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1032483577728271
Epoch: 7, Steps: 4 | Train Loss: 0.225 Vali Loss: 3.897 Vali Acc: 0.480 Test Loss: 3.897 Test Acc: 0.480
Validation loss decreased (-0.459977 --> -0.479961).  Saving model ...
Epoch: 8 cost time: 0.9854226112365723
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.758 Vali Acc: 0.460 Test Loss: 3.758 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0714139938354492
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.557 Vali Acc: 0.440 Test Loss: 4.557 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0493924617767334
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.554 Vali Acc: 0.460 Test Loss: 5.554 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0215792655944824
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.318 Vali Acc: 0.460 Test Loss: 6.318 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0197904109954834
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.811 Vali Acc: 0.460 Test Loss: 6.811 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2833900451660156
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.054 Vali Acc: 0.460 Test Loss: 7.054 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9900829792022705
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.121 Vali Acc: 0.460 Test Loss: 7.121 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0330302715301514
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.059 Vali Acc: 0.460 Test Loss: 7.059 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1042559146881104
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.953 Vali Acc: 0.460 Test Loss: 6.953 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.120434045791626
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.838 Vali Acc: 0.460 Test Loss: 6.838 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3839117
model size : 14.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.336421012878418
Epoch: 1, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.495 Vali Acc: 0.320 Test Loss: 1.495 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.135638952255249
Epoch: 2, Steps: 4 | Train Loss: 1.168 Vali Loss: 1.444 Vali Acc: 0.420 Test Loss: 1.444 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419986).  Saving model ...
Epoch: 3 cost time: 0.9739422798156738
Epoch: 3, Steps: 4 | Train Loss: 0.602 Vali Loss: 1.557 Vali Acc: 0.460 Test Loss: 1.557 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459984).  Saving model ...
Epoch: 4 cost time: 0.9225220680236816
Epoch: 4, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.966 Vali Acc: 0.500 Test Loss: 1.966 Test Acc: 0.500
Validation loss decreased (-0.459984 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 1.0600998401641846
Epoch: 5, Steps: 4 | Train Loss: 0.151 Vali Loss: 2.359 Vali Acc: 0.440 Test Loss: 2.359 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0879201889038086
Epoch: 6, Steps: 4 | Train Loss: 0.059 Vali Loss: 3.070 Vali Acc: 0.480 Test Loss: 3.070 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0825319290161133
Epoch: 7, Steps: 4 | Train Loss: 0.020 Vali Loss: 3.544 Vali Acc: 0.480 Test Loss: 3.544 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0101523399353027
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.240 Vali Acc: 0.480 Test Loss: 4.240 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.262972116470337
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.998 Vali Acc: 0.460 Test Loss: 4.998 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1274490356445312
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.419 Vali Acc: 0.460 Test Loss: 5.419 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.170145034790039
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.498 Vali Acc: 0.480 Test Loss: 5.498 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1268489360809326
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.532 Vali Acc: 0.480 Test Loss: 5.532 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1278607845306396
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.562 Vali Acc: 0.460 Test Loss: 5.562 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1990079879760742
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.613 Vali Acc: 0.460 Test Loss: 5.613 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3834043
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3582682609558105
Epoch: 1, Steps: 4 | Train Loss: 1.635 Vali Loss: 1.539 Vali Acc: 0.280 Test Loss: 1.539 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 0.9723048210144043
Epoch: 2, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.581 Vali Acc: 0.380 Test Loss: 1.581 Test Acc: 0.380
Validation loss decreased (-0.279985 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 0.8984014987945557
Epoch: 3, Steps: 4 | Train Loss: 0.524 Vali Loss: 1.497 Vali Acc: 0.420 Test Loss: 1.497 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 0.9163799285888672
Epoch: 4, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.959 Vali Acc: 0.500 Test Loss: 1.959 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 0.930305004119873
Epoch: 5, Steps: 4 | Train Loss: 0.111 Vali Loss: 2.443 Vali Acc: 0.480 Test Loss: 2.443 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7717697620391846
Epoch: 6, Steps: 4 | Train Loss: 0.052 Vali Loss: 2.383 Vali Acc: 0.520 Test Loss: 2.383 Test Acc: 0.520
Validation loss decreased (-0.499980 --> -0.519976).  Saving model ...
Epoch: 7 cost time: 0.8655920028686523
Epoch: 7, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.173 Vali Acc: 0.500 Test Loss: 3.173 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1104061603546143
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.773 Vali Acc: 0.460 Test Loss: 3.773 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.922572135925293
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.963 Vali Acc: 0.460 Test Loss: 3.963 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7990210056304932
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.088 Vali Acc: 0.500 Test Loss: 4.088 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8833808898925781
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.272 Vali Acc: 0.480 Test Loss: 4.272 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.843250036239624
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.422 Vali Acc: 0.480 Test Loss: 4.422 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9813480377197266
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.526 Vali Acc: 0.480 Test Loss: 4.526 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7761068344116211
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.582 Vali Acc: 0.500 Test Loss: 4.582 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.940319299697876
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.610 Vali Acc: 0.500 Test Loss: 4.610 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9062936305999756
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.623 Vali Acc: 0.500 Test Loss: 4.623 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3829941
model size : 14.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2019829750061035
Epoch: 1, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.542 Vali Acc: 0.280 Test Loss: 1.542 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 0.9251484870910645
Epoch: 2, Steps: 4 | Train Loss: 1.123 Vali Loss: 1.602 Vali Acc: 0.400 Test Loss: 1.602 Test Acc: 0.400
Validation loss decreased (-0.279985 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.90061354637146
Epoch: 3, Steps: 4 | Train Loss: 0.588 Vali Loss: 2.063 Vali Acc: 0.440 Test Loss: 2.063 Test Acc: 0.440
Validation loss decreased (-0.399984 --> -0.439979).  Saving model ...
Epoch: 4 cost time: 0.9790694713592529
Epoch: 4, Steps: 4 | Train Loss: 0.254 Vali Loss: 2.186 Vali Acc: 0.460 Test Loss: 2.186 Test Acc: 0.460
Validation loss decreased (-0.439979 --> -0.459978).  Saving model ...
Epoch: 5 cost time: 0.9682879447937012
Epoch: 5, Steps: 4 | Train Loss: 0.146 Vali Loss: 2.706 Vali Acc: 0.460 Test Loss: 2.706 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8443484306335449
Epoch: 6, Steps: 4 | Train Loss: 0.178 Vali Loss: 3.303 Vali Acc: 0.480 Test Loss: 3.303 Test Acc: 0.480
Validation loss decreased (-0.459978 --> -0.479967).  Saving model ...
Epoch: 7 cost time: 0.8815085887908936
Epoch: 7, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.184 Vali Acc: 0.460 Test Loss: 3.184 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8887028694152832
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.002 Vali Acc: 0.460 Test Loss: 5.002 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9175653457641602
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.029 Vali Acc: 0.440 Test Loss: 6.029 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9980649948120117
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.380 Vali Acc: 0.400 Test Loss: 6.380 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0857951641082764
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.510 Vali Acc: 0.420 Test Loss: 6.510 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9563581943511963
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.587 Vali Acc: 0.420 Test Loss: 6.587 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9386913776397705
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.633 Vali Acc: 0.420 Test Loss: 6.633 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8002393245697021
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.654 Vali Acc: 0.420 Test Loss: 6.654 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9766533374786377
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.680 Vali Acc: 0.420 Test Loss: 6.680 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9343152046203613
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.701 Vali Acc: 0.420 Test Loss: 6.701 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3827663
model size : 14.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5005738735198975
Epoch: 1, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.556 Vali Acc: 0.240 Test Loss: 1.556 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 0.9993960857391357
Epoch: 2, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.667 Vali Acc: 0.360 Test Loss: 1.667 Test Acc: 0.360
Validation loss decreased (-0.239984 --> -0.359983).  Saving model ...
Epoch: 3 cost time: 1.048466444015503
Epoch: 3, Steps: 4 | Train Loss: 0.595 Vali Loss: 1.844 Vali Acc: 0.440 Test Loss: 1.844 Test Acc: 0.440
Validation loss decreased (-0.359983 --> -0.439982).  Saving model ...
Epoch: 4 cost time: 1.0959422588348389
Epoch: 4, Steps: 4 | Train Loss: 0.288 Vali Loss: 2.058 Vali Acc: 0.520 Test Loss: 2.058 Test Acc: 0.520
Validation loss decreased (-0.439982 --> -0.519979).  Saving model ...
Epoch: 5 cost time: 1.2371060848236084
Epoch: 5, Steps: 4 | Train Loss: 0.124 Vali Loss: 2.405 Vali Acc: 0.540 Test Loss: 2.405 Test Acc: 0.540
Validation loss decreased (-0.519979 --> -0.539976).  Saving model ...
Epoch: 6 cost time: 1.1178021430969238
Epoch: 6, Steps: 4 | Train Loss: 0.051 Vali Loss: 3.205 Vali Acc: 0.540 Test Loss: 3.205 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0698165893554688
Epoch: 7, Steps: 4 | Train Loss: 0.031 Vali Loss: 3.796 Vali Acc: 0.500 Test Loss: 3.796 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.038041114807129
Epoch: 8, Steps: 4 | Train Loss: 0.014 Vali Loss: 5.106 Vali Acc: 0.460 Test Loss: 5.106 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1024401187896729
Epoch: 9, Steps: 4 | Train Loss: 0.015 Vali Loss: 4.760 Vali Acc: 0.460 Test Loss: 4.760 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9539220333099365
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 5.131 Vali Acc: 0.480 Test Loss: 5.131 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9753801822662354
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.633 Vali Acc: 0.440 Test Loss: 6.633 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0246219635009766
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 7.334 Vali Acc: 0.420 Test Loss: 7.334 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9960289001464844
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.379 Vali Acc: 0.440 Test Loss: 7.379 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9411225318908691
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.579 Vali Acc: 0.440 Test Loss: 7.579 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9803154468536377
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.892 Vali Acc: 0.340 Test Loss: 7.892 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3826967
model size : 14.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3015096187591553
Epoch: 1, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.662 Vali Acc: 0.280 Test Loss: 1.662 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 1.0853471755981445
Epoch: 2, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.951 Vali Acc: 0.360 Test Loss: 1.951 Test Acc: 0.360
Validation loss decreased (-0.279983 --> -0.359980).  Saving model ...
Epoch: 3 cost time: 1.055393934249878
Epoch: 3, Steps: 4 | Train Loss: 0.873 Vali Loss: 1.585 Vali Acc: 0.440 Test Loss: 1.585 Test Acc: 0.440
Validation loss decreased (-0.359980 --> -0.439984).  Saving model ...
Epoch: 4 cost time: 0.9910027980804443
Epoch: 4, Steps: 4 | Train Loss: 0.295 Vali Loss: 2.101 Vali Acc: 0.480 Test Loss: 2.101 Test Acc: 0.480
Validation loss decreased (-0.439984 --> -0.479979).  Saving model ...
Epoch: 5 cost time: 1.1609203815460205
Epoch: 5, Steps: 4 | Train Loss: 0.126 Vali Loss: 2.502 Vali Acc: 0.460 Test Loss: 2.502 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1385443210601807
Epoch: 6, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.762 Vali Acc: 0.520 Test Loss: 2.762 Test Acc: 0.520
Validation loss decreased (-0.479979 --> -0.519972).  Saving model ...
Epoch: 7 cost time: 0.9901518821716309
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.849 Vali Acc: 0.440 Test Loss: 3.849 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0891072750091553
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.514 Vali Acc: 0.480 Test Loss: 4.514 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1464338302612305
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.374 Vali Acc: 0.540 Test Loss: 4.374 Test Acc: 0.540
Validation loss decreased (-0.519972 --> -0.539956).  Saving model ...
Epoch: 10 cost time: 1.1036241054534912
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.595 Vali Acc: 0.440 Test Loss: 4.595 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1420586109161377
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.727 Vali Acc: 0.440 Test Loss: 4.727 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0893311500549316
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.141 Vali Acc: 0.460 Test Loss: 5.141 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.069272518157959
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.509 Vali Acc: 0.420 Test Loss: 5.509 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0121066570281982
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.742 Vali Acc: 0.400 Test Loss: 5.742 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1665277481079102
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.836 Vali Acc: 0.400 Test Loss: 5.836 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0979530811309814
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.862 Vali Acc: 0.400 Test Loss: 5.862 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1621601581573486
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.837 Vali Acc: 0.400 Test Loss: 5.837 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0683174133300781
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.776 Vali Acc: 0.400 Test Loss: 5.776 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0120134353637695
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.716 Vali Acc: 0.400 Test Loss: 5.716 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3825451
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.268733263015747
Epoch: 1, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.467 Vali Acc: 0.260 Test Loss: 1.467 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 0.9438092708587646
Epoch: 2, Steps: 4 | Train Loss: 1.094 Vali Loss: 1.540 Vali Acc: 0.380 Test Loss: 1.540 Test Acc: 0.380
Validation loss decreased (-0.259985 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.0184383392333984
Epoch: 3, Steps: 4 | Train Loss: 0.629 Vali Loss: 2.137 Vali Acc: 0.400 Test Loss: 2.137 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399979).  Saving model ...
Epoch: 4 cost time: 1.043877124786377
Epoch: 4, Steps: 4 | Train Loss: 0.308 Vali Loss: 2.449 Vali Acc: 0.460 Test Loss: 2.449 Test Acc: 0.460
Validation loss decreased (-0.399979 --> -0.459976).  Saving model ...
Epoch: 5 cost time: 0.9339306354522705
Epoch: 5, Steps: 4 | Train Loss: 0.146 Vali Loss: 2.699 Vali Acc: 0.360 Test Loss: 2.699 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8235874176025391
Epoch: 6, Steps: 4 | Train Loss: 0.064 Vali Loss: 3.300 Vali Acc: 0.420 Test Loss: 3.300 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8593194484710693
Epoch: 7, Steps: 4 | Train Loss: 0.018 Vali Loss: 4.462 Vali Acc: 0.400 Test Loss: 4.462 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8537518978118896
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.052 Vali Acc: 0.400 Test Loss: 5.052 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9664883613586426
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.377 Vali Acc: 0.400 Test Loss: 5.377 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8805191516876221
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.555 Vali Acc: 0.420 Test Loss: 5.555 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0552809238433838
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.676 Vali Acc: 0.420 Test Loss: 5.676 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9578988552093506
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.772 Vali Acc: 0.460 Test Loss: 5.772 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.037506103515625
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.859 Vali Acc: 0.460 Test Loss: 5.859 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9467480182647705
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.927 Vali Acc: 0.440 Test Loss: 5.927 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3823925
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.32555890083313
Epoch: 1, Steps: 4 | Train Loss: 1.711 Vali Loss: 1.682 Vali Acc: 0.380 Test Loss: 1.682 Test Acc: 0.380
Validation loss decreased (inf --> -0.379983).  Saving model ...
Epoch: 2 cost time: 1.0488646030426025
Epoch: 2, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.546 Vali Acc: 0.380 Test Loss: 1.546 Test Acc: 0.380
Validation loss decreased (-0.379983 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.0192461013793945
Epoch: 3, Steps: 4 | Train Loss: 0.556 Vali Loss: 1.708 Vali Acc: 0.460 Test Loss: 1.708 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459983).  Saving model ...
Epoch: 4 cost time: 0.9318487644195557
Epoch: 4, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.903 Vali Acc: 0.520 Test Loss: 1.903 Test Acc: 0.520
Validation loss decreased (-0.459983 --> -0.519981).  Saving model ...
Epoch: 5 cost time: 0.996833086013794
Epoch: 5, Steps: 4 | Train Loss: 0.102 Vali Loss: 2.207 Vali Acc: 0.500 Test Loss: 2.207 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9260411262512207
Epoch: 6, Steps: 4 | Train Loss: 0.036 Vali Loss: 2.428 Vali Acc: 0.500 Test Loss: 2.428 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8966939449310303
Epoch: 7, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.391 Vali Acc: 0.500 Test Loss: 3.391 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8670859336853027
Epoch: 8, Steps: 4 | Train Loss: 0.105 Vali Loss: 3.872 Vali Acc: 0.520 Test Loss: 3.872 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9301891326904297
Epoch: 9, Steps: 4 | Train Loss: 0.048 Vali Loss: 3.065 Vali Acc: 0.500 Test Loss: 3.065 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9573366641998291
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.539 Vali Acc: 0.500 Test Loss: 3.539 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.886030912399292
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.357 Vali Acc: 0.420 Test Loss: 4.357 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.956092119216919
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.050 Vali Acc: 0.380 Test Loss: 5.050 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9547278881072998
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.427 Vali Acc: 0.380 Test Loss: 5.427 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9693782329559326
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.578 Vali Acc: 0.380 Test Loss: 5.578 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3823199
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.655869722366333
Epoch: 1, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.628 Vali Acc: 0.360 Test Loss: 1.628 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 1.0117754936218262
Epoch: 2, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.683 Vali Acc: 0.360 Test Loss: 1.683 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.016791582107544
Epoch: 3, Steps: 4 | Train Loss: 0.616 Vali Loss: 1.619 Vali Acc: 0.480 Test Loss: 1.619 Test Acc: 0.480
Validation loss decreased (-0.359984 --> -0.479984).  Saving model ...
Epoch: 4 cost time: 0.8973264694213867
Epoch: 4, Steps: 4 | Train Loss: 0.334 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 1.0064003467559814
Epoch: 5, Steps: 4 | Train Loss: 0.139 Vali Loss: 2.331 Vali Acc: 0.500 Test Loss: 2.331 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1593329906463623
Epoch: 6, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.656 Vali Acc: 0.540 Test Loss: 2.656 Test Acc: 0.540
Validation loss decreased (-0.499979 --> -0.539973).  Saving model ...
Epoch: 7 cost time: 0.910912275314331
Epoch: 7, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.152 Vali Acc: 0.480 Test Loss: 3.152 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0849673748016357
Epoch: 8, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.631 Vali Acc: 0.460 Test Loss: 3.631 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0689952373504639
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.333 Vali Acc: 0.480 Test Loss: 4.333 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9457073211669922
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.556 Vali Acc: 0.500 Test Loss: 4.556 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9583969116210938
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.458 Vali Acc: 0.420 Test Loss: 4.458 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0526983737945557
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.503 Vali Acc: 0.440 Test Loss: 4.503 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0658066272735596
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.709 Vali Acc: 0.460 Test Loss: 4.709 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0232608318328857
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.996 Vali Acc: 0.500 Test Loss: 4.996 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9474120140075684
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.303 Vali Acc: 0.500 Test Loss: 5.303 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9618353843688965
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.508 Vali Acc: 0.500 Test Loss: 5.508 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3824083
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.222817897796631
Epoch: 1, Steps: 4 | Train Loss: 1.729 Vali Loss: 1.681 Vali Acc: 0.280 Test Loss: 1.681 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 0.9566559791564941
Epoch: 2, Steps: 4 | Train Loss: 1.183 Vali Loss: 2.087 Vali Acc: 0.400 Test Loss: 2.087 Test Acc: 0.400
Validation loss decreased (-0.279983 --> -0.399979).  Saving model ...
Epoch: 3 cost time: 0.9790663719177246
Epoch: 3, Steps: 4 | Train Loss: 0.561 Vali Loss: 1.842 Vali Acc: 0.460 Test Loss: 1.842 Test Acc: 0.460
Validation loss decreased (-0.399979 --> -0.459982).  Saving model ...
Epoch: 4 cost time: 0.9921584129333496
Epoch: 4, Steps: 4 | Train Loss: 0.268 Vali Loss: 3.107 Vali Acc: 0.440 Test Loss: 3.107 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0453362464904785
Epoch: 5, Steps: 4 | Train Loss: 0.215 Vali Loss: 3.103 Vali Acc: 0.460 Test Loss: 3.103 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9215221405029297
Epoch: 6, Steps: 4 | Train Loss: 0.122 Vali Loss: 2.930 Vali Acc: 0.480 Test Loss: 2.930 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479971).  Saving model ...
Epoch: 7 cost time: 1.0382716655731201
Epoch: 7, Steps: 4 | Train Loss: 0.028 Vali Loss: 3.922 Vali Acc: 0.440 Test Loss: 3.922 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9207248687744141
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.262 Vali Acc: 0.460 Test Loss: 4.262 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0154976844787598
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.968 Vali Acc: 0.440 Test Loss: 3.968 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9407360553741455
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.962 Vali Acc: 0.440 Test Loss: 3.962 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1218082904815674
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.131 Vali Acc: 0.460 Test Loss: 4.131 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9069924354553223
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.349 Vali Acc: 0.420 Test Loss: 4.349 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0492558479309082
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.540 Vali Acc: 0.420 Test Loss: 4.540 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9494476318359375
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.687 Vali Acc: 0.440 Test Loss: 4.687 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9610781669616699
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.793 Vali Acc: 0.420 Test Loss: 4.793 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1089255809783936
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.856 Vali Acc: 0.420 Test Loss: 4.856 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3823891
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.222860813140869
Epoch: 1, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.664 Vali Acc: 0.340 Test Loss: 1.664 Test Acc: 0.340
Validation loss decreased (inf --> -0.339983).  Saving model ...
Epoch: 2 cost time: 1.0965523719787598
Epoch: 2, Steps: 4 | Train Loss: 1.089 Vali Loss: 1.720 Vali Acc: 0.340 Test Loss: 1.720 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1343367099761963
Epoch: 3, Steps: 4 | Train Loss: 0.617 Vali Loss: 1.948 Vali Acc: 0.420 Test Loss: 1.948 Test Acc: 0.420
Validation loss decreased (-0.339983 --> -0.419981).  Saving model ...
Epoch: 4 cost time: 0.9812657833099365
Epoch: 4, Steps: 4 | Train Loss: 0.578 Vali Loss: 2.283 Vali Acc: 0.500 Test Loss: 2.283 Test Acc: 0.500
Validation loss decreased (-0.419981 --> -0.499977).  Saving model ...
Epoch: 5 cost time: 1.0336582660675049
Epoch: 5, Steps: 4 | Train Loss: 0.192 Vali Loss: 3.624 Vali Acc: 0.460 Test Loss: 3.624 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9750669002532959
Epoch: 6, Steps: 4 | Train Loss: 0.110 Vali Loss: 3.367 Vali Acc: 0.440 Test Loss: 3.367 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0529022216796875
Epoch: 7, Steps: 4 | Train Loss: 0.113 Vali Loss: 3.705 Vali Acc: 0.460 Test Loss: 3.705 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.022282361984253
Epoch: 8, Steps: 4 | Train Loss: 0.033 Vali Loss: 5.217 Vali Acc: 0.400 Test Loss: 5.217 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.071822166442871
Epoch: 9, Steps: 4 | Train Loss: 0.018 Vali Loss: 5.767 Vali Acc: 0.420 Test Loss: 5.767 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.893660306930542
Epoch: 10, Steps: 4 | Train Loss: 0.076 Vali Loss: 5.123 Vali Acc: 0.460 Test Loss: 5.123 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.844611406326294
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.239 Vali Acc: 0.420 Test Loss: 5.239 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.952812910079956
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.389 Vali Acc: 0.440 Test Loss: 5.389 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9534919261932373
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.694 Vali Acc: 0.400 Test Loss: 5.694 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.143355369567871
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.744 Vali Acc: 0.380 Test Loss: 5.744 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3822623
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.228646993637085
Epoch: 1, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.591 Vali Acc: 0.300 Test Loss: 1.591 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.1095294952392578
Epoch: 2, Steps: 4 | Train Loss: 1.353 Vali Loss: 1.685 Vali Acc: 0.300 Test Loss: 1.685 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0686028003692627
Epoch: 3, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.826 Vali Acc: 0.380 Test Loss: 1.826 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379982).  Saving model ...
Epoch: 4 cost time: 1.0617265701293945
Epoch: 4, Steps: 4 | Train Loss: 0.543 Vali Loss: 2.177 Vali Acc: 0.420 Test Loss: 2.177 Test Acc: 0.420
Validation loss decreased (-0.379982 --> -0.419978).  Saving model ...
Epoch: 5 cost time: 1.135380744934082
Epoch: 5, Steps: 4 | Train Loss: 0.150 Vali Loss: 2.602 Vali Acc: 0.520 Test Loss: 2.602 Test Acc: 0.520
Validation loss decreased (-0.419978 --> -0.519974).  Saving model ...
Epoch: 6 cost time: 1.1851592063903809
Epoch: 6, Steps: 4 | Train Loss: 0.040 Vali Loss: 3.955 Vali Acc: 0.400 Test Loss: 3.955 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.063356637954712
Epoch: 7, Steps: 4 | Train Loss: 0.021 Vali Loss: 4.470 Vali Acc: 0.440 Test Loss: 4.470 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9876258373260498
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.360 Vali Acc: 0.460 Test Loss: 4.360 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.207282304763794
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.426 Vali Acc: 0.480 Test Loss: 4.426 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9777271747589111
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.451 Vali Acc: 0.460 Test Loss: 4.451 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9589862823486328
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.456 Vali Acc: 0.400 Test Loss: 4.456 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1341614723205566
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.503 Vali Acc: 0.420 Test Loss: 4.503 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0229136943817139
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.577 Vali Acc: 0.420 Test Loss: 4.577 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.132631540298462
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.669 Vali Acc: 0.440 Test Loss: 4.669 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0916085243225098
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.768 Vali Acc: 0.440 Test Loss: 4.768 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3824315
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.363605260848999
Epoch: 1, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.723 Vali Acc: 0.260 Test Loss: 1.723 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 0.9938347339630127
Epoch: 2, Steps: 4 | Train Loss: 0.999 Vali Loss: 1.719 Vali Acc: 0.380 Test Loss: 1.719 Test Acc: 0.380
Validation loss decreased (-0.259983 --> -0.379983).  Saving model ...
Epoch: 3 cost time: 1.0714287757873535
Epoch: 3, Steps: 4 | Train Loss: 0.555 Vali Loss: 1.682 Vali Acc: 0.380 Test Loss: 1.682 Test Acc: 0.380
Validation loss decreased (-0.379983 --> -0.379983).  Saving model ...
Epoch: 4 cost time: 1.0953307151794434
Epoch: 4, Steps: 4 | Train Loss: 0.240 Vali Loss: 2.175 Vali Acc: 0.440 Test Loss: 2.175 Test Acc: 0.440
Validation loss decreased (-0.379983 --> -0.439978).  Saving model ...
Epoch: 5 cost time: 1.0171535015106201
Epoch: 5, Steps: 4 | Train Loss: 0.092 Vali Loss: 2.985 Vali Acc: 0.460 Test Loss: 2.985 Test Acc: 0.460
Validation loss decreased (-0.439978 --> -0.459970).  Saving model ...
Epoch: 6 cost time: 0.930828332901001
Epoch: 6, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.894 Vali Acc: 0.440 Test Loss: 3.894 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8905782699584961
Epoch: 7, Steps: 4 | Train Loss: 0.066 Vali Loss: 3.617 Vali Acc: 0.480 Test Loss: 3.617 Test Acc: 0.480
Validation loss decreased (-0.459970 --> -0.479964).  Saving model ...
Epoch: 8 cost time: 1.0942997932434082
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.667 Vali Acc: 0.420 Test Loss: 3.667 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0245704650878906
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.255 Vali Acc: 0.440 Test Loss: 4.255 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0801610946655273
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.024 Vali Acc: 0.460 Test Loss: 5.024 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9315280914306641
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.559 Vali Acc: 0.460 Test Loss: 5.559 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2322185039520264
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.679 Vali Acc: 0.420 Test Loss: 5.679 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0475900173187256
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.642 Vali Acc: 0.420 Test Loss: 5.642 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9447507858276367
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.569 Vali Acc: 0.420 Test Loss: 5.569 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0320005416870117
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.505 Vali Acc: 0.420 Test Loss: 5.505 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.106949806213379
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.453 Vali Acc: 0.440 Test Loss: 5.453 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0912764072418213
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.412 Vali Acc: 0.440 Test Loss: 5.412 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3821165
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3865225315093994
Epoch: 1, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.590 Vali Acc: 0.280 Test Loss: 1.590 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1646842956542969
Epoch: 2, Steps: 4 | Train Loss: 1.402 Vali Loss: 1.635 Vali Acc: 0.360 Test Loss: 1.635 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 1.11049485206604
Epoch: 3, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.736 Vali Acc: 0.380 Test Loss: 1.736 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379983).  Saving model ...
Epoch: 4 cost time: 1.0396690368652344
Epoch: 4, Steps: 4 | Train Loss: 0.373 Vali Loss: 1.945 Vali Acc: 0.480 Test Loss: 1.945 Test Acc: 0.480
Validation loss decreased (-0.379983 --> -0.479981).  Saving model ...
Epoch: 5 cost time: 1.0772020816802979
Epoch: 5, Steps: 4 | Train Loss: 0.179 Vali Loss: 2.155 Vali Acc: 0.500 Test Loss: 2.155 Test Acc: 0.500
Validation loss decreased (-0.479981 --> -0.499978).  Saving model ...
Epoch: 6 cost time: 0.8309555053710938
Epoch: 6, Steps: 4 | Train Loss: 0.045 Vali Loss: 3.086 Vali Acc: 0.460 Test Loss: 3.086 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9903473854064941
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.553 Vali Acc: 0.460 Test Loss: 3.553 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2131505012512207
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.884 Vali Acc: 0.440 Test Loss: 4.884 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1105735301971436
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.484 Vali Acc: 0.460 Test Loss: 5.484 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.051114559173584
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.704 Vali Acc: 0.440 Test Loss: 5.704 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.068368911743164
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.880 Vali Acc: 0.460 Test Loss: 5.880 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0777349472045898
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.029 Vali Acc: 0.480 Test Loss: 6.029 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0173704624176025
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.174 Vali Acc: 0.480 Test Loss: 6.174 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2016863822937012
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.301 Vali Acc: 0.460 Test Loss: 6.301 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.085906744003296
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.407 Vali Acc: 0.480 Test Loss: 6.407 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3821515
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1870646476745605
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.527 Vali Acc: 0.280 Test Loss: 1.527 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 0.9418044090270996
Epoch: 2, Steps: 4 | Train Loss: 1.119 Vali Loss: 1.607 Vali Acc: 0.380 Test Loss: 1.607 Test Acc: 0.380
Validation loss decreased (-0.279985 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 0.9393608570098877
Epoch: 3, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.665 Vali Acc: 0.560 Test Loss: 1.665 Test Acc: 0.560
Validation loss decreased (-0.379984 --> -0.559983).  Saving model ...
Epoch: 4 cost time: 0.9563179016113281
Epoch: 4, Steps: 4 | Train Loss: 0.249 Vali Loss: 2.779 Vali Acc: 0.520 Test Loss: 2.779 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.086035966873169
Epoch: 5, Steps: 4 | Train Loss: 0.104 Vali Loss: 2.763 Vali Acc: 0.460 Test Loss: 2.763 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.078718662261963
Epoch: 6, Steps: 4 | Train Loss: 0.038 Vali Loss: 2.672 Vali Acc: 0.540 Test Loss: 2.672 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.020864725112915
Epoch: 7, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.483 Vali Acc: 0.480 Test Loss: 3.483 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1902735233306885
Epoch: 8, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.202 Vali Acc: 0.460 Test Loss: 4.202 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2594950199127197
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.443 Vali Acc: 0.480 Test Loss: 4.443 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0649595260620117
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.649 Vali Acc: 0.480 Test Loss: 4.649 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1070621013641357
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.844 Vali Acc: 0.460 Test Loss: 4.844 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1276218891143799
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.053 Vali Acc: 0.460 Test Loss: 5.053 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1149303913116455
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.224 Vali Acc: 0.460 Test Loss: 5.224 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3821329
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.14817214012146
Epoch: 1, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.529 Vali Acc: 0.260 Test Loss: 1.529 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.1442296504974365
Epoch: 2, Steps: 4 | Train Loss: 1.063 Vali Loss: 1.851 Vali Acc: 0.280 Test Loss: 1.851 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279981).  Saving model ...
Epoch: 3 cost time: 1.0303866863250732
Epoch: 3, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.968 Vali Acc: 0.340 Test Loss: 1.968 Test Acc: 0.340
Validation loss decreased (-0.279981 --> -0.339980).  Saving model ...
Epoch: 4 cost time: 1.1600570678710938
Epoch: 4, Steps: 4 | Train Loss: 0.436 Vali Loss: 2.785 Vali Acc: 0.360 Test Loss: 2.785 Test Acc: 0.360
Validation loss decreased (-0.339980 --> -0.359972).  Saving model ...
Epoch: 5 cost time: 1.057262659072876
Epoch: 5, Steps: 4 | Train Loss: 0.194 Vali Loss: 3.391 Vali Acc: 0.380 Test Loss: 3.391 Test Acc: 0.380
Validation loss decreased (-0.359972 --> -0.379966).  Saving model ...
Epoch: 6 cost time: 1.211857795715332
Epoch: 6, Steps: 4 | Train Loss: 0.055 Vali Loss: 3.619 Vali Acc: 0.380 Test Loss: 3.619 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0445904731750488
Epoch: 7, Steps: 4 | Train Loss: 0.027 Vali Loss: 3.735 Vali Acc: 0.420 Test Loss: 3.735 Test Acc: 0.420
Validation loss decreased (-0.379966 --> -0.419963).  Saving model ...
Epoch: 8 cost time: 1.053565263748169
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.118 Vali Acc: 0.380 Test Loss: 5.118 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1646840572357178
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.171 Vali Acc: 0.380 Test Loss: 6.171 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1532325744628906
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.951 Vali Acc: 0.360 Test Loss: 6.951 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0299897193908691
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.561 Vali Acc: 0.400 Test Loss: 7.561 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0647304058074951
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.945 Vali Acc: 0.380 Test Loss: 7.945 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3193044662475586
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.162 Vali Acc: 0.380 Test Loss: 8.162 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1312556266784668
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.261 Vali Acc: 0.380 Test Loss: 8.261 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0680763721466064
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.282 Vali Acc: 0.380 Test Loss: 8.282 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1418817043304443
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.266 Vali Acc: 0.400 Test Loss: 8.266 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0242714881896973
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.226 Vali Acc: 0.400 Test Loss: 8.226 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 3820607
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.444715976715088
Epoch: 1, Steps: 4 | Train Loss: 1.683 Vali Loss: 1.548 Vali Acc: 0.200 Test Loss: 1.548 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.277853012084961
Epoch: 2, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.530 Vali Acc: 0.340 Test Loss: 1.530 Test Acc: 0.340
Validation loss decreased (-0.199985 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.098710536956787
Epoch: 3, Steps: 4 | Train Loss: 0.677 Vali Loss: 1.636 Vali Acc: 0.360 Test Loss: 1.636 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.0658624172210693
Epoch: 4, Steps: 4 | Train Loss: 0.425 Vali Loss: 2.387 Vali Acc: 0.440 Test Loss: 2.387 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439976).  Saving model ...
Epoch: 5 cost time: 1.2065808773040771
Epoch: 5, Steps: 4 | Train Loss: 0.121 Vali Loss: 2.058 Vali Acc: 0.480 Test Loss: 2.058 Test Acc: 0.480
Validation loss decreased (-0.439976 --> -0.479979).  Saving model ...
Epoch: 6 cost time: 1.191742181777954
Epoch: 6, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.719 Vali Acc: 0.520 Test Loss: 2.719 Test Acc: 0.520
Validation loss decreased (-0.479979 --> -0.519973).  Saving model ...
Epoch: 7 cost time: 1.1451904773712158
Epoch: 7, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.406 Vali Acc: 0.440 Test Loss: 3.406 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2123496532440186
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.964 Vali Acc: 0.440 Test Loss: 3.964 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2968497276306152
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.541 Vali Acc: 0.420 Test Loss: 4.541 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1488451957702637
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.959 Vali Acc: 0.460 Test Loss: 4.959 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1417531967163086
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.245 Vali Acc: 0.480 Test Loss: 5.245 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.319603681564331
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.363 Vali Acc: 0.480 Test Loss: 5.363 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.111661434173584
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.411 Vali Acc: 0.480 Test Loss: 5.411 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1252176761627197
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.412 Vali Acc: 0.480 Test Loss: 5.412 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1674809455871582
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.354 Vali Acc: 0.480 Test Loss: 5.354 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0699951648712158
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.309 Vali Acc: 0.480 Test Loss: 5.309 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3823211
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4227209091186523
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.1377193927764893
Epoch: 2, Steps: 4 | Train Loss: 1.056 Vali Loss: 1.863 Vali Acc: 0.360 Test Loss: 1.863 Test Acc: 0.360
Validation loss decreased (-0.219984 --> -0.359981).  Saving model ...
Epoch: 3 cost time: 1.1108810901641846
Epoch: 3, Steps: 4 | Train Loss: 1.049 Vali Loss: 2.027 Vali Acc: 0.380 Test Loss: 2.027 Test Acc: 0.380
Validation loss decreased (-0.359981 --> -0.379980).  Saving model ...
Epoch: 4 cost time: 1.1311955451965332
Epoch: 4, Steps: 4 | Train Loss: 0.298 Vali Loss: 2.566 Vali Acc: 0.520 Test Loss: 2.566 Test Acc: 0.520
Validation loss decreased (-0.379980 --> -0.519974).  Saving model ...
Epoch: 5 cost time: 1.3612957000732422
Epoch: 5, Steps: 4 | Train Loss: 0.186 Vali Loss: 3.042 Vali Acc: 0.400 Test Loss: 3.042 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1967628002166748
Epoch: 6, Steps: 4 | Train Loss: 0.074 Vali Loss: 3.756 Vali Acc: 0.440 Test Loss: 3.756 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2746145725250244
Epoch: 7, Steps: 4 | Train Loss: 0.041 Vali Loss: 4.721 Vali Acc: 0.400 Test Loss: 4.721 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1749155521392822
Epoch: 8, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.149 Vali Acc: 0.420 Test Loss: 5.149 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1186261177062988
Epoch: 9, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.098 Vali Acc: 0.460 Test Loss: 6.098 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0175864696502686
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.145 Vali Acc: 0.460 Test Loss: 7.145 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.182060718536377
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.161 Vali Acc: 0.460 Test Loss: 7.161 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2633605003356934
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.085 Vali Acc: 0.460 Test Loss: 7.085 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1748290061950684
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.001 Vali Acc: 0.480 Test Loss: 7.001 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0673761367797852
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.945 Vali Acc: 0.480 Test Loss: 6.945 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3821151
model size : 14.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0864202976226807
Epoch: 1, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.528 Vali Acc: 0.220 Test Loss: 1.528 Test Acc: 0.220
Validation loss decreased (inf --> -0.219985).  Saving model ...
Epoch: 2 cost time: 0.9011492729187012
Epoch: 2, Steps: 4 | Train Loss: 1.069 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
Validation loss decreased (-0.219985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.8684384822845459
Epoch: 3, Steps: 4 | Train Loss: 0.569 Vali Loss: 2.261 Vali Acc: 0.400 Test Loss: 2.261 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0675959587097168
Epoch: 4, Steps: 4 | Train Loss: 0.399 Vali Loss: 2.469 Vali Acc: 0.480 Test Loss: 2.469 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479975).  Saving model ...
Epoch: 5 cost time: 0.799396276473999
Epoch: 5, Steps: 4 | Train Loss: 0.167 Vali Loss: 2.934 Vali Acc: 0.380 Test Loss: 2.934 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8092930316925049
Epoch: 6, Steps: 4 | Train Loss: 0.111 Vali Loss: 3.376 Vali Acc: 0.460 Test Loss: 3.376 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7626907825469971
Epoch: 7, Steps: 4 | Train Loss: 0.143 Vali Loss: 4.268 Vali Acc: 0.460 Test Loss: 4.268 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8552360534667969
Epoch: 8, Steps: 4 | Train Loss: 0.025 Vali Loss: 5.108 Vali Acc: 0.380 Test Loss: 5.108 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7810657024383545
Epoch: 9, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.632 Vali Acc: 0.400 Test Loss: 5.632 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7656311988830566
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.412 Vali Acc: 0.400 Test Loss: 5.412 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8975307941436768
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.516 Vali Acc: 0.380 Test Loss: 5.516 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8524720668792725
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.029 Vali Acc: 0.400 Test Loss: 6.029 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8705108165740967
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.481 Vali Acc: 0.400 Test Loss: 6.481 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7681620121002197
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.787 Vali Acc: 0.420 Test Loss: 6.787 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3750527
model size : 14.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9336063861846924
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.590 Vali Acc: 0.260 Test Loss: 1.590 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 0.8600144386291504
Epoch: 2, Steps: 4 | Train Loss: 1.258 Vali Loss: 1.944 Vali Acc: 0.340 Test Loss: 1.944 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339981).  Saving model ...
Epoch: 3 cost time: 0.8844161033630371
Epoch: 3, Steps: 4 | Train Loss: 0.756 Vali Loss: 2.241 Vali Acc: 0.340 Test Loss: 2.241 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9644804000854492
Epoch: 4, Steps: 4 | Train Loss: 0.316 Vali Loss: 2.642 Vali Acc: 0.440 Test Loss: 2.642 Test Acc: 0.440
Validation loss decreased (-0.339981 --> -0.439974).  Saving model ...
Epoch: 5 cost time: 0.9595158100128174
Epoch: 5, Steps: 4 | Train Loss: 0.311 Vali Loss: 2.625 Vali Acc: 0.480 Test Loss: 2.625 Test Acc: 0.480
Validation loss decreased (-0.439974 --> -0.479974).  Saving model ...
Epoch: 6 cost time: 0.8597896099090576
Epoch: 6, Steps: 4 | Train Loss: 0.197 Vali Loss: 3.955 Vali Acc: 0.400 Test Loss: 3.955 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.071718454360962
Epoch: 7, Steps: 4 | Train Loss: 0.130 Vali Loss: 3.668 Vali Acc: 0.500 Test Loss: 3.668 Test Acc: 0.500
Validation loss decreased (-0.479974 --> -0.499963).  Saving model ...
Epoch: 8 cost time: 0.9115641117095947
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.684 Vali Acc: 0.440 Test Loss: 3.684 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8287053108215332
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.356 Vali Acc: 0.420 Test Loss: 4.356 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8915657997131348
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.002 Vali Acc: 0.420 Test Loss: 5.002 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8442058563232422
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.455 Vali Acc: 0.400 Test Loss: 5.455 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.818803071975708
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.772 Vali Acc: 0.400 Test Loss: 5.772 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8668103218078613
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.976 Vali Acc: 0.400 Test Loss: 5.976 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9057612419128418
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.086 Vali Acc: 0.420 Test Loss: 6.086 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9030463695526123
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.121 Vali Acc: 0.440 Test Loss: 6.121 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9245755672454834
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.121 Vali Acc: 0.440 Test Loss: 6.121 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.908698558807373
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.099 Vali Acc: 0.420 Test Loss: 6.099 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3744781
model size : 14.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.933809757232666
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.574 Vali Acc: 0.280 Test Loss: 1.574 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.0568969249725342
Epoch: 2, Steps: 4 | Train Loss: 1.201 Vali Loss: 2.035 Vali Acc: 0.380 Test Loss: 2.035 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379980).  Saving model ...
Epoch: 3 cost time: 0.9510023593902588
Epoch: 3, Steps: 4 | Train Loss: 0.662 Vali Loss: 1.941 Vali Acc: 0.320 Test Loss: 1.941 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9199047088623047
Epoch: 4, Steps: 4 | Train Loss: 0.326 Vali Loss: 2.260 Vali Acc: 0.420 Test Loss: 2.260 Test Acc: 0.420
Validation loss decreased (-0.379980 --> -0.419977).  Saving model ...
Epoch: 5 cost time: 1.209886074066162
Epoch: 5, Steps: 4 | Train Loss: 0.179 Vali Loss: 2.698 Vali Acc: 0.420 Test Loss: 2.698 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7960391044616699
Epoch: 6, Steps: 4 | Train Loss: 0.064 Vali Loss: 2.977 Vali Acc: 0.420 Test Loss: 2.977 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9490795135498047
Epoch: 7, Steps: 4 | Train Loss: 0.053 Vali Loss: 3.157 Vali Acc: 0.460 Test Loss: 3.157 Test Acc: 0.460
Validation loss decreased (-0.419977 --> -0.459968).  Saving model ...
Epoch: 8 cost time: 0.9100453853607178
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.923 Vali Acc: 0.440 Test Loss: 3.923 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.068267822265625
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.526 Vali Acc: 0.440 Test Loss: 4.526 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9267385005950928
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.827 Vali Acc: 0.440 Test Loss: 4.827 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1849870681762695
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.095 Vali Acc: 0.360 Test Loss: 5.095 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9360239505767822
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.339 Vali Acc: 0.420 Test Loss: 5.339 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.107365369796753
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.608 Vali Acc: 0.420 Test Loss: 5.608 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9524545669555664
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.826 Vali Acc: 0.440 Test Loss: 5.826 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9719803333282471
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.993 Vali Acc: 0.420 Test Loss: 5.993 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9015583992004395
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.073 Vali Acc: 0.440 Test Loss: 6.073 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9151849746704102
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.117 Vali Acc: 0.440 Test Loss: 6.117 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3742523
model size : 14.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5723042488098145
Epoch: 1, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.505 Vali Acc: 0.360 Test Loss: 1.505 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 0.8836212158203125
Epoch: 2, Steps: 4 | Train Loss: 1.349 Vali Loss: 1.507 Vali Acc: 0.520 Test Loss: 1.507 Test Acc: 0.520
Validation loss decreased (-0.359985 --> -0.519985).  Saving model ...
Epoch: 3 cost time: 0.9018418788909912
Epoch: 3, Steps: 4 | Train Loss: 0.542 Vali Loss: 1.810 Vali Acc: 0.480 Test Loss: 1.810 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.81638503074646
Epoch: 4, Steps: 4 | Train Loss: 0.281 Vali Loss: 2.394 Vali Acc: 0.480 Test Loss: 2.394 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.874535083770752
Epoch: 5, Steps: 4 | Train Loss: 0.155 Vali Loss: 2.561 Vali Acc: 0.440 Test Loss: 2.561 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8061497211456299
Epoch: 6, Steps: 4 | Train Loss: 0.053 Vali Loss: 3.015 Vali Acc: 0.520 Test Loss: 3.015 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9553349018096924
Epoch: 7, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.166 Vali Acc: 0.480 Test Loss: 4.166 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9094629287719727
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.942 Vali Acc: 0.400 Test Loss: 4.942 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8930153846740723
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.177 Vali Acc: 0.440 Test Loss: 5.177 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.866253137588501
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.450 Vali Acc: 0.400 Test Loss: 5.450 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7590029239654541
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.694 Vali Acc: 0.440 Test Loss: 5.694 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.810659646987915
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.985 Vali Acc: 0.440 Test Loss: 5.985 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3740213
model size : 14.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3189051151275635
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.470 Vali Acc: 0.240 Test Loss: 1.470 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 0.935274600982666
Epoch: 2, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.595 Vali Acc: 0.320 Test Loss: 1.595 Test Acc: 0.320
Validation loss decreased (-0.239985 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 0.8245224952697754
Epoch: 3, Steps: 4 | Train Loss: 0.594 Vali Loss: 2.051 Vali Acc: 0.380 Test Loss: 2.051 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379979).  Saving model ...
Epoch: 4 cost time: 0.8736355304718018
Epoch: 4, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.629 Vali Acc: 0.460 Test Loss: 2.629 Test Acc: 0.460
Validation loss decreased (-0.379979 --> -0.459974).  Saving model ...
Epoch: 5 cost time: 0.8722355365753174
Epoch: 5, Steps: 4 | Train Loss: 0.187 Vali Loss: 2.480 Vali Acc: 0.500 Test Loss: 2.480 Test Acc: 0.500
Validation loss decreased (-0.459974 --> -0.499975).  Saving model ...
Epoch: 6 cost time: 0.9514002799987793
Epoch: 6, Steps: 4 | Train Loss: 0.045 Vali Loss: 3.539 Vali Acc: 0.460 Test Loss: 3.539 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8730099201202393
Epoch: 7, Steps: 4 | Train Loss: 0.031 Vali Loss: 3.928 Vali Acc: 0.400 Test Loss: 3.928 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9810192584991455
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.294 Vali Acc: 0.480 Test Loss: 4.294 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9170119762420654
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.958 Vali Acc: 0.460 Test Loss: 4.958 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8474466800689697
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.292 Vali Acc: 0.480 Test Loss: 5.292 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8566985130310059
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.442 Vali Acc: 0.480 Test Loss: 5.442 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.833730936050415
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.524 Vali Acc: 0.440 Test Loss: 5.524 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8939812183380127
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.550 Vali Acc: 0.460 Test Loss: 5.550 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8449656963348389
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.562 Vali Acc: 0.460 Test Loss: 5.562 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8261709213256836
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.563 Vali Acc: 0.480 Test Loss: 5.563 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3739087
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2524209022521973
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.426 Vali Acc: 0.260 Test Loss: 1.426 Test Acc: 0.260
Validation loss decreased (inf --> -0.259986).  Saving model ...
Epoch: 2 cost time: 0.8456165790557861
Epoch: 2, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.547 Vali Acc: 0.440 Test Loss: 1.547 Test Acc: 0.440
Validation loss decreased (-0.259986 --> -0.439985).  Saving model ...
Epoch: 3 cost time: 0.9447371959686279
Epoch: 3, Steps: 4 | Train Loss: 0.831 Vali Loss: 2.017 Vali Acc: 0.440 Test Loss: 2.017 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9146196842193604
Epoch: 4, Steps: 4 | Train Loss: 0.249 Vali Loss: 3.107 Vali Acc: 0.440 Test Loss: 3.107 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0455570220947266
Epoch: 5, Steps: 4 | Train Loss: 0.143 Vali Loss: 3.555 Vali Acc: 0.540 Test Loss: 3.555 Test Acc: 0.540
Validation loss decreased (-0.439985 --> -0.539964).  Saving model ...
Epoch: 6 cost time: 0.8750660419464111
Epoch: 6, Steps: 4 | Train Loss: 0.049 Vali Loss: 4.351 Vali Acc: 0.500 Test Loss: 4.351 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.952143669128418
Epoch: 7, Steps: 4 | Train Loss: 0.019 Vali Loss: 4.896 Vali Acc: 0.460 Test Loss: 4.896 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8772580623626709
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 5.347 Vali Acc: 0.460 Test Loss: 5.347 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.005204439163208
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.432 Vali Acc: 0.480 Test Loss: 5.432 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0635836124420166
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.609 Vali Acc: 0.440 Test Loss: 5.609 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9455468654632568
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.841 Vali Acc: 0.420 Test Loss: 5.841 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9735848903656006
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.077 Vali Acc: 0.440 Test Loss: 6.077 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.008169412612915
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.307 Vali Acc: 0.460 Test Loss: 6.307 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8702630996704102
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.502 Vali Acc: 0.440 Test Loss: 6.502 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8713095188140869
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.657 Vali Acc: 0.440 Test Loss: 6.657 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3739159
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.160085439682007
Epoch: 1, Steps: 4 | Train Loss: 1.846 Vali Loss: 1.635 Vali Acc: 0.320 Test Loss: 1.635 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 0.8889584541320801
Epoch: 2, Steps: 4 | Train Loss: 1.246 Vali Loss: 1.553 Vali Acc: 0.400 Test Loss: 1.553 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.90976881980896
Epoch: 3, Steps: 4 | Train Loss: 0.595 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
Validation loss decreased (-0.399984 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 1.0463142395019531
Epoch: 4, Steps: 4 | Train Loss: 0.239 Vali Loss: 2.108 Vali Acc: 0.480 Test Loss: 2.108 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8416821956634521
Epoch: 5, Steps: 4 | Train Loss: 0.101 Vali Loss: 2.394 Vali Acc: 0.480 Test Loss: 2.394 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0357863903045654
Epoch: 6, Steps: 4 | Train Loss: 0.028 Vali Loss: 3.197 Vali Acc: 0.400 Test Loss: 3.197 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.003910779953003
Epoch: 7, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.156 Vali Acc: 0.460 Test Loss: 4.156 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8972995281219482
Epoch: 8, Steps: 4 | Train Loss: 0.039 Vali Loss: 4.163 Vali Acc: 0.480 Test Loss: 4.163 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1053240299224854
Epoch: 9, Steps: 4 | Train Loss: 0.034 Vali Loss: 4.087 Vali Acc: 0.440 Test Loss: 4.087 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0235373973846436
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.979 Vali Acc: 0.460 Test Loss: 4.979 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8633403778076172
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.608 Vali Acc: 0.420 Test Loss: 5.608 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0413365364074707
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.509 Vali Acc: 0.440 Test Loss: 5.509 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9717979431152344
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.381 Vali Acc: 0.440 Test Loss: 5.381 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3738283
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1307778358459473
Epoch: 1, Steps: 4 | Train Loss: 1.727 Vali Loss: 1.484 Vali Acc: 0.380 Test Loss: 1.484 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 0.7928488254547119
Epoch: 2, Steps: 4 | Train Loss: 1.255 Vali Loss: 1.523 Vali Acc: 0.380 Test Loss: 1.523 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8205673694610596
Epoch: 3, Steps: 4 | Train Loss: 0.531 Vali Loss: 1.927 Vali Acc: 0.440 Test Loss: 1.927 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439981).  Saving model ...
Epoch: 4 cost time: 0.7921714782714844
Epoch: 4, Steps: 4 | Train Loss: 0.258 Vali Loss: 2.348 Vali Acc: 0.420 Test Loss: 2.348 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.924666166305542
Epoch: 5, Steps: 4 | Train Loss: 0.142 Vali Loss: 3.038 Vali Acc: 0.440 Test Loss: 3.038 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8314371109008789
Epoch: 6, Steps: 4 | Train Loss: 0.069 Vali Loss: 3.840 Vali Acc: 0.460 Test Loss: 3.840 Test Acc: 0.460
Validation loss decreased (-0.439981 --> -0.459962).  Saving model ...
Epoch: 7 cost time: 0.8424510955810547
Epoch: 7, Steps: 4 | Train Loss: 0.031 Vali Loss: 4.104 Vali Acc: 0.520 Test Loss: 4.104 Test Acc: 0.520
Validation loss decreased (-0.459962 --> -0.519959).  Saving model ...
Epoch: 8 cost time: 0.9937944412231445
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.198 Vali Acc: 0.520 Test Loss: 4.198 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8501436710357666
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.477 Vali Acc: 0.480 Test Loss: 4.477 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8971586227416992
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.716 Vali Acc: 0.460 Test Loss: 4.716 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9197418689727783
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.076 Vali Acc: 0.440 Test Loss: 5.076 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.889317512512207
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.386 Vali Acc: 0.460 Test Loss: 5.386 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8570268154144287
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.622 Vali Acc: 0.480 Test Loss: 5.622 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9226553440093994
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.782 Vali Acc: 0.460 Test Loss: 5.782 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8930628299713135
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.848 Vali Acc: 0.460 Test Loss: 5.848 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1213014125823975
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.774 Vali Acc: 0.480 Test Loss: 5.774 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1166858673095703
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.722 Vali Acc: 0.480 Test Loss: 5.722 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3737269
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1908650398254395
Epoch: 1, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.617 Vali Acc: 0.340 Test Loss: 1.617 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 0.9243366718292236
Epoch: 2, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.811 Vali Acc: 0.340 Test Loss: 1.811 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9981846809387207
Epoch: 3, Steps: 4 | Train Loss: 0.902 Vali Loss: 2.052 Vali Acc: 0.400 Test Loss: 2.052 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399979).  Saving model ...
Epoch: 4 cost time: 0.9815235137939453
Epoch: 4, Steps: 4 | Train Loss: 0.281 Vali Loss: 2.241 Vali Acc: 0.560 Test Loss: 2.241 Test Acc: 0.560
Validation loss decreased (-0.399979 --> -0.559978).  Saving model ...
Epoch: 5 cost time: 0.762362003326416
Epoch: 5, Steps: 4 | Train Loss: 0.103 Vali Loss: 2.842 Vali Acc: 0.460 Test Loss: 2.842 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0118722915649414
Epoch: 6, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.534 Vali Acc: 0.480 Test Loss: 3.534 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8606963157653809
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.150 Vali Acc: 0.420 Test Loss: 4.150 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9513165950775146
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.889 Vali Acc: 0.440 Test Loss: 4.889 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8519701957702637
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.434 Vali Acc: 0.440 Test Loss: 5.434 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8985366821289062
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.849 Vali Acc: 0.420 Test Loss: 5.849 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8553657531738281
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.236 Vali Acc: 0.440 Test Loss: 6.236 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8356175422668457
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.552 Vali Acc: 0.460 Test Loss: 6.552 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.889009952545166
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.785 Vali Acc: 0.460 Test Loss: 6.785 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9981589317321777
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.948 Vali Acc: 0.460 Test Loss: 6.948 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3736927
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1295645236968994
Epoch: 1, Steps: 4 | Train Loss: 1.610 Vali Loss: 1.596 Vali Acc: 0.180 Test Loss: 1.596 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 0.8195104598999023
Epoch: 2, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.882 Vali Acc: 0.320 Test Loss: 1.882 Test Acc: 0.320
Validation loss decreased (-0.179984 --> -0.319981).  Saving model ...
Epoch: 3 cost time: 0.8359496593475342
Epoch: 3, Steps: 4 | Train Loss: 0.611 Vali Loss: 2.200 Vali Acc: 0.360 Test Loss: 2.200 Test Acc: 0.360
Validation loss decreased (-0.319981 --> -0.359978).  Saving model ...
Epoch: 4 cost time: 0.961266279220581
Epoch: 4, Steps: 4 | Train Loss: 0.439 Vali Loss: 2.979 Vali Acc: 0.380 Test Loss: 2.979 Test Acc: 0.380
Validation loss decreased (-0.359978 --> -0.379970).  Saving model ...
Epoch: 5 cost time: 0.9319500923156738
Epoch: 5, Steps: 4 | Train Loss: 0.208 Vali Loss: 3.401 Vali Acc: 0.520 Test Loss: 3.401 Test Acc: 0.520
Validation loss decreased (-0.379970 --> -0.519966).  Saving model ...
Epoch: 6 cost time: 0.9664721488952637
Epoch: 6, Steps: 4 | Train Loss: 0.144 Vali Loss: 4.192 Vali Acc: 0.440 Test Loss: 4.192 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8900575637817383
Epoch: 7, Steps: 4 | Train Loss: 0.046 Vali Loss: 4.892 Vali Acc: 0.380 Test Loss: 4.892 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9068446159362793
Epoch: 8, Steps: 4 | Train Loss: 0.012 Vali Loss: 5.909 Vali Acc: 0.380 Test Loss: 5.909 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9116554260253906
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.813 Vali Acc: 0.400 Test Loss: 6.813 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0324981212615967
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.011 Vali Acc: 0.400 Test Loss: 7.011 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7800531387329102
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.151 Vali Acc: 0.380 Test Loss: 7.151 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8977398872375488
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.319 Vali Acc: 0.400 Test Loss: 7.319 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9566316604614258
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.515 Vali Acc: 0.420 Test Loss: 7.515 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9878716468811035
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.692 Vali Acc: 0.400 Test Loss: 7.692 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0466663837432861
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.782 Vali Acc: 0.420 Test Loss: 7.782 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3738067
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5769505500793457
Epoch: 1, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.536 Vali Acc: 0.240 Test Loss: 1.536 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 0.979276180267334
Epoch: 2, Steps: 4 | Train Loss: 1.121 Vali Loss: 1.686 Vali Acc: 0.360 Test Loss: 1.686 Test Acc: 0.360
Validation loss decreased (-0.239985 --> -0.359983).  Saving model ...
Epoch: 3 cost time: 1.0062944889068604
Epoch: 3, Steps: 4 | Train Loss: 0.998 Vali Loss: 2.276 Vali Acc: 0.320 Test Loss: 2.276 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.982393741607666
Epoch: 4, Steps: 4 | Train Loss: 0.410 Vali Loss: 2.309 Vali Acc: 0.440 Test Loss: 2.309 Test Acc: 0.440
Validation loss decreased (-0.359983 --> -0.439977).  Saving model ...
Epoch: 5 cost time: 1.020796298980713
Epoch: 5, Steps: 4 | Train Loss: 0.255 Vali Loss: 2.624 Vali Acc: 0.500 Test Loss: 2.624 Test Acc: 0.500
Validation loss decreased (-0.439977 --> -0.499974).  Saving model ...
Epoch: 6 cost time: 1.1496987342834473
Epoch: 6, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.532 Vali Acc: 0.400 Test Loss: 3.532 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0254335403442383
Epoch: 7, Steps: 4 | Train Loss: 0.084 Vali Loss: 4.372 Vali Acc: 0.420 Test Loss: 4.372 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.975217342376709
Epoch: 8, Steps: 4 | Train Loss: 0.015 Vali Loss: 4.037 Vali Acc: 0.340 Test Loss: 4.037 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9324853420257568
Epoch: 9, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.674 Vali Acc: 0.480 Test Loss: 4.674 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0487086772918701
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.703 Vali Acc: 0.440 Test Loss: 5.703 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0130689144134521
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.978 Vali Acc: 0.440 Test Loss: 5.978 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.115889072418213
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.675 Vali Acc: 0.400 Test Loss: 5.675 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0847573280334473
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.670 Vali Acc: 0.360 Test Loss: 5.670 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9435467720031738
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.752 Vali Acc: 0.400 Test Loss: 5.752 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1021595001220703
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.818 Vali Acc: 0.400 Test Loss: 5.818 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3738131
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.465831995010376
Epoch: 1, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.536 Vali Acc: 0.300 Test Loss: 1.536 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.9387466907501221
Epoch: 2, Steps: 4 | Train Loss: 1.076 Vali Loss: 1.712 Vali Acc: 0.340 Test Loss: 1.712 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339983).  Saving model ...
Epoch: 3 cost time: 1.042741060256958
Epoch: 3, Steps: 4 | Train Loss: 0.845 Vali Loss: 1.596 Vali Acc: 0.420 Test Loss: 1.596 Test Acc: 0.420
Validation loss decreased (-0.339983 --> -0.419984).  Saving model ...
Epoch: 4 cost time: 0.9856216907501221
Epoch: 4, Steps: 4 | Train Loss: 0.324 Vali Loss: 2.178 Vali Acc: 0.500 Test Loss: 2.178 Test Acc: 0.500
Validation loss decreased (-0.419984 --> -0.499978).  Saving model ...
Epoch: 5 cost time: 1.2490615844726562
Epoch: 5, Steps: 4 | Train Loss: 0.121 Vali Loss: 2.453 Vali Acc: 0.480 Test Loss: 2.453 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1707737445831299
Epoch: 6, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.787 Vali Acc: 0.440 Test Loss: 2.787 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9590411186218262
Epoch: 7, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.577 Vali Acc: 0.480 Test Loss: 3.577 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9454975128173828
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.581 Vali Acc: 0.400 Test Loss: 4.581 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.088564395904541
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.286 Vali Acc: 0.420 Test Loss: 5.286 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.10160231590271
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.576 Vali Acc: 0.420 Test Loss: 5.576 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1067566871643066
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.582 Vali Acc: 0.420 Test Loss: 5.582 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1523356437683105
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.538 Vali Acc: 0.420 Test Loss: 5.538 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1192481517791748
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.537 Vali Acc: 0.420 Test Loss: 5.537 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9572763442993164
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.420 Test Loss: 5.546 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3737119
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.205622911453247
Epoch: 1, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.635 Vali Acc: 0.340 Test Loss: 1.635 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.3539528846740723
Epoch: 2, Steps: 4 | Train Loss: 1.008 Vali Loss: 2.046 Vali Acc: 0.320 Test Loss: 2.046 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1448407173156738
Epoch: 3, Steps: 4 | Train Loss: 0.980 Vali Loss: 2.048 Vali Acc: 0.480 Test Loss: 2.048 Test Acc: 0.480
Validation loss decreased (-0.339984 --> -0.479980).  Saving model ...
Epoch: 4 cost time: 0.9923250675201416
Epoch: 4, Steps: 4 | Train Loss: 0.318 Vali Loss: 2.056 Vali Acc: 0.500 Test Loss: 2.056 Test Acc: 0.500
Validation loss decreased (-0.479980 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 1.2597441673278809
Epoch: 5, Steps: 4 | Train Loss: 0.121 Vali Loss: 2.770 Vali Acc: 0.500 Test Loss: 2.770 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3458669185638428
Epoch: 6, Steps: 4 | Train Loss: 0.077 Vali Loss: 3.374 Vali Acc: 0.460 Test Loss: 3.374 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.978569507598877
Epoch: 7, Steps: 4 | Train Loss: 0.012 Vali Loss: 4.114 Vali Acc: 0.500 Test Loss: 4.114 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.078944206237793
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.520 Vali Acc: 0.520 Test Loss: 4.520 Test Acc: 0.520
Validation loss decreased (-0.499979 --> -0.519955).  Saving model ...
Epoch: 9 cost time: 1.061995267868042
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.844 Vali Acc: 0.500 Test Loss: 4.844 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1041991710662842
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.168 Vali Acc: 0.500 Test Loss: 5.168 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.037086009979248
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.523 Vali Acc: 0.500 Test Loss: 5.523 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.12451171875
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.822 Vali Acc: 0.480 Test Loss: 5.822 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9534225463867188
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.057 Vali Acc: 0.480 Test Loss: 6.057 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0811688899993896
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.232 Vali Acc: 0.480 Test Loss: 6.232 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0227200984954834
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.355 Vali Acc: 0.480 Test Loss: 6.355 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3146381378173828
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.436 Vali Acc: 0.480 Test Loss: 6.436 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.025000810623169
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.482 Vali Acc: 0.460 Test Loss: 6.482 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.11051344871521
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.507 Vali Acc: 0.460 Test Loss: 6.507 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3738939
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.320758104324341
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.564 Vali Acc: 0.240 Test Loss: 1.564 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.0284619331359863
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.519 Vali Acc: 0.320 Test Loss: 1.519 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.027909278869629
Epoch: 3, Steps: 4 | Train Loss: 0.661 Vali Loss: 1.840 Vali Acc: 0.420 Test Loss: 1.840 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419982).  Saving model ...
Epoch: 4 cost time: 0.913153886795044
Epoch: 4, Steps: 4 | Train Loss: 0.271 Vali Loss: 2.371 Vali Acc: 0.440 Test Loss: 2.371 Test Acc: 0.440
Validation loss decreased (-0.419982 --> -0.439976).  Saving model ...
Epoch: 5 cost time: 1.0769340991973877
Epoch: 5, Steps: 4 | Train Loss: 0.225 Vali Loss: 2.336 Vali Acc: 0.480 Test Loss: 2.336 Test Acc: 0.480
Validation loss decreased (-0.439976 --> -0.479977).  Saving model ...
Epoch: 6 cost time: 1.0385546684265137
Epoch: 6, Steps: 4 | Train Loss: 0.120 Vali Loss: 3.628 Vali Acc: 0.440 Test Loss: 3.628 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1204619407653809
Epoch: 7, Steps: 4 | Train Loss: 0.037 Vali Loss: 4.324 Vali Acc: 0.400 Test Loss: 4.324 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0633435249328613
Epoch: 8, Steps: 4 | Train Loss: 0.098 Vali Loss: 5.172 Vali Acc: 0.380 Test Loss: 5.172 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1743948459625244
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.013 Vali Acc: 0.440 Test Loss: 5.013 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.106410264968872
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.179 Vali Acc: 0.440 Test Loss: 5.179 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0046539306640625
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.611 Vali Acc: 0.440 Test Loss: 5.611 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0737261772155762
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.512 Vali Acc: 0.380 Test Loss: 6.512 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0785934925079346
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.305 Vali Acc: 0.380 Test Loss: 7.305 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9247608184814453
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.791 Vali Acc: 0.380 Test Loss: 7.791 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9573535919189453
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.945 Vali Acc: 0.360 Test Loss: 7.945 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3736045
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.098759174346924
Epoch: 1, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.688 Vali Acc: 0.240 Test Loss: 1.688 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.0558667182922363
Epoch: 2, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.816 Vali Acc: 0.280 Test Loss: 1.816 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279982).  Saving model ...
Epoch: 3 cost time: 0.9309332370758057
Epoch: 3, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.994 Vali Acc: 0.400 Test Loss: 1.994 Test Acc: 0.400
Validation loss decreased (-0.279982 --> -0.399980).  Saving model ...
Epoch: 4 cost time: 0.9529995918273926
Epoch: 4, Steps: 4 | Train Loss: 0.254 Vali Loss: 2.878 Vali Acc: 0.440 Test Loss: 2.878 Test Acc: 0.440
Validation loss decreased (-0.399980 --> -0.439971).  Saving model ...
Epoch: 5 cost time: 0.8844935894012451
Epoch: 5, Steps: 4 | Train Loss: 0.117 Vali Loss: 4.321 Vali Acc: 0.440 Test Loss: 4.321 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9809343814849854
Epoch: 6, Steps: 4 | Train Loss: 0.074 Vali Loss: 4.168 Vali Acc: 0.380 Test Loss: 4.168 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9575099945068359
Epoch: 7, Steps: 4 | Train Loss: 0.012 Vali Loss: 4.971 Vali Acc: 0.420 Test Loss: 4.971 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8391883373260498
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.990 Vali Acc: 0.460 Test Loss: 5.990 Test Acc: 0.460
Validation loss decreased (-0.439971 --> -0.459940).  Saving model ...
Epoch: 9 cost time: 1.0378985404968262
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.460 Vali Acc: 0.420 Test Loss: 6.460 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9230668544769287
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.567 Vali Acc: 0.420 Test Loss: 6.567 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9125373363494873
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.595 Vali Acc: 0.420 Test Loss: 6.595 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9851076602935791
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.508 Vali Acc: 0.420 Test Loss: 6.508 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9140620231628418
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.461 Vali Acc: 0.420 Test Loss: 6.461 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9811611175537109
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.447 Vali Acc: 0.420 Test Loss: 6.447 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8755753040313721
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.455 Vali Acc: 0.420 Test Loss: 6.455 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8785169124603271
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.472 Vali Acc: 0.440 Test Loss: 6.472 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0653235912322998
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.498 Vali Acc: 0.420 Test Loss: 6.498 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0677728652954102
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.525 Vali Acc: 0.420 Test Loss: 6.525 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3736523
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.379401922225952
Epoch: 1, Steps: 4 | Train Loss: 1.705 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.2304019927978516
Epoch: 2, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.581 Vali Acc: 0.340 Test Loss: 1.581 Test Acc: 0.340
Validation loss decreased (-0.299983 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.0116527080535889
Epoch: 3, Steps: 4 | Train Loss: 0.602 Vali Loss: 1.634 Vali Acc: 0.480 Test Loss: 1.634 Test Acc: 0.480
Validation loss decreased (-0.339984 --> -0.479984).  Saving model ...
Epoch: 4 cost time: 1.2521865367889404
Epoch: 4, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.945 Vali Acc: 0.540 Test Loss: 1.945 Test Acc: 0.540
Validation loss decreased (-0.479984 --> -0.539981).  Saving model ...
Epoch: 5 cost time: 1.3082294464111328
Epoch: 5, Steps: 4 | Train Loss: 0.132 Vali Loss: 2.699 Vali Acc: 0.520 Test Loss: 2.699 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2814061641693115
Epoch: 6, Steps: 4 | Train Loss: 0.059 Vali Loss: 3.157 Vali Acc: 0.440 Test Loss: 3.157 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.092216968536377
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.508 Vali Acc: 0.480 Test Loss: 3.508 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1415960788726807
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.976 Vali Acc: 0.500 Test Loss: 3.976 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0187668800354004
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.411 Vali Acc: 0.480 Test Loss: 4.411 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1457874774932861
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.779 Vali Acc: 0.480 Test Loss: 4.779 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1311848163604736
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.096 Vali Acc: 0.480 Test Loss: 5.096 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.16676926612854
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.360 Vali Acc: 0.460 Test Loss: 5.360 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.192265510559082
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.606 Vali Acc: 0.500 Test Loss: 5.606 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1587140560150146
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.794 Vali Acc: 0.500 Test Loss: 5.794 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3736465
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.329468250274658
Epoch: 1, Steps: 4 | Train Loss: 1.736 Vali Loss: 1.522 Vali Acc: 0.300 Test Loss: 1.522 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.1438777446746826
Epoch: 2, Steps: 4 | Train Loss: 1.182 Vali Loss: 1.720 Vali Acc: 0.300 Test Loss: 1.720 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.258695363998413
Epoch: 3, Steps: 4 | Train Loss: 0.886 Vali Loss: 1.992 Vali Acc: 0.440 Test Loss: 1.992 Test Acc: 0.440
Validation loss decreased (-0.299985 --> -0.439980).  Saving model ...
Epoch: 4 cost time: 1.0549511909484863
Epoch: 4, Steps: 4 | Train Loss: 0.503 Vali Loss: 2.708 Vali Acc: 0.460 Test Loss: 2.708 Test Acc: 0.460
Validation loss decreased (-0.439980 --> -0.459973).  Saving model ...
Epoch: 5 cost time: 0.9874048233032227
Epoch: 5, Steps: 4 | Train Loss: 0.095 Vali Loss: 2.707 Vali Acc: 0.420 Test Loss: 2.707 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1352434158325195
Epoch: 6, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.316 Vali Acc: 0.480 Test Loss: 3.316 Test Acc: 0.480
Validation loss decreased (-0.459973 --> -0.479967).  Saving model ...
Epoch: 7 cost time: 1.1458418369293213
Epoch: 7, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.956 Vali Acc: 0.420 Test Loss: 3.956 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1645479202270508
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.716 Vali Acc: 0.420 Test Loss: 4.716 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0913777351379395
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.345 Vali Acc: 0.440 Test Loss: 5.345 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1330897808074951
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.825 Vali Acc: 0.400 Test Loss: 5.825 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0750296115875244
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.111 Vali Acc: 0.380 Test Loss: 6.111 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0747976303100586
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.312 Vali Acc: 0.380 Test Loss: 6.312 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0370712280273438
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.433 Vali Acc: 0.400 Test Loss: 6.433 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1381001472473145
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.510 Vali Acc: 0.420 Test Loss: 6.510 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2119660377502441
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.550 Vali Acc: 0.420 Test Loss: 6.550 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0696451663970947
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.568 Vali Acc: 0.420 Test Loss: 6.568 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3735871
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1283926963806152
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.557 Vali Acc: 0.300 Test Loss: 1.557 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.9062697887420654
Epoch: 2, Steps: 4 | Train Loss: 1.190 Vali Loss: 1.684 Vali Acc: 0.280 Test Loss: 1.684 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0800490379333496
Epoch: 3, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.776 Vali Acc: 0.440 Test Loss: 1.776 Test Acc: 0.440
Validation loss decreased (-0.299984 --> -0.439982).  Saving model ...
Epoch: 4 cost time: 0.9782471656799316
Epoch: 4, Steps: 4 | Train Loss: 0.502 Vali Loss: 2.654 Vali Acc: 0.440 Test Loss: 2.654 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9459707736968994
Epoch: 5, Steps: 4 | Train Loss: 0.246 Vali Loss: 2.332 Vali Acc: 0.400 Test Loss: 2.332 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.915642261505127
Epoch: 6, Steps: 4 | Train Loss: 0.236 Vali Loss: 3.160 Vali Acc: 0.440 Test Loss: 3.160 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9979720115661621
Epoch: 7, Steps: 4 | Train Loss: 0.028 Vali Loss: 3.998 Vali Acc: 0.440 Test Loss: 3.998 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8543047904968262
Epoch: 8, Steps: 4 | Train Loss: 0.020 Vali Loss: 3.945 Vali Acc: 0.420 Test Loss: 3.945 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0221507549285889
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.160 Vali Acc: 0.380 Test Loss: 4.160 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0311903953552246
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.378 Vali Acc: 0.420 Test Loss: 4.378 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0751981735229492
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.623 Vali Acc: 0.420 Test Loss: 4.623 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.014122486114502
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.826 Vali Acc: 0.440 Test Loss: 4.826 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0566749572753906
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.971 Vali Acc: 0.440 Test Loss: 4.971 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 3738603
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.372002363204956
Epoch: 1, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.573 Vali Acc: 0.360 Test Loss: 1.573 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 1.1015610694885254
Epoch: 2, Steps: 4 | Train Loss: 1.029 Vali Loss: 1.683 Vali Acc: 0.300 Test Loss: 1.683 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0257341861724854
Epoch: 3, Steps: 4 | Train Loss: 0.644 Vali Loss: 1.716 Vali Acc: 0.440 Test Loss: 1.716 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439983).  Saving model ...
Epoch: 4 cost time: 1.1231446266174316
Epoch: 4, Steps: 4 | Train Loss: 0.255 Vali Loss: 2.069 Vali Acc: 0.500 Test Loss: 2.069 Test Acc: 0.500
Validation loss decreased (-0.439983 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 1.1988718509674072
Epoch: 5, Steps: 4 | Train Loss: 0.139 Vali Loss: 2.665 Vali Acc: 0.500 Test Loss: 2.665 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1113057136535645
Epoch: 6, Steps: 4 | Train Loss: 0.134 Vali Loss: 3.452 Vali Acc: 0.460 Test Loss: 3.452 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.143752098083496
Epoch: 7, Steps: 4 | Train Loss: 0.024 Vali Loss: 3.560 Vali Acc: 0.460 Test Loss: 3.560 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.052011251449585
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.895 Vali Acc: 0.480 Test Loss: 4.895 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.147373914718628
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.198 Vali Acc: 0.440 Test Loss: 5.198 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2483384609222412
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.391 Vali Acc: 0.480 Test Loss: 5.391 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9439594745635986
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.557 Vali Acc: 0.460 Test Loss: 5.557 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9841387271881104
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.714 Vali Acc: 0.440 Test Loss: 5.714 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0155894756317139
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.883 Vali Acc: 0.420 Test Loss: 5.883 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.052410364151001
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.037 Vali Acc: 0.420 Test Loss: 6.037 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3736671
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.152503728866577
Epoch: 1, Steps: 4 | Train Loss: 1.535 Vali Loss: 1.630 Vali Acc: 0.220 Test Loss: 1.630 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 0.8748705387115479
Epoch: 2, Steps: 4 | Train Loss: 1.106 Vali Loss: 1.487 Vali Acc: 0.420 Test Loss: 1.487 Test Acc: 0.420
Validation loss decreased (-0.219984 --> -0.419985).  Saving model ...
Epoch: 3 cost time: 0.8600962162017822
Epoch: 3, Steps: 4 | Train Loss: 0.816 Vali Loss: 2.297 Vali Acc: 0.420 Test Loss: 2.297 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.844536542892456
Epoch: 4, Steps: 4 | Train Loss: 0.235 Vali Loss: 3.008 Vali Acc: 0.480 Test Loss: 3.008 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479970).  Saving model ...
Epoch: 5 cost time: 0.7873189449310303
Epoch: 5, Steps: 4 | Train Loss: 0.221 Vali Loss: 3.298 Vali Acc: 0.440 Test Loss: 3.298 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8729367256164551
Epoch: 6, Steps: 4 | Train Loss: 0.030 Vali Loss: 4.394 Vali Acc: 0.400 Test Loss: 4.394 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9308836460113525
Epoch: 7, Steps: 4 | Train Loss: 0.121 Vali Loss: 5.147 Vali Acc: 0.440 Test Loss: 5.147 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.035719633102417
Epoch: 8, Steps: 4 | Train Loss: 0.103 Vali Loss: 6.410 Vali Acc: 0.380 Test Loss: 6.410 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8476343154907227
Epoch: 9, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.435 Vali Acc: 0.440 Test Loss: 6.435 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.923638105392456
Epoch: 10, Steps: 4 | Train Loss: 0.055 Vali Loss: 6.945 Vali Acc: 0.480 Test Loss: 6.945 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8969440460205078
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.266 Vali Acc: 0.500 Test Loss: 6.266 Test Acc: 0.500
Validation loss decreased (-0.479970 --> -0.499937).  Saving model ...
Epoch: 12 cost time: 1.0431063175201416
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.321 Vali Acc: 0.480 Test Loss: 6.321 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.842658281326294
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 7.029 Vali Acc: 0.500 Test Loss: 7.029 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8029863834381104
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.807 Vali Acc: 0.460 Test Loss: 8.807 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8339657783508301
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 8.570 Vali Acc: 0.480 Test Loss: 8.570 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.885221004486084
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.134 Vali Acc: 0.500 Test Loss: 8.134 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6970574855804443
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.902 Vali Acc: 0.520 Test Loss: 7.902 Test Acc: 0.520
Validation loss decreased (-0.499937 --> -0.519921).  Saving model ...
Epoch: 18 cost time: 0.9092051982879639
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.781 Vali Acc: 0.480 Test Loss: 7.781 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6837966442108154
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.713 Vali Acc: 0.500 Test Loss: 7.713 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9423062801361084
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.671 Vali Acc: 0.480 Test Loss: 7.671 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.979684591293335
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.657 Vali Acc: 0.460 Test Loss: 7.657 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9199910163879395
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.670 Vali Acc: 0.480 Test Loss: 7.670 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8321630954742432
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.704 Vali Acc: 0.440 Test Loss: 7.704 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0003066062927246
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.761 Vali Acc: 0.440 Test Loss: 7.761 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8916847705841064
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.810 Vali Acc: 0.440 Test Loss: 7.810 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8585100173950195
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.849 Vali Acc: 0.440 Test Loss: 7.849 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9424071311950684
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.880 Vali Acc: 0.440 Test Loss: 7.880 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3718911
model size : 14.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5585684776306152
Epoch: 1, Steps: 4 | Train Loss: 1.613 Vali Loss: 1.565 Vali Acc: 0.360 Test Loss: 1.565 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 0.9024405479431152
Epoch: 2, Steps: 4 | Train Loss: 1.221 Vali Loss: 1.575 Vali Acc: 0.380 Test Loss: 1.575 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 1.0722618103027344
Epoch: 3, Steps: 4 | Train Loss: 0.535 Vali Loss: 1.957 Vali Acc: 0.440 Test Loss: 1.957 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439980).  Saving model ...
Epoch: 4 cost time: 0.8913414478302002
Epoch: 4, Steps: 4 | Train Loss: 0.487 Vali Loss: 2.262 Vali Acc: 0.400 Test Loss: 2.262 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9433751106262207
Epoch: 5, Steps: 4 | Train Loss: 0.234 Vali Loss: 2.851 Vali Acc: 0.480 Test Loss: 2.851 Test Acc: 0.480
Validation loss decreased (-0.439980 --> -0.479971).  Saving model ...
Epoch: 6 cost time: 0.9323716163635254
Epoch: 6, Steps: 4 | Train Loss: 0.049 Vali Loss: 3.195 Vali Acc: 0.520 Test Loss: 3.195 Test Acc: 0.520
Validation loss decreased (-0.479971 --> -0.519968).  Saving model ...
Epoch: 7 cost time: 1.0345470905303955
Epoch: 7, Steps: 4 | Train Loss: 0.156 Vali Loss: 3.339 Vali Acc: 0.520 Test Loss: 3.339 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.989666223526001
Epoch: 8, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.218 Vali Acc: 0.440 Test Loss: 4.218 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9004597663879395
Epoch: 9, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.914 Vali Acc: 0.480 Test Loss: 4.914 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8600938320159912
Epoch: 10, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.167 Vali Acc: 0.540 Test Loss: 5.167 Test Acc: 0.540
Validation loss decreased (-0.519968 --> -0.539948).  Saving model ...
Epoch: 11 cost time: 0.9413220882415771
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.312 Vali Acc: 0.500 Test Loss: 5.312 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9440340995788574
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.736 Vali Acc: 0.440 Test Loss: 5.736 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0240061283111572
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.461 Vali Acc: 0.460 Test Loss: 6.461 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0443992614746094
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.175 Vali Acc: 0.460 Test Loss: 7.175 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9696428775787354
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.683 Vali Acc: 0.440 Test Loss: 7.683 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9922282695770264
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.876 Vali Acc: 0.460 Test Loss: 7.876 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0082263946533203
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.855 Vali Acc: 0.460 Test Loss: 7.855 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8863880634307861
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.740 Vali Acc: 0.480 Test Loss: 7.740 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9471631050109863
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.636 Vali Acc: 0.480 Test Loss: 7.636 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8767316341400146
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.550 Vali Acc: 0.480 Test Loss: 7.550 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3716045
model size : 14.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3210415840148926
Epoch: 1, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.736 Vali Acc: 0.300 Test Loss: 1.736 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.0008716583251953
Epoch: 2, Steps: 4 | Train Loss: 1.180 Vali Loss: 1.711 Vali Acc: 0.260 Test Loss: 1.711 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8681199550628662
Epoch: 3, Steps: 4 | Train Loss: 0.664 Vali Loss: 1.868 Vali Acc: 0.460 Test Loss: 1.868 Test Acc: 0.460
Validation loss decreased (-0.299983 --> -0.459981).  Saving model ...
Epoch: 4 cost time: 1.0814273357391357
Epoch: 4, Steps: 4 | Train Loss: 0.260 Vali Loss: 2.003 Vali Acc: 0.500 Test Loss: 2.003 Test Acc: 0.500
Validation loss decreased (-0.459981 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 1.0654828548431396
Epoch: 5, Steps: 4 | Train Loss: 0.221 Vali Loss: 2.778 Vali Acc: 0.460 Test Loss: 2.778 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9942774772644043
Epoch: 6, Steps: 4 | Train Loss: 0.069 Vali Loss: 3.859 Vali Acc: 0.460 Test Loss: 3.859 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.018486738204956
Epoch: 7, Steps: 4 | Train Loss: 0.138 Vali Loss: 3.921 Vali Acc: 0.420 Test Loss: 3.921 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9994091987609863
Epoch: 8, Steps: 4 | Train Loss: 0.031 Vali Loss: 3.437 Vali Acc: 0.460 Test Loss: 3.437 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9963440895080566
Epoch: 9, Steps: 4 | Train Loss: 0.035 Vali Loss: 3.844 Vali Acc: 0.520 Test Loss: 3.844 Test Acc: 0.520
Validation loss decreased (-0.499980 --> -0.519962).  Saving model ...
Epoch: 10 cost time: 0.9124014377593994
Epoch: 10, Steps: 4 | Train Loss: 0.014 Vali Loss: 4.577 Vali Acc: 0.440 Test Loss: 4.577 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9646117687225342
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.660 Vali Acc: 0.400 Test Loss: 4.660 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9255666732788086
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.656 Vali Acc: 0.460 Test Loss: 4.656 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8428916931152344
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.788 Vali Acc: 0.480 Test Loss: 4.788 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.958219051361084
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.925 Vali Acc: 0.480 Test Loss: 4.925 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0440325736999512
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.083 Vali Acc: 0.460 Test Loss: 5.083 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0470969676971436
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.257 Vali Acc: 0.440 Test Loss: 5.257 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8718774318695068
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.412 Vali Acc: 0.460 Test Loss: 5.412 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0195016860961914
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.420 Test Loss: 5.546 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8878812789916992
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.640 Vali Acc: 0.420 Test Loss: 5.640 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3715195
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2572977542877197
Epoch: 1, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.665 Vali Acc: 0.300 Test Loss: 1.665 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.0483770370483398
Epoch: 2, Steps: 4 | Train Loss: 1.366 Vali Loss: 1.629 Vali Acc: 0.280 Test Loss: 1.629 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7648904323577881
Epoch: 3, Steps: 4 | Train Loss: 0.752 Vali Loss: 2.136 Vali Acc: 0.420 Test Loss: 2.136 Test Acc: 0.420
Validation loss decreased (-0.299983 --> -0.419979).  Saving model ...
Epoch: 4 cost time: 0.7897717952728271
Epoch: 4, Steps: 4 | Train Loss: 0.394 Vali Loss: 2.044 Vali Acc: 0.480 Test Loss: 2.044 Test Acc: 0.480
Validation loss decreased (-0.419979 --> -0.479980).  Saving model ...
Epoch: 5 cost time: 0.9044737815856934
Epoch: 5, Steps: 4 | Train Loss: 0.137 Vali Loss: 2.955 Vali Acc: 0.460 Test Loss: 2.955 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7817230224609375
Epoch: 6, Steps: 4 | Train Loss: 0.069 Vali Loss: 2.992 Vali Acc: 0.520 Test Loss: 2.992 Test Acc: 0.520
Validation loss decreased (-0.479980 --> -0.519970).  Saving model ...
Epoch: 7 cost time: 0.9256997108459473
Epoch: 7, Steps: 4 | Train Loss: 0.061 Vali Loss: 3.286 Vali Acc: 0.540 Test Loss: 3.286 Test Acc: 0.540
Validation loss decreased (-0.519970 --> -0.539967).  Saving model ...
Epoch: 8 cost time: 0.880969762802124
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.881 Vali Acc: 0.400 Test Loss: 3.881 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9550113677978516
Epoch: 9, Steps: 4 | Train Loss: 0.018 Vali Loss: 4.909 Vali Acc: 0.480 Test Loss: 4.909 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8235785961151123
Epoch: 10, Steps: 4 | Train Loss: 0.020 Vali Loss: 5.391 Vali Acc: 0.480 Test Loss: 5.391 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.127323865890503
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.456 Vali Acc: 0.440 Test Loss: 5.456 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9686219692230225
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.802 Vali Acc: 0.460 Test Loss: 5.802 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0097270011901855
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.215 Vali Acc: 0.440 Test Loss: 6.215 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9970262050628662
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.326 Vali Acc: 0.480 Test Loss: 6.326 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9419217109680176
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.562 Vali Acc: 0.540 Test Loss: 6.562 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8866102695465088
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.581 Vali Acc: 0.520 Test Loss: 6.581 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8757486343383789
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.508 Vali Acc: 0.520 Test Loss: 6.508 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3713781
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.090336799621582
Epoch: 1, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.604 Vali Acc: 0.360 Test Loss: 1.604 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 1.0162692070007324
Epoch: 2, Steps: 4 | Train Loss: 1.330 Vali Loss: 1.705 Vali Acc: 0.320 Test Loss: 1.705 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8022456169128418
Epoch: 3, Steps: 4 | Train Loss: 0.821 Vali Loss: 2.113 Vali Acc: 0.400 Test Loss: 2.113 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399979).  Saving model ...
Epoch: 4 cost time: 0.9385871887207031
Epoch: 4, Steps: 4 | Train Loss: 0.280 Vali Loss: 2.067 Vali Acc: 0.460 Test Loss: 2.067 Test Acc: 0.460
Validation loss decreased (-0.399979 --> -0.459979).  Saving model ...
Epoch: 5 cost time: 1.0629665851593018
Epoch: 5, Steps: 4 | Train Loss: 0.177 Vali Loss: 3.105 Vali Acc: 0.460 Test Loss: 3.105 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9199497699737549
Epoch: 6, Steps: 4 | Train Loss: 0.087 Vali Loss: 3.684 Vali Acc: 0.380 Test Loss: 3.684 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9957318305969238
Epoch: 7, Steps: 4 | Train Loss: 0.037 Vali Loss: 3.310 Vali Acc: 0.480 Test Loss: 3.310 Test Acc: 0.480
Validation loss decreased (-0.459979 --> -0.479967).  Saving model ...
Epoch: 8 cost time: 0.9314639568328857
Epoch: 8, Steps: 4 | Train Loss: 0.015 Vali Loss: 4.209 Vali Acc: 0.380 Test Loss: 4.209 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8098921775817871
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.583 Vali Acc: 0.400 Test Loss: 5.583 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8682870864868164
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.262 Vali Acc: 0.440 Test Loss: 6.262 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0367069244384766
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.850 Vali Acc: 0.420 Test Loss: 6.850 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8488936424255371
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.327 Vali Acc: 0.440 Test Loss: 7.327 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9598128795623779
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.628 Vali Acc: 0.400 Test Loss: 7.628 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8238134384155273
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.803 Vali Acc: 0.360 Test Loss: 7.803 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9775710105895996
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.916 Vali Acc: 0.360 Test Loss: 7.916 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0006844997406006
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.987 Vali Acc: 0.360 Test Loss: 7.987 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8765106201171875
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.035 Vali Acc: 0.400 Test Loss: 8.035 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3713231
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1566555500030518
Epoch: 1, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.618 Vali Acc: 0.300 Test Loss: 1.618 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.8104903697967529
Epoch: 2, Steps: 4 | Train Loss: 1.112 Vali Loss: 1.931 Vali Acc: 0.300 Test Loss: 1.931 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9157841205596924
Epoch: 3, Steps: 4 | Train Loss: 0.774 Vali Loss: 2.144 Vali Acc: 0.440 Test Loss: 2.144 Test Acc: 0.440
Validation loss decreased (-0.299984 --> -0.439979).  Saving model ...
Epoch: 4 cost time: 0.8986289501190186
Epoch: 4, Steps: 4 | Train Loss: 0.548 Vali Loss: 2.571 Vali Acc: 0.480 Test Loss: 2.571 Test Acc: 0.480
Validation loss decreased (-0.439979 --> -0.479974).  Saving model ...
Epoch: 5 cost time: 0.9108455181121826
Epoch: 5, Steps: 4 | Train Loss: 0.231 Vali Loss: 3.078 Vali Acc: 0.300 Test Loss: 3.078 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8489184379577637
Epoch: 6, Steps: 4 | Train Loss: 0.298 Vali Loss: 4.291 Vali Acc: 0.480 Test Loss: 4.291 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8934252262115479
Epoch: 7, Steps: 4 | Train Loss: 0.083 Vali Loss: 3.552 Vali Acc: 0.400 Test Loss: 3.552 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.784900426864624
Epoch: 8, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.822 Vali Acc: 0.420 Test Loss: 3.822 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8946037292480469
Epoch: 9, Steps: 4 | Train Loss: 0.007 Vali Loss: 5.039 Vali Acc: 0.420 Test Loss: 5.039 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8214328289031982
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.871 Vali Acc: 0.400 Test Loss: 5.871 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.058774709701538
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.299 Vali Acc: 0.440 Test Loss: 6.299 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9582278728485107
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.519 Vali Acc: 0.420 Test Loss: 6.519 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8664195537567139
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.790 Vali Acc: 0.460 Test Loss: 6.790 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8520255088806152
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.022 Vali Acc: 0.500 Test Loss: 7.022 Test Acc: 0.500
Validation loss decreased (-0.479974 --> -0.499930).  Saving model ...
Epoch: 15 cost time: 0.8262252807617188
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.186 Vali Acc: 0.540 Test Loss: 7.186 Test Acc: 0.540
Validation loss decreased (-0.499930 --> -0.539928).  Saving model ...
Epoch: 16 cost time: 0.9024710655212402
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.282 Vali Acc: 0.520 Test Loss: 7.282 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.857506513595581
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.301 Vali Acc: 0.520 Test Loss: 7.301 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9820029735565186
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.285 Vali Acc: 0.540 Test Loss: 7.285 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9261984825134277
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.252 Vali Acc: 0.540 Test Loss: 7.252 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9368293285369873
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.220 Vali Acc: 0.540 Test Loss: 7.220 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8051154613494873
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.195 Vali Acc: 0.540 Test Loss: 7.195 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.927598237991333
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.177 Vali Acc: 0.540 Test Loss: 7.177 Test Acc: 0.540
Validation loss decreased (-0.539928 --> -0.539928).  Saving model ...
Epoch: 23 cost time: 0.8175709247589111
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.168 Vali Acc: 0.520 Test Loss: 7.168 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7837772369384766
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.160 Vali Acc: 0.520 Test Loss: 7.160 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7978079319000244
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.151 Vali Acc: 0.500 Test Loss: 7.151 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8101472854614258
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.150 Vali Acc: 0.500 Test Loss: 7.150 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7285163402557373
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.153 Vali Acc: 0.500 Test Loss: 7.153 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8676893711090088
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.158 Vali Acc: 0.500 Test Loss: 7.158 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8051698207855225
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.165 Vali Acc: 0.500 Test Loss: 7.165 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9756355285644531
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.176 Vali Acc: 0.500 Test Loss: 7.176 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8370029926300049
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.186 Vali Acc: 0.500 Test Loss: 7.186 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0303890705108643
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.196 Vali Acc: 0.500 Test Loss: 7.196 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3713687
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0351459980010986
Epoch: 1, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.648 Vali Acc: 0.300 Test Loss: 1.648 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.9220900535583496
Epoch: 2, Steps: 4 | Train Loss: 1.160 Vali Loss: 1.760 Vali Acc: 0.400 Test Loss: 1.760 Test Acc: 0.400
Validation loss decreased (-0.299984 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 0.9761760234832764
Epoch: 3, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.872 Vali Acc: 0.360 Test Loss: 1.872 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9252338409423828
Epoch: 4, Steps: 4 | Train Loss: 0.420 Vali Loss: 2.967 Vali Acc: 0.440 Test Loss: 2.967 Test Acc: 0.440
Validation loss decreased (-0.399982 --> -0.439970).  Saving model ...
Epoch: 5 cost time: 0.9514009952545166
Epoch: 5, Steps: 4 | Train Loss: 0.361 Vali Loss: 3.455 Vali Acc: 0.420 Test Loss: 3.455 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1231420040130615
Epoch: 6, Steps: 4 | Train Loss: 0.121 Vali Loss: 3.086 Vali Acc: 0.440 Test Loss: 3.086 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1109952926635742
Epoch: 7, Steps: 4 | Train Loss: 0.030 Vali Loss: 3.686 Vali Acc: 0.440 Test Loss: 3.686 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9471070766448975
Epoch: 8, Steps: 4 | Train Loss: 0.054 Vali Loss: 4.818 Vali Acc: 0.400 Test Loss: 4.818 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9370589256286621
Epoch: 9, Steps: 4 | Train Loss: 0.071 Vali Loss: 5.076 Vali Acc: 0.420 Test Loss: 5.076 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0492091178894043
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.650 Vali Acc: 0.320 Test Loss: 4.650 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8386936187744141
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.185 Vali Acc: 0.420 Test Loss: 5.185 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8598623275756836
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.239 Vali Acc: 0.440 Test Loss: 6.239 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9197251796722412
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.254 Vali Acc: 0.440 Test Loss: 7.254 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8448760509490967
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.696 Vali Acc: 0.400 Test Loss: 7.696 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 3713131
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0127010345458984
Epoch: 1, Steps: 4 | Train Loss: 1.634 Vali Loss: 1.646 Vali Acc: 0.260 Test Loss: 1.646 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 0.8005938529968262
Epoch: 2, Steps: 4 | Train Loss: 1.374 Vali Loss: 1.713 Vali Acc: 0.320 Test Loss: 1.713 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 0.8517313003540039
Epoch: 3, Steps: 4 | Train Loss: 0.725 Vali Loss: 1.809 Vali Acc: 0.380 Test Loss: 1.809 Test Acc: 0.380
Validation loss decreased (-0.319983 --> -0.379982).  Saving model ...
Epoch: 4 cost time: 0.8968760967254639
Epoch: 4, Steps: 4 | Train Loss: 0.828 Vali Loss: 2.104 Vali Acc: 0.400 Test Loss: 2.104 Test Acc: 0.400
Validation loss decreased (-0.379982 --> -0.399979).  Saving model ...
Epoch: 5 cost time: 0.8916442394256592
Epoch: 5, Steps: 4 | Train Loss: 0.569 Vali Loss: 2.734 Vali Acc: 0.400 Test Loss: 2.734 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9342954158782959
Epoch: 6, Steps: 4 | Train Loss: 0.279 Vali Loss: 3.428 Vali Acc: 0.460 Test Loss: 3.428 Test Acc: 0.460
Validation loss decreased (-0.399979 --> -0.459966).  Saving model ...
Epoch: 7 cost time: 0.8355269432067871
Epoch: 7, Steps: 4 | Train Loss: 0.084 Vali Loss: 3.271 Vali Acc: 0.380 Test Loss: 3.271 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7585620880126953
Epoch: 8, Steps: 4 | Train Loss: 0.097 Vali Loss: 4.265 Vali Acc: 0.420 Test Loss: 4.265 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9101769924163818
Epoch: 9, Steps: 4 | Train Loss: 0.060 Vali Loss: 6.171 Vali Acc: 0.340 Test Loss: 6.171 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8685054779052734
Epoch: 10, Steps: 4 | Train Loss: 0.051 Vali Loss: 5.707 Vali Acc: 0.420 Test Loss: 5.707 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9303574562072754
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.079 Vali Acc: 0.400 Test Loss: 5.079 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8948380947113037
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.878 Vali Acc: 0.420 Test Loss: 4.878 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9224145412445068
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.091 Vali Acc: 0.440 Test Loss: 5.091 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0056993961334229
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.288 Vali Acc: 0.440 Test Loss: 5.288 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9640951156616211
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.523 Vali Acc: 0.420 Test Loss: 5.523 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7612555027008057
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.719 Vali Acc: 0.440 Test Loss: 5.719 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3712373
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4382741451263428
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.741 Vali Acc: 0.440 Test Loss: 1.741 Test Acc: 0.440
Validation loss decreased (inf --> -0.439983).  Saving model ...
Epoch: 2 cost time: 0.8745181560516357
Epoch: 2, Steps: 4 | Train Loss: 1.246 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8230793476104736
Epoch: 3, Steps: 4 | Train Loss: 0.724 Vali Loss: 2.071 Vali Acc: 0.400 Test Loss: 2.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8555629253387451
Epoch: 4, Steps: 4 | Train Loss: 0.416 Vali Loss: 2.727 Vali Acc: 0.480 Test Loss: 2.727 Test Acc: 0.480
Validation loss decreased (-0.439983 --> -0.479973).  Saving model ...
Epoch: 5 cost time: 0.7980442047119141
Epoch: 5, Steps: 4 | Train Loss: 0.389 Vali Loss: 2.729 Vali Acc: 0.420 Test Loss: 2.729 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9440217018127441
Epoch: 6, Steps: 4 | Train Loss: 0.139 Vali Loss: 3.549 Vali Acc: 0.380 Test Loss: 3.549 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8197002410888672
Epoch: 7, Steps: 4 | Train Loss: 0.031 Vali Loss: 4.152 Vali Acc: 0.380 Test Loss: 4.152 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9541463851928711
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.890 Vali Acc: 0.420 Test Loss: 4.890 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7906029224395752
Epoch: 9, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.988 Vali Acc: 0.380 Test Loss: 4.988 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0946745872497559
Epoch: 10, Steps: 4 | Train Loss: 0.017 Vali Loss: 5.034 Vali Acc: 0.420 Test Loss: 5.034 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8057262897491455
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.685 Vali Acc: 0.400 Test Loss: 6.685 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9367859363555908
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.908 Vali Acc: 0.420 Test Loss: 6.908 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0620875358581543
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.900 Vali Acc: 0.380 Test Loss: 6.900 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8854098320007324
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.831 Vali Acc: 0.380 Test Loss: 6.831 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3712223
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.956885814666748
Epoch: 1, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.575 Vali Acc: 0.300 Test Loss: 1.575 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.7018604278564453
Epoch: 2, Steps: 4 | Train Loss: 1.245 Vali Loss: 1.506 Vali Acc: 0.380 Test Loss: 1.506 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 0.6500699520111084
Epoch: 3, Steps: 4 | Train Loss: 0.600 Vali Loss: 1.790 Vali Acc: 0.480 Test Loss: 1.790 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479982).  Saving model ...
Epoch: 4 cost time: 0.8609085083007812
Epoch: 4, Steps: 4 | Train Loss: 0.323 Vali Loss: 2.174 Vali Acc: 0.560 Test Loss: 2.174 Test Acc: 0.560
Validation loss decreased (-0.479982 --> -0.559978).  Saving model ...
Epoch: 5 cost time: 0.7548670768737793
Epoch: 5, Steps: 4 | Train Loss: 0.108 Vali Loss: 2.812 Vali Acc: 0.440 Test Loss: 2.812 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.886460542678833
Epoch: 6, Steps: 4 | Train Loss: 0.060 Vali Loss: 3.484 Vali Acc: 0.500 Test Loss: 3.484 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8003301620483398
Epoch: 7, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.241 Vali Acc: 0.560 Test Loss: 4.241 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8560423851013184
Epoch: 8, Steps: 4 | Train Loss: 0.041 Vali Loss: 5.021 Vali Acc: 0.440 Test Loss: 5.021 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8798599243164062
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.956 Vali Acc: 0.460 Test Loss: 4.956 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.814690351486206
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.251 Vali Acc: 0.400 Test Loss: 5.251 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7982761859893799
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.719 Vali Acc: 0.440 Test Loss: 5.719 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7299072742462158
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.190 Vali Acc: 0.440 Test Loss: 6.190 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8393261432647705
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.588 Vali Acc: 0.440 Test Loss: 6.588 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7360730171203613
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.723 Vali Acc: 0.440 Test Loss: 6.723 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3713491
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0217831134796143
Epoch: 1, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.536 Vali Acc: 0.260 Test Loss: 1.536 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 0.9217805862426758
Epoch: 2, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.601 Vali Acc: 0.360 Test Loss: 1.601 Test Acc: 0.360
Validation loss decreased (-0.259985 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 1.0226261615753174
Epoch: 3, Steps: 4 | Train Loss: 0.679 Vali Loss: 2.271 Vali Acc: 0.440 Test Loss: 2.271 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439977).  Saving model ...
Epoch: 4 cost time: 0.9469892978668213
Epoch: 4, Steps: 4 | Train Loss: 0.536 Vali Loss: 2.596 Vali Acc: 0.440 Test Loss: 2.596 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1270442008972168
Epoch: 5, Steps: 4 | Train Loss: 0.142 Vali Loss: 3.129 Vali Acc: 0.440 Test Loss: 3.129 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9800155162811279
Epoch: 6, Steps: 4 | Train Loss: 0.124 Vali Loss: 3.136 Vali Acc: 0.440 Test Loss: 3.136 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9418647289276123
Epoch: 7, Steps: 4 | Train Loss: 0.044 Vali Loss: 4.035 Vali Acc: 0.420 Test Loss: 4.035 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.995455265045166
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.566 Vali Acc: 0.440 Test Loss: 5.566 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9704864025115967
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.278 Vali Acc: 0.440 Test Loss: 6.278 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9244930744171143
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.472 Vali Acc: 0.400 Test Loss: 6.472 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9397547245025635
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.630 Vali Acc: 0.380 Test Loss: 6.630 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.165285587310791
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.792 Vali Acc: 0.380 Test Loss: 6.792 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9473185539245605
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.953 Vali Acc: 0.400 Test Loss: 6.953 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 3713683
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.157667398452759
Epoch: 1, Steps: 4 | Train Loss: 1.683 Vali Loss: 1.572 Vali Acc: 0.300 Test Loss: 1.572 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.8034179210662842
Epoch: 2, Steps: 4 | Train Loss: 1.268 Vali Loss: 1.750 Vali Acc: 0.400 Test Loss: 1.750 Test Acc: 0.400
Validation loss decreased (-0.299984 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 0.8723430633544922
Epoch: 3, Steps: 4 | Train Loss: 0.630 Vali Loss: 1.919 Vali Acc: 0.500 Test Loss: 1.919 Test Acc: 0.500
Validation loss decreased (-0.399983 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 0.8125929832458496
Epoch: 4, Steps: 4 | Train Loss: 0.245 Vali Loss: 2.623 Vali Acc: 0.500 Test Loss: 2.623 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8527204990386963
Epoch: 5, Steps: 4 | Train Loss: 0.115 Vali Loss: 3.245 Vali Acc: 0.500 Test Loss: 3.245 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9736018180847168
Epoch: 6, Steps: 4 | Train Loss: 0.079 Vali Loss: 3.867 Vali Acc: 0.500 Test Loss: 3.867 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0516295433044434
Epoch: 7, Steps: 4 | Train Loss: 0.032 Vali Loss: 4.359 Vali Acc: 0.460 Test Loss: 4.359 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0411639213562012
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.067 Vali Acc: 0.520 Test Loss: 5.067 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519949).  Saving model ...
Epoch: 9 cost time: 0.9947350025177002
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.485 Vali Acc: 0.520 Test Loss: 5.485 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8991737365722656
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.669 Vali Acc: 0.540 Test Loss: 5.669 Test Acc: 0.540
Validation loss decreased (-0.519949 --> -0.539943).  Saving model ...
Epoch: 11 cost time: 0.9956657886505127
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.790 Vali Acc: 0.540 Test Loss: 5.790 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8843438625335693
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.886 Vali Acc: 0.540 Test Loss: 5.886 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9427831172943115
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.958 Vali Acc: 0.520 Test Loss: 5.958 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.925147533416748
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.013 Vali Acc: 0.520 Test Loss: 6.013 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0780155658721924
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.055 Vali Acc: 0.520 Test Loss: 6.055 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9079151153564453
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.091 Vali Acc: 0.520 Test Loss: 6.091 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.086611032485962
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.120 Vali Acc: 0.520 Test Loss: 6.120 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0008256435394287
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.142 Vali Acc: 0.520 Test Loss: 6.142 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8278708457946777
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.175 Vali Acc: 0.520 Test Loss: 6.175 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9112417697906494
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.202 Vali Acc: 0.520 Test Loss: 6.202 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3712799
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3128533363342285
Epoch: 1, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.651 Vali Acc: 0.340 Test Loss: 1.651 Test Acc: 0.340
Validation loss decreased (inf --> -0.339983).  Saving model ...
Epoch: 2 cost time: 0.932504415512085
Epoch: 2, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.457 Vali Acc: 0.340 Test Loss: 1.457 Test Acc: 0.340
Validation loss decreased (-0.339983 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 0.9004766941070557
Epoch: 3, Steps: 4 | Train Loss: 0.540 Vali Loss: 1.969 Vali Acc: 0.360 Test Loss: 1.969 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359980).  Saving model ...
Epoch: 4 cost time: 0.9514403343200684
Epoch: 4, Steps: 4 | Train Loss: 0.271 Vali Loss: 2.323 Vali Acc: 0.360 Test Loss: 2.323 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.937739372253418
Epoch: 5, Steps: 4 | Train Loss: 0.132 Vali Loss: 3.911 Vali Acc: 0.460 Test Loss: 3.911 Test Acc: 0.460
Validation loss decreased (-0.359980 --> -0.459961).  Saving model ...
Epoch: 6 cost time: 0.9213278293609619
Epoch: 6, Steps: 4 | Train Loss: 0.253 Vali Loss: 3.838 Vali Acc: 0.520 Test Loss: 3.838 Test Acc: 0.520
Validation loss decreased (-0.459961 --> -0.519962).  Saving model ...
Epoch: 7 cost time: 0.8607573509216309
Epoch: 7, Steps: 4 | Train Loss: 0.022 Vali Loss: 4.793 Vali Acc: 0.460 Test Loss: 4.793 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8399028778076172
Epoch: 8, Steps: 4 | Train Loss: 0.068 Vali Loss: 6.309 Vali Acc: 0.500 Test Loss: 6.309 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9163544178009033
Epoch: 9, Steps: 4 | Train Loss: 0.058 Vali Loss: 7.367 Vali Acc: 0.480 Test Loss: 7.367 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8716518878936768
Epoch: 10, Steps: 4 | Train Loss: 0.026 Vali Loss: 6.197 Vali Acc: 0.380 Test Loss: 6.197 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8945193290710449
Epoch: 11, Steps: 4 | Train Loss: 0.029 Vali Loss: 6.884 Vali Acc: 0.420 Test Loss: 6.884 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8442106246948242
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.788 Vali Acc: 0.420 Test Loss: 7.788 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.996985673904419
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.823 Vali Acc: 0.400 Test Loss: 6.823 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9967765808105469
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.378 Vali Acc: 0.440 Test Loss: 6.378 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9495432376861572
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.909 Vali Acc: 0.420 Test Loss: 5.909 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8179919719696045
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.727 Vali Acc: 0.420 Test Loss: 5.727 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3714683
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2480108737945557
Epoch: 1, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.710 Vali Acc: 0.140 Test Loss: 1.710 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 0.8827297687530518
Epoch: 2, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.691 Vali Acc: 0.400 Test Loss: 1.691 Test Acc: 0.400
Validation loss decreased (-0.139983 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 0.8519768714904785
Epoch: 3, Steps: 4 | Train Loss: 0.572 Vali Loss: 1.990 Vali Acc: 0.480 Test Loss: 1.990 Test Acc: 0.480
Validation loss decreased (-0.399983 --> -0.479980).  Saving model ...
Epoch: 4 cost time: 0.8385410308837891
Epoch: 4, Steps: 4 | Train Loss: 0.701 Vali Loss: 2.548 Vali Acc: 0.500 Test Loss: 2.548 Test Acc: 0.500
Validation loss decreased (-0.479980 --> -0.499975).  Saving model ...
Epoch: 5 cost time: 0.9550073146820068
Epoch: 5, Steps: 4 | Train Loss: 0.128 Vali Loss: 3.106 Vali Acc: 0.440 Test Loss: 3.106 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8680820465087891
Epoch: 6, Steps: 4 | Train Loss: 0.123 Vali Loss: 3.304 Vali Acc: 0.480 Test Loss: 3.304 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9474644660949707
Epoch: 7, Steps: 4 | Train Loss: 0.264 Vali Loss: 3.677 Vali Acc: 0.500 Test Loss: 3.677 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9397664070129395
Epoch: 8, Steps: 4 | Train Loss: 0.052 Vali Loss: 3.653 Vali Acc: 0.440 Test Loss: 3.653 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.882188081741333
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.813 Vali Acc: 0.460 Test Loss: 4.813 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.885502815246582
Epoch: 10, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.787 Vali Acc: 0.460 Test Loss: 5.787 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8188107013702393
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.475 Vali Acc: 0.440 Test Loss: 6.475 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8707175254821777
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.115 Vali Acc: 0.440 Test Loss: 7.115 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9843714237213135
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.603 Vali Acc: 0.420 Test Loss: 7.603 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8510515689849854
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.899 Vali Acc: 0.440 Test Loss: 7.899 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3711917
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2672362327575684
Epoch: 1, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.110870599746704
Epoch: 2, Steps: 4 | Train Loss: 0.980 Vali Loss: 2.024 Vali Acc: 0.300 Test Loss: 2.024 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299980).  Saving model ...
Epoch: 3 cost time: 1.076136827468872
Epoch: 3, Steps: 4 | Train Loss: 0.644 Vali Loss: 2.355 Vali Acc: 0.380 Test Loss: 2.355 Test Acc: 0.380
Validation loss decreased (-0.299980 --> -0.379976).  Saving model ...
Epoch: 4 cost time: 0.8913297653198242
Epoch: 4, Steps: 4 | Train Loss: 0.413 Vali Loss: 2.049 Vali Acc: 0.500 Test Loss: 2.049 Test Acc: 0.500
Validation loss decreased (-0.379976 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 0.9555778503417969
Epoch: 5, Steps: 4 | Train Loss: 0.149 Vali Loss: 3.568 Vali Acc: 0.420 Test Loss: 3.568 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9958140850067139
Epoch: 6, Steps: 4 | Train Loss: 0.130 Vali Loss: 2.764 Vali Acc: 0.460 Test Loss: 2.764 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9288890361785889
Epoch: 7, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.321 Vali Acc: 0.440 Test Loss: 3.321 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8809218406677246
Epoch: 8, Steps: 4 | Train Loss: 0.025 Vali Loss: 3.876 Vali Acc: 0.460 Test Loss: 3.876 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0323235988616943
Epoch: 9, Steps: 4 | Train Loss: 0.020 Vali Loss: 4.672 Vali Acc: 0.420 Test Loss: 4.672 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9207296371459961
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.160 Vali Acc: 0.400 Test Loss: 5.160 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8990392684936523
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.824 Vali Acc: 0.440 Test Loss: 5.824 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.971898078918457
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.089 Vali Acc: 0.420 Test Loss: 6.089 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0069575309753418
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.795 Vali Acc: 0.460 Test Loss: 5.795 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8970444202423096
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.547 Vali Acc: 0.460 Test Loss: 5.547 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3712459
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4420928955078125
Epoch: 1, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.604 Vali Acc: 0.280 Test Loss: 1.604 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.017580270767212
Epoch: 2, Steps: 4 | Train Loss: 1.192 Vali Loss: 1.577 Vali Acc: 0.420 Test Loss: 1.577 Test Acc: 0.420
Validation loss decreased (-0.279984 --> -0.419984).  Saving model ...
Epoch: 3 cost time: 0.930617094039917
Epoch: 3, Steps: 4 | Train Loss: 0.484 Vali Loss: 2.131 Vali Acc: 0.320 Test Loss: 2.131 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.067302942276001
Epoch: 4, Steps: 4 | Train Loss: 0.301 Vali Loss: 2.925 Vali Acc: 0.460 Test Loss: 2.925 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459971).  Saving model ...
Epoch: 5 cost time: 0.9844837188720703
Epoch: 5, Steps: 4 | Train Loss: 0.179 Vali Loss: 3.077 Vali Acc: 0.480 Test Loss: 3.077 Test Acc: 0.480
Validation loss decreased (-0.459971 --> -0.479969).  Saving model ...
Epoch: 6 cost time: 1.002328634262085
Epoch: 6, Steps: 4 | Train Loss: 0.151 Vali Loss: 3.855 Vali Acc: 0.460 Test Loss: 3.855 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1055526733398438
Epoch: 7, Steps: 4 | Train Loss: 0.074 Vali Loss: 5.786 Vali Acc: 0.360 Test Loss: 5.786 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0207667350769043
Epoch: 8, Steps: 4 | Train Loss: 0.039 Vali Loss: 4.078 Vali Acc: 0.460 Test Loss: 4.078 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.110827922821045
Epoch: 9, Steps: 4 | Train Loss: 0.009 Vali Loss: 5.027 Vali Acc: 0.420 Test Loss: 5.027 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8651576042175293
Epoch: 10, Steps: 4 | Train Loss: 0.033 Vali Loss: 5.626 Vali Acc: 0.380 Test Loss: 5.626 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9986402988433838
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.683 Vali Acc: 0.460 Test Loss: 5.683 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0265204906463623
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.489 Vali Acc: 0.400 Test Loss: 6.489 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9750726222991943
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.428 Vali Acc: 0.440 Test Loss: 7.428 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9720683097839355
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.708 Vali Acc: 0.460 Test Loss: 8.708 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.047180414199829
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.410 Vali Acc: 0.440 Test Loss: 9.410 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3712465
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3295466899871826
Epoch: 1, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.659 Vali Acc: 0.360 Test Loss: 1.659 Test Acc: 0.360
Validation loss decreased (inf --> -0.359983).  Saving model ...
Epoch: 2 cost time: 1.1295690536499023
Epoch: 2, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.585 Vali Acc: 0.460 Test Loss: 1.585 Test Acc: 0.460
Validation loss decreased (-0.359983 --> -0.459984).  Saving model ...
Epoch: 3 cost time: 1.046729326248169
Epoch: 3, Steps: 4 | Train Loss: 0.755 Vali Loss: 1.814 Vali Acc: 0.340 Test Loss: 1.814 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0119714736938477
Epoch: 4, Steps: 4 | Train Loss: 0.363 Vali Loss: 2.912 Vali Acc: 0.460 Test Loss: 2.912 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0897798538208008
Epoch: 5, Steps: 4 | Train Loss: 0.184 Vali Loss: 3.031 Vali Acc: 0.400 Test Loss: 3.031 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0450642108917236
Epoch: 6, Steps: 4 | Train Loss: 0.078 Vali Loss: 4.250 Vali Acc: 0.460 Test Loss: 4.250 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9437391757965088
Epoch: 7, Steps: 4 | Train Loss: 0.076 Vali Loss: 3.866 Vali Acc: 0.440 Test Loss: 3.866 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0317332744598389
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.067 Vali Acc: 0.400 Test Loss: 4.067 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3014121055603027
Epoch: 9, Steps: 4 | Train Loss: 0.019 Vali Loss: 4.649 Vali Acc: 0.420 Test Loss: 4.649 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1700172424316406
Epoch: 10, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.761 Vali Acc: 0.440 Test Loss: 4.761 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0252556800842285
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.912 Vali Acc: 0.440 Test Loss: 4.912 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.058192253112793
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.023 Vali Acc: 0.460 Test Loss: 5.023 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3711935
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4200193881988525
Epoch: 1, Steps: 4 | Train Loss: 1.602 Vali Loss: 1.621 Vali Acc: 0.260 Test Loss: 1.621 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.0418310165405273
Epoch: 2, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.755 Vali Acc: 0.380 Test Loss: 1.755 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379982).  Saving model ...
Epoch: 3 cost time: 1.0622825622558594
Epoch: 3, Steps: 4 | Train Loss: 0.588 Vali Loss: 1.760 Vali Acc: 0.440 Test Loss: 1.760 Test Acc: 0.440
Validation loss decreased (-0.379982 --> -0.439982).  Saving model ...
Epoch: 4 cost time: 1.0525829792022705
Epoch: 4, Steps: 4 | Train Loss: 0.246 Vali Loss: 2.276 Vali Acc: 0.460 Test Loss: 2.276 Test Acc: 0.460
Validation loss decreased (-0.439982 --> -0.459977).  Saving model ...
Epoch: 5 cost time: 0.9219365119934082
Epoch: 5, Steps: 4 | Train Loss: 0.160 Vali Loss: 2.846 Vali Acc: 0.420 Test Loss: 2.846 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.120612621307373
Epoch: 6, Steps: 4 | Train Loss: 0.091 Vali Loss: 4.252 Vali Acc: 0.460 Test Loss: 4.252 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0413684844970703
Epoch: 7, Steps: 4 | Train Loss: 0.044 Vali Loss: 4.711 Vali Acc: 0.440 Test Loss: 4.711 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0178484916687012
Epoch: 8, Steps: 4 | Train Loss: 0.064 Vali Loss: 6.256 Vali Acc: 0.480 Test Loss: 6.256 Test Acc: 0.480
Validation loss decreased (-0.459977 --> -0.479937).  Saving model ...
Epoch: 9 cost time: 0.9560661315917969
Epoch: 9, Steps: 4 | Train Loss: 0.030 Vali Loss: 6.499 Vali Acc: 0.440 Test Loss: 6.499 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1161518096923828
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.923 Vali Acc: 0.520 Test Loss: 6.923 Test Acc: 0.520
Validation loss decreased (-0.479937 --> -0.519931).  Saving model ...
Epoch: 11 cost time: 1.0272216796875
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.273 Vali Acc: 0.420 Test Loss: 7.273 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9970085620880127
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.658 Vali Acc: 0.380 Test Loss: 8.658 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9039590358734131
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.376 Vali Acc: 0.400 Test Loss: 9.376 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9753625392913818
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.741 Vali Acc: 0.400 Test Loss: 9.741 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.095414638519287
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.927 Vali Acc: 0.400 Test Loss: 9.927 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9454233646392822
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.989 Vali Acc: 0.400 Test Loss: 9.989 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.870542049407959
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.972 Vali Acc: 0.420 Test Loss: 9.972 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0592319965362549
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.867 Vali Acc: 0.420 Test Loss: 9.867 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9728763103485107
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.779 Vali Acc: 0.400 Test Loss: 9.779 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0233137607574463
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.708 Vali Acc: 0.400 Test Loss: 9.708 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3714731
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.248932361602783
Epoch: 1, Steps: 4 | Train Loss: 1.790 Vali Loss: 1.656 Vali Acc: 0.340 Test Loss: 1.656 Test Acc: 0.340
Validation loss decreased (inf --> -0.339983).  Saving model ...
Epoch: 2 cost time: 0.894383430480957
Epoch: 2, Steps: 4 | Train Loss: 1.068 Vali Loss: 1.553 Vali Acc: 0.400 Test Loss: 1.553 Test Acc: 0.400
Validation loss decreased (-0.339983 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.9132094383239746
Epoch: 3, Steps: 4 | Train Loss: 0.691 Vali Loss: 1.913 Vali Acc: 0.420 Test Loss: 1.913 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419981).  Saving model ...
Epoch: 4 cost time: 0.9615302085876465
Epoch: 4, Steps: 4 | Train Loss: 0.292 Vali Loss: 2.441 Vali Acc: 0.480 Test Loss: 2.441 Test Acc: 0.480
Validation loss decreased (-0.419981 --> -0.479976).  Saving model ...
Epoch: 5 cost time: 0.9595897197723389
Epoch: 5, Steps: 4 | Train Loss: 0.183 Vali Loss: 2.913 Vali Acc: 0.500 Test Loss: 2.913 Test Acc: 0.500
Validation loss decreased (-0.479976 --> -0.499971).  Saving model ...
Epoch: 6 cost time: 0.9483680725097656
Epoch: 6, Steps: 4 | Train Loss: 0.099 Vali Loss: 3.551 Vali Acc: 0.420 Test Loss: 3.551 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0229015350341797
Epoch: 7, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.570 Vali Acc: 0.480 Test Loss: 3.570 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9488956928253174
Epoch: 8, Steps: 4 | Train Loss: 0.030 Vali Loss: 3.649 Vali Acc: 0.540 Test Loss: 3.649 Test Acc: 0.540
Validation loss decreased (-0.499971 --> -0.539964).  Saving model ...
Epoch: 9 cost time: 0.853757381439209
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.109 Vali Acc: 0.420 Test Loss: 5.109 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8469367027282715
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.408 Vali Acc: 0.420 Test Loss: 6.408 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9334495067596436
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.283 Vali Acc: 0.440 Test Loss: 6.283 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0085134506225586
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.301 Vali Acc: 0.440 Test Loss: 5.301 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0888161659240723
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.809 Vali Acc: 0.400 Test Loss: 4.809 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0537023544311523
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.635 Vali Acc: 0.400 Test Loss: 4.635 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0763194561004639
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.627 Vali Acc: 0.380 Test Loss: 4.627 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8719913959503174
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.697 Vali Acc: 0.420 Test Loss: 4.697 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.901400089263916
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.808 Vali Acc: 0.460 Test Loss: 4.808 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8278818130493164
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.933 Vali Acc: 0.480 Test Loss: 4.933 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3712863
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.400456666946411
Epoch: 1, Steps: 4 | Train Loss: 1.770 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.1166255474090576
Epoch: 2, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.825 Vali Acc: 0.340 Test Loss: 1.825 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0301220417022705
Epoch: 3, Steps: 4 | Train Loss: 0.802 Vali Loss: 2.423 Vali Acc: 0.300 Test Loss: 2.423 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0482120513916016
Epoch: 4, Steps: 4 | Train Loss: 0.873 Vali Loss: 2.726 Vali Acc: 0.320 Test Loss: 2.726 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9851913452148438
Epoch: 5, Steps: 4 | Train Loss: 0.331 Vali Loss: 2.924 Vali Acc: 0.380 Test Loss: 2.924 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9299962520599365
Epoch: 6, Steps: 4 | Train Loss: 0.609 Vali Loss: 3.099 Vali Acc: 0.440 Test Loss: 3.099 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439969).  Saving model ...
Epoch: 7 cost time: 0.8324606418609619
Epoch: 7, Steps: 4 | Train Loss: 0.231 Vali Loss: 3.226 Vali Acc: 0.460 Test Loss: 3.226 Test Acc: 0.460
Validation loss decreased (-0.439969 --> -0.459968).  Saving model ...
Epoch: 8 cost time: 0.852527379989624
Epoch: 8, Steps: 4 | Train Loss: 0.101 Vali Loss: 3.466 Vali Acc: 0.480 Test Loss: 3.466 Test Acc: 0.480
Validation loss decreased (-0.459968 --> -0.479965).  Saving model ...
Epoch: 9 cost time: 0.8270461559295654
Epoch: 9, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.917 Vali Acc: 0.440 Test Loss: 3.917 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.13555908203125
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 5.635 Vali Acc: 0.420 Test Loss: 5.635 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.059356451034546
Epoch: 11, Steps: 4 | Train Loss: 0.036 Vali Loss: 7.704 Vali Acc: 0.380 Test Loss: 7.704 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9892945289611816
Epoch: 12, Steps: 4 | Train Loss: 0.114 Vali Loss: 6.457 Vali Acc: 0.340 Test Loss: 6.457 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8906614780426025
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.091 Vali Acc: 0.380 Test Loss: 6.091 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9313907623291016
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.446 Vali Acc: 0.420 Test Loss: 6.446 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9687190055847168
Epoch: 15, Steps: 4 | Train Loss: 0.015 Vali Loss: 6.447 Vali Acc: 0.460 Test Loss: 6.447 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0564415454864502
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.082 Vali Acc: 0.340 Test Loss: 7.082 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9335105419158936
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.419 Vali Acc: 0.440 Test Loss: 6.419 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9628121852874756
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.283 Vali Acc: 0.300 Test Loss: 7.283 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3707711
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5260162353515625
Epoch: 1, Steps: 4 | Train Loss: 1.613 Vali Loss: 1.457 Vali Acc: 0.260 Test Loss: 1.457 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 0.8608148097991943
Epoch: 2, Steps: 4 | Train Loss: 1.132 Vali Loss: 1.833 Vali Acc: 0.400 Test Loss: 1.833 Test Acc: 0.400
Validation loss decreased (-0.259985 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 0.8635067939758301
Epoch: 3, Steps: 4 | Train Loss: 0.696 Vali Loss: 2.078 Vali Acc: 0.420 Test Loss: 2.078 Test Acc: 0.420
Validation loss decreased (-0.399982 --> -0.419979).  Saving model ...
Epoch: 4 cost time: 0.8130645751953125
Epoch: 4, Steps: 4 | Train Loss: 0.416 Vali Loss: 2.590 Vali Acc: 0.360 Test Loss: 2.590 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7591688632965088
Epoch: 5, Steps: 4 | Train Loss: 0.167 Vali Loss: 3.321 Vali Acc: 0.340 Test Loss: 3.321 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9496395587921143
Epoch: 6, Steps: 4 | Train Loss: 0.161 Vali Loss: 3.850 Vali Acc: 0.400 Test Loss: 3.850 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8071303367614746
Epoch: 7, Steps: 4 | Train Loss: 0.146 Vali Loss: 4.939 Vali Acc: 0.480 Test Loss: 4.939 Test Acc: 0.480
Validation loss decreased (-0.419979 --> -0.479951).  Saving model ...
Epoch: 8 cost time: 0.8207225799560547
Epoch: 8, Steps: 4 | Train Loss: 0.189 Vali Loss: 5.166 Vali Acc: 0.420 Test Loss: 5.166 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7618036270141602
Epoch: 9, Steps: 4 | Train Loss: 0.068 Vali Loss: 5.124 Vali Acc: 0.380 Test Loss: 5.124 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8780808448791504
Epoch: 10, Steps: 4 | Train Loss: 0.058 Vali Loss: 5.625 Vali Acc: 0.440 Test Loss: 5.625 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8524808883666992
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 6.336 Vali Acc: 0.400 Test Loss: 6.336 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0110907554626465
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.258 Vali Acc: 0.400 Test Loss: 6.258 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7993927001953125
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.198 Vali Acc: 0.440 Test Loss: 6.198 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8968262672424316
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.972 Vali Acc: 0.420 Test Loss: 5.972 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7798135280609131
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.098 Vali Acc: 0.480 Test Loss: 6.098 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8137729167938232
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.427 Vali Acc: 0.460 Test Loss: 6.427 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8172016143798828
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.768 Vali Acc: 0.440 Test Loss: 6.768 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3706285
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.172560214996338
Epoch: 1, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.608 Vali Acc: 0.320 Test Loss: 1.608 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 0.9092056751251221
Epoch: 2, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.630 Vali Acc: 0.280 Test Loss: 1.630 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9749536514282227
Epoch: 3, Steps: 4 | Train Loss: 0.739 Vali Loss: 2.036 Vali Acc: 0.480 Test Loss: 2.036 Test Acc: 0.480
Validation loss decreased (-0.319984 --> -0.479980).  Saving model ...
Epoch: 4 cost time: 0.8533260822296143
Epoch: 4, Steps: 4 | Train Loss: 0.638 Vali Loss: 2.653 Vali Acc: 0.480 Test Loss: 2.653 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.982067346572876
Epoch: 5, Steps: 4 | Train Loss: 0.249 Vali Loss: 3.513 Vali Acc: 0.480 Test Loss: 3.513 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.814293384552002
Epoch: 6, Steps: 4 | Train Loss: 0.286 Vali Loss: 3.317 Vali Acc: 0.460 Test Loss: 3.317 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9599430561065674
Epoch: 7, Steps: 4 | Train Loss: 0.158 Vali Loss: 4.868 Vali Acc: 0.440 Test Loss: 4.868 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.950324535369873
Epoch: 8, Steps: 4 | Train Loss: 0.064 Vali Loss: 6.845 Vali Acc: 0.440 Test Loss: 6.845 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8738882541656494
Epoch: 9, Steps: 4 | Train Loss: 0.103 Vali Loss: 6.537 Vali Acc: 0.360 Test Loss: 6.537 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.784090518951416
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 5.916 Vali Acc: 0.420 Test Loss: 5.916 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7849128246307373
Epoch: 11, Steps: 4 | Train Loss: 0.014 Vali Loss: 6.183 Vali Acc: 0.480 Test Loss: 6.183 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9472205638885498
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.581 Vali Acc: 0.480 Test Loss: 6.581 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9424324035644531
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.803 Vali Acc: 0.480 Test Loss: 6.803 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3706139
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8288662433624268
Epoch: 1, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.668 Vali Acc: 0.340 Test Loss: 1.668 Test Acc: 0.340
Validation loss decreased (inf --> -0.339983).  Saving model ...
Epoch: 2 cost time: 0.8940615653991699
Epoch: 2, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.983 Vali Acc: 0.400 Test Loss: 1.983 Test Acc: 0.400
Validation loss decreased (-0.339983 --> -0.399980).  Saving model ...
Epoch: 3 cost time: 0.9255170822143555
Epoch: 3, Steps: 4 | Train Loss: 0.643 Vali Loss: 2.205 Vali Acc: 0.280 Test Loss: 2.205 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8031244277954102
Epoch: 4, Steps: 4 | Train Loss: 0.558 Vali Loss: 2.729 Vali Acc: 0.340 Test Loss: 2.729 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8422796726226807
Epoch: 5, Steps: 4 | Train Loss: 0.315 Vali Loss: 3.213 Vali Acc: 0.460 Test Loss: 3.213 Test Acc: 0.460
Validation loss decreased (-0.399980 --> -0.459968).  Saving model ...
Epoch: 6 cost time: 0.9304203987121582
Epoch: 6, Steps: 4 | Train Loss: 0.379 Vali Loss: 3.629 Vali Acc: 0.340 Test Loss: 3.629 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8251461982727051
Epoch: 7, Steps: 4 | Train Loss: 0.096 Vali Loss: 4.591 Vali Acc: 0.480 Test Loss: 4.591 Test Acc: 0.480
Validation loss decreased (-0.459968 --> -0.479954).  Saving model ...
Epoch: 8 cost time: 0.9008562564849854
Epoch: 8, Steps: 4 | Train Loss: 0.220 Vali Loss: 3.990 Vali Acc: 0.500 Test Loss: 3.990 Test Acc: 0.500
Validation loss decreased (-0.479954 --> -0.499960).  Saving model ...
Epoch: 9 cost time: 0.8207662105560303
Epoch: 9, Steps: 4 | Train Loss: 0.043 Vali Loss: 3.385 Vali Acc: 0.500 Test Loss: 3.385 Test Acc: 0.500
Validation loss decreased (-0.499960 --> -0.499966).  Saving model ...
Epoch: 10 cost time: 0.836766242980957
Epoch: 10, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.218 Vali Acc: 0.400 Test Loss: 4.218 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8227651119232178
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.018 Vali Acc: 0.520 Test Loss: 5.018 Test Acc: 0.520
Validation loss decreased (-0.499966 --> -0.519950).  Saving model ...
Epoch: 12 cost time: 0.7834970951080322
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.270 Vali Acc: 0.420 Test Loss: 5.270 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7994513511657715
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.589 Vali Acc: 0.480 Test Loss: 5.589 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8483121395111084
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.715 Vali Acc: 0.480 Test Loss: 5.715 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8746275901794434
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.772 Vali Acc: 0.480 Test Loss: 5.772 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7447052001953125
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.845 Vali Acc: 0.520 Test Loss: 5.845 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9026439189910889
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.914 Vali Acc: 0.540 Test Loss: 5.914 Test Acc: 0.540
Validation loss decreased (-0.519950 --> -0.539941).  Saving model ...
Epoch: 18 cost time: 0.9297094345092773
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.972 Vali Acc: 0.540 Test Loss: 5.972 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9232673645019531
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.014 Vali Acc: 0.540 Test Loss: 6.014 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9056046009063721
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.043 Vali Acc: 0.540 Test Loss: 6.043 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8853976726531982
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.062 Vali Acc: 0.520 Test Loss: 6.062 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9148473739624023
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.071 Vali Acc: 0.520 Test Loss: 6.071 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9695518016815186
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.073 Vali Acc: 0.520 Test Loss: 6.073 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8052628040313721
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.071 Vali Acc: 0.520 Test Loss: 6.071 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9951455593109131
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.068 Vali Acc: 0.520 Test Loss: 6.068 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.868192195892334
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.062 Vali Acc: 0.520 Test Loss: 6.062 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9715468883514404
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.053 Vali Acc: 0.520 Test Loss: 6.053 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3705173
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3264784812927246
Epoch: 1, Steps: 4 | Train Loss: 1.587 Vali Loss: 1.796 Vali Acc: 0.320 Test Loss: 1.796 Test Acc: 0.320
Validation loss decreased (inf --> -0.319982).  Saving model ...
Epoch: 2 cost time: 1.0692224502563477
Epoch: 2, Steps: 4 | Train Loss: 0.974 Vali Loss: 2.379 Vali Acc: 0.220 Test Loss: 2.379 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1573646068572998
Epoch: 3, Steps: 4 | Train Loss: 0.756 Vali Loss: 2.287 Vali Acc: 0.400 Test Loss: 2.287 Test Acc: 0.400
Validation loss decreased (-0.319982 --> -0.399977).  Saving model ...
Epoch: 4 cost time: 0.8504338264465332
Epoch: 4, Steps: 4 | Train Loss: 0.324 Vali Loss: 3.755 Vali Acc: 0.280 Test Loss: 3.755 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0309381484985352
Epoch: 5, Steps: 4 | Train Loss: 0.448 Vali Loss: 4.227 Vali Acc: 0.280 Test Loss: 4.227 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9255108833312988
Epoch: 6, Steps: 4 | Train Loss: 0.382 Vali Loss: 2.912 Vali Acc: 0.520 Test Loss: 2.912 Test Acc: 0.520
Validation loss decreased (-0.399977 --> -0.519971).  Saving model ...
Epoch: 7 cost time: 0.8899352550506592
Epoch: 7, Steps: 4 | Train Loss: 0.077 Vali Loss: 4.475 Vali Acc: 0.500 Test Loss: 4.475 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.941821813583374
Epoch: 8, Steps: 4 | Train Loss: 0.125 Vali Loss: 4.259 Vali Acc: 0.480 Test Loss: 4.259 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8487005233764648
Epoch: 9, Steps: 4 | Train Loss: 0.056 Vali Loss: 4.283 Vali Acc: 0.480 Test Loss: 4.283 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0751259326934814
Epoch: 10, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.466 Vali Acc: 0.420 Test Loss: 4.466 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7766122817993164
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 5.338 Vali Acc: 0.500 Test Loss: 5.338 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1812891960144043
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.069 Vali Acc: 0.520 Test Loss: 6.069 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7773208618164062
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.220 Vali Acc: 0.440 Test Loss: 6.220 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8743622303009033
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.653 Vali Acc: 0.420 Test Loss: 6.653 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.927121639251709
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.049 Vali Acc: 0.420 Test Loss: 7.049 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.032252550125122
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.951 Vali Acc: 0.460 Test Loss: 7.951 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3704911
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.128291606903076
Epoch: 1, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.413 Vali Acc: 0.340 Test Loss: 1.413 Test Acc: 0.340
Validation loss decreased (inf --> -0.339986).  Saving model ...
Epoch: 2 cost time: 0.908313512802124
Epoch: 2, Steps: 4 | Train Loss: 1.349 Vali Loss: 1.810 Vali Acc: 0.420 Test Loss: 1.810 Test Acc: 0.420
Validation loss decreased (-0.339986 --> -0.419982).  Saving model ...
Epoch: 3 cost time: 1.0645020008087158
Epoch: 3, Steps: 4 | Train Loss: 0.620 Vali Loss: 1.699 Vali Acc: 0.480 Test Loss: 1.699 Test Acc: 0.480
Validation loss decreased (-0.419982 --> -0.479983).  Saving model ...
Epoch: 4 cost time: 0.9511957168579102
Epoch: 4, Steps: 4 | Train Loss: 0.338 Vali Loss: 2.747 Vali Acc: 0.440 Test Loss: 2.747 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.033212423324585
Epoch: 5, Steps: 4 | Train Loss: 0.143 Vali Loss: 3.408 Vali Acc: 0.380 Test Loss: 3.408 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9912991523742676
Epoch: 6, Steps: 4 | Train Loss: 0.183 Vali Loss: 3.111 Vali Acc: 0.520 Test Loss: 3.111 Test Acc: 0.520
Validation loss decreased (-0.479983 --> -0.519969).  Saving model ...
Epoch: 7 cost time: 0.8984668254852295
Epoch: 7, Steps: 4 | Train Loss: 0.034 Vali Loss: 3.686 Vali Acc: 0.540 Test Loss: 3.686 Test Acc: 0.540
Validation loss decreased (-0.519969 --> -0.539963).  Saving model ...
Epoch: 8 cost time: 0.8637261390686035
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.523 Vali Acc: 0.420 Test Loss: 4.523 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8775298595428467
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.755 Vali Acc: 0.500 Test Loss: 4.755 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.011911153793335
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.196 Vali Acc: 0.500 Test Loss: 5.196 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8126699924468994
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.344 Vali Acc: 0.460 Test Loss: 5.344 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9229190349578857
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.390 Vali Acc: 0.400 Test Loss: 5.390 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9603004455566406
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.468 Vali Acc: 0.440 Test Loss: 5.468 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9714031219482422
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.606 Vali Acc: 0.460 Test Loss: 5.606 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0385854244232178
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.778 Vali Acc: 0.500 Test Loss: 5.778 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8964300155639648
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.950 Vali Acc: 0.540 Test Loss: 5.950 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0218665599822998
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.112 Vali Acc: 0.540 Test Loss: 6.112 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3705559
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.345783233642578
Epoch: 1, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.294215440750122
Epoch: 2, Steps: 4 | Train Loss: 1.253 Vali Loss: 1.801 Vali Acc: 0.460 Test Loss: 1.801 Test Acc: 0.460
Validation loss decreased (-0.239984 --> -0.459982).  Saving model ...
Epoch: 3 cost time: 1.096452236175537
Epoch: 3, Steps: 4 | Train Loss: 1.098 Vali Loss: 2.026 Vali Acc: 0.320 Test Loss: 2.026 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0358021259307861
Epoch: 4, Steps: 4 | Train Loss: 0.604 Vali Loss: 2.450 Vali Acc: 0.340 Test Loss: 2.450 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0997898578643799
Epoch: 5, Steps: 4 | Train Loss: 0.269 Vali Loss: 3.884 Vali Acc: 0.400 Test Loss: 3.884 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9489085674285889
Epoch: 6, Steps: 4 | Train Loss: 0.267 Vali Loss: 3.911 Vali Acc: 0.460 Test Loss: 3.911 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1874873638153076
Epoch: 7, Steps: 4 | Train Loss: 0.064 Vali Loss: 4.184 Vali Acc: 0.540 Test Loss: 4.184 Test Acc: 0.540
Validation loss decreased (-0.459982 --> -0.539958).  Saving model ...
Epoch: 8 cost time: 0.9665534496307373
Epoch: 8, Steps: 4 | Train Loss: 0.036 Vali Loss: 4.800 Vali Acc: 0.420 Test Loss: 4.800 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2365481853485107
Epoch: 9, Steps: 4 | Train Loss: 0.040 Vali Loss: 6.209 Vali Acc: 0.480 Test Loss: 6.209 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9838078022003174
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.523 Vali Acc: 0.460 Test Loss: 7.523 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.113328218460083
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 8.292 Vali Acc: 0.460 Test Loss: 8.292 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1583616733551025
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.656 Vali Acc: 0.440 Test Loss: 8.656 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0204014778137207
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.640 Vali Acc: 0.460 Test Loss: 8.640 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1165661811828613
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.461 Vali Acc: 0.460 Test Loss: 8.461 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0286140441894531
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.257 Vali Acc: 0.440 Test Loss: 8.257 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1167757511138916
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.165 Vali Acc: 0.460 Test Loss: 8.165 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9927685260772705
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.143 Vali Acc: 0.480 Test Loss: 8.143 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3705163
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4094085693359375
Epoch: 1, Steps: 4 | Train Loss: 1.637 Vali Loss: 1.544 Vali Acc: 0.300 Test Loss: 1.544 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.1163103580474854
Epoch: 2, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.553 Vali Acc: 0.340 Test Loss: 1.553 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 0.9654817581176758
Epoch: 3, Steps: 4 | Train Loss: 0.974 Vali Loss: 2.291 Vali Acc: 0.420 Test Loss: 2.291 Test Acc: 0.420
Validation loss decreased (-0.339984 --> -0.419977).  Saving model ...
Epoch: 4 cost time: 0.9943366050720215
Epoch: 4, Steps: 4 | Train Loss: 0.422 Vali Loss: 2.331 Vali Acc: 0.480 Test Loss: 2.331 Test Acc: 0.480
Validation loss decreased (-0.419977 --> -0.479977).  Saving model ...
Epoch: 5 cost time: 0.8896019458770752
Epoch: 5, Steps: 4 | Train Loss: 0.265 Vali Loss: 3.089 Vali Acc: 0.440 Test Loss: 3.089 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1146142482757568
Epoch: 6, Steps: 4 | Train Loss: 0.216 Vali Loss: 3.121 Vali Acc: 0.460 Test Loss: 3.121 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0407240390777588
Epoch: 7, Steps: 4 | Train Loss: 0.050 Vali Loss: 4.857 Vali Acc: 0.400 Test Loss: 4.857 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0615808963775635
Epoch: 8, Steps: 4 | Train Loss: 0.057 Vali Loss: 4.315 Vali Acc: 0.520 Test Loss: 4.315 Test Acc: 0.520
Validation loss decreased (-0.479977 --> -0.519957).  Saving model ...
Epoch: 9 cost time: 0.9999790191650391
Epoch: 9, Steps: 4 | Train Loss: 0.062 Vali Loss: 4.740 Vali Acc: 0.420 Test Loss: 4.740 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.030491828918457
Epoch: 10, Steps: 4 | Train Loss: 0.055 Vali Loss: 4.473 Vali Acc: 0.460 Test Loss: 4.473 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8973352909088135
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.529 Vali Acc: 0.440 Test Loss: 5.529 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9760563373565674
Epoch: 12, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.457 Vali Acc: 0.460 Test Loss: 6.457 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0891733169555664
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.923 Vali Acc: 0.300 Test Loss: 7.923 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9187300205230713
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 8.239 Vali Acc: 0.380 Test Loss: 8.239 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9736020565032959
Epoch: 15, Steps: 4 | Train Loss: 0.020 Vali Loss: 8.390 Vali Acc: 0.440 Test Loss: 8.390 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9556307792663574
Epoch: 16, Steps: 4 | Train Loss: 0.021 Vali Loss: 9.887 Vali Acc: 0.380 Test Loss: 9.887 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9257433414459229
Epoch: 17, Steps: 4 | Train Loss: 0.010 Vali Loss: 8.356 Vali Acc: 0.420 Test Loss: 8.356 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9324245452880859
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.130 Vali Acc: 0.420 Test Loss: 9.130 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3704533
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.042276620864868
Epoch: 1, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.541 Vali Acc: 0.320 Test Loss: 1.541 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.1200368404388428
Epoch: 2, Steps: 4 | Train Loss: 1.025 Vali Loss: 1.648 Vali Acc: 0.360 Test Loss: 1.648 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 1.025646448135376
Epoch: 3, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.935 Vali Acc: 0.440 Test Loss: 1.935 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439981).  Saving model ...
Epoch: 4 cost time: 0.9408628940582275
Epoch: 4, Steps: 4 | Train Loss: 0.409 Vali Loss: 2.374 Vali Acc: 0.420 Test Loss: 2.374 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9424433708190918
Epoch: 5, Steps: 4 | Train Loss: 0.316 Vali Loss: 3.725 Vali Acc: 0.400 Test Loss: 3.725 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.159538745880127
Epoch: 6, Steps: 4 | Train Loss: 0.312 Vali Loss: 2.818 Vali Acc: 0.480 Test Loss: 2.818 Test Acc: 0.480
Validation loss decreased (-0.439981 --> -0.479972).  Saving model ...
Epoch: 7 cost time: 0.9247140884399414
Epoch: 7, Steps: 4 | Train Loss: 0.145 Vali Loss: 3.830 Vali Acc: 0.520 Test Loss: 3.830 Test Acc: 0.520
Validation loss decreased (-0.479972 --> -0.519962).  Saving model ...
Epoch: 8 cost time: 0.940349817276001
Epoch: 8, Steps: 4 | Train Loss: 0.091 Vali Loss: 4.924 Vali Acc: 0.360 Test Loss: 4.924 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.011646032333374
Epoch: 9, Steps: 4 | Train Loss: 0.069 Vali Loss: 4.192 Vali Acc: 0.540 Test Loss: 4.192 Test Acc: 0.540
Validation loss decreased (-0.519962 --> -0.539958).  Saving model ...
Epoch: 10 cost time: 0.9970786571502686
Epoch: 10, Steps: 4 | Train Loss: 0.052 Vali Loss: 4.308 Vali Acc: 0.500 Test Loss: 4.308 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8579514026641846
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.654 Vali Acc: 0.480 Test Loss: 4.654 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8803417682647705
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.527 Vali Acc: 0.420 Test Loss: 5.527 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.916102409362793
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.525 Vali Acc: 0.420 Test Loss: 6.525 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9175314903259277
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.269 Vali Acc: 0.440 Test Loss: 7.269 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9825723171234131
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.677 Vali Acc: 0.440 Test Loss: 7.677 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.022442102432251
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.802 Vali Acc: 0.420 Test Loss: 7.802 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1928513050079346
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.798 Vali Acc: 0.420 Test Loss: 7.798 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9808309078216553
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.729 Vali Acc: 0.420 Test Loss: 7.729 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0977656841278076
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.638 Vali Acc: 0.420 Test Loss: 7.638 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3704479
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1096768379211426
Epoch: 1, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.523 Vali Acc: 0.340 Test Loss: 1.523 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 0.7847139835357666
Epoch: 2, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.489 Vali Acc: 0.320 Test Loss: 1.489 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9239706993103027
Epoch: 3, Steps: 4 | Train Loss: 0.571 Vali Loss: 2.769 Vali Acc: 0.340 Test Loss: 2.769 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8773908615112305
Epoch: 4, Steps: 4 | Train Loss: 0.633 Vali Loss: 2.875 Vali Acc: 0.420 Test Loss: 2.875 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419971).  Saving model ...
Epoch: 5 cost time: 0.9750568866729736
Epoch: 5, Steps: 4 | Train Loss: 0.158 Vali Loss: 3.522 Vali Acc: 0.480 Test Loss: 3.522 Test Acc: 0.480
Validation loss decreased (-0.419971 --> -0.479965).  Saving model ...
Epoch: 6 cost time: 0.7297627925872803
Epoch: 6, Steps: 4 | Train Loss: 0.073 Vali Loss: 4.393 Vali Acc: 0.460 Test Loss: 4.393 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9943680763244629
Epoch: 7, Steps: 4 | Train Loss: 0.084 Vali Loss: 3.745 Vali Acc: 0.520 Test Loss: 3.745 Test Acc: 0.520
Validation loss decreased (-0.479965 --> -0.519963).  Saving model ...
Epoch: 8 cost time: 0.8279740810394287
Epoch: 8, Steps: 4 | Train Loss: 0.020 Vali Loss: 4.780 Vali Acc: 0.400 Test Loss: 4.780 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9415097236633301
Epoch: 9, Steps: 4 | Train Loss: 0.039 Vali Loss: 6.428 Vali Acc: 0.460 Test Loss: 6.428 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8597257137298584
Epoch: 10, Steps: 4 | Train Loss: 0.065 Vali Loss: 5.790 Vali Acc: 0.480 Test Loss: 5.790 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8962528705596924
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 5.658 Vali Acc: 0.460 Test Loss: 5.658 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8416030406951904
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.282 Vali Acc: 0.500 Test Loss: 7.282 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9413738250732422
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 7.501 Vali Acc: 0.460 Test Loss: 7.501 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9074501991271973
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.368 Vali Acc: 0.460 Test Loss: 8.368 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.01202392578125
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.443 Vali Acc: 0.480 Test Loss: 8.443 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8297028541564941
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.959 Vali Acc: 0.460 Test Loss: 7.959 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0160222053527832
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.635 Vali Acc: 0.460 Test Loss: 7.635 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3705811
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.09596848487854
Epoch: 1, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.584 Vali Acc: 0.340 Test Loss: 1.584 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 0.841149091720581
Epoch: 2, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.664 Vali Acc: 0.380 Test Loss: 1.664 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379983).  Saving model ...
Epoch: 3 cost time: 0.9393279552459717
Epoch: 3, Steps: 4 | Train Loss: 0.575 Vali Loss: 2.135 Vali Acc: 0.420 Test Loss: 2.135 Test Acc: 0.420
Validation loss decreased (-0.379983 --> -0.419979).  Saving model ...
Epoch: 4 cost time: 0.9703376293182373
Epoch: 4, Steps: 4 | Train Loss: 0.453 Vali Loss: 2.353 Vali Acc: 0.440 Test Loss: 2.353 Test Acc: 0.440
Validation loss decreased (-0.419979 --> -0.439976).  Saving model ...
Epoch: 5 cost time: 1.1153466701507568
Epoch: 5, Steps: 4 | Train Loss: 0.161 Vali Loss: 3.119 Vali Acc: 0.440 Test Loss: 3.119 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0698916912078857
Epoch: 6, Steps: 4 | Train Loss: 0.177 Vali Loss: 3.623 Vali Acc: 0.480 Test Loss: 3.623 Test Acc: 0.480
Validation loss decreased (-0.439976 --> -0.479964).  Saving model ...
Epoch: 7 cost time: 0.899512529373169
Epoch: 7, Steps: 4 | Train Loss: 0.182 Vali Loss: 3.494 Vali Acc: 0.440 Test Loss: 3.494 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.051241397857666
Epoch: 8, Steps: 4 | Train Loss: 0.135 Vali Loss: 5.534 Vali Acc: 0.440 Test Loss: 5.534 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9839017391204834
Epoch: 9, Steps: 4 | Train Loss: 0.136 Vali Loss: 6.621 Vali Acc: 0.460 Test Loss: 6.621 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0134449005126953
Epoch: 10, Steps: 4 | Train Loss: 0.443 Vali Loss: 7.848 Vali Acc: 0.480 Test Loss: 7.848 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8684873580932617
Epoch: 11, Steps: 4 | Train Loss: 0.094 Vali Loss: 5.938 Vali Acc: 0.400 Test Loss: 5.938 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0294265747070312
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 6.586 Vali Acc: 0.380 Test Loss: 6.586 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9950296878814697
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 9.343 Vali Acc: 0.420 Test Loss: 9.343 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1022987365722656
Epoch: 14, Steps: 4 | Train Loss: 0.050 Vali Loss: 10.569 Vali Acc: 0.440 Test Loss: 10.569 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0467700958251953
Epoch: 15, Steps: 4 | Train Loss: 0.025 Vali Loss: 8.459 Vali Acc: 0.360 Test Loss: 8.459 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9704985618591309
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.430 Vali Acc: 0.420 Test Loss: 6.430 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3706067
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.231112003326416
Epoch: 1, Steps: 4 | Train Loss: 1.694 Vali Loss: 1.601 Vali Acc: 0.320 Test Loss: 1.601 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 0.9567708969116211
Epoch: 2, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.954 Vali Acc: 0.340 Test Loss: 1.954 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339980).  Saving model ...
Epoch: 3 cost time: 0.8410632610321045
Epoch: 3, Steps: 4 | Train Loss: 0.747 Vali Loss: 2.198 Vali Acc: 0.360 Test Loss: 2.198 Test Acc: 0.360
Validation loss decreased (-0.339980 --> -0.359978).  Saving model ...
Epoch: 4 cost time: 1.0286786556243896
Epoch: 4, Steps: 4 | Train Loss: 0.545 Vali Loss: 2.839 Vali Acc: 0.380 Test Loss: 2.839 Test Acc: 0.380
Validation loss decreased (-0.359978 --> -0.379972).  Saving model ...
Epoch: 5 cost time: 0.8746893405914307
Epoch: 5, Steps: 4 | Train Loss: 0.523 Vali Loss: 4.046 Vali Acc: 0.260 Test Loss: 4.046 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9035661220550537
Epoch: 6, Steps: 4 | Train Loss: 0.334 Vali Loss: 3.146 Vali Acc: 0.440 Test Loss: 3.146 Test Acc: 0.440
Validation loss decreased (-0.379972 --> -0.439969).  Saving model ...
Epoch: 7 cost time: 0.9965040683746338
Epoch: 7, Steps: 4 | Train Loss: 0.193 Vali Loss: 3.852 Vali Acc: 0.460 Test Loss: 3.852 Test Acc: 0.460
Validation loss decreased (-0.439969 --> -0.459961).  Saving model ...
Epoch: 8 cost time: 0.8594965934753418
Epoch: 8, Steps: 4 | Train Loss: 0.152 Vali Loss: 5.454 Vali Acc: 0.440 Test Loss: 5.454 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9545931816101074
Epoch: 9, Steps: 4 | Train Loss: 0.051 Vali Loss: 3.774 Vali Acc: 0.520 Test Loss: 3.774 Test Acc: 0.520
Validation loss decreased (-0.459961 --> -0.519962).  Saving model ...
Epoch: 10 cost time: 0.8866119384765625
Epoch: 10, Steps: 4 | Train Loss: 0.016 Vali Loss: 4.430 Vali Acc: 0.520 Test Loss: 4.430 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9573426246643066
Epoch: 11, Steps: 4 | Train Loss: 0.017 Vali Loss: 4.430 Vali Acc: 0.420 Test Loss: 4.430 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9916841983795166
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.112 Vali Acc: 0.440 Test Loss: 5.112 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9235315322875977
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.885 Vali Acc: 0.480 Test Loss: 5.885 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8202078342437744
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.701 Vali Acc: 0.440 Test Loss: 6.701 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0705687999725342
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.136 Vali Acc: 0.440 Test Loss: 7.136 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9746654033660889
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.347 Vali Acc: 0.440 Test Loss: 7.347 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8642027378082275
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.363 Vali Acc: 0.440 Test Loss: 7.363 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8651103973388672
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.327 Vali Acc: 0.440 Test Loss: 7.327 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0251386165618896
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.233 Vali Acc: 0.460 Test Loss: 7.233 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3705247
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8974106311798096
Epoch: 1, Steps: 4 | Train Loss: 1.727 Vali Loss: 1.575 Vali Acc: 0.240 Test Loss: 1.575 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 0.9045674800872803
Epoch: 2, Steps: 4 | Train Loss: 1.388 Vali Loss: 1.581 Vali Acc: 0.380 Test Loss: 1.581 Test Acc: 0.380
Validation loss decreased (-0.239984 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 0.8957195281982422
Epoch: 3, Steps: 4 | Train Loss: 0.712 Vali Loss: 1.811 Vali Acc: 0.440 Test Loss: 1.811 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439982).  Saving model ...
Epoch: 4 cost time: 0.8767318725585938
Epoch: 4, Steps: 4 | Train Loss: 0.509 Vali Loss: 2.853 Vali Acc: 0.360 Test Loss: 2.853 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0025227069854736
Epoch: 5, Steps: 4 | Train Loss: 0.217 Vali Loss: 3.532 Vali Acc: 0.380 Test Loss: 3.532 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0114240646362305
Epoch: 6, Steps: 4 | Train Loss: 0.384 Vali Loss: 3.429 Vali Acc: 0.380 Test Loss: 3.429 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9216198921203613
Epoch: 7, Steps: 4 | Train Loss: 0.094 Vali Loss: 3.289 Vali Acc: 0.440 Test Loss: 3.289 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0536248683929443
Epoch: 8, Steps: 4 | Train Loss: 0.030 Vali Loss: 3.868 Vali Acc: 0.440 Test Loss: 3.868 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.017139196395874
Epoch: 9, Steps: 4 | Train Loss: 0.032 Vali Loss: 4.429 Vali Acc: 0.440 Test Loss: 4.429 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9648487567901611
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.362 Vali Acc: 0.380 Test Loss: 5.362 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9063858985900879
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.820 Vali Acc: 0.420 Test Loss: 5.820 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9594540596008301
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.686 Vali Acc: 0.440 Test Loss: 5.686 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.212939739227295
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.888 Vali Acc: 0.400 Test Loss: 5.888 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 3707163
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.429823160171509
Epoch: 1, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.612 Vali Acc: 0.320 Test Loss: 1.612 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 0.8612604141235352
Epoch: 2, Steps: 4 | Train Loss: 1.350 Vali Loss: 1.956 Vali Acc: 0.340 Test Loss: 1.956 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339980).  Saving model ...
Epoch: 3 cost time: 0.9415206909179688
Epoch: 3, Steps: 4 | Train Loss: 1.052 Vali Loss: 1.789 Vali Acc: 0.300 Test Loss: 1.789 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8240666389465332
Epoch: 4, Steps: 4 | Train Loss: 0.349 Vali Loss: 2.954 Vali Acc: 0.400 Test Loss: 2.954 Test Acc: 0.400
Validation loss decreased (-0.339980 --> -0.399970).  Saving model ...
Epoch: 5 cost time: 0.8291018009185791
Epoch: 5, Steps: 4 | Train Loss: 0.830 Vali Loss: 3.058 Vali Acc: 0.340 Test Loss: 3.058 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9548611640930176
Epoch: 6, Steps: 4 | Train Loss: 0.349 Vali Loss: 2.922 Vali Acc: 0.480 Test Loss: 2.922 Test Acc: 0.480
Validation loss decreased (-0.399970 --> -0.479971).  Saving model ...
Epoch: 7 cost time: 0.7720291614532471
Epoch: 7, Steps: 4 | Train Loss: 0.166 Vali Loss: 4.523 Vali Acc: 0.420 Test Loss: 4.523 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8753876686096191
Epoch: 8, Steps: 4 | Train Loss: 0.138 Vali Loss: 5.074 Vali Acc: 0.420 Test Loss: 5.074 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7573971748352051
Epoch: 9, Steps: 4 | Train Loss: 0.026 Vali Loss: 4.115 Vali Acc: 0.360 Test Loss: 4.115 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0451807975769043
Epoch: 10, Steps: 4 | Train Loss: 0.023 Vali Loss: 4.610 Vali Acc: 0.500 Test Loss: 4.610 Test Acc: 0.500
Validation loss decreased (-0.479971 --> -0.499954).  Saving model ...
Epoch: 11 cost time: 0.8123507499694824
Epoch: 11, Steps: 4 | Train Loss: 0.080 Vali Loss: 5.076 Vali Acc: 0.460 Test Loss: 5.076 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8789019584655762
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.407 Vali Acc: 0.540 Test Loss: 5.407 Test Acc: 0.540
Validation loss decreased (-0.499954 --> -0.539946).  Saving model ...
Epoch: 13 cost time: 0.7691943645477295
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.911 Vali Acc: 0.480 Test Loss: 5.911 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8266298770904541
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.486 Vali Acc: 0.460 Test Loss: 6.486 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7889726161956787
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.228 Vali Acc: 0.460 Test Loss: 7.228 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0229194164276123
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.896 Vali Acc: 0.480 Test Loss: 7.896 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8957698345184326
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.400 Vali Acc: 0.460 Test Loss: 8.400 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7611925601959229
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.689 Vali Acc: 0.440 Test Loss: 8.689 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8266620635986328
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.762 Vali Acc: 0.440 Test Loss: 8.762 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9973042011260986
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.779 Vali Acc: 0.440 Test Loss: 8.779 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8586854934692383
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.775 Vali Acc: 0.440 Test Loss: 8.775 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9877309799194336
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.763 Vali Acc: 0.440 Test Loss: 8.763 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3704461
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.253817319869995
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.561 Vali Acc: 0.300 Test Loss: 1.561 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.9495546817779541
Epoch: 2, Steps: 4 | Train Loss: 1.092 Vali Loss: 2.022 Vali Acc: 0.400 Test Loss: 2.022 Test Acc: 0.400
Validation loss decreased (-0.299984 --> -0.399980).  Saving model ...
Epoch: 3 cost time: 0.90769362449646
Epoch: 3, Steps: 4 | Train Loss: 0.893 Vali Loss: 2.012 Vali Acc: 0.440 Test Loss: 2.012 Test Acc: 0.440
Validation loss decreased (-0.399980 --> -0.439980).  Saving model ...
Epoch: 4 cost time: 1.0551905632019043
Epoch: 4, Steps: 4 | Train Loss: 0.402 Vali Loss: 2.994 Vali Acc: 0.380 Test Loss: 2.994 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8167345523834229
Epoch: 5, Steps: 4 | Train Loss: 0.192 Vali Loss: 2.982 Vali Acc: 0.440 Test Loss: 2.982 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8936476707458496
Epoch: 6, Steps: 4 | Train Loss: 0.224 Vali Loss: 3.565 Vali Acc: 0.460 Test Loss: 3.565 Test Acc: 0.460
Validation loss decreased (-0.439980 --> -0.459964).  Saving model ...
Epoch: 7 cost time: 0.8668076992034912
Epoch: 7, Steps: 4 | Train Loss: 0.037 Vali Loss: 4.971 Vali Acc: 0.440 Test Loss: 4.971 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8655533790588379
Epoch: 8, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.552 Vali Acc: 0.500 Test Loss: 3.552 Test Acc: 0.500
Validation loss decreased (-0.459964 --> -0.499964).  Saving model ...
Epoch: 9 cost time: 0.8021690845489502
Epoch: 9, Steps: 4 | Train Loss: 0.032 Vali Loss: 4.321 Vali Acc: 0.560 Test Loss: 4.321 Test Acc: 0.560
Validation loss decreased (-0.499964 --> -0.559957).  Saving model ...
Epoch: 10 cost time: 1.0879957675933838
Epoch: 10, Steps: 4 | Train Loss: 0.013 Vali Loss: 6.920 Vali Acc: 0.460 Test Loss: 6.920 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8306701183319092
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.193 Vali Acc: 0.440 Test Loss: 5.193 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9723968505859375
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.576 Vali Acc: 0.380 Test Loss: 5.576 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9203689098358154
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.148 Vali Acc: 0.400 Test Loss: 6.148 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0022008419036865
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.608 Vali Acc: 0.400 Test Loss: 6.608 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9001750946044922
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.173 Vali Acc: 0.400 Test Loss: 7.173 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9602868556976318
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.691 Vali Acc: 0.420 Test Loss: 7.691 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0281548500061035
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.112 Vali Acc: 0.380 Test Loss: 8.112 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8851606845855713
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.413 Vali Acc: 0.380 Test Loss: 8.413 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9157679080963135
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.614 Vali Acc: 0.380 Test Loss: 8.614 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3705035
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.400434970855713
Epoch: 1, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.722 Vali Acc: 0.240 Test Loss: 1.722 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 0.8228521347045898
Epoch: 2, Steps: 4 | Train Loss: 1.290 Vali Loss: 1.912 Vali Acc: 0.340 Test Loss: 1.912 Test Acc: 0.340
Validation loss decreased (-0.239983 --> -0.339981).  Saving model ...
Epoch: 3 cost time: 0.9568862915039062
Epoch: 3, Steps: 4 | Train Loss: 0.603 Vali Loss: 2.220 Vali Acc: 0.380 Test Loss: 2.220 Test Acc: 0.380
Validation loss decreased (-0.339981 --> -0.379978).  Saving model ...
Epoch: 4 cost time: 0.9428083896636963
Epoch: 4, Steps: 4 | Train Loss: 0.321 Vali Loss: 2.497 Vali Acc: 0.440 Test Loss: 2.497 Test Acc: 0.440
Validation loss decreased (-0.379978 --> -0.439975).  Saving model ...
Epoch: 5 cost time: 0.878361701965332
Epoch: 5, Steps: 4 | Train Loss: 0.243 Vali Loss: 2.710 Vali Acc: 0.420 Test Loss: 2.710 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0230903625488281
Epoch: 6, Steps: 4 | Train Loss: 0.177 Vali Loss: 3.288 Vali Acc: 0.380 Test Loss: 3.288 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0139117240905762
Epoch: 7, Steps: 4 | Train Loss: 0.030 Vali Loss: 4.181 Vali Acc: 0.440 Test Loss: 4.181 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0078248977661133
Epoch: 8, Steps: 4 | Train Loss: 0.021 Vali Loss: 4.443 Vali Acc: 0.400 Test Loss: 4.443 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8640620708465576
Epoch: 9, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.236 Vali Acc: 0.440 Test Loss: 5.236 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9769606590270996
Epoch: 10, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.428 Vali Acc: 0.440 Test Loss: 5.428 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9631006717681885
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.280 Vali Acc: 0.420 Test Loss: 6.280 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0430593490600586
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.849 Vali Acc: 0.420 Test Loss: 6.849 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9141426086425781
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.828 Vali Acc: 0.460 Test Loss: 6.828 Test Acc: 0.460
Validation loss decreased (-0.439975 --> -0.459932).  Saving model ...
Epoch: 14 cost time: 1.0136046409606934
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.897 Vali Acc: 0.440 Test Loss: 6.897 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0395116806030273
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.019 Vali Acc: 0.420 Test Loss: 7.019 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9561445713043213
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.149 Vali Acc: 0.400 Test Loss: 7.149 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9110393524169922
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.279 Vali Acc: 0.400 Test Loss: 7.279 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8943648338317871
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.400 Vali Acc: 0.440 Test Loss: 7.400 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9532074928283691
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.511 Vali Acc: 0.440 Test Loss: 7.511 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9212219715118408
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.615 Vali Acc: 0.460 Test Loss: 7.615 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9795691967010498
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.697 Vali Acc: 0.460 Test Loss: 7.697 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9342155456542969
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.761 Vali Acc: 0.460 Test Loss: 7.761 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.879692554473877
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.806 Vali Acc: 0.460 Test Loss: 7.806 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3705073
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3368606567382812
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.652 Vali Acc: 0.200 Test Loss: 1.652 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.047316074371338
Epoch: 2, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.800 Vali Acc: 0.280 Test Loss: 1.800 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279982).  Saving model ...
Epoch: 3 cost time: 0.8157076835632324
Epoch: 3, Steps: 4 | Train Loss: 0.747 Vali Loss: 2.122 Vali Acc: 0.320 Test Loss: 2.122 Test Acc: 0.320
Validation loss decreased (-0.279982 --> -0.319979).  Saving model ...
Epoch: 4 cost time: 1.147672176361084
Epoch: 4, Steps: 4 | Train Loss: 0.667 Vali Loss: 2.736 Vali Acc: 0.380 Test Loss: 2.736 Test Acc: 0.380
Validation loss decreased (-0.319979 --> -0.379973).  Saving model ...
Epoch: 5 cost time: 1.034168004989624
Epoch: 5, Steps: 4 | Train Loss: 0.249 Vali Loss: 2.411 Vali Acc: 0.500 Test Loss: 2.411 Test Acc: 0.500
Validation loss decreased (-0.379973 --> -0.499976).  Saving model ...
Epoch: 6 cost time: 0.9146835803985596
Epoch: 6, Steps: 4 | Train Loss: 0.066 Vali Loss: 4.403 Vali Acc: 0.460 Test Loss: 4.403 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9761059284210205
Epoch: 7, Steps: 4 | Train Loss: 0.654 Vali Loss: 4.841 Vali Acc: 0.420 Test Loss: 4.841 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9624435901641846
Epoch: 8, Steps: 4 | Train Loss: 0.250 Vali Loss: 4.060 Vali Acc: 0.440 Test Loss: 4.060 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1396763324737549
Epoch: 9, Steps: 4 | Train Loss: 0.059 Vali Loss: 4.507 Vali Acc: 0.460 Test Loss: 4.507 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9627456665039062
Epoch: 10, Steps: 4 | Train Loss: 0.052 Vali Loss: 4.058 Vali Acc: 0.480 Test Loss: 4.058 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.081413745880127
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.903 Vali Acc: 0.420 Test Loss: 4.903 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.896766185760498
Epoch: 12, Steps: 4 | Train Loss: 0.007 Vali Loss: 5.917 Vali Acc: 0.440 Test Loss: 5.917 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.987313985824585
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.232 Vali Acc: 0.420 Test Loss: 7.232 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7319321632385254
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.622 Vali Acc: 0.440 Test Loss: 7.622 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9236307144165039
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.407 Vali Acc: 0.420 Test Loss: 7.407 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3704575
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3009397983551025
Epoch: 1, Steps: 4 | Train Loss: 1.617 Vali Loss: 1.548 Vali Acc: 0.260 Test Loss: 1.548 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 0.9131126403808594
Epoch: 2, Steps: 4 | Train Loss: 1.415 Vali Loss: 1.594 Vali Acc: 0.300 Test Loss: 1.594 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 0.8765974044799805
Epoch: 3, Steps: 4 | Train Loss: 1.081 Vali Loss: 2.701 Vali Acc: 0.280 Test Loss: 2.701 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9721560478210449
Epoch: 4, Steps: 4 | Train Loss: 0.455 Vali Loss: 2.915 Vali Acc: 0.360 Test Loss: 2.915 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359971).  Saving model ...
Epoch: 5 cost time: 0.861762285232544
Epoch: 5, Steps: 4 | Train Loss: 0.400 Vali Loss: 3.947 Vali Acc: 0.440 Test Loss: 3.947 Test Acc: 0.440
Validation loss decreased (-0.359971 --> -0.439961).  Saving model ...
Epoch: 6 cost time: 1.0164024829864502
Epoch: 6, Steps: 4 | Train Loss: 0.340 Vali Loss: 2.947 Vali Acc: 0.500 Test Loss: 2.947 Test Acc: 0.500
Validation loss decreased (-0.439961 --> -0.499971).  Saving model ...
Epoch: 7 cost time: 0.886242151260376
Epoch: 7, Steps: 4 | Train Loss: 0.085 Vali Loss: 4.980 Vali Acc: 0.360 Test Loss: 4.980 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1299846172332764
Epoch: 8, Steps: 4 | Train Loss: 0.197 Vali Loss: 4.519 Vali Acc: 0.400 Test Loss: 4.519 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9258937835693359
Epoch: 9, Steps: 4 | Train Loss: 0.206 Vali Loss: 4.458 Vali Acc: 0.380 Test Loss: 4.458 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8675117492675781
Epoch: 10, Steps: 4 | Train Loss: 0.053 Vali Loss: 5.995 Vali Acc: 0.360 Test Loss: 5.995 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9749774932861328
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.777 Vali Acc: 0.380 Test Loss: 5.777 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9439117908477783
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 5.495 Vali Acc: 0.420 Test Loss: 5.495 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8427867889404297
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.271 Vali Acc: 0.400 Test Loss: 5.271 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9001271724700928
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.452 Vali Acc: 0.400 Test Loss: 5.452 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9492270946502686
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.703 Vali Acc: 0.420 Test Loss: 5.703 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0199708938598633
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.023 Vali Acc: 0.440 Test Loss: 6.023 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3707403
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.156345844268799
Epoch: 1, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.470 Vali Acc: 0.280 Test Loss: 1.470 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 0.8729186058044434
Epoch: 2, Steps: 4 | Train Loss: 1.133 Vali Loss: 1.657 Vali Acc: 0.420 Test Loss: 1.657 Test Acc: 0.420
Validation loss decreased (-0.279985 --> -0.419983).  Saving model ...
Epoch: 3 cost time: 0.912893533706665
Epoch: 3, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.839 Vali Acc: 0.420 Test Loss: 1.839 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.087980031967163
Epoch: 4, Steps: 4 | Train Loss: 0.303 Vali Loss: 3.284 Vali Acc: 0.340 Test Loss: 3.284 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9676558971405029
Epoch: 5, Steps: 4 | Train Loss: 0.357 Vali Loss: 2.842 Vali Acc: 0.460 Test Loss: 2.842 Test Acc: 0.460
Validation loss decreased (-0.419983 --> -0.459972).  Saving model ...
Epoch: 6 cost time: 0.7972996234893799
Epoch: 6, Steps: 4 | Train Loss: 0.298 Vali Loss: 3.512 Vali Acc: 0.380 Test Loss: 3.512 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9450078010559082
Epoch: 7, Steps: 4 | Train Loss: 0.732 Vali Loss: 4.445 Vali Acc: 0.420 Test Loss: 4.445 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0066778659820557
Epoch: 8, Steps: 4 | Train Loss: 0.106 Vali Loss: 4.153 Vali Acc: 0.400 Test Loss: 4.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9227046966552734
Epoch: 9, Steps: 4 | Train Loss: 0.017 Vali Loss: 4.477 Vali Acc: 0.460 Test Loss: 4.477 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8827502727508545
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.291 Vali Acc: 0.420 Test Loss: 5.291 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0811660289764404
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.435 Vali Acc: 0.440 Test Loss: 5.435 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0920238494873047
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.442 Vali Acc: 0.400 Test Loss: 5.442 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8638558387756348
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.471 Vali Acc: 0.380 Test Loss: 5.471 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8933277130126953
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.506 Vali Acc: 0.380 Test Loss: 5.506 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.848198413848877
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.540 Vali Acc: 0.400 Test Loss: 5.540 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3705567
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.032202959060669
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 0.7714269161224365
Epoch: 2, Steps: 4 | Train Loss: 1.138 Vali Loss: 2.193 Vali Acc: 0.240 Test Loss: 2.193 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8153345584869385
Epoch: 3, Steps: 4 | Train Loss: 0.722 Vali Loss: 2.223 Vali Acc: 0.360 Test Loss: 2.223 Test Acc: 0.360
Validation loss decreased (-0.239984 --> -0.359978).  Saving model ...
Epoch: 4 cost time: 0.7848033905029297
Epoch: 4, Steps: 4 | Train Loss: 0.831 Vali Loss: 3.069 Vali Acc: 0.420 Test Loss: 3.069 Test Acc: 0.420
Validation loss decreased (-0.359978 --> -0.419969).  Saving model ...
Epoch: 5 cost time: 0.8520903587341309
Epoch: 5, Steps: 4 | Train Loss: 0.262 Vali Loss: 3.377 Vali Acc: 0.340 Test Loss: 3.377 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8343672752380371
Epoch: 6, Steps: 4 | Train Loss: 0.372 Vali Loss: 4.343 Vali Acc: 0.460 Test Loss: 4.343 Test Acc: 0.460
Validation loss decreased (-0.419969 --> -0.459957).  Saving model ...
Epoch: 7 cost time: 0.8274340629577637
Epoch: 7, Steps: 4 | Train Loss: 0.589 Vali Loss: 4.475 Vali Acc: 0.380 Test Loss: 4.475 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7686569690704346
Epoch: 8, Steps: 4 | Train Loss: 0.133 Vali Loss: 5.363 Vali Acc: 0.420 Test Loss: 5.363 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.832972526550293
Epoch: 9, Steps: 4 | Train Loss: 0.173 Vali Loss: 8.953 Vali Acc: 0.480 Test Loss: 8.953 Test Acc: 0.480
Validation loss decreased (-0.459957 --> -0.479910).  Saving model ...
Epoch: 10 cost time: 0.7731602191925049
Epoch: 10, Steps: 4 | Train Loss: 0.229 Vali Loss: 5.433 Vali Acc: 0.420 Test Loss: 5.433 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7796611785888672
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.227 Vali Acc: 0.400 Test Loss: 5.227 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7598869800567627
Epoch: 12, Steps: 4 | Train Loss: 0.011 Vali Loss: 6.091 Vali Acc: 0.420 Test Loss: 6.091 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9106941223144531
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 8.333 Vali Acc: 0.440 Test Loss: 8.333 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7984185218811035
Epoch: 14, Steps: 4 | Train Loss: 0.033 Vali Loss: 8.402 Vali Acc: 0.300 Test Loss: 8.402 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9950783252716064
Epoch: 15, Steps: 4 | Train Loss: 0.037 Vali Loss: 10.267 Vali Acc: 0.360 Test Loss: 10.267 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6932992935180664
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 12.847 Vali Acc: 0.400 Test Loss: 12.847 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9800162315368652
Epoch: 17, Steps: 4 | Train Loss: 0.217 Vali Loss: 8.523 Vali Acc: 0.460 Test Loss: 8.523 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7843809127807617
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.068 Vali Acc: 0.440 Test Loss: 6.068 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7380273342132568
Epoch: 19, Steps: 4 | Train Loss: 0.035 Vali Loss: 5.535 Vali Acc: 0.500 Test Loss: 5.535 Test Acc: 0.500
Validation loss decreased (-0.479910 --> -0.499945).  Saving model ...
Epoch: 20 cost time: 0.7280187606811523
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.085 Vali Acc: 0.440 Test Loss: 6.085 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9062139987945557
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.177 Vali Acc: 0.380 Test Loss: 7.177 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.848046064376831
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.734 Vali Acc: 0.380 Test Loss: 7.734 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8621528148651123
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.844 Vali Acc: 0.380 Test Loss: 7.844 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7669272422790527
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.755 Vali Acc: 0.340 Test Loss: 7.755 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.843740701675415
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.704 Vali Acc: 0.340 Test Loss: 7.704 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8056366443634033
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.672 Vali Acc: 0.340 Test Loss: 7.672 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8968417644500732
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.652 Vali Acc: 0.340 Test Loss: 7.652 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7675187587738037
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.634 Vali Acc: 0.340 Test Loss: 7.634 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9176905155181885
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.619 Vali Acc: 0.340 Test Loss: 7.619 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3703263
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1121695041656494
Epoch: 1, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.766 Vali Acc: 0.300 Test Loss: 1.766 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 0.9322700500488281
Epoch: 2, Steps: 4 | Train Loss: 1.391 Vali Loss: 1.758 Vali Acc: 0.380 Test Loss: 1.758 Test Acc: 0.380
Validation loss decreased (-0.299982 --> -0.379982).  Saving model ...
Epoch: 3 cost time: 0.9282176494598389
Epoch: 3, Steps: 4 | Train Loss: 0.882 Vali Loss: 2.293 Vali Acc: 0.260 Test Loss: 2.293 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8735864162445068
Epoch: 4, Steps: 4 | Train Loss: 0.514 Vali Loss: 4.474 Vali Acc: 0.320 Test Loss: 4.474 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8286590576171875
Epoch: 5, Steps: 4 | Train Loss: 1.019 Vali Loss: 5.242 Vali Acc: 0.340 Test Loss: 5.242 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8697586059570312
Epoch: 6, Steps: 4 | Train Loss: 0.620 Vali Loss: 3.979 Vali Acc: 0.420 Test Loss: 3.979 Test Acc: 0.420
Validation loss decreased (-0.379982 --> -0.419960).  Saving model ...
Epoch: 7 cost time: 0.8325901031494141
Epoch: 7, Steps: 4 | Train Loss: 0.352 Vali Loss: 4.962 Vali Acc: 0.400 Test Loss: 4.962 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9337928295135498
Epoch: 8, Steps: 4 | Train Loss: 0.925 Vali Loss: 4.040 Vali Acc: 0.500 Test Loss: 4.040 Test Acc: 0.500
Validation loss decreased (-0.419960 --> -0.499960).  Saving model ...
Epoch: 9 cost time: 0.7606210708618164
Epoch: 9, Steps: 4 | Train Loss: 0.840 Vali Loss: 5.217 Vali Acc: 0.480 Test Loss: 5.217 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8372511863708496
Epoch: 10, Steps: 4 | Train Loss: 0.067 Vali Loss: 4.775 Vali Acc: 0.440 Test Loss: 4.775 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9579591751098633
Epoch: 11, Steps: 4 | Train Loss: 0.208 Vali Loss: 4.868 Vali Acc: 0.420 Test Loss: 4.868 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8376495838165283
Epoch: 12, Steps: 4 | Train Loss: 0.085 Vali Loss: 5.882 Vali Acc: 0.380 Test Loss: 5.882 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8797333240509033
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 7.255 Vali Acc: 0.440 Test Loss: 7.255 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0628998279571533
Epoch: 14, Steps: 4 | Train Loss: 0.028 Vali Loss: 6.111 Vali Acc: 0.420 Test Loss: 6.111 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.87211012840271
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.096 Vali Acc: 0.360 Test Loss: 7.096 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0495669841766357
Epoch: 16, Steps: 4 | Train Loss: 0.028 Vali Loss: 6.418 Vali Acc: 0.460 Test Loss: 6.418 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9479248523712158
Epoch: 17, Steps: 4 | Train Loss: 0.024 Vali Loss: 8.726 Vali Acc: 0.440 Test Loss: 8.726 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1484904289245605
Epoch: 18, Steps: 4 | Train Loss: 0.129 Vali Loss: 6.173 Vali Acc: 0.440 Test Loss: 6.173 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3702557
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7747743129730225
Epoch: 1, Steps: 4 | Train Loss: 1.744 Vali Loss: 1.722 Vali Acc: 0.300 Test Loss: 1.722 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.2343919277191162
Epoch: 2, Steps: 4 | Train Loss: 1.334 Vali Loss: 1.674 Vali Acc: 0.320 Test Loss: 1.674 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 1.2783000469207764
Epoch: 3, Steps: 4 | Train Loss: 0.875 Vali Loss: 2.331 Vali Acc: 0.260 Test Loss: 2.331 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4848744869232178
Epoch: 4, Steps: 4 | Train Loss: 0.852 Vali Loss: 2.860 Vali Acc: 0.500 Test Loss: 2.860 Test Acc: 0.500
Validation loss decreased (-0.319983 --> -0.499971).  Saving model ...
Epoch: 5 cost time: 1.6257760524749756
Epoch: 5, Steps: 4 | Train Loss: 0.215 Vali Loss: 2.926 Vali Acc: 0.320 Test Loss: 2.926 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.222015142440796
Epoch: 6, Steps: 4 | Train Loss: 0.544 Vali Loss: 4.004 Vali Acc: 0.420 Test Loss: 4.004 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.185307264328003
Epoch: 7, Steps: 4 | Train Loss: 0.170 Vali Loss: 7.441 Vali Acc: 0.440 Test Loss: 7.441 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.262937068939209
Epoch: 8, Steps: 4 | Train Loss: 0.165 Vali Loss: 4.716 Vali Acc: 0.400 Test Loss: 4.716 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3980522155761719
Epoch: 9, Steps: 4 | Train Loss: 0.033 Vali Loss: 4.625 Vali Acc: 0.340 Test Loss: 4.625 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1503753662109375
Epoch: 10, Steps: 4 | Train Loss: 0.011 Vali Loss: 5.938 Vali Acc: 0.320 Test Loss: 5.938 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1395468711853027
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.129 Vali Acc: 0.380 Test Loss: 6.129 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3012568950653076
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.790 Vali Acc: 0.340 Test Loss: 6.790 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2884771823883057
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.772 Vali Acc: 0.440 Test Loss: 6.772 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3051118850708008
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.606 Vali Acc: 0.380 Test Loss: 7.606 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3702763
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3901264667510986
Epoch: 1, Steps: 4 | Train Loss: 1.746 Vali Loss: 1.614 Vali Acc: 0.320 Test Loss: 1.614 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.4461312294006348
Epoch: 2, Steps: 4 | Train Loss: 1.359 Vali Loss: 1.617 Vali Acc: 0.320 Test Loss: 1.617 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7593739032745361
Epoch: 3, Steps: 4 | Train Loss: 0.589 Vali Loss: 2.571 Vali Acc: 0.340 Test Loss: 2.571 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339974).  Saving model ...
Epoch: 4 cost time: 1.5249695777893066
Epoch: 4, Steps: 4 | Train Loss: 0.365 Vali Loss: 3.313 Vali Acc: 0.280 Test Loss: 3.313 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2914719581604004
Epoch: 5, Steps: 4 | Train Loss: 0.640 Vali Loss: 3.090 Vali Acc: 0.460 Test Loss: 3.090 Test Acc: 0.460
Validation loss decreased (-0.339974 --> -0.459969).  Saving model ...
Epoch: 6 cost time: 1.487121820449829
Epoch: 6, Steps: 4 | Train Loss: 0.207 Vali Loss: 3.193 Vali Acc: 0.460 Test Loss: 3.193 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7074639797210693
Epoch: 7, Steps: 4 | Train Loss: 0.133 Vali Loss: 3.294 Vali Acc: 0.500 Test Loss: 3.294 Test Acc: 0.500
Validation loss decreased (-0.459969 --> -0.499967).  Saving model ...
Epoch: 8 cost time: 1.3756086826324463
Epoch: 8, Steps: 4 | Train Loss: 0.154 Vali Loss: 4.748 Vali Acc: 0.420 Test Loss: 4.748 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2396118640899658
Epoch: 9, Steps: 4 | Train Loss: 0.012 Vali Loss: 4.981 Vali Acc: 0.380 Test Loss: 4.981 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4739725589752197
Epoch: 10, Steps: 4 | Train Loss: 0.072 Vali Loss: 5.691 Vali Acc: 0.480 Test Loss: 5.691 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.740675449371338
Epoch: 11, Steps: 4 | Train Loss: 0.058 Vali Loss: 7.234 Vali Acc: 0.460 Test Loss: 7.234 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.821326732635498
Epoch: 12, Steps: 4 | Train Loss: 0.083 Vali Loss: 8.649 Vali Acc: 0.440 Test Loss: 8.649 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4224827289581299
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 8.828 Vali Acc: 0.400 Test Loss: 8.828 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4728572368621826
Epoch: 14, Steps: 4 | Train Loss: 0.109 Vali Loss: 8.873 Vali Acc: 0.480 Test Loss: 8.873 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.369788646697998
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 7.954 Vali Acc: 0.440 Test Loss: 7.954 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7532055377960205
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.219 Vali Acc: 0.440 Test Loss: 7.219 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.706904411315918
Epoch: 17, Steps: 4 | Train Loss: 0.014 Vali Loss: 7.814 Vali Acc: 0.400 Test Loss: 7.814 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3702021
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9758429527282715
Epoch: 1, Steps: 4 | Train Loss: 1.816 Vali Loss: 1.613 Vali Acc: 0.280 Test Loss: 1.613 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.4277632236480713
Epoch: 2, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.540 Vali Acc: 0.340 Test Loss: 1.540 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.3621249198913574
Epoch: 3, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.872 Vali Acc: 0.280 Test Loss: 1.872 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.17531156539917
Epoch: 4, Steps: 4 | Train Loss: 0.464 Vali Loss: 2.331 Vali Acc: 0.380 Test Loss: 2.331 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379977).  Saving model ...
Epoch: 5 cost time: 1.3898320198059082
Epoch: 5, Steps: 4 | Train Loss: 0.540 Vali Loss: 2.660 Vali Acc: 0.380 Test Loss: 2.660 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6925342082977295
Epoch: 6, Steps: 4 | Train Loss: 0.484 Vali Loss: 3.092 Vali Acc: 0.380 Test Loss: 3.092 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.417919397354126
Epoch: 7, Steps: 4 | Train Loss: 0.415 Vali Loss: 3.412 Vali Acc: 0.420 Test Loss: 3.412 Test Acc: 0.420
Validation loss decreased (-0.379977 --> -0.419966).  Saving model ...
Epoch: 8 cost time: 1.3035383224487305
Epoch: 8, Steps: 4 | Train Loss: 0.169 Vali Loss: 3.605 Vali Acc: 0.480 Test Loss: 3.605 Test Acc: 0.480
Validation loss decreased (-0.419966 --> -0.479964).  Saving model ...
Epoch: 9 cost time: 1.4328844547271729
Epoch: 9, Steps: 4 | Train Loss: 0.027 Vali Loss: 4.191 Vali Acc: 0.420 Test Loss: 4.191 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5502798557281494
Epoch: 10, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.943 Vali Acc: 0.480 Test Loss: 3.943 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5682439804077148
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.190 Vali Acc: 0.480 Test Loss: 4.190 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5134782791137695
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.863 Vali Acc: 0.520 Test Loss: 5.863 Test Acc: 0.520
Validation loss decreased (-0.479964 --> -0.519941).  Saving model ...
Epoch: 13 cost time: 1.2180626392364502
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.765 Vali Acc: 0.500 Test Loss: 4.765 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3169517517089844
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.430 Vali Acc: 0.460 Test Loss: 4.430 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.257178783416748
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.886 Vali Acc: 0.460 Test Loss: 6.886 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6137096881866455
Epoch: 16, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.386 Vali Acc: 0.480 Test Loss: 6.386 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5654535293579102
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.646 Vali Acc: 0.500 Test Loss: 5.646 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4439666271209717
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.897 Vali Acc: 0.460 Test Loss: 5.897 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7491836547851562
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.854 Vali Acc: 0.420 Test Loss: 5.854 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6485373973846436
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.964 Vali Acc: 0.440 Test Loss: 5.964 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4984169006347656
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.337 Vali Acc: 0.500 Test Loss: 6.337 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4273414611816406
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.729 Vali Acc: 0.500 Test Loss: 6.729 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3701903
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8182504177093506
Epoch: 1, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.663 Vali Acc: 0.240 Test Loss: 1.663 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.335153341293335
Epoch: 2, Steps: 4 | Train Loss: 1.506 Vali Loss: 2.186 Vali Acc: 0.300 Test Loss: 2.186 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299978).  Saving model ...
Epoch: 3 cost time: 1.4520339965820312
Epoch: 3, Steps: 4 | Train Loss: 0.859 Vali Loss: 2.152 Vali Acc: 0.340 Test Loss: 2.152 Test Acc: 0.340
Validation loss decreased (-0.299978 --> -0.339978).  Saving model ...
Epoch: 4 cost time: 1.2615411281585693
Epoch: 4, Steps: 4 | Train Loss: 0.677 Vali Loss: 2.585 Vali Acc: 0.400 Test Loss: 2.585 Test Acc: 0.400
Validation loss decreased (-0.339978 --> -0.399974).  Saving model ...
Epoch: 5 cost time: 1.251650094985962
Epoch: 5, Steps: 4 | Train Loss: 0.358 Vali Loss: 3.007 Vali Acc: 0.360 Test Loss: 3.007 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6567394733428955
Epoch: 6, Steps: 4 | Train Loss: 0.270 Vali Loss: 3.540 Vali Acc: 0.440 Test Loss: 3.540 Test Acc: 0.440
Validation loss decreased (-0.399974 --> -0.439965).  Saving model ...
Epoch: 7 cost time: 1.2472591400146484
Epoch: 7, Steps: 4 | Train Loss: 0.105 Vali Loss: 3.437 Vali Acc: 0.500 Test Loss: 3.437 Test Acc: 0.500
Validation loss decreased (-0.439965 --> -0.499966).  Saving model ...
Epoch: 8 cost time: 1.2360310554504395
Epoch: 8, Steps: 4 | Train Loss: 0.017 Vali Loss: 3.896 Vali Acc: 0.440 Test Loss: 3.896 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5810415744781494
Epoch: 9, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.290 Vali Acc: 0.460 Test Loss: 4.290 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.356740951538086
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.739 Vali Acc: 0.500 Test Loss: 4.739 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.265070915222168
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.107 Vali Acc: 0.480 Test Loss: 5.107 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3130238056182861
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.320 Vali Acc: 0.460 Test Loss: 5.320 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.504795789718628
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.412 Vali Acc: 0.480 Test Loss: 5.412 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5172410011291504
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.427 Vali Acc: 0.480 Test Loss: 5.427 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2999207973480225
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.411 Vali Acc: 0.500 Test Loss: 5.411 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.542856216430664
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.390 Vali Acc: 0.500 Test Loss: 5.390 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5150442123413086
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.378 Vali Acc: 0.500 Test Loss: 5.378 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3702647
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.454375982284546
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.548 Vali Acc: 0.240 Test Loss: 1.548 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.125270128250122
Epoch: 2, Steps: 4 | Train Loss: 0.988 Vali Loss: 1.911 Vali Acc: 0.320 Test Loss: 1.911 Test Acc: 0.320
Validation loss decreased (-0.239985 --> -0.319981).  Saving model ...
Epoch: 3 cost time: 1.0921423435211182
Epoch: 3, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.918 Vali Acc: 0.440 Test Loss: 1.918 Test Acc: 0.440
Validation loss decreased (-0.319981 --> -0.439981).  Saving model ...
Epoch: 4 cost time: 1.2507777214050293
Epoch: 4, Steps: 4 | Train Loss: 0.366 Vali Loss: 4.032 Vali Acc: 0.260 Test Loss: 4.032 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5048203468322754
Epoch: 5, Steps: 4 | Train Loss: 0.812 Vali Loss: 2.896 Vali Acc: 0.480 Test Loss: 2.896 Test Acc: 0.480
Validation loss decreased (-0.439981 --> -0.479971).  Saving model ...
Epoch: 6 cost time: 1.249837875366211
Epoch: 6, Steps: 4 | Train Loss: 0.350 Vali Loss: 3.464 Vali Acc: 0.460 Test Loss: 3.464 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3682935237884521
Epoch: 7, Steps: 4 | Train Loss: 0.097 Vali Loss: 6.296 Vali Acc: 0.360 Test Loss: 6.296 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2480759620666504
Epoch: 8, Steps: 4 | Train Loss: 0.358 Vali Loss: 5.447 Vali Acc: 0.500 Test Loss: 5.447 Test Acc: 0.500
Validation loss decreased (-0.479971 --> -0.499946).  Saving model ...
Epoch: 9 cost time: 1.2887601852416992
Epoch: 9, Steps: 4 | Train Loss: 0.213 Vali Loss: 4.904 Vali Acc: 0.420 Test Loss: 4.904 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1939196586608887
Epoch: 10, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.450 Vali Acc: 0.440 Test Loss: 5.450 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1510658264160156
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.697 Vali Acc: 0.400 Test Loss: 6.697 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2777388095855713
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.858 Vali Acc: 0.380 Test Loss: 7.858 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4953925609588623
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 8.365 Vali Acc: 0.360 Test Loss: 8.365 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1188864707946777
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.782 Vali Acc: 0.440 Test Loss: 8.782 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0869369506835938
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.430 Vali Acc: 0.380 Test Loss: 9.430 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2262156009674072
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.430 Vali Acc: 0.360 Test Loss: 8.430 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2106423377990723
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 9.102 Vali Acc: 0.340 Test Loss: 9.102 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2292897701263428
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 9.456 Vali Acc: 0.300 Test Loss: 9.456 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3702331
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2808992862701416
Epoch: 1, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.460 Vali Acc: 0.340 Test Loss: 1.460 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.3668944835662842
Epoch: 2, Steps: 4 | Train Loss: 1.416 Vali Loss: 1.750 Vali Acc: 0.380 Test Loss: 1.750 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379983).  Saving model ...
Epoch: 3 cost time: 1.3317615985870361
Epoch: 3, Steps: 4 | Train Loss: 0.865 Vali Loss: 1.979 Vali Acc: 0.400 Test Loss: 1.979 Test Acc: 0.400
Validation loss decreased (-0.379983 --> -0.399980).  Saving model ...
Epoch: 4 cost time: 1.16314697265625
Epoch: 4, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.886 Vali Acc: 0.460 Test Loss: 2.886 Test Acc: 0.460
Validation loss decreased (-0.399980 --> -0.459971).  Saving model ...
Epoch: 5 cost time: 1.3048875331878662
Epoch: 5, Steps: 4 | Train Loss: 0.207 Vali Loss: 2.556 Vali Acc: 0.400 Test Loss: 2.556 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1500399112701416
Epoch: 6, Steps: 4 | Train Loss: 0.133 Vali Loss: 4.681 Vali Acc: 0.400 Test Loss: 4.681 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.444955587387085
Epoch: 7, Steps: 4 | Train Loss: 0.128 Vali Loss: 4.161 Vali Acc: 0.480 Test Loss: 4.161 Test Acc: 0.480
Validation loss decreased (-0.459971 --> -0.479958).  Saving model ...
Epoch: 8 cost time: 1.4035418033599854
Epoch: 8, Steps: 4 | Train Loss: 0.074 Vali Loss: 4.038 Vali Acc: 0.480 Test Loss: 4.038 Test Acc: 0.480
Validation loss decreased (-0.479958 --> -0.479960).  Saving model ...
Epoch: 9 cost time: 1.4105744361877441
Epoch: 9, Steps: 4 | Train Loss: 0.050 Vali Loss: 4.755 Vali Acc: 0.480 Test Loss: 4.755 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1828069686889648
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.201 Vali Acc: 0.480 Test Loss: 6.201 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3984270095825195
Epoch: 11, Steps: 4 | Train Loss: 0.014 Vali Loss: 6.054 Vali Acc: 0.440 Test Loss: 6.054 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1128404140472412
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.715 Vali Acc: 0.440 Test Loss: 5.715 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3143548965454102
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.732 Vali Acc: 0.460 Test Loss: 5.732 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3540878295898438
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.658 Vali Acc: 0.440 Test Loss: 6.658 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4114923477172852
Epoch: 15, Steps: 4 | Train Loss: 0.017 Vali Loss: 7.491 Vali Acc: 0.400 Test Loss: 7.491 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2809011936187744
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.042 Vali Acc: 0.440 Test Loss: 8.042 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3087425231933594
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.076 Vali Acc: 0.420 Test Loss: 9.076 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.097100019454956
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.906 Vali Acc: 0.480 Test Loss: 9.906 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3701765
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6070117950439453
Epoch: 1, Steps: 4 | Train Loss: 1.683 Vali Loss: 1.659 Vali Acc: 0.180 Test Loss: 1.659 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.2120118141174316
Epoch: 2, Steps: 4 | Train Loss: 1.363 Vali Loss: 2.251 Vali Acc: 0.260 Test Loss: 2.251 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259977).  Saving model ...
Epoch: 3 cost time: 1.0331552028656006
Epoch: 3, Steps: 4 | Train Loss: 0.865 Vali Loss: 2.182 Vali Acc: 0.420 Test Loss: 2.182 Test Acc: 0.420
Validation loss decreased (-0.259977 --> -0.419978).  Saving model ...
Epoch: 4 cost time: 1.4618334770202637
Epoch: 4, Steps: 4 | Train Loss: 0.642 Vali Loss: 3.090 Vali Acc: 0.420 Test Loss: 3.090 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5351369380950928
Epoch: 5, Steps: 4 | Train Loss: 0.499 Vali Loss: 2.726 Vali Acc: 0.380 Test Loss: 2.726 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3478929996490479
Epoch: 6, Steps: 4 | Train Loss: 0.142 Vali Loss: 4.824 Vali Acc: 0.440 Test Loss: 4.824 Test Acc: 0.440
Validation loss decreased (-0.419978 --> -0.439952).  Saving model ...
Epoch: 7 cost time: 1.2125883102416992
Epoch: 7, Steps: 4 | Train Loss: 0.263 Vali Loss: 4.001 Vali Acc: 0.440 Test Loss: 4.001 Test Acc: 0.440
Validation loss decreased (-0.439952 --> -0.439960).  Saving model ...
Epoch: 8 cost time: 1.6705660820007324
Epoch: 8, Steps: 4 | Train Loss: 0.041 Vali Loss: 4.531 Vali Acc: 0.480 Test Loss: 4.531 Test Acc: 0.480
Validation loss decreased (-0.439960 --> -0.479955).  Saving model ...
Epoch: 9 cost time: 1.6032605171203613
Epoch: 9, Steps: 4 | Train Loss: 0.052 Vali Loss: 5.301 Vali Acc: 0.480 Test Loss: 5.301 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.742689847946167
Epoch: 10, Steps: 4 | Train Loss: 0.014 Vali Loss: 4.984 Vali Acc: 0.420 Test Loss: 4.984 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.351119041442871
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.917 Vali Acc: 0.340 Test Loss: 5.917 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4607796669006348
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.014 Vali Acc: 0.460 Test Loss: 5.014 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1615629196166992
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.776 Vali Acc: 0.420 Test Loss: 5.776 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3240618705749512
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.127 Vali Acc: 0.440 Test Loss: 6.127 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.342958927154541
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.420 Vali Acc: 0.440 Test Loss: 6.420 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.345794677734375
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.558 Vali Acc: 0.460 Test Loss: 6.558 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4496400356292725
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.582 Vali Acc: 0.480 Test Loss: 6.582 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3462200164794922
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.572 Vali Acc: 0.460 Test Loss: 6.572 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3701759
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4795405864715576
Epoch: 1, Steps: 4 | Train Loss: 1.789 Vali Loss: 1.757 Vali Acc: 0.260 Test Loss: 1.757 Test Acc: 0.260
Validation loss decreased (inf --> -0.259982).  Saving model ...
Epoch: 2 cost time: 1.1339061260223389
Epoch: 2, Steps: 4 | Train Loss: 1.341 Vali Loss: 1.526 Vali Acc: 0.380 Test Loss: 1.526 Test Acc: 0.380
Validation loss decreased (-0.259982 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.238748550415039
Epoch: 3, Steps: 4 | Train Loss: 0.794 Vali Loss: 2.116 Vali Acc: 0.400 Test Loss: 2.116 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399979).  Saving model ...
Epoch: 4 cost time: 1.220700740814209
Epoch: 4, Steps: 4 | Train Loss: 0.569 Vali Loss: 2.550 Vali Acc: 0.380 Test Loss: 2.550 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.334587574005127
Epoch: 5, Steps: 4 | Train Loss: 0.172 Vali Loss: 3.820 Vali Acc: 0.420 Test Loss: 3.820 Test Acc: 0.420
Validation loss decreased (-0.399979 --> -0.419962).  Saving model ...
Epoch: 6 cost time: 1.2075772285461426
Epoch: 6, Steps: 4 | Train Loss: 0.334 Vali Loss: 3.475 Vali Acc: 0.400 Test Loss: 3.475 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0644032955169678
Epoch: 7, Steps: 4 | Train Loss: 0.465 Vali Loss: 4.113 Vali Acc: 0.420 Test Loss: 4.113 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0783119201660156
Epoch: 8, Steps: 4 | Train Loss: 0.458 Vali Loss: 5.229 Vali Acc: 0.460 Test Loss: 5.229 Test Acc: 0.460
Validation loss decreased (-0.419962 --> -0.459948).  Saving model ...
Epoch: 9 cost time: 1.1551125049591064
Epoch: 9, Steps: 4 | Train Loss: 0.196 Vali Loss: 4.472 Vali Acc: 0.480 Test Loss: 4.472 Test Acc: 0.480
Validation loss decreased (-0.459948 --> -0.479955).  Saving model ...
Epoch: 10 cost time: 1.2103617191314697
Epoch: 10, Steps: 4 | Train Loss: 0.135 Vali Loss: 5.522 Vali Acc: 0.380 Test Loss: 5.522 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1612069606781006
Epoch: 11, Steps: 4 | Train Loss: 0.038 Vali Loss: 6.157 Vali Acc: 0.420 Test Loss: 6.157 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.349113941192627
Epoch: 12, Steps: 4 | Train Loss: 0.066 Vali Loss: 5.772 Vali Acc: 0.400 Test Loss: 5.772 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.156024694442749
Epoch: 13, Steps: 4 | Train Loss: 0.025 Vali Loss: 7.001 Vali Acc: 0.480 Test Loss: 7.001 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1036860942840576
Epoch: 14, Steps: 4 | Train Loss: 0.034 Vali Loss: 6.936 Vali Acc: 0.440 Test Loss: 6.936 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1533682346343994
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.607 Vali Acc: 0.440 Test Loss: 6.607 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.096052646636963
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.554 Vali Acc: 0.380 Test Loss: 6.554 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2480463981628418
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.619 Vali Acc: 0.340 Test Loss: 6.619 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9910492897033691
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.534 Vali Acc: 0.400 Test Loss: 6.534 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0843219757080078
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.155 Vali Acc: 0.400 Test Loss: 6.155 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3703123
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9517931938171387
Epoch: 1, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.723 Vali Acc: 0.220 Test Loss: 1.723 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.18294358253479
Epoch: 2, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.748 Vali Acc: 0.380 Test Loss: 1.748 Test Acc: 0.380
Validation loss decreased (-0.219983 --> -0.379983).  Saving model ...
Epoch: 3 cost time: 1.1286993026733398
Epoch: 3, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.872 Vali Acc: 0.500 Test Loss: 1.872 Test Acc: 0.500
Validation loss decreased (-0.379983 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 0.9730262756347656
Epoch: 4, Steps: 4 | Train Loss: 0.462 Vali Loss: 2.554 Vali Acc: 0.440 Test Loss: 2.554 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1536502838134766
Epoch: 5, Steps: 4 | Train Loss: 0.266 Vali Loss: 3.590 Vali Acc: 0.420 Test Loss: 3.590 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4366583824157715
Epoch: 6, Steps: 4 | Train Loss: 0.275 Vali Loss: 3.279 Vali Acc: 0.400 Test Loss: 3.279 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.060088872909546
Epoch: 7, Steps: 4 | Train Loss: 0.222 Vali Loss: 4.094 Vali Acc: 0.480 Test Loss: 4.094 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4632251262664795
Epoch: 8, Steps: 4 | Train Loss: 0.108 Vali Loss: 4.983 Vali Acc: 0.360 Test Loss: 4.983 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.024811029434204
Epoch: 9, Steps: 4 | Train Loss: 0.029 Vali Loss: 4.264 Vali Acc: 0.480 Test Loss: 4.264 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1627147197723389
Epoch: 10, Steps: 4 | Train Loss: 0.023 Vali Loss: 4.683 Vali Acc: 0.400 Test Loss: 4.683 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.935429573059082
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.105 Vali Acc: 0.460 Test Loss: 5.105 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3060040473937988
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.753 Vali Acc: 0.440 Test Loss: 5.753 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4733152389526367
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.268 Vali Acc: 0.460 Test Loss: 6.268 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3703411
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.459200859069824
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.674 Vali Acc: 0.260 Test Loss: 1.674 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.5372257232666016
Epoch: 2, Steps: 4 | Train Loss: 1.132 Vali Loss: 2.384 Vali Acc: 0.240 Test Loss: 2.384 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.339158058166504
Epoch: 3, Steps: 4 | Train Loss: 0.737 Vali Loss: 2.188 Vali Acc: 0.320 Test Loss: 2.188 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319978).  Saving model ...
Epoch: 4 cost time: 1.3165700435638428
Epoch: 4, Steps: 4 | Train Loss: 0.509 Vali Loss: 3.700 Vali Acc: 0.340 Test Loss: 3.700 Test Acc: 0.340
Validation loss decreased (-0.319978 --> -0.339963).  Saving model ...
Epoch: 5 cost time: 1.4215366840362549
Epoch: 5, Steps: 4 | Train Loss: 0.953 Vali Loss: 3.898 Vali Acc: 0.380 Test Loss: 3.898 Test Acc: 0.380
Validation loss decreased (-0.339963 --> -0.379961).  Saving model ...
Epoch: 6 cost time: 1.574112892150879
Epoch: 6, Steps: 4 | Train Loss: 0.204 Vali Loss: 4.521 Vali Acc: 0.360 Test Loss: 4.521 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3550381660461426
Epoch: 7, Steps: 4 | Train Loss: 0.482 Vali Loss: 5.225 Vali Acc: 0.500 Test Loss: 5.225 Test Acc: 0.500
Validation loss decreased (-0.379961 --> -0.499948).  Saving model ...
Epoch: 8 cost time: 1.6422836780548096
Epoch: 8, Steps: 4 | Train Loss: 0.164 Vali Loss: 5.333 Vali Acc: 0.420 Test Loss: 5.333 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.446056842803955
Epoch: 9, Steps: 4 | Train Loss: 0.179 Vali Loss: 5.005 Vali Acc: 0.480 Test Loss: 5.005 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1652798652648926
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 7.954 Vali Acc: 0.360 Test Loss: 7.954 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3751089572906494
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 8.564 Vali Acc: 0.440 Test Loss: 8.564 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.769714593887329
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.698 Vali Acc: 0.280 Test Loss: 9.698 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5518732070922852
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 10.654 Vali Acc: 0.360 Test Loss: 10.654 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.514110803604126
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 11.174 Vali Acc: 0.420 Test Loss: 11.174 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.562455177307129
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.181 Vali Acc: 0.420 Test Loss: 11.181 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3364133834838867
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.596 Vali Acc: 0.440 Test Loss: 10.596 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.419806957244873
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.152 Vali Acc: 0.480 Test Loss: 10.152 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3702623
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.361906051635742
Epoch: 1, Steps: 4 | Train Loss: 1.761 Vali Loss: 1.849 Vali Acc: 0.220 Test Loss: 1.849 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 1.0599925518035889
Epoch: 2, Steps: 4 | Train Loss: 1.359 Vali Loss: 1.848 Vali Acc: 0.360 Test Loss: 1.848 Test Acc: 0.360
Validation loss decreased (-0.219982 --> -0.359982).  Saving model ...
Epoch: 3 cost time: 1.1350562572479248
Epoch: 3, Steps: 4 | Train Loss: 0.658 Vali Loss: 2.794 Vali Acc: 0.340 Test Loss: 2.794 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1403565406799316
Epoch: 4, Steps: 4 | Train Loss: 0.526 Vali Loss: 3.386 Vali Acc: 0.360 Test Loss: 3.386 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1363346576690674
Epoch: 5, Steps: 4 | Train Loss: 0.711 Vali Loss: 3.562 Vali Acc: 0.360 Test Loss: 3.562 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2775204181671143
Epoch: 6, Steps: 4 | Train Loss: 0.419 Vali Loss: 4.425 Vali Acc: 0.440 Test Loss: 4.425 Test Acc: 0.440
Validation loss decreased (-0.359982 --> -0.439956).  Saving model ...
Epoch: 7 cost time: 1.0744459629058838
Epoch: 7, Steps: 4 | Train Loss: 0.139 Vali Loss: 3.771 Vali Acc: 0.500 Test Loss: 3.771 Test Acc: 0.500
Validation loss decreased (-0.439956 --> -0.499962).  Saving model ...
Epoch: 8 cost time: 1.2306883335113525
Epoch: 8, Steps: 4 | Train Loss: 0.101 Vali Loss: 5.453 Vali Acc: 0.320 Test Loss: 5.453 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.158961296081543
Epoch: 9, Steps: 4 | Train Loss: 0.094 Vali Loss: 5.779 Vali Acc: 0.420 Test Loss: 5.779 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3886120319366455
Epoch: 10, Steps: 4 | Train Loss: 0.078 Vali Loss: 6.632 Vali Acc: 0.400 Test Loss: 6.632 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1908607482910156
Epoch: 11, Steps: 4 | Train Loss: 0.202 Vali Loss: 6.769 Vali Acc: 0.340 Test Loss: 6.769 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1432511806488037
Epoch: 12, Steps: 4 | Train Loss: 0.147 Vali Loss: 9.428 Vali Acc: 0.340 Test Loss: 9.428 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.147674560546875
Epoch: 13, Steps: 4 | Train Loss: 0.039 Vali Loss: 10.405 Vali Acc: 0.460 Test Loss: 10.405 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1492908000946045
Epoch: 14, Steps: 4 | Train Loss: 0.309 Vali Loss: 7.972 Vali Acc: 0.500 Test Loss: 7.972 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1385581493377686
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.041 Vali Acc: 0.420 Test Loss: 6.041 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1924028396606445
Epoch: 16, Steps: 4 | Train Loss: 0.050 Vali Loss: 6.979 Vali Acc: 0.360 Test Loss: 6.979 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0766639709472656
Epoch: 17, Steps: 4 | Train Loss: 0.010 Vali Loss: 7.722 Vali Acc: 0.360 Test Loss: 7.722 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3704555
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1268649101257324
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.574 Vali Acc: 0.220 Test Loss: 1.574 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.4108242988586426
Epoch: 2, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.972 Vali Acc: 0.260 Test Loss: 1.972 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259980).  Saving model ...
Epoch: 3 cost time: 1.1260290145874023
Epoch: 3, Steps: 4 | Train Loss: 0.861 Vali Loss: 2.865 Vali Acc: 0.240 Test Loss: 2.865 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0284790992736816
Epoch: 4, Steps: 4 | Train Loss: 1.072 Vali Loss: 2.233 Vali Acc: 0.440 Test Loss: 2.233 Test Acc: 0.440
Validation loss decreased (-0.259980 --> -0.439978).  Saving model ...
Epoch: 5 cost time: 1.1151745319366455
Epoch: 5, Steps: 4 | Train Loss: 0.625 Vali Loss: 2.916 Vali Acc: 0.460 Test Loss: 2.916 Test Acc: 0.460
Validation loss decreased (-0.439978 --> -0.459971).  Saving model ...
Epoch: 6 cost time: 1.2627499103546143
Epoch: 6, Steps: 4 | Train Loss: 0.304 Vali Loss: 3.028 Vali Acc: 0.480 Test Loss: 3.028 Test Acc: 0.480
Validation loss decreased (-0.459971 --> -0.479970).  Saving model ...
Epoch: 7 cost time: 1.1668701171875
Epoch: 7, Steps: 4 | Train Loss: 0.151 Vali Loss: 4.178 Vali Acc: 0.420 Test Loss: 4.178 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1335194110870361
Epoch: 8, Steps: 4 | Train Loss: 0.093 Vali Loss: 4.517 Vali Acc: 0.340 Test Loss: 4.517 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0713844299316406
Epoch: 9, Steps: 4 | Train Loss: 0.248 Vali Loss: 5.319 Vali Acc: 0.300 Test Loss: 5.319 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2486958503723145
Epoch: 10, Steps: 4 | Train Loss: 0.398 Vali Loss: 4.936 Vali Acc: 0.340 Test Loss: 4.936 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1986851692199707
Epoch: 11, Steps: 4 | Train Loss: 0.048 Vali Loss: 5.380 Vali Acc: 0.400 Test Loss: 5.380 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3855822086334229
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.203 Vali Acc: 0.360 Test Loss: 6.203 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1453428268432617
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 7.427 Vali Acc: 0.440 Test Loss: 7.427 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1566078662872314
Epoch: 14, Steps: 4 | Train Loss: 0.038 Vali Loss: 8.060 Vali Acc: 0.400 Test Loss: 8.060 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0226786136627197
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.096 Vali Acc: 0.380 Test Loss: 8.096 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3596129417419434
Epoch: 16, Steps: 4 | Train Loss: 0.012 Vali Loss: 7.825 Vali Acc: 0.480 Test Loss: 7.825 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3701885
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.52158522605896
Epoch: 1, Steps: 4 | Train Loss: 1.569 Vali Loss: 1.568 Vali Acc: 0.260 Test Loss: 1.568 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3465993404388428
Epoch: 2, Steps: 4 | Train Loss: 1.316 Vali Loss: 1.956 Vali Acc: 0.300 Test Loss: 1.956 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299980).  Saving model ...
Epoch: 3 cost time: 1.5045702457427979
Epoch: 3, Steps: 4 | Train Loss: 0.881 Vali Loss: 2.305 Vali Acc: 0.360 Test Loss: 2.305 Test Acc: 0.360
Validation loss decreased (-0.299980 --> -0.359977).  Saving model ...
Epoch: 4 cost time: 1.787463665008545
Epoch: 4, Steps: 4 | Train Loss: 0.371 Vali Loss: 3.019 Vali Acc: 0.400 Test Loss: 3.019 Test Acc: 0.400
Validation loss decreased (-0.359977 --> -0.399970).  Saving model ...
Epoch: 5 cost time: 1.732105016708374
Epoch: 5, Steps: 4 | Train Loss: 0.455 Vali Loss: 2.724 Vali Acc: 0.480 Test Loss: 2.724 Test Acc: 0.480
Validation loss decreased (-0.399970 --> -0.479973).  Saving model ...
Epoch: 6 cost time: 1.3337533473968506
Epoch: 6, Steps: 4 | Train Loss: 0.162 Vali Loss: 4.500 Vali Acc: 0.440 Test Loss: 4.500 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4855778217315674
Epoch: 7, Steps: 4 | Train Loss: 0.263 Vali Loss: 6.372 Vali Acc: 0.360 Test Loss: 6.372 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.695788860321045
Epoch: 8, Steps: 4 | Train Loss: 0.323 Vali Loss: 5.483 Vali Acc: 0.300 Test Loss: 5.483 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3394813537597656
Epoch: 9, Steps: 4 | Train Loss: 0.090 Vali Loss: 6.077 Vali Acc: 0.460 Test Loss: 6.077 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5484392642974854
Epoch: 10, Steps: 4 | Train Loss: 0.302 Vali Loss: 8.572 Vali Acc: 0.340 Test Loss: 8.572 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4466056823730469
Epoch: 11, Steps: 4 | Train Loss: 0.118 Vali Loss: 7.816 Vali Acc: 0.340 Test Loss: 7.816 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.378727912902832
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 8.646 Vali Acc: 0.340 Test Loss: 8.646 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4362189769744873
Epoch: 13, Steps: 4 | Train Loss: 0.025 Vali Loss: 9.854 Vali Acc: 0.420 Test Loss: 9.854 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3963677883148193
Epoch: 14, Steps: 4 | Train Loss: 0.028 Vali Loss: 10.328 Vali Acc: 0.420 Test Loss: 10.328 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5594632625579834
Epoch: 15, Steps: 4 | Train Loss: 0.017 Vali Loss: 10.412 Vali Acc: 0.420 Test Loss: 10.412 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3702475
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2634339332580566
Epoch: 1, Steps: 4 | Train Loss: 1.789 Vali Loss: 1.640 Vali Acc: 0.260 Test Loss: 1.640 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3055927753448486
Epoch: 2, Steps: 4 | Train Loss: 1.423 Vali Loss: 1.798 Vali Acc: 0.260 Test Loss: 1.798 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8375849723815918
Epoch: 3, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.931 Vali Acc: 0.340 Test Loss: 1.931 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339981).  Saving model ...
Epoch: 4 cost time: 1.4744446277618408
Epoch: 4, Steps: 4 | Train Loss: 0.364 Vali Loss: 3.264 Vali Acc: 0.400 Test Loss: 3.264 Test Acc: 0.400
Validation loss decreased (-0.339981 --> -0.399967).  Saving model ...
Epoch: 5 cost time: 1.4086596965789795
Epoch: 5, Steps: 4 | Train Loss: 0.443 Vali Loss: 2.512 Vali Acc: 0.380 Test Loss: 2.512 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.613962173461914
Epoch: 6, Steps: 4 | Train Loss: 0.192 Vali Loss: 3.944 Vali Acc: 0.320 Test Loss: 3.944 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.205660343170166
Epoch: 7, Steps: 4 | Train Loss: 0.356 Vali Loss: 4.984 Vali Acc: 0.440 Test Loss: 4.984 Test Acc: 0.440
Validation loss decreased (-0.399967 --> -0.439950).  Saving model ...
Epoch: 8 cost time: 1.2817270755767822
Epoch: 8, Steps: 4 | Train Loss: 0.305 Vali Loss: 3.704 Vali Acc: 0.460 Test Loss: 3.704 Test Acc: 0.460
Validation loss decreased (-0.439950 --> -0.459963).  Saving model ...
Epoch: 9 cost time: 1.204005241394043
Epoch: 9, Steps: 4 | Train Loss: 0.421 Vali Loss: 4.485 Vali Acc: 0.400 Test Loss: 4.485 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4012916088104248
Epoch: 10, Steps: 4 | Train Loss: 0.080 Vali Loss: 5.912 Vali Acc: 0.460 Test Loss: 5.912 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3065688610076904
Epoch: 11, Steps: 4 | Train Loss: 0.169 Vali Loss: 6.836 Vali Acc: 0.480 Test Loss: 6.836 Test Acc: 0.480
Validation loss decreased (-0.459963 --> -0.479932).  Saving model ...
Epoch: 12 cost time: 1.5134968757629395
Epoch: 12, Steps: 4 | Train Loss: 0.099 Vali Loss: 7.216 Vali Acc: 0.360 Test Loss: 7.216 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4188005924224854
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.142 Vali Acc: 0.440 Test Loss: 7.142 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4599015712738037
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.408 Vali Acc: 0.400 Test Loss: 7.408 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7133944034576416
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.734 Vali Acc: 0.440 Test Loss: 5.734 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3770678043365479
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.717 Vali Acc: 0.400 Test Loss: 5.717 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2464637756347656
Epoch: 17, Steps: 4 | Train Loss: 0.047 Vali Loss: 5.676 Vali Acc: 0.440 Test Loss: 5.676 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.267961025238037
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.632 Vali Acc: 0.340 Test Loss: 7.632 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7047858238220215
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.335 Vali Acc: 0.340 Test Loss: 10.335 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.884652853012085
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 11.324 Vali Acc: 0.380 Test Loss: 11.324 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4085273742675781
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.626 Vali Acc: 0.400 Test Loss: 10.626 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3702529
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6762731075286865
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.670 Vali Acc: 0.180 Test Loss: 1.670 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.1009161472320557
Epoch: 2, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.730 Vali Acc: 0.340 Test Loss: 1.730 Test Acc: 0.340
Validation loss decreased (-0.179983 --> -0.339983).  Saving model ...
Epoch: 3 cost time: 1.232438564300537
Epoch: 3, Steps: 4 | Train Loss: 0.950 Vali Loss: 3.112 Vali Acc: 0.440 Test Loss: 3.112 Test Acc: 0.440
Validation loss decreased (-0.339983 --> -0.439969).  Saving model ...
Epoch: 4 cost time: 0.9375526905059814
Epoch: 4, Steps: 4 | Train Loss: 0.805 Vali Loss: 2.449 Vali Acc: 0.380 Test Loss: 2.449 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1193883419036865
Epoch: 5, Steps: 4 | Train Loss: 1.058 Vali Loss: 3.832 Vali Acc: 0.400 Test Loss: 3.832 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9515483379364014
Epoch: 6, Steps: 4 | Train Loss: 0.713 Vali Loss: 4.323 Vali Acc: 0.360 Test Loss: 4.323 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.006528377532959
Epoch: 7, Steps: 4 | Train Loss: 0.255 Vali Loss: 4.164 Vali Acc: 0.480 Test Loss: 4.164 Test Acc: 0.480
Validation loss decreased (-0.439969 --> -0.479958).  Saving model ...
Epoch: 8 cost time: 1.0128202438354492
Epoch: 8, Steps: 4 | Train Loss: 0.408 Vali Loss: 3.611 Vali Acc: 0.420 Test Loss: 3.611 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0819323062896729
Epoch: 9, Steps: 4 | Train Loss: 0.104 Vali Loss: 6.152 Vali Acc: 0.420 Test Loss: 6.152 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0518083572387695
Epoch: 10, Steps: 4 | Train Loss: 0.019 Vali Loss: 4.548 Vali Acc: 0.440 Test Loss: 4.548 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0437097549438477
Epoch: 11, Steps: 4 | Train Loss: 0.030 Vali Loss: 5.549 Vali Acc: 0.480 Test Loss: 5.549 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.022949457168579
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.872 Vali Acc: 0.420 Test Loss: 7.872 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0821797847747803
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.487 Vali Acc: 0.380 Test Loss: 9.487 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0026724338531494
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.152 Vali Acc: 0.460 Test Loss: 8.152 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1271677017211914
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.698 Vali Acc: 0.400 Test Loss: 6.698 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3255321979522705
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.918 Vali Acc: 0.440 Test Loss: 5.918 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3734569549560547
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.742 Vali Acc: 0.460 Test Loss: 5.742 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 3702047
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1451244354248047
Epoch: 1, Steps: 4 | Train Loss: 1.748 Vali Loss: 1.644 Vali Acc: 0.240 Test Loss: 1.644 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.46437668800354
Epoch: 2, Steps: 4 | Train Loss: 1.289 Vali Loss: 2.150 Vali Acc: 0.260 Test Loss: 2.150 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259979).  Saving model ...
Epoch: 3 cost time: 1.6185998916625977
Epoch: 3, Steps: 4 | Train Loss: 0.810 Vali Loss: 2.303 Vali Acc: 0.360 Test Loss: 2.303 Test Acc: 0.360
Validation loss decreased (-0.259979 --> -0.359977).  Saving model ...
Epoch: 4 cost time: 1.1293742656707764
Epoch: 4, Steps: 4 | Train Loss: 0.908 Vali Loss: 3.091 Vali Acc: 0.340 Test Loss: 3.091 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2505431175231934
Epoch: 5, Steps: 4 | Train Loss: 0.344 Vali Loss: 4.820 Vali Acc: 0.300 Test Loss: 4.820 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.221407413482666
Epoch: 6, Steps: 4 | Train Loss: 1.527 Vali Loss: 4.083 Vali Acc: 0.380 Test Loss: 4.083 Test Acc: 0.380
Validation loss decreased (-0.359977 --> -0.379959).  Saving model ...
Epoch: 7 cost time: 1.177457571029663
Epoch: 7, Steps: 4 | Train Loss: 0.935 Vali Loss: 4.370 Vali Acc: 0.380 Test Loss: 4.370 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4144177436828613
Epoch: 8, Steps: 4 | Train Loss: 0.185 Vali Loss: 5.784 Vali Acc: 0.360 Test Loss: 5.784 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3850798606872559
Epoch: 9, Steps: 4 | Train Loss: 0.224 Vali Loss: 6.746 Vali Acc: 0.400 Test Loss: 6.746 Test Acc: 0.400
Validation loss decreased (-0.379959 --> -0.399933).  Saving model ...
Epoch: 10 cost time: 1.142892599105835
Epoch: 10, Steps: 4 | Train Loss: 0.016 Vali Loss: 5.785 Vali Acc: 0.320 Test Loss: 5.785 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.231522560119629
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 5.941 Vali Acc: 0.440 Test Loss: 5.941 Test Acc: 0.440
Validation loss decreased (-0.399933 --> -0.439941).  Saving model ...
Epoch: 12 cost time: 1.3068861961364746
Epoch: 12, Steps: 4 | Train Loss: 0.049 Vali Loss: 7.017 Vali Acc: 0.400 Test Loss: 7.017 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4186122417449951
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 9.039 Vali Acc: 0.420 Test Loss: 9.039 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.298553228378296
Epoch: 14, Steps: 4 | Train Loss: 0.027 Vali Loss: 7.259 Vali Acc: 0.400 Test Loss: 7.259 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1847155094146729
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.907 Vali Acc: 0.360 Test Loss: 8.907 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1084482669830322
Epoch: 16, Steps: 4 | Train Loss: 0.025 Vali Loss: 8.789 Vali Acc: 0.440 Test Loss: 8.789 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.460458755493164
Epoch: 17, Steps: 4 | Train Loss: 0.024 Vali Loss: 9.149 Vali Acc: 0.320 Test Loss: 9.149 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2995893955230713
Epoch: 18, Steps: 4 | Train Loss: 0.024 Vali Loss: 9.769 Vali Acc: 0.360 Test Loss: 9.769 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5666685104370117
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 10.745 Vali Acc: 0.420 Test Loss: 10.745 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2174251079559326
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 14.202 Vali Acc: 0.360 Test Loss: 14.202 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4000113010406494
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 16.626 Vali Acc: 0.420 Test Loss: 16.626 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 3704891
model size : 14.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.830156087875366
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.610 Vali Acc: 0.300 Test Loss: 1.610 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.4074854850769043
Epoch: 2, Steps: 4 | Train Loss: 1.761 Vali Loss: 1.504 Vali Acc: 0.300 Test Loss: 1.504 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.1513950824737549
Epoch: 3, Steps: 4 | Train Loss: 0.810 Vali Loss: 2.327 Vali Acc: 0.340 Test Loss: 2.327 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339977).  Saving model ...
Epoch: 4 cost time: 1.2247238159179688
Epoch: 4, Steps: 4 | Train Loss: 0.514 Vali Loss: 2.368 Vali Acc: 0.400 Test Loss: 2.368 Test Acc: 0.400
Validation loss decreased (-0.339977 --> -0.399976).  Saving model ...
Epoch: 5 cost time: 1.3885109424591064
Epoch: 5, Steps: 4 | Train Loss: 0.566 Vali Loss: 2.863 Vali Acc: 0.440 Test Loss: 2.863 Test Acc: 0.440
Validation loss decreased (-0.399976 --> -0.439971).  Saving model ...
Epoch: 6 cost time: 1.2986369132995605
Epoch: 6, Steps: 4 | Train Loss: 0.154 Vali Loss: 3.841 Vali Acc: 0.460 Test Loss: 3.841 Test Acc: 0.460
Validation loss decreased (-0.439971 --> -0.459962).  Saving model ...
Epoch: 7 cost time: 1.2898340225219727
Epoch: 7, Steps: 4 | Train Loss: 0.135 Vali Loss: 3.090 Vali Acc: 0.520 Test Loss: 3.090 Test Acc: 0.520
Validation loss decreased (-0.459962 --> -0.519969).  Saving model ...
Epoch: 8 cost time: 1.4333701133728027
Epoch: 8, Steps: 4 | Train Loss: 0.090 Vali Loss: 4.398 Vali Acc: 0.400 Test Loss: 4.398 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.565321683883667
Epoch: 9, Steps: 4 | Train Loss: 0.022 Vali Loss: 5.190 Vali Acc: 0.460 Test Loss: 5.190 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3793134689331055
Epoch: 10, Steps: 4 | Train Loss: 0.070 Vali Loss: 5.247 Vali Acc: 0.440 Test Loss: 5.247 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.317932367324829
Epoch: 11, Steps: 4 | Train Loss: 0.031 Vali Loss: 7.083 Vali Acc: 0.440 Test Loss: 7.083 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4645981788635254
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 5.969 Vali Acc: 0.460 Test Loss: 5.969 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4543213844299316
Epoch: 13, Steps: 4 | Train Loss: 0.102 Vali Loss: 5.782 Vali Acc: 0.400 Test Loss: 5.782 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3841543197631836
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.462 Vali Acc: 0.420 Test Loss: 5.462 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.389143705368042
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.923 Vali Acc: 0.400 Test Loss: 5.923 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2139055728912354
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.647 Vali Acc: 0.420 Test Loss: 6.647 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4468772411346436
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.228 Vali Acc: 0.400 Test Loss: 7.228 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_LightTS_UEA_ftM_sl270_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3703071
model size : 14.14MB
