Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6793835163116455
Epoch: 1, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.982 Vali Acc: 0.184 Test Loss: 1.982 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 0.49934959411621094
Epoch: 2, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.730 Vali Acc: 0.469 Test Loss: 1.730 Test Acc: 0.469
Validation loss decreased (-0.184355 --> -0.468733).  Saving model ...
Epoch: 3 cost time: 0.4806094169616699
Epoch: 3, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.428 Vali Acc: 0.694 Test Loss: 1.428 Test Acc: 0.694
Validation loss decreased (-0.468733 --> -0.693736).  Saving model ...
Epoch: 4 cost time: 0.5533654689788818
Epoch: 4, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.150 Vali Acc: 0.747 Test Loss: 1.150 Test Acc: 0.747
Validation loss decreased (-0.693736 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.5270147323608398
Epoch: 5, Steps: 8 | Train Loss: 0.955 Vali Loss: 0.922 Vali Acc: 0.778 Test Loss: 0.922 Test Acc: 0.778
Validation loss decreased (-0.746863 --> -0.778116).  Saving model ...
Epoch: 6 cost time: 0.5889797210693359
Epoch: 6, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.778116 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5393919944763184
Epoch: 7, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.652 Vali Acc: 0.806 Test Loss: 0.652 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.5188617706298828
Epoch: 8, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.550811767578125
Epoch: 9, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5791213512420654
Epoch: 10, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.5381300449371338
Epoch: 11, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5272719860076904
Epoch: 12, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5051538944244385
Epoch: 13, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5732049942016602
Epoch: 14, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.572058916091919
Epoch: 15, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5497884750366211
Epoch: 16, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5530271530151367
Epoch: 17, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.592 Vali Acc: 0.838 Test Loss: 0.592 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837494).  Saving model ...
Epoch: 18 cost time: 0.5047299861907959
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.653 Vali Acc: 0.819 Test Loss: 0.653 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6270923614501953
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.545534610748291
Epoch: 20, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5816969871520996
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.723 Vali Acc: 0.828 Test Loss: 0.723 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5608813762664795
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.775 Vali Acc: 0.819 Test Loss: 0.775 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4685029983520508
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.811 Vali Acc: 0.819 Test Loss: 0.811 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5546913146972656
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.817 Vali Acc: 0.809 Test Loss: 0.817 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.53196120262146
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.823 Vali Acc: 0.819 Test Loss: 0.823 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4105656147003174
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.853 Vali Acc: 0.806 Test Loss: 0.853 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.40461277961730957
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.869 Vali Acc: 0.803 Test Loss: 0.869 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 267576
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7915828227996826
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.056 Vali Acc: 0.122 Test Loss: 2.056 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.5121860504150391
Epoch: 2, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.791 Vali Acc: 0.450 Test Loss: 1.791 Test Acc: 0.450
Validation loss decreased (-0.121854 --> -0.449982).  Saving model ...
Epoch: 3 cost time: 0.5304477214813232
Epoch: 3, Steps: 8 | Train Loss: 1.639 Vali Loss: 1.468 Vali Acc: 0.684 Test Loss: 1.468 Test Acc: 0.684
Validation loss decreased (-0.449982 --> -0.684360).  Saving model ...
Epoch: 4 cost time: 0.5293846130371094
Epoch: 4, Steps: 8 | Train Loss: 1.301 Vali Loss: 1.173 Vali Acc: 0.747 Test Loss: 1.173 Test Acc: 0.747
Validation loss decreased (-0.684360 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.5144784450531006
Epoch: 5, Steps: 8 | Train Loss: 1.024 Vali Loss: 0.928 Vali Acc: 0.775 Test Loss: 0.928 Test Acc: 0.775
Validation loss decreased (-0.746863 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.5141005516052246
Epoch: 6, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.754 Vali Acc: 0.809 Test Loss: 0.754 Test Acc: 0.809
Validation loss decreased (-0.774991 --> -0.809367).  Saving model ...
Epoch: 7 cost time: 0.5370900630950928
Epoch: 7, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.641 Vali Acc: 0.816 Test Loss: 0.641 Test Acc: 0.816
Validation loss decreased (-0.809367 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 0.5888426303863525
Epoch: 8, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.592 Vali Acc: 0.828 Test Loss: 0.592 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.4998948574066162
Epoch: 9, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.6171989440917969
Epoch: 10, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.5241127014160156
Epoch: 11, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5606412887573242
Epoch: 12, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5874662399291992
Epoch: 13, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5180692672729492
Epoch: 14, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.49613523483276367
Epoch: 15, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6294329166412354
Epoch: 16, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6460700035095215
Epoch: 17, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.571535587310791
Epoch: 18, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.583 Vali Acc: 0.847 Test Loss: 0.583 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846869).  Saving model ...
Epoch: 19 cost time: 0.5564682483673096
Epoch: 19, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.638 Vali Acc: 0.831 Test Loss: 0.638 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4904031753540039
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.695 Vali Acc: 0.831 Test Loss: 0.695 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.49690723419189453
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5972437858581543
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.726 Vali Acc: 0.834 Test Loss: 0.726 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4847855567932129
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.740 Vali Acc: 0.831 Test Loss: 0.740 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5096819400787354
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.785 Vali Acc: 0.828 Test Loss: 0.785 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.46164846420288086
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.825 Vali Acc: 0.822 Test Loss: 0.825 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.48288488388061523
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.870 Vali Acc: 0.828 Test Loss: 0.870 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5004725456237793
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.865 Vali Acc: 0.828 Test Loss: 0.865 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5038619041442871
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.876 Vali Acc: 0.828 Test Loss: 0.876 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 253707
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.917590618133545
Epoch: 1, Steps: 8 | Train Loss: 2.039 Vali Loss: 2.014 Vali Acc: 0.212 Test Loss: 2.014 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.5137722492218018
Epoch: 2, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.762 Vali Acc: 0.466 Test Loss: 1.762 Test Acc: 0.466
Validation loss decreased (-0.212480 --> -0.465607).  Saving model ...
Epoch: 3 cost time: 0.5914161205291748
Epoch: 3, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.448 Vali Acc: 0.713 Test Loss: 1.448 Test Acc: 0.713
Validation loss decreased (-0.465607 --> -0.712486).  Saving model ...
Epoch: 4 cost time: 0.4969754219055176
Epoch: 4, Steps: 8 | Train Loss: 1.237 Vali Loss: 1.156 Vali Acc: 0.759 Test Loss: 1.156 Test Acc: 0.759
Validation loss decreased (-0.712486 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.4365050792694092
Epoch: 5, Steps: 8 | Train Loss: 0.951 Vali Loss: 0.918 Vali Acc: 0.784 Test Loss: 0.918 Test Acc: 0.784
Validation loss decreased (-0.759363 --> -0.784366).  Saving model ...
Epoch: 6 cost time: 0.5558927059173584
Epoch: 6, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.752 Vali Acc: 0.797 Test Loss: 0.752 Test Acc: 0.797
Validation loss decreased (-0.784366 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5364665985107422
Epoch: 7, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
Validation loss decreased (-0.796867 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 0.5423824787139893
Epoch: 8, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.821868 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.45065975189208984
Epoch: 9, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.555 Vali Acc: 0.838 Test Loss: 0.555 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5355608463287354
Epoch: 10, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6227414608001709
Epoch: 11, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6118388175964355
Epoch: 12, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6084592342376709
Epoch: 13, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5540406703948975
Epoch: 14, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6315767765045166
Epoch: 15, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5499813556671143
Epoch: 16, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 0.5564894676208496
Epoch: 17, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6666035652160645
Epoch: 18, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 0.5897412300109863
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.564 Vali Acc: 0.834 Test Loss: 0.564 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5586626529693604
Epoch: 20, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5317771434783936
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.604 Vali Acc: 0.831 Test Loss: 0.604 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6077523231506348
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5693409442901611
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5187411308288574
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5935831069946289
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5712566375732422
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5205392837524414
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.819 Test Loss: 0.702 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.595700740814209
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.825 Test Loss: 0.704 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 247384
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.872690200805664
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 2.093 Vali Acc: 0.166 Test Loss: 2.093 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 0.5464718341827393
Epoch: 2, Steps: 8 | Train Loss: 1.935 Vali Loss: 1.828 Vali Acc: 0.391 Test Loss: 1.828 Test Acc: 0.391
Validation loss decreased (-0.165604 --> -0.390607).  Saving model ...
Epoch: 3 cost time: 0.5080893039703369
Epoch: 3, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.510 Vali Acc: 0.584 Test Loss: 1.510 Test Acc: 0.584
Validation loss decreased (-0.390607 --> -0.584360).  Saving model ...
Epoch: 4 cost time: 0.49428343772888184
Epoch: 4, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.199 Vali Acc: 0.747 Test Loss: 1.199 Test Acc: 0.747
Validation loss decreased (-0.584360 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.5206806659698486
Epoch: 5, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.938 Vali Acc: 0.803 Test Loss: 0.938 Test Acc: 0.803
Validation loss decreased (-0.746863 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 0.5650243759155273
Epoch: 6, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.758 Vali Acc: 0.803 Test Loss: 0.758 Test Acc: 0.803
Validation loss decreased (-0.803116 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.48770976066589355
Epoch: 7, Steps: 8 | Train Loss: 0.612 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.5070440769195557
Epoch: 8, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.599 Vali Acc: 0.806 Test Loss: 0.599 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.4865386486053467
Epoch: 9, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
Validation loss decreased (-0.806244 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.4763832092285156
Epoch: 10, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.537867546081543
Epoch: 11, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 0.5400333404541016
Epoch: 12, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 13 cost time: 0.6106932163238525
Epoch: 13, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 0.5506227016448975
Epoch: 14, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6027042865753174
Epoch: 15, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47413063049316406
Epoch: 16, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5279109477996826
Epoch: 17, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 0.6111006736755371
Epoch: 18, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5199673175811768
Epoch: 19, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.586 Vali Acc: 0.834 Test Loss: 0.586 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5177278518676758
Epoch: 20, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5484347343444824
Epoch: 21, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.624 Vali Acc: 0.834 Test Loss: 0.624 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5267431735992432
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.632 Vali Acc: 0.841 Test Loss: 0.632 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.47987866401672363
Epoch: 23, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.646 Vali Acc: 0.838 Test Loss: 0.646 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5361742973327637
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4519774913787842
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5202059745788574
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.711 Vali Acc: 0.847 Test Loss: 0.711 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846868).  Saving model ...
Epoch: 27 cost time: 0.44913578033447266
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.782 Vali Acc: 0.838 Test Loss: 0.782 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.40770936012268066
Epoch: 28, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.804 Vali Acc: 0.834 Test Loss: 0.804 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5153985023498535
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.747 Vali Acc: 0.856 Test Loss: 0.747 Test Acc: 0.856
Validation loss decreased (-0.846868 --> -0.856243).  Saving model ...
Epoch: 30 cost time: 0.44476890563964844
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.811 Vali Acc: 0.834 Test Loss: 0.811 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.40802574157714844
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.853 Vali Acc: 0.831 Test Loss: 0.853 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4671506881713867
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.814 Vali Acc: 0.847 Test Loss: 0.814 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5042483806610107
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.592780351638794
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.850 Test Loss: 0.835 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.46932005882263184
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.833 Vali Acc: 0.853 Test Loss: 0.833 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5739870071411133
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.850 Test Loss: 0.858 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5386779308319092
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.883 Vali Acc: 0.850 Test Loss: 0.883 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5651071071624756
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.850 Test Loss: 0.878 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5559909343719482
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.850 Test Loss: 0.884 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 242995
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8009817600250244
Epoch: 1, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.903 Vali Acc: 0.291 Test Loss: 1.903 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 0.5359184741973877
Epoch: 2, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.670 Vali Acc: 0.531 Test Loss: 1.670 Test Acc: 0.531
Validation loss decreased (-0.290606 --> -0.531233).  Saving model ...
Epoch: 3 cost time: 0.6263182163238525
Epoch: 3, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.386 Vali Acc: 0.725 Test Loss: 1.386 Test Acc: 0.725
Validation loss decreased (-0.531233 --> -0.724986).  Saving model ...
Epoch: 4 cost time: 0.6131939888000488
Epoch: 4, Steps: 8 | Train Loss: 1.261 Vali Loss: 1.113 Vali Acc: 0.759 Test Loss: 1.113 Test Acc: 0.759
Validation loss decreased (-0.724986 --> -0.759364).  Saving model ...
Epoch: 5 cost time: 0.5123963356018066
Epoch: 5, Steps: 8 | Train Loss: 0.981 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
Validation loss decreased (-0.759364 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.5191140174865723
Epoch: 6, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.749 Vali Acc: 0.803 Test Loss: 0.749 Test Acc: 0.803
Validation loss decreased (-0.774991 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 0.5791401863098145
Epoch: 7, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.661 Vali Acc: 0.806 Test Loss: 0.661 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.6014273166656494
Epoch: 8, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.6193745136260986
Epoch: 9, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5042848587036133
Epoch: 10, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 0.5057773590087891
Epoch: 11, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5316245555877686
Epoch: 12, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.5651729106903076
Epoch: 13, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5272438526153564
Epoch: 14, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.5134444236755371
Epoch: 15, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5202794075012207
Epoch: 16, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.514779806137085
Epoch: 17, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5873119831085205
Epoch: 18, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4790306091308594
Epoch: 19, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.534273624420166
Epoch: 20, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5085303783416748
Epoch: 21, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843744).  Saving model ...
Epoch: 22 cost time: 0.4721415042877197
Epoch: 22, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.49456095695495605
Epoch: 23, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 24 cost time: 0.5315151214599609
Epoch: 24, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.6621789932250977
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4939231872558594
Epoch: 26, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4915657043457031
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.659 Vali Acc: 0.834 Test Loss: 0.659 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5120847225189209
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.693 Vali Acc: 0.834 Test Loss: 0.693 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5673954486846924
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.703 Vali Acc: 0.844 Test Loss: 0.703 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7261900901794434
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.698 Vali Acc: 0.838 Test Loss: 0.698 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5847516059875488
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.719 Vali Acc: 0.838 Test Loss: 0.719 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.4606325626373291
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.741 Vali Acc: 0.834 Test Loss: 0.741 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4759056568145752
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.834 Test Loss: 0.753 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6870067119598389
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.841 Test Loss: 0.763 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 241406
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.906966209411621
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 2.009 Vali Acc: 0.219 Test Loss: 2.009 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.5251896381378174
Epoch: 2, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.760 Vali Acc: 0.509 Test Loss: 1.760 Test Acc: 0.509
Validation loss decreased (-0.218730 --> -0.509357).  Saving model ...
Epoch: 3 cost time: 0.5042507648468018
Epoch: 3, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.448 Vali Acc: 0.722 Test Loss: 1.448 Test Acc: 0.722
Validation loss decreased (-0.509357 --> -0.721861).  Saving model ...
Epoch: 4 cost time: 0.5637505054473877
Epoch: 4, Steps: 8 | Train Loss: 1.318 Vali Loss: 1.152 Vali Acc: 0.791 Test Loss: 1.152 Test Acc: 0.791
Validation loss decreased (-0.721861 --> -0.790613).  Saving model ...
Epoch: 5 cost time: 0.5693793296813965
Epoch: 5, Steps: 8 | Train Loss: 0.996 Vali Loss: 0.912 Vali Acc: 0.806 Test Loss: 0.912 Test Acc: 0.806
Validation loss decreased (-0.790613 --> -0.806241).  Saving model ...
Epoch: 6 cost time: 0.5372533798217773
Epoch: 6, Steps: 8 | Train Loss: 0.802 Vali Loss: 0.753 Vali Acc: 0.816 Test Loss: 0.753 Test Acc: 0.816
Validation loss decreased (-0.806241 --> -0.815617).  Saving model ...
Epoch: 7 cost time: 0.5310142040252686
Epoch: 7, Steps: 8 | Train Loss: 0.656 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
Validation loss decreased (-0.815617 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 0.6008603572845459
Epoch: 8, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.5859966278076172
Epoch: 9, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.5778646469116211
Epoch: 10, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.604388952255249
Epoch: 11, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5732908248901367
Epoch: 12, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5962479114532471
Epoch: 13, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 0.5977747440338135
Epoch: 14, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5202252864837646
Epoch: 15, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5483431816101074
Epoch: 16, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 17 cost time: 0.574777364730835
Epoch: 17, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6215240955352783
Epoch: 18, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6388287544250488
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.576 Vali Acc: 0.834 Test Loss: 0.576 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7310354709625244
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.609 Vali Acc: 0.834 Test Loss: 0.609 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6575701236724854
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.610 Vali Acc: 0.831 Test Loss: 0.610 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6502547264099121
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6202058792114258
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.658 Vali Acc: 0.834 Test Loss: 0.658 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.610670804977417
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7233490943908691
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.702 Vali Acc: 0.834 Test Loss: 0.702 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6015536785125732
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.725 Vali Acc: 0.841 Test Loss: 0.725 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 238443
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8613038063049316
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.054 Vali Acc: 0.169 Test Loss: 2.054 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 0.5995583534240723
Epoch: 2, Steps: 8 | Train Loss: 1.956 Vali Loss: 1.798 Vali Acc: 0.369 Test Loss: 1.798 Test Acc: 0.369
Validation loss decreased (-0.168729 --> -0.368732).  Saving model ...
Epoch: 3 cost time: 0.5657033920288086
Epoch: 3, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.482 Vali Acc: 0.684 Test Loss: 1.482 Test Acc: 0.684
Validation loss decreased (-0.368732 --> -0.684360).  Saving model ...
Epoch: 4 cost time: 0.47370195388793945
Epoch: 4, Steps: 8 | Train Loss: 1.327 Vali Loss: 1.193 Vali Acc: 0.759 Test Loss: 1.193 Test Acc: 0.759
Validation loss decreased (-0.684360 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.6444902420043945
Epoch: 5, Steps: 8 | Train Loss: 1.021 Vali Loss: 0.950 Vali Acc: 0.781 Test Loss: 0.950 Test Acc: 0.781
Validation loss decreased (-0.759363 --> -0.781241).  Saving model ...
Epoch: 6 cost time: 0.5576317310333252
Epoch: 6, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.770 Vali Acc: 0.806 Test Loss: 0.770 Test Acc: 0.806
Validation loss decreased (-0.781241 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.5500392913818359
Epoch: 7, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
Validation loss decreased (-0.806242 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 0.5532667636871338
Epoch: 8, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.824994 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 0.5243918895721436
Epoch: 9, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.5839364528656006
Epoch: 10, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.5504441261291504
Epoch: 11, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4880397319793701
Epoch: 12, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5223698616027832
Epoch: 13, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 0.5537421703338623
Epoch: 14, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.47641777992248535
Epoch: 15, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.5500953197479248
Epoch: 16, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5089321136474609
Epoch: 17, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5185196399688721
Epoch: 18, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 19 cost time: 0.6465435028076172
Epoch: 19, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6029684543609619
Epoch: 20, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5729348659515381
Epoch: 21, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5526542663574219
Epoch: 22, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5040395259857178
Epoch: 23, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.533149242401123
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.628 Vali Acc: 0.866 Test Loss: 0.628 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 25 cost time: 0.5243344306945801
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5423309803009033
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.681 Vali Acc: 0.841 Test Loss: 0.681 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5074477195739746
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5304775238037109
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.739 Vali Acc: 0.847 Test Loss: 0.739 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7069573402404785
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.757 Vali Acc: 0.847 Test Loss: 0.757 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.49544405937194824
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.779 Vali Acc: 0.847 Test Loss: 0.779 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5960330963134766
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.853 Test Loss: 0.794 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6471943855285645
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.818 Vali Acc: 0.850 Test Loss: 0.818 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6950316429138184
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.847 Test Loss: 0.852 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5800497531890869
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.850 Test Loss: 0.866 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 238772
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9896740913391113
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.027 Vali Acc: 0.169 Test Loss: 2.027 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 0.672236442565918
Epoch: 2, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.771 Vali Acc: 0.400 Test Loss: 1.771 Test Acc: 0.400
Validation loss decreased (-0.168730 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 0.507843017578125
Epoch: 3, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.465 Vali Acc: 0.691 Test Loss: 1.465 Test Acc: 0.691
Validation loss decreased (-0.399982 --> -0.690610).  Saving model ...
Epoch: 4 cost time: 0.4788525104522705
Epoch: 4, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.180 Vali Acc: 0.753 Test Loss: 1.180 Test Acc: 0.753
Validation loss decreased (-0.690610 --> -0.753113).  Saving model ...
Epoch: 5 cost time: 0.5286359786987305
Epoch: 5, Steps: 8 | Train Loss: 1.020 Vali Loss: 0.947 Vali Acc: 0.775 Test Loss: 0.947 Test Acc: 0.775
Validation loss decreased (-0.753113 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.5061781406402588
Epoch: 6, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.776 Vali Acc: 0.803 Test Loss: 0.776 Test Acc: 0.803
Validation loss decreased (-0.774991 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.542076826095581
Epoch: 7, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
Validation loss decreased (-0.803117 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 0.5126852989196777
Epoch: 8, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
Validation loss decreased (-0.821868 --> -0.837494).  Saving model ...
Epoch: 9 cost time: 0.5249021053314209
Epoch: 9, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6815223693847656
Epoch: 10, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6924920082092285
Epoch: 11, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.7168455123901367
Epoch: 12, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.5680248737335205
Epoch: 13, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.577141284942627
Epoch: 14, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 0.596867561340332
Epoch: 15, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5556802749633789
Epoch: 16, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.498 Vali Acc: 0.866 Test Loss: 0.498 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 17 cost time: 0.6616787910461426
Epoch: 17, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 18 cost time: 0.6034445762634277
Epoch: 18, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 19 cost time: 0.6574928760528564
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5667629241943359
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 0.6281313896179199
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 22 cost time: 0.6977729797363281
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.556 Vali Acc: 0.891 Test Loss: 0.556 Test Acc: 0.891
Validation loss decreased (-0.878120 --> -0.890619).  Saving model ...
Epoch: 23 cost time: 0.6339099407196045
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5614414215087891
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.884 Test Loss: 0.596 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6004245281219482
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.610 Vali Acc: 0.887 Test Loss: 0.610 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6715025901794434
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.630 Vali Acc: 0.891 Test Loss: 0.630 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5790128707885742
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.884 Test Loss: 0.655 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6952502727508545
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.887 Test Loss: 0.655 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.617119550704956
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.887 Test Loss: 0.666 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6900296211242676
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.884 Test Loss: 0.693 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5388071537017822
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.887 Test Loss: 0.696 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.561091423034668
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.891 Test Loss: 0.710 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.890625
model parameter : 235955
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.885124683380127
Epoch: 1, Steps: 8 | Train Loss: 2.093 Vali Loss: 2.004 Vali Acc: 0.206 Test Loss: 2.004 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 0.5539443492889404
Epoch: 2, Steps: 8 | Train Loss: 1.918 Vali Loss: 1.756 Vali Acc: 0.438 Test Loss: 1.756 Test Acc: 0.438
Validation loss decreased (-0.206230 --> -0.437482).  Saving model ...
Epoch: 3 cost time: 0.5909268856048584
Epoch: 3, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.454 Vali Acc: 0.697 Test Loss: 1.454 Test Acc: 0.697
Validation loss decreased (-0.437482 --> -0.696860).  Saving model ...
Epoch: 4 cost time: 0.5659434795379639
Epoch: 4, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.170 Vali Acc: 0.759 Test Loss: 1.170 Test Acc: 0.759
Validation loss decreased (-0.696860 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.5333142280578613
Epoch: 5, Steps: 8 | Train Loss: 0.990 Vali Loss: 0.945 Vali Acc: 0.784 Test Loss: 0.945 Test Acc: 0.784
Validation loss decreased (-0.759363 --> -0.784366).  Saving model ...
Epoch: 6 cost time: 0.623321533203125
Epoch: 6, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.765 Vali Acc: 0.797 Test Loss: 0.765 Test Acc: 0.797
Validation loss decreased (-0.784366 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5024161338806152
Epoch: 7, Steps: 8 | Train Loss: 0.651 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.796867 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 0.5528643131256104
Epoch: 8, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4730405807495117
Epoch: 9, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.5991249084472656
Epoch: 10, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.6237316131591797
Epoch: 11, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.5266556739807129
Epoch: 12, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.4556262493133545
Epoch: 13, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5766189098358154
Epoch: 14, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6485166549682617
Epoch: 15, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5565266609191895
Epoch: 16, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.576 Vali Acc: 0.838 Test Loss: 0.576 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6216142177581787
Epoch: 17, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.624 Vali Acc: 0.838 Test Loss: 0.624 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.532172679901123
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.639 Vali Acc: 0.831 Test Loss: 0.639 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6252975463867188
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.667 Vali Acc: 0.841 Test Loss: 0.667 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7326903343200684
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.701 Vali Acc: 0.834 Test Loss: 0.701 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.820587158203125
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.743 Vali Acc: 0.831 Test Loss: 0.743 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6222939491271973
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.737 Vali Acc: 0.831 Test Loss: 0.737 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 236804
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7288119792938232
Epoch: 1, Steps: 8 | Train Loss: 1.884 Vali Loss: 1.865 Vali Acc: 0.322 Test Loss: 1.865 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 0.5781495571136475
Epoch: 2, Steps: 8 | Train Loss: 1.703 Vali Loss: 1.631 Vali Acc: 0.516 Test Loss: 1.631 Test Acc: 0.516
Validation loss decreased (-0.321856 --> -0.515609).  Saving model ...
Epoch: 3 cost time: 0.5430259704589844
Epoch: 3, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.354 Vali Acc: 0.684 Test Loss: 1.354 Test Acc: 0.684
Validation loss decreased (-0.515609 --> -0.684361).  Saving model ...
Epoch: 4 cost time: 0.5654160976409912
Epoch: 4, Steps: 8 | Train Loss: 1.172 Vali Loss: 1.092 Vali Acc: 0.750 Test Loss: 1.092 Test Acc: 0.750
Validation loss decreased (-0.684361 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 0.5275838375091553
Epoch: 5, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.889 Vali Acc: 0.769 Test Loss: 0.889 Test Acc: 0.769
Validation loss decreased (-0.749989 --> -0.768741).  Saving model ...
Epoch: 6 cost time: 0.5433039665222168
Epoch: 6, Steps: 8 | Train Loss: 0.739 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
Validation loss decreased (-0.768741 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.7500975131988525
Epoch: 7, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
Validation loss decreased (-0.774992 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.6231977939605713
Epoch: 8, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
Validation loss decreased (-0.803118 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.5883181095123291
Epoch: 9, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.824994 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.5830862522125244
Epoch: 10, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5052683353424072
Epoch: 11, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5955219268798828
Epoch: 12, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6707496643066406
Epoch: 13, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6325514316558838
Epoch: 14, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5936965942382812
Epoch: 15, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.565 Vali Acc: 0.853 Test Loss: 0.565 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5823163986206055
Epoch: 16, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5535581111907959
Epoch: 17, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.621 Vali Acc: 0.831 Test Loss: 0.621 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5483531951904297
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.664 Vali Acc: 0.838 Test Loss: 0.664 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5386815071105957
Epoch: 19, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.674 Vali Acc: 0.831 Test Loss: 0.674 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 235767
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7074358463287354
Epoch: 1, Steps: 8 | Train Loss: 2.079 Vali Loss: 2.012 Vali Acc: 0.194 Test Loss: 2.012 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.6010751724243164
Epoch: 2, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.769 Vali Acc: 0.459 Test Loss: 1.769 Test Acc: 0.459
Validation loss decreased (-0.193730 --> -0.459357).  Saving model ...
Epoch: 3 cost time: 0.6499125957489014
Epoch: 3, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.462 Vali Acc: 0.697 Test Loss: 1.462 Test Acc: 0.697
Validation loss decreased (-0.459357 --> -0.696860).  Saving model ...
Epoch: 4 cost time: 0.768669843673706
Epoch: 4, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.182 Vali Acc: 0.744 Test Loss: 1.182 Test Acc: 0.744
Validation loss decreased (-0.696860 --> -0.743738).  Saving model ...
Epoch: 5 cost time: 0.5802810192108154
Epoch: 5, Steps: 8 | Train Loss: 1.046 Vali Loss: 0.950 Vali Acc: 0.775 Test Loss: 0.950 Test Acc: 0.775
Validation loss decreased (-0.743738 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.5697000026702881
Epoch: 6, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.792 Vali Acc: 0.803 Test Loss: 0.792 Test Acc: 0.803
Validation loss decreased (-0.774990 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.5316867828369141
Epoch: 7, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.683 Vali Acc: 0.816 Test Loss: 0.683 Test Acc: 0.816
Validation loss decreased (-0.803117 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 0.566650390625
Epoch: 8, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.5516517162322998
Epoch: 9, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.636906623840332
Epoch: 10, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.834369 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.57857346534729
Epoch: 11, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5801899433135986
Epoch: 12, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6452603340148926
Epoch: 13, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.532724142074585
Epoch: 14, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7103416919708252
Epoch: 15, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6648769378662109
Epoch: 16, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5377728939056396
Epoch: 17, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4293510913848877
Epoch: 18, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5258548259735107
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6625714302062988
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.582 Vali Acc: 0.831 Test Loss: 0.582 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 236880
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9897315502166748
Epoch: 1, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.858 Vali Acc: 0.366 Test Loss: 1.858 Test Acc: 0.366
Validation loss decreased (inf --> -0.365606).  Saving model ...
Epoch: 2 cost time: 0.5343389511108398
Epoch: 2, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.621 Vali Acc: 0.578 Test Loss: 1.621 Test Acc: 0.578
Validation loss decreased (-0.365606 --> -0.578109).  Saving model ...
Epoch: 3 cost time: 0.6957440376281738
Epoch: 3, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.331 Vali Acc: 0.703 Test Loss: 1.331 Test Acc: 0.703
Validation loss decreased (-0.578109 --> -0.703112).  Saving model ...
Epoch: 4 cost time: 0.6640229225158691
Epoch: 4, Steps: 8 | Train Loss: 1.181 Vali Loss: 1.068 Vali Acc: 0.769 Test Loss: 1.068 Test Acc: 0.769
Validation loss decreased (-0.703112 --> -0.768739).  Saving model ...
Epoch: 5 cost time: 0.6215023994445801
Epoch: 5, Steps: 8 | Train Loss: 0.941 Vali Loss: 0.849 Vali Acc: 0.806 Test Loss: 0.849 Test Acc: 0.806
Validation loss decreased (-0.768739 --> -0.806242).  Saving model ...
Epoch: 6 cost time: 0.7702369689941406
Epoch: 6, Steps: 8 | Train Loss: 0.740 Vali Loss: 0.713 Vali Acc: 0.816 Test Loss: 0.713 Test Acc: 0.816
Validation loss decreased (-0.806242 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 0.6503324508666992
Epoch: 7, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.617 Vali Acc: 0.828 Test Loss: 0.617 Test Acc: 0.828
Validation loss decreased (-0.815618 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.6255085468292236
Epoch: 8, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.6345505714416504
Epoch: 9, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.566317081451416
Epoch: 10, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 11 cost time: 0.6455931663513184
Epoch: 11, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 12 cost time: 0.6393885612487793
Epoch: 12, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 13 cost time: 0.7260289192199707
Epoch: 13, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878120).  Saving model ...
Epoch: 14 cost time: 0.5637376308441162
Epoch: 14, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5470585823059082
Epoch: 15, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5592193603515625
Epoch: 16, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.521 Vali Acc: 0.869 Test Loss: 0.521 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5860805511474609
Epoch: 17, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6630868911743164
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5769424438476562
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6219754219055176
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.634148120880127
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.626 Vali Acc: 0.869 Test Loss: 0.626 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.606752872467041
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.660 Vali Acc: 0.866 Test Loss: 0.660 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7135658264160156
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.674 Vali Acc: 0.869 Test Loss: 0.674 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 236737
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1373391151428223
Epoch: 1, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.950 Vali Acc: 0.234 Test Loss: 1.950 Test Acc: 0.234
Validation loss decreased (inf --> -0.234356).  Saving model ...
Epoch: 2 cost time: 0.6133782863616943
Epoch: 2, Steps: 8 | Train Loss: 1.828 Vali Loss: 1.711 Vali Acc: 0.441 Test Loss: 1.711 Test Acc: 0.441
Validation loss decreased (-0.234356 --> -0.440608).  Saving model ...
Epoch: 3 cost time: 0.574577808380127
Epoch: 3, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.422 Vali Acc: 0.675 Test Loss: 1.422 Test Acc: 0.675
Validation loss decreased (-0.440608 --> -0.674986).  Saving model ...
Epoch: 4 cost time: 0.603895902633667
Epoch: 4, Steps: 8 | Train Loss: 1.263 Vali Loss: 1.160 Vali Acc: 0.738 Test Loss: 1.160 Test Acc: 0.738
Validation loss decreased (-0.674986 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.5628507137298584
Epoch: 5, Steps: 8 | Train Loss: 0.983 Vali Loss: 0.940 Vali Acc: 0.762 Test Loss: 0.940 Test Acc: 0.762
Validation loss decreased (-0.737488 --> -0.762491).  Saving model ...
Epoch: 6 cost time: 0.5123186111450195
Epoch: 6, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.782 Vali Acc: 0.778 Test Loss: 0.782 Test Acc: 0.778
Validation loss decreased (-0.762491 --> -0.778117).  Saving model ...
Epoch: 7 cost time: 0.6536149978637695
Epoch: 7, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
Validation loss decreased (-0.778117 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5587825775146484
Epoch: 8, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.7972409725189209
Epoch: 9, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.5865375995635986
Epoch: 10, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.7206928730010986
Epoch: 11, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.5912954807281494
Epoch: 12, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 0.6230735778808594
Epoch: 13, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7980031967163086
Epoch: 14, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7080981731414795
Epoch: 15, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7412784099578857
Epoch: 16, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 17 cost time: 0.537832498550415
Epoch: 17, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6355953216552734
Epoch: 18, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7883040904998779
Epoch: 19, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 0.6273036003112793
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6712429523468018
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.544 Vali Acc: 0.866 Test Loss: 0.544 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 22 cost time: 0.761021614074707
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.570 Vali Acc: 0.853 Test Loss: 0.570 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6159961223602295
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.568 Vali Acc: 0.869 Test Loss: 0.568 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868744).  Saving model ...
Epoch: 24 cost time: 0.5805730819702148
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.868744 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.7286651134490967
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.866 Test Loss: 0.584 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6876747608184814
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.869 Test Loss: 0.592 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6845169067382812
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.602 Vali Acc: 0.875 Test Loss: 0.602 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6807758808135986
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.859 Test Loss: 0.643 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6553592681884766
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7530438899993896
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.881 Test Loss: 0.636 Test Acc: 0.881
Validation loss decreased (-0.874994 --> -0.881244).  Saving model ...
Epoch: 31 cost time: 0.5444297790527344
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.878 Test Loss: 0.644 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5959014892578125
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.872 Test Loss: 0.669 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6974976062774658
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.677 Vali Acc: 0.878 Test Loss: 0.677 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6883101463317871
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.684 Vali Acc: 0.881 Test Loss: 0.684 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.682837724685669
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.881 Test Loss: 0.687 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.660376787185669
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5715806484222412
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.878 Test Loss: 0.708 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5885312557220459
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.884 Test Loss: 0.715 Test Acc: 0.884
Validation loss decreased (-0.881244 --> -0.884368).  Saving model ...
Epoch: 39 cost time: 0.6895709037780762
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.884 Test Loss: 0.726 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8211290836334229
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.881 Test Loss: 0.732 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6707212924957275
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.881 Test Loss: 0.741 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.536311149597168
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.878 Test Loss: 0.748 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5443251132965088
Epoch: 43, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.881 Test Loss: 0.756 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5768768787384033
Epoch: 44, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.878 Test Loss: 0.760 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.622962474822998
Epoch: 45, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.884 Test Loss: 0.765 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5804464817047119
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.881 Test Loss: 0.775 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6450886726379395
Epoch: 47, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.884 Test Loss: 0.783 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6508557796478271
Epoch: 48, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.884 Test Loss: 0.785 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 235338
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0690643787384033
Epoch: 1, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.874 Vali Acc: 0.362 Test Loss: 1.874 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 0.752589225769043
Epoch: 2, Steps: 8 | Train Loss: 1.756 Vali Loss: 1.649 Vali Acc: 0.559 Test Loss: 1.649 Test Acc: 0.559
Validation loss decreased (-0.362481 --> -0.559359).  Saving model ...
Epoch: 3 cost time: 0.6484966278076172
Epoch: 3, Steps: 8 | Train Loss: 1.473 Vali Loss: 1.373 Vali Acc: 0.725 Test Loss: 1.373 Test Acc: 0.725
Validation loss decreased (-0.559359 --> -0.724986).  Saving model ...
Epoch: 4 cost time: 0.548821210861206
Epoch: 4, Steps: 8 | Train Loss: 1.188 Vali Loss: 1.103 Vali Acc: 0.775 Test Loss: 1.103 Test Acc: 0.775
Validation loss decreased (-0.724986 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 0.6307895183563232
Epoch: 5, Steps: 8 | Train Loss: 0.941 Vali Loss: 0.898 Vali Acc: 0.784 Test Loss: 0.898 Test Acc: 0.784
Validation loss decreased (-0.774989 --> -0.784366).  Saving model ...
Epoch: 6 cost time: 0.7318179607391357
Epoch: 6, Steps: 8 | Train Loss: 0.749 Vali Loss: 0.763 Vali Acc: 0.791 Test Loss: 0.763 Test Acc: 0.791
Validation loss decreased (-0.784366 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.7877805233001709
Epoch: 7, Steps: 8 | Train Loss: 0.626 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
Validation loss decreased (-0.790617 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.7028605937957764
Epoch: 8, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.607 Vali Acc: 0.809 Test Loss: 0.607 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.6945562362670898
Epoch: 9, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.564284086227417
Epoch: 10, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 0.6258976459503174
Epoch: 11, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.7128829956054688
Epoch: 12, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.9077572822570801
Epoch: 13, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6905641555786133
Epoch: 14, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6825418472290039
Epoch: 15, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6114077568054199
Epoch: 16, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 0.6631312370300293
Epoch: 17, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 0.6251504421234131
Epoch: 18, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7161080837249756
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5781614780426025
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.599 Vali Acc: 0.853 Test Loss: 0.599 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 21 cost time: 0.533735990524292
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.598 Vali Acc: 0.866 Test Loss: 0.598 Test Acc: 0.866
Validation loss decreased (-0.853119 --> -0.865619).  Saving model ...
Epoch: 22 cost time: 0.5686736106872559
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
Validation loss decreased (-0.865619 --> -0.871869).  Saving model ...
Epoch: 23 cost time: 0.590385913848877
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.635 Vali Acc: 0.875 Test Loss: 0.635 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.6315503120422363
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.658 Vali Acc: 0.878 Test Loss: 0.658 Test Acc: 0.878
Validation loss decreased (-0.874994 --> -0.878118).  Saving model ...
Epoch: 25 cost time: 0.5344557762145996
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.560868501663208
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.692 Vali Acc: 0.863 Test Loss: 0.692 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5312297344207764
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.713 Vali Acc: 0.869 Test Loss: 0.713 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6318235397338867
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.875 Test Loss: 0.719 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5990846157073975
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.875 Test Loss: 0.721 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6501734256744385
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.875 Test Loss: 0.726 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5958425998687744
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.872 Test Loss: 0.740 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.677936315536499
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.878 Test Loss: 0.754 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5924994945526123
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.878 Test Loss: 0.761 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7381491661071777
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 232683
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1807868480682373
Epoch: 1, Steps: 8 | Train Loss: 2.053 Vali Loss: 1.998 Vali Acc: 0.212 Test Loss: 1.998 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.663701057434082
Epoch: 2, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.747 Vali Acc: 0.438 Test Loss: 1.747 Test Acc: 0.438
Validation loss decreased (-0.212480 --> -0.437483).  Saving model ...
Epoch: 3 cost time: 0.5874016284942627
Epoch: 3, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.448 Vali Acc: 0.706 Test Loss: 1.448 Test Acc: 0.706
Validation loss decreased (-0.437483 --> -0.706236).  Saving model ...
Epoch: 4 cost time: 0.6480281352996826
Epoch: 4, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.160 Vali Acc: 0.747 Test Loss: 1.160 Test Acc: 0.747
Validation loss decreased (-0.706236 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.6291115283966064
Epoch: 5, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.933 Vali Acc: 0.791 Test Loss: 0.933 Test Acc: 0.791
Validation loss decreased (-0.746863 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 0.5549042224884033
Epoch: 6, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
Validation loss decreased (-0.790616 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.8348181247711182
Epoch: 7, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.667 Vali Acc: 0.806 Test Loss: 0.667 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.6193737983703613
Epoch: 8, Steps: 8 | Train Loss: 0.518 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.7323639392852783
Epoch: 9, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.6152243614196777
Epoch: 10, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.5180003643035889
Epoch: 11, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.6927464008331299
Epoch: 12, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7100539207458496
Epoch: 13, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.7023985385894775
Epoch: 14, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5735211372375488
Epoch: 15, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5020687580108643
Epoch: 16, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.602 Vali Acc: 0.834 Test Loss: 0.602 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7146117687225342
Epoch: 17, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.598 Vali Acc: 0.831 Test Loss: 0.598 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.735753059387207
Epoch: 18, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6269772052764893
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.631 Vali Acc: 0.834 Test Loss: 0.631 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6007053852081299
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.651 Vali Acc: 0.847 Test Loss: 0.651 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846868).  Saving model ...
Epoch: 21 cost time: 0.5390431880950928
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.673 Vali Acc: 0.841 Test Loss: 0.673 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5441274642944336
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6607656478881836
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.722 Vali Acc: 0.853 Test Loss: 0.722 Test Acc: 0.853
Validation loss decreased (-0.846868 --> -0.853118).  Saving model ...
Epoch: 24 cost time: 0.5911362171173096
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.755 Vali Acc: 0.844 Test Loss: 0.755 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7489755153656006
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.853 Test Loss: 0.761 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5573937892913818
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.793 Vali Acc: 0.847 Test Loss: 0.793 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6309828758239746
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.830 Vali Acc: 0.853 Test Loss: 0.830 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7154262065887451
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.859 Vali Acc: 0.853 Test Loss: 0.859 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7629642486572266
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.874 Vali Acc: 0.859 Test Loss: 0.874 Test Acc: 0.859
Validation loss decreased (-0.853118 --> -0.859366).  Saving model ...
Epoch: 30 cost time: 0.8371577262878418
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.877 Vali Acc: 0.853 Test Loss: 0.877 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7683994770050049
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.901 Vali Acc: 0.850 Test Loss: 0.901 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6107301712036133
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.847 Test Loss: 0.934 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6651105880737305
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.853 Test Loss: 0.949 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8557140827178955
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.850 Test Loss: 0.959 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.565138578414917
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.850 Test Loss: 0.969 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6276671886444092
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.853 Test Loss: 0.989 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5575408935546875
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.853 Test Loss: 0.999 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6843469142913818
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.850 Test Loss: 1.011 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5832812786102295
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.853 Test Loss: 1.022 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 234068
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9740159511566162
Epoch: 1, Steps: 8 | Train Loss: 2.103 Vali Loss: 2.073 Vali Acc: 0.122 Test Loss: 2.073 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 0.6061687469482422
Epoch: 2, Steps: 8 | Train Loss: 1.935 Vali Loss: 1.822 Vali Acc: 0.359 Test Loss: 1.822 Test Acc: 0.359
Validation loss decreased (-0.121854 --> -0.359357).  Saving model ...
Epoch: 3 cost time: 0.6120645999908447
Epoch: 3, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.506 Vali Acc: 0.634 Test Loss: 1.506 Test Acc: 0.634
Validation loss decreased (-0.359357 --> -0.634360).  Saving model ...
Epoch: 4 cost time: 0.6897072792053223
Epoch: 4, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.214 Vali Acc: 0.738 Test Loss: 1.214 Test Acc: 0.738
Validation loss decreased (-0.634360 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.6345033645629883
Epoch: 5, Steps: 8 | Train Loss: 0.997 Vali Loss: 0.965 Vali Acc: 0.778 Test Loss: 0.965 Test Acc: 0.778
Validation loss decreased (-0.737488 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.6297347545623779
Epoch: 6, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.780 Vali Acc: 0.791 Test Loss: 0.780 Test Acc: 0.791
Validation loss decreased (-0.778115 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.5384690761566162
Epoch: 7, Steps: 8 | Train Loss: 0.612 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.790617 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.6195311546325684
Epoch: 8, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.6513762474060059
Epoch: 9, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.6649355888366699
Epoch: 10, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.577284574508667
Epoch: 11, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.658172607421875
Epoch: 12, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.666447639465332
Epoch: 13, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7825179100036621
Epoch: 14, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.570 Vali Acc: 0.831 Test Loss: 0.570 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 0.6514694690704346
Epoch: 15, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.744879961013794
Epoch: 16, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6735281944274902
Epoch: 17, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.674328088760376
Epoch: 18, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.696 Vali Acc: 0.819 Test Loss: 0.696 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7147760391235352
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6572461128234863
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.685 Vali Acc: 0.831 Test Loss: 0.685 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6700112819671631
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.605379581451416
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7295734882354736
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.822 Vali Acc: 0.822 Test Loss: 0.822 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5216858386993408
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 234827
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.215334177017212
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 2.019 Vali Acc: 0.191 Test Loss: 2.019 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 0.5583007335662842
Epoch: 2, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.763 Vali Acc: 0.447 Test Loss: 1.763 Test Acc: 0.447
Validation loss decreased (-0.190605 --> -0.446857).  Saving model ...
Epoch: 3 cost time: 0.7563769817352295
Epoch: 3, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.452 Vali Acc: 0.653 Test Loss: 1.452 Test Acc: 0.653
Validation loss decreased (-0.446857 --> -0.653110).  Saving model ...
Epoch: 4 cost time: 0.563194990158081
Epoch: 4, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.154 Vali Acc: 0.725 Test Loss: 1.154 Test Acc: 0.725
Validation loss decreased (-0.653110 --> -0.724988).  Saving model ...
Epoch: 5 cost time: 0.6803915500640869
Epoch: 5, Steps: 8 | Train Loss: 0.972 Vali Loss: 0.925 Vali Acc: 0.756 Test Loss: 0.925 Test Acc: 0.756
Validation loss decreased (-0.724988 --> -0.756241).  Saving model ...
Epoch: 6 cost time: 0.6959559917449951
Epoch: 6, Steps: 8 | Train Loss: 0.767 Vali Loss: 0.770 Vali Acc: 0.781 Test Loss: 0.770 Test Acc: 0.781
Validation loss decreased (-0.756241 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.7144286632537842
Epoch: 7, Steps: 8 | Train Loss: 0.605 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.654714822769165
Epoch: 8, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.6689448356628418
Epoch: 9, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.6080203056335449
Epoch: 10, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.6032459735870361
Epoch: 11, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.5858826637268066
Epoch: 12, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.6359074115753174
Epoch: 13, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5917849540710449
Epoch: 14, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6569645404815674
Epoch: 15, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.651 Vali Acc: 0.838 Test Loss: 0.651 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6149213314056396
Epoch: 16, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.700 Vali Acc: 0.831 Test Loss: 0.700 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5945401191711426
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.683 Vali Acc: 0.841 Test Loss: 0.683 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5554282665252686
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.694 Vali Acc: 0.841 Test Loss: 0.694 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8506007194519043
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.767 Vali Acc: 0.834 Test Loss: 0.767 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8305001258850098
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.723 Vali Acc: 0.838 Test Loss: 0.723 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6585123538970947
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5682013034820557
Epoch: 22, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 234960
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.117509603500366
Epoch: 1, Steps: 8 | Train Loss: 2.081 Vali Loss: 1.999 Vali Acc: 0.253 Test Loss: 1.999 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 0.7105677127838135
Epoch: 2, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.753 Vali Acc: 0.459 Test Loss: 1.753 Test Acc: 0.459
Validation loss decreased (-0.253105 --> -0.459357).  Saving model ...
Epoch: 3 cost time: 0.6991536617279053
Epoch: 3, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.450 Vali Acc: 0.634 Test Loss: 1.450 Test Acc: 0.634
Validation loss decreased (-0.459357 --> -0.634360).  Saving model ...
Epoch: 4 cost time: 0.7002933025360107
Epoch: 4, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.166 Vali Acc: 0.725 Test Loss: 1.166 Test Acc: 0.725
Validation loss decreased (-0.634360 --> -0.724988).  Saving model ...
Epoch: 5 cost time: 0.7541344165802002
Epoch: 5, Steps: 8 | Train Loss: 1.019 Vali Loss: 0.930 Vali Acc: 0.769 Test Loss: 0.930 Test Acc: 0.769
Validation loss decreased (-0.724988 --> -0.768741).  Saving model ...
Epoch: 6 cost time: 0.7583129405975342
Epoch: 6, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.773 Vali Acc: 0.791 Test Loss: 0.773 Test Acc: 0.791
Validation loss decreased (-0.768741 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.8055374622344971
Epoch: 7, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
Validation loss decreased (-0.790617 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.7766308784484863
Epoch: 8, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.803118 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.7170805931091309
Epoch: 9, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.6025667190551758
Epoch: 10, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
Validation loss decreased (-0.818744 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.7089459896087646
Epoch: 11, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7441270351409912
Epoch: 12, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.7408413887023926
Epoch: 13, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.564683198928833
Epoch: 14, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6366653442382812
Epoch: 15, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 0.5864756107330322
Epoch: 16, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 17 cost time: 0.9190876483917236
Epoch: 17, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7530958652496338
Epoch: 18, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.582 Vali Acc: 0.831 Test Loss: 0.582 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6007118225097656
Epoch: 19, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5436005592346191
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6501641273498535
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.648 Vali Acc: 0.834 Test Loss: 0.648 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7074332237243652
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843743).  Saving model ...
Epoch: 23 cost time: 0.6527924537658691
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.723 Vali Acc: 0.831 Test Loss: 0.723 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6309800148010254
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.731 Vali Acc: 0.838 Test Loss: 0.731 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5441441535949707
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.747 Vali Acc: 0.834 Test Loss: 0.747 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5967283248901367
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.773 Vali Acc: 0.831 Test Loss: 0.773 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6856491565704346
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.806 Vali Acc: 0.831 Test Loss: 0.806 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7633836269378662
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.834 Test Loss: 0.804 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5931675434112549
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.838 Test Loss: 0.804 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.546597957611084
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.817 Vali Acc: 0.838 Test Loss: 0.817 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6824953556060791
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.838 Test Loss: 0.832 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6427328586578369
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.857 Vali Acc: 0.838 Test Loss: 0.857 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 234467
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4315989017486572
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 2.007 Vali Acc: 0.197 Test Loss: 2.007 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 0.6509263515472412
Epoch: 2, Steps: 8 | Train Loss: 1.915 Vali Loss: 1.763 Vali Acc: 0.425 Test Loss: 1.763 Test Acc: 0.425
Validation loss decreased (-0.196855 --> -0.424982).  Saving model ...
Epoch: 3 cost time: 0.7430548667907715
Epoch: 3, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.467 Vali Acc: 0.616 Test Loss: 1.467 Test Acc: 0.616
Validation loss decreased (-0.424982 --> -0.615610).  Saving model ...
Epoch: 4 cost time: 0.7858586311340332
Epoch: 4, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.184 Vali Acc: 0.741 Test Loss: 1.184 Test Acc: 0.741
Validation loss decreased (-0.615610 --> -0.740613).  Saving model ...
Epoch: 5 cost time: 0.721956729888916
Epoch: 5, Steps: 8 | Train Loss: 1.046 Vali Loss: 0.960 Vali Acc: 0.778 Test Loss: 0.960 Test Acc: 0.778
Validation loss decreased (-0.740613 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.7864353656768799
Epoch: 6, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.794 Vali Acc: 0.784 Test Loss: 0.794 Test Acc: 0.784
Validation loss decreased (-0.778115 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.7347056865692139
Epoch: 7, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.5603179931640625
Epoch: 8, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
Validation loss decreased (-0.793743 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.6786985397338867
Epoch: 9, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.9304852485656738
Epoch: 10, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
Validation loss decreased (-0.821869 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.6961688995361328
Epoch: 11, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6840686798095703
Epoch: 12, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5762364864349365
Epoch: 13, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5757918357849121
Epoch: 14, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7522258758544922
Epoch: 15, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 0.546072244644165
Epoch: 16, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7165517807006836
Epoch: 17, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5281882286071777
Epoch: 18, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.547 Vali Acc: 0.853 Test Loss: 0.547 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5495448112487793
Epoch: 19, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 20 cost time: 0.5683436393737793
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6473596096038818
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6269130706787109
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5589816570281982
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5489988327026367
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.853 Test Loss: 0.675 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7904322147369385
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.678220272064209
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.716 Vali Acc: 0.853 Test Loss: 0.716 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7078440189361572
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5720808506011963
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.856 Test Loss: 0.731 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.583076000213623
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 233348
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.604464530944824
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 2.032 Vali Acc: 0.197 Test Loss: 2.032 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 0.7698259353637695
Epoch: 2, Steps: 8 | Train Loss: 1.913 Vali Loss: 1.783 Vali Acc: 0.469 Test Loss: 1.783 Test Acc: 0.469
Validation loss decreased (-0.196855 --> -0.468732).  Saving model ...
Epoch: 3 cost time: 0.8797924518585205
Epoch: 3, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.478 Vali Acc: 0.628 Test Loss: 1.478 Test Acc: 0.628
Validation loss decreased (-0.468732 --> -0.628110).  Saving model ...
Epoch: 4 cost time: 0.5917923450469971
Epoch: 4, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.189 Vali Acc: 0.713 Test Loss: 1.189 Test Acc: 0.713
Validation loss decreased (-0.628110 --> -0.712488).  Saving model ...
Epoch: 5 cost time: 0.7529585361480713
Epoch: 5, Steps: 8 | Train Loss: 0.995 Vali Loss: 0.941 Vali Acc: 0.781 Test Loss: 0.941 Test Acc: 0.781
Validation loss decreased (-0.712488 --> -0.781241).  Saving model ...
Epoch: 6 cost time: 0.7612729072570801
Epoch: 6, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.770 Vali Acc: 0.791 Test Loss: 0.770 Test Acc: 0.791
Validation loss decreased (-0.781241 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.6787610054016113
Epoch: 7, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
Validation loss decreased (-0.790617 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 0.687964677810669
Epoch: 8, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.562 Vali Acc: 0.859 Test Loss: 0.562 Test Acc: 0.859
Validation loss decreased (-0.815618 --> -0.859369).  Saving model ...
Epoch: 9 cost time: 0.6687660217285156
Epoch: 9, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6030118465423584
Epoch: 10, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7097992897033691
Epoch: 11, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6486434936523438
Epoch: 12, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6169815063476562
Epoch: 13, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 0.9298365116119385
Epoch: 14, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.710951566696167
Epoch: 15, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8197267055511475
Epoch: 16, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6688802242279053
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.662616491317749
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5697383880615234
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6484365463256836
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5489194393157959
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.609 Vali Acc: 0.866 Test Loss: 0.609 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865619).  Saving model ...
Epoch: 22 cost time: 0.6508188247680664
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.647 Vali Acc: 0.866 Test Loss: 0.647 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6476242542266846
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.676 Vali Acc: 0.853 Test Loss: 0.676 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5984885692596436
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6670370101928711
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.712 Vali Acc: 0.866 Test Loss: 0.712 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5934665203094482
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.866 Test Loss: 0.751 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5610368251800537
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.760 Vali Acc: 0.866 Test Loss: 0.760 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7676408290863037
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.763 Vali Acc: 0.859 Test Loss: 0.763 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9267425537109375
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.774 Vali Acc: 0.863 Test Loss: 0.774 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7041051387786865
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.791 Vali Acc: 0.859 Test Loss: 0.791 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6651380062103271
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.856 Test Loss: 0.809 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 231603
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.870084524154663
Epoch: 1, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.923 Vali Acc: 0.259 Test Loss: 1.923 Test Acc: 0.259
Validation loss decreased (inf --> -0.259356).  Saving model ...
Epoch: 2 cost time: 0.6366181373596191
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
Validation loss decreased (-0.259356 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 0.7541508674621582
Epoch: 3, Steps: 8 | Train Loss: 1.560 Vali Loss: 1.402 Vali Acc: 0.703 Test Loss: 1.402 Test Acc: 0.703
Validation loss decreased (-0.499983 --> -0.703111).  Saving model ...
Epoch: 4 cost time: 0.690086841583252
Epoch: 4, Steps: 8 | Train Loss: 1.256 Vali Loss: 1.135 Vali Acc: 0.794 Test Loss: 1.135 Test Acc: 0.794
Validation loss decreased (-0.703111 --> -0.793739).  Saving model ...
Epoch: 5 cost time: 0.5888371467590332
Epoch: 5, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.916 Vali Acc: 0.800 Test Loss: 0.916 Test Acc: 0.800
Validation loss decreased (-0.793739 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 0.5847325325012207
Epoch: 6, Steps: 8 | Train Loss: 0.802 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.821867).  Saving model ...
Epoch: 7 cost time: 0.5821163654327393
Epoch: 7, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6645064353942871
Epoch: 8, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
Validation loss decreased (-0.821867 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 0.6434276103973389
Epoch: 9, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6506457328796387
Epoch: 10, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5790128707885742
Epoch: 11, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7480087280273438
Epoch: 12, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6401214599609375
Epoch: 13, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6226556301116943
Epoch: 14, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.713040828704834
Epoch: 15, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5448908805847168
Epoch: 16, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6242358684539795
Epoch: 17, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 0.5155525207519531
Epoch: 18, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6362400054931641
Epoch: 19, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6093318462371826
Epoch: 20, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6630411148071289
Epoch: 21, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.47681093215942383
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.591 Vali Acc: 0.834 Test Loss: 0.591 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.587160587310791
Epoch: 23, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.603 Vali Acc: 0.834 Test Loss: 0.603 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5310924053192139
Epoch: 24, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.614 Vali Acc: 0.831 Test Loss: 0.614 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6213743686676025
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.608 Vali Acc: 0.838 Test Loss: 0.608 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6712617874145508
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.619 Vali Acc: 0.831 Test Loss: 0.619 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.62850022315979
Epoch: 27, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.635 Vali Acc: 0.831 Test Loss: 0.635 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 163096
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1776204109191895
Epoch: 1, Steps: 8 | Train Loss: 2.214 Vali Loss: 2.125 Vali Acc: 0.084 Test Loss: 2.125 Test Acc: 0.084
Validation loss decreased (inf --> -0.084354).  Saving model ...
Epoch: 2 cost time: 0.6243605613708496
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.864 Vali Acc: 0.375 Test Loss: 1.864 Test Acc: 0.375
Validation loss decreased (-0.084354 --> -0.374981).  Saving model ...
Epoch: 3 cost time: 0.7910163402557373
Epoch: 3, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.552 Vali Acc: 0.631 Test Loss: 1.552 Test Acc: 0.631
Validation loss decreased (-0.374981 --> -0.631234).  Saving model ...
Epoch: 4 cost time: 0.7024199962615967
Epoch: 4, Steps: 8 | Train Loss: 1.402 Vali Loss: 1.251 Vali Acc: 0.741 Test Loss: 1.251 Test Acc: 0.741
Validation loss decreased (-0.631234 --> -0.740612).  Saving model ...
Epoch: 5 cost time: 0.5812220573425293
Epoch: 5, Steps: 8 | Train Loss: 1.087 Vali Loss: 0.994 Vali Acc: 0.778 Test Loss: 0.994 Test Acc: 0.778
Validation loss decreased (-0.740612 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.6052007675170898
Epoch: 6, Steps: 8 | Train Loss: 0.878 Vali Loss: 0.817 Vali Acc: 0.787 Test Loss: 0.817 Test Acc: 0.787
Validation loss decreased (-0.778115 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.49412083625793457
Epoch: 7, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.702 Vali Acc: 0.803 Test Loss: 0.702 Test Acc: 0.803
Validation loss decreased (-0.787492 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.7001264095306396
Epoch: 8, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5778381824493408
Epoch: 9, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.6664435863494873
Epoch: 10, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 0.6878659725189209
Epoch: 11, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 0.7217731475830078
Epoch: 12, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6734614372253418
Epoch: 13, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5532965660095215
Epoch: 14, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 0.624413013458252
Epoch: 15, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 0.5978467464447021
Epoch: 16, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 0.6314949989318848
Epoch: 17, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6363060474395752
Epoch: 18, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6414377689361572
Epoch: 19, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6035294532775879
Epoch: 20, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5749571323394775
Epoch: 21, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6771845817565918
Epoch: 22, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5926098823547363
Epoch: 23, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6799414157867432
Epoch: 24, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5993831157684326
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.648 Vali Acc: 0.816 Test Loss: 0.648 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.558560848236084
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.660 Vali Acc: 0.812 Test Loss: 0.660 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 156011
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9536418914794922
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.057 Vali Acc: 0.219 Test Loss: 2.057 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 0.612328290939331
Epoch: 2, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.808 Vali Acc: 0.438 Test Loss: 1.808 Test Acc: 0.438
Validation loss decreased (-0.218729 --> -0.437482).  Saving model ...
Epoch: 3 cost time: 0.6486430168151855
Epoch: 3, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.510 Vali Acc: 0.650 Test Loss: 1.510 Test Acc: 0.650
Validation loss decreased (-0.437482 --> -0.649985).  Saving model ...
Epoch: 4 cost time: 0.626011848449707
Epoch: 4, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.214 Vali Acc: 0.738 Test Loss: 1.214 Test Acc: 0.738
Validation loss decreased (-0.649985 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.5758216381072998
Epoch: 5, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.966 Vali Acc: 0.784 Test Loss: 0.966 Test Acc: 0.784
Validation loss decreased (-0.737488 --> -0.784365).  Saving model ...
Epoch: 6 cost time: 0.6802577972412109
Epoch: 6, Steps: 8 | Train Loss: 0.824 Vali Loss: 0.793 Vali Acc: 0.791 Test Loss: 0.793 Test Acc: 0.791
Validation loss decreased (-0.784365 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.8011343479156494
Epoch: 7, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
Validation loss decreased (-0.790617 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.7623753547668457
Epoch: 8, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.6257333755493164
Epoch: 9, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.6299123764038086
Epoch: 10, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818745).  Saving model ...
Epoch: 11 cost time: 0.6567428112030029
Epoch: 11, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 12 cost time: 0.7859902381896973
Epoch: 12, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6887755393981934
Epoch: 13, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.908660888671875
Epoch: 14, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5999083518981934
Epoch: 15, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 0.4723944664001465
Epoch: 16, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 17 cost time: 0.5850098133087158
Epoch: 17, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6272923946380615
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6720619201660156
Epoch: 19, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6828653812408447
Epoch: 20, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5074827671051025
Epoch: 21, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6136882305145264
Epoch: 22, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6720175743103027
Epoch: 23, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.586 Vali Acc: 0.831 Test Loss: 0.586 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7046821117401123
Epoch: 24, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.598 Vali Acc: 0.838 Test Loss: 0.598 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837494).  Saving model ...
Epoch: 25 cost time: 0.550804853439331
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.604 Vali Acc: 0.834 Test Loss: 0.604 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.501758337020874
Epoch: 26, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 27 cost time: 0.5853164196014404
Epoch: 27, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 28 cost time: 0.578009843826294
Epoch: 28, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.648 Vali Acc: 0.841 Test Loss: 0.648 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6725804805755615
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.651 Vali Acc: 0.841 Test Loss: 0.651 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8812296390533447
Epoch: 30, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.591118574142456
Epoch: 31, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6499128341674805
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.693 Vali Acc: 0.834 Test Loss: 0.693 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5755264759063721
Epoch: 33, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.707 Vali Acc: 0.838 Test Loss: 0.707 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6592862606048584
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.717 Vali Acc: 0.838 Test Loss: 0.717 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8678369522094727
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.731 Vali Acc: 0.838 Test Loss: 0.731 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9620506763458252
Epoch: 36, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.834 Test Loss: 0.748 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8246972560882568
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.834 Test Loss: 0.762 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 153016
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.021436929702759
Epoch: 1, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.991 Vali Acc: 0.172 Test Loss: 1.991 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 0.6444506645202637
Epoch: 2, Steps: 8 | Train Loss: 1.881 Vali Loss: 1.757 Vali Acc: 0.378 Test Loss: 1.757 Test Acc: 0.378
Validation loss decreased (-0.171855 --> -0.378107).  Saving model ...
Epoch: 3 cost time: 0.6556527614593506
Epoch: 3, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.463 Vali Acc: 0.631 Test Loss: 1.463 Test Acc: 0.631
Validation loss decreased (-0.378107 --> -0.631235).  Saving model ...
Epoch: 4 cost time: 0.806469202041626
Epoch: 4, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.188 Vali Acc: 0.719 Test Loss: 1.188 Test Acc: 0.719
Validation loss decreased (-0.631235 --> -0.718738).  Saving model ...
Epoch: 5 cost time: 0.6587226390838623
Epoch: 5, Steps: 8 | Train Loss: 1.022 Vali Loss: 0.964 Vali Acc: 0.753 Test Loss: 0.964 Test Acc: 0.753
Validation loss decreased (-0.718738 --> -0.753115).  Saving model ...
Epoch: 6 cost time: 0.7526917457580566
Epoch: 6, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.796 Vali Acc: 0.784 Test Loss: 0.796 Test Acc: 0.784
Validation loss decreased (-0.753115 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.6039910316467285
Epoch: 7, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.686 Vali Acc: 0.812 Test Loss: 0.686 Test Acc: 0.812
Validation loss decreased (-0.784367 --> -0.812493).  Saving model ...
Epoch: 8 cost time: 0.664177656173706
Epoch: 8, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.7420742511749268
Epoch: 9, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5630195140838623
Epoch: 10, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6690759658813477
Epoch: 11, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.53403639793396
Epoch: 12, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 13 cost time: 0.6013898849487305
Epoch: 13, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6294236183166504
Epoch: 14, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6065797805786133
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5964922904968262
Epoch: 16, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 0.5149316787719727
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7374734878540039
Epoch: 18, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6398968696594238
Epoch: 19, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.588 Vali Acc: 0.831 Test Loss: 0.588 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6408677101135254
Epoch: 20, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6197149753570557
Epoch: 21, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843744).  Saving model ...
Epoch: 22 cost time: 0.4824855327606201
Epoch: 22, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6199295520782471
Epoch: 23, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.631 Vali Acc: 0.831 Test Loss: 0.631 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7253420352935791
Epoch: 24, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.659 Vali Acc: 0.834 Test Loss: 0.659 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5689663887023926
Epoch: 25, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.682 Vali Acc: 0.831 Test Loss: 0.682 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6715221405029297
Epoch: 26, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.655 Vali Acc: 0.838 Test Loss: 0.655 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5296671390533447
Epoch: 27, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5727040767669678
Epoch: 28, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.714 Vali Acc: 0.831 Test Loss: 0.714 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6280004978179932
Epoch: 29, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.751 Vali Acc: 0.834 Test Loss: 0.751 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.645941972732544
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5569603443145752
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.770 Vali Acc: 0.834 Test Loss: 0.770 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 150675
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0238938331604004
Epoch: 1, Steps: 8 | Train Loss: 2.087 Vali Loss: 1.979 Vali Acc: 0.209 Test Loss: 1.979 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 0.7118597030639648
Epoch: 2, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.742 Vali Acc: 0.434 Test Loss: 1.742 Test Acc: 0.434
Validation loss decreased (-0.209355 --> -0.434358).  Saving model ...
Epoch: 3 cost time: 0.6920661926269531
Epoch: 3, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.445 Vali Acc: 0.681 Test Loss: 1.445 Test Acc: 0.681
Validation loss decreased (-0.434358 --> -0.681236).  Saving model ...
Epoch: 4 cost time: 0.7030072212219238
Epoch: 4, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.164 Vali Acc: 0.756 Test Loss: 1.164 Test Acc: 0.756
Validation loss decreased (-0.681236 --> -0.756238).  Saving model ...
Epoch: 5 cost time: 0.751568078994751
Epoch: 5, Steps: 8 | Train Loss: 1.047 Vali Loss: 0.931 Vali Acc: 0.778 Test Loss: 0.931 Test Acc: 0.778
Validation loss decreased (-0.756238 --> -0.778116).  Saving model ...
Epoch: 6 cost time: 0.7241888046264648
Epoch: 6, Steps: 8 | Train Loss: 0.789 Vali Loss: 0.782 Vali Acc: 0.781 Test Loss: 0.782 Test Acc: 0.781
Validation loss decreased (-0.778116 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.7072179317474365
Epoch: 7, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5901134014129639
Epoch: 8, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.6205916404724121
Epoch: 9, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.6861505508422852
Epoch: 10, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.7510688304901123
Epoch: 11, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.6343238353729248
Epoch: 12, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.8523654937744141
Epoch: 13, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6497597694396973
Epoch: 14, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8062584400177002
Epoch: 15, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.656466007232666
Epoch: 16, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6648261547088623
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.559 Vali Acc: 0.834 Test Loss: 0.559 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834369).  Saving model ...
Epoch: 18 cost time: 0.8085062503814697
Epoch: 18, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.566 Vali Acc: 0.834 Test Loss: 0.566 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6513781547546387
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 20 cost time: 0.5303568840026855
Epoch: 20, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6077163219451904
Epoch: 21, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6280598640441895
Epoch: 22, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5747449398040771
Epoch: 23, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6561183929443359
Epoch: 24, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.624 Vali Acc: 0.831 Test Loss: 0.624 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5050175189971924
Epoch: 25, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.608992338180542
Epoch: 26, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5836234092712402
Epoch: 27, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.667 Vali Acc: 0.816 Test Loss: 0.667 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.616246223449707
Epoch: 28, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7563023567199707
Epoch: 29, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.704 Vali Acc: 0.828 Test Loss: 0.704 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 150366
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.899724006652832
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.064 Vali Acc: 0.216 Test Loss: 2.064 Test Acc: 0.216
Validation loss decreased (inf --> -0.215604).  Saving model ...
Epoch: 2 cost time: 0.5400371551513672
Epoch: 2, Steps: 8 | Train Loss: 1.940 Vali Loss: 1.812 Vali Acc: 0.428 Test Loss: 1.812 Test Acc: 0.428
Validation loss decreased (-0.215604 --> -0.428107).  Saving model ...
Epoch: 3 cost time: 0.6662423610687256
Epoch: 3, Steps: 8 | Train Loss: 1.651 Vali Loss: 1.508 Vali Acc: 0.666 Test Loss: 1.508 Test Acc: 0.666
Validation loss decreased (-0.428107 --> -0.665610).  Saving model ...
Epoch: 4 cost time: 0.6159725189208984
Epoch: 4, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.210 Vali Acc: 0.741 Test Loss: 1.210 Test Acc: 0.741
Validation loss decreased (-0.665610 --> -0.740613).  Saving model ...
Epoch: 5 cost time: 0.6398069858551025
Epoch: 5, Steps: 8 | Train Loss: 1.069 Vali Loss: 0.972 Vali Acc: 0.772 Test Loss: 0.972 Test Acc: 0.772
Validation loss decreased (-0.740613 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.5609140396118164
Epoch: 6, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.800 Vali Acc: 0.787 Test Loss: 0.800 Test Acc: 0.787
Validation loss decreased (-0.771865 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.5557866096496582
Epoch: 7, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.684 Vali Acc: 0.806 Test Loss: 0.684 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.6855721473693848
Epoch: 8, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.7378997802734375
Epoch: 9, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6938285827636719
Epoch: 10, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.6815824508666992
Epoch: 11, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.5451300144195557
Epoch: 12, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5404119491577148
Epoch: 13, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6355996131896973
Epoch: 14, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7354152202606201
Epoch: 15, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7162792682647705
Epoch: 16, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6634812355041504
Epoch: 17, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5914778709411621
Epoch: 18, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.575 Vali Acc: 0.806 Test Loss: 0.575 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7243077754974365
Epoch: 19, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8557817935943604
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6917102336883545
Epoch: 21, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 148427
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0077483654022217
Epoch: 1, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.907 Vali Acc: 0.322 Test Loss: 1.907 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 0.6406817436218262
Epoch: 2, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.677 Vali Acc: 0.534 Test Loss: 1.677 Test Acc: 0.534
Validation loss decreased (-0.321856 --> -0.534358).  Saving model ...
Epoch: 3 cost time: 0.715695858001709
Epoch: 3, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.405 Vali Acc: 0.706 Test Loss: 1.405 Test Acc: 0.706
Validation loss decreased (-0.534358 --> -0.706236).  Saving model ...
Epoch: 4 cost time: 0.7407774925231934
Epoch: 4, Steps: 8 | Train Loss: 1.265 Vali Loss: 1.151 Vali Acc: 0.750 Test Loss: 1.151 Test Acc: 0.750
Validation loss decreased (-0.706236 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 0.7880270481109619
Epoch: 5, Steps: 8 | Train Loss: 1.004 Vali Loss: 0.933 Vali Acc: 0.778 Test Loss: 0.933 Test Acc: 0.778
Validation loss decreased (-0.749988 --> -0.778116).  Saving model ...
Epoch: 6 cost time: 0.5607180595397949
Epoch: 6, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.774 Vali Acc: 0.797 Test Loss: 0.774 Test Acc: 0.797
Validation loss decreased (-0.778116 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.6415553092956543
Epoch: 7, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.676 Vali Acc: 0.819 Test Loss: 0.676 Test Acc: 0.819
Validation loss decreased (-0.796867 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 0.650205135345459
Epoch: 8, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.617 Vali Acc: 0.819 Test Loss: 0.617 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.7436277866363525
Epoch: 9, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.7288689613342285
Epoch: 10, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 0.6264655590057373
Epoch: 11, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 0.6512823104858398
Epoch: 12, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7365322113037109
Epoch: 13, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7235138416290283
Epoch: 14, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.6777529716491699
Epoch: 15, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 0.6169958114624023
Epoch: 16, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7777090072631836
Epoch: 17, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7523112297058105
Epoch: 18, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7247631549835205
Epoch: 19, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6922791004180908
Epoch: 20, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6659224033355713
Epoch: 21, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5635380744934082
Epoch: 22, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.613 Vali Acc: 0.831 Test Loss: 0.613 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7906968593597412
Epoch: 23, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7653639316558838
Epoch: 24, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.632 Vali Acc: 0.831 Test Loss: 0.632 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6402499675750732
Epoch: 25, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.643 Vali Acc: 0.847 Test Loss: 0.643 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 26 cost time: 0.6456232070922852
Epoch: 26, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.648 Vali Acc: 0.847 Test Loss: 0.648 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5452926158905029
Epoch: 27, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.663 Vali Acc: 0.847 Test Loss: 0.663 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6939473152160645
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.687 Vali Acc: 0.838 Test Loss: 0.687 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5783264636993408
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.691 Vali Acc: 0.844 Test Loss: 0.691 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7295632362365723
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6372923851013184
Epoch: 31, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.712 Vali Acc: 0.847 Test Loss: 0.712 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7217597961425781
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.728 Vali Acc: 0.844 Test Loss: 0.728 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6674337387084961
Epoch: 33, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.740 Vali Acc: 0.844 Test Loss: 0.740 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.729529857635498
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.847 Test Loss: 0.748 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6521468162536621
Epoch: 35, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.767 Vali Acc: 0.844 Test Loss: 0.767 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 149396
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2562410831451416
Epoch: 1, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.944 Vali Acc: 0.300 Test Loss: 1.944 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 0.6087703704833984
Epoch: 2, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.717 Vali Acc: 0.491 Test Loss: 1.717 Test Acc: 0.491
Validation loss decreased (-0.299981 --> -0.490608).  Saving model ...
Epoch: 3 cost time: 0.5216555595397949
Epoch: 3, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.449 Vali Acc: 0.588 Test Loss: 1.449 Test Acc: 0.588
Validation loss decreased (-0.490608 --> -0.587486).  Saving model ...
Epoch: 4 cost time: 0.5945053100585938
Epoch: 4, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.181 Vali Acc: 0.738 Test Loss: 1.181 Test Acc: 0.738
Validation loss decreased (-0.587486 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.6275930404663086
Epoch: 5, Steps: 8 | Train Loss: 1.045 Vali Loss: 0.960 Vali Acc: 0.772 Test Loss: 0.960 Test Acc: 0.772
Validation loss decreased (-0.737488 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.6924543380737305
Epoch: 6, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
Validation loss decreased (-0.771865 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.6040022373199463
Epoch: 7, Steps: 8 | Train Loss: 0.667 Vali Loss: 0.700 Vali Acc: 0.791 Test Loss: 0.700 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.512580394744873
Epoch: 8, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
Validation loss decreased (-0.793742 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.5285212993621826
Epoch: 9, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.6212515830993652
Epoch: 10, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.6491060256958008
Epoch: 11, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.6882433891296387
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.5925924777984619
Epoch: 13, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 0.7034745216369629
Epoch: 14, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5776031017303467
Epoch: 15, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7420599460601807
Epoch: 16, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6614012718200684
Epoch: 17, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831244).  Saving model ...
Epoch: 18 cost time: 0.7138309478759766
Epoch: 18, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5768001079559326
Epoch: 19, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5596833229064941
Epoch: 20, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.577674150466919
Epoch: 21, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6315033435821533
Epoch: 22, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7154197692871094
Epoch: 23, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7005834579467773
Epoch: 24, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6596388816833496
Epoch: 25, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5913047790527344
Epoch: 26, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.729581356048584
Epoch: 27, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.669 Vali Acc: 0.812 Test Loss: 0.669 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 147219
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.293623924255371
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.062 Vali Acc: 0.219 Test Loss: 2.062 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 0.6320395469665527
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.820 Vali Acc: 0.328 Test Loss: 1.820 Test Acc: 0.328
Validation loss decreased (-0.218729 --> -0.328107).  Saving model ...
Epoch: 3 cost time: 0.6076252460479736
Epoch: 3, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.506 Vali Acc: 0.597 Test Loss: 1.506 Test Acc: 0.597
Validation loss decreased (-0.328107 --> -0.596860).  Saving model ...
Epoch: 4 cost time: 0.6200706958770752
Epoch: 4, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.204 Vali Acc: 0.759 Test Loss: 1.204 Test Acc: 0.759
Validation loss decreased (-0.596860 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.6430196762084961
Epoch: 5, Steps: 8 | Train Loss: 1.070 Vali Loss: 0.960 Vali Acc: 0.787 Test Loss: 0.960 Test Acc: 0.787
Validation loss decreased (-0.759363 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.5796561241149902
Epoch: 6, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.785 Vali Acc: 0.797 Test Loss: 0.785 Test Acc: 0.797
Validation loss decreased (-0.787490 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5987005233764648
Epoch: 7, Steps: 8 | Train Loss: 0.707 Vali Loss: 0.680 Vali Acc: 0.797 Test Loss: 0.680 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.6120221614837646
Epoch: 8, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.636540412902832
Epoch: 9, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.6382589340209961
Epoch: 10, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7088882923126221
Epoch: 11, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.6613774299621582
Epoch: 12, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.7626962661743164
Epoch: 13, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.536 Vali Acc: 0.825 Test Loss: 0.536 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8304166793823242
Epoch: 14, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7789397239685059
Epoch: 15, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6291275024414062
Epoch: 16, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.725745439529419
Epoch: 17, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7233412265777588
Epoch: 18, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6919000148773193
Epoch: 19, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834369).  Saving model ...
Epoch: 20 cost time: 0.8196213245391846
Epoch: 20, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7346549034118652
Epoch: 21, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6427609920501709
Epoch: 22, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.593 Vali Acc: 0.834 Test Loss: 0.593 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7633049488067627
Epoch: 23, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6054513454437256
Epoch: 24, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7593932151794434
Epoch: 25, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.643 Vali Acc: 0.834 Test Loss: 0.643 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5901033878326416
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.660 Vali Acc: 0.828 Test Loss: 0.660 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6665656566619873
Epoch: 27, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.682 Vali Acc: 0.825 Test Loss: 0.682 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8347887992858887
Epoch: 28, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.680 Vali Acc: 0.834 Test Loss: 0.680 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7802486419677734
Epoch: 29, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.702 Vali Acc: 0.831 Test Loss: 0.702 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 148452
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.126347780227661
Epoch: 1, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.976 Vali Acc: 0.234 Test Loss: 1.976 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.586681604385376
Epoch: 2, Steps: 8 | Train Loss: 1.876 Vali Loss: 1.730 Vali Acc: 0.412 Test Loss: 1.730 Test Acc: 0.412
Validation loss decreased (-0.234355 --> -0.412483).  Saving model ...
Epoch: 3 cost time: 0.5717253684997559
Epoch: 3, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.430 Vali Acc: 0.725 Test Loss: 1.430 Test Acc: 0.725
Validation loss decreased (-0.412483 --> -0.724986).  Saving model ...
Epoch: 4 cost time: 0.6088533401489258
Epoch: 4, Steps: 8 | Train Loss: 1.268 Vali Loss: 1.154 Vali Acc: 0.766 Test Loss: 1.154 Test Acc: 0.766
Validation loss decreased (-0.724986 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.6592366695404053
Epoch: 5, Steps: 8 | Train Loss: 1.005 Vali Loss: 0.931 Vali Acc: 0.797 Test Loss: 0.931 Test Acc: 0.797
Validation loss decreased (-0.765613 --> -0.796866).  Saving model ...
Epoch: 6 cost time: 0.5607700347900391
Epoch: 6, Steps: 8 | Train Loss: 0.779 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.796866 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5605685710906982
Epoch: 7, Steps: 8 | Train Loss: 0.630 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.5752854347229004
Epoch: 8, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.614 Vali Acc: 0.812 Test Loss: 0.614 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.5720033645629883
Epoch: 9, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.601865291595459
Epoch: 10, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.562 Vali Acc: 0.834 Test Loss: 0.562 Test Acc: 0.834
Validation loss decreased (-0.812494 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 0.705852746963501
Epoch: 11, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 0.5898995399475098
Epoch: 12, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5797531604766846
Epoch: 13, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5856108665466309
Epoch: 14, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5668661594390869
Epoch: 15, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5853760242462158
Epoch: 16, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5218527317047119
Epoch: 17, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6225860118865967
Epoch: 18, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6351792812347412
Epoch: 19, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6574039459228516
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.607633113861084
Epoch: 21, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.620 Vali Acc: 0.819 Test Loss: 0.620 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 147799
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.87245774269104
Epoch: 1, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.995 Vali Acc: 0.169 Test Loss: 1.995 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 0.7811441421508789
Epoch: 2, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.744 Vali Acc: 0.472 Test Loss: 1.744 Test Acc: 0.472
Validation loss decreased (-0.168730 --> -0.471858).  Saving model ...
Epoch: 3 cost time: 0.6556687355041504
Epoch: 3, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.447 Vali Acc: 0.656 Test Loss: 1.447 Test Acc: 0.656
Validation loss decreased (-0.471858 --> -0.656236).  Saving model ...
Epoch: 4 cost time: 0.6241354942321777
Epoch: 4, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.173 Vali Acc: 0.772 Test Loss: 1.173 Test Acc: 0.772
Validation loss decreased (-0.656236 --> -0.771863).  Saving model ...
Epoch: 5 cost time: 0.5861246585845947
Epoch: 5, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.959 Vali Acc: 0.787 Test Loss: 0.959 Test Acc: 0.787
Validation loss decreased (-0.771863 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.7092819213867188
Epoch: 6, Steps: 8 | Train Loss: 0.778 Vali Loss: 0.800 Vali Acc: 0.794 Test Loss: 0.800 Test Acc: 0.794
Validation loss decreased (-0.787490 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.6486020088195801
Epoch: 7, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.685 Vali Acc: 0.797 Test Loss: 0.685 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.7514629364013672
Epoch: 8, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.5937879085540771
Epoch: 9, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.541924238204956
Epoch: 10, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.6554770469665527
Epoch: 11, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.702772855758667
Epoch: 12, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.5275919437408447
Epoch: 13, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6430826187133789
Epoch: 14, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.821869 --> -0.840619).  Saving model ...
Epoch: 15 cost time: 0.5850429534912109
Epoch: 15, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6634366512298584
Epoch: 16, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.588 Vali Acc: 0.828 Test Loss: 0.588 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6139695644378662
Epoch: 17, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7115826606750488
Epoch: 18, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6857516765594482
Epoch: 19, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6082849502563477
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.601 Vali Acc: 0.816 Test Loss: 0.601 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.592792272567749
Epoch: 21, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.598 Vali Acc: 0.834 Test Loss: 0.598 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7035658359527588
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.618 Vali Acc: 0.831 Test Loss: 0.618 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5310707092285156
Epoch: 23, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7265143394470215
Epoch: 24, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.641 Vali Acc: 0.834 Test Loss: 0.641 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 149168
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.108722448348999
Epoch: 1, Steps: 8 | Train Loss: 2.085 Vali Loss: 2.021 Vali Acc: 0.266 Test Loss: 2.021 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 0.5608553886413574
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.789 Vali Acc: 0.463 Test Loss: 1.789 Test Acc: 0.463
Validation loss decreased (-0.265605 --> -0.462482).  Saving model ...
Epoch: 3 cost time: 0.52530837059021
Epoch: 3, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.511 Vali Acc: 0.606 Test Loss: 1.511 Test Acc: 0.606
Validation loss decreased (-0.462482 --> -0.606235).  Saving model ...
Epoch: 4 cost time: 0.5800707340240479
Epoch: 4, Steps: 8 | Train Loss: 1.337 Vali Loss: 1.233 Vali Acc: 0.709 Test Loss: 1.233 Test Acc: 0.709
Validation loss decreased (-0.606235 --> -0.709363).  Saving model ...
Epoch: 5 cost time: 0.6517975330352783
Epoch: 5, Steps: 8 | Train Loss: 1.032 Vali Loss: 0.997 Vali Acc: 0.756 Test Loss: 0.997 Test Acc: 0.756
Validation loss decreased (-0.709363 --> -0.756240).  Saving model ...
Epoch: 6 cost time: 0.582179069519043
Epoch: 6, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.826 Vali Acc: 0.797 Test Loss: 0.826 Test Acc: 0.797
Validation loss decreased (-0.756240 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.606813907623291
Epoch: 7, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
Validation loss decreased (-0.796867 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.6737875938415527
Epoch: 8, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.614849328994751
Epoch: 9, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.6200907230377197
Epoch: 10, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.681309700012207
Epoch: 11, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.5622336864471436
Epoch: 12, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 0.5258331298828125
Epoch: 13, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.52132248878479
Epoch: 14, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 15 cost time: 0.5466790199279785
Epoch: 15, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 16 cost time: 0.5526628494262695
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6333224773406982
Epoch: 17, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5494108200073242
Epoch: 18, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.560427188873291
Epoch: 19, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5664701461791992
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5997686386108398
Epoch: 21, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5530304908752441
Epoch: 22, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.604 Vali Acc: 0.834 Test Loss: 0.604 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6137056350708008
Epoch: 23, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.612 Vali Acc: 0.831 Test Loss: 0.612 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6387591361999512
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.616 Vali Acc: 0.831 Test Loss: 0.616 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5757513046264648
Epoch: 25, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.633 Vali Acc: 0.828 Test Loss: 0.633 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 149281
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.139796495437622
Epoch: 1, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.980 Vali Acc: 0.297 Test Loss: 1.980 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 0.6304757595062256
Epoch: 2, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.733 Vali Acc: 0.456 Test Loss: 1.733 Test Acc: 0.456
Validation loss decreased (-0.296855 --> -0.456233).  Saving model ...
Epoch: 3 cost time: 0.6590690612792969
Epoch: 3, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.438 Vali Acc: 0.641 Test Loss: 1.438 Test Acc: 0.641
Validation loss decreased (-0.456233 --> -0.640611).  Saving model ...
Epoch: 4 cost time: 0.6640336513519287
Epoch: 4, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.157 Vali Acc: 0.747 Test Loss: 1.157 Test Acc: 0.747
Validation loss decreased (-0.640611 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.744171142578125
Epoch: 5, Steps: 8 | Train Loss: 0.974 Vali Loss: 0.930 Vali Acc: 0.778 Test Loss: 0.930 Test Acc: 0.778
Validation loss decreased (-0.746863 --> -0.778116).  Saving model ...
Epoch: 6 cost time: 0.738145112991333
Epoch: 6, Steps: 8 | Train Loss: 0.767 Vali Loss: 0.781 Vali Acc: 0.791 Test Loss: 0.781 Test Acc: 0.791
Validation loss decreased (-0.778116 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.6531658172607422
Epoch: 7, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.720860481262207
Epoch: 8, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
Validation loss decreased (-0.793743 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.6922495365142822
Epoch: 9, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.7149779796600342
Epoch: 10, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6968808174133301
Epoch: 11, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6068923473358154
Epoch: 12, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6329905986785889
Epoch: 13, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 0.714111328125
Epoch: 14, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 0.7652592658996582
Epoch: 15, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6533854007720947
Epoch: 16, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5940830707550049
Epoch: 17, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 0.6168453693389893
Epoch: 18, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7000060081481934
Epoch: 19, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8002533912658691
Epoch: 20, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7343583106994629
Epoch: 21, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.557971715927124
Epoch: 22, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.592430830001831
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.570 Vali Acc: 0.834 Test Loss: 0.570 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8503508567810059
Epoch: 24, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7944443225860596
Epoch: 25, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843744).  Saving model ...
Epoch: 26 cost time: 0.6046791076660156
Epoch: 26, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6512775421142578
Epoch: 27, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.584 Vali Acc: 0.847 Test Loss: 0.584 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 28 cost time: 0.709242582321167
Epoch: 28, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.597 Vali Acc: 0.847 Test Loss: 0.597 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7984271049499512
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7865207195281982
Epoch: 30, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7436099052429199
Epoch: 31, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.623 Vali Acc: 0.847 Test Loss: 0.623 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6101176738739014
Epoch: 32, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.847 Test Loss: 0.631 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4811441898345947
Epoch: 33, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.663 Vali Acc: 0.841 Test Loss: 0.663 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5153741836547852
Epoch: 34, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.841 Test Loss: 0.674 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6515974998474121
Epoch: 35, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.671 Vali Acc: 0.844 Test Loss: 0.671 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.622220516204834
Epoch: 36, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.681 Vali Acc: 0.841 Test Loss: 0.681 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5626323223114014
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.834 Test Loss: 0.705 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 148138
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9741075038909912
Epoch: 1, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.940 Vali Acc: 0.241 Test Loss: 1.940 Test Acc: 0.241
Validation loss decreased (inf --> -0.240606).  Saving model ...
Epoch: 2 cost time: 0.6845109462738037
Epoch: 2, Steps: 8 | Train Loss: 1.837 Vali Loss: 1.708 Vali Acc: 0.472 Test Loss: 1.708 Test Acc: 0.472
Validation loss decreased (-0.240606 --> -0.471858).  Saving model ...
Epoch: 3 cost time: 0.6665918827056885
Epoch: 3, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.428 Vali Acc: 0.669 Test Loss: 1.428 Test Acc: 0.669
Validation loss decreased (-0.471858 --> -0.668736).  Saving model ...
Epoch: 4 cost time: 0.5765664577484131
Epoch: 4, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.150 Vali Acc: 0.756 Test Loss: 1.150 Test Acc: 0.756
Validation loss decreased (-0.668736 --> -0.756239).  Saving model ...
Epoch: 5 cost time: 0.609839916229248
Epoch: 5, Steps: 8 | Train Loss: 0.980 Vali Loss: 0.939 Vali Acc: 0.772 Test Loss: 0.939 Test Acc: 0.772
Validation loss decreased (-0.756239 --> -0.771866).  Saving model ...
Epoch: 6 cost time: 0.6929364204406738
Epoch: 6, Steps: 8 | Train Loss: 0.841 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.771866 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5827059745788574
Epoch: 7, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.680 Vali Acc: 0.809 Test Loss: 0.680 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 0.581336498260498
Epoch: 8, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
Validation loss decreased (-0.809368 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.5903685092926025
Epoch: 9, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.645082950592041
Epoch: 10, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.8760967254638672
Epoch: 11, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7102651596069336
Epoch: 12, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.6553821563720703
Epoch: 13, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 0.6132299900054932
Epoch: 14, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5858364105224609
Epoch: 15, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6614773273468018
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5574402809143066
Epoch: 17, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7686066627502441
Epoch: 18, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7211647033691406
Epoch: 19, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7138867378234863
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.576 Vali Acc: 0.831 Test Loss: 0.576 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8438794612884521
Epoch: 21, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.574 Vali Acc: 0.831 Test Loss: 0.574 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8420109748840332
Epoch: 22, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8155760765075684
Epoch: 23, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.602 Vali Acc: 0.831 Test Loss: 0.602 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 145739
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.170893430709839
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 2.089 Vali Acc: 0.144 Test Loss: 2.089 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 0.6185059547424316
Epoch: 2, Steps: 8 | Train Loss: 1.934 Vali Loss: 1.840 Vali Acc: 0.409 Test Loss: 1.840 Test Acc: 0.409
Validation loss decreased (-0.143729 --> -0.409357).  Saving model ...
Epoch: 3 cost time: 0.5914108753204346
Epoch: 3, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.533 Vali Acc: 0.597 Test Loss: 1.533 Test Acc: 0.597
Validation loss decreased (-0.409357 --> -0.596860).  Saving model ...
Epoch: 4 cost time: 0.6087241172790527
Epoch: 4, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.232 Vali Acc: 0.731 Test Loss: 1.232 Test Acc: 0.731
Validation loss decreased (-0.596860 --> -0.731238).  Saving model ...
Epoch: 5 cost time: 0.7018125057220459
Epoch: 5, Steps: 8 | Train Loss: 1.042 Vali Loss: 0.986 Vali Acc: 0.781 Test Loss: 0.986 Test Acc: 0.781
Validation loss decreased (-0.731238 --> -0.781240).  Saving model ...
Epoch: 6 cost time: 0.7117574214935303
Epoch: 6, Steps: 8 | Train Loss: 0.812 Vali Loss: 0.811 Vali Acc: 0.784 Test Loss: 0.811 Test Acc: 0.784
Validation loss decreased (-0.781240 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.7990267276763916
Epoch: 7, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.702 Vali Acc: 0.794 Test Loss: 0.702 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.6861927509307861
Epoch: 8, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.620 Vali Acc: 0.809 Test Loss: 0.620 Test Acc: 0.809
Validation loss decreased (-0.793743 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.5808992385864258
Epoch: 9, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.6296005249023438
Epoch: 10, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6071057319641113
Epoch: 11, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 0.6882171630859375
Epoch: 12, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 0.7281475067138672
Epoch: 13, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5867710113525391
Epoch: 14, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.732245922088623
Epoch: 15, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6998889446258545
Epoch: 16, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6139609813690186
Epoch: 17, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.631458044052124
Epoch: 18, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6515533924102783
Epoch: 19, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6966733932495117
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6898939609527588
Epoch: 21, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.626 Vali Acc: 0.819 Test Loss: 0.626 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6990785598754883
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 147252
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8805441856384277
Epoch: 1, Steps: 8 | Train Loss: 2.191 Vali Loss: 2.080 Vali Acc: 0.116 Test Loss: 2.080 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 0.7441506385803223
Epoch: 2, Steps: 8 | Train Loss: 2.014 Vali Loss: 1.831 Vali Acc: 0.328 Test Loss: 1.831 Test Acc: 0.328
Validation loss decreased (-0.115604 --> -0.328107).  Saving model ...
Epoch: 3 cost time: 0.6359210014343262
Epoch: 3, Steps: 8 | Train Loss: 1.714 Vali Loss: 1.519 Vali Acc: 0.634 Test Loss: 1.519 Test Acc: 0.634
Validation loss decreased (-0.328107 --> -0.634360).  Saving model ...
Epoch: 4 cost time: 0.582261323928833
Epoch: 4, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.222 Vali Acc: 0.734 Test Loss: 1.222 Test Acc: 0.734
Validation loss decreased (-0.634360 --> -0.734363).  Saving model ...
Epoch: 5 cost time: 0.5812809467315674
Epoch: 5, Steps: 8 | Train Loss: 1.103 Vali Loss: 0.986 Vali Acc: 0.769 Test Loss: 0.986 Test Acc: 0.769
Validation loss decreased (-0.734363 --> -0.768740).  Saving model ...
Epoch: 6 cost time: 0.6772594451904297
Epoch: 6, Steps: 8 | Train Loss: 0.845 Vali Loss: 0.808 Vali Acc: 0.791 Test Loss: 0.808 Test Acc: 0.791
Validation loss decreased (-0.768740 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.6911149024963379
Epoch: 7, Steps: 8 | Train Loss: 0.684 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
Validation loss decreased (-0.790617 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.6926279067993164
Epoch: 8, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.627 Vali Acc: 0.806 Test Loss: 0.627 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.6634230613708496
Epoch: 9, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.5576248168945312
Epoch: 10, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.6194539070129395
Epoch: 11, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.817657470703125
Epoch: 12, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.6288321018218994
Epoch: 13, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.7572884559631348
Epoch: 14, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5889031887054443
Epoch: 15, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.788477897644043
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 0.7491815090179443
Epoch: 17, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7983794212341309
Epoch: 18, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7962462902069092
Epoch: 19, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5871593952178955
Epoch: 20, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7101585865020752
Epoch: 21, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.590 Vali Acc: 0.831 Test Loss: 0.590 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.551100492477417
Epoch: 22, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.595 Vali Acc: 0.834 Test Loss: 0.595 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 23 cost time: 0.679894208908081
Epoch: 23, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.598 Vali Acc: 0.831 Test Loss: 0.598 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.64776611328125
Epoch: 24, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 25 cost time: 0.6686792373657227
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.629 Vali Acc: 0.838 Test Loss: 0.629 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6082119941711426
Epoch: 26, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6616551876068115
Epoch: 27, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.623 Vali Acc: 0.831 Test Loss: 0.623 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7020590305328369
Epoch: 28, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.631 Vali Acc: 0.838 Test Loss: 0.631 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.684821605682373
Epoch: 29, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.641 Vali Acc: 0.841 Test Loss: 0.641 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7144424915313721
Epoch: 30, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.667 Vali Acc: 0.831 Test Loss: 0.667 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5885987281799316
Epoch: 31, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7301115989685059
Epoch: 32, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.682 Vali Acc: 0.841 Test Loss: 0.682 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8362712860107422
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.691 Vali Acc: 0.841 Test Loss: 0.691 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8265242576599121
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.696 Vali Acc: 0.847 Test Loss: 0.696 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846868).  Saving model ...
Epoch: 35 cost time: 0.8598315715789795
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.709 Vali Acc: 0.847 Test Loss: 0.709 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7841544151306152
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.725 Vali Acc: 0.847 Test Loss: 0.725 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6604251861572266
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.740 Vali Acc: 0.841 Test Loss: 0.740 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6649684906005859
Epoch: 38, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.841 Test Loss: 0.747 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7380154132843018
Epoch: 39, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.844 Test Loss: 0.763 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6437492370605469
Epoch: 40, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.838 Test Loss: 0.763 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6176338195800781
Epoch: 41, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.774 Vali Acc: 0.834 Test Loss: 0.774 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5759947299957275
Epoch: 42, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.841 Test Loss: 0.777 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5692245960235596
Epoch: 43, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.780 Vali Acc: 0.847 Test Loss: 0.780 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5398919582366943
Epoch: 44, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.798 Vali Acc: 0.844 Test Loss: 0.798 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 148139
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.204913377761841
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 2.094 Vali Acc: 0.250 Test Loss: 2.094 Test Acc: 0.250
Validation loss decreased (inf --> -0.249979).  Saving model ...
Epoch: 2 cost time: 0.5992255210876465
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.837 Vali Acc: 0.353 Test Loss: 1.837 Test Acc: 0.353
Validation loss decreased (-0.249979 --> -0.353107).  Saving model ...
Epoch: 3 cost time: 0.7046153545379639
Epoch: 3, Steps: 8 | Train Loss: 1.736 Vali Loss: 1.529 Vali Acc: 0.597 Test Loss: 1.529 Test Acc: 0.597
Validation loss decreased (-0.353107 --> -0.596860).  Saving model ...
Epoch: 4 cost time: 0.6911482810974121
Epoch: 4, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.232 Vali Acc: 0.734 Test Loss: 1.232 Test Acc: 0.734
Validation loss decreased (-0.596860 --> -0.734363).  Saving model ...
Epoch: 5 cost time: 0.7979321479797363
Epoch: 5, Steps: 8 | Train Loss: 1.089 Vali Loss: 0.982 Vali Acc: 0.787 Test Loss: 0.982 Test Acc: 0.787
Validation loss decreased (-0.734363 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.6962430477142334
Epoch: 6, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.811 Vali Acc: 0.784 Test Loss: 0.811 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7000930309295654
Epoch: 7, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.693 Vali Acc: 0.816 Test Loss: 0.693 Test Acc: 0.816
Validation loss decreased (-0.787490 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 0.5588221549987793
Epoch: 8, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5651497840881348
Epoch: 9, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
Validation loss decreased (-0.815618 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 0.6299536228179932
Epoch: 10, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5821924209594727
Epoch: 11, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6618878841400146
Epoch: 12, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.7124738693237305
Epoch: 13, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.5366454124450684
Epoch: 14, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.638746976852417
Epoch: 15, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7140350341796875
Epoch: 16, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7061820030212402
Epoch: 17, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.80169677734375
Epoch: 18, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.73909592628479
Epoch: 19, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6961781978607178
Epoch: 20, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.607 Vali Acc: 0.797 Test Loss: 0.607 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.653465986251831
Epoch: 21, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6768805980682373
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6219158172607422
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 148400
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.051090717315674
Epoch: 1, Steps: 8 | Train Loss: 2.028 Vali Loss: 1.956 Vali Acc: 0.303 Test Loss: 1.956 Test Acc: 0.303
Validation loss decreased (inf --> -0.303105).  Saving model ...
Epoch: 2 cost time: 0.5674769878387451
Epoch: 2, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.716 Vali Acc: 0.503 Test Loss: 1.716 Test Acc: 0.503
Validation loss decreased (-0.303105 --> -0.503108).  Saving model ...
Epoch: 3 cost time: 0.6073966026306152
Epoch: 3, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.427 Vali Acc: 0.706 Test Loss: 1.427 Test Acc: 0.706
Validation loss decreased (-0.503108 --> -0.706236).  Saving model ...
Epoch: 4 cost time: 0.5994217395782471
Epoch: 4, Steps: 8 | Train Loss: 1.272 Vali Loss: 1.152 Vali Acc: 0.747 Test Loss: 1.152 Test Acc: 0.747
Validation loss decreased (-0.706236 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.5877673625946045
Epoch: 5, Steps: 8 | Train Loss: 1.003 Vali Loss: 0.930 Vali Acc: 0.775 Test Loss: 0.930 Test Acc: 0.775
Validation loss decreased (-0.746863 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.5840179920196533
Epoch: 6, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.777 Vali Acc: 0.797 Test Loss: 0.777 Test Acc: 0.797
Validation loss decreased (-0.774991 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.648963451385498
Epoch: 7, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.595707893371582
Epoch: 8, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
Validation loss decreased (-0.806243 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.5832505226135254
Epoch: 9, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 0.7752971649169922
Epoch: 10, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.5862534046173096
Epoch: 11, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7320547103881836
Epoch: 12, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6566250324249268
Epoch: 13, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6487424373626709
Epoch: 14, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6572549343109131
Epoch: 15, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6773412227630615
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.840094804763794
Epoch: 17, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7730536460876465
Epoch: 18, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6401684284210205
Epoch: 19, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5810256004333496
Epoch: 20, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 148035
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.966742753982544
Epoch: 1, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.790 Vali Acc: 0.359 Test Loss: 1.790 Test Acc: 0.359
Validation loss decreased (inf --> -0.359357).  Saving model ...
Epoch: 2 cost time: 0.8085293769836426
Epoch: 2, Steps: 8 | Train Loss: 1.730 Vali Loss: 1.562 Vali Acc: 0.637 Test Loss: 1.562 Test Acc: 0.637
Validation loss decreased (-0.359357 --> -0.637484).  Saving model ...
Epoch: 3 cost time: 0.6334681510925293
Epoch: 3, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.302 Vali Acc: 0.778 Test Loss: 1.302 Test Acc: 0.778
Validation loss decreased (-0.637484 --> -0.778112).  Saving model ...
Epoch: 4 cost time: 0.6259591579437256
Epoch: 4, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.054 Vali Acc: 0.812 Test Loss: 1.054 Test Acc: 0.812
Validation loss decreased (-0.778112 --> -0.812489).  Saving model ...
Epoch: 5 cost time: 0.6310675144195557
Epoch: 5, Steps: 8 | Train Loss: 0.940 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6643764972686768
Epoch: 6, Steps: 8 | Train Loss: 0.754 Vali Loss: 0.731 Vali Acc: 0.806 Test Loss: 0.731 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6145648956298828
Epoch: 7, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.646 Vali Acc: 0.816 Test Loss: 0.646 Test Acc: 0.816
Validation loss decreased (-0.812489 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 0.7317619323730469
Epoch: 8, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.592 Vali Acc: 0.831 Test Loss: 0.592 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 0.590247392654419
Epoch: 9, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 0.6546440124511719
Epoch: 10, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.6650495529174805
Epoch: 11, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.7428534030914307
Epoch: 12, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.6367835998535156
Epoch: 13, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.5843203067779541
Epoch: 14, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6419789791107178
Epoch: 15, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6354987621307373
Epoch: 16, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5946846008300781
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5635912418365479
Epoch: 18, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7126500606536865
Epoch: 19, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.570 Vali Acc: 0.834 Test Loss: 0.570 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7208912372589111
Epoch: 20, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.589 Vali Acc: 0.838 Test Loss: 0.589 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6341531276702881
Epoch: 21, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.598 Vali Acc: 0.834 Test Loss: 0.598 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5470716953277588
Epoch: 22, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.618 Vali Acc: 0.831 Test Loss: 0.618 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6155767440795898
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.626 Vali Acc: 0.834 Test Loss: 0.626 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 147044
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1629106998443604
Epoch: 1, Steps: 8 | Train Loss: 2.198 Vali Loss: 2.120 Vali Acc: 0.100 Test Loss: 2.120 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 0.5391595363616943
Epoch: 2, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.868 Vali Acc: 0.381 Test Loss: 1.868 Test Acc: 0.381
Validation loss decreased (-0.099979 --> -0.381231).  Saving model ...
Epoch: 3 cost time: 0.5727698802947998
Epoch: 3, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.562 Vali Acc: 0.619 Test Loss: 1.562 Test Acc: 0.619
Validation loss decreased (-0.381231 --> -0.618734).  Saving model ...
Epoch: 4 cost time: 0.6258881092071533
Epoch: 4, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.267 Vali Acc: 0.716 Test Loss: 1.267 Test Acc: 0.716
Validation loss decreased (-0.618734 --> -0.715612).  Saving model ...
Epoch: 5 cost time: 0.6218094825744629
Epoch: 5, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.019 Vali Acc: 0.784 Test Loss: 1.019 Test Acc: 0.784
Validation loss decreased (-0.715612 --> -0.784365).  Saving model ...
Epoch: 6 cost time: 0.5879569053649902
Epoch: 6, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.825 Vali Acc: 0.797 Test Loss: 0.825 Test Acc: 0.797
Validation loss decreased (-0.784365 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.618985652923584
Epoch: 7, Steps: 8 | Train Loss: 0.699 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
Validation loss decreased (-0.796867 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 0.6005921363830566
Epoch: 8, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.7626996040344238
Epoch: 9, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.585 Vali Acc: 0.834 Test Loss: 0.585 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.6506357192993164
Epoch: 10, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.7634413242340088
Epoch: 11, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.6417880058288574
Epoch: 12, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6126425266265869
Epoch: 13, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.6252467632293701
Epoch: 14, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5771565437316895
Epoch: 15, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6422278881072998
Epoch: 16, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8210222721099854
Epoch: 17, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6180436611175537
Epoch: 18, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6620349884033203
Epoch: 19, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.542776346206665
Epoch: 20, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6000027656555176
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5930330753326416
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.612565279006958
Epoch: 23, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.615 Vali Acc: 0.834 Test Loss: 0.615 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 145427
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.813852310180664
Epoch: 1, Steps: 8 | Train Loss: 2.163 Vali Loss: 2.084 Vali Acc: 0.119 Test Loss: 2.084 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 0.5737519264221191
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.829 Vali Acc: 0.344 Test Loss: 1.829 Test Acc: 0.344
Validation loss decreased (-0.118729 --> -0.343732).  Saving model ...
Epoch: 3 cost time: 0.6276023387908936
Epoch: 3, Steps: 8 | Train Loss: 1.689 Vali Loss: 1.529 Vali Acc: 0.584 Test Loss: 1.529 Test Acc: 0.584
Validation loss decreased (-0.343732 --> -0.584360).  Saving model ...
Epoch: 4 cost time: 0.579655647277832
Epoch: 4, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.238 Vali Acc: 0.713 Test Loss: 1.238 Test Acc: 0.713
Validation loss decreased (-0.584360 --> -0.712488).  Saving model ...
Epoch: 5 cost time: 0.6747760772705078
Epoch: 5, Steps: 8 | Train Loss: 1.064 Vali Loss: 1.000 Vali Acc: 0.753 Test Loss: 1.000 Test Acc: 0.753
Validation loss decreased (-0.712488 --> -0.753115).  Saving model ...
Epoch: 6 cost time: 0.5999233722686768
Epoch: 6, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.753115 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.6581485271453857
Epoch: 7, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.670635461807251
Epoch: 8, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.607166051864624
Epoch: 9, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.6187167167663574
Epoch: 10, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6289021968841553
Epoch: 11, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 12 cost time: 0.6552879810333252
Epoch: 12, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7778692245483398
Epoch: 13, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.677278995513916
Epoch: 14, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6238596439361572
Epoch: 15, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6501264572143555
Epoch: 16, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.544234037399292
Epoch: 17, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5613815784454346
Epoch: 18, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.578 Vali Acc: 0.834 Test Loss: 0.578 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6266419887542725
Epoch: 19, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6157958507537842
Epoch: 20, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5747954845428467
Epoch: 21, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 129288
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0856001377105713
Epoch: 1, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.921 Vali Acc: 0.316 Test Loss: 1.921 Test Acc: 0.316
Validation loss decreased (inf --> -0.315606).  Saving model ...
Epoch: 2 cost time: 0.640089750289917
Epoch: 2, Steps: 8 | Train Loss: 1.869 Vali Loss: 1.700 Vali Acc: 0.463 Test Loss: 1.700 Test Acc: 0.463
Validation loss decreased (-0.315606 --> -0.462483).  Saving model ...
Epoch: 3 cost time: 0.628429651260376
Epoch: 3, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.424 Vali Acc: 0.619 Test Loss: 1.424 Test Acc: 0.619
Validation loss decreased (-0.462483 --> -0.618736).  Saving model ...
Epoch: 4 cost time: 0.618699312210083
Epoch: 4, Steps: 8 | Train Loss: 1.275 Vali Loss: 1.162 Vali Acc: 0.769 Test Loss: 1.162 Test Acc: 0.769
Validation loss decreased (-0.618736 --> -0.768738).  Saving model ...
Epoch: 5 cost time: 0.6303303241729736
Epoch: 5, Steps: 8 | Train Loss: 1.048 Vali Loss: 0.941 Vali Acc: 0.794 Test Loss: 0.941 Test Acc: 0.794
Validation loss decreased (-0.768738 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 0.5525434017181396
Epoch: 6, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
Validation loss decreased (-0.793741 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.58182692527771
Epoch: 7, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 0.7062890529632568
Epoch: 8, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.666273832321167
Epoch: 9, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.5797767639160156
Epoch: 10, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.5576992034912109
Epoch: 11, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.7868955135345459
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 0.5974609851837158
Epoch: 13, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.727508544921875
Epoch: 14, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6086359024047852
Epoch: 15, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.540982723236084
Epoch: 16, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6376924514770508
Epoch: 17, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6664638519287109
Epoch: 18, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5650670528411865
Epoch: 19, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5693774223327637
Epoch: 20, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.591 Vali Acc: 0.831 Test Loss: 0.591 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6013715267181396
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6318104267120361
Epoch: 22, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 125595
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.989124059677124
Epoch: 1, Steps: 8 | Train Loss: 2.056 Vali Loss: 1.972 Vali Acc: 0.219 Test Loss: 1.972 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.6787033081054688
Epoch: 2, Steps: 8 | Train Loss: 1.881 Vali Loss: 1.741 Vali Acc: 0.428 Test Loss: 1.741 Test Acc: 0.428
Validation loss decreased (-0.218730 --> -0.428108).  Saving model ...
Epoch: 3 cost time: 0.5666599273681641
Epoch: 3, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.460 Vali Acc: 0.703 Test Loss: 1.460 Test Acc: 0.703
Validation loss decreased (-0.428108 --> -0.703110).  Saving model ...
Epoch: 4 cost time: 0.5343668460845947
Epoch: 4, Steps: 8 | Train Loss: 1.316 Vali Loss: 1.182 Vali Acc: 0.778 Test Loss: 1.182 Test Acc: 0.778
Validation loss decreased (-0.703110 --> -0.778113).  Saving model ...
Epoch: 5 cost time: 0.45685482025146484
Epoch: 5, Steps: 8 | Train Loss: 1.023 Vali Loss: 0.946 Vali Acc: 0.794 Test Loss: 0.946 Test Acc: 0.794
Validation loss decreased (-0.778113 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 0.4822065830230713
Epoch: 6, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.792 Vali Acc: 0.794 Test Loss: 0.792 Test Acc: 0.794
Validation loss decreased (-0.793741 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.6119105815887451
Epoch: 7, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.689 Vali Acc: 0.797 Test Loss: 0.689 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.6486074924468994
Epoch: 8, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.535102367401123
Epoch: 9, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5633411407470703
Epoch: 10, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 0.5320124626159668
Epoch: 11, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 0.8530807495117188
Epoch: 12, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.578784704208374
Epoch: 13, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.63954758644104
Epoch: 14, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6420533657073975
Epoch: 15, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7220122814178467
Epoch: 16, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6417853832244873
Epoch: 17, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7245094776153564
Epoch: 18, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.764298677444458
Epoch: 19, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.721987247467041
Epoch: 20, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6821792125701904
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5874602794647217
Epoch: 22, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.618 Vali Acc: 0.812 Test Loss: 0.618 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 124264
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.181215524673462
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 2.045 Vali Acc: 0.191 Test Loss: 2.045 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 0.709810733795166
Epoch: 2, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.793 Vali Acc: 0.406 Test Loss: 1.793 Test Acc: 0.406
Validation loss decreased (-0.190605 --> -0.406232).  Saving model ...
Epoch: 3 cost time: 0.6296200752258301
Epoch: 3, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.489 Vali Acc: 0.581 Test Loss: 1.489 Test Acc: 0.581
Validation loss decreased (-0.406232 --> -0.581235).  Saving model ...
Epoch: 4 cost time: 0.7189798355102539
Epoch: 4, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.191 Vali Acc: 0.728 Test Loss: 1.191 Test Acc: 0.728
Validation loss decreased (-0.581235 --> -0.728113).  Saving model ...
Epoch: 5 cost time: 0.6307179927825928
Epoch: 5, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.948 Vali Acc: 0.766 Test Loss: 0.948 Test Acc: 0.766
Validation loss decreased (-0.728113 --> -0.765616).  Saving model ...
Epoch: 6 cost time: 0.6231098175048828
Epoch: 6, Steps: 8 | Train Loss: 0.776 Vali Loss: 0.787 Vali Acc: 0.784 Test Loss: 0.787 Test Acc: 0.784
Validation loss decreased (-0.765616 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.7275171279907227
Epoch: 7, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.683 Vali Acc: 0.791 Test Loss: 0.683 Test Acc: 0.791
Validation loss decreased (-0.784367 --> -0.790618).  Saving model ...
Epoch: 8 cost time: 0.6311283111572266
Epoch: 8, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.636 Vali Acc: 0.800 Test Loss: 0.636 Test Acc: 0.800
Validation loss decreased (-0.790618 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 0.6552238464355469
Epoch: 9, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.600 Vali Acc: 0.806 Test Loss: 0.600 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.6812953948974609
Epoch: 10, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.5823743343353271
Epoch: 11, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.6909925937652588
Epoch: 12, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6150972843170166
Epoch: 13, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 0.6556308269500732
Epoch: 14, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6053810119628906
Epoch: 15, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6541726589202881
Epoch: 16, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5826716423034668
Epoch: 17, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7319021224975586
Epoch: 18, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.662994384765625
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.615 Vali Acc: 0.816 Test Loss: 0.615 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6351771354675293
Epoch: 20, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5965597629547119
Epoch: 21, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6865184307098389
Epoch: 22, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.66640305519104
Epoch: 23, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.658 Vali Acc: 0.812 Test Loss: 0.658 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 122947
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8606014251708984
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 2.073 Vali Acc: 0.237 Test Loss: 2.073 Test Acc: 0.237
Validation loss decreased (inf --> -0.237479).  Saving model ...
Epoch: 2 cost time: 0.6541762351989746
Epoch: 2, Steps: 8 | Train Loss: 1.985 Vali Loss: 1.833 Vali Acc: 0.366 Test Loss: 1.833 Test Acc: 0.366
Validation loss decreased (-0.237479 --> -0.365607).  Saving model ...
Epoch: 3 cost time: 0.6208128929138184
Epoch: 3, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.530 Vali Acc: 0.512 Test Loss: 1.530 Test Acc: 0.512
Validation loss decreased (-0.365607 --> -0.512485).  Saving model ...
Epoch: 4 cost time: 0.5528812408447266
Epoch: 4, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.241 Vali Acc: 0.697 Test Loss: 1.241 Test Acc: 0.697
Validation loss decreased (-0.512485 --> -0.696863).  Saving model ...
Epoch: 5 cost time: 0.530867338180542
Epoch: 5, Steps: 8 | Train Loss: 1.094 Vali Loss: 0.992 Vali Acc: 0.781 Test Loss: 0.992 Test Acc: 0.781
Validation loss decreased (-0.696863 --> -0.781240).  Saving model ...
Epoch: 6 cost time: 0.6361973285675049
Epoch: 6, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.814 Vali Acc: 0.794 Test Loss: 0.814 Test Acc: 0.794
Validation loss decreased (-0.781240 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.6682453155517578
Epoch: 7, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.700 Vali Acc: 0.812 Test Loss: 0.700 Test Acc: 0.812
Validation loss decreased (-0.793742 --> -0.812493).  Saving model ...
Epoch: 8 cost time: 0.5870976448059082
Epoch: 8, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.5860762596130371
Epoch: 9, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.6899905204772949
Epoch: 10, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6267440319061279
Epoch: 11, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.5879600048065186
Epoch: 12, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.76914381980896
Epoch: 13, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.754279613494873
Epoch: 14, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.6293129920959473
Epoch: 15, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6355545520782471
Epoch: 16, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6091725826263428
Epoch: 17, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6770181655883789
Epoch: 18, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6838955879211426
Epoch: 19, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.641730785369873
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7045316696166992
Epoch: 21, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.589 Vali Acc: 0.828 Test Loss: 0.589 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.645005464553833
Epoch: 22, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6111328601837158
Epoch: 23, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6683757305145264
Epoch: 24, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 123278
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3616418838500977
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 2.086 Vali Acc: 0.184 Test Loss: 2.086 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 0.6848239898681641
Epoch: 2, Steps: 8 | Train Loss: 1.976 Vali Loss: 1.824 Vali Acc: 0.341 Test Loss: 1.824 Test Acc: 0.341
Validation loss decreased (-0.184354 --> -0.340607).  Saving model ...
Epoch: 3 cost time: 0.672945499420166
Epoch: 3, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.506 Vali Acc: 0.637 Test Loss: 1.506 Test Acc: 0.637
Validation loss decreased (-0.340607 --> -0.637485).  Saving model ...
Epoch: 4 cost time: 0.8204226493835449
Epoch: 4, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.207 Vali Acc: 0.759 Test Loss: 1.207 Test Acc: 0.759
Validation loss decreased (-0.637485 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.6812727451324463
Epoch: 5, Steps: 8 | Train Loss: 1.025 Vali Loss: 0.965 Vali Acc: 0.766 Test Loss: 0.965 Test Acc: 0.766
Validation loss decreased (-0.759363 --> -0.765615).  Saving model ...
Epoch: 6 cost time: 0.6928451061248779
Epoch: 6, Steps: 8 | Train Loss: 0.807 Vali Loss: 0.800 Vali Acc: 0.778 Test Loss: 0.800 Test Acc: 0.778
Validation loss decreased (-0.765615 --> -0.778117).  Saving model ...
Epoch: 7 cost time: 0.6737518310546875
Epoch: 7, Steps: 8 | Train Loss: 0.667 Vali Loss: 0.699 Vali Acc: 0.784 Test Loss: 0.699 Test Acc: 0.784
Validation loss decreased (-0.778117 --> -0.784368).  Saving model ...
Epoch: 8 cost time: 0.6182506084442139
Epoch: 8, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
Validation loss decreased (-0.784368 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.645942211151123
Epoch: 9, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.589 Vali Acc: 0.806 Test Loss: 0.589 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.5178523063659668
Epoch: 10, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.6049106121063232
Epoch: 11, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.5715851783752441
Epoch: 12, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6318662166595459
Epoch: 13, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5798382759094238
Epoch: 14, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 0.5883729457855225
Epoch: 15, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5625040531158447
Epoch: 16, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.583 Vali Acc: 0.831 Test Loss: 0.583 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6781821250915527
Epoch: 17, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5739634037017822
Epoch: 18, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8376188278198242
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7319180965423584
Epoch: 20, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.634 Vali Acc: 0.806 Test Loss: 0.634 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6958563327789307
Epoch: 21, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6210238933563232
Epoch: 22, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8260610103607178
Epoch: 23, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.659 Vali Acc: 0.806 Test Loss: 0.659 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6618764400482178
Epoch: 24, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 121851
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0828115940093994
Epoch: 1, Steps: 8 | Train Loss: 2.063 Vali Loss: 1.968 Vali Acc: 0.241 Test Loss: 1.968 Test Acc: 0.241
Validation loss decreased (inf --> -0.240605).  Saving model ...
Epoch: 2 cost time: 0.5887181758880615
Epoch: 2, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.738 Vali Acc: 0.394 Test Loss: 1.738 Test Acc: 0.394
Validation loss decreased (-0.240605 --> -0.393733).  Saving model ...
Epoch: 3 cost time: 0.5960867404937744
Epoch: 3, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.450 Vali Acc: 0.641 Test Loss: 1.450 Test Acc: 0.641
Validation loss decreased (-0.393733 --> -0.640610).  Saving model ...
Epoch: 4 cost time: 0.9103705883026123
Epoch: 4, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.184 Vali Acc: 0.734 Test Loss: 1.184 Test Acc: 0.734
Validation loss decreased (-0.640610 --> -0.734363).  Saving model ...
Epoch: 5 cost time: 0.6865034103393555
Epoch: 5, Steps: 8 | Train Loss: 1.027 Vali Loss: 0.951 Vali Acc: 0.772 Test Loss: 0.951 Test Acc: 0.772
Validation loss decreased (-0.734363 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.5644526481628418
Epoch: 6, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.802 Vali Acc: 0.791 Test Loss: 0.802 Test Acc: 0.791
Validation loss decreased (-0.771865 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 0.6163573265075684
Epoch: 7, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.716 Vali Acc: 0.794 Test Loss: 0.716 Test Acc: 0.794
Validation loss decreased (-0.790617 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.6063060760498047
Epoch: 8, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.793743 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.6478307247161865
Epoch: 9, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.5900673866271973
Epoch: 10, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.6601088047027588
Epoch: 11, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5341646671295166
Epoch: 12, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6733283996582031
Epoch: 13, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7010319232940674
Epoch: 14, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 15 cost time: 0.6938979625701904
Epoch: 15, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6646456718444824
Epoch: 16, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7755048274993896
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6578636169433594
Epoch: 18, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6493673324584961
Epoch: 19, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5630631446838379
Epoch: 20, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6455678939819336
Epoch: 21, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.605 Vali Acc: 0.812 Test Loss: 0.605 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5443680286407471
Epoch: 22, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.619 Vali Acc: 0.812 Test Loss: 0.619 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.608750581741333
Epoch: 23, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5853569507598877
Epoch: 24, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 123140
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7371723651885986
Epoch: 1, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.894 Vali Acc: 0.319 Test Loss: 1.894 Test Acc: 0.319
Validation loss decreased (inf --> -0.318731).  Saving model ...
Epoch: 2 cost time: 0.5291941165924072
Epoch: 2, Steps: 8 | Train Loss: 1.819 Vali Loss: 1.665 Vali Acc: 0.550 Test Loss: 1.665 Test Acc: 0.550
Validation loss decreased (-0.318731 --> -0.549983).  Saving model ...
Epoch: 3 cost time: 0.6644737720489502
Epoch: 3, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.390 Vali Acc: 0.675 Test Loss: 1.390 Test Acc: 0.675
Validation loss decreased (-0.549983 --> -0.674986).  Saving model ...
Epoch: 4 cost time: 0.5893568992614746
Epoch: 4, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.126 Vali Acc: 0.753 Test Loss: 1.126 Test Acc: 0.753
Validation loss decreased (-0.674986 --> -0.753114).  Saving model ...
Epoch: 5 cost time: 0.5785722732543945
Epoch: 5, Steps: 8 | Train Loss: 0.975 Vali Loss: 0.914 Vali Acc: 0.772 Test Loss: 0.914 Test Acc: 0.772
Validation loss decreased (-0.753114 --> -0.771866).  Saving model ...
Epoch: 6 cost time: 0.5471117496490479
Epoch: 6, Steps: 8 | Train Loss: 0.785 Vali Loss: 0.757 Vali Acc: 0.797 Test Loss: 0.757 Test Acc: 0.797
Validation loss decreased (-0.771866 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.6872758865356445
Epoch: 7, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.659 Vali Acc: 0.812 Test Loss: 0.659 Test Acc: 0.812
Validation loss decreased (-0.796867 --> -0.812493).  Saving model ...
Epoch: 8 cost time: 0.5245265960693359
Epoch: 8, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.60489821434021
Epoch: 9, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.5571560859680176
Epoch: 10, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 0.5088808536529541
Epoch: 11, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.5909428596496582
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5406768321990967
Epoch: 13, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.543710470199585
Epoch: 14, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 0.45546460151672363
Epoch: 15, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5255522727966309
Epoch: 16, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5730011463165283
Epoch: 17, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5496430397033691
Epoch: 18, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.576545000076294
Epoch: 19, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5393047332763672
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5440266132354736
Epoch: 21, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5019533634185791
Epoch: 22, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.636 Vali Acc: 0.825 Test Loss: 0.636 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6610825061798096
Epoch: 23, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6326773166656494
Epoch: 24, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.667 Vali Acc: 0.816 Test Loss: 0.667 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 121283
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.735548496246338
Epoch: 1, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.925 Vali Acc: 0.291 Test Loss: 1.925 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 0.6036009788513184
Epoch: 2, Steps: 8 | Train Loss: 1.820 Vali Loss: 1.696 Vali Acc: 0.566 Test Loss: 1.696 Test Acc: 0.566
Validation loss decreased (-0.290606 --> -0.565608).  Saving model ...
Epoch: 3 cost time: 0.6429986953735352
Epoch: 3, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.423 Vali Acc: 0.703 Test Loss: 1.423 Test Acc: 0.703
Validation loss decreased (-0.565608 --> -0.703111).  Saving model ...
Epoch: 4 cost time: 0.5772194862365723
Epoch: 4, Steps: 8 | Train Loss: 1.282 Vali Loss: 1.152 Vali Acc: 0.762 Test Loss: 1.152 Test Acc: 0.762
Validation loss decreased (-0.703111 --> -0.762488).  Saving model ...
Epoch: 5 cost time: 0.6758143901824951
Epoch: 5, Steps: 8 | Train Loss: 0.995 Vali Loss: 0.940 Vali Acc: 0.791 Test Loss: 0.940 Test Acc: 0.791
Validation loss decreased (-0.762488 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 0.5625460147857666
Epoch: 6, Steps: 8 | Train Loss: 0.817 Vali Loss: 0.789 Vali Acc: 0.797 Test Loss: 0.789 Test Acc: 0.797
Validation loss decreased (-0.790616 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.6222751140594482
Epoch: 7, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.691 Vali Acc: 0.797 Test Loss: 0.691 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.6475403308868408
Epoch: 8, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.862260103225708
Epoch: 9, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.6315617561340332
Epoch: 10, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
Validation loss decreased (-0.815619 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.7758266925811768
Epoch: 11, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.556 Vali Acc: 0.834 Test Loss: 0.556 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6693882942199707
Epoch: 12, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5895488262176514
Epoch: 13, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.5951948165893555
Epoch: 14, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.704688549041748
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.764146089553833
Epoch: 16, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6649119853973389
Epoch: 17, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6032974720001221
Epoch: 18, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7388784885406494
Epoch: 19, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6636142730712891
Epoch: 20, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6709444522857666
Epoch: 21, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6087079048156738
Epoch: 22, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5167098045349121
Epoch: 23, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 122708
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4248342514038086
Epoch: 1, Steps: 8 | Train Loss: 2.110 Vali Loss: 2.063 Vali Acc: 0.219 Test Loss: 2.063 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 0.6920702457427979
Epoch: 2, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.809 Vali Acc: 0.431 Test Loss: 1.809 Test Acc: 0.431
Validation loss decreased (-0.218729 --> -0.431232).  Saving model ...
Epoch: 3 cost time: 0.5950193405151367
Epoch: 3, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.491 Vali Acc: 0.694 Test Loss: 1.491 Test Acc: 0.694
Validation loss decreased (-0.431232 --> -0.693735).  Saving model ...
Epoch: 4 cost time: 0.646489143371582
Epoch: 4, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.190 Vali Acc: 0.766 Test Loss: 1.190 Test Acc: 0.766
Validation loss decreased (-0.693735 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.5580825805664062
Epoch: 5, Steps: 8 | Train Loss: 1.005 Vali Loss: 0.949 Vali Acc: 0.787 Test Loss: 0.949 Test Acc: 0.787
Validation loss decreased (-0.765613 --> -0.787491).  Saving model ...
Epoch: 6 cost time: 0.603508472442627
Epoch: 6, Steps: 8 | Train Loss: 0.819 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
Validation loss decreased (-0.787491 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.6517271995544434
Epoch: 7, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5817291736602783
Epoch: 8, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.6859884262084961
Epoch: 9, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 10 cost time: 0.5918023586273193
Epoch: 10, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
Validation loss decreased (-0.803119 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.5547444820404053
Epoch: 11, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.6589882373809814
Epoch: 12, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 13 cost time: 0.6075201034545898
Epoch: 13, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 0.5718393325805664
Epoch: 14, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6052947044372559
Epoch: 15, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 0.665034294128418
Epoch: 16, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 17 cost time: 0.6654348373413086
Epoch: 17, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.693995475769043
Epoch: 18, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.581 Vali Acc: 0.825 Test Loss: 0.581 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5859084129333496
Epoch: 19, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5692803859710693
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.719963550567627
Epoch: 21, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6108736991882324
Epoch: 22, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6936252117156982
Epoch: 23, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.632 Vali Acc: 0.816 Test Loss: 0.632 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.633575439453125
Epoch: 24, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5969281196594238
Epoch: 25, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.619593620300293
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 122247
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6356873512268066
Epoch: 1, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.972 Vali Acc: 0.244 Test Loss: 1.972 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 0.5839178562164307
Epoch: 2, Steps: 8 | Train Loss: 1.883 Vali Loss: 1.733 Vali Acc: 0.500 Test Loss: 1.733 Test Acc: 0.500
Validation loss decreased (-0.243730 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 0.6015570163726807
Epoch: 3, Steps: 8 | Train Loss: 1.595 Vali Loss: 1.450 Vali Acc: 0.694 Test Loss: 1.450 Test Acc: 0.694
Validation loss decreased (-0.499983 --> -0.693735).  Saving model ...
Epoch: 4 cost time: 0.6541333198547363
Epoch: 4, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.169 Vali Acc: 0.766 Test Loss: 1.169 Test Acc: 0.766
Validation loss decreased (-0.693735 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.5917835235595703
Epoch: 5, Steps: 8 | Train Loss: 0.991 Vali Loss: 0.952 Vali Acc: 0.778 Test Loss: 0.952 Test Acc: 0.778
Validation loss decreased (-0.765613 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.9248859882354736
Epoch: 6, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.789 Vali Acc: 0.787 Test Loss: 0.789 Test Acc: 0.787
Validation loss decreased (-0.778115 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.8023767471313477
Epoch: 7, Steps: 8 | Train Loss: 0.639 Vali Loss: 0.681 Vali Acc: 0.794 Test Loss: 0.681 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.6706621646881104
Epoch: 8, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.626 Vali Acc: 0.797 Test Loss: 0.626 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796869).  Saving model ...
Epoch: 9 cost time: 0.6024169921875
Epoch: 9, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.590 Vali Acc: 0.806 Test Loss: 0.590 Test Acc: 0.806
Validation loss decreased (-0.796869 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.7252306938171387
Epoch: 10, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.579 Vali Acc: 0.806 Test Loss: 0.579 Test Acc: 0.806
Validation loss decreased (-0.806244 --> -0.806244).  Saving model ...
Epoch: 11 cost time: 0.686511754989624
Epoch: 11, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.6620244979858398
Epoch: 12, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7725925445556641
Epoch: 13, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5722396373748779
Epoch: 14, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 0.6754934787750244
Epoch: 15, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6910860538482666
Epoch: 16, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7361946105957031
Epoch: 17, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6682074069976807
Epoch: 18, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6884019374847412
Epoch: 19, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6582221984863281
Epoch: 20, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6262359619140625
Epoch: 21, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.610 Vali Acc: 0.809 Test Loss: 0.610 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5951247215270996
Epoch: 22, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.633 Vali Acc: 0.806 Test Loss: 0.633 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6725645065307617
Epoch: 23, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.651 Vali Acc: 0.809 Test Loss: 0.651 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5223116874694824
Epoch: 24, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.660 Vali Acc: 0.806 Test Loss: 0.660 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 123744
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9988420009613037
Epoch: 1, Steps: 8 | Train Loss: 2.207 Vali Loss: 2.148 Vali Acc: 0.084 Test Loss: 2.148 Test Acc: 0.084
Validation loss decreased (inf --> -0.084354).  Saving model ...
Epoch: 2 cost time: 0.5384299755096436
Epoch: 2, Steps: 8 | Train Loss: 1.994 Vali Loss: 1.881 Vali Acc: 0.303 Test Loss: 1.881 Test Acc: 0.303
Validation loss decreased (-0.084354 --> -0.303106).  Saving model ...
Epoch: 3 cost time: 0.6103494167327881
Epoch: 3, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.563 Vali Acc: 0.613 Test Loss: 1.563 Test Acc: 0.613
Validation loss decreased (-0.303106 --> -0.612484).  Saving model ...
Epoch: 4 cost time: 0.5453214645385742
Epoch: 4, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.248 Vali Acc: 0.728 Test Loss: 1.248 Test Acc: 0.728
Validation loss decreased (-0.612484 --> -0.728113).  Saving model ...
Epoch: 5 cost time: 0.6776812076568604
Epoch: 5, Steps: 8 | Train Loss: 1.058 Vali Loss: 0.995 Vali Acc: 0.787 Test Loss: 0.995 Test Acc: 0.787
Validation loss decreased (-0.728113 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.797417163848877
Epoch: 6, Steps: 8 | Train Loss: 0.827 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.787490 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.7310895919799805
Epoch: 7, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.7193429470062256
Epoch: 8, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.7535221576690674
Epoch: 9, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.6395559310913086
Epoch: 10, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.5725269317626953
Epoch: 11, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837494).  Saving model ...
Epoch: 12 cost time: 0.6509697437286377
Epoch: 12, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6986734867095947
Epoch: 13, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6354341506958008
Epoch: 14, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6298408508300781
Epoch: 15, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 16 cost time: 0.6669349670410156
Epoch: 16, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6899838447570801
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8294050693511963
Epoch: 18, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8006889820098877
Epoch: 19, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6450533866882324
Epoch: 20, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7624845504760742
Epoch: 21, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.605 Vali Acc: 0.825 Test Loss: 0.605 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6997590065002441
Epoch: 22, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.620 Vali Acc: 0.816 Test Loss: 0.620 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7261800765991211
Epoch: 23, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.649 Vali Acc: 0.806 Test Loss: 0.649 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5929417610168457
Epoch: 24, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6024782657623291
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 123985
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9027128219604492
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.020 Vali Acc: 0.188 Test Loss: 2.020 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 0.6301479339599609
Epoch: 2, Steps: 8 | Train Loss: 1.918 Vali Loss: 1.775 Vali Acc: 0.444 Test Loss: 1.775 Test Acc: 0.444
Validation loss decreased (-0.187480 --> -0.443732).  Saving model ...
Epoch: 3 cost time: 0.5848989486694336
Epoch: 3, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.472 Vali Acc: 0.688 Test Loss: 1.472 Test Acc: 0.688
Validation loss decreased (-0.443732 --> -0.687485).  Saving model ...
Epoch: 4 cost time: 0.48351049423217773
Epoch: 4, Steps: 8 | Train Loss: 1.324 Vali Loss: 1.182 Vali Acc: 0.766 Test Loss: 1.182 Test Acc: 0.766
Validation loss decreased (-0.687485 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.49016666412353516
Epoch: 5, Steps: 8 | Train Loss: 1.047 Vali Loss: 0.954 Vali Acc: 0.791 Test Loss: 0.954 Test Acc: 0.791
Validation loss decreased (-0.765613 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 0.6008107662200928
Epoch: 6, Steps: 8 | Train Loss: 0.846 Vali Loss: 0.800 Vali Acc: 0.803 Test Loss: 0.800 Test Acc: 0.803
Validation loss decreased (-0.790615 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.5933408737182617
Epoch: 7, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.7746193408966064
Epoch: 8, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.639 Vali Acc: 0.806 Test Loss: 0.639 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.5449278354644775
Epoch: 9, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.5861091613769531
Epoch: 10, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6165452003479004
Epoch: 11, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7389280796051025
Epoch: 12, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7505655288696289
Epoch: 13, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7199461460113525
Epoch: 14, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.7057576179504395
Epoch: 15, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7074260711669922
Epoch: 16, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 0.6393980979919434
Epoch: 17, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 18 cost time: 0.6860692501068115
Epoch: 18, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6903116703033447
Epoch: 19, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.599 Vali Acc: 0.812 Test Loss: 0.599 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6606850624084473
Epoch: 20, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5712556838989258
Epoch: 21, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6501309871673584
Epoch: 22, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.615 Vali Acc: 0.819 Test Loss: 0.615 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6536855697631836
Epoch: 23, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6628379821777344
Epoch: 24, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.627648115158081
Epoch: 25, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6481640338897705
Epoch: 26, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6352362632751465
Epoch: 27, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.688 Vali Acc: 0.806 Test Loss: 0.688 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 122970
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6664996147155762
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.048 Vali Acc: 0.212 Test Loss: 2.048 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.5718405246734619
Epoch: 2, Steps: 8 | Train Loss: 1.962 Vali Loss: 1.802 Vali Acc: 0.441 Test Loss: 1.802 Test Acc: 0.441
Validation loss decreased (-0.212480 --> -0.440607).  Saving model ...
Epoch: 3 cost time: 0.5817935466766357
Epoch: 3, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.495 Vali Acc: 0.669 Test Loss: 1.495 Test Acc: 0.669
Validation loss decreased (-0.440607 --> -0.668735).  Saving model ...
Epoch: 4 cost time: 0.5568890571594238
Epoch: 4, Steps: 8 | Train Loss: 1.336 Vali Loss: 1.200 Vali Acc: 0.747 Test Loss: 1.200 Test Acc: 0.747
Validation loss decreased (-0.668735 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.6716744899749756
Epoch: 5, Steps: 8 | Train Loss: 1.061 Vali Loss: 0.964 Vali Acc: 0.784 Test Loss: 0.964 Test Acc: 0.784
Validation loss decreased (-0.746863 --> -0.784365).  Saving model ...
Epoch: 6 cost time: 0.5981254577636719
Epoch: 6, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.794 Vali Acc: 0.803 Test Loss: 0.794 Test Acc: 0.803
Validation loss decreased (-0.784365 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.6215074062347412
Epoch: 7, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.690 Vali Acc: 0.812 Test Loss: 0.690 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812493).  Saving model ...
Epoch: 8 cost time: 0.671846866607666
Epoch: 8, Steps: 8 | Train Loss: 0.598 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.6134874820709229
Epoch: 9, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5880093574523926
Epoch: 10, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 0.6072278022766113
Epoch: 11, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5364193916320801
Epoch: 12, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6023428440093994
Epoch: 13, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6300933361053467
Epoch: 14, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6521105766296387
Epoch: 15, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6558647155761719
Epoch: 16, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6250123977661133
Epoch: 17, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7652838230133057
Epoch: 18, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7276983261108398
Epoch: 19, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6624727249145508
Epoch: 20, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 120699
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.123131275177002
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 2.025 Vali Acc: 0.144 Test Loss: 2.025 Test Acc: 0.144
Validation loss decreased (inf --> -0.143730).  Saving model ...
Epoch: 2 cost time: 0.5697941780090332
Epoch: 2, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.784 Vali Acc: 0.369 Test Loss: 1.784 Test Acc: 0.369
Validation loss decreased (-0.143730 --> -0.368732).  Saving model ...
Epoch: 3 cost time: 0.7791392803192139
Epoch: 3, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.490 Vali Acc: 0.566 Test Loss: 1.490 Test Acc: 0.566
Validation loss decreased (-0.368732 --> -0.565610).  Saving model ...
Epoch: 4 cost time: 0.7151279449462891
Epoch: 4, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.208 Vali Acc: 0.716 Test Loss: 1.208 Test Acc: 0.716
Validation loss decreased (-0.565610 --> -0.715613).  Saving model ...
Epoch: 5 cost time: 0.6567583084106445
Epoch: 5, Steps: 8 | Train Loss: 1.054 Vali Loss: 0.974 Vali Acc: 0.762 Test Loss: 0.974 Test Acc: 0.762
Validation loss decreased (-0.715613 --> -0.762490).  Saving model ...
Epoch: 6 cost time: 0.6973862648010254
Epoch: 6, Steps: 8 | Train Loss: 0.862 Vali Loss: 0.816 Vali Acc: 0.787 Test Loss: 0.816 Test Acc: 0.787
Validation loss decreased (-0.762490 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.594233512878418
Epoch: 7, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.702 Vali Acc: 0.794 Test Loss: 0.702 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.6067521572113037
Epoch: 8, Steps: 8 | Train Loss: 0.595 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.6187868118286133
Epoch: 9, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.5667798519134521
Epoch: 10, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 0.5452697277069092
Epoch: 11, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
Validation loss decreased (-0.812494 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.4910762310028076
Epoch: 12, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 0.4870178699493408
Epoch: 13, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5252811908721924
Epoch: 14, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5356788635253906
Epoch: 15, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5439717769622803
Epoch: 16, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.49367260932922363
Epoch: 17, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5353457927703857
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.596 Vali Acc: 0.812 Test Loss: 0.596 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5450363159179688
Epoch: 19, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.521662712097168
Epoch: 20, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5670177936553955
Epoch: 21, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4712181091308594
Epoch: 22, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.634 Vali Acc: 0.806 Test Loss: 0.634 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 122276
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.995607614517212
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 2.047 Vali Acc: 0.150 Test Loss: 2.047 Test Acc: 0.150
Validation loss decreased (inf --> -0.149980).  Saving model ...
Epoch: 2 cost time: 0.6716639995574951
Epoch: 2, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.803 Vali Acc: 0.384 Test Loss: 1.803 Test Acc: 0.384
Validation loss decreased (-0.149980 --> -0.384357).  Saving model ...
Epoch: 3 cost time: 0.6574749946594238
Epoch: 3, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.506 Vali Acc: 0.656 Test Loss: 1.506 Test Acc: 0.656
Validation loss decreased (-0.384357 --> -0.656235).  Saving model ...
Epoch: 4 cost time: 0.6005778312683105
Epoch: 4, Steps: 8 | Train Loss: 1.330 Vali Loss: 1.222 Vali Acc: 0.734 Test Loss: 1.222 Test Acc: 0.734
Validation loss decreased (-0.656235 --> -0.734363).  Saving model ...
Epoch: 5 cost time: 0.61726975440979
Epoch: 5, Steps: 8 | Train Loss: 1.057 Vali Loss: 0.998 Vali Acc: 0.759 Test Loss: 0.998 Test Acc: 0.759
Validation loss decreased (-0.734363 --> -0.759365).  Saving model ...
Epoch: 6 cost time: 0.5439605712890625
Epoch: 6, Steps: 8 | Train Loss: 0.826 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.759365 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.579052209854126
Epoch: 7, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.714 Vali Acc: 0.791 Test Loss: 0.714 Test Acc: 0.791
Validation loss decreased (-0.774992 --> -0.790618).  Saving model ...
Epoch: 8 cost time: 0.6303660869598389
Epoch: 8, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.648 Vali Acc: 0.806 Test Loss: 0.648 Test Acc: 0.806
Validation loss decreased (-0.790618 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.601905345916748
Epoch: 9, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.5857343673706055
Epoch: 10, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.490950345993042
Epoch: 11, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.5800209045410156
Epoch: 12, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 0.5277984142303467
Epoch: 13, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7091407775878906
Epoch: 14, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8672759532928467
Epoch: 15, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 0.6977403163909912
Epoch: 16, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.559 Vali Acc: 0.834 Test Loss: 0.559 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 17 cost time: 0.6046843528747559
Epoch: 17, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5579397678375244
Epoch: 18, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.730579137802124
Epoch: 19, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5796031951904297
Epoch: 20, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6729066371917725
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4690995216369629
Epoch: 22, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.628 Vali Acc: 0.806 Test Loss: 0.628 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4008345603942871
Epoch: 23, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.638 Vali Acc: 0.806 Test Loss: 0.638 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5076389312744141
Epoch: 24, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5294029712677002
Epoch: 25, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5514848232269287
Epoch: 26, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.676 Vali Acc: 0.812 Test Loss: 0.676 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 123227
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9505441188812256
Epoch: 1, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.902 Vali Acc: 0.284 Test Loss: 1.902 Test Acc: 0.284
Validation loss decreased (inf --> -0.284356).  Saving model ...
Epoch: 2 cost time: 0.5682754516601562
Epoch: 2, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.677 Vali Acc: 0.494 Test Loss: 1.677 Test Acc: 0.494
Validation loss decreased (-0.284356 --> -0.493733).  Saving model ...
Epoch: 3 cost time: 0.5676982402801514
Epoch: 3, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.403 Vali Acc: 0.656 Test Loss: 1.403 Test Acc: 0.656
Validation loss decreased (-0.493733 --> -0.656236).  Saving model ...
Epoch: 4 cost time: 0.634880781173706
Epoch: 4, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.142 Vali Acc: 0.744 Test Loss: 1.142 Test Acc: 0.744
Validation loss decreased (-0.656236 --> -0.743739).  Saving model ...
Epoch: 5 cost time: 0.5942502021789551
Epoch: 5, Steps: 8 | Train Loss: 1.027 Vali Loss: 0.927 Vali Acc: 0.778 Test Loss: 0.927 Test Acc: 0.778
Validation loss decreased (-0.743739 --> -0.778116).  Saving model ...
Epoch: 6 cost time: 0.5950050354003906
Epoch: 6, Steps: 8 | Train Loss: 0.800 Vali Loss: 0.788 Vali Acc: 0.784 Test Loss: 0.788 Test Acc: 0.784
Validation loss decreased (-0.778116 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.6116704940795898
Epoch: 7, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.784367 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.6029860973358154
Epoch: 8, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.5708181858062744
Epoch: 9, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.5918393135070801
Epoch: 10, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.6440272331237793
Epoch: 11, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.626014232635498
Epoch: 12, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6846730709075928
Epoch: 13, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6388781070709229
Epoch: 14, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6790368556976318
Epoch: 15, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6327235698699951
Epoch: 16, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6561033725738525
Epoch: 17, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5702269077301025
Epoch: 18, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6786715984344482
Epoch: 19, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6262288093566895
Epoch: 20, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.593 Vali Acc: 0.791 Test Loss: 0.593 Test Acc: 0.791
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6335117816925049
Epoch: 21, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 123552
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8886148929595947
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.075 Vali Acc: 0.106 Test Loss: 2.075 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 0.5395298004150391
Epoch: 2, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.836 Vali Acc: 0.356 Test Loss: 1.836 Test Acc: 0.356
Validation loss decreased (-0.106229 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 0.5643117427825928
Epoch: 3, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.533 Vali Acc: 0.681 Test Loss: 1.533 Test Acc: 0.681
Validation loss decreased (-0.356232 --> -0.681235).  Saving model ...
Epoch: 4 cost time: 0.6102652549743652
Epoch: 4, Steps: 8 | Train Loss: 1.392 Vali Loss: 1.238 Vali Acc: 0.772 Test Loss: 1.238 Test Acc: 0.772
Validation loss decreased (-0.681235 --> -0.771863).  Saving model ...
Epoch: 5 cost time: 0.5104789733886719
Epoch: 5, Steps: 8 | Train Loss: 1.098 Vali Loss: 0.997 Vali Acc: 0.787 Test Loss: 0.997 Test Acc: 0.787
Validation loss decreased (-0.771863 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.6566648483276367
Epoch: 6, Steps: 8 | Train Loss: 0.847 Vali Loss: 0.821 Vali Acc: 0.806 Test Loss: 0.821 Test Acc: 0.806
Validation loss decreased (-0.787490 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.5888168811798096
Epoch: 7, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
Validation loss decreased (-0.806242 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 0.6299843788146973
Epoch: 8, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.5941007137298584
Epoch: 9, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.565805196762085
Epoch: 10, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5722568035125732
Epoch: 11, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 0.7352700233459473
Epoch: 12, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.6383395195007324
Epoch: 13, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.7108581066131592
Epoch: 14, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5605361461639404
Epoch: 15, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5772702693939209
Epoch: 16, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5809037685394287
Epoch: 17, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5474047660827637
Epoch: 18, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.589 Vali Acc: 0.819 Test Loss: 0.589 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5709671974182129
Epoch: 19, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6570992469787598
Epoch: 20, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5691342353820801
Epoch: 21, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.604 Vali Acc: 0.819 Test Loss: 0.604 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6601667404174805
Epoch: 22, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5673003196716309
Epoch: 23, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 123251
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7986516952514648
Epoch: 1, Steps: 8 | Train Loss: 2.120 Vali Loss: 2.015 Vali Acc: 0.231 Test Loss: 2.015 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.44355249404907227
Epoch: 2, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.778 Vali Acc: 0.459 Test Loss: 1.778 Test Acc: 0.459
Validation loss decreased (-0.231230 --> -0.459357).  Saving model ...
Epoch: 3 cost time: 0.5644526481628418
Epoch: 3, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.486 Vali Acc: 0.644 Test Loss: 1.486 Test Acc: 0.644
Validation loss decreased (-0.459357 --> -0.643735).  Saving model ...
Epoch: 4 cost time: 0.5301570892333984
Epoch: 4, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.208 Vali Acc: 0.747 Test Loss: 1.208 Test Acc: 0.747
Validation loss decreased (-0.643735 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.5171923637390137
Epoch: 5, Steps: 8 | Train Loss: 1.067 Vali Loss: 0.976 Vali Acc: 0.778 Test Loss: 0.976 Test Acc: 0.778
Validation loss decreased (-0.746863 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.5194025039672852
Epoch: 6, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.778115 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.621300458908081
Epoch: 7, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.691 Vali Acc: 0.806 Test Loss: 0.691 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.4605441093444824
Epoch: 8, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.6368546485900879
Epoch: 9, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.5145666599273682
Epoch: 10, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.571 Vali Acc: 0.816 Test Loss: 0.571 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.5452656745910645
Epoch: 11, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.42415475845336914
Epoch: 12, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 13 cost time: 0.5315761566162109
Epoch: 13, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 14 cost time: 0.6490297317504883
Epoch: 14, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 15 cost time: 0.5688958168029785
Epoch: 15, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 0.6038966178894043
Epoch: 16, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 0.6396214962005615
Epoch: 17, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5667493343353271
Epoch: 18, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6169745922088623
Epoch: 19, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6860120296478271
Epoch: 20, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5879099369049072
Epoch: 21, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6112704277038574
Epoch: 22, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6452484130859375
Epoch: 23, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.630 Vali Acc: 0.816 Test Loss: 0.630 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5706343650817871
Epoch: 24, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.654 Vali Acc: 0.812 Test Loss: 0.654 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5611083507537842
Epoch: 25, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.660 Vali Acc: 0.812 Test Loss: 0.660 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5899391174316406
Epoch: 26, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 122324
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8296844959259033
Epoch: 1, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.933 Vali Acc: 0.284 Test Loss: 1.933 Test Acc: 0.284
Validation loss decreased (inf --> -0.284356).  Saving model ...
Epoch: 2 cost time: 0.53298020362854
Epoch: 2, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.692 Vali Acc: 0.556 Test Loss: 1.692 Test Acc: 0.556
Validation loss decreased (-0.284356 --> -0.556233).  Saving model ...
Epoch: 3 cost time: 0.5230967998504639
Epoch: 3, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.402 Vali Acc: 0.728 Test Loss: 1.402 Test Acc: 0.728
Validation loss decreased (-0.556233 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 0.47788405418395996
Epoch: 4, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.128 Vali Acc: 0.784 Test Loss: 1.128 Test Acc: 0.784
Validation loss decreased (-0.728111 --> -0.784364).  Saving model ...
Epoch: 5 cost time: 0.499896764755249
Epoch: 5, Steps: 8 | Train Loss: 0.999 Vali Loss: 0.915 Vali Acc: 0.787 Test Loss: 0.915 Test Acc: 0.787
Validation loss decreased (-0.784364 --> -0.787491).  Saving model ...
Epoch: 6 cost time: 0.49471402168273926
Epoch: 6, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
Validation loss decreased (-0.787491 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.5621240139007568
Epoch: 7, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.672 Vali Acc: 0.806 Test Loss: 0.672 Test Acc: 0.806
Validation loss decreased (-0.806242 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.599170446395874
Epoch: 8, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.6936213970184326
Epoch: 9, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.610375165939331
Epoch: 10, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.5491161346435547
Epoch: 11, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6110615730285645
Epoch: 12, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4632599353790283
Epoch: 13, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5792667865753174
Epoch: 14, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5868513584136963
Epoch: 15, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 0.5629332065582275
Epoch: 16, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5133826732635498
Epoch: 17, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5695648193359375
Epoch: 18, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.661078929901123
Epoch: 19, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6008732318878174
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5355777740478516
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.619 Vali Acc: 0.806 Test Loss: 0.619 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5684475898742676
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5356693267822266
Epoch: 23, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5389530658721924
Epoch: 24, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6993684768676758
Epoch: 25, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 120771
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.893089771270752
Epoch: 1, Steps: 8 | Train Loss: 2.230 Vali Loss: 2.157 Vali Acc: 0.134 Test Loss: 2.157 Test Acc: 0.134
Validation loss decreased (inf --> -0.134353).  Saving model ...
Epoch: 2 cost time: 0.6104245185852051
Epoch: 2, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.895 Vali Acc: 0.334 Test Loss: 1.895 Test Acc: 0.334
Validation loss decreased (-0.134353 --> -0.334356).  Saving model ...
Epoch: 3 cost time: 0.508969783782959
Epoch: 3, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.573 Vali Acc: 0.619 Test Loss: 1.573 Test Acc: 0.619
Validation loss decreased (-0.334356 --> -0.618734).  Saving model ...
Epoch: 4 cost time: 0.5275912284851074
Epoch: 4, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.264 Vali Acc: 0.741 Test Loss: 1.264 Test Acc: 0.741
Validation loss decreased (-0.618734 --> -0.740612).  Saving model ...
Epoch: 5 cost time: 0.5397028923034668
Epoch: 5, Steps: 8 | Train Loss: 1.107 Vali Loss: 1.010 Vali Acc: 0.781 Test Loss: 1.010 Test Acc: 0.781
Validation loss decreased (-0.740612 --> -0.781240).  Saving model ...
Epoch: 6 cost time: 0.5501425266265869
Epoch: 6, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.822 Vali Acc: 0.797 Test Loss: 0.822 Test Acc: 0.797
Validation loss decreased (-0.781240 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.45868372917175293
Epoch: 7, Steps: 8 | Train Loss: 0.698 Vali Loss: 0.695 Vali Acc: 0.797 Test Loss: 0.695 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.4994046688079834
Epoch: 8, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.4798767566680908
Epoch: 9, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.590 Vali Acc: 0.806 Test Loss: 0.590 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4972398281097412
Epoch: 10, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.4775698184967041
Epoch: 11, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.4868738651275635
Epoch: 12, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.4543783664703369
Epoch: 13, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5097413063049316
Epoch: 14, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.47537827491760254
Epoch: 15, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6338932514190674
Epoch: 16, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5131721496582031
Epoch: 17, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.48993873596191406
Epoch: 18, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4733736515045166
Epoch: 19, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5223124027252197
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5306403636932373
Epoch: 21, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5261948108673096
Epoch: 22, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 116992
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7317733764648438
Epoch: 1, Steps: 8 | Train Loss: 2.046 Vali Loss: 1.940 Vali Acc: 0.284 Test Loss: 1.940 Test Acc: 0.284
Validation loss decreased (inf --> -0.284356).  Saving model ...
Epoch: 2 cost time: 0.5792593955993652
Epoch: 2, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.697 Vali Acc: 0.522 Test Loss: 1.697 Test Acc: 0.522
Validation loss decreased (-0.284356 --> -0.521858).  Saving model ...
Epoch: 3 cost time: 0.5420699119567871
Epoch: 3, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.415 Vali Acc: 0.684 Test Loss: 1.415 Test Acc: 0.684
Validation loss decreased (-0.521858 --> -0.684361).  Saving model ...
Epoch: 4 cost time: 0.5066952705383301
Epoch: 4, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.149 Vali Acc: 0.775 Test Loss: 1.149 Test Acc: 0.775
Validation loss decreased (-0.684361 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 0.6114351749420166
Epoch: 5, Steps: 8 | Train Loss: 1.029 Vali Loss: 0.939 Vali Acc: 0.787 Test Loss: 0.939 Test Acc: 0.787
Validation loss decreased (-0.774989 --> -0.787491).  Saving model ...
Epoch: 6 cost time: 0.5275275707244873
Epoch: 6, Steps: 8 | Train Loss: 0.800 Vali Loss: 0.798 Vali Acc: 0.797 Test Loss: 0.798 Test Acc: 0.797
Validation loss decreased (-0.787491 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5657796859741211
Epoch: 7, Steps: 8 | Train Loss: 0.640 Vali Loss: 0.693 Vali Acc: 0.806 Test Loss: 0.693 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.5937151908874512
Epoch: 8, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5916414260864258
Epoch: 9, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.6097357273101807
Epoch: 10, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.5522506237030029
Epoch: 11, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48275089263916016
Epoch: 12, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.49967193603515625
Epoch: 13, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.524599552154541
Epoch: 14, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 15 cost time: 0.6099815368652344
Epoch: 15, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 0.526383638381958
Epoch: 16, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.476093053817749
Epoch: 17, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3879873752593994
Epoch: 18, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4891939163208008
Epoch: 19, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.47255611419677734
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.609 Vali Acc: 0.812 Test Loss: 0.609 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5166144371032715
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5878293514251709
Epoch: 22, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.604 Vali Acc: 0.831 Test Loss: 0.604 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 23 cost time: 0.4811725616455078
Epoch: 23, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4519636631011963
Epoch: 24, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5114836692810059
Epoch: 25, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.648 Vali Acc: 0.819 Test Loss: 0.648 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4750196933746338
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.651 Vali Acc: 0.819 Test Loss: 0.651 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.48262929916381836
Epoch: 27, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.658 Vali Acc: 0.812 Test Loss: 0.658 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4570033550262451
Epoch: 28, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.672 Vali Acc: 0.819 Test Loss: 0.672 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.49981021881103516
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5136480331420898
Epoch: 30, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4965548515319824
Epoch: 31, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.706 Vali Acc: 0.819 Test Loss: 0.706 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5004332065582275
Epoch: 32, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.722 Vali Acc: 0.816 Test Loss: 0.722 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 114995
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.867323637008667
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.035 Vali Acc: 0.250 Test Loss: 2.035 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 0.7000586986541748
Epoch: 2, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.789 Vali Acc: 0.406 Test Loss: 1.789 Test Acc: 0.406
Validation loss decreased (-0.249980 --> -0.406232).  Saving model ...
Epoch: 3 cost time: 0.565826416015625
Epoch: 3, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.480 Vali Acc: 0.606 Test Loss: 1.480 Test Acc: 0.606
Validation loss decreased (-0.406232 --> -0.606235).  Saving model ...
Epoch: 4 cost time: 0.5418376922607422
Epoch: 4, Steps: 8 | Train Loss: 1.297 Vali Loss: 1.201 Vali Acc: 0.753 Test Loss: 1.201 Test Acc: 0.753
Validation loss decreased (-0.606235 --> -0.753113).  Saving model ...
Epoch: 5 cost time: 0.6038923263549805
Epoch: 5, Steps: 8 | Train Loss: 1.023 Vali Loss: 0.974 Vali Acc: 0.778 Test Loss: 0.974 Test Acc: 0.778
Validation loss decreased (-0.753113 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.5664334297180176
Epoch: 6, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.814 Vali Acc: 0.781 Test Loss: 0.814 Test Acc: 0.781
Validation loss decreased (-0.778115 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.594151496887207
Epoch: 7, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
Validation loss decreased (-0.781242 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.5956308841705322
Epoch: 8, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.630 Vali Acc: 0.806 Test Loss: 0.630 Test Acc: 0.806
Validation loss decreased (-0.796868 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.636399507522583
Epoch: 9, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.5805511474609375
Epoch: 10, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.5074272155761719
Epoch: 11, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.5760459899902344
Epoch: 12, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5836999416351318
Epoch: 13, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5967519283294678
Epoch: 14, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 0.5328445434570312
Epoch: 15, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5049035549163818
Epoch: 16, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4831371307373047
Epoch: 17, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6742334365844727
Epoch: 18, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5889332294464111
Epoch: 19, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6178970336914062
Epoch: 20, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.567375898361206
Epoch: 21, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5183820724487305
Epoch: 22, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5594546794891357
Epoch: 23, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.645 Vali Acc: 0.816 Test Loss: 0.645 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5708465576171875
Epoch: 24, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 114496
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9887762069702148
Epoch: 1, Steps: 8 | Train Loss: 2.195 Vali Loss: 2.086 Vali Acc: 0.109 Test Loss: 2.086 Test Acc: 0.109
Validation loss decreased (inf --> -0.109354).  Saving model ...
Epoch: 2 cost time: 0.5726680755615234
Epoch: 2, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.828 Vali Acc: 0.369 Test Loss: 1.828 Test Acc: 0.369
Validation loss decreased (-0.109354 --> -0.368732).  Saving model ...
Epoch: 3 cost time: 0.5676352977752686
Epoch: 3, Steps: 8 | Train Loss: 1.689 Vali Loss: 1.512 Vali Acc: 0.631 Test Loss: 1.512 Test Acc: 0.631
Validation loss decreased (-0.368732 --> -0.631235).  Saving model ...
Epoch: 4 cost time: 0.5405604839324951
Epoch: 4, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.214 Vali Acc: 0.731 Test Loss: 1.214 Test Acc: 0.731
Validation loss decreased (-0.631235 --> -0.731238).  Saving model ...
Epoch: 5 cost time: 0.5857164859771729
Epoch: 5, Steps: 8 | Train Loss: 1.047 Vali Loss: 0.978 Vali Acc: 0.778 Test Loss: 0.978 Test Acc: 0.778
Validation loss decreased (-0.731238 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.676023006439209
Epoch: 6, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
Validation loss decreased (-0.778115 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5450539588928223
Epoch: 7, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.695 Vali Acc: 0.797 Test Loss: 0.695 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.553727388381958
Epoch: 8, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.621 Vali Acc: 0.819 Test Loss: 0.621 Test Acc: 0.819
Validation loss decreased (-0.799992 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.5098237991333008
Epoch: 9, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.5764434337615967
Epoch: 10, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.5447237491607666
Epoch: 11, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.5307750701904297
Epoch: 12, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 0.5078797340393066
Epoch: 13, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.56988525390625
Epoch: 14, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6125636100769043
Epoch: 15, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6600522994995117
Epoch: 16, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4807744026184082
Epoch: 17, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5901815891265869
Epoch: 18, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.564 Vali Acc: 0.834 Test Loss: 0.564 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5077521800994873
Epoch: 19, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4823875427246094
Epoch: 20, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4594409465789795
Epoch: 21, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.570340633392334
Epoch: 22, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 113691
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8260917663574219
Epoch: 1, Steps: 8 | Train Loss: 2.239 Vali Loss: 2.188 Vali Acc: 0.062 Test Loss: 2.188 Test Acc: 0.062
Validation loss decreased (inf --> -0.062478).  Saving model ...
Epoch: 2 cost time: 0.5775041580200195
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.924 Vali Acc: 0.241 Test Loss: 1.924 Test Acc: 0.241
Validation loss decreased (-0.062478 --> -0.240606).  Saving model ...
Epoch: 3 cost time: 0.610811710357666
Epoch: 3, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.591 Vali Acc: 0.600 Test Loss: 1.591 Test Acc: 0.600
Validation loss decreased (-0.240606 --> -0.599984).  Saving model ...
Epoch: 4 cost time: 0.5596156120300293
Epoch: 4, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.269 Vali Acc: 0.722 Test Loss: 1.269 Test Acc: 0.722
Validation loss decreased (-0.599984 --> -0.721862).  Saving model ...
Epoch: 5 cost time: 0.671290397644043
Epoch: 5, Steps: 8 | Train Loss: 1.065 Vali Loss: 1.007 Vali Acc: 0.769 Test Loss: 1.007 Test Acc: 0.769
Validation loss decreased (-0.721862 --> -0.768740).  Saving model ...
Epoch: 6 cost time: 0.60733962059021
Epoch: 6, Steps: 8 | Train Loss: 0.847 Vali Loss: 0.822 Vali Acc: 0.787 Test Loss: 0.822 Test Acc: 0.787
Validation loss decreased (-0.768740 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.5454981327056885
Epoch: 7, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.5679171085357666
Epoch: 8, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.6082303524017334
Epoch: 9, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5671541690826416
Epoch: 10, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5756127834320068
Epoch: 11, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6398658752441406
Epoch: 12, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5030844211578369
Epoch: 13, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6637067794799805
Epoch: 14, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.519881010055542
Epoch: 15, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5924506187438965
Epoch: 16, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6086838245391846
Epoch: 17, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6001849174499512
Epoch: 18, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5714194774627686
Epoch: 19, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 114342
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6169166564941406
Epoch: 1, Steps: 8 | Train Loss: 2.073 Vali Loss: 2.010 Vali Acc: 0.234 Test Loss: 2.010 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.7141625881195068
Epoch: 2, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.759 Vali Acc: 0.453 Test Loss: 1.759 Test Acc: 0.453
Validation loss decreased (-0.234355 --> -0.453107).  Saving model ...
Epoch: 3 cost time: 0.5108950138092041
Epoch: 3, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.450 Vali Acc: 0.722 Test Loss: 1.450 Test Acc: 0.722
Validation loss decreased (-0.453107 --> -0.721861).  Saving model ...
Epoch: 4 cost time: 0.4261603355407715
Epoch: 4, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.158 Vali Acc: 0.766 Test Loss: 1.158 Test Acc: 0.766
Validation loss decreased (-0.721861 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.45597267150878906
Epoch: 5, Steps: 8 | Train Loss: 0.996 Vali Loss: 0.930 Vali Acc: 0.794 Test Loss: 0.930 Test Acc: 0.794
Validation loss decreased (-0.765613 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 0.4171135425567627
Epoch: 6, Steps: 8 | Train Loss: 0.770 Vali Loss: 0.781 Vali Acc: 0.791 Test Loss: 0.781 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5205748081207275
Epoch: 7, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
Validation loss decreased (-0.793741 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.5275239944458008
Epoch: 8, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.608 Vali Acc: 0.806 Test Loss: 0.608 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.48096561431884766
Epoch: 9, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5250930786132812
Epoch: 10, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 11 cost time: 0.49950170516967773
Epoch: 11, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 0.5158560276031494
Epoch: 12, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6119983196258545
Epoch: 13, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6292896270751953
Epoch: 14, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5907514095306396
Epoch: 15, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 16 cost time: 0.5608291625976562
Epoch: 16, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 17 cost time: 0.5618789196014404
Epoch: 17, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5217580795288086
Epoch: 18, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6329443454742432
Epoch: 19, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5865988731384277
Epoch: 20, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.599 Vali Acc: 0.812 Test Loss: 0.599 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.558643102645874
Epoch: 21, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.505885124206543
Epoch: 22, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.630 Vali Acc: 0.806 Test Loss: 0.630 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4887971878051758
Epoch: 23, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5808391571044922
Epoch: 24, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6312072277069092
Epoch: 25, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.672 Vali Acc: 0.812 Test Loss: 0.672 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5949752330780029
Epoch: 26, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 113171
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7732717990875244
Epoch: 1, Steps: 8 | Train Loss: 2.055 Vali Loss: 2.005 Vali Acc: 0.188 Test Loss: 2.005 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 0.514183521270752
Epoch: 2, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.769 Vali Acc: 0.406 Test Loss: 1.769 Test Acc: 0.406
Validation loss decreased (-0.187480 --> -0.406232).  Saving model ...
Epoch: 3 cost time: 0.6320607662200928
Epoch: 3, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.479 Vali Acc: 0.603 Test Loss: 1.479 Test Acc: 0.603
Validation loss decreased (-0.406232 --> -0.603110).  Saving model ...
Epoch: 4 cost time: 0.5124444961547852
Epoch: 4, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.202 Vali Acc: 0.716 Test Loss: 1.202 Test Acc: 0.716
Validation loss decreased (-0.603110 --> -0.715613).  Saving model ...
Epoch: 5 cost time: 0.4972352981567383
Epoch: 5, Steps: 8 | Train Loss: 1.024 Vali Loss: 0.977 Vali Acc: 0.756 Test Loss: 0.977 Test Acc: 0.756
Validation loss decreased (-0.715613 --> -0.756240).  Saving model ...
Epoch: 6 cost time: 0.5531163215637207
Epoch: 6, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.815 Vali Acc: 0.772 Test Loss: 0.815 Test Acc: 0.772
Validation loss decreased (-0.756240 --> -0.771867).  Saving model ...
Epoch: 7 cost time: 0.4823431968688965
Epoch: 7, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.708 Vali Acc: 0.794 Test Loss: 0.708 Test Acc: 0.794
Validation loss decreased (-0.771867 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.5635464191436768
Epoch: 8, Steps: 8 | Train Loss: 0.614 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
Validation loss decreased (-0.793743 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.5466859340667725
Epoch: 9, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.5881991386413574
Epoch: 10, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.54144287109375
Epoch: 11, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.5643727779388428
Epoch: 12, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.5515587329864502
Epoch: 13, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.47052717208862305
Epoch: 14, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5335268974304199
Epoch: 15, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 0.5996878147125244
Epoch: 16, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 0.5851242542266846
Epoch: 17, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5297772884368896
Epoch: 18, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5103566646575928
Epoch: 19, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5206289291381836
Epoch: 20, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6131095886230469
Epoch: 21, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6049025058746338
Epoch: 22, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.46720409393310547
Epoch: 23, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.48804426193237305
Epoch: 24, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.675 Vali Acc: 0.794 Test Loss: 0.675 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5201997756958008
Epoch: 25, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6124658584594727
Epoch: 26, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.704 Vali Acc: 0.809 Test Loss: 0.704 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 114620
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.734489917755127
Epoch: 1, Steps: 8 | Train Loss: 2.142 Vali Loss: 2.085 Vali Acc: 0.250 Test Loss: 2.085 Test Acc: 0.250
Validation loss decreased (inf --> -0.249979).  Saving model ...
Epoch: 2 cost time: 0.6206233501434326
Epoch: 2, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.835 Vali Acc: 0.384 Test Loss: 1.835 Test Acc: 0.384
Validation loss decreased (-0.249979 --> -0.384357).  Saving model ...
Epoch: 3 cost time: 0.5585858821868896
Epoch: 3, Steps: 8 | Train Loss: 1.680 Vali Loss: 1.516 Vali Acc: 0.591 Test Loss: 1.516 Test Acc: 0.591
Validation loss decreased (-0.384357 --> -0.590610).  Saving model ...
Epoch: 4 cost time: 0.5754485130310059
Epoch: 4, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.226 Vali Acc: 0.716 Test Loss: 1.226 Test Acc: 0.716
Validation loss decreased (-0.590610 --> -0.715613).  Saving model ...
Epoch: 5 cost time: 0.5530812740325928
Epoch: 5, Steps: 8 | Train Loss: 1.041 Vali Loss: 0.998 Vali Acc: 0.762 Test Loss: 0.998 Test Acc: 0.762
Validation loss decreased (-0.715613 --> -0.762490).  Saving model ...
Epoch: 6 cost time: 0.5572075843811035
Epoch: 6, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.812 Vali Acc: 0.781 Test Loss: 0.812 Test Acc: 0.781
Validation loss decreased (-0.762490 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.42225217819213867
Epoch: 7, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5863697528839111
Epoch: 8, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.624 Vali Acc: 0.812 Test Loss: 0.624 Test Acc: 0.812
Validation loss decreased (-0.799993 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.5462634563446045
Epoch: 9, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.5490210056304932
Epoch: 10, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5127813816070557
Epoch: 11, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5582892894744873
Epoch: 12, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.574 Vali Acc: 0.806 Test Loss: 0.574 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5469698905944824
Epoch: 13, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5086498260498047
Epoch: 14, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 15 cost time: 0.579791784286499
Epoch: 15, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5132846832275391
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6265182495117188
Epoch: 17, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5776176452636719
Epoch: 18, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.592 Vali Acc: 0.806 Test Loss: 0.592 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5369958877563477
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5206723213195801
Epoch: 20, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5327057838439941
Epoch: 21, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.49149346351623535
Epoch: 22, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5071961879730225
Epoch: 23, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6530818939208984
Epoch: 24, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.821875
model parameter : 112923
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7163636684417725
Epoch: 1, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.870 Vali Acc: 0.300 Test Loss: 1.870 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 0.5979428291320801
Epoch: 2, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.640 Vali Acc: 0.512 Test Loss: 1.640 Test Acc: 0.512
Validation loss decreased (-0.299981 --> -0.512484).  Saving model ...
Epoch: 3 cost time: 0.5853958129882812
Epoch: 3, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.371 Vali Acc: 0.700 Test Loss: 1.371 Test Acc: 0.700
Validation loss decreased (-0.512484 --> -0.699986).  Saving model ...
Epoch: 4 cost time: 0.6714026927947998
Epoch: 4, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.119 Vali Acc: 0.741 Test Loss: 1.119 Test Acc: 0.741
Validation loss decreased (-0.699986 --> -0.740614).  Saving model ...
Epoch: 5 cost time: 0.5092401504516602
Epoch: 5, Steps: 8 | Train Loss: 0.973 Vali Loss: 0.907 Vali Acc: 0.766 Test Loss: 0.907 Test Acc: 0.766
Validation loss decreased (-0.740614 --> -0.765616).  Saving model ...
Epoch: 6 cost time: 0.5808565616607666
Epoch: 6, Steps: 8 | Train Loss: 0.774 Vali Loss: 0.769 Vali Acc: 0.778 Test Loss: 0.769 Test Acc: 0.778
Validation loss decreased (-0.765616 --> -0.778117).  Saving model ...
Epoch: 7 cost time: 0.5522325038909912
Epoch: 7, Steps: 8 | Train Loss: 0.657 Vali Loss: 0.687 Vali Acc: 0.791 Test Loss: 0.687 Test Acc: 0.791
Validation loss decreased (-0.778117 --> -0.790618).  Saving model ...
Epoch: 8 cost time: 0.6230649948120117
Epoch: 8, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.621 Vali Acc: 0.806 Test Loss: 0.621 Test Acc: 0.806
Validation loss decreased (-0.790618 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.580817461013794
Epoch: 9, Steps: 8 | Train Loss: 0.518 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.6966249942779541
Epoch: 10, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.5409271717071533
Epoch: 11, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6734387874603271
Epoch: 12, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6431992053985596
Epoch: 13, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6154079437255859
Epoch: 14, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5733530521392822
Epoch: 15, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5575463771820068
Epoch: 16, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6287777423858643
Epoch: 17, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6137750148773193
Epoch: 18, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6000568866729736
Epoch: 19, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6158409118652344
Epoch: 20, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.821875
model parameter : 114444
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9715933799743652
Epoch: 1, Steps: 8 | Train Loss: 2.057 Vali Loss: 1.963 Vali Acc: 0.297 Test Loss: 1.963 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 0.5889875888824463
Epoch: 2, Steps: 8 | Train Loss: 1.869 Vali Loss: 1.729 Vali Acc: 0.428 Test Loss: 1.729 Test Acc: 0.428
Validation loss decreased (-0.296855 --> -0.428108).  Saving model ...
Epoch: 3 cost time: 0.5996999740600586
Epoch: 3, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.444 Vali Acc: 0.600 Test Loss: 1.444 Test Acc: 0.600
Validation loss decreased (-0.428108 --> -0.599986).  Saving model ...
Epoch: 4 cost time: 0.5936369895935059
Epoch: 4, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.171 Vali Acc: 0.741 Test Loss: 1.171 Test Acc: 0.741
Validation loss decreased (-0.599986 --> -0.740613).  Saving model ...
Epoch: 5 cost time: 0.49730515480041504
Epoch: 5, Steps: 8 | Train Loss: 1.005 Vali Loss: 0.947 Vali Acc: 0.797 Test Loss: 0.947 Test Acc: 0.797
Validation loss decreased (-0.740613 --> -0.796866).  Saving model ...
Epoch: 6 cost time: 0.684807538986206
Epoch: 6, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.783 Vali Acc: 0.806 Test Loss: 0.783 Test Acc: 0.806
Validation loss decreased (-0.796866 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.548602819442749
Epoch: 7, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
Validation loss decreased (-0.806242 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 0.6724162101745605
Epoch: 8, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
Validation loss decreased (-0.818743 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.46694397926330566
Epoch: 9, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.5367529392242432
Epoch: 10, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.5047032833099365
Epoch: 11, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6381344795227051
Epoch: 12, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6006700992584229
Epoch: 13, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5573503971099854
Epoch: 14, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5652420520782471
Epoch: 15, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5534675121307373
Epoch: 16, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5699925422668457
Epoch: 17, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5244159698486328
Epoch: 18, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5773234367370605
Epoch: 19, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5379972457885742
Epoch: 20, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 114079
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9448227882385254
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.096 Vali Acc: 0.153 Test Loss: 2.096 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 0.5461552143096924
Epoch: 2, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.840 Vali Acc: 0.347 Test Loss: 1.840 Test Acc: 0.347
Validation loss decreased (-0.153104 --> -0.346857).  Saving model ...
Epoch: 3 cost time: 0.5693895816802979
Epoch: 3, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.533 Vali Acc: 0.634 Test Loss: 1.533 Test Acc: 0.634
Validation loss decreased (-0.346857 --> -0.634360).  Saving model ...
Epoch: 4 cost time: 0.5378947257995605
Epoch: 4, Steps: 8 | Train Loss: 1.374 Vali Loss: 1.228 Vali Acc: 0.738 Test Loss: 1.228 Test Acc: 0.738
Validation loss decreased (-0.634360 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.4908008575439453
Epoch: 5, Steps: 8 | Train Loss: 1.067 Vali Loss: 0.984 Vali Acc: 0.775 Test Loss: 0.984 Test Acc: 0.775
Validation loss decreased (-0.737488 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.5748555660247803
Epoch: 6, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.809 Vali Acc: 0.794 Test Loss: 0.809 Test Acc: 0.794
Validation loss decreased (-0.774990 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.5798814296722412
Epoch: 7, Steps: 8 | Train Loss: 0.698 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.793742 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5166497230529785
Epoch: 8, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.640 Vali Acc: 0.797 Test Loss: 0.640 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5681085586547852
Epoch: 9, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 10 cost time: 0.5138423442840576
Epoch: 10, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 11 cost time: 0.48171544075012207
Epoch: 11, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 12 cost time: 0.5479934215545654
Epoch: 12, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.5567500591278076
Epoch: 13, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4940946102142334
Epoch: 14, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5650637149810791
Epoch: 15, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5881485939025879
Epoch: 16, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5823919773101807
Epoch: 17, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5470919609069824
Epoch: 18, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.595 Vali Acc: 0.806 Test Loss: 0.595 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.636211633682251
Epoch: 19, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.610 Vali Acc: 0.806 Test Loss: 0.610 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5436174869537354
Epoch: 20, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6044402122497559
Epoch: 21, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5415611267089844
Epoch: 22, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.617 Vali Acc: 0.812 Test Loss: 0.617 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 115640
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8806257247924805
Epoch: 1, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.924 Vali Acc: 0.259 Test Loss: 1.924 Test Acc: 0.259
Validation loss decreased (inf --> -0.259356).  Saving model ...
Epoch: 2 cost time: 0.5239667892456055
Epoch: 2, Steps: 8 | Train Loss: 1.833 Vali Loss: 1.693 Vali Acc: 0.569 Test Loss: 1.693 Test Acc: 0.569
Validation loss decreased (-0.259356 --> -0.568733).  Saving model ...
Epoch: 3 cost time: 0.5185084342956543
Epoch: 3, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.418 Vali Acc: 0.678 Test Loss: 1.418 Test Acc: 0.678
Validation loss decreased (-0.568733 --> -0.678111).  Saving model ...
Epoch: 4 cost time: 0.6598737239837646
Epoch: 4, Steps: 8 | Train Loss: 1.251 Vali Loss: 1.169 Vali Acc: 0.728 Test Loss: 1.169 Test Acc: 0.728
Validation loss decreased (-0.678111 --> -0.728113).  Saving model ...
Epoch: 5 cost time: 0.513927698135376
Epoch: 5, Steps: 8 | Train Loss: 1.002 Vali Loss: 0.957 Vali Acc: 0.753 Test Loss: 0.957 Test Acc: 0.753
Validation loss decreased (-0.728113 --> -0.753115).  Saving model ...
Epoch: 6 cost time: 0.519615650177002
Epoch: 6, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.813 Vali Acc: 0.772 Test Loss: 0.813 Test Acc: 0.772
Validation loss decreased (-0.753115 --> -0.771867).  Saving model ...
Epoch: 7 cost time: 0.5407612323760986
Epoch: 7, Steps: 8 | Train Loss: 0.715 Vali Loss: 0.712 Vali Acc: 0.787 Test Loss: 0.712 Test Acc: 0.787
Validation loss decreased (-0.771867 --> -0.787493).  Saving model ...
Epoch: 8 cost time: 0.5040504932403564
Epoch: 8, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
Validation loss decreased (-0.787493 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.49609923362731934
Epoch: 9, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.7075502872467041
Epoch: 10, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.4948558807373047
Epoch: 11, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48360538482666016
Epoch: 12, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5551884174346924
Epoch: 13, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5628514289855957
Epoch: 14, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6389424800872803
Epoch: 15, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 16 cost time: 0.4839026927947998
Epoch: 16, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 17 cost time: 0.4251391887664795
Epoch: 17, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 0.5642962455749512
Epoch: 18, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 19 cost time: 0.566718339920044
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5457243919372559
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5575652122497559
Epoch: 21, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.637 Vali Acc: 0.806 Test Loss: 0.637 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5714530944824219
Epoch: 22, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6152114868164062
Epoch: 23, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.670 Vali Acc: 0.806 Test Loss: 0.670 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5814352035522461
Epoch: 24, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.671 Vali Acc: 0.809 Test Loss: 0.671 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5724728107452393
Epoch: 25, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.692 Vali Acc: 0.797 Test Loss: 0.692 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5626668930053711
Epoch: 26, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5307061672210693
Epoch: 27, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.728 Vali Acc: 0.812 Test Loss: 0.728 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5186355113983154
Epoch: 28, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 115945
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7533950805664062
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 1.998 Vali Acc: 0.178 Test Loss: 1.998 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.586998462677002
Epoch: 2, Steps: 8 | Train Loss: 1.925 Vali Loss: 1.770 Vali Acc: 0.366 Test Loss: 1.770 Test Acc: 0.366
Validation loss decreased (-0.178105 --> -0.365607).  Saving model ...
Epoch: 3 cost time: 0.5463738441467285
Epoch: 3, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.489 Vali Acc: 0.625 Test Loss: 1.489 Test Acc: 0.625
Validation loss decreased (-0.365607 --> -0.624985).  Saving model ...
Epoch: 4 cost time: 0.5110025405883789
Epoch: 4, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.212 Vali Acc: 0.728 Test Loss: 1.212 Test Acc: 0.728
Validation loss decreased (-0.624985 --> -0.728113).  Saving model ...
Epoch: 5 cost time: 0.4976656436920166
Epoch: 5, Steps: 8 | Train Loss: 1.044 Vali Loss: 0.991 Vali Acc: 0.766 Test Loss: 0.991 Test Acc: 0.766
Validation loss decreased (-0.728113 --> -0.765615).  Saving model ...
Epoch: 6 cost time: 0.4943811893463135
Epoch: 6, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.831 Vali Acc: 0.778 Test Loss: 0.831 Test Acc: 0.778
Validation loss decreased (-0.765615 --> -0.778117).  Saving model ...
Epoch: 7 cost time: 0.49791526794433594
Epoch: 7, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.730 Vali Acc: 0.787 Test Loss: 0.730 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787493).  Saving model ...
Epoch: 8 cost time: 0.47374820709228516
Epoch: 8, Steps: 8 | Train Loss: 0.571 Vali Loss: 0.650 Vali Acc: 0.812 Test Loss: 0.650 Test Acc: 0.812
Validation loss decreased (-0.787493 --> -0.812493).  Saving model ...
Epoch: 9 cost time: 0.49536657333374023
Epoch: 9, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.5321476459503174
Epoch: 10, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.5204200744628906
Epoch: 11, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.46675968170166016
Epoch: 12, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.4499504566192627
Epoch: 13, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 14 cost time: 0.5304038524627686
Epoch: 14, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4479694366455078
Epoch: 15, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 0.541621208190918
Epoch: 16, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.492023229598999
Epoch: 17, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.42427492141723633
Epoch: 18, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3957850933074951
Epoch: 19, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.49558591842651367
Epoch: 20, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5897417068481445
Epoch: 21, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6056978702545166
Epoch: 22, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.656 Vali Acc: 0.816 Test Loss: 0.656 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5191733837127686
Epoch: 23, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.668 Vali Acc: 0.812 Test Loss: 0.668 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5284731388092041
Epoch: 24, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4995267391204834
Epoch: 25, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.675 Vali Acc: 0.816 Test Loss: 0.675 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 114994
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.664567232131958
Epoch: 1, Steps: 8 | Train Loss: 2.219 Vali Loss: 2.158 Vali Acc: 0.131 Test Loss: 2.158 Test Acc: 0.131
Validation loss decreased (inf --> -0.131228).  Saving model ...
Epoch: 2 cost time: 0.5077502727508545
Epoch: 2, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.903 Vali Acc: 0.334 Test Loss: 1.903 Test Acc: 0.334
Validation loss decreased (-0.131228 --> -0.334356).  Saving model ...
Epoch: 3 cost time: 0.5375313758850098
Epoch: 3, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.590 Vali Acc: 0.566 Test Loss: 1.590 Test Acc: 0.566
Validation loss decreased (-0.334356 --> -0.565609).  Saving model ...
Epoch: 4 cost time: 0.5253355503082275
Epoch: 4, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.290 Vali Acc: 0.684 Test Loss: 1.290 Test Acc: 0.684
Validation loss decreased (-0.565609 --> -0.684362).  Saving model ...
Epoch: 5 cost time: 0.5036442279815674
Epoch: 5, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.035 Vali Acc: 0.744 Test Loss: 1.035 Test Acc: 0.744
Validation loss decreased (-0.684362 --> -0.743740).  Saving model ...
Epoch: 6 cost time: 0.550422191619873
Epoch: 6, Steps: 8 | Train Loss: 0.887 Vali Loss: 0.854 Vali Acc: 0.772 Test Loss: 0.854 Test Acc: 0.772
Validation loss decreased (-0.743740 --> -0.771866).  Saving model ...
Epoch: 7 cost time: 0.5039103031158447
Epoch: 7, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.726 Vali Acc: 0.787 Test Loss: 0.726 Test Acc: 0.787
Validation loss decreased (-0.771866 --> -0.787493).  Saving model ...
Epoch: 8 cost time: 0.48662853240966797
Epoch: 8, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
Validation loss decreased (-0.787493 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.5123512744903564
Epoch: 9, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.609 Vali Acc: 0.806 Test Loss: 0.609 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.5015463829040527
Epoch: 10, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 0.44062018394470215
Epoch: 11, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.4074223041534424
Epoch: 12, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.512244701385498
Epoch: 13, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5703253746032715
Epoch: 14, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5851340293884277
Epoch: 15, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.585 Vali Acc: 0.806 Test Loss: 0.585 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.45190954208374023
Epoch: 16, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4366648197174072
Epoch: 17, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5145242214202881
Epoch: 18, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5162112712860107
Epoch: 19, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.620 Vali Acc: 0.797 Test Loss: 0.620 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5456998348236084
Epoch: 20, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.41932153701782227
Epoch: 21, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.821875
model parameter : 112787
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7216131687164307
Epoch: 1, Steps: 8 | Train Loss: 2.053 Vali Loss: 1.939 Vali Acc: 0.263 Test Loss: 1.939 Test Acc: 0.263
Validation loss decreased (inf --> -0.262481).  Saving model ...
Epoch: 2 cost time: 0.5779147148132324
Epoch: 2, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.710 Vali Acc: 0.412 Test Loss: 1.710 Test Acc: 0.412
Validation loss decreased (-0.262481 --> -0.412483).  Saving model ...
Epoch: 3 cost time: 0.5462019443511963
Epoch: 3, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.430 Vali Acc: 0.678 Test Loss: 1.430 Test Acc: 0.678
Validation loss decreased (-0.412483 --> -0.678111).  Saving model ...
Epoch: 4 cost time: 0.5481925010681152
Epoch: 4, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.170 Vali Acc: 0.738 Test Loss: 1.170 Test Acc: 0.738
Validation loss decreased (-0.678111 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.5783274173736572
Epoch: 5, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.950 Vali Acc: 0.787 Test Loss: 0.950 Test Acc: 0.787
Validation loss decreased (-0.737488 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.5566508769989014
Epoch: 6, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.798 Vali Acc: 0.787 Test Loss: 0.798 Test Acc: 0.787
Validation loss decreased (-0.787490 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.6162378787994385
Epoch: 7, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.696 Vali Acc: 0.806 Test Loss: 0.696 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.5521390438079834
Epoch: 8, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.4797847270965576
Epoch: 9, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.49558162689208984
Epoch: 10, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.48889756202697754
Epoch: 11, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.5538396835327148
Epoch: 12, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5153031349182129
Epoch: 13, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.5353152751922607
Epoch: 14, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4530496597290039
Epoch: 15, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.45372891426086426
Epoch: 16, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5040061473846436
Epoch: 17, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.39861130714416504
Epoch: 18, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.601 Vali Acc: 0.812 Test Loss: 0.601 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4845921993255615
Epoch: 19, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5169022083282471
Epoch: 20, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.612 Vali Acc: 0.806 Test Loss: 0.612 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.42563462257385254
Epoch: 21, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4769587516784668
Epoch: 22, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.44388890266418457
Epoch: 23, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.655 Vali Acc: 0.797 Test Loss: 0.655 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 114396
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.815948247909546
Epoch: 1, Steps: 8 | Train Loss: 2.066 Vali Loss: 2.001 Vali Acc: 0.222 Test Loss: 2.001 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 0.6123113632202148
Epoch: 2, Steps: 8 | Train Loss: 1.904 Vali Loss: 1.762 Vali Acc: 0.497 Test Loss: 1.762 Test Acc: 0.497
Validation loss decreased (-0.221855 --> -0.496857).  Saving model ...
Epoch: 3 cost time: 0.520625114440918
Epoch: 3, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.475 Vali Acc: 0.662 Test Loss: 1.475 Test Acc: 0.662
Validation loss decreased (-0.496857 --> -0.662485).  Saving model ...
Epoch: 4 cost time: 0.5841505527496338
Epoch: 4, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.201 Vali Acc: 0.741 Test Loss: 1.201 Test Acc: 0.741
Validation loss decreased (-0.662485 --> -0.740613).  Saving model ...
Epoch: 5 cost time: 0.5182700157165527
Epoch: 5, Steps: 8 | Train Loss: 1.028 Vali Loss: 0.975 Vali Acc: 0.753 Test Loss: 0.975 Test Acc: 0.753
Validation loss decreased (-0.740613 --> -0.753115).  Saving model ...
Epoch: 6 cost time: 0.5645530223846436
Epoch: 6, Steps: 8 | Train Loss: 0.813 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.753115 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 0.520251989364624
Epoch: 7, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.715 Vali Acc: 0.778 Test Loss: 0.715 Test Acc: 0.778
Validation loss decreased (-0.774992 --> -0.778118).  Saving model ...
Epoch: 8 cost time: 0.5324101448059082
Epoch: 8, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.778118 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 0.5204546451568604
Epoch: 9, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.799994 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.5150032043457031
Epoch: 10, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.570 Vali Acc: 0.831 Test Loss: 0.570 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 0.5223636627197266
Epoch: 11, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.559246301651001
Epoch: 12, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5128936767578125
Epoch: 13, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5071132183074951
Epoch: 14, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4898085594177246
Epoch: 15, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4980192184448242
Epoch: 16, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5063624382019043
Epoch: 17, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.46429014205932617
Epoch: 18, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5333287715911865
Epoch: 19, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.39763379096984863
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.628 Vali Acc: 0.806 Test Loss: 0.628 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 115379
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6257505416870117
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.092 Vali Acc: 0.138 Test Loss: 2.092 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.5131535530090332
Epoch: 2, Steps: 8 | Train Loss: 1.986 Vali Loss: 1.852 Vali Acc: 0.369 Test Loss: 1.852 Test Acc: 0.369
Validation loss decreased (-0.137479 --> -0.368731).  Saving model ...
Epoch: 3 cost time: 0.5363011360168457
Epoch: 3, Steps: 8 | Train Loss: 1.716 Vali Loss: 1.547 Vali Acc: 0.588 Test Loss: 1.547 Test Acc: 0.588
Validation loss decreased (-0.368731 --> -0.587485).  Saving model ...
Epoch: 4 cost time: 0.5864982604980469
Epoch: 4, Steps: 8 | Train Loss: 1.382 Vali Loss: 1.259 Vali Acc: 0.684 Test Loss: 1.259 Test Acc: 0.684
Validation loss decreased (-0.587485 --> -0.684362).  Saving model ...
Epoch: 5 cost time: 0.5125143527984619
Epoch: 5, Steps: 8 | Train Loss: 1.096 Vali Loss: 1.013 Vali Acc: 0.772 Test Loss: 1.013 Test Acc: 0.772
Validation loss decreased (-0.684362 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.5352945327758789
Epoch: 6, Steps: 8 | Train Loss: 0.874 Vali Loss: 0.841 Vali Acc: 0.784 Test Loss: 0.841 Test Acc: 0.784
Validation loss decreased (-0.771865 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.5245423316955566
Epoch: 7, Steps: 8 | Train Loss: 0.674 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.784367 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5533525943756104
Epoch: 8, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
Validation loss decreased (-0.799993 --> -0.815618).  Saving model ...
Epoch: 9 cost time: 0.5975182056427002
Epoch: 9, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.605 Vali Acc: 0.825 Test Loss: 0.605 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.5362758636474609
Epoch: 10, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 0.4821138381958008
Epoch: 11, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 0.5347778797149658
Epoch: 12, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4500100612640381
Epoch: 13, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4714016914367676
Epoch: 14, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.510460376739502
Epoch: 15, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.46604132652282715
Epoch: 16, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.48659396171569824
Epoch: 17, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.595 Vali Acc: 0.816 Test Loss: 0.595 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4779038429260254
Epoch: 18, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4667928218841553
Epoch: 19, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5175294876098633
Epoch: 20, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6095492839813232
Epoch: 21, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 115736
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.7955374717712402
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.049 Vali Acc: 0.116 Test Loss: 2.049 Test Acc: 0.116
Validation loss decreased (inf --> -0.115605).  Saving model ...
Epoch: 2 cost time: 0.47099924087524414
Epoch: 2, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.812 Vali Acc: 0.356 Test Loss: 1.812 Test Acc: 0.356
Validation loss decreased (-0.115605 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 0.4893059730529785
Epoch: 3, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.520 Vali Acc: 0.606 Test Loss: 1.520 Test Acc: 0.606
Validation loss decreased (-0.356232 --> -0.606235).  Saving model ...
Epoch: 4 cost time: 0.5156943798065186
Epoch: 4, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.238 Vali Acc: 0.725 Test Loss: 1.238 Test Acc: 0.725
Validation loss decreased (-0.606235 --> -0.724988).  Saving model ...
Epoch: 5 cost time: 0.501908540725708
Epoch: 5, Steps: 8 | Train Loss: 1.066 Vali Loss: 1.009 Vali Acc: 0.781 Test Loss: 1.009 Test Acc: 0.781
Validation loss decreased (-0.724988 --> -0.781240).  Saving model ...
Epoch: 6 cost time: 0.5563466548919678
Epoch: 6, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.837 Vali Acc: 0.800 Test Loss: 0.837 Test Acc: 0.800
Validation loss decreased (-0.781240 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.4423685073852539
Epoch: 7, Steps: 8 | Train Loss: 0.707 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.45374250411987305
Epoch: 8, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.5450921058654785
Epoch: 9, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.5190632343292236
Epoch: 10, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.5363259315490723
Epoch: 11, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.5470445156097412
Epoch: 12, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.49169063568115234
Epoch: 13, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4819514751434326
Epoch: 14, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.49062323570251465
Epoch: 15, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5743834972381592
Epoch: 16, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5788941383361816
Epoch: 17, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4606335163116455
Epoch: 18, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5869443416595459
Epoch: 19, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.526925802230835
Epoch: 20, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.617 Vali Acc: 0.812 Test Loss: 0.617 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6051931381225586
Epoch: 21, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 115467
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5299503803253174
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.132 Vali Acc: 0.084 Test Loss: 2.132 Test Acc: 0.084
Validation loss decreased (inf --> -0.084354).  Saving model ...
Epoch: 2 cost time: 0.49043869972229004
Epoch: 2, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.868 Vali Acc: 0.297 Test Loss: 1.868 Test Acc: 0.297
Validation loss decreased (-0.084354 --> -0.296856).  Saving model ...
Epoch: 3 cost time: 0.41622281074523926
Epoch: 3, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.541 Vali Acc: 0.581 Test Loss: 1.541 Test Acc: 0.581
Validation loss decreased (-0.296856 --> -0.581235).  Saving model ...
Epoch: 4 cost time: 0.45452189445495605
Epoch: 4, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.232 Vali Acc: 0.738 Test Loss: 1.232 Test Acc: 0.738
Validation loss decreased (-0.581235 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.4780154228210449
Epoch: 5, Steps: 8 | Train Loss: 1.053 Vali Loss: 0.977 Vali Acc: 0.769 Test Loss: 0.977 Test Acc: 0.769
Validation loss decreased (-0.737488 --> -0.768740).  Saving model ...
Epoch: 6 cost time: 0.44582700729370117
Epoch: 6, Steps: 8 | Train Loss: 0.813 Vali Loss: 0.808 Vali Acc: 0.784 Test Loss: 0.808 Test Acc: 0.784
Validation loss decreased (-0.768740 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.5099961757659912
Epoch: 7, Steps: 8 | Train Loss: 0.680 Vali Loss: 0.688 Vali Acc: 0.794 Test Loss: 0.688 Test Acc: 0.794
Validation loss decreased (-0.784367 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.4254114627838135
Epoch: 8, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.628 Vali Acc: 0.803 Test Loss: 0.628 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.42853546142578125
Epoch: 9, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.593 Vali Acc: 0.800 Test Loss: 0.593 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.48790836334228516
Epoch: 10, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
Validation loss decreased (-0.803119 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.45282459259033203
Epoch: 11, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.4979262351989746
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5827202796936035
Epoch: 13, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.559 Vali Acc: 0.812 Test Loss: 0.559 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.43033599853515625
Epoch: 14, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5342843532562256
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5462658405303955
Epoch: 16, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5884823799133301
Epoch: 17, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4550483226776123
Epoch: 18, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4713454246520996
Epoch: 19, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5358591079711914
Epoch: 20, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.603 Vali Acc: 0.806 Test Loss: 0.603 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5857105255126953
Epoch: 21, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.622 Vali Acc: 0.797 Test Loss: 0.622 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 114572
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4833858013153076
Epoch: 1, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.913 Vali Acc: 0.287 Test Loss: 1.913 Test Acc: 0.287
Validation loss decreased (inf --> -0.287481).  Saving model ...
Epoch: 2 cost time: 0.4244499206542969
Epoch: 2, Steps: 8 | Train Loss: 1.785 Vali Loss: 1.686 Vali Acc: 0.497 Test Loss: 1.686 Test Acc: 0.497
Validation loss decreased (-0.287481 --> -0.496858).  Saving model ...
Epoch: 3 cost time: 0.4636373519897461
Epoch: 3, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.405 Vali Acc: 0.697 Test Loss: 1.405 Test Acc: 0.697
Validation loss decreased (-0.496858 --> -0.696861).  Saving model ...
Epoch: 4 cost time: 0.5157358646392822
Epoch: 4, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.140 Vali Acc: 0.762 Test Loss: 1.140 Test Acc: 0.762
Validation loss decreased (-0.696861 --> -0.762489).  Saving model ...
Epoch: 5 cost time: 0.4901409149169922
Epoch: 5, Steps: 8 | Train Loss: 0.993 Vali Loss: 0.928 Vali Acc: 0.781 Test Loss: 0.928 Test Acc: 0.781
Validation loss decreased (-0.762489 --> -0.781241).  Saving model ...
Epoch: 6 cost time: 0.4625821113586426
Epoch: 6, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.775 Vali Acc: 0.806 Test Loss: 0.775 Test Acc: 0.806
Validation loss decreased (-0.781241 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.5326018333435059
Epoch: 7, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.422504186630249
Epoch: 8, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
Validation loss decreased (-0.806242 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.5438375473022461
Epoch: 9, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.588 Vali Acc: 0.806 Test Loss: 0.588 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.42285609245300293
Epoch: 10, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3717923164367676
Epoch: 11, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.4752941131591797
Epoch: 12, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43950939178466797
Epoch: 13, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.44095563888549805
Epoch: 14, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5363423824310303
Epoch: 15, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.49469518661499023
Epoch: 16, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4658799171447754
Epoch: 17, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.535041093826294
Epoch: 18, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.45638537406921387
Epoch: 19, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5710251331329346
Epoch: 20, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5118722915649414
Epoch: 21, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 113051
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8413872718811035
Epoch: 1, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.977 Vali Acc: 0.272 Test Loss: 1.977 Test Acc: 0.272
Validation loss decreased (inf --> -0.271855).  Saving model ...
Epoch: 2 cost time: 0.6484689712524414
Epoch: 2, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.740 Vali Acc: 0.481 Test Loss: 1.740 Test Acc: 0.481
Validation loss decreased (-0.271855 --> -0.481233).  Saving model ...
Epoch: 3 cost time: 0.5237267017364502
Epoch: 3, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.454 Vali Acc: 0.591 Test Loss: 1.454 Test Acc: 0.591
Validation loss decreased (-0.481233 --> -0.590610).  Saving model ...
Epoch: 4 cost time: 0.5225839614868164
Epoch: 4, Steps: 8 | Train Loss: 1.262 Vali Loss: 1.176 Vali Acc: 0.759 Test Loss: 1.176 Test Acc: 0.759
Validation loss decreased (-0.590610 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.5030250549316406
Epoch: 5, Steps: 8 | Train Loss: 1.029 Vali Loss: 0.949 Vali Acc: 0.787 Test Loss: 0.949 Test Acc: 0.787
Validation loss decreased (-0.759363 --> -0.787491).  Saving model ...
Epoch: 6 cost time: 0.5312209129333496
Epoch: 6, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.797 Vali Acc: 0.806 Test Loss: 0.797 Test Acc: 0.806
Validation loss decreased (-0.787491 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.5496153831481934
Epoch: 7, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.695 Vali Acc: 0.812 Test Loss: 0.695 Test Acc: 0.812
Validation loss decreased (-0.806242 --> -0.812493).  Saving model ...
Epoch: 8 cost time: 0.5074329376220703
Epoch: 8, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.642 Vali Acc: 0.816 Test Loss: 0.642 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.42899060249328613
Epoch: 9, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.46451377868652344
Epoch: 10, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.49285078048706055
Epoch: 11, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.5669980049133301
Epoch: 12, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4438896179199219
Epoch: 13, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.461637020111084
Epoch: 14, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4672691822052002
Epoch: 15, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.45717597007751465
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.623542308807373
Epoch: 17, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.48856592178344727
Epoch: 18, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4982645511627197
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5488913059234619
Epoch: 20, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5292885303497314
Epoch: 21, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 111996
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8609874248504639
Epoch: 1, Steps: 8 | Train Loss: 2.290 Vali Loss: 2.141 Vali Acc: 0.172 Test Loss: 2.141 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.5616681575775146
Epoch: 2, Steps: 8 | Train Loss: 2.087 Vali Loss: 1.885 Vali Acc: 0.278 Test Loss: 1.885 Test Acc: 0.278
Validation loss decreased (-0.171854 --> -0.278106).  Saving model ...
Epoch: 3 cost time: 0.5681796073913574
Epoch: 3, Steps: 8 | Train Loss: 1.779 Vali Loss: 1.576 Vali Acc: 0.600 Test Loss: 1.576 Test Acc: 0.600
Validation loss decreased (-0.278106 --> -0.599984).  Saving model ...
Epoch: 4 cost time: 0.5375969409942627
Epoch: 4, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.267 Vali Acc: 0.741 Test Loss: 1.267 Test Acc: 0.741
Validation loss decreased (-0.599984 --> -0.740612).  Saving model ...
Epoch: 5 cost time: 0.5549986362457275
Epoch: 5, Steps: 8 | Train Loss: 1.147 Vali Loss: 1.009 Vali Acc: 0.778 Test Loss: 1.009 Test Acc: 0.778
Validation loss decreased (-0.740612 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.6168477535247803
Epoch: 6, Steps: 8 | Train Loss: 0.885 Vali Loss: 0.823 Vali Acc: 0.803 Test Loss: 0.823 Test Acc: 0.803
Validation loss decreased (-0.778115 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.5890564918518066
Epoch: 7, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.702 Vali Acc: 0.812 Test Loss: 0.702 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812493).  Saving model ...
Epoch: 8 cost time: 0.530958890914917
Epoch: 8, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.4923248291015625
Epoch: 9, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.4572889804840088
Epoch: 10, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.5857665538787842
Epoch: 11, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.5989484786987305
Epoch: 12, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 0.45859384536743164
Epoch: 13, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 0.4942319393157959
Epoch: 14, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.475477933883667
Epoch: 15, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47889041900634766
Epoch: 16, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.567786693572998
Epoch: 17, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5876221656799316
Epoch: 18, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.46666526794433594
Epoch: 19, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4577066898345947
Epoch: 20, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.47687578201293945
Epoch: 21, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5473740100860596
Epoch: 22, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5505461692810059
Epoch: 23, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 110847
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs79_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.798295021057129
Epoch: 1, Steps: 8 | Train Loss: 2.072 Vali Loss: 2.016 Vali Acc: 0.175 Test Loss: 2.016 Test Acc: 0.175
Validation loss decreased (inf --> -0.174980).  Saving model ...
Epoch: 2 cost time: 0.5041451454162598
Epoch: 2, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.785 Vali Acc: 0.409 Test Loss: 1.785 Test Acc: 0.409
Validation loss decreased (-0.174980 --> -0.409357).  Saving model ...
Epoch: 3 cost time: 0.5752360820770264
Epoch: 3, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.497 Vali Acc: 0.603 Test Loss: 1.497 Test Acc: 0.603
Validation loss decreased (-0.409357 --> -0.603110).  Saving model ...
Epoch: 4 cost time: 0.5787725448608398
Epoch: 4, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.227 Vali Acc: 0.694 Test Loss: 1.227 Test Acc: 0.694
Validation loss decreased (-0.603110 --> -0.693738).  Saving model ...
Epoch: 5 cost time: 0.49183225631713867
Epoch: 5, Steps: 8 | Train Loss: 1.074 Vali Loss: 0.997 Vali Acc: 0.741 Test Loss: 0.997 Test Acc: 0.741
Validation loss decreased (-0.693738 --> -0.740615).  Saving model ...
Epoch: 6 cost time: 0.5443727970123291
Epoch: 6, Steps: 8 | Train Loss: 0.845 Vali Loss: 0.853 Vali Acc: 0.759 Test Loss: 0.853 Test Acc: 0.759
Validation loss decreased (-0.740615 --> -0.759366).  Saving model ...
Epoch: 7 cost time: 0.533865213394165
Epoch: 7, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
Validation loss decreased (-0.759366 --> -0.778118).  Saving model ...
Epoch: 8 cost time: 0.5787248611450195
Epoch: 8, Steps: 8 | Train Loss: 0.595 Vali Loss: 0.653 Vali Acc: 0.806 Test Loss: 0.653 Test Acc: 0.806
Validation loss decreased (-0.778118 --> -0.806243).  Saving model ...
Epoch: 9 cost time: 0.5627799034118652
Epoch: 9, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.5691583156585693
Epoch: 10, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.5136706829071045
Epoch: 11, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 12 cost time: 0.5082824230194092
Epoch: 12, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 0.46586060523986816
Epoch: 13, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 0.5572986602783203
Epoch: 14, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.555 Vali Acc: 0.838 Test Loss: 0.555 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 0.5697894096374512
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5000960826873779
Epoch: 16, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5237338542938232
Epoch: 17, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.55222487449646
Epoch: 18, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4038050174713135
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5002014636993408
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5139236450195312
Epoch: 21, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.621 Vali Acc: 0.816 Test Loss: 0.621 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.48724985122680664
Epoch: 22, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.624 Vali Acc: 0.812 Test Loss: 0.624 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.43865013122558594
Epoch: 23, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.664 Vali Acc: 0.806 Test Loss: 0.664 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5179867744445801
Epoch: 24, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs79_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 110764
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6672999858856201
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.010 Vali Acc: 0.241 Test Loss: 2.010 Test Acc: 0.241
Validation loss decreased (inf --> -0.240605).  Saving model ...
Epoch: 2 cost time: 0.537071704864502
Epoch: 2, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.771 Vali Acc: 0.459 Test Loss: 1.771 Test Acc: 0.459
Validation loss decreased (-0.240605 --> -0.459357).  Saving model ...
Epoch: 3 cost time: 0.5545694828033447
Epoch: 3, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.474 Vali Acc: 0.669 Test Loss: 1.474 Test Acc: 0.669
Validation loss decreased (-0.459357 --> -0.668735).  Saving model ...
Epoch: 4 cost time: 0.5024044513702393
Epoch: 4, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.184 Vali Acc: 0.738 Test Loss: 1.184 Test Acc: 0.738
Validation loss decreased (-0.668735 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.5833837985992432
Epoch: 5, Steps: 8 | Train Loss: 1.029 Vali Loss: 0.965 Vali Acc: 0.769 Test Loss: 0.965 Test Acc: 0.769
Validation loss decreased (-0.737488 --> -0.768740).  Saving model ...
Epoch: 6 cost time: 0.4745523929595947
Epoch: 6, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.793 Vali Acc: 0.797 Test Loss: 0.793 Test Acc: 0.797
Validation loss decreased (-0.768740 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5337550640106201
Epoch: 7, Steps: 8 | Train Loss: 0.711 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.520211935043335
Epoch: 8, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.5243089199066162
Epoch: 9, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.48613977432250977
Epoch: 10, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.48827195167541504
Epoch: 11, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 12 cost time: 0.42783665657043457
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.48493313789367676
Epoch: 13, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.47066402435302734
Epoch: 14, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4915308952331543
Epoch: 15, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5421807765960693
Epoch: 16, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.43239378929138184
Epoch: 17, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.40271639823913574
Epoch: 18, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5131592750549316
Epoch: 19, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.45126795768737793
Epoch: 20, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5396156311035156
Epoch: 21, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 110215
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5225830078125
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 1.994 Vali Acc: 0.203 Test Loss: 1.994 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 0.4302525520324707
Epoch: 2, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.758 Vali Acc: 0.438 Test Loss: 1.758 Test Acc: 0.438
Validation loss decreased (-0.203105 --> -0.437482).  Saving model ...
Epoch: 3 cost time: 0.5878760814666748
Epoch: 3, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.470 Vali Acc: 0.622 Test Loss: 1.470 Test Acc: 0.622
Validation loss decreased (-0.437482 --> -0.621860).  Saving model ...
Epoch: 4 cost time: 0.5174527168273926
Epoch: 4, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.190 Vali Acc: 0.738 Test Loss: 1.190 Test Acc: 0.738
Validation loss decreased (-0.621860 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.5024785995483398
Epoch: 5, Steps: 8 | Train Loss: 1.058 Vali Loss: 0.966 Vali Acc: 0.766 Test Loss: 0.966 Test Acc: 0.766
Validation loss decreased (-0.737488 --> -0.765615).  Saving model ...
Epoch: 6 cost time: 0.531144380569458
Epoch: 6, Steps: 8 | Train Loss: 0.838 Vali Loss: 0.810 Vali Acc: 0.797 Test Loss: 0.810 Test Acc: 0.797
Validation loss decreased (-0.765615 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5320992469787598
Epoch: 7, Steps: 8 | Train Loss: 0.675 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.5233848094940186
Epoch: 8, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.548011302947998
Epoch: 9, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.6098828315734863
Epoch: 10, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5977699756622314
Epoch: 11, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.5912690162658691
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.5116550922393799
Epoch: 13, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5017061233520508
Epoch: 14, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5174610614776611
Epoch: 15, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5982856750488281
Epoch: 16, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5771870613098145
Epoch: 17, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5240600109100342
Epoch: 18, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5093429088592529
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4862532615661621
Epoch: 20, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5695292949676514
Epoch: 21, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.645 Vali Acc: 0.800 Test Loss: 0.645 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.47895145416259766
Epoch: 22, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.821875
model parameter : 111026
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.26949143409729
Epoch: 1, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.945 Vali Acc: 0.259 Test Loss: 1.945 Test Acc: 0.259
Validation loss decreased (inf --> -0.259356).  Saving model ...
Epoch: 2 cost time: 0.45996665954589844
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.715 Vali Acc: 0.419 Test Loss: 1.715 Test Acc: 0.419
Validation loss decreased (-0.259356 --> -0.418733).  Saving model ...
Epoch: 3 cost time: 0.4920635223388672
Epoch: 3, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.426 Vali Acc: 0.706 Test Loss: 1.426 Test Acc: 0.706
Validation loss decreased (-0.418733 --> -0.706236).  Saving model ...
Epoch: 4 cost time: 0.5252368450164795
Epoch: 4, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.157 Vali Acc: 0.778 Test Loss: 1.157 Test Acc: 0.778
Validation loss decreased (-0.706236 --> -0.778113).  Saving model ...
Epoch: 5 cost time: 0.41521239280700684
Epoch: 5, Steps: 8 | Train Loss: 0.997 Vali Loss: 0.928 Vali Acc: 0.803 Test Loss: 0.928 Test Acc: 0.803
Validation loss decreased (-0.778113 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 0.4183170795440674
Epoch: 6, Steps: 8 | Train Loss: 0.795 Vali Loss: 0.765 Vali Acc: 0.816 Test Loss: 0.765 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815617).  Saving model ...
Epoch: 7 cost time: 0.4875493049621582
Epoch: 7, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.658 Vali Acc: 0.834 Test Loss: 0.658 Test Acc: 0.834
Validation loss decreased (-0.815617 --> -0.834368).  Saving model ...
Epoch: 8 cost time: 0.49417901039123535
Epoch: 8, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.42561841011047363
Epoch: 9, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3712289333343506
Epoch: 10, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
Validation loss decreased (-0.834368 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.45942211151123047
Epoch: 11, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.45961427688598633
Epoch: 12, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43973660469055176
Epoch: 13, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.47559547424316406
Epoch: 14, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4360067844390869
Epoch: 15, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5262012481689453
Epoch: 16, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4446413516998291
Epoch: 17, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.570 Vali Acc: 0.831 Test Loss: 0.570 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4599339962005615
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5423064231872559
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5117967128753662
Epoch: 20, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5648810863494873
Epoch: 21, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 109983
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5295181274414062
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 2.018 Vali Acc: 0.134 Test Loss: 2.018 Test Acc: 0.134
Validation loss decreased (inf --> -0.134355).  Saving model ...
Epoch: 2 cost time: 0.48504042625427246
Epoch: 2, Steps: 8 | Train Loss: 1.922 Vali Loss: 1.773 Vali Acc: 0.397 Test Loss: 1.773 Test Acc: 0.397
Validation loss decreased (-0.134355 --> -0.396857).  Saving model ...
Epoch: 3 cost time: 0.44738030433654785
Epoch: 3, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.476 Vali Acc: 0.659 Test Loss: 1.476 Test Acc: 0.659
Validation loss decreased (-0.396857 --> -0.659360).  Saving model ...
Epoch: 4 cost time: 0.4587593078613281
Epoch: 4, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.191 Vali Acc: 0.775 Test Loss: 1.191 Test Acc: 0.775
Validation loss decreased (-0.659360 --> -0.774988).  Saving model ...
Epoch: 5 cost time: 0.43944740295410156
Epoch: 5, Steps: 8 | Train Loss: 1.029 Vali Loss: 0.961 Vali Acc: 0.791 Test Loss: 0.961 Test Acc: 0.791
Validation loss decreased (-0.774988 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 0.4197554588317871
Epoch: 6, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.805 Vali Acc: 0.797 Test Loss: 0.805 Test Acc: 0.797
Validation loss decreased (-0.790615 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.47343921661376953
Epoch: 7, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.691 Vali Acc: 0.803 Test Loss: 0.691 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.4973599910736084
Epoch: 8, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.625 Vali Acc: 0.819 Test Loss: 0.625 Test Acc: 0.819
Validation loss decreased (-0.803118 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.4349546432495117
Epoch: 9, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.38933730125427246
Epoch: 10, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 0.4802088737487793
Epoch: 11, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48065781593322754
Epoch: 12, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.4454324245452881
Epoch: 13, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4179267883300781
Epoch: 14, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3804178237915039
Epoch: 15, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.46435546875
Epoch: 16, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5168612003326416
Epoch: 17, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.46413183212280273
Epoch: 18, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4670593738555908
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.606 Vali Acc: 0.806 Test Loss: 0.606 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.3657865524291992
Epoch: 20, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.36780381202697754
Epoch: 21, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.39199161529541016
Epoch: 22, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.644 Vali Acc: 0.806 Test Loss: 0.644 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 111512
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.690882682800293
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.023 Vali Acc: 0.206 Test Loss: 2.023 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 0.4839444160461426
Epoch: 2, Steps: 8 | Train Loss: 1.945 Vali Loss: 1.783 Vali Acc: 0.381 Test Loss: 1.783 Test Acc: 0.381
Validation loss decreased (-0.206230 --> -0.381232).  Saving model ...
Epoch: 3 cost time: 0.5269041061401367
Epoch: 3, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.485 Vali Acc: 0.656 Test Loss: 1.485 Test Acc: 0.656
Validation loss decreased (-0.381232 --> -0.656235).  Saving model ...
Epoch: 4 cost time: 0.4996306896209717
Epoch: 4, Steps: 8 | Train Loss: 1.334 Vali Loss: 1.203 Vali Acc: 0.750 Test Loss: 1.203 Test Acc: 0.750
Validation loss decreased (-0.656235 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 0.5139486789703369
Epoch: 5, Steps: 8 | Train Loss: 1.039 Vali Loss: 0.974 Vali Acc: 0.775 Test Loss: 0.974 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.4958021640777588
Epoch: 6, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.795 Vali Acc: 0.784 Test Loss: 0.795 Test Acc: 0.784
Validation loss decreased (-0.774990 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.4419710636138916
Epoch: 7, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.684 Vali Acc: 0.797 Test Loss: 0.684 Test Acc: 0.797
Validation loss decreased (-0.784367 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.48912668228149414
Epoch: 8, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.627 Vali Acc: 0.806 Test Loss: 0.627 Test Acc: 0.806
Validation loss decreased (-0.796868 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.5176599025726318
Epoch: 9, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
Validation loss decreased (-0.806244 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.47177743911743164
Epoch: 10, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 0.4942896366119385
Epoch: 11, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.45273780822753906
Epoch: 12, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.3773224353790283
Epoch: 13, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47849392890930176
Epoch: 14, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5088000297546387
Epoch: 15, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.49591851234436035
Epoch: 16, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.44675469398498535
Epoch: 17, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.40320634841918945
Epoch: 18, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4180428981781006
Epoch: 19, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.45514869689941406
Epoch: 20, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.46846938133239746
Epoch: 21, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.48946499824523926
Epoch: 22, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 109895
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.665562629699707
Epoch: 1, Steps: 8 | Train Loss: 2.022 Vali Loss: 1.996 Vali Acc: 0.300 Test Loss: 1.996 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 0.5176165103912354
Epoch: 2, Steps: 8 | Train Loss: 1.869 Vali Loss: 1.754 Vali Acc: 0.466 Test Loss: 1.754 Test Acc: 0.466
Validation loss decreased (-0.299980 --> -0.465607).  Saving model ...
Epoch: 3 cost time: 0.5540318489074707
Epoch: 3, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.472 Vali Acc: 0.662 Test Loss: 1.472 Test Acc: 0.662
Validation loss decreased (-0.465607 --> -0.662485).  Saving model ...
Epoch: 4 cost time: 0.5443522930145264
Epoch: 4, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.202 Vali Acc: 0.738 Test Loss: 1.202 Test Acc: 0.738
Validation loss decreased (-0.662485 --> -0.737488).  Saving model ...
Epoch: 5 cost time: 0.5418074131011963
Epoch: 5, Steps: 8 | Train Loss: 1.044 Vali Loss: 0.973 Vali Acc: 0.759 Test Loss: 0.973 Test Acc: 0.759
Validation loss decreased (-0.737488 --> -0.759365).  Saving model ...
Epoch: 6 cost time: 0.5136504173278809
Epoch: 6, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.803 Vali Acc: 0.787 Test Loss: 0.803 Test Acc: 0.787
Validation loss decreased (-0.759365 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.49867773056030273
Epoch: 7, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.698 Vali Acc: 0.809 Test Loss: 0.698 Test Acc: 0.809
Validation loss decreased (-0.787492 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 0.5322103500366211
Epoch: 8, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.5564391613006592
Epoch: 9, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.5573170185089111
Epoch: 10, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 0.5739865303039551
Epoch: 11, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.5464205741882324
Epoch: 12, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5336229801177979
Epoch: 13, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.553826093673706
Epoch: 14, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5599339008331299
Epoch: 15, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5455939769744873
Epoch: 16, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.40033650398254395
Epoch: 17, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.576 Vali Acc: 0.834 Test Loss: 0.576 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4304931163787842
Epoch: 18, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.577 Vali Acc: 0.831 Test Loss: 0.577 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5206053256988525
Epoch: 19, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5650968551635742
Epoch: 20, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5166454315185547
Epoch: 21, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 111464
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.4882304668426514
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.100 Vali Acc: 0.166 Test Loss: 2.100 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 0.47017979621887207
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.843 Vali Acc: 0.322 Test Loss: 1.843 Test Acc: 0.322
Validation loss decreased (-0.165604 --> -0.321857).  Saving model ...
Epoch: 3 cost time: 0.4631638526916504
Epoch: 3, Steps: 8 | Train Loss: 1.695 Vali Loss: 1.528 Vali Acc: 0.656 Test Loss: 1.528 Test Acc: 0.656
Validation loss decreased (-0.321857 --> -0.656235).  Saving model ...
Epoch: 4 cost time: 0.49709057807922363
Epoch: 4, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.225 Vali Acc: 0.759 Test Loss: 1.225 Test Acc: 0.759
Validation loss decreased (-0.656235 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.5484402179718018
Epoch: 5, Steps: 8 | Train Loss: 1.062 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
Validation loss decreased (-0.759363 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.4975862503051758
Epoch: 6, Steps: 8 | Train Loss: 0.828 Vali Loss: 0.814 Vali Acc: 0.794 Test Loss: 0.814 Test Acc: 0.794
Validation loss decreased (-0.774990 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.4769773483276367
Epoch: 7, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
Validation loss decreased (-0.793742 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.5239818096160889
Epoch: 8, Steps: 8 | Train Loss: 0.571 Vali Loss: 0.632 Vali Acc: 0.812 Test Loss: 0.632 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.5058374404907227
Epoch: 9, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.48053789138793945
Epoch: 10, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 0.5540666580200195
Epoch: 11, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 0.5409646034240723
Epoch: 12, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.46164417266845703
Epoch: 13, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4790980815887451
Epoch: 14, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5920372009277344
Epoch: 15, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.48111629486083984
Epoch: 16, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5564734935760498
Epoch: 17, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5314462184906006
Epoch: 18, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.49369215965270996
Epoch: 19, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.43050193786621094
Epoch: 20, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4241323471069336
Epoch: 21, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 111147
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5479910373687744
Epoch: 1, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.948 Vali Acc: 0.278 Test Loss: 1.948 Test Acc: 0.278
Validation loss decreased (inf --> -0.278106).  Saving model ...
Epoch: 2 cost time: 0.47301626205444336
Epoch: 2, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.716 Vali Acc: 0.487 Test Loss: 1.716 Test Acc: 0.487
Validation loss decreased (-0.278106 --> -0.487483).  Saving model ...
Epoch: 3 cost time: 0.5299673080444336
Epoch: 3, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.432 Vali Acc: 0.650 Test Loss: 1.432 Test Acc: 0.650
Validation loss decreased (-0.487483 --> -0.649986).  Saving model ...
Epoch: 4 cost time: 0.4951446056365967
Epoch: 4, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.168 Vali Acc: 0.725 Test Loss: 1.168 Test Acc: 0.725
Validation loss decreased (-0.649986 --> -0.724988).  Saving model ...
Epoch: 5 cost time: 0.5656678676605225
Epoch: 5, Steps: 8 | Train Loss: 0.976 Vali Loss: 0.959 Vali Acc: 0.756 Test Loss: 0.959 Test Acc: 0.756
Validation loss decreased (-0.724988 --> -0.756240).  Saving model ...
Epoch: 6 cost time: 0.5338690280914307
Epoch: 6, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.798 Vali Acc: 0.784 Test Loss: 0.798 Test Acc: 0.784
Validation loss decreased (-0.756240 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.5184061527252197
Epoch: 7, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.784367 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5025079250335693
Epoch: 8, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.628 Vali Acc: 0.806 Test Loss: 0.628 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.5619590282440186
Epoch: 9, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.552804708480835
Epoch: 10, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.5517282485961914
Epoch: 11, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.5393421649932861
Epoch: 12, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.5265457630157471
Epoch: 13, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.51983642578125
Epoch: 14, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5143420696258545
Epoch: 15, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5638747215270996
Epoch: 16, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5649447441101074
Epoch: 17, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4953627586364746
Epoch: 18, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4638023376464844
Epoch: 19, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5725307464599609
Epoch: 20, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5881168842315674
Epoch: 21, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5301260948181152
Epoch: 22, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.644 Vali Acc: 0.812 Test Loss: 0.644 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 112740
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5835604667663574
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.056 Vali Acc: 0.156 Test Loss: 2.056 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.4074270725250244
Epoch: 2, Steps: 8 | Train Loss: 1.962 Vali Loss: 1.807 Vali Acc: 0.472 Test Loss: 1.807 Test Acc: 0.472
Validation loss decreased (-0.156229 --> -0.471857).  Saving model ...
Epoch: 3 cost time: 0.42761993408203125
Epoch: 3, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.500 Vali Acc: 0.644 Test Loss: 1.500 Test Acc: 0.644
Validation loss decreased (-0.471857 --> -0.643735).  Saving model ...
Epoch: 4 cost time: 0.5919625759124756
Epoch: 4, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.215 Vali Acc: 0.734 Test Loss: 1.215 Test Acc: 0.734
Validation loss decreased (-0.643735 --> -0.734363).  Saving model ...
Epoch: 5 cost time: 0.4633455276489258
Epoch: 5, Steps: 8 | Train Loss: 1.049 Vali Loss: 0.981 Vali Acc: 0.772 Test Loss: 0.981 Test Acc: 0.772
Validation loss decreased (-0.734363 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.5285766124725342
Epoch: 6, Steps: 8 | Train Loss: 0.873 Vali Loss: 0.811 Vali Acc: 0.800 Test Loss: 0.811 Test Acc: 0.800
Validation loss decreased (-0.771865 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5480563640594482
Epoch: 7, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5420405864715576
Epoch: 8, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 0.4630005359649658
Epoch: 9, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.495469331741333
Epoch: 10, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.46851277351379395
Epoch: 11, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.5287609100341797
Epoch: 12, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.5248830318450928
Epoch: 13, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47444581985473633
Epoch: 14, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4958987236022949
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5316388607025146
Epoch: 16, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5388813018798828
Epoch: 17, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5042035579681396
Epoch: 18, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4877455234527588
Epoch: 19, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.507408857345581
Epoch: 20, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.46721911430358887
Epoch: 21, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.614 Vali Acc: 0.816 Test Loss: 0.614 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4815659523010254
Epoch: 22, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.641 Vali Acc: 0.816 Test Loss: 0.641 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 113077
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6395351886749268
Epoch: 1, Steps: 8 | Train Loss: 2.054 Vali Loss: 1.960 Vali Acc: 0.297 Test Loss: 1.960 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 0.4812192916870117
Epoch: 2, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.727 Vali Acc: 0.481 Test Loss: 1.727 Test Acc: 0.481
Validation loss decreased (-0.296855 --> -0.481233).  Saving model ...
Epoch: 3 cost time: 0.3632645606994629
Epoch: 3, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.450 Vali Acc: 0.706 Test Loss: 1.450 Test Acc: 0.706
Validation loss decreased (-0.481233 --> -0.706235).  Saving model ...
Epoch: 4 cost time: 0.46103620529174805
Epoch: 4, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.186 Vali Acc: 0.759 Test Loss: 1.186 Test Acc: 0.759
Validation loss decreased (-0.706235 --> -0.759363).  Saving model ...
Epoch: 5 cost time: 0.45423364639282227
Epoch: 5, Steps: 8 | Train Loss: 1.083 Vali Loss: 0.950 Vali Acc: 0.778 Test Loss: 0.950 Test Acc: 0.778
Validation loss decreased (-0.759363 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.387099027633667
Epoch: 6, Steps: 8 | Train Loss: 0.819 Vali Loss: 0.803 Vali Acc: 0.794 Test Loss: 0.803 Test Acc: 0.794
Validation loss decreased (-0.778115 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 0.39989781379699707
Epoch: 7, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.702 Vali Acc: 0.791 Test Loss: 0.702 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4508936405181885
Epoch: 8, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
Validation loss decreased (-0.793742 --> -0.803119).  Saving model ...
Epoch: 9 cost time: 0.4175393581390381
Epoch: 9, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 10 cost time: 0.5155377388000488
Epoch: 10, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.803119 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 0.5241575241088867
Epoch: 11, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47102975845336914
Epoch: 12, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5537865161895752
Epoch: 13, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5273077487945557
Epoch: 14, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5097899436950684
Epoch: 15, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 0.5247139930725098
Epoch: 16, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.45920634269714355
Epoch: 17, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6071414947509766
Epoch: 18, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5258114337921143
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5327322483062744
Epoch: 20, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4579310417175293
Epoch: 21, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.618 Vali Acc: 0.806 Test Loss: 0.618 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5200445652008057
Epoch: 22, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5620458126068115
Epoch: 23, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.664 Vali Acc: 0.791 Test Loss: 0.664 Test Acc: 0.791
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5356559753417969
Epoch: 24, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5231029987335205
Epoch: 25, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 112158
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5468449592590332
Epoch: 1, Steps: 8 | Train Loss: 2.022 Vali Loss: 1.945 Vali Acc: 0.250 Test Loss: 1.945 Test Acc: 0.250
Validation loss decreased (inf --> -0.249981).  Saving model ...
Epoch: 2 cost time: 0.556910514831543
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.715 Vali Acc: 0.428 Test Loss: 1.715 Test Acc: 0.428
Validation loss decreased (-0.249981 --> -0.428108).  Saving model ...
Epoch: 3 cost time: 0.5076961517333984
Epoch: 3, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.426 Vali Acc: 0.706 Test Loss: 1.426 Test Acc: 0.706
Validation loss decreased (-0.428108 --> -0.706236).  Saving model ...
Epoch: 4 cost time: 0.4030187129974365
Epoch: 4, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.156 Vali Acc: 0.775 Test Loss: 1.156 Test Acc: 0.775
Validation loss decreased (-0.706236 --> -0.774988).  Saving model ...
Epoch: 5 cost time: 0.4852001667022705
Epoch: 5, Steps: 8 | Train Loss: 0.996 Vali Loss: 0.928 Vali Acc: 0.803 Test Loss: 0.928 Test Acc: 0.803
Validation loss decreased (-0.774988 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 0.4758462905883789
Epoch: 6, Steps: 8 | Train Loss: 0.795 Vali Loss: 0.765 Vali Acc: 0.816 Test Loss: 0.765 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815617).  Saving model ...
Epoch: 7 cost time: 0.43062305450439453
Epoch: 7, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.658 Vali Acc: 0.834 Test Loss: 0.658 Test Acc: 0.834
Validation loss decreased (-0.815617 --> -0.834368).  Saving model ...
Epoch: 8 cost time: 0.4409182071685791
Epoch: 8, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4499084949493408
Epoch: 9, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4017348289489746
Epoch: 10, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.834368 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.44724225997924805
Epoch: 11, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.43991589546203613
Epoch: 12, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4978625774383545
Epoch: 13, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4789454936981201
Epoch: 14, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.45827817916870117
Epoch: 15, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.506070613861084
Epoch: 16, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4681077003479004
Epoch: 17, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.570 Vali Acc: 0.831 Test Loss: 0.570 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4723782539367676
Epoch: 18, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.45395517349243164
Epoch: 19, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.616 Vali Acc: 0.806 Test Loss: 0.616 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.49803948402404785
Epoch: 20, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5190842151641846
Epoch: 21, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 109983
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5706520080566406
Epoch: 1, Steps: 8 | Train Loss: 2.079 Vali Loss: 1.908 Vali Acc: 0.316 Test Loss: 1.908 Test Acc: 0.316
Validation loss decreased (inf --> -0.315606).  Saving model ...
Epoch: 2 cost time: 0.4271962642669678
Epoch: 2, Steps: 8 | Train Loss: 1.897 Vali Loss: 1.689 Vali Acc: 0.497 Test Loss: 1.689 Test Acc: 0.497
Validation loss decreased (-0.315606 --> -0.496858).  Saving model ...
Epoch: 3 cost time: 0.40345191955566406
Epoch: 3, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.411 Vali Acc: 0.703 Test Loss: 1.411 Test Acc: 0.703
Validation loss decreased (-0.496858 --> -0.703111).  Saving model ...
Epoch: 4 cost time: 0.491070032119751
Epoch: 4, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.145 Vali Acc: 0.769 Test Loss: 1.145 Test Acc: 0.769
Validation loss decreased (-0.703111 --> -0.768739).  Saving model ...
Epoch: 5 cost time: 0.36571574211120605
Epoch: 5, Steps: 8 | Train Loss: 1.033 Vali Loss: 0.933 Vali Acc: 0.781 Test Loss: 0.933 Test Acc: 0.781
Validation loss decreased (-0.768739 --> -0.781241).  Saving model ...
Epoch: 6 cost time: 0.4340198040008545
Epoch: 6, Steps: 8 | Train Loss: 0.849 Vali Loss: 0.779 Vali Acc: 0.787 Test Loss: 0.779 Test Acc: 0.787
Validation loss decreased (-0.781241 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.4801962375640869
Epoch: 7, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
Validation loss decreased (-0.787492 --> -0.803118).  Saving model ...
Epoch: 8 cost time: 0.41510725021362305
Epoch: 8, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.620 Vali Acc: 0.812 Test Loss: 0.620 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.5650184154510498
Epoch: 9, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 0.3837299346923828
Epoch: 10, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.577 Vali Acc: 0.812 Test Loss: 0.577 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 0.4389808177947998
Epoch: 11, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.4232485294342041
Epoch: 12, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 13 cost time: 0.46725893020629883
Epoch: 13, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4887571334838867
Epoch: 14, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.44674205780029297
Epoch: 15, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5086557865142822
Epoch: 16, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.560248851776123
Epoch: 17, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5362071990966797
Epoch: 18, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.47109055519104004
Epoch: 19, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5413234233856201
Epoch: 20, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4901459217071533
Epoch: 21, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5303902626037598
Epoch: 22, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.626 Vali Acc: 0.816 Test Loss: 0.626 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 111608
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6065313816070557
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 2.103 Vali Acc: 0.134 Test Loss: 2.103 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 0.4329500198364258
Epoch: 2, Steps: 8 | Train Loss: 1.995 Vali Loss: 1.843 Vali Acc: 0.359 Test Loss: 1.843 Test Acc: 0.359
Validation loss decreased (-0.134354 --> -0.359357).  Saving model ...
Epoch: 3 cost time: 0.5638480186462402
Epoch: 3, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.532 Vali Acc: 0.659 Test Loss: 1.532 Test Acc: 0.659
Validation loss decreased (-0.359357 --> -0.659360).  Saving model ...
Epoch: 4 cost time: 0.47157955169677734
Epoch: 4, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.238 Vali Acc: 0.747 Test Loss: 1.238 Test Acc: 0.747
Validation loss decreased (-0.659360 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.5060725212097168
Epoch: 5, Steps: 8 | Train Loss: 1.074 Vali Loss: 0.991 Vali Acc: 0.791 Test Loss: 0.991 Test Acc: 0.791
Validation loss decreased (-0.746863 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 0.39055943489074707
Epoch: 6, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.815 Vali Acc: 0.819 Test Loss: 0.815 Test Acc: 0.819
Validation loss decreased (-0.790615 --> -0.818742).  Saving model ...
Epoch: 7 cost time: 0.421917200088501
Epoch: 7, Steps: 8 | Train Loss: 0.697 Vali Loss: 0.691 Vali Acc: 0.819 Test Loss: 0.691 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 0.5101268291473389
Epoch: 8, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.632 Vali Acc: 0.825 Test Loss: 0.632 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.5248129367828369
Epoch: 9, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.4552130699157715
Epoch: 10, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 0.46752381324768066
Epoch: 11, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5486383438110352
Epoch: 12, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 0.4503507614135742
Epoch: 13, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5228664875030518
Epoch: 14, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5118463039398193
Epoch: 15, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.46372175216674805
Epoch: 16, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.41684842109680176
Epoch: 17, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.46242809295654297
Epoch: 18, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5035572052001953
Epoch: 19, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.590224027633667
Epoch: 20, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6168699264526367
Epoch: 21, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.645 Vali Acc: 0.797 Test Loss: 0.645 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5160105228424072
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 112607
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.6077077388763428
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.052 Vali Acc: 0.159 Test Loss: 2.052 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.5000593662261963
Epoch: 2, Steps: 8 | Train Loss: 1.959 Vali Loss: 1.807 Vali Acc: 0.350 Test Loss: 1.807 Test Acc: 0.350
Validation loss decreased (-0.159354 --> -0.349982).  Saving model ...
Epoch: 3 cost time: 0.49939703941345215
Epoch: 3, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.499 Vali Acc: 0.644 Test Loss: 1.499 Test Acc: 0.644
Validation loss decreased (-0.349982 --> -0.643735).  Saving model ...
Epoch: 4 cost time: 0.5126814842224121
Epoch: 4, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.205 Vali Acc: 0.756 Test Loss: 1.205 Test Acc: 0.756
Validation loss decreased (-0.643735 --> -0.756238).  Saving model ...
Epoch: 5 cost time: 0.480313777923584
Epoch: 5, Steps: 8 | Train Loss: 1.043 Vali Loss: 0.967 Vali Acc: 0.787 Test Loss: 0.967 Test Acc: 0.787
Validation loss decreased (-0.756238 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 0.5352413654327393
Epoch: 6, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.808 Vali Acc: 0.787 Test Loss: 0.808 Test Acc: 0.787
Validation loss decreased (-0.787490 --> -0.787492).  Saving model ...
Epoch: 7 cost time: 0.5005176067352295
Epoch: 7, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.696 Vali Acc: 0.794 Test Loss: 0.696 Test Acc: 0.794
Validation loss decreased (-0.787492 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.4613950252532959
Epoch: 8, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
Validation loss decreased (-0.793743 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.5583906173706055
Epoch: 9, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 0.48523449897766113
Epoch: 10, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 0.44890689849853516
Epoch: 11, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 0.5261754989624023
Epoch: 12, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 13 cost time: 0.5279245376586914
Epoch: 13, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5308616161346436
Epoch: 14, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4859745502471924
Epoch: 15, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.48172497749328613
Epoch: 16, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828119).  Saving model ...
Epoch: 17 cost time: 0.5305473804473877
Epoch: 17, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 18 cost time: 0.4717228412628174
Epoch: 18, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.582 Vali Acc: 0.831 Test Loss: 0.582 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4911477565765381
Epoch: 19, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.44948792457580566
Epoch: 20, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4553985595703125
Epoch: 21, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5419769287109375
Epoch: 22, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5159142017364502
Epoch: 23, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.539482593536377
Epoch: 24, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5261640548706055
Epoch: 25, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.47124266624450684
Epoch: 26, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.45192956924438477
Epoch: 27, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 112980
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8096449375152588
Epoch: 1, Steps: 8 | Train Loss: 2.022 Vali Loss: 1.946 Vali Acc: 0.322 Test Loss: 1.946 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 0.465395450592041
Epoch: 2, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.708 Vali Acc: 0.528 Test Loss: 1.708 Test Acc: 0.528
Validation loss decreased (-0.321856 --> -0.528108).  Saving model ...
Epoch: 3 cost time: 0.48343586921691895
Epoch: 3, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.426 Vali Acc: 0.681 Test Loss: 1.426 Test Acc: 0.681
Validation loss decreased (-0.528108 --> -0.681236).  Saving model ...
Epoch: 4 cost time: 0.5269739627838135
Epoch: 4, Steps: 8 | Train Loss: 1.272 Vali Loss: 1.150 Vali Acc: 0.734 Test Loss: 1.150 Test Acc: 0.734
Validation loss decreased (-0.681236 --> -0.734364).  Saving model ...
Epoch: 5 cost time: 0.5023086071014404
Epoch: 5, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.940 Vali Acc: 0.769 Test Loss: 0.940 Test Acc: 0.769
Validation loss decreased (-0.734364 --> -0.768741).  Saving model ...
Epoch: 6 cost time: 0.5369336605072021
Epoch: 6, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.789 Vali Acc: 0.800 Test Loss: 0.789 Test Acc: 0.800
Validation loss decreased (-0.768741 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.5115771293640137
Epoch: 7, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.45844101905822754
Epoch: 8, Steps: 8 | Train Loss: 0.575 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 0.4075164794921875
Epoch: 9, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.4815361499786377
Epoch: 10, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 0.5149428844451904
Epoch: 11, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4294126033782959
Epoch: 12, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4075510501861572
Epoch: 13, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.43188977241516113
Epoch: 14, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.522301197052002
Epoch: 15, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 0.536949634552002
Epoch: 16, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.406630277633667
Epoch: 17, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4625520706176758
Epoch: 18, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4084188938140869
Epoch: 19, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.603 Vali Acc: 0.816 Test Loss: 0.603 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5033588409423828
Epoch: 20, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5289850234985352
Epoch: 21, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.623 Vali Acc: 0.809 Test Loss: 0.623 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5174248218536377
Epoch: 22, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.45806264877319336
Epoch: 23, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4627845287322998
Epoch: 24, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5237853527069092
Epoch: 25, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 112727
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8689744472503662
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.032 Vali Acc: 0.209 Test Loss: 2.032 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 0.4681577682495117
Epoch: 2, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.788 Vali Acc: 0.441 Test Loss: 1.788 Test Acc: 0.441
Validation loss decreased (-0.209355 --> -0.440607).  Saving model ...
Epoch: 3 cost time: 0.5562210083007812
Epoch: 3, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.498 Vali Acc: 0.613 Test Loss: 1.498 Test Acc: 0.613
Validation loss decreased (-0.440607 --> -0.612485).  Saving model ...
Epoch: 4 cost time: 0.5260169506072998
Epoch: 4, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.217 Vali Acc: 0.725 Test Loss: 1.217 Test Acc: 0.725
Validation loss decreased (-0.612485 --> -0.724988).  Saving model ...
Epoch: 5 cost time: 0.577725887298584
Epoch: 5, Steps: 8 | Train Loss: 1.069 Vali Loss: 0.982 Vali Acc: 0.772 Test Loss: 0.982 Test Acc: 0.772
Validation loss decreased (-0.724988 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.5306270122528076
Epoch: 6, Steps: 8 | Train Loss: 0.824 Vali Loss: 0.810 Vali Acc: 0.797 Test Loss: 0.810 Test Acc: 0.797
Validation loss decreased (-0.771865 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.5670890808105469
Epoch: 7, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.694 Vali Acc: 0.797 Test Loss: 0.694 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.43433570861816406
Epoch: 8, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
Validation loss decreased (-0.796868 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.46415090560913086
Epoch: 9, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.586 Vali Acc: 0.825 Test Loss: 0.586 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.4573032855987549
Epoch: 10, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.564 Vali Acc: 0.834 Test Loss: 0.564 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 0.5492904186248779
Epoch: 11, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 0.5339477062225342
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47270703315734863
Epoch: 13, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 0.4864473342895508
Epoch: 14, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4224059581756592
Epoch: 15, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.42873382568359375
Epoch: 16, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4882054328918457
Epoch: 17, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5144333839416504
Epoch: 18, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3927016258239746
Epoch: 19, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.608 Vali Acc: 0.812 Test Loss: 0.608 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5036334991455078
Epoch: 20, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.628 Vali Acc: 0.800 Test Loss: 0.628 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.512214183807373
Epoch: 21, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5632975101470947
Epoch: 22, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5929486751556396
Epoch: 23, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.654 Vali Acc: 0.806 Test Loss: 0.654 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 111848
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.5371761322021484
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.038 Vali Acc: 0.122 Test Loss: 2.038 Test Acc: 0.122
Validation loss decreased (inf --> -0.121855).  Saving model ...
Epoch: 2 cost time: 0.608090877532959
Epoch: 2, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.786 Vali Acc: 0.391 Test Loss: 1.786 Test Acc: 0.391
Validation loss decreased (-0.121855 --> -0.390607).  Saving model ...
Epoch: 3 cost time: 0.540203332901001
Epoch: 3, Steps: 8 | Train Loss: 1.675 Vali Loss: 1.482 Vali Acc: 0.634 Test Loss: 1.482 Test Acc: 0.634
Validation loss decreased (-0.390607 --> -0.634360).  Saving model ...
Epoch: 4 cost time: 0.46129679679870605
Epoch: 4, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.208 Vali Acc: 0.741 Test Loss: 1.208 Test Acc: 0.741
Validation loss decreased (-0.634360 --> -0.740613).  Saving model ...
Epoch: 5 cost time: 0.4973576068878174
Epoch: 5, Steps: 8 | Train Loss: 1.064 Vali Loss: 0.985 Vali Acc: 0.772 Test Loss: 0.985 Test Acc: 0.772
Validation loss decreased (-0.740613 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.5068559646606445
Epoch: 6, Steps: 8 | Train Loss: 0.855 Vali Loss: 0.809 Vali Acc: 0.781 Test Loss: 0.809 Test Acc: 0.781
Validation loss decreased (-0.771865 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.4959409236907959
Epoch: 7, Steps: 8 | Train Loss: 0.672 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
Validation loss decreased (-0.781242 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.5677275657653809
Epoch: 8, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.623 Vali Acc: 0.812 Test Loss: 0.623 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812494).  Saving model ...
Epoch: 9 cost time: 0.4754047393798828
Epoch: 9, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 10 cost time: 0.40387701988220215
Epoch: 10, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5620076656341553
Epoch: 11, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.49305033683776855
Epoch: 12, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 0.4936964511871338
Epoch: 13, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.5086307525634766
Epoch: 14, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.37554216384887695
Epoch: 15, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4022643566131592
Epoch: 16, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.481656551361084
Epoch: 17, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4587740898132324
Epoch: 18, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4375159740447998
Epoch: 19, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4802265167236328
Epoch: 20, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.619 Vali Acc: 0.812 Test Loss: 0.619 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.40727853775024414
Epoch: 21, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4259672164916992
Epoch: 22, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.48575901985168457
Epoch: 23, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_LightTS_UEA_ftM_sl315_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 110343
model size : 0.43MB
