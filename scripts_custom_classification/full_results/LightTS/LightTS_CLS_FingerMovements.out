Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5896027088165283
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 0.8496630191802979
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.697 Vali Acc: 0.540 Test Loss: 0.697 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 0.7725062370300293
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8865683078765869
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8970680236816406
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9374339580535889
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9085125923156738
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8739023208618164
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8734698295593262
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8752799034118652
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 11 cost time: 0.857647180557251
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9310433864593506
Epoch: 12, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8725681304931641
Epoch: 13, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.722 Vali Acc: 0.600 Test Loss: 0.722 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 0.9134387969970703
Epoch: 14, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8948049545288086
Epoch: 15, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9082918167114258
Epoch: 16, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8352196216583252
Epoch: 17, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9692661762237549
Epoch: 18, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.991 Vali Acc: 0.530 Test Loss: 0.991 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.971207857131958
Epoch: 19, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.933 Vali Acc: 0.550 Test Loss: 0.933 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9275820255279541
Epoch: 20, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9213428497314453
Epoch: 21, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.262 Vali Acc: 0.520 Test Loss: 1.262 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0274453163146973
Epoch: 22, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.474 Vali Acc: 0.520 Test Loss: 1.474 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9586987495422363
Epoch: 23, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 115032
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.308380603790283
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.071239709854126
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.704 Vali Acc: 0.450 Test Loss: 0.704 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7986941337585449
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9116287231445312
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.731 Vali Acc: 0.450 Test Loss: 0.731 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1554489135742188
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.942826509475708
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.758 Vali Acc: 0.440 Test Loss: 0.758 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9754631519317627
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8732237815856934
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.766 Vali Acc: 0.470 Test Loss: 0.766 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8596467971801758
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0349912643432617
Epoch: 10, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0225365161895752
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 113048
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.357901096343994
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 0.8380112648010254
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0594422817230225
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2267258167266846
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.172520399093628
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.760 Vali Acc: 0.460 Test Loss: 0.760 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.105175495147705
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0012671947479248
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0071165561676025
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.774 Vali Acc: 0.460 Test Loss: 0.774 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.059664249420166
Epoch: 9, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1288344860076904
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1275222301483154
Epoch: 11, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 1.0181787014007568
Epoch: 12, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.949953556060791
Epoch: 13, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.748 Vali Acc: 0.560 Test Loss: 0.748 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9734904766082764
Epoch: 14, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9357156753540039
Epoch: 15, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1596193313598633
Epoch: 16, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2650363445281982
Epoch: 17, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.850 Vali Acc: 0.540 Test Loss: 0.850 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0895893573760986
Epoch: 18, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0705792903900146
Epoch: 19, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.947 Vali Acc: 0.530 Test Loss: 0.947 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0393133163452148
Epoch: 20, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.988 Vali Acc: 0.480 Test Loss: 0.988 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.144132375717163
Epoch: 21, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.075 Vali Acc: 0.480 Test Loss: 1.075 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 112092
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8469855785369873
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.689 Vali Acc: 0.510 Test Loss: 0.689 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.1499710083007812
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9336113929748535
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.717 Vali Acc: 0.450 Test Loss: 0.717 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9938333034515381
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2940549850463867
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.1348779201507568
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0461995601654053
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0560145378112793
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.1633751392364502
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1974101066589355
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3122472763061523
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1058566570281982
Epoch: 12, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0845956802368164
Epoch: 13, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4979956150054932
Epoch: 14, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.833 Vali Acc: 0.540 Test Loss: 0.833 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 15 cost time: 1.0627450942993164
Epoch: 15, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 1.105745792388916
Epoch: 16, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.912 Vali Acc: 0.440 Test Loss: 0.912 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1287167072296143
Epoch: 17, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.833 Vali Acc: 0.540 Test Loss: 0.833 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0452325344085693
Epoch: 18, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.804 Vali Acc: 0.480 Test Loss: 0.804 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1379046440124512
Epoch: 19, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.906 Vali Acc: 0.550 Test Loss: 0.906 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549991).  Saving model ...
Epoch: 20 cost time: 1.0607693195343018
Epoch: 20, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579992).  Saving model ...
Epoch: 21 cost time: 0.9366796016693115
Epoch: 21, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.941 Vali Acc: 0.490 Test Loss: 0.941 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2411613464355469
Epoch: 22, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.896 Vali Acc: 0.570 Test Loss: 0.896 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2073054313659668
Epoch: 23, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.057 Vali Acc: 0.560 Test Loss: 1.057 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.020073413848877
Epoch: 24, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.216 Vali Acc: 0.550 Test Loss: 1.216 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0338761806488037
Epoch: 25, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.967 Vali Acc: 0.540 Test Loss: 0.967 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8506989479064941
Epoch: 26, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.129 Vali Acc: 0.510 Test Loss: 1.129 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0180022716522217
Epoch: 27, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.183 Vali Acc: 0.560 Test Loss: 1.183 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3327264785766602
Epoch: 28, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.140 Vali Acc: 0.510 Test Loss: 1.140 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.068570613861084
Epoch: 29, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.295 Vali Acc: 0.550 Test Loss: 1.295 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4349195957183838
Epoch: 30, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.274 Vali Acc: 0.560 Test Loss: 1.274 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 111246
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.482272148132324
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.675 Vali Acc: 0.540 Test Loss: 0.675 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.0313127040863037
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.682 Vali Acc: 0.580 Test Loss: 0.682 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 1.1967582702636719
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.712 Vali Acc: 0.560 Test Loss: 0.712 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9441683292388916
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.706 Vali Acc: 0.480 Test Loss: 0.706 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.157944679260254
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1378147602081299
Epoch: 6, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.91194748878479
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.017746925354004
Epoch: 8, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1053626537322998
Epoch: 9, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.152073860168457
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.690 Vali Acc: 0.480 Test Loss: 0.690 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.984612226486206
Epoch: 11, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.703 Vali Acc: 0.570 Test Loss: 0.703 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2150161266326904
Epoch: 12, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 111216
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6292035579681396
Epoch: 1, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.708 Vali Acc: 0.460 Test Loss: 0.708 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.3522796630859375
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.731 Vali Acc: 0.400 Test Loss: 0.731 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9767322540283203
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 1.263273000717163
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3172221183776855
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 1.1911187171936035
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 0.9669642448425293
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.004772424697876
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.050241231918335
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 0.9052777290344238
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0516777038574219
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3460230827331543
Epoch: 12, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9858598709106445
Epoch: 13, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1411452293395996
Epoch: 14, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0018131732940674
Epoch: 15, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1445226669311523
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1565518379211426
Epoch: 17, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0734915733337402
Epoch: 18, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1319842338562012
Epoch: 19, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 111090
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8974223136901855
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.0518975257873535
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.739 Vali Acc: 0.440 Test Loss: 0.739 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1820600032806396
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.743 Vali Acc: 0.440 Test Loss: 0.743 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0879921913146973
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.0008690357208252
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.755 Vali Acc: 0.460 Test Loss: 0.755 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9487602710723877
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 1.2387406826019287
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.155599594116211
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1207880973815918
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4002485275268555
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0051734447479248
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1095247268676758
Epoch: 12, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0856785774230957
Epoch: 13, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3879542350769043
Epoch: 14, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0786077976226807
Epoch: 15, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.044081211090088
Epoch: 16, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 110868
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.610051393508911
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.0742385387420654
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.719 Vali Acc: 0.470 Test Loss: 0.719 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2722210884094238
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.258357286453247
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0224015712738037
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.088090419769287
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.067032814025879
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9537196159362793
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.135740041732788
Epoch: 9, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0239934921264648
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.736 Vali Acc: 0.450 Test Loss: 0.736 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9408330917358398
Epoch: 11, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 110550
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.868443250656128
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.703 Vali Acc: 0.440 Test Loss: 0.703 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.2000212669372559
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.711 Vali Acc: 0.450 Test Loss: 0.711 Test Acc: 0.450
Validation loss decreased (-0.439993 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 1.1491639614105225
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.719 Vali Acc: 0.460 Test Loss: 0.719 Test Acc: 0.460
Validation loss decreased (-0.449993 --> -0.459993).  Saving model ...
Epoch: 4 cost time: 1.2380945682525635
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.216590166091919
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3165814876556396
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.729 Vali Acc: 0.440 Test Loss: 0.729 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.480445384979248
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9428606033325195
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1143054962158203
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.097764492034912
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2412104606628418
Epoch: 11, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0175104141235352
Epoch: 12, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 13 cost time: 0.8847141265869141
Epoch: 13, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.706 Vali Acc: 0.560 Test Loss: 0.706 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 0.9901125431060791
Epoch: 14, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.731 Vali Acc: 0.570 Test Loss: 0.731 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 15 cost time: 1.1817119121551514
Epoch: 15, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1695709228515625
Epoch: 16, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0837855339050293
Epoch: 17, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.176781177520752
Epoch: 18, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2505342960357666
Epoch: 19, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.925 Vali Acc: 0.470 Test Loss: 0.925 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1120123863220215
Epoch: 20, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0339546203613281
Epoch: 21, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.147 Vali Acc: 0.530 Test Loss: 1.147 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1960573196411133
Epoch: 22, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.937819242477417
Epoch: 23, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.070 Vali Acc: 0.470 Test Loss: 1.070 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8700323104858398
Epoch: 24, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.415 Vali Acc: 0.420 Test Loss: 1.415 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 110136
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7530622482299805
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.681 Vali Acc: 0.500 Test Loss: 0.681 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1738395690917969
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.695 Vali Acc: 0.490 Test Loss: 0.695 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1299104690551758
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1241779327392578
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9860069751739502
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0749850273132324
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2681901454925537
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.0113873481750488
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9610710144042969
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9299139976501465
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0914933681488037
Epoch: 11, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0099408626556396
Epoch: 12, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7619245052337646
Epoch: 13, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.20367431640625
Epoch: 14, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.765 Vali Acc: 0.470 Test Loss: 0.765 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.077568769454956
Epoch: 15, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8826131820678711
Epoch: 16, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.859 Vali Acc: 0.490 Test Loss: 0.859 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9953935146331787
Epoch: 17, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 110130
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.701333999633789
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.681 Vali Acc: 0.520 Test Loss: 0.681 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.9805727005004883
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9394533634185791
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.725 Vali Acc: 0.420 Test Loss: 0.725 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0490179061889648
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.726 Vali Acc: 0.470 Test Loss: 0.726 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.25339937210083
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9870667457580566
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0673222541809082
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0717287063598633
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0530071258544922
Epoch: 9, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.112959623336792
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2563762664794922
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.737 Vali Acc: 0.450 Test Loss: 0.737 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm512_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 110080
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.647942304611206
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.685 Vali Acc: 0.490 Test Loss: 0.685 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 0.9387044906616211
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.695 Vali Acc: 0.470 Test Loss: 0.695 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.406531572341919
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.718 Vali Acc: 0.460 Test Loss: 0.718 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4913852214813232
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.750 Vali Acc: 0.410 Test Loss: 0.750 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1574721336364746
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.732 Vali Acc: 0.430 Test Loss: 0.732 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0146145820617676
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1493785381317139
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1869957447052002
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.749 Vali Acc: 0.460 Test Loss: 0.749 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.033320665359497
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.751 Vali Acc: 0.450 Test Loss: 0.751 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3478353023529053
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.745 Vali Acc: 0.450 Test Loss: 0.745 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1991348266601562
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 36056
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7203760147094727
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.706 Vali Acc: 0.410 Test Loss: 0.706 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.3763799667358398
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.713 Vali Acc: 0.400 Test Loss: 0.713 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2536683082580566
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.725 Vali Acc: 0.440 Test Loss: 0.725 Test Acc: 0.440
Validation loss decreased (-0.409993 --> -0.439993).  Saving model ...
Epoch: 4 cost time: 1.0383882522583008
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.754 Vali Acc: 0.430 Test Loss: 0.754 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1589422225952148
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.755 Vali Acc: 0.460 Test Loss: 0.755 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459992).  Saving model ...
Epoch: 6 cost time: 1.1208720207214355
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469993).  Saving model ...
Epoch: 7 cost time: 1.1287806034088135
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1466753482818604
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 9 cost time: 1.0597176551818848
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.733 Vali Acc: 0.450 Test Loss: 0.733 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9372174739837646
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519992).  Saving model ...
Epoch: 11 cost time: 1.310246229171753
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 12 cost time: 0.9665801525115967
Epoch: 12, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1750130653381348
Epoch: 13, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 1.2511682510375977
Epoch: 14, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9557631015777588
Epoch: 15, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.731 Vali Acc: 0.560 Test Loss: 0.731 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1630053520202637
Epoch: 16, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.721 Vali Acc: 0.580 Test Loss: 0.721 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 17 cost time: 1.281367301940918
Epoch: 17, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.724 Vali Acc: 0.580 Test Loss: 0.724 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1689465045928955
Epoch: 18, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 19 cost time: 1.2129321098327637
Epoch: 19, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.704 Vali Acc: 0.630 Test Loss: 0.704 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629993).  Saving model ...
Epoch: 20 cost time: 1.3290750980377197
Epoch: 20, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.702 Vali Acc: 0.600 Test Loss: 0.702 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0030086040496826
Epoch: 21, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0597729682922363
Epoch: 22, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.759 Vali Acc: 0.620 Test Loss: 0.759 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2637109756469727
Epoch: 23, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.855 Vali Acc: 0.600 Test Loss: 0.855 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1160109043121338
Epoch: 24, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.888 Vali Acc: 0.600 Test Loss: 0.888 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1098947525024414
Epoch: 25, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.833 Vali Acc: 0.580 Test Loss: 0.833 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3914544582366943
Epoch: 26, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.910 Vali Acc: 0.590 Test Loss: 0.910 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1420390605926514
Epoch: 27, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0687439441680908
Epoch: 28, Steps: 20 | Train Loss: 0.340 Vali Loss: 0.868 Vali Acc: 0.560 Test Loss: 0.868 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2756850719451904
Epoch: 29, Steps: 20 | Train Loss: 0.336 Vali Loss: 0.911 Vali Acc: 0.590 Test Loss: 0.911 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 35096
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.65726900100708
Epoch: 1, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.118905782699585
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.716 Vali Acc: 0.440 Test Loss: 0.716 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9375967979431152
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8802392482757568
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9384353160858154
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.731 Vali Acc: 0.450 Test Loss: 0.731 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0468096733093262
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1242327690124512
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.056062936782837
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.737 Vali Acc: 0.450 Test Loss: 0.737 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.189997673034668
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.732 Vali Acc: 0.460 Test Loss: 0.732 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.951746940612793
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9810338020324707
Epoch: 11, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 0.9708948135375977
Epoch: 12, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2071466445922852
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 14 cost time: 1.0405099391937256
Epoch: 14, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.116586446762085
Epoch: 15, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0914182662963867
Epoch: 16, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0550651550292969
Epoch: 17, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0643885135650635
Epoch: 18, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1755595207214355
Epoch: 19, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.956566572189331
Epoch: 20, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.787 Vali Acc: 0.530 Test Loss: 0.787 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0949745178222656
Epoch: 21, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0471107959747314
Epoch: 22, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 23 cost time: 1.1568942070007324
Epoch: 23, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.903 Vali Acc: 0.540 Test Loss: 0.903 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9206161499023438
Epoch: 24, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 25 cost time: 0.9466097354888916
Epoch: 25, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0369019508361816
Epoch: 26, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.210 Vali Acc: 0.540 Test Loss: 1.210 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.167205572128296
Epoch: 27, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.296 Vali Acc: 0.530 Test Loss: 1.296 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1790223121643066
Epoch: 28, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.337 Vali Acc: 0.520 Test Loss: 1.337 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0188331604003906
Epoch: 29, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.415 Vali Acc: 0.510 Test Loss: 1.415 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1374664306640625
Epoch: 30, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.689 Vali Acc: 0.550 Test Loss: 1.689 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.020038366317749
Epoch: 31, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.771 Vali Acc: 0.510 Test Loss: 1.771 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9165537357330322
Epoch: 32, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.812 Vali Acc: 0.550 Test Loss: 1.812 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0848345756530762
Epoch: 33, Steps: 20 | Train Loss: 0.126 Vali Loss: 2.080 Vali Acc: 0.560 Test Loss: 2.080 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2881526947021484
Epoch: 34, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.952 Vali Acc: 0.560 Test Loss: 1.952 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 34652
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.933317184448242
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.694 Vali Acc: 0.490 Test Loss: 0.694 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.1478939056396484
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1151962280273438
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.3331201076507568
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2775533199310303
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3568742275238037
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.101597785949707
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3490054607391357
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.726 Vali Acc: 0.590 Test Loss: 0.726 Test Acc: 0.590
Validation loss decreased (-0.499993 --> -0.589993).  Saving model ...
Epoch: 9 cost time: 1.179908037185669
Epoch: 9, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8489181995391846
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9465785026550293
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2207491397857666
Epoch: 12, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8937914371490479
Epoch: 13, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.767 Vali Acc: 0.440 Test Loss: 0.767 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9813995361328125
Epoch: 14, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.792 Vali Acc: 0.470 Test Loss: 0.792 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2235050201416016
Epoch: 15, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0060794353485107
Epoch: 16, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9965603351593018
Epoch: 17, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0377612113952637
Epoch: 18, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 34190
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3140928745269775
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.672 Vali Acc: 0.580 Test Loss: 0.672 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.2942147254943848
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.676 Vali Acc: 0.510 Test Loss: 0.676 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.057581901550293
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.701 Vali Acc: 0.460 Test Loss: 0.701 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0381250381469727
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9593236446380615
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.715 Vali Acc: 0.430 Test Loss: 0.715 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0796475410461426
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.719 Vali Acc: 0.440 Test Loss: 0.719 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1136553287506104
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.995542049407959
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.748 Vali Acc: 0.460 Test Loss: 0.748 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4343876838684082
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.723 Vali Acc: 0.440 Test Loss: 0.723 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1543927192687988
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.278308629989624
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.727 Vali Acc: 0.450 Test Loss: 0.727 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 34288
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.750744581222534
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.707 Vali Acc: 0.530 Test Loss: 0.707 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.1554160118103027
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.699 Vali Acc: 0.460 Test Loss: 0.699 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.261197566986084
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.721 Vali Acc: 0.440 Test Loss: 0.721 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.987410306930542
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.737 Vali Acc: 0.430 Test Loss: 0.737 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9419465065002441
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.742 Vali Acc: 0.440 Test Loss: 0.742 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8881692886352539
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.734 Vali Acc: 0.440 Test Loss: 0.734 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9288225173950195
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0305607318878174
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8541975021362305
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9743459224700928
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.767 Vali Acc: 0.470 Test Loss: 0.767 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.027801275253296
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 0.8502330780029297
Epoch: 12, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1252987384796143
Epoch: 13, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9160144329071045
Epoch: 14, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.248849868774414
Epoch: 15, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.225461721420288
Epoch: 16, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9945371150970459
Epoch: 17, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0210342407226562
Epoch: 18, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.765 Vali Acc: 0.530 Test Loss: 0.765 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1462061405181885
Epoch: 19, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.698 Vali Acc: 0.570 Test Loss: 0.698 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 20 cost time: 1.0069305896759033
Epoch: 20, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0962913036346436
Epoch: 21, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1609735488891602
Epoch: 22, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.764 Vali Acc: 0.470 Test Loss: 0.764 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9325439929962158
Epoch: 23, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.795 Vali Acc: 0.450 Test Loss: 0.795 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.460089921951294
Epoch: 24, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.452991247177124
Epoch: 25, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.852 Vali Acc: 0.530 Test Loss: 0.852 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1380295753479004
Epoch: 26, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3868408203125
Epoch: 27, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.961 Vali Acc: 0.500 Test Loss: 0.961 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.19818115234375
Epoch: 28, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9966835975646973
Epoch: 29, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 34290
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9075920581817627
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.03346848487854
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.729 Vali Acc: 0.440 Test Loss: 0.729 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0641427040100098
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.727 Vali Acc: 0.450 Test Loss: 0.727 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9655771255493164
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 5 cost time: 0.8694100379943848
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.743 Vali Acc: 0.450 Test Loss: 0.743 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8945772647857666
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9652469158172607
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9443058967590332
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.749 Vali Acc: 0.460 Test Loss: 0.749 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1368212699890137
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9077820777893066
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 11 cost time: 0.8720400333404541
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 12 cost time: 0.7651004791259766
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 13 cost time: 0.9242322444915771
Epoch: 13, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 14 cost time: 0.9380395412445068
Epoch: 14, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.714 Vali Acc: 0.570 Test Loss: 0.714 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569993).  Saving model ...
Epoch: 15 cost time: 0.9063496589660645
Epoch: 15, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.771 Vali Acc: 0.590 Test Loss: 0.771 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 1.3075902462005615
Epoch: 16, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.959845781326294
Epoch: 17, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.734 Vali Acc: 0.610 Test Loss: 0.734 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609993).  Saving model ...
Epoch: 18 cost time: 1.047858715057373
Epoch: 18, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.794 Vali Acc: 0.570 Test Loss: 0.794 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8926181793212891
Epoch: 19, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8567757606506348
Epoch: 20, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.821 Vali Acc: 0.560 Test Loss: 0.821 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.973846435546875
Epoch: 21, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.808 Vali Acc: 0.560 Test Loss: 0.808 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0586435794830322
Epoch: 22, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.894 Vali Acc: 0.580 Test Loss: 0.894 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0784704685211182
Epoch: 23, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.946 Vali Acc: 0.550 Test Loss: 0.946 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1279561519622803
Epoch: 24, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.881 Vali Acc: 0.560 Test Loss: 0.881 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4685149192810059
Epoch: 25, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.915 Vali Acc: 0.580 Test Loss: 0.915 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9055943489074707
Epoch: 26, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.003 Vali Acc: 0.560 Test Loss: 1.003 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0139904022216797
Epoch: 27, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.021 Vali Acc: 0.570 Test Loss: 1.021 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 34196
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7755930423736572
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.712 Vali Acc: 0.430 Test Loss: 0.712 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.2728891372680664
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.719 Vali Acc: 0.370 Test Loss: 0.719 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9893088340759277
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.742 Vali Acc: 0.400 Test Loss: 0.742 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3281397819519043
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
Validation loss decreased (-0.429993 --> -0.459993).  Saving model ...
Epoch: 5 cost time: 1.065812587738037
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.747 Vali Acc: 0.440 Test Loss: 0.747 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8666932582855225
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0943248271942139
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
Validation loss decreased (-0.459993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 0.9664576053619385
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.783 Vali Acc: 0.440 Test Loss: 0.783 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0085468292236328
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.739 Vali Acc: 0.430 Test Loss: 0.739 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.913994312286377
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9126856327056885
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9688460826873779
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.826432466506958
Epoch: 13, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8766043186187744
Epoch: 14, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8318145275115967
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.707 Vali Acc: 0.570 Test Loss: 0.707 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 16 cost time: 0.973189115524292
Epoch: 16, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9044802188873291
Epoch: 17, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9888691902160645
Epoch: 18, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9740722179412842
Epoch: 19, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.803 Vali Acc: 0.560 Test Loss: 0.803 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9936490058898926
Epoch: 20, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9217603206634521
Epoch: 21, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.800 Vali Acc: 0.560 Test Loss: 0.800 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9748117923736572
Epoch: 22, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8896727561950684
Epoch: 23, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.888 Vali Acc: 0.550 Test Loss: 0.888 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9733567237854004
Epoch: 24, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2285869121551514
Epoch: 25, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 34006
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3481974601745605
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 0.9095616340637207
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.728 Vali Acc: 0.420 Test Loss: 0.728 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0209245681762695
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.717 Vali Acc: 0.460 Test Loss: 0.717 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0298972129821777
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2132678031921387
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.0330746173858643
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.710 Vali Acc: 0.470 Test Loss: 0.710 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.121593952178955
Epoch: 7, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0315320491790771
Epoch: 8, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7805728912353516
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9475851058959961
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8847129344940186
Epoch: 11, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 12 cost time: 0.9495463371276855
Epoch: 12, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9496910572052002
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1808617115020752
Epoch: 14, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2700536251068115
Epoch: 15, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0402836799621582
Epoch: 16, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.735 Vali Acc: 0.570 Test Loss: 0.735 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 17 cost time: 1.1341526508331299
Epoch: 17, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9371933937072754
Epoch: 18, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8802990913391113
Epoch: 19, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.845914363861084
Epoch: 20, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9333248138427734
Epoch: 21, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8490250110626221
Epoch: 22, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.798126220703125
Epoch: 23, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.828049898147583
Epoch: 24, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.981 Vali Acc: 0.540 Test Loss: 0.981 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8115835189819336
Epoch: 25, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.879 Vali Acc: 0.550 Test Loss: 0.879 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9101967811584473
Epoch: 26, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.851 Vali Acc: 0.510 Test Loss: 0.851 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 33720
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.549467086791992
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.704 Vali Acc: 0.440 Test Loss: 0.704 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 0.9567487239837646
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.709 Vali Acc: 0.430 Test Loss: 0.709 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1045246124267578
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.736 Vali Acc: 0.420 Test Loss: 0.736 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.029761791229248
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.750 Vali Acc: 0.450 Test Loss: 0.750 Test Acc: 0.450
Validation loss decreased (-0.439993 --> -0.449993).  Saving model ...
Epoch: 5 cost time: 0.9694180488586426
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.767 Vali Acc: 0.420 Test Loss: 0.767 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.009748935699463
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.753 Vali Acc: 0.470 Test Loss: 0.753 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469992).  Saving model ...
Epoch: 7 cost time: 1.0218122005462646
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.771 Vali Acc: 0.430 Test Loss: 0.771 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1440813541412354
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.776 Vali Acc: 0.430 Test Loss: 0.776 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.430873155593872
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.755 Vali Acc: 0.470 Test Loss: 0.755 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.059213638305664
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.765 Vali Acc: 0.430 Test Loss: 0.765 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1874475479125977
Epoch: 11, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519993).  Saving model ...
Epoch: 12 cost time: 0.9940671920776367
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.788 Vali Acc: 0.460 Test Loss: 0.788 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8315994739532471
Epoch: 13, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2203683853149414
Epoch: 14, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0082805156707764
Epoch: 15, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.744 Vali Acc: 0.570 Test Loss: 0.744 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 16 cost time: 0.9018833637237549
Epoch: 16, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.800 Vali Acc: 0.460 Test Loss: 0.800 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1826376914978027
Epoch: 17, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.802 Vali Acc: 0.460 Test Loss: 0.802 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.914984941482544
Epoch: 18, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9446921348571777
Epoch: 19, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2064704895019531
Epoch: 20, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.855 Vali Acc: 0.460 Test Loss: 0.855 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2152304649353027
Epoch: 21, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.846 Vali Acc: 0.540 Test Loss: 0.846 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9032063484191895
Epoch: 22, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.857 Vali Acc: 0.550 Test Loss: 0.857 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0065186023712158
Epoch: 23, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.917 Vali Acc: 0.530 Test Loss: 0.917 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8866918087005615
Epoch: 24, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.936 Vali Acc: 0.500 Test Loss: 0.936 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4695956707000732
Epoch: 25, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.928 Vali Acc: 0.550 Test Loss: 0.928 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 33842
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7369046211242676
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.9963998794555664
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0436341762542725
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.011671781539917
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0093011856079102
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.167072057723999
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9975135326385498
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1958963871002197
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.101644515991211
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 1.0697193145751953
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0711729526519775
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9622471332550049
Epoch: 12, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.025449275970459
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.707 Vali Acc: 0.570 Test Loss: 0.707 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.006819725036621
Epoch: 14, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9276041984558105
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5172092914581299
Epoch: 16, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0881669521331787
Epoch: 17, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.864 Vali Acc: 0.490 Test Loss: 0.864 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0964641571044922
Epoch: 18, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.740 Vali Acc: 0.600 Test Loss: 0.740 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 19 cost time: 1.006054162979126
Epoch: 19, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1863117218017578
Epoch: 20, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.020745038986206
Epoch: 21, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9103872776031494
Epoch: 22, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0039997100830078
Epoch: 23, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.896 Vali Acc: 0.580 Test Loss: 0.896 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0406737327575684
Epoch: 24, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3942816257476807
Epoch: 25, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.933 Vali Acc: 0.550 Test Loss: 0.933 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0722200870513916
Epoch: 26, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.055 Vali Acc: 0.570 Test Loss: 1.055 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1032962799072266
Epoch: 27, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.028 Vali Acc: 0.570 Test Loss: 1.028 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.067976474761963
Epoch: 28, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.011 Vali Acc: 0.550 Test Loss: 1.011 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm256_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 33920
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.841064691543579
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.0451881885528564
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.1474523544311523
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1100492477416992
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.732 Vali Acc: 0.470 Test Loss: 0.732 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.051171064376831
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8100476264953613
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0558390617370605
Epoch: 7, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1338422298431396
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 9 cost time: 1.1213648319244385
Epoch: 9, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0249907970428467
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.127351999282837
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0289514064788818
Epoch: 12, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.105177640914917
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 14 cost time: 0.9940335750579834
Epoch: 14, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0059068202972412
Epoch: 15, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.732 Vali Acc: 0.590 Test Loss: 0.732 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 16 cost time: 0.9919662475585938
Epoch: 16, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3224523067474365
Epoch: 17, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2591874599456787
Epoch: 18, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.740 Vali Acc: 0.560 Test Loss: 0.740 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3545987606048584
Epoch: 19, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.715 Vali Acc: 0.590 Test Loss: 0.715 Test Acc: 0.590
Validation loss decreased (-0.589993 --> -0.589993).  Saving model ...
Epoch: 20 cost time: 1.2634861469268799
Epoch: 20, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.719 Vali Acc: 0.590 Test Loss: 0.719 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0508220195770264
Epoch: 21, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1015737056732178
Epoch: 22, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.096837043762207
Epoch: 23, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0850560665130615
Epoch: 24, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.724 Vali Acc: 0.610 Test Loss: 0.724 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609993).  Saving model ...
Epoch: 25 cost time: 1.1276564598083496
Epoch: 25, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.800 Vali Acc: 0.560 Test Loss: 0.800 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2894258499145508
Epoch: 26, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1467828750610352
Epoch: 27, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.872 Vali Acc: 0.490 Test Loss: 0.872 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.176107406616211
Epoch: 28, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1397860050201416
Epoch: 29, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.796 Vali Acc: 0.590 Test Loss: 0.796 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0445599555969238
Epoch: 30, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.864 Vali Acc: 0.580 Test Loss: 0.864 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0317609310150146
Epoch: 31, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.876 Vali Acc: 0.580 Test Loss: 0.876 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2158384323120117
Epoch: 32, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.988 Vali Acc: 0.550 Test Loss: 0.988 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1204805374145508
Epoch: 33, Steps: 20 | Train Loss: 0.336 Vali Loss: 0.927 Vali Acc: 0.570 Test Loss: 0.927 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1340892314910889
Epoch: 34, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.082 Vali Acc: 0.610 Test Loss: 1.082 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 15000
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.1742677688598633
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 0.8807823657989502
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.726 Vali Acc: 0.390 Test Loss: 0.726 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8859591484069824
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0280828475952148
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.771 Vali Acc: 0.440 Test Loss: 0.771 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.02424955368042
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0237610340118408
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.760 Vali Acc: 0.440 Test Loss: 0.760 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9917254447937012
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.149075984954834
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.870617151260376
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.726 Vali Acc: 0.590 Test Loss: 0.726 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 0.9339392185211182
Epoch: 10, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0522477626800537
Epoch: 11, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8516333103179932
Epoch: 12, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9810247421264648
Epoch: 13, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9802353382110596
Epoch: 14, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0467514991760254
Epoch: 15, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
Validation loss decreased (-0.589993 --> -0.589993).  Saving model ...
Epoch: 16 cost time: 1.0223522186279297
Epoch: 16, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.851841926574707
Epoch: 17, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1538825035095215
Epoch: 18, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1064105033874512
Epoch: 19, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.747 Vali Acc: 0.430 Test Loss: 0.747 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1776649951934814
Epoch: 20, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9659626483917236
Epoch: 21, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0114593505859375
Epoch: 22, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.177854061126709
Epoch: 23, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.151233434677124
Epoch: 24, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2700440883636475
Epoch: 25, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.814 Vali Acc: 0.490 Test Loss: 0.814 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 14552
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8571276664733887
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.1977744102478027
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9957256317138672
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9980976581573486
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0571708679199219
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 0.9781322479248047
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.081939935684204
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1126840114593506
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9293591976165771
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0940628051757812
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.056800365447998
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0252203941345215
Epoch: 12, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0770928859710693
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9010758399963379
Epoch: 14, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.731 Vali Acc: 0.570 Test Loss: 0.731 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.992110013961792
Epoch: 15, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 14364
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.380744695663452
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.707 Vali Acc: 0.450 Test Loss: 0.707 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.0688073635101318
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.713 Vali Acc: 0.450 Test Loss: 0.713 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.312791347503662
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 0.9400761127471924
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.740 Vali Acc: 0.440 Test Loss: 0.740 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0319604873657227
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0584132671356201
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 0.9302620887756348
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.051797866821289
Epoch: 8, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1284801959991455
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9967186450958252
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 11 cost time: 1.1247284412384033
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 1.1800215244293213
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 13 cost time: 1.251718521118164
Epoch: 13, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1574087142944336
Epoch: 14, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1600360870361328
Epoch: 15, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2977252006530762
Epoch: 16, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 17 cost time: 1.2143163681030273
Epoch: 17, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3172688484191895
Epoch: 18, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4177138805389404
Epoch: 19, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9628739356994629
Epoch: 20, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1573827266693115
Epoch: 21, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0390925407409668
Epoch: 22, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 23 cost time: 0.8385801315307617
Epoch: 23, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 24 cost time: 1.0650184154510498
Epoch: 24, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2651798725128174
Epoch: 25, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2607288360595703
Epoch: 26, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.849 Vali Acc: 0.480 Test Loss: 0.849 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3020319938659668
Epoch: 27, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.199744701385498
Epoch: 28, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9297153949737549
Epoch: 29, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.837 Vali Acc: 0.490 Test Loss: 0.837 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9650568962097168
Epoch: 30, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.836 Vali Acc: 0.430 Test Loss: 0.836 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1937098503112793
Epoch: 31, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2321608066558838
Epoch: 32, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.862 Vali Acc: 0.450 Test Loss: 0.862 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0937268733978271
Epoch: 33, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.012 Vali Acc: 0.440 Test Loss: 1.012 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 14094
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.511544704437256
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.0755281448364258
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.2350080013275146
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.738 Vali Acc: 0.430 Test Loss: 0.738 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.34663987159729
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4069716930389404
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.751 Vali Acc: 0.450 Test Loss: 0.751 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0711750984191895
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.748 Vali Acc: 0.440 Test Loss: 0.748 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1263470649719238
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.762 Vali Acc: 0.440 Test Loss: 0.762 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9830529689788818
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.758 Vali Acc: 0.450 Test Loss: 0.758 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.835362434387207
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.749 Vali Acc: 0.460 Test Loss: 0.749 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1638762950897217
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.745 Vali Acc: 0.460 Test Loss: 0.745 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.359426498413086
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.785 Vali Acc: 0.440 Test Loss: 0.785 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.047217845916748
Epoch: 12, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 14256
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.874483346939087
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.1621592044830322
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.722 Vali Acc: 0.430 Test Loss: 0.722 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0769195556640625
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9645516872406006
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.741 Vali Acc: 0.410 Test Loss: 0.741 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0622203350067139
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.753 Vali Acc: 0.460 Test Loss: 0.753 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.007800817489624
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9460453987121582
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 0.901289701461792
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.791 Vali Acc: 0.440 Test Loss: 0.791 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9540624618530273
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9588890075683594
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8907077312469482
Epoch: 11, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.971019983291626
Epoch: 12, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 13 cost time: 0.9611308574676514
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.717 Vali Acc: 0.560 Test Loss: 0.717 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 1.0016567707061768
Epoch: 14, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.786 Vali Acc: 0.460 Test Loss: 0.786 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0255908966064453
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8707530498504639
Epoch: 16, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9076006412506104
Epoch: 17, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8571557998657227
Epoch: 18, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1154594421386719
Epoch: 19, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.776 Vali Acc: 0.550 Test Loss: 0.776 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9356672763824463
Epoch: 20, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.705 Vali Acc: 0.620 Test Loss: 0.705 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619993).  Saving model ...
Epoch: 21 cost time: 0.8581414222717285
Epoch: 21, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0821146965026855
Epoch: 22, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9133930206298828
Epoch: 23, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9661684036254883
Epoch: 24, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.833 Vali Acc: 0.540 Test Loss: 0.833 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.210510015487671
Epoch: 25, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.722 Vali Acc: 0.560 Test Loss: 0.722 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1686835289001465
Epoch: 26, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.708 Vali Acc: 0.580 Test Loss: 0.708 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8979296684265137
Epoch: 27, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.752 Vali Acc: 0.580 Test Loss: 0.752 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0596613883972168
Epoch: 28, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.797 Vali Acc: 0.560 Test Loss: 0.797 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.246274709701538
Epoch: 29, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.853 Vali Acc: 0.570 Test Loss: 0.853 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0328469276428223
Epoch: 30, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.069 Vali Acc: 0.560 Test Loss: 1.069 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 14322
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.895347833633423
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.730 Vali Acc: 0.400 Test Loss: 0.730 Test Acc: 0.400
Validation loss decreased (inf --> -0.399993).  Saving model ...
Epoch: 2 cost time: 1.0796592235565186
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.727 Vali Acc: 0.420 Test Loss: 0.727 Test Acc: 0.420
Validation loss decreased (-0.399993 --> -0.419993).  Saving model ...
Epoch: 3 cost time: 1.0100018978118896
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.742 Vali Acc: 0.420 Test Loss: 0.742 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.175732135772705
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.754 Vali Acc: 0.410 Test Loss: 0.754 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0184717178344727
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.774 Vali Acc: 0.410 Test Loss: 0.774 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.222562551498413
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.761 Vali Acc: 0.430 Test Loss: 0.761 Test Acc: 0.430
Validation loss decreased (-0.419993 --> -0.429992).  Saving model ...
Epoch: 7 cost time: 1.0728859901428223
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.759 Vali Acc: 0.420 Test Loss: 0.759 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.119521141052246
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.760 Vali Acc: 0.450 Test Loss: 0.760 Test Acc: 0.450
Validation loss decreased (-0.429992 --> -0.449992).  Saving model ...
Epoch: 9 cost time: 0.9440155029296875
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.790 Vali Acc: 0.440 Test Loss: 0.790 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9398288726806641
Epoch: 10, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499993).  Saving model ...
Epoch: 11 cost time: 1.1645658016204834
Epoch: 11, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.775 Vali Acc: 0.460 Test Loss: 0.775 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9125633239746094
Epoch: 12, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 13 cost time: 0.8950533866882324
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.987023115158081
Epoch: 14, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.840641975402832
Epoch: 15, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8409478664398193
Epoch: 16, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9123499393463135
Epoch: 17, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9824936389923096
Epoch: 18, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 19 cost time: 0.8930141925811768
Epoch: 19, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.860750675201416
Epoch: 20, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 21 cost time: 1.0440301895141602
Epoch: 21, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 22 cost time: 0.9051058292388916
Epoch: 22, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9260959625244141
Epoch: 23, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.771 Vali Acc: 0.580 Test Loss: 0.771 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 24 cost time: 1.1552722454071045
Epoch: 24, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8279871940612793
Epoch: 25, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7789239883422852
Epoch: 26, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.874 Vali Acc: 0.510 Test Loss: 0.874 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.95143723487854
Epoch: 27, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.961 Vali Acc: 0.510 Test Loss: 0.961 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8739020824432373
Epoch: 28, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.809 Vali Acc: 0.560 Test Loss: 0.809 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9807021617889404
Epoch: 29, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0914855003356934
Epoch: 30, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.862 Vali Acc: 0.550 Test Loss: 0.862 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0120489597320557
Epoch: 31, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.955 Vali Acc: 0.520 Test Loss: 0.955 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.164518117904663
Epoch: 32, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.992 Vali Acc: 0.570 Test Loss: 0.992 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9058406352996826
Epoch: 33, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.005 Vali Acc: 0.550 Test Loss: 1.005 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14292
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5529990196228027
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.672 Vali Acc: 0.560 Test Loss: 0.672 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 0.9526751041412354
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.682 Vali Acc: 0.560 Test Loss: 0.682 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8571088314056396
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8453452587127686
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1035282611846924
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9497020244598389
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9934329986572266
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2148852348327637
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0855002403259277
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.725 Vali Acc: 0.470 Test Loss: 0.725 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3486943244934082
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1275744438171387
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14166
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4405088424682617
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.717 Vali Acc: 0.420 Test Loss: 0.717 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 1.013528823852539
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.732 Vali Acc: 0.460 Test Loss: 0.732 Test Acc: 0.460
Validation loss decreased (-0.419993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 0.9392678737640381
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.748 Vali Acc: 0.420 Test Loss: 0.748 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8368456363677979
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.731 Vali Acc: 0.440 Test Loss: 0.731 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9026839733123779
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.771 Vali Acc: 0.420 Test Loss: 0.771 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.735595703125
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
Validation loss decreased (-0.459993 --> -0.459993).  Saving model ...
Epoch: 7 cost time: 0.9135856628417969
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7923696041107178
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 0.8431801795959473
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.762 Vali Acc: 0.450 Test Loss: 0.762 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.969940185546875
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.753 Vali Acc: 0.460 Test Loss: 0.753 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.019651174545288
Epoch: 11, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 12 cost time: 0.9324133396148682
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0166161060333252
Epoch: 13, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 1.2806453704833984
Epoch: 14, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0839664936065674
Epoch: 15, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.97039794921875
Epoch: 16, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2223453521728516
Epoch: 17, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8316450119018555
Epoch: 18, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9580717086791992
Epoch: 19, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.752 Vali Acc: 0.600 Test Loss: 0.752 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 20 cost time: 1.1158013343811035
Epoch: 20, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0778517723083496
Epoch: 21, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3963496685028076
Epoch: 22, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9586958885192871
Epoch: 23, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.774 Vali Acc: 0.570 Test Loss: 0.774 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9801168441772461
Epoch: 24, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.739 Vali Acc: 0.600 Test Loss: 0.739 Test Acc: 0.600
Validation loss decreased (-0.599992 --> -0.599993).  Saving model ...
Epoch: 25 cost time: 1.075864315032959
Epoch: 25, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.784 Vali Acc: 0.530 Test Loss: 0.784 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0610120296478271
Epoch: 26, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.777 Vali Acc: 0.570 Test Loss: 0.777 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0292911529541016
Epoch: 27, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.776 Vali Acc: 0.550 Test Loss: 0.776 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9920265674591064
Epoch: 28, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9640626907348633
Epoch: 29, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.111234426498413
Epoch: 30, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.876 Vali Acc: 0.560 Test Loss: 0.876 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0697550773620605
Epoch: 31, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.832 Vali Acc: 0.570 Test Loss: 0.832 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0167391300201416
Epoch: 32, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.849 Vali Acc: 0.550 Test Loss: 0.849 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.93365478515625
Epoch: 33, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.935 Vali Acc: 0.590 Test Loss: 0.935 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9669601917266846
Epoch: 34, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.096 Vali Acc: 0.570 Test Loss: 1.096 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 13944
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.40714955329895
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 0.9277377128601074
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8979783058166504
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8962926864624023
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.858802080154419
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7887539863586426
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1349766254425049
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.770 Vali Acc: 0.460 Test Loss: 0.770 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.870659351348877
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8266992568969727
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.750 Vali Acc: 0.460 Test Loss: 0.750 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.044382095336914
Epoch: 10, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2390551567077637
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.781 Vali Acc: 0.440 Test Loss: 0.781 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14130
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.600163221359253
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 0.9497725963592529
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.0648694038391113
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.733 Vali Acc: 0.440 Test Loss: 0.733 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0432133674621582
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.880277156829834
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3761587142944336
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8495104312896729
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.0214171409606934
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.965001106262207
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9602477550506592
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.0577213764190674
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1228764057159424
Epoch: 12, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.735 Vali Acc: 0.540 Test Loss: 0.735 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 13 cost time: 1.3262369632720947
Epoch: 13, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3471441268920898
Epoch: 14, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1880087852478027
Epoch: 15, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0756971836090088
Epoch: 16, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.746 Vali Acc: 0.450 Test Loss: 0.746 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1094050407409668
Epoch: 17, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1607534885406494
Epoch: 18, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4677362442016602
Epoch: 19, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 20 cost time: 1.0378639698028564
Epoch: 20, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.747 Vali Acc: 0.580 Test Loss: 0.747 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579993).  Saving model ...
Epoch: 21 cost time: 1.0802106857299805
Epoch: 21, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0344367027282715
Epoch: 22, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1233930587768555
Epoch: 23, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1664009094238281
Epoch: 24, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3878543376922607
Epoch: 25, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.217810869216919
Epoch: 26, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.388390302658081
Epoch: 27, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.873 Vali Acc: 0.520 Test Loss: 0.873 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0864315032958984
Epoch: 28, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.785 Vali Acc: 0.490 Test Loss: 0.785 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9634442329406738
Epoch: 29, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.931577205657959
Epoch: 30, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm128_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14272
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.736569404602051
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.685 Vali Acc: 0.620 Test Loss: 0.685 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 0.8092379570007324
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.692 Vali Acc: 0.520 Test Loss: 0.692 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1223609447479248
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.713 Vali Acc: 0.560 Test Loss: 0.713 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9718611240386963
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0275170803070068
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0447602272033691
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0273621082305908
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9909768104553223
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9554038047790527
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8256340026855469
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9365944862365723
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9080
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.853898525238037
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.710 Vali Acc: 0.470 Test Loss: 0.710 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.3512914180755615
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.729 Vali Acc: 0.440 Test Loss: 0.729 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2367057800292969
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.732 Vali Acc: 0.440 Test Loss: 0.732 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.142132043838501
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 1.213090419769287
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.765 Vali Acc: 0.450 Test Loss: 0.765 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9611451625823975
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.751 Vali Acc: 0.430 Test Loss: 0.751 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0301306247711182
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9887261390686035
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 1.1157550811767578
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3845365047454834
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.748 Vali Acc: 0.540 Test Loss: 0.748 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.3536458015441895
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.776 Vali Acc: 0.530 Test Loss: 0.776 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1810829639434814
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.186227560043335
Epoch: 13, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9973478317260742
Epoch: 14, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.744 Vali Acc: 0.450 Test Loss: 0.744 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0487020015716553
Epoch: 15, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.780 Vali Acc: 0.490 Test Loss: 0.780 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1820130348205566
Epoch: 16, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9964926242828369
Epoch: 17, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3292155265808105
Epoch: 18, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2346742153167725
Epoch: 19, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.779 Vali Acc: 0.510 Test Loss: 0.779 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.984062910079956
Epoch: 20, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 8888
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.491655111312866
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.705 Vali Acc: 0.470 Test Loss: 0.705 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.152099847793579
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.718 Vali Acc: 0.450 Test Loss: 0.718 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9009068012237549
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.728 Vali Acc: 0.430 Test Loss: 0.728 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9456908702850342
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 0.9484894275665283
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9882214069366455
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0304253101348877
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.1645901203155518
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4034461975097656
Epoch: 9, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2759456634521484
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.338440179824829
Epoch: 11, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 12 cost time: 0.9978406429290771
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1122965812683105
Epoch: 13, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0788836479187012
Epoch: 14, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0617344379425049
Epoch: 15, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8577098846435547
Epoch: 16, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0703418254852295
Epoch: 17, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2291913032531738
Epoch: 18, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 19 cost time: 1.1582911014556885
Epoch: 19, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1464719772338867
Epoch: 20, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.980633020401001
Epoch: 21, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0357050895690918
Epoch: 22, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.198204755783081
Epoch: 23, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.087397813796997
Epoch: 24, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.758 Vali Acc: 0.620 Test Loss: 0.758 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619992).  Saving model ...
Epoch: 25 cost time: 1.0653023719787598
Epoch: 25, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.167372465133667
Epoch: 26, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1453309059143066
Epoch: 27, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.751 Vali Acc: 0.590 Test Loss: 0.751 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.100471019744873
Epoch: 28, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0272228717803955
Epoch: 29, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9371554851531982
Epoch: 30, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9521932601928711
Epoch: 31, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.087386131286621
Epoch: 32, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9718608856201172
Epoch: 33, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0056300163269043
Epoch: 34, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 8828
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.698423385620117
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.729 Vali Acc: 0.430 Test Loss: 0.729 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.0260071754455566
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.736 Vali Acc: 0.440 Test Loss: 0.736 Test Acc: 0.440
Validation loss decreased (-0.429993 --> -0.439993).  Saving model ...
Epoch: 3 cost time: 0.8565616607666016
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.730 Vali Acc: 0.420 Test Loss: 0.730 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8730006217956543
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.774 Vali Acc: 0.410 Test Loss: 0.774 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8914802074432373
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.766 Vali Acc: 0.420 Test Loss: 0.766 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9788980484008789
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 7 cost time: 1.413086175918579
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.761 Vali Acc: 0.430 Test Loss: 0.761 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2241380214691162
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.742 Vali Acc: 0.460 Test Loss: 0.742 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3868534564971924
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469992).  Saving model ...
Epoch: 10 cost time: 1.0384442806243896
Epoch: 10, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 11 cost time: 1.1185824871063232
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1249873638153076
Epoch: 12, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.758 Vali Acc: 0.460 Test Loss: 0.758 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9509544372558594
Epoch: 13, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4536375999450684
Epoch: 14, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 15 cost time: 1.3680694103240967
Epoch: 15, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 16 cost time: 1.0899648666381836
Epoch: 16, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.158959150314331
Epoch: 17, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.399493932723999
Epoch: 18, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9143538475036621
Epoch: 19, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3356046676635742
Epoch: 20, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 21 cost time: 1.2673766613006592
Epoch: 21, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0161681175231934
Epoch: 22, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.775 Vali Acc: 0.450 Test Loss: 0.775 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4049890041351318
Epoch: 23, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 24 cost time: 1.2622148990631104
Epoch: 24, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1194689273834229
Epoch: 25, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3401556015014648
Epoch: 26, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 27 cost time: 1.0913238525390625
Epoch: 27, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9760007858276367
Epoch: 28, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0322518348693848
Epoch: 29, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.848 Vali Acc: 0.480 Test Loss: 0.848 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.084721326828003
Epoch: 30, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.818 Vali Acc: 0.490 Test Loss: 0.818 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0345897674560547
Epoch: 31, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2788972854614258
Epoch: 32, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.807 Vali Acc: 0.520 Test Loss: 0.807 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1911273002624512
Epoch: 33, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0195348262786865
Epoch: 34, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8663301467895508
Epoch: 35, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.810 Vali Acc: 0.520 Test Loss: 0.810 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2703256607055664
Epoch: 36, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 8654
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.746851921081543
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.728 Vali Acc: 0.440 Test Loss: 0.728 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.2997019290924072
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.3309354782104492
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 1.2702150344848633
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.317509412765503
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2691996097564697
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.055788278579712
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.288043737411499
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 9 cost time: 1.0498781204223633
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 1.1607491970062256
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.131842851638794
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5912971496582031
Epoch: 12, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4913434982299805
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 1.1635372638702393
Epoch: 14, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3337950706481934
Epoch: 15, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4086408615112305
Epoch: 16, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1877598762512207
Epoch: 17, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2980873584747314
Epoch: 18, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4319603443145752
Epoch: 19, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0778398513793945
Epoch: 20, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1284570693969727
Epoch: 21, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.190100908279419
Epoch: 22, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.139378547668457
Epoch: 23, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 8848
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.696972608566284
Epoch: 1, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.682 Vali Acc: 0.520 Test Loss: 0.682 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.3415892124176025
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9627556800842285
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.1633172035217285
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3070623874664307
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9740011692047119
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9788315296173096
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9479191303253174
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0387980937957764
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0433850288391113
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.009350299835205
Epoch: 11, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9632613658905029
Epoch: 12, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1104316711425781
Epoch: 13, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 8946
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4308276176452637
Epoch: 1, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.680 Vali Acc: 0.570 Test Loss: 0.680 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.2648916244506836
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9664034843444824
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.703 Vali Acc: 0.580 Test Loss: 0.703 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 0.9915809631347656
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9501094818115234
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9215717315673828
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8923854827880859
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0003740787506104
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9557557106018066
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.713 Vali Acc: 0.570 Test Loss: 0.713 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1341900825500488
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9992797374725342
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.905869722366333
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.725 Vali Acc: 0.430 Test Loss: 0.725 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9108576774597168
Epoch: 13, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8948
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8318822383880615
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 0.9980614185333252
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.0492801666259766
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3962488174438477
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 1.1239359378814697
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 1.1897542476654053
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.0903899669647217
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9854080677032471
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.751 Vali Acc: 0.450 Test Loss: 0.751 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1473143100738525
Epoch: 9, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0101838111877441
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9244396686553955
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0141685009002686
Epoch: 12, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0878880023956299
Epoch: 13, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.250201940536499
Epoch: 14, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9262130260467529
Epoch: 15, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9723455905914307
Epoch: 16, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.776 Vali Acc: 0.430 Test Loss: 0.776 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 8854
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.291560649871826
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.732 Vali Acc: 0.420 Test Loss: 0.732 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 0.8715708255767822
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.744 Vali Acc: 0.400 Test Loss: 0.744 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9516901969909668
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.755 Vali Acc: 0.370 Test Loss: 0.755 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9893026351928711
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.764 Vali Acc: 0.430 Test Loss: 0.764 Test Acc: 0.430
Validation loss decreased (-0.419993 --> -0.429992).  Saving model ...
Epoch: 5 cost time: 1.158900499343872
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.747 Vali Acc: 0.430 Test Loss: 0.747 Test Acc: 0.430
Validation loss decreased (-0.429992 --> -0.429993).  Saving model ...
Epoch: 6 cost time: 1.0986919403076172
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.759 Vali Acc: 0.410 Test Loss: 0.759 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1279382705688477
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.755 Vali Acc: 0.470 Test Loss: 0.755 Test Acc: 0.470
Validation loss decreased (-0.429993 --> -0.469992).  Saving model ...
Epoch: 8 cost time: 1.0385737419128418
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.778 Vali Acc: 0.400 Test Loss: 0.778 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0031404495239258
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.769 Vali Acc: 0.420 Test Loss: 0.769 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3006250858306885
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9598329067230225
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.771 Vali Acc: 0.440 Test Loss: 0.771 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2316224575042725
Epoch: 12, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.791 Vali Acc: 0.420 Test Loss: 0.791 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3516175746917725
Epoch: 13, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.778 Vali Acc: 0.470 Test Loss: 0.778 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1913785934448242
Epoch: 14, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9193100929260254
Epoch: 15, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499992).  Saving model ...
Epoch: 16 cost time: 1.3277735710144043
Epoch: 16, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.760 Vali Acc: 0.430 Test Loss: 0.760 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0127103328704834
Epoch: 17, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 18 cost time: 0.8482770919799805
Epoch: 18, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.016106367111206
Epoch: 19, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9665677547454834
Epoch: 20, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2179155349731445
Epoch: 21, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 22 cost time: 0.974226713180542
Epoch: 22, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.314147710800171
Epoch: 23, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9745984077453613
Epoch: 24, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0741689205169678
Epoch: 25, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0763781070709229
Epoch: 26, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9652066230773926
Epoch: 27, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.778 Vali Acc: 0.450 Test Loss: 0.778 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2337918281555176
Epoch: 28, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.813 Vali Acc: 0.430 Test Loss: 0.813 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0756957530975342
Epoch: 29, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.843 Vali Acc: 0.470 Test Loss: 0.843 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1180040836334229
Epoch: 30, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9972844123840332
Epoch: 31, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.833 Vali Acc: 0.430 Test Loss: 0.833 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 8664
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.008546829223633
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.688 Vali Acc: 0.500 Test Loss: 0.688 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.9262418746948242
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.0770201683044434
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9793851375579834
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0237481594085693
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0706391334533691
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0300202369689941
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2678687572479248
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8979442119598389
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.053257942199707
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9434027671813965
Epoch: 11, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0617432594299316
Epoch: 12, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 8882
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.846254825592041
Epoch: 1, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.724 Vali Acc: 0.380 Test Loss: 0.724 Test Acc: 0.380
Validation loss decreased (inf --> -0.379993).  Saving model ...
Epoch: 2 cost time: 1.1886382102966309
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.732 Vali Acc: 0.390 Test Loss: 0.732 Test Acc: 0.390
Validation loss decreased (-0.379993 --> -0.389993).  Saving model ...
Epoch: 3 cost time: 1.0011086463928223
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.740 Vali Acc: 0.430 Test Loss: 0.740 Test Acc: 0.430
Validation loss decreased (-0.389993 --> -0.429993).  Saving model ...
Epoch: 4 cost time: 1.1980245113372803
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.746 Vali Acc: 0.430 Test Loss: 0.746 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1476666927337646
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.741 Vali Acc: 0.420 Test Loss: 0.741 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3080270290374756
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.765 Vali Acc: 0.420 Test Loss: 0.765 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.113114356994629
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.772 Vali Acc: 0.440 Test Loss: 0.772 Test Acc: 0.440
Validation loss decreased (-0.429993 --> -0.439992).  Saving model ...
Epoch: 8 cost time: 1.0828092098236084
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
Validation loss decreased (-0.439992 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 1.0166780948638916
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.782 Vali Acc: 0.460 Test Loss: 0.782 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3715848922729492
Epoch: 10, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 11 cost time: 1.0801739692687988
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.772 Vali Acc: 0.450 Test Loss: 0.772 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0918715000152588
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.764 Vali Acc: 0.470 Test Loss: 0.764 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0901598930358887
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 1.0386555194854736
Epoch: 14, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.903754711151123
Epoch: 15, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.774 Vali Acc: 0.460 Test Loss: 0.774 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0457491874694824
Epoch: 16, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.239556074142456
Epoch: 17, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1098947525024414
Epoch: 18, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.810 Vali Acc: 0.480 Test Loss: 0.810 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1478486061096191
Epoch: 19, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.167717695236206
Epoch: 20, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2250463962554932
Epoch: 21, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3246688842773438
Epoch: 22, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 23 cost time: 0.9685335159301758
Epoch: 23, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.743 Vali Acc: 0.590 Test Loss: 0.743 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 24 cost time: 1.2714595794677734
Epoch: 24, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9074645042419434
Epoch: 25, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.719 Vali Acc: 0.560 Test Loss: 0.719 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3282787799835205
Epoch: 26, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.189129114151001
Epoch: 27, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2018928527832031
Epoch: 28, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9556417465209961
Epoch: 29, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2284038066864014
Epoch: 30, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.759 Vali Acc: 0.530 Test Loss: 0.759 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.115471363067627
Epoch: 31, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2901694774627686
Epoch: 32, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.166625738143921
Epoch: 33, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm64_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9056
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.997173309326172
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.738 Vali Acc: 0.450 Test Loss: 0.738 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.3132352828979492
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.730 Vali Acc: 0.440 Test Loss: 0.730 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.484201192855835
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.736 Vali Acc: 0.430 Test Loss: 0.736 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8877747058868408
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479992).  Saving model ...
Epoch: 5 cost time: 1.592435598373413
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 1.4871838092803955
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.800 Vali Acc: 0.480 Test Loss: 0.800 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.896353006362915
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.740 Vali Acc: 0.440 Test Loss: 0.740 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4482223987579346
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.804 Vali Acc: 0.480 Test Loss: 0.804 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2883703708648682
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.747 Vali Acc: 0.440 Test Loss: 0.747 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8140506744384766
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.737 Vali Acc: 0.440 Test Loss: 0.737 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.570199728012085
Epoch: 11, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2953195571899414
Epoch: 12, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.771 Vali Acc: 0.440 Test Loss: 0.771 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0328037738800049
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 14 cost time: 1.2778069972991943
Epoch: 14, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7498054504394531
Epoch: 15, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7129034996032715
Epoch: 16, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.665602445602417
Epoch: 17, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.731 Vali Acc: 0.560 Test Loss: 0.731 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 18 cost time: 1.274533748626709
Epoch: 18, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.756 Vali Acc: 0.550 Test Loss: 0.756 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.387568473815918
Epoch: 19, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3955941200256348
Epoch: 20, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2722229957580566
Epoch: 21, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.466496229171753
Epoch: 22, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.801 Vali Acc: 0.520 Test Loss: 0.801 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5308926105499268
Epoch: 23, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.532519817352295
Epoch: 24, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2350356578826904
Epoch: 25, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.778 Vali Acc: 0.490 Test Loss: 0.778 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.493638515472412
Epoch: 26, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3827474117279053
Epoch: 27, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 7272
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7011454105377197
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.673 Vali Acc: 0.570 Test Loss: 0.673 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.4197862148284912
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.679 Vali Acc: 0.560 Test Loss: 0.679 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.081528902053833
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0019118785858154
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.440340518951416
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.739 Vali Acc: 0.440 Test Loss: 0.739 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3269140720367432
Epoch: 6, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2214686870574951
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.745 Vali Acc: 0.450 Test Loss: 0.745 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.469527006149292
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2919294834136963
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.749 Vali Acc: 0.450 Test Loss: 0.749 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3460347652435303
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2269694805145264
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 7208
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.565319299697876
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.683 Vali Acc: 0.590 Test Loss: 0.683 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.1579806804656982
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.697 Vali Acc: 0.590 Test Loss: 0.697 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4358363151550293
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5321044921875
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1930279731750488
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.305790901184082
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4370689392089844
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4176936149597168
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5276069641113281
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.750 Vali Acc: 0.460 Test Loss: 0.750 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3226592540740967
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2041339874267578
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7212
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.653709888458252
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.695 Vali Acc: 0.450 Test Loss: 0.695 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.6150648593902588
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.703 Vali Acc: 0.450 Test Loss: 0.703 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5055487155914307
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.714 Vali Acc: 0.450 Test Loss: 0.714 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5897932052612305
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.742 Vali Acc: 0.420 Test Loss: 0.742 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4922518730163574
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
Validation loss decreased (-0.449993 --> -0.459993).  Saving model ...
Epoch: 6 cost time: 1.4400990009307861
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.732 Vali Acc: 0.420 Test Loss: 0.732 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2287547588348389
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.736 Vali Acc: 0.440 Test Loss: 0.736 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1002600193023682
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499992).  Saving model ...
Epoch: 9 cost time: 1.454451322555542
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.725 Vali Acc: 0.470 Test Loss: 0.725 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5021588802337646
Epoch: 10, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.743 Vali Acc: 0.440 Test Loss: 0.743 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1733522415161133
Epoch: 11, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5112292766571045
Epoch: 12, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3636956214904785
Epoch: 13, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.729 Vali Acc: 0.570 Test Loss: 0.729 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.1838173866271973
Epoch: 14, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4696645736694336
Epoch: 15, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1610021591186523
Epoch: 16, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4227218627929688
Epoch: 17, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.823 Vali Acc: 0.510 Test Loss: 0.823 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0400638580322266
Epoch: 18, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3266518115997314
Epoch: 19, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.521017074584961
Epoch: 20, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.751 Vali Acc: 0.530 Test Loss: 0.751 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4279394149780273
Epoch: 21, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.559072494506836
Epoch: 22, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2619831562042236
Epoch: 23, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 7086
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3412797451019287
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.4589712619781494
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.731 Vali Acc: 0.450 Test Loss: 0.731 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.476654052734375
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.759 Vali Acc: 0.450 Test Loss: 0.759 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1091828346252441
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.750 Vali Acc: 0.460 Test Loss: 0.750 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.162045955657959
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.779 Vali Acc: 0.460 Test Loss: 0.779 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0079967975616455
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.406069278717041
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3311991691589355
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.176293134689331
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 10 cost time: 1.602156400680542
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519993).  Saving model ...
Epoch: 11 cost time: 1.3676788806915283
Epoch: 11, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1916553974151611
Epoch: 12, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4385759830474854
Epoch: 13, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 14 cost time: 1.2520573139190674
Epoch: 14, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.730 Vali Acc: 0.590 Test Loss: 0.730 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589993).  Saving model ...
Epoch: 15 cost time: 1.2652606964111328
Epoch: 15, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2480740547180176
Epoch: 16, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3138971328735352
Epoch: 17, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2905197143554688
Epoch: 18, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.220729112625122
Epoch: 19, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4537196159362793
Epoch: 20, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5094051361083984
Epoch: 21, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1014413833618164
Epoch: 22, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.278313398361206
Epoch: 23, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.114650011062622
Epoch: 24, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.831 Vali Acc: 0.470 Test Loss: 0.831 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7296
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5619912147521973
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.676 Vali Acc: 0.610 Test Loss: 0.676 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.049482822418213
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3442590236663818
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0904839038848877
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2457249164581299
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.165905237197876
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.725 Vali Acc: 0.470 Test Loss: 0.725 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.607877492904663
Epoch: 7, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.782 Vali Acc: 0.460 Test Loss: 0.782 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.12040114402771
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.245434284210205
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3128900527954102
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3093292713165283
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 7410
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.946812868118286
Epoch: 1, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.0662899017333984
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.713 Vali Acc: 0.450 Test Loss: 0.713 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6136178970336914
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1411879062652588
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2153723239898682
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.733 Vali Acc: 0.440 Test Loss: 0.733 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.215595006942749
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2479994297027588
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3520081043243408
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1598553657531738
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 1.3166232109069824
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.773 Vali Acc: 0.460 Test Loss: 0.773 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1768064498901367
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.714 Vali Acc: 0.460 Test Loss: 0.714 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.288306474685669
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1730117797851562
Epoch: 13, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.732 Vali Acc: 0.450 Test Loss: 0.732 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1435134410858154
Epoch: 14, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1241064071655273
Epoch: 15, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.759 Vali Acc: 0.450 Test Loss: 0.759 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2678906917572021
Epoch: 16, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.324821949005127
Epoch: 17, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.759 Vali Acc: 0.470 Test Loss: 0.759 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9989418983459473
Epoch: 18, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1334857940673828
Epoch: 19, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 7428
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.164534568786621
Epoch: 1, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.699 Vali Acc: 0.470 Test Loss: 0.699 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.230855941772461
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.719 Vali Acc: 0.420 Test Loss: 0.719 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6519875526428223
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.450571060180664
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.345942497253418
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.2070307731628418
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.952796459197998
Epoch: 7, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.765 Vali Acc: 0.420 Test Loss: 0.765 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.193089485168457
Epoch: 8, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.726 Vali Acc: 0.560 Test Loss: 0.726 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.7680809497833252
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2052953243255615
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3472158908843994
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1955723762512207
Epoch: 12, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3001289367675781
Epoch: 13, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.338911771774292
Epoch: 14, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2564246654510498
Epoch: 15, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.785 Vali Acc: 0.440 Test Loss: 0.785 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6224088668823242
Epoch: 16, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.779 Vali Acc: 0.470 Test Loss: 0.779 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3216922283172607
Epoch: 17, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3738703727722168
Epoch: 18, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 7350
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6259639263153076
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.672 Vali Acc: 0.640 Test Loss: 0.672 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 1.3998842239379883
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.695 Vali Acc: 0.580 Test Loss: 0.695 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4913971424102783
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5839390754699707
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.22629714012146
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6037936210632324
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6078786849975586
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2822606563568115
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3419625759124756
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.774 Vali Acc: 0.470 Test Loss: 0.774 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2546653747558594
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.734 Vali Acc: 0.580 Test Loss: 0.734 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0642280578613281
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 7176
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0142078399658203
Epoch: 1, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.0533342361450195
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.707 Vali Acc: 0.440 Test Loss: 0.707 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3434209823608398
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1084444522857666
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1117019653320312
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.086411952972412
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3130488395690918
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.801 Vali Acc: 0.440 Test Loss: 0.801 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9441213607788086
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2970325946807861
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.775 Vali Acc: 0.460 Test Loss: 0.775 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.25966477394104
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1163420677185059
Epoch: 11, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 7410
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2406539916992188
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.8149757385253906
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.440 Test Loss: 0.710 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5895133018493652
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9780480861663818
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.481227159500122
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.737 Vali Acc: 0.450 Test Loss: 0.737 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4531831741333008
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.771 Vali Acc: 0.480 Test Loss: 0.771 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3364880084991455
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4389021396636963
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.18503737449646
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2856416702270508
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6490325927734375
Epoch: 11, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_LightTS_UEA_ftM_sl50_ll0_pl0_dm32_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 7600
model size : 0.04MB
