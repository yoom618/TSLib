Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.210949182510376
Epoch: 1, Steps: 18 | Train Loss: 1.099 Vali Loss: 1.253 Vali Acc: 0.530 Test Loss: 1.253 Test Acc: 0.530
Validation loss decreased (inf --> -0.529987).  Saving model ...
Epoch: 2 cost time: 2.219193458557129
Epoch: 2, Steps: 18 | Train Loss: 1.565 Vali Loss: 0.975 Vali Acc: 0.530 Test Loss: 0.975 Test Acc: 0.530
Validation loss decreased (-0.529987 --> -0.529990).  Saving model ...
Epoch: 3 cost time: 2.1048030853271484
Epoch: 3, Steps: 18 | Train Loss: 1.018 Vali Loss: 2.497 Vali Acc: 0.500 Test Loss: 2.497 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9798192977905273
Epoch: 4, Steps: 18 | Train Loss: 1.370 Vali Loss: 1.753 Vali Acc: 0.470 Test Loss: 1.753 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6784093379974365
Epoch: 5, Steps: 18 | Train Loss: 0.987 Vali Loss: 1.808 Vali Acc: 0.480 Test Loss: 1.808 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.42063045501709
Epoch: 6, Steps: 18 | Train Loss: 1.342 Vali Loss: 3.930 Vali Acc: 0.450 Test Loss: 3.930 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4807369709014893
Epoch: 7, Steps: 18 | Train Loss: 1.592 Vali Loss: 2.495 Vali Acc: 0.480 Test Loss: 2.495 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4953322410583496
Epoch: 8, Steps: 18 | Train Loss: 1.562 Vali Loss: 3.939 Vali Acc: 0.570 Test Loss: 3.939 Test Acc: 0.570
Validation loss decreased (-0.529990 --> -0.569961).  Saving model ...
Epoch: 9 cost time: 2.4348366260528564
Epoch: 9, Steps: 18 | Train Loss: 1.786 Vali Loss: 2.837 Vali Acc: 0.460 Test Loss: 2.837 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4135119915008545
Epoch: 10, Steps: 18 | Train Loss: 0.833 Vali Loss: 3.462 Vali Acc: 0.510 Test Loss: 3.462 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6421992778778076
Epoch: 11, Steps: 18 | Train Loss: 2.256 Vali Loss: 2.695 Vali Acc: 0.550 Test Loss: 2.695 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.532654047012329
Epoch: 12, Steps: 18 | Train Loss: 0.825 Vali Loss: 2.368 Vali Acc: 0.540 Test Loss: 2.368 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.889780044555664
Epoch: 13, Steps: 18 | Train Loss: 1.077 Vali Loss: 5.678 Vali Acc: 0.450 Test Loss: 5.678 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.248800039291382
Epoch: 14, Steps: 18 | Train Loss: 2.289 Vali Loss: 4.635 Vali Acc: 0.460 Test Loss: 4.635 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4118337631225586
Epoch: 15, Steps: 18 | Train Loss: 2.689 Vali Loss: 7.427 Vali Acc: 0.500 Test Loss: 7.427 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7461771965026855
Epoch: 16, Steps: 18 | Train Loss: 2.940 Vali Loss: 5.051 Vali Acc: 0.550 Test Loss: 5.051 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.562366485595703
Epoch: 17, Steps: 18 | Train Loss: 1.655 Vali Loss: 5.021 Vali Acc: 0.530 Test Loss: 5.021 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.382201910018921
Epoch: 18, Steps: 18 | Train Loss: 3.155 Vali Loss: 5.163 Vali Acc: 0.490 Test Loss: 5.163 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 10069380
model size : 38.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.5480241775512695
Epoch: 1, Steps: 18 | Train Loss: 1.154 Vali Loss: 1.026 Vali Acc: 0.660 Test Loss: 1.026 Test Acc: 0.660
Validation loss decreased (inf --> -0.659990).  Saving model ...
Epoch: 2 cost time: 2.7152276039123535
Epoch: 2, Steps: 18 | Train Loss: 1.277 Vali Loss: 1.186 Vali Acc: 0.600 Test Loss: 1.186 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4416627883911133
Epoch: 3, Steps: 18 | Train Loss: 1.191 Vali Loss: 0.938 Vali Acc: 0.560 Test Loss: 0.938 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.22768235206604
Epoch: 4, Steps: 18 | Train Loss: 1.019 Vali Loss: 1.171 Vali Acc: 0.510 Test Loss: 1.171 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9747767448425293
Epoch: 5, Steps: 18 | Train Loss: 1.070 Vali Loss: 1.521 Vali Acc: 0.490 Test Loss: 1.521 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7775461673736572
Epoch: 6, Steps: 18 | Train Loss: 0.967 Vali Loss: 1.429 Vali Acc: 0.470 Test Loss: 1.429 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0169992446899414
Epoch: 7, Steps: 18 | Train Loss: 1.013 Vali Loss: 2.301 Vali Acc: 0.520 Test Loss: 2.301 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8820998668670654
Epoch: 8, Steps: 18 | Train Loss: 0.862 Vali Loss: 5.913 Vali Acc: 0.480 Test Loss: 5.913 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.735184669494629
Epoch: 9, Steps: 18 | Train Loss: 1.765 Vali Loss: 1.778 Vali Acc: 0.540 Test Loss: 1.778 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1273343563079834
Epoch: 10, Steps: 18 | Train Loss: 1.122 Vali Loss: 3.710 Vali Acc: 0.500 Test Loss: 3.710 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.017378807067871
Epoch: 11, Steps: 18 | Train Loss: 1.373 Vali Loss: 2.921 Vali Acc: 0.550 Test Loss: 2.921 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 9941394
model size : 37.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.283879041671753
Epoch: 1, Steps: 18 | Train Loss: 1.233 Vali Loss: 1.343 Vali Acc: 0.540 Test Loss: 1.343 Test Acc: 0.540
Validation loss decreased (inf --> -0.539987).  Saving model ...
Epoch: 2 cost time: 2.078591823577881
Epoch: 2, Steps: 18 | Train Loss: 1.555 Vali Loss: 1.104 Vali Acc: 0.490 Test Loss: 1.104 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4836697578430176
Epoch: 3, Steps: 18 | Train Loss: 1.119 Vali Loss: 1.073 Vali Acc: 0.550 Test Loss: 1.073 Test Acc: 0.550
Validation loss decreased (-0.539987 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 2.328944683074951
Epoch: 4, Steps: 18 | Train Loss: 0.887 Vali Loss: 1.358 Vali Acc: 0.510 Test Loss: 1.358 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9790263175964355
Epoch: 5, Steps: 18 | Train Loss: 0.995 Vali Loss: 1.432 Vali Acc: 0.460 Test Loss: 1.432 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3497707843780518
Epoch: 6, Steps: 18 | Train Loss: 0.879 Vali Loss: 1.880 Vali Acc: 0.450 Test Loss: 1.880 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2851853370666504
Epoch: 7, Steps: 18 | Train Loss: 1.354 Vali Loss: 1.548 Vali Acc: 0.560 Test Loss: 1.548 Test Acc: 0.560
Validation loss decreased (-0.549989 --> -0.559985).  Saving model ...
Epoch: 8 cost time: 2.4436891078948975
Epoch: 8, Steps: 18 | Train Loss: 1.528 Vali Loss: 4.014 Vali Acc: 0.430 Test Loss: 4.014 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1339874267578125
Epoch: 9, Steps: 18 | Train Loss: 1.945 Vali Loss: 2.784 Vali Acc: 0.490 Test Loss: 2.784 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.292511224746704
Epoch: 10, Steps: 18 | Train Loss: 1.113 Vali Loss: 3.136 Vali Acc: 0.530 Test Loss: 3.136 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.553473949432373
Epoch: 11, Steps: 18 | Train Loss: 3.814 Vali Loss: 3.317 Vali Acc: 0.480 Test Loss: 3.317 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.484764337539673
Epoch: 12, Steps: 18 | Train Loss: 1.421 Vali Loss: 5.157 Vali Acc: 0.460 Test Loss: 5.157 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.592865467071533
Epoch: 13, Steps: 18 | Train Loss: 0.982 Vali Loss: 5.074 Vali Acc: 0.430 Test Loss: 5.074 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.412536859512329
Epoch: 14, Steps: 18 | Train Loss: 1.585 Vali Loss: 3.913 Vali Acc: 0.520 Test Loss: 3.913 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.584456205368042
Epoch: 15, Steps: 18 | Train Loss: 1.970 Vali Loss: 6.650 Vali Acc: 0.480 Test Loss: 6.650 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.981985092163086
Epoch: 16, Steps: 18 | Train Loss: 3.621 Vali Loss: 7.496 Vali Acc: 0.520 Test Loss: 7.496 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3031809329986572
Epoch: 17, Steps: 18 | Train Loss: 1.692 Vali Loss: 5.311 Vali Acc: 0.480 Test Loss: 5.311 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9877412
model size : 37.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.760226249694824
Epoch: 1, Steps: 18 | Train Loss: 1.040 Vali Loss: 1.757 Vali Acc: 0.410 Test Loss: 1.757 Test Acc: 0.410
Validation loss decreased (inf --> -0.409982).  Saving model ...
Epoch: 2 cost time: 3.149996042251587
Epoch: 2, Steps: 18 | Train Loss: 1.317 Vali Loss: 1.386 Vali Acc: 0.560 Test Loss: 1.386 Test Acc: 0.560
Validation loss decreased (-0.409982 --> -0.559986).  Saving model ...
Epoch: 3 cost time: 2.730623483657837
Epoch: 3, Steps: 18 | Train Loss: 1.229 Vali Loss: 1.992 Vali Acc: 0.560 Test Loss: 1.992 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1759979724884033
Epoch: 4, Steps: 18 | Train Loss: 1.118 Vali Loss: 2.871 Vali Acc: 0.490 Test Loss: 2.871 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1855247020721436
Epoch: 5, Steps: 18 | Train Loss: 1.320 Vali Loss: 2.003 Vali Acc: 0.450 Test Loss: 2.003 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6344492435455322
Epoch: 6, Steps: 18 | Train Loss: 1.210 Vali Loss: 2.315 Vali Acc: 0.480 Test Loss: 2.315 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5466830730438232
Epoch: 7, Steps: 18 | Train Loss: 1.113 Vali Loss: 2.794 Vali Acc: 0.490 Test Loss: 2.794 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6453776359558105
Epoch: 8, Steps: 18 | Train Loss: 1.176 Vali Loss: 2.969 Vali Acc: 0.520 Test Loss: 2.969 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.498922109603882
Epoch: 9, Steps: 18 | Train Loss: 1.263 Vali Loss: 2.706 Vali Acc: 0.450 Test Loss: 2.706 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8876712322235107
Epoch: 10, Steps: 18 | Train Loss: 1.721 Vali Loss: 3.030 Vali Acc: 0.480 Test Loss: 3.030 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5814778804779053
Epoch: 11, Steps: 18 | Train Loss: 1.123 Vali Loss: 2.974 Vali Acc: 0.480 Test Loss: 2.974 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7624804973602295
Epoch: 12, Steps: 18 | Train Loss: 1.528 Vali Loss: 5.166 Vali Acc: 0.450 Test Loss: 5.166 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9839034
model size : 37.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.183139801025391
Epoch: 1, Steps: 18 | Train Loss: 1.148 Vali Loss: 0.871 Vali Acc: 0.480 Test Loss: 0.871 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 2.395883560180664
Epoch: 2, Steps: 18 | Train Loss: 1.365 Vali Loss: 1.936 Vali Acc: 0.460 Test Loss: 1.936 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.300966501235962
Epoch: 3, Steps: 18 | Train Loss: 1.340 Vali Loss: 1.424 Vali Acc: 0.460 Test Loss: 1.424 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.546520709991455
Epoch: 4, Steps: 18 | Train Loss: 1.182 Vali Loss: 1.255 Vali Acc: 0.450 Test Loss: 1.255 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.602675437927246
Epoch: 5, Steps: 18 | Train Loss: 1.147 Vali Loss: 1.738 Vali Acc: 0.490 Test Loss: 1.738 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489983).  Saving model ...
Epoch: 6 cost time: 2.2965023517608643
Epoch: 6, Steps: 18 | Train Loss: 1.141 Vali Loss: 2.253 Vali Acc: 0.570 Test Loss: 2.253 Test Acc: 0.570
Validation loss decreased (-0.489983 --> -0.569977).  Saving model ...
Epoch: 7 cost time: 2.28581166267395
Epoch: 7, Steps: 18 | Train Loss: 1.006 Vali Loss: 2.571 Vali Acc: 0.480 Test Loss: 2.571 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.071760654449463
Epoch: 8, Steps: 18 | Train Loss: 1.176 Vali Loss: 2.080 Vali Acc: 0.500 Test Loss: 2.080 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.447876214981079
Epoch: 9, Steps: 18 | Train Loss: 0.985 Vali Loss: 4.966 Vali Acc: 0.430 Test Loss: 4.966 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2690951824188232
Epoch: 10, Steps: 18 | Train Loss: 2.013 Vali Loss: 4.263 Vali Acc: 0.500 Test Loss: 4.263 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.249248743057251
Epoch: 11, Steps: 18 | Train Loss: 1.222 Vali Loss: 2.501 Vali Acc: 0.530 Test Loss: 2.501 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2427289485931396
Epoch: 12, Steps: 18 | Train Loss: 0.882 Vali Loss: 3.232 Vali Acc: 0.500 Test Loss: 3.232 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.289424180984497
Epoch: 13, Steps: 18 | Train Loss: 1.895 Vali Loss: 6.270 Vali Acc: 0.430 Test Loss: 6.270 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.374657154083252
Epoch: 14, Steps: 18 | Train Loss: 2.844 Vali Loss: 7.838 Vali Acc: 0.560 Test Loss: 7.838 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2509357929229736
Epoch: 15, Steps: 18 | Train Loss: 2.372 Vali Loss: 5.693 Vali Acc: 0.450 Test Loss: 5.693 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2351346015930176
Epoch: 16, Steps: 18 | Train Loss: 1.890 Vali Loss: 5.387 Vali Acc: 0.570 Test Loss: 5.387 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9813460
model size : 37.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.010334491729736
Epoch: 1, Steps: 18 | Train Loss: 1.315 Vali Loss: 1.749 Vali Acc: 0.630 Test Loss: 1.749 Test Acc: 0.630
Validation loss decreased (inf --> -0.629983).  Saving model ...
Epoch: 2 cost time: 2.7375104427337646
Epoch: 2, Steps: 18 | Train Loss: 1.423 Vali Loss: 1.292 Vali Acc: 0.460 Test Loss: 1.292 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.790179967880249
Epoch: 3, Steps: 18 | Train Loss: 1.212 Vali Loss: 1.441 Vali Acc: 0.540 Test Loss: 1.441 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4242403507232666
Epoch: 4, Steps: 18 | Train Loss: 1.040 Vali Loss: 1.966 Vali Acc: 0.510 Test Loss: 1.966 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.062575578689575
Epoch: 5, Steps: 18 | Train Loss: 1.268 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5973334312438965
Epoch: 6, Steps: 18 | Train Loss: 0.891 Vali Loss: 1.461 Vali Acc: 0.520 Test Loss: 1.461 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5640878677368164
Epoch: 7, Steps: 18 | Train Loss: 0.676 Vali Loss: 3.908 Vali Acc: 0.470 Test Loss: 3.908 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.4975388050079346
Epoch: 8, Steps: 18 | Train Loss: 0.794 Vali Loss: 2.303 Vali Acc: 0.500 Test Loss: 2.303 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6246790885925293
Epoch: 9, Steps: 18 | Train Loss: 1.141 Vali Loss: 1.772 Vali Acc: 0.510 Test Loss: 1.772 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6736552715301514
Epoch: 10, Steps: 18 | Train Loss: 0.728 Vali Loss: 3.408 Vali Acc: 0.520 Test Loss: 3.408 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.838172435760498
Epoch: 11, Steps: 18 | Train Loss: 1.215 Vali Loss: 3.591 Vali Acc: 0.500 Test Loss: 3.591 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 9804314
model size : 37.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.935037612915039
Epoch: 1, Steps: 18 | Train Loss: 0.921 Vali Loss: 0.943 Vali Acc: 0.470 Test Loss: 0.943 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 3.077083110809326
Epoch: 2, Steps: 18 | Train Loss: 1.274 Vali Loss: 1.118 Vali Acc: 0.550 Test Loss: 1.118 Test Acc: 0.550
Validation loss decreased (-0.469991 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 2.864187479019165
Epoch: 3, Steps: 18 | Train Loss: 1.473 Vali Loss: 1.944 Vali Acc: 0.570 Test Loss: 1.944 Test Acc: 0.570
Validation loss decreased (-0.549989 --> -0.569981).  Saving model ...
Epoch: 4 cost time: 2.457519292831421
Epoch: 4, Steps: 18 | Train Loss: 1.582 Vali Loss: 1.471 Vali Acc: 0.540 Test Loss: 1.471 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7545251846313477
Epoch: 5, Steps: 18 | Train Loss: 0.846 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.816486358642578
Epoch: 6, Steps: 18 | Train Loss: 0.897 Vali Loss: 1.744 Vali Acc: 0.540 Test Loss: 1.744 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9074721336364746
Epoch: 7, Steps: 18 | Train Loss: 0.899 Vali Loss: 2.225 Vali Acc: 0.530 Test Loss: 2.225 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0281598567962646
Epoch: 8, Steps: 18 | Train Loss: 2.189 Vali Loss: 2.175 Vali Acc: 0.520 Test Loss: 2.175 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.999216079711914
Epoch: 9, Steps: 18 | Train Loss: 2.104 Vali Loss: 2.824 Vali Acc: 0.510 Test Loss: 2.824 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5979244709014893
Epoch: 10, Steps: 18 | Train Loss: 2.238 Vali Loss: 2.292 Vali Acc: 0.520 Test Loss: 2.292 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.908437967300415
Epoch: 11, Steps: 18 | Train Loss: 1.161 Vali Loss: 2.605 Vali Acc: 0.510 Test Loss: 2.605 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7969789505004883
Epoch: 12, Steps: 18 | Train Loss: 1.089 Vali Loss: 4.237 Vali Acc: 0.460 Test Loss: 4.237 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.363050937652588
Epoch: 13, Steps: 18 | Train Loss: 1.025 Vali Loss: 7.099 Vali Acc: 0.470 Test Loss: 7.099 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9781524
model size : 37.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.344238042831421
Epoch: 1, Steps: 18 | Train Loss: 0.935 Vali Loss: 1.065 Vali Acc: 0.680 Test Loss: 1.065 Test Acc: 0.680
Validation loss decreased (inf --> -0.679989).  Saving model ...
Epoch: 2 cost time: 2.4630041122436523
Epoch: 2, Steps: 18 | Train Loss: 1.005 Vali Loss: 0.785 Vali Acc: 0.600 Test Loss: 0.785 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6861112117767334
Epoch: 3, Steps: 18 | Train Loss: 0.961 Vali Loss: 1.380 Vali Acc: 0.510 Test Loss: 1.380 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.608822822570801
Epoch: 4, Steps: 18 | Train Loss: 1.104 Vali Loss: 1.072 Vali Acc: 0.550 Test Loss: 1.072 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2331440448760986
Epoch: 5, Steps: 18 | Train Loss: 1.042 Vali Loss: 1.568 Vali Acc: 0.550 Test Loss: 1.568 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5501656532287598
Epoch: 6, Steps: 18 | Train Loss: 1.078 Vali Loss: 1.862 Vali Acc: 0.510 Test Loss: 1.862 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.671440362930298
Epoch: 7, Steps: 18 | Train Loss: 1.022 Vali Loss: 1.507 Vali Acc: 0.460 Test Loss: 1.507 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6491880416870117
Epoch: 8, Steps: 18 | Train Loss: 0.784 Vali Loss: 2.336 Vali Acc: 0.540 Test Loss: 2.336 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6573686599731445
Epoch: 9, Steps: 18 | Train Loss: 1.374 Vali Loss: 4.637 Vali Acc: 0.480 Test Loss: 4.637 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.200758695602417
Epoch: 10, Steps: 18 | Train Loss: 2.569 Vali Loss: 8.368 Vali Acc: 0.430 Test Loss: 8.368 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1130168437957764
Epoch: 11, Steps: 18 | Train Loss: 2.286 Vali Loss: 3.995 Vali Acc: 0.450 Test Loss: 3.995 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.68
model parameter : 9789066
model size : 37.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.845962047576904
Epoch: 1, Steps: 18 | Train Loss: 0.917 Vali Loss: 1.039 Vali Acc: 0.450 Test Loss: 1.039 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 2.5597023963928223
Epoch: 2, Steps: 18 | Train Loss: 1.143 Vali Loss: 1.214 Vali Acc: 0.590 Test Loss: 1.214 Test Acc: 0.590
Validation loss decreased (-0.449990 --> -0.589988).  Saving model ...
Epoch: 3 cost time: 2.912418842315674
Epoch: 3, Steps: 18 | Train Loss: 0.951 Vali Loss: 1.799 Vali Acc: 0.490 Test Loss: 1.799 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4148802757263184
Epoch: 4, Steps: 18 | Train Loss: 1.025 Vali Loss: 1.326 Vali Acc: 0.490 Test Loss: 1.326 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.817423105239868
Epoch: 5, Steps: 18 | Train Loss: 1.380 Vali Loss: 3.089 Vali Acc: 0.450 Test Loss: 3.089 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0106492042541504
Epoch: 6, Steps: 18 | Train Loss: 1.282 Vali Loss: 1.371 Vali Acc: 0.510 Test Loss: 1.371 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.678853750228882
Epoch: 7, Steps: 18 | Train Loss: 0.914 Vali Loss: 2.122 Vali Acc: 0.480 Test Loss: 2.122 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6901612281799316
Epoch: 8, Steps: 18 | Train Loss: 1.099 Vali Loss: 2.860 Vali Acc: 0.520 Test Loss: 2.860 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.90093731880188
Epoch: 9, Steps: 18 | Train Loss: 1.244 Vali Loss: 2.275 Vali Acc: 0.490 Test Loss: 2.275 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4569220542907715
Epoch: 10, Steps: 18 | Train Loss: 1.347 Vali Loss: 3.553 Vali Acc: 0.430 Test Loss: 3.553 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8528120517730713
Epoch: 11, Steps: 18 | Train Loss: 1.610 Vali Loss: 4.608 Vali Acc: 0.520 Test Loss: 4.608 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.91079044342041
Epoch: 12, Steps: 18 | Train Loss: 1.107 Vali Loss: 4.787 Vali Acc: 0.520 Test Loss: 4.787 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9762404
model size : 37.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.371360778808594
Epoch: 1, Steps: 18 | Train Loss: 0.907 Vali Loss: 0.971 Vali Acc: 0.520 Test Loss: 0.971 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 2.440880060195923
Epoch: 2, Steps: 18 | Train Loss: 1.453 Vali Loss: 1.293 Vali Acc: 0.420 Test Loss: 1.293 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3181018829345703
Epoch: 3, Steps: 18 | Train Loss: 1.007 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4018490314483643
Epoch: 4, Steps: 18 | Train Loss: 0.923 Vali Loss: 1.504 Vali Acc: 0.510 Test Loss: 1.504 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.594926595687866
Epoch: 5, Steps: 18 | Train Loss: 1.045 Vali Loss: 2.299 Vali Acc: 0.450 Test Loss: 2.299 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4158308506011963
Epoch: 6, Steps: 18 | Train Loss: 1.675 Vali Loss: 4.792 Vali Acc: 0.450 Test Loss: 4.792 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.581368923187256
Epoch: 7, Steps: 18 | Train Loss: 2.028 Vali Loss: 2.014 Vali Acc: 0.530 Test Loss: 2.014 Test Acc: 0.530
Validation loss decreased (-0.519990 --> -0.529980).  Saving model ...
Epoch: 8 cost time: 2.3893017768859863
Epoch: 8, Steps: 18 | Train Loss: 0.808 Vali Loss: 2.169 Vali Acc: 0.440 Test Loss: 2.169 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.629317283630371
Epoch: 9, Steps: 18 | Train Loss: 1.192 Vali Loss: 5.847 Vali Acc: 0.440 Test Loss: 5.847 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0508830547332764
Epoch: 10, Steps: 18 | Train Loss: 1.753 Vali Loss: 2.511 Vali Acc: 0.480 Test Loss: 2.511 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.607632637023926
Epoch: 11, Steps: 18 | Train Loss: 0.845 Vali Loss: 2.472 Vali Acc: 0.580 Test Loss: 2.472 Test Acc: 0.580
Validation loss decreased (-0.529980 --> -0.579975).  Saving model ...
Epoch: 12 cost time: 2.3700380325317383
Epoch: 12, Steps: 18 | Train Loss: 1.330 Vali Loss: 4.658 Vali Acc: 0.600 Test Loss: 4.658 Test Acc: 0.600
Validation loss decreased (-0.579975 --> -0.599953).  Saving model ...
Epoch: 13 cost time: 2.3767638206481934
Epoch: 13, Steps: 18 | Train Loss: 1.657 Vali Loss: 3.218 Vali Acc: 0.500 Test Loss: 3.218 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.809983253479004
Epoch: 14, Steps: 18 | Train Loss: 1.181 Vali Loss: 8.274 Vali Acc: 0.470 Test Loss: 8.274 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7074708938598633
Epoch: 15, Steps: 18 | Train Loss: 3.356 Vali Loss: 4.375 Vali Acc: 0.520 Test Loss: 4.375 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1214098930358887
Epoch: 16, Steps: 18 | Train Loss: 2.051 Vali Loss: 7.309 Vali Acc: 0.570 Test Loss: 7.309 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7975046634674072
Epoch: 17, Steps: 18 | Train Loss: 1.886 Vali Loss: 5.728 Vali Acc: 0.480 Test Loss: 5.728 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5928149223327637
Epoch: 18, Steps: 18 | Train Loss: 2.323 Vali Loss: 7.774 Vali Acc: 0.470 Test Loss: 7.774 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7262957096099854
Epoch: 19, Steps: 18 | Train Loss: 1.039 Vali Loss: 10.562 Vali Acc: 0.500 Test Loss: 10.562 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.691939115524292
Epoch: 20, Steps: 18 | Train Loss: 2.563 Vali Loss: 10.693 Vali Acc: 0.480 Test Loss: 10.693 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.760812997817993
Epoch: 21, Steps: 18 | Train Loss: 1.457 Vali Loss: 14.475 Vali Acc: 0.440 Test Loss: 14.475 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6412110328674316
Epoch: 22, Steps: 18 | Train Loss: 2.249 Vali Loss: 16.813 Vali Acc: 0.480 Test Loss: 16.813 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9764538
model size : 37.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.5796589851379395
Epoch: 1, Steps: 18 | Train Loss: 0.873 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 3.267460823059082
Epoch: 2, Steps: 18 | Train Loss: 0.975 Vali Loss: 1.174 Vali Acc: 0.590 Test Loss: 1.174 Test Acc: 0.590
Validation loss decreased (-0.539991 --> -0.589988).  Saving model ...
Epoch: 3 cost time: 2.4490911960601807
Epoch: 3, Steps: 18 | Train Loss: 1.133 Vali Loss: 1.048 Vali Acc: 0.610 Test Loss: 1.048 Test Acc: 0.610
Validation loss decreased (-0.589988 --> -0.609990).  Saving model ...
Epoch: 4 cost time: 2.1302168369293213
Epoch: 4, Steps: 18 | Train Loss: 1.369 Vali Loss: 2.168 Vali Acc: 0.470 Test Loss: 2.168 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4935872554779053
Epoch: 5, Steps: 18 | Train Loss: 1.187 Vali Loss: 2.106 Vali Acc: 0.550 Test Loss: 2.106 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4374096393585205
Epoch: 6, Steps: 18 | Train Loss: 1.531 Vali Loss: 1.685 Vali Acc: 0.530 Test Loss: 1.685 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0558691024780273
Epoch: 7, Steps: 18 | Train Loss: 1.436 Vali Loss: 2.385 Vali Acc: 0.410 Test Loss: 2.385 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.732489585876465
Epoch: 8, Steps: 18 | Train Loss: 1.084 Vali Loss: 3.324 Vali Acc: 0.560 Test Loss: 3.324 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.880117416381836
Epoch: 9, Steps: 18 | Train Loss: 1.380 Vali Loss: 2.083 Vali Acc: 0.570 Test Loss: 2.083 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4294707775115967
Epoch: 10, Steps: 18 | Train Loss: 1.514 Vali Loss: 2.423 Vali Acc: 0.460 Test Loss: 2.423 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.125577926635742
Epoch: 11, Steps: 18 | Train Loss: 0.673 Vali Loss: 3.254 Vali Acc: 0.470 Test Loss: 3.254 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.637667179107666
Epoch: 12, Steps: 18 | Train Loss: 1.102 Vali Loss: 2.868 Vali Acc: 0.480 Test Loss: 2.868 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.732248306274414
Epoch: 13, Steps: 18 | Train Loss: 1.656 Vali Loss: 3.032 Vali Acc: 0.520 Test Loss: 3.032 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9749700
model size : 37.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.675545692443848
Epoch: 1, Steps: 18 | Train Loss: 1.097 Vali Loss: 1.551 Vali Acc: 0.440 Test Loss: 1.551 Test Acc: 0.440
Validation loss decreased (inf --> -0.439984).  Saving model ...
Epoch: 2 cost time: 2.7635865211486816
Epoch: 2, Steps: 18 | Train Loss: 1.155 Vali Loss: 1.429 Vali Acc: 0.480 Test Loss: 1.429 Test Acc: 0.480
Validation loss decreased (-0.439984 --> -0.479986).  Saving model ...
Epoch: 3 cost time: 2.331455945968628
Epoch: 3, Steps: 18 | Train Loss: 1.117 Vali Loss: 1.362 Vali Acc: 0.490 Test Loss: 1.362 Test Acc: 0.490
Validation loss decreased (-0.479986 --> -0.489986).  Saving model ...
Epoch: 4 cost time: 2.699446439743042
Epoch: 4, Steps: 18 | Train Loss: 1.046 Vali Loss: 3.466 Vali Acc: 0.460 Test Loss: 3.466 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7272896766662598
Epoch: 5, Steps: 18 | Train Loss: 1.357 Vali Loss: 1.394 Vali Acc: 0.540 Test Loss: 1.394 Test Acc: 0.540
Validation loss decreased (-0.489986 --> -0.539986).  Saving model ...
Epoch: 6 cost time: 2.344055414199829
Epoch: 6, Steps: 18 | Train Loss: 0.753 Vali Loss: 2.050 Vali Acc: 0.540 Test Loss: 2.050 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3988027572631836
Epoch: 7, Steps: 18 | Train Loss: 1.107 Vali Loss: 3.631 Vali Acc: 0.580 Test Loss: 3.631 Test Acc: 0.580
Validation loss decreased (-0.539986 --> -0.579964).  Saving model ...
Epoch: 8 cost time: 2.186244010925293
Epoch: 8, Steps: 18 | Train Loss: 1.541 Vali Loss: 4.850 Vali Acc: 0.520 Test Loss: 4.850 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0701589584350586
Epoch: 9, Steps: 18 | Train Loss: 1.000 Vali Loss: 4.081 Vali Acc: 0.440 Test Loss: 4.081 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3274497985839844
Epoch: 10, Steps: 18 | Train Loss: 1.871 Vali Loss: 2.922 Vali Acc: 0.470 Test Loss: 2.922 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2536380290985107
Epoch: 11, Steps: 18 | Train Loss: 2.242 Vali Loss: 4.912 Vali Acc: 0.570 Test Loss: 4.912 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3846888542175293
Epoch: 12, Steps: 18 | Train Loss: 1.634 Vali Loss: 2.729 Vali Acc: 0.520 Test Loss: 2.729 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.475078821182251
Epoch: 13, Steps: 18 | Train Loss: 1.225 Vali Loss: 3.963 Vali Acc: 0.490 Test Loss: 3.963 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5039703845977783
Epoch: 14, Steps: 18 | Train Loss: 1.392 Vali Loss: 5.875 Vali Acc: 0.520 Test Loss: 5.875 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7227606773376465
Epoch: 15, Steps: 18 | Train Loss: 1.597 Vali Loss: 5.303 Vali Acc: 0.470 Test Loss: 5.303 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6457879543304443
Epoch: 16, Steps: 18 | Train Loss: 1.311 Vali Loss: 4.490 Vali Acc: 0.490 Test Loss: 4.490 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5665950775146484
Epoch: 17, Steps: 18 | Train Loss: 1.174 Vali Loss: 4.670 Vali Acc: 0.520 Test Loss: 4.670 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9753890
model size : 37.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.128701686859131
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 1.019 Vali Acc: 0.590 Test Loss: 1.019 Test Acc: 0.590
Validation loss decreased (inf --> -0.589990).  Saving model ...
Epoch: 2 cost time: 1.9371716976165771
Epoch: 2, Steps: 18 | Train Loss: 1.250 Vali Loss: 1.890 Vali Acc: 0.510 Test Loss: 1.890 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1266231536865234
Epoch: 3, Steps: 18 | Train Loss: 1.160 Vali Loss: 1.433 Vali Acc: 0.530 Test Loss: 1.433 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0347626209259033
Epoch: 4, Steps: 18 | Train Loss: 0.979 Vali Loss: 2.309 Vali Acc: 0.500 Test Loss: 2.309 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.892439603805542
Epoch: 5, Steps: 18 | Train Loss: 1.209 Vali Loss: 1.701 Vali Acc: 0.570 Test Loss: 1.701 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.03427791595459
Epoch: 6, Steps: 18 | Train Loss: 1.323 Vali Loss: 2.075 Vali Acc: 0.430 Test Loss: 2.075 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7535245418548584
Epoch: 7, Steps: 18 | Train Loss: 0.905 Vali Loss: 2.378 Vali Acc: 0.530 Test Loss: 2.378 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2632782459259033
Epoch: 8, Steps: 18 | Train Loss: 1.146 Vali Loss: 2.500 Vali Acc: 0.540 Test Loss: 2.500 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7650554180145264
Epoch: 9, Steps: 18 | Train Loss: 0.766 Vali Loss: 2.222 Vali Acc: 0.520 Test Loss: 2.222 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8455140590667725
Epoch: 10, Steps: 18 | Train Loss: 1.197 Vali Loss: 4.218 Vali Acc: 0.560 Test Loss: 4.218 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1199915409088135
Epoch: 11, Steps: 18 | Train Loss: 1.189 Vali Loss: 3.769 Vali Acc: 0.430 Test Loss: 3.769 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9770852
model size : 37.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.470855712890625
Epoch: 1, Steps: 18 | Train Loss: 1.351 Vali Loss: 1.051 Vali Acc: 0.480 Test Loss: 1.051 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 2.2055439949035645
Epoch: 2, Steps: 18 | Train Loss: 1.169 Vali Loss: 1.367 Vali Acc: 0.540 Test Loss: 1.367 Test Acc: 0.540
Validation loss decreased (-0.479989 --> -0.539986).  Saving model ...
Epoch: 3 cost time: 2.1603586673736572
Epoch: 3, Steps: 18 | Train Loss: 1.246 Vali Loss: 1.260 Vali Acc: 0.460 Test Loss: 1.260 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.230719566345215
Epoch: 4, Steps: 18 | Train Loss: 1.451 Vali Loss: 1.562 Vali Acc: 0.540 Test Loss: 1.562 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.216611862182617
Epoch: 5, Steps: 18 | Train Loss: 1.279 Vali Loss: 1.532 Vali Acc: 0.560 Test Loss: 1.532 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559985).  Saving model ...
Epoch: 6 cost time: 2.102440118789673
Epoch: 6, Steps: 18 | Train Loss: 1.460 Vali Loss: 3.504 Vali Acc: 0.590 Test Loss: 3.504 Test Acc: 0.590
Validation loss decreased (-0.559985 --> -0.589965).  Saving model ...
Epoch: 7 cost time: 2.684648036956787
Epoch: 7, Steps: 18 | Train Loss: 1.597 Vali Loss: 4.382 Vali Acc: 0.440 Test Loss: 4.382 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.163553476333618
Epoch: 8, Steps: 18 | Train Loss: 1.599 Vali Loss: 2.755 Vali Acc: 0.510 Test Loss: 2.755 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2666218280792236
Epoch: 9, Steps: 18 | Train Loss: 1.222 Vali Loss: 3.898 Vali Acc: 0.440 Test Loss: 3.898 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.163346529006958
Epoch: 10, Steps: 18 | Train Loss: 1.081 Vali Loss: 3.506 Vali Acc: 0.570 Test Loss: 3.506 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5372369289398193
Epoch: 11, Steps: 18 | Train Loss: 1.068 Vali Loss: 2.504 Vali Acc: 0.510 Test Loss: 2.504 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.123011827468872
Epoch: 12, Steps: 18 | Train Loss: 1.054 Vali Loss: 5.315 Vali Acc: 0.480 Test Loss: 5.315 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1388683319091797
Epoch: 13, Steps: 18 | Train Loss: 1.810 Vali Loss: 4.410 Vali Acc: 0.460 Test Loss: 4.410 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1911065578460693
Epoch: 14, Steps: 18 | Train Loss: 1.205 Vali Loss: 4.975 Vali Acc: 0.590 Test Loss: 4.975 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0392911434173584
Epoch: 15, Steps: 18 | Train Loss: 1.163 Vali Loss: 6.400 Vali Acc: 0.390 Test Loss: 6.400 Test Acc: 0.390
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.204737663269043
Epoch: 16, Steps: 18 | Train Loss: 2.230 Vali Loss: 12.176 Vali Acc: 0.410 Test Loss: 12.176 Test Acc: 0.410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9737074
model size : 37.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6786420345306396
Epoch: 1, Steps: 18 | Train Loss: 0.937 Vali Loss: 1.011 Vali Acc: 0.540 Test Loss: 1.011 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 2.0206801891326904
Epoch: 2, Steps: 18 | Train Loss: 1.097 Vali Loss: 0.934 Vali Acc: 0.540 Test Loss: 0.934 Test Acc: 0.540
Validation loss decreased (-0.539990 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 1.9811716079711914
Epoch: 3, Steps: 18 | Train Loss: 1.127 Vali Loss: 1.227 Vali Acc: 0.460 Test Loss: 1.227 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1536953449249268
Epoch: 4, Steps: 18 | Train Loss: 1.183 Vali Loss: 1.419 Vali Acc: 0.500 Test Loss: 1.419 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7035856246948242
Epoch: 5, Steps: 18 | Train Loss: 1.214 Vali Loss: 4.039 Vali Acc: 0.480 Test Loss: 4.039 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8731322288513184
Epoch: 6, Steps: 18 | Train Loss: 1.344 Vali Loss: 2.499 Vali Acc: 0.470 Test Loss: 2.499 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.135876178741455
Epoch: 7, Steps: 18 | Train Loss: 1.581 Vali Loss: 3.423 Vali Acc: 0.430 Test Loss: 3.423 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.332063674926758
Epoch: 8, Steps: 18 | Train Loss: 1.473 Vali Loss: 3.499 Vali Acc: 0.480 Test Loss: 3.499 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.30550217628479
Epoch: 9, Steps: 18 | Train Loss: 1.071 Vali Loss: 1.975 Vali Acc: 0.510 Test Loss: 1.975 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8054931163787842
Epoch: 10, Steps: 18 | Train Loss: 2.066 Vali Loss: 6.820 Vali Acc: 0.540 Test Loss: 6.820 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2366318702697754
Epoch: 11, Steps: 18 | Train Loss: 1.489 Vali Loss: 5.661 Vali Acc: 0.450 Test Loss: 5.661 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0619916915893555
Epoch: 12, Steps: 18 | Train Loss: 1.594 Vali Loss: 3.461 Vali Acc: 0.540 Test Loss: 3.461 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9758068
model size : 37.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.044264554977417
Epoch: 1, Steps: 18 | Train Loss: 0.940 Vali Loss: 0.936 Vali Acc: 0.570 Test Loss: 0.936 Test Acc: 0.570
Validation loss decreased (inf --> -0.569991).  Saving model ...
Epoch: 2 cost time: 1.8676421642303467
Epoch: 2, Steps: 18 | Train Loss: 1.680 Vali Loss: 1.503 Vali Acc: 0.500 Test Loss: 1.503 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3524632453918457
Epoch: 3, Steps: 18 | Train Loss: 1.308 Vali Loss: 1.243 Vali Acc: 0.540 Test Loss: 1.243 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0681633949279785
Epoch: 4, Steps: 18 | Train Loss: 1.141 Vali Loss: 1.366 Vali Acc: 0.480 Test Loss: 1.366 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0194475650787354
Epoch: 5, Steps: 18 | Train Loss: 0.856 Vali Loss: 2.182 Vali Acc: 0.500 Test Loss: 2.182 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1312482357025146
Epoch: 6, Steps: 18 | Train Loss: 1.706 Vali Loss: 1.942 Vali Acc: 0.420 Test Loss: 1.942 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.759584903717041
Epoch: 7, Steps: 18 | Train Loss: 0.594 Vali Loss: 2.117 Vali Acc: 0.500 Test Loss: 2.117 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.329143762588501
Epoch: 8, Steps: 18 | Train Loss: 0.904 Vali Loss: 1.640 Vali Acc: 0.560 Test Loss: 1.640 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.028909921646118
Epoch: 9, Steps: 18 | Train Loss: 1.087 Vali Loss: 2.331 Vali Acc: 0.530 Test Loss: 2.331 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1272525787353516
Epoch: 10, Steps: 18 | Train Loss: 1.744 Vali Loss: 3.748 Vali Acc: 0.580 Test Loss: 3.748 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579963).  Saving model ...
Epoch: 11 cost time: 2.150218963623047
Epoch: 11, Steps: 18 | Train Loss: 1.004 Vali Loss: 3.697 Vali Acc: 0.540 Test Loss: 3.697 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8200063705444336
Epoch: 12, Steps: 18 | Train Loss: 1.287 Vali Loss: 3.934 Vali Acc: 0.500 Test Loss: 3.934 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2898073196411133
Epoch: 13, Steps: 18 | Train Loss: 1.223 Vali Loss: 5.594 Vali Acc: 0.490 Test Loss: 5.594 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.317507266998291
Epoch: 14, Steps: 18 | Train Loss: 1.068 Vali Loss: 5.658 Vali Acc: 0.460 Test Loss: 5.658 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7915117740631104
Epoch: 15, Steps: 18 | Train Loss: 1.301 Vali Loss: 6.518 Vali Acc: 0.530 Test Loss: 6.518 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1953303813934326
Epoch: 16, Steps: 18 | Train Loss: 1.385 Vali Loss: 5.736 Vali Acc: 0.470 Test Loss: 5.736 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2172486782073975
Epoch: 17, Steps: 18 | Train Loss: 1.897 Vali Loss: 12.740 Vali Acc: 0.410 Test Loss: 12.740 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0842366218566895
Epoch: 18, Steps: 18 | Train Loss: 0.537 Vali Loss: 9.643 Vali Acc: 0.390 Test Loss: 9.643 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.101519823074341
Epoch: 19, Steps: 18 | Train Loss: 0.869 Vali Loss: 14.390 Vali Acc: 0.450 Test Loss: 14.390 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.774947166442871
Epoch: 20, Steps: 18 | Train Loss: 0.756 Vali Loss: 9.223 Vali Acc: 0.480 Test Loss: 9.223 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9758322
model size : 37.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.427711725234985
Epoch: 1, Steps: 18 | Train Loss: 1.255 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
Validation loss decreased (inf --> -0.539989).  Saving model ...
Epoch: 2 cost time: 2.8690130710601807
Epoch: 2, Steps: 18 | Train Loss: 1.084 Vali Loss: 1.706 Vali Acc: 0.470 Test Loss: 1.706 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8618829250335693
Epoch: 3, Steps: 18 | Train Loss: 1.264 Vali Loss: 1.614 Vali Acc: 0.470 Test Loss: 1.614 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7150497436523438
Epoch: 4, Steps: 18 | Train Loss: 1.149 Vali Loss: 1.874 Vali Acc: 0.550 Test Loss: 1.874 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549981).  Saving model ...
Epoch: 5 cost time: 2.8942806720733643
Epoch: 5, Steps: 18 | Train Loss: 0.993 Vali Loss: 1.337 Vali Acc: 0.540 Test Loss: 1.337 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.944619655609131
Epoch: 6, Steps: 18 | Train Loss: 0.835 Vali Loss: 1.530 Vali Acc: 0.520 Test Loss: 1.530 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9026172161102295
Epoch: 7, Steps: 18 | Train Loss: 0.939 Vali Loss: 2.469 Vali Acc: 0.500 Test Loss: 2.469 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.125659227371216
Epoch: 8, Steps: 18 | Train Loss: 0.934 Vali Loss: 2.555 Vali Acc: 0.530 Test Loss: 2.555 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9079623222351074
Epoch: 9, Steps: 18 | Train Loss: 1.023 Vali Loss: 3.848 Vali Acc: 0.430 Test Loss: 3.848 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5586161613464355
Epoch: 10, Steps: 18 | Train Loss: 1.457 Vali Loss: 2.999 Vali Acc: 0.570 Test Loss: 2.999 Test Acc: 0.570
Validation loss decreased (-0.549981 --> -0.569970).  Saving model ...
Epoch: 11 cost time: 2.483001947402954
Epoch: 11, Steps: 18 | Train Loss: 1.488 Vali Loss: 2.769 Vali Acc: 0.430 Test Loss: 2.769 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.859555244445801
Epoch: 12, Steps: 18 | Train Loss: 1.219 Vali Loss: 4.196 Vali Acc: 0.470 Test Loss: 4.196 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5572400093078613
Epoch: 13, Steps: 18 | Train Loss: 1.256 Vali Loss: 3.557 Vali Acc: 0.510 Test Loss: 3.557 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.473245859146118
Epoch: 14, Steps: 18 | Train Loss: 2.633 Vali Loss: 8.198 Vali Acc: 0.470 Test Loss: 8.198 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4545187950134277
Epoch: 15, Steps: 18 | Train Loss: 3.737 Vali Loss: 8.955 Vali Acc: 0.450 Test Loss: 8.955 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6241400241851807
Epoch: 16, Steps: 18 | Train Loss: 1.728 Vali Loss: 4.014 Vali Acc: 0.550 Test Loss: 4.014 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5457990169525146
Epoch: 17, Steps: 18 | Train Loss: 1.523 Vali Loss: 4.852 Vali Acc: 0.480 Test Loss: 4.852 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8520541191101074
Epoch: 18, Steps: 18 | Train Loss: 0.959 Vali Loss: 6.388 Vali Acc: 0.460 Test Loss: 6.388 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6780617237091064
Epoch: 19, Steps: 18 | Train Loss: 1.669 Vali Loss: 8.053 Vali Acc: 0.520 Test Loss: 8.053 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.9332761764526367
Epoch: 20, Steps: 18 | Train Loss: 1.532 Vali Loss: 5.361 Vali Acc: 0.510 Test Loss: 5.361 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9746836
model size : 37.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.136608362197876
Epoch: 1, Steps: 18 | Train Loss: 0.914 Vali Loss: 1.349 Vali Acc: 0.480 Test Loss: 1.349 Test Acc: 0.480
Validation loss decreased (inf --> -0.479987).  Saving model ...
Epoch: 2 cost time: 1.949791431427002
Epoch: 2, Steps: 18 | Train Loss: 1.474 Vali Loss: 1.668 Vali Acc: 0.470 Test Loss: 1.668 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9090425968170166
Epoch: 3, Steps: 18 | Train Loss: 1.225 Vali Loss: 1.358 Vali Acc: 0.550 Test Loss: 1.358 Test Acc: 0.550
Validation loss decreased (-0.479987 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 1.7715139389038086
Epoch: 4, Steps: 18 | Train Loss: 0.862 Vali Loss: 0.995 Vali Acc: 0.540 Test Loss: 0.995 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0340757369995117
Epoch: 5, Steps: 18 | Train Loss: 0.848 Vali Loss: 2.108 Vali Acc: 0.460 Test Loss: 2.108 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3561484813690186
Epoch: 6, Steps: 18 | Train Loss: 0.881 Vali Loss: 2.383 Vali Acc: 0.490 Test Loss: 2.383 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3052008152008057
Epoch: 7, Steps: 18 | Train Loss: 0.978 Vali Loss: 4.120 Vali Acc: 0.440 Test Loss: 4.120 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3749430179595947
Epoch: 8, Steps: 18 | Train Loss: 0.869 Vali Loss: 2.989 Vali Acc: 0.520 Test Loss: 2.989 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3148515224456787
Epoch: 9, Steps: 18 | Train Loss: 0.949 Vali Loss: 2.053 Vali Acc: 0.570 Test Loss: 2.053 Test Acc: 0.570
Validation loss decreased (-0.549986 --> -0.569979).  Saving model ...
Epoch: 10 cost time: 1.8104429244995117
Epoch: 10, Steps: 18 | Train Loss: 0.930 Vali Loss: 2.488 Vali Acc: 0.510 Test Loss: 2.488 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7352006435394287
Epoch: 11, Steps: 18 | Train Loss: 1.166 Vali Loss: 4.112 Vali Acc: 0.520 Test Loss: 4.112 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.398796558380127
Epoch: 12, Steps: 18 | Train Loss: 0.836 Vali Loss: 3.624 Vali Acc: 0.510 Test Loss: 3.624 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1066532135009766
Epoch: 13, Steps: 18 | Train Loss: 2.196 Vali Loss: 11.564 Vali Acc: 0.550 Test Loss: 11.564 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2125587463378906
Epoch: 14, Steps: 18 | Train Loss: 3.690 Vali Loss: 3.528 Vali Acc: 0.530 Test Loss: 3.528 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.976614236831665
Epoch: 15, Steps: 18 | Train Loss: 1.187 Vali Loss: 5.098 Vali Acc: 0.490 Test Loss: 5.098 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8360989093780518
Epoch: 16, Steps: 18 | Train Loss: 0.970 Vali Loss: 5.967 Vali Acc: 0.550 Test Loss: 5.967 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.070746898651123
Epoch: 17, Steps: 18 | Train Loss: 1.688 Vali Loss: 7.009 Vali Acc: 0.550 Test Loss: 7.009 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2952754497528076
Epoch: 18, Steps: 18 | Train Loss: 2.207 Vali Loss: 9.355 Vali Acc: 0.460 Test Loss: 9.355 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0247750282287598
Epoch: 19, Steps: 18 | Train Loss: 1.228 Vali Loss: 13.547 Vali Acc: 0.460 Test Loss: 13.547 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9732610
model size : 37.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.5540571212768555
Epoch: 1, Steps: 18 | Train Loss: 1.088 Vali Loss: 1.432 Vali Acc: 0.650 Test Loss: 1.432 Test Acc: 0.650
Validation loss decreased (inf --> -0.649986).  Saving model ...
Epoch: 2 cost time: 1.7778186798095703
Epoch: 2, Steps: 18 | Train Loss: 1.458 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.306065797805786
Epoch: 3, Steps: 18 | Train Loss: 0.942 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6287946701049805
Epoch: 4, Steps: 18 | Train Loss: 0.909 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5764994621276855
Epoch: 5, Steps: 18 | Train Loss: 0.893 Vali Loss: 1.883 Vali Acc: 0.410 Test Loss: 1.883 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.584887981414795
Epoch: 6, Steps: 18 | Train Loss: 0.960 Vali Loss: 1.418 Vali Acc: 0.580 Test Loss: 1.418 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8407084941864014
Epoch: 7, Steps: 18 | Train Loss: 0.972 Vali Loss: 2.688 Vali Acc: 0.450 Test Loss: 2.688 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1264595985412598
Epoch: 8, Steps: 18 | Train Loss: 1.761 Vali Loss: 4.600 Vali Acc: 0.460 Test Loss: 4.600 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.374971628189087
Epoch: 9, Steps: 18 | Train Loss: 1.505 Vali Loss: 2.743 Vali Acc: 0.520 Test Loss: 2.743 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0035722255706787
Epoch: 10, Steps: 18 | Train Loss: 1.173 Vali Loss: 4.519 Vali Acc: 0.540 Test Loss: 4.519 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8741824626922607
Epoch: 11, Steps: 18 | Train Loss: 1.871 Vali Loss: 5.667 Vali Acc: 0.470 Test Loss: 5.667 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 9724644
model size : 37.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.5217835903167725
Epoch: 1, Steps: 18 | Train Loss: 1.024 Vali Loss: 1.538 Vali Acc: 0.430 Test Loss: 1.538 Test Acc: 0.430
Validation loss decreased (inf --> -0.429985).  Saving model ...
Epoch: 2 cost time: 2.121988296508789
Epoch: 2, Steps: 18 | Train Loss: 1.156 Vali Loss: 2.409 Vali Acc: 0.420 Test Loss: 2.409 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.052227020263672
Epoch: 3, Steps: 18 | Train Loss: 1.720 Vali Loss: 0.912 Vali Acc: 0.470 Test Loss: 0.912 Test Acc: 0.470
Validation loss decreased (-0.429985 --> -0.469991).  Saving model ...
Epoch: 4 cost time: 2.3168325424194336
Epoch: 4, Steps: 18 | Train Loss: 1.945 Vali Loss: 1.651 Vali Acc: 0.480 Test Loss: 1.651 Test Acc: 0.480
Validation loss decreased (-0.469991 --> -0.479983).  Saving model ...
Epoch: 5 cost time: 2.2988314628601074
Epoch: 5, Steps: 18 | Train Loss: 1.383 Vali Loss: 1.408 Vali Acc: 0.510 Test Loss: 1.408 Test Acc: 0.510
Validation loss decreased (-0.479983 --> -0.509986).  Saving model ...
Epoch: 6 cost time: 2.2887802124023438
Epoch: 6, Steps: 18 | Train Loss: 1.084 Vali Loss: 1.624 Vali Acc: 0.500 Test Loss: 1.624 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.040665626525879
Epoch: 7, Steps: 18 | Train Loss: 0.982 Vali Loss: 3.582 Vali Acc: 0.410 Test Loss: 3.582 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5898988246917725
Epoch: 8, Steps: 18 | Train Loss: 1.293 Vali Loss: 2.859 Vali Acc: 0.460 Test Loss: 2.859 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.225287437438965
Epoch: 9, Steps: 18 | Train Loss: 0.991 Vali Loss: 1.840 Vali Acc: 0.580 Test Loss: 1.840 Test Acc: 0.580
Validation loss decreased (-0.509986 --> -0.579982).  Saving model ...
Epoch: 10 cost time: 2.145111322402954
Epoch: 10, Steps: 18 | Train Loss: 1.191 Vali Loss: 2.169 Vali Acc: 0.540 Test Loss: 2.169 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.118114948272705
Epoch: 11, Steps: 18 | Train Loss: 1.670 Vali Loss: 8.535 Vali Acc: 0.470 Test Loss: 8.535 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4698410034179688
Epoch: 12, Steps: 18 | Train Loss: 1.732 Vali Loss: 3.010 Vali Acc: 0.490 Test Loss: 3.010 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.22206449508667
Epoch: 13, Steps: 18 | Train Loss: 1.037 Vali Loss: 6.456 Vali Acc: 0.470 Test Loss: 6.456 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2304980754852295
Epoch: 14, Steps: 18 | Train Loss: 1.645 Vali Loss: 3.400 Vali Acc: 0.490 Test Loss: 3.400 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.285719633102417
Epoch: 15, Steps: 18 | Train Loss: 1.498 Vali Loss: 4.311 Vali Acc: 0.530 Test Loss: 4.311 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3774707317352295
Epoch: 16, Steps: 18 | Train Loss: 1.282 Vali Loss: 5.075 Vali Acc: 0.430 Test Loss: 5.075 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4738709926605225
Epoch: 17, Steps: 18 | Train Loss: 1.469 Vali Loss: 7.978 Vali Acc: 0.540 Test Loss: 7.978 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9126074314117432
Epoch: 18, Steps: 18 | Train Loss: 1.685 Vali Loss: 7.021 Vali Acc: 0.460 Test Loss: 7.021 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7635774612426758
Epoch: 19, Steps: 18 | Train Loss: 1.179 Vali Loss: 7.157 Vali Acc: 0.490 Test Loss: 7.157 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm512_cs143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9731938
model size : 37.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.077779531478882
Epoch: 1, Steps: 18 | Train Loss: 1.398 Vali Loss: 2.044 Vali Acc: 0.570 Test Loss: 2.044 Test Acc: 0.570
Validation loss decreased (inf --> -0.569980).  Saving model ...
Epoch: 2 cost time: 1.7422828674316406
Epoch: 2, Steps: 18 | Train Loss: 1.450 Vali Loss: 1.716 Vali Acc: 0.440 Test Loss: 1.716 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9001872539520264
Epoch: 3, Steps: 18 | Train Loss: 1.200 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0756092071533203
Epoch: 4, Steps: 18 | Train Loss: 1.420 Vali Loss: 1.715 Vali Acc: 0.540 Test Loss: 1.715 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8687100410461426
Epoch: 5, Steps: 18 | Train Loss: 1.192 Vali Loss: 1.565 Vali Acc: 0.530 Test Loss: 1.565 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.609334945678711
Epoch: 6, Steps: 18 | Train Loss: 0.860 Vali Loss: 2.047 Vali Acc: 0.530 Test Loss: 2.047 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7326602935791016
Epoch: 7, Steps: 18 | Train Loss: 1.277 Vali Loss: 2.105 Vali Acc: 0.540 Test Loss: 2.105 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7695698738098145
Epoch: 8, Steps: 18 | Train Loss: 0.948 Vali Loss: 4.810 Vali Acc: 0.450 Test Loss: 4.810 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7667450904846191
Epoch: 9, Steps: 18 | Train Loss: 1.283 Vali Loss: 7.774 Vali Acc: 0.420 Test Loss: 7.774 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7631802558898926
Epoch: 10, Steps: 18 | Train Loss: 1.707 Vali Loss: 2.486 Vali Acc: 0.500 Test Loss: 2.486 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7070040702819824
Epoch: 11, Steps: 18 | Train Loss: 1.088 Vali Loss: 3.845 Vali Acc: 0.500 Test Loss: 3.845 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9707204
model size : 37.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.279588460922241
Epoch: 1, Steps: 18 | Train Loss: 1.064 Vali Loss: 1.850 Vali Acc: 0.420 Test Loss: 1.850 Test Acc: 0.420
Validation loss decreased (inf --> -0.419982).  Saving model ...
Epoch: 2 cost time: 2.451578378677368
Epoch: 2, Steps: 18 | Train Loss: 1.548 Vali Loss: 1.533 Vali Acc: 0.460 Test Loss: 1.533 Test Acc: 0.460
Validation loss decreased (-0.419982 --> -0.459985).  Saving model ...
Epoch: 3 cost time: 2.1246883869171143
Epoch: 3, Steps: 18 | Train Loss: 1.071 Vali Loss: 1.917 Vali Acc: 0.490 Test Loss: 1.917 Test Acc: 0.490
Validation loss decreased (-0.459985 --> -0.489981).  Saving model ...
Epoch: 4 cost time: 2.1949193477630615
Epoch: 4, Steps: 18 | Train Loss: 1.325 Vali Loss: 1.041 Vali Acc: 0.540 Test Loss: 1.041 Test Acc: 0.540
Validation loss decreased (-0.489981 --> -0.539990).  Saving model ...
Epoch: 5 cost time: 2.4733455181121826
Epoch: 5, Steps: 18 | Train Loss: 1.007 Vali Loss: 1.608 Vali Acc: 0.510 Test Loss: 1.608 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3829004764556885
Epoch: 6, Steps: 18 | Train Loss: 1.131 Vali Loss: 1.885 Vali Acc: 0.520 Test Loss: 1.885 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.178165912628174
Epoch: 7, Steps: 18 | Train Loss: 1.719 Vali Loss: 5.061 Vali Acc: 0.450 Test Loss: 5.061 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.151261568069458
Epoch: 8, Steps: 18 | Train Loss: 1.961 Vali Loss: 2.574 Vali Acc: 0.500 Test Loss: 2.574 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1358823776245117
Epoch: 9, Steps: 18 | Train Loss: 1.462 Vali Loss: 2.731 Vali Acc: 0.500 Test Loss: 2.731 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5562188625335693
Epoch: 10, Steps: 18 | Train Loss: 1.435 Vali Loss: 3.132 Vali Acc: 0.540 Test Loss: 3.132 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.04714298248291
Epoch: 11, Steps: 18 | Train Loss: 2.909 Vali Loss: 4.926 Vali Acc: 0.470 Test Loss: 4.926 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4233174324035645
Epoch: 12, Steps: 18 | Train Loss: 1.914 Vali Loss: 4.502 Vali Acc: 0.490 Test Loss: 4.502 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9655048847198486
Epoch: 13, Steps: 18 | Train Loss: 2.022 Vali Loss: 4.049 Vali Acc: 0.530 Test Loss: 4.049 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7973053455352783
Epoch: 14, Steps: 18 | Train Loss: 1.650 Vali Loss: 4.396 Vali Acc: 0.500 Test Loss: 4.396 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9643218
model size : 36.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9775257110595703
Epoch: 1, Steps: 18 | Train Loss: 1.057 Vali Loss: 0.952 Vali Acc: 0.520 Test Loss: 0.952 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 1.9769260883331299
Epoch: 2, Steps: 18 | Train Loss: 1.249 Vali Loss: 2.258 Vali Acc: 0.450 Test Loss: 2.258 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3063089847564697
Epoch: 3, Steps: 18 | Train Loss: 1.191 Vali Loss: 1.173 Vali Acc: 0.630 Test Loss: 1.173 Test Acc: 0.630
Validation loss decreased (-0.519990 --> -0.629988).  Saving model ...
Epoch: 4 cost time: 2.4830517768859863
Epoch: 4, Steps: 18 | Train Loss: 1.307 Vali Loss: 1.989 Vali Acc: 0.440 Test Loss: 1.989 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0839285850524902
Epoch: 5, Steps: 18 | Train Loss: 0.917 Vali Loss: 1.765 Vali Acc: 0.590 Test Loss: 1.765 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.235072135925293
Epoch: 6, Steps: 18 | Train Loss: 1.126 Vali Loss: 1.418 Vali Acc: 0.460 Test Loss: 1.418 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9486212730407715
Epoch: 7, Steps: 18 | Train Loss: 1.280 Vali Loss: 3.894 Vali Acc: 0.490 Test Loss: 3.894 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9137444496154785
Epoch: 8, Steps: 18 | Train Loss: 1.308 Vali Loss: 2.345 Vali Acc: 0.600 Test Loss: 2.345 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0579235553741455
Epoch: 9, Steps: 18 | Train Loss: 1.500 Vali Loss: 2.776 Vali Acc: 0.480 Test Loss: 2.776 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7761497497558594
Epoch: 10, Steps: 18 | Train Loss: 0.904 Vali Loss: 2.387 Vali Acc: 0.450 Test Loss: 2.387 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6642982959747314
Epoch: 11, Steps: 18 | Train Loss: 1.061 Vali Loss: 3.454 Vali Acc: 0.410 Test Loss: 3.454 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6810245513916016
Epoch: 12, Steps: 18 | Train Loss: 0.723 Vali Loss: 3.518 Vali Acc: 0.470 Test Loss: 3.518 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.797896385192871
Epoch: 13, Steps: 18 | Train Loss: 0.949 Vali Loss: 3.260 Vali Acc: 0.490 Test Loss: 3.260 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 9611236
model size : 36.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.856377363204956
Epoch: 1, Steps: 18 | Train Loss: 1.037 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.7791671752929688
Epoch: 2, Steps: 18 | Train Loss: 1.107 Vali Loss: 1.347 Vali Acc: 0.490 Test Loss: 1.347 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8390769958496094
Epoch: 3, Steps: 18 | Train Loss: 1.288 Vali Loss: 1.495 Vali Acc: 0.520 Test Loss: 1.495 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519985).  Saving model ...
Epoch: 4 cost time: 2.2072155475616455
Epoch: 4, Steps: 18 | Train Loss: 1.140 Vali Loss: 2.516 Vali Acc: 0.430 Test Loss: 2.516 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5221948623657227
Epoch: 5, Steps: 18 | Train Loss: 1.509 Vali Loss: 1.349 Vali Acc: 0.440 Test Loss: 1.349 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4829156398773193
Epoch: 6, Steps: 18 | Train Loss: 0.988 Vali Loss: 2.352 Vali Acc: 0.590 Test Loss: 2.352 Test Acc: 0.590
Validation loss decreased (-0.519985 --> -0.589976).  Saving model ...
Epoch: 7 cost time: 2.109069585800171
Epoch: 7, Steps: 18 | Train Loss: 1.030 Vali Loss: 3.450 Vali Acc: 0.450 Test Loss: 3.450 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0531749725341797
Epoch: 8, Steps: 18 | Train Loss: 1.114 Vali Loss: 2.450 Vali Acc: 0.580 Test Loss: 2.450 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1240227222442627
Epoch: 9, Steps: 18 | Train Loss: 2.253 Vali Loss: 2.587 Vali Acc: 0.520 Test Loss: 2.587 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8776705265045166
Epoch: 10, Steps: 18 | Train Loss: 0.937 Vali Loss: 2.790 Vali Acc: 0.510 Test Loss: 2.790 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.86222505569458
Epoch: 11, Steps: 18 | Train Loss: 1.310 Vali Loss: 5.526 Vali Acc: 0.450 Test Loss: 5.526 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.982358455657959
Epoch: 12, Steps: 18 | Train Loss: 1.651 Vali Loss: 3.166 Vali Acc: 0.480 Test Loss: 3.166 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.322847843170166
Epoch: 13, Steps: 18 | Train Loss: 1.421 Vali Loss: 5.861 Vali Acc: 0.450 Test Loss: 5.861 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8713657855987549
Epoch: 14, Steps: 18 | Train Loss: 2.345 Vali Loss: 3.644 Vali Acc: 0.530 Test Loss: 3.644 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.152914047241211
Epoch: 15, Steps: 18 | Train Loss: 1.330 Vali Loss: 4.993 Vali Acc: 0.520 Test Loss: 4.993 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7721941471099854
Epoch: 16, Steps: 18 | Train Loss: 1.652 Vali Loss: 6.371 Vali Acc: 0.590 Test Loss: 6.371 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9592058
model size : 36.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.273413896560669
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 1.8625965118408203
Epoch: 2, Steps: 18 | Train Loss: 1.365 Vali Loss: 1.277 Vali Acc: 0.430 Test Loss: 1.277 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.478344202041626
Epoch: 3, Steps: 18 | Train Loss: 1.372 Vali Loss: 1.321 Vali Acc: 0.530 Test Loss: 1.321 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6722698211669922
Epoch: 4, Steps: 18 | Train Loss: 1.101 Vali Loss: 1.391 Vali Acc: 0.550 Test Loss: 1.391 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549986).  Saving model ...
Epoch: 5 cost time: 1.5820088386535645
Epoch: 5, Steps: 18 | Train Loss: 0.854 Vali Loss: 2.132 Vali Acc: 0.430 Test Loss: 2.132 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4117813110351562
Epoch: 6, Steps: 18 | Train Loss: 1.364 Vali Loss: 1.606 Vali Acc: 0.480 Test Loss: 1.606 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6416339874267578
Epoch: 7, Steps: 18 | Train Loss: 0.916 Vali Loss: 2.202 Vali Acc: 0.520 Test Loss: 2.202 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4546244144439697
Epoch: 8, Steps: 18 | Train Loss: 1.062 Vali Loss: 1.853 Vali Acc: 0.530 Test Loss: 1.853 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5484726428985596
Epoch: 9, Steps: 18 | Train Loss: 0.926 Vali Loss: 6.884 Vali Acc: 0.490 Test Loss: 6.884 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5890226364135742
Epoch: 10, Steps: 18 | Train Loss: 1.850 Vali Loss: 3.510 Vali Acc: 0.420 Test Loss: 3.510 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3684687614440918
Epoch: 11, Steps: 18 | Train Loss: 1.710 Vali Loss: 2.917 Vali Acc: 0.520 Test Loss: 2.917 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7783150672912598
Epoch: 12, Steps: 18 | Train Loss: 1.245 Vali Loss: 2.622 Vali Acc: 0.560 Test Loss: 2.622 Test Acc: 0.560
Validation loss decreased (-0.549986 --> -0.559974).  Saving model ...
Epoch: 13 cost time: 1.4624640941619873
Epoch: 13, Steps: 18 | Train Loss: 1.749 Vali Loss: 5.646 Vali Acc: 0.400 Test Loss: 5.646 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.596177101135254
Epoch: 14, Steps: 18 | Train Loss: 1.312 Vali Loss: 4.002 Vali Acc: 0.510 Test Loss: 4.002 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5807504653930664
Epoch: 15, Steps: 18 | Train Loss: 0.841 Vali Loss: 4.405 Vali Acc: 0.520 Test Loss: 4.405 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6885337829589844
Epoch: 16, Steps: 18 | Train Loss: 1.287 Vali Loss: 4.771 Vali Acc: 0.490 Test Loss: 4.771 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5862855911254883
Epoch: 17, Steps: 18 | Train Loss: 1.230 Vali Loss: 4.382 Vali Acc: 0.610 Test Loss: 4.382 Test Acc: 0.610
Validation loss decreased (-0.559974 --> -0.609956).  Saving model ...
Epoch: 18 cost time: 1.773850917816162
Epoch: 18, Steps: 18 | Train Loss: 1.569 Vali Loss: 6.615 Vali Acc: 0.530 Test Loss: 6.615 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7268922328948975
Epoch: 19, Steps: 18 | Train Loss: 2.916 Vali Loss: 5.949 Vali Acc: 0.600 Test Loss: 5.949 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5495853424072266
Epoch: 20, Steps: 18 | Train Loss: 2.550 Vali Loss: 6.423 Vali Acc: 0.570 Test Loss: 6.423 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5161783695220947
Epoch: 21, Steps: 18 | Train Loss: 1.145 Vali Loss: 11.112 Vali Acc: 0.550 Test Loss: 11.112 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8172721862792969
Epoch: 22, Steps: 18 | Train Loss: 1.679 Vali Loss: 8.221 Vali Acc: 0.500 Test Loss: 8.221 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.0086019039154053
Epoch: 23, Steps: 18 | Train Loss: 1.829 Vali Loss: 12.214 Vali Acc: 0.560 Test Loss: 12.214 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4691970348358154
Epoch: 24, Steps: 18 | Train Loss: 1.074 Vali Loss: 13.275 Vali Acc: 0.500 Test Loss: 13.275 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.796072244644165
Epoch: 25, Steps: 18 | Train Loss: 1.578 Vali Loss: 9.246 Vali Acc: 0.550 Test Loss: 9.246 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6394157409667969
Epoch: 26, Steps: 18 | Train Loss: 1.892 Vali Loss: 8.405 Vali Acc: 0.520 Test Loss: 8.405 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5888850688934326
Epoch: 27, Steps: 18 | Train Loss: 0.702 Vali Loss: 6.787 Vali Acc: 0.590 Test Loss: 6.787 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9579284
model size : 36.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3173460960388184
Epoch: 1, Steps: 18 | Train Loss: 1.089 Vali Loss: 1.378 Vali Acc: 0.590 Test Loss: 1.378 Test Acc: 0.590
Validation loss decreased (inf --> -0.589986).  Saving model ...
Epoch: 2 cost time: 1.8691692352294922
Epoch: 2, Steps: 18 | Train Loss: 0.962 Vali Loss: 1.450 Vali Acc: 0.510 Test Loss: 1.450 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8124091625213623
Epoch: 3, Steps: 18 | Train Loss: 1.060 Vali Loss: 1.442 Vali Acc: 0.560 Test Loss: 1.442 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7895090579986572
Epoch: 4, Steps: 18 | Train Loss: 1.031 Vali Loss: 2.807 Vali Acc: 0.450 Test Loss: 2.807 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6677708625793457
Epoch: 5, Steps: 18 | Train Loss: 1.258 Vali Loss: 2.784 Vali Acc: 0.540 Test Loss: 2.784 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.944319486618042
Epoch: 6, Steps: 18 | Train Loss: 0.869 Vali Loss: 2.076 Vali Acc: 0.500 Test Loss: 2.076 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.773249864578247
Epoch: 7, Steps: 18 | Train Loss: 0.891 Vali Loss: 1.943 Vali Acc: 0.430 Test Loss: 1.943 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7237155437469482
Epoch: 8, Steps: 18 | Train Loss: 0.804 Vali Loss: 4.094 Vali Acc: 0.420 Test Loss: 4.094 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2720868587493896
Epoch: 9, Steps: 18 | Train Loss: 1.383 Vali Loss: 3.310 Vali Acc: 0.440 Test Loss: 3.310 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9517467021942139
Epoch: 10, Steps: 18 | Train Loss: 1.150 Vali Loss: 4.901 Vali Acc: 0.430 Test Loss: 4.901 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5792055130004883
Epoch: 11, Steps: 18 | Train Loss: 1.170 Vali Loss: 3.134 Vali Acc: 0.450 Test Loss: 3.134 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9579226
model size : 36.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.947661876678467
Epoch: 1, Steps: 18 | Train Loss: 1.018 Vali Loss: 1.511 Vali Acc: 0.550 Test Loss: 1.511 Test Acc: 0.550
Validation loss decreased (inf --> -0.549985).  Saving model ...
Epoch: 2 cost time: 2.05985689163208
Epoch: 2, Steps: 18 | Train Loss: 1.313 Vali Loss: 1.149 Vali Acc: 0.450 Test Loss: 1.149 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.751798152923584
Epoch: 3, Steps: 18 | Train Loss: 1.150 Vali Loss: 1.628 Vali Acc: 0.500 Test Loss: 1.628 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.737023115158081
Epoch: 4, Steps: 18 | Train Loss: 0.893 Vali Loss: 1.186 Vali Acc: 0.530 Test Loss: 1.186 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9451017379760742
Epoch: 5, Steps: 18 | Train Loss: 1.198 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7585406303405762
Epoch: 6, Steps: 18 | Train Loss: 0.821 Vali Loss: 1.631 Vali Acc: 0.480 Test Loss: 1.631 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3812308311462402
Epoch: 7, Steps: 18 | Train Loss: 1.045 Vali Loss: 1.954 Vali Acc: 0.560 Test Loss: 1.954 Test Acc: 0.560
Validation loss decreased (-0.549985 --> -0.559980).  Saving model ...
Epoch: 8 cost time: 1.9465675354003906
Epoch: 8, Steps: 18 | Train Loss: 1.740 Vali Loss: 2.538 Vali Acc: 0.530 Test Loss: 2.538 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.663926601409912
Epoch: 9, Steps: 18 | Train Loss: 0.975 Vali Loss: 4.149 Vali Acc: 0.480 Test Loss: 4.149 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7001588344573975
Epoch: 10, Steps: 18 | Train Loss: 1.015 Vali Loss: 2.668 Vali Acc: 0.470 Test Loss: 2.668 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8052823543548584
Epoch: 11, Steps: 18 | Train Loss: 1.269 Vali Loss: 5.261 Vali Acc: 0.480 Test Loss: 5.261 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.473459243774414
Epoch: 12, Steps: 18 | Train Loss: 1.051 Vali Loss: 3.083 Vali Acc: 0.430 Test Loss: 3.083 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.581270456314087
Epoch: 13, Steps: 18 | Train Loss: 1.915 Vali Loss: 5.319 Vali Acc: 0.410 Test Loss: 5.319 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.748241662979126
Epoch: 14, Steps: 18 | Train Loss: 1.265 Vali Loss: 4.722 Vali Acc: 0.460 Test Loss: 4.722 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7477996349334717
Epoch: 15, Steps: 18 | Train Loss: 1.614 Vali Loss: 6.931 Vali Acc: 0.510 Test Loss: 6.931 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7685611248016357
Epoch: 16, Steps: 18 | Train Loss: 4.402 Vali Loss: 8.701 Vali Acc: 0.420 Test Loss: 8.701 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5879786014556885
Epoch: 17, Steps: 18 | Train Loss: 1.000 Vali Loss: 6.569 Vali Acc: 0.460 Test Loss: 6.569 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9563348
model size : 36.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6010448932647705
Epoch: 1, Steps: 18 | Train Loss: 1.010 Vali Loss: 1.516 Vali Acc: 0.630 Test Loss: 1.516 Test Acc: 0.630
Validation loss decreased (inf --> -0.629985).  Saving model ...
Epoch: 2 cost time: 1.5296900272369385
Epoch: 2, Steps: 18 | Train Loss: 1.237 Vali Loss: 1.277 Vali Acc: 0.540 Test Loss: 1.277 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6910309791564941
Epoch: 3, Steps: 18 | Train Loss: 1.630 Vali Loss: 1.705 Vali Acc: 0.490 Test Loss: 1.705 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.235792636871338
Epoch: 4, Steps: 18 | Train Loss: 1.752 Vali Loss: 1.383 Vali Acc: 0.470 Test Loss: 1.383 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7737078666687012
Epoch: 5, Steps: 18 | Train Loss: 0.986 Vali Loss: 1.397 Vali Acc: 0.510 Test Loss: 1.397 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5320096015930176
Epoch: 6, Steps: 18 | Train Loss: 1.034 Vali Loss: 1.842 Vali Acc: 0.550 Test Loss: 1.842 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6576354503631592
Epoch: 7, Steps: 18 | Train Loss: 1.008 Vali Loss: 2.992 Vali Acc: 0.460 Test Loss: 2.992 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5764133930206299
Epoch: 8, Steps: 18 | Train Loss: 0.909 Vali Loss: 2.967 Vali Acc: 0.480 Test Loss: 2.967 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6075637340545654
Epoch: 9, Steps: 18 | Train Loss: 2.666 Vali Loss: 5.371 Vali Acc: 0.420 Test Loss: 5.371 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5689599514007568
Epoch: 10, Steps: 18 | Train Loss: 2.926 Vali Loss: 7.746 Vali Acc: 0.410 Test Loss: 7.746 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4991939067840576
Epoch: 11, Steps: 18 | Train Loss: 1.507 Vali Loss: 3.894 Vali Acc: 0.520 Test Loss: 3.894 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 9576138
model size : 36.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.288857936859131
Epoch: 1, Steps: 18 | Train Loss: 1.115 Vali Loss: 1.331 Vali Acc: 0.570 Test Loss: 1.331 Test Acc: 0.570
Validation loss decreased (inf --> -0.569987).  Saving model ...
Epoch: 2 cost time: 1.5511786937713623
Epoch: 2, Steps: 18 | Train Loss: 1.218 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8233871459960938
Epoch: 3, Steps: 18 | Train Loss: 0.884 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8090384006500244
Epoch: 4, Steps: 18 | Train Loss: 0.987 Vali Loss: 1.327 Vali Acc: 0.480 Test Loss: 1.327 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7560904026031494
Epoch: 5, Steps: 18 | Train Loss: 1.068 Vali Loss: 1.571 Vali Acc: 0.540 Test Loss: 1.571 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.666733980178833
Epoch: 6, Steps: 18 | Train Loss: 0.994 Vali Loss: 2.218 Vali Acc: 0.520 Test Loss: 2.218 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1060056686401367
Epoch: 7, Steps: 18 | Train Loss: 0.891 Vali Loss: 2.232 Vali Acc: 0.530 Test Loss: 2.232 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2330880165100098
Epoch: 8, Steps: 18 | Train Loss: 1.206 Vali Loss: 1.725 Vali Acc: 0.500 Test Loss: 1.725 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8948581218719482
Epoch: 9, Steps: 18 | Train Loss: 1.815 Vali Loss: 2.713 Vali Acc: 0.540 Test Loss: 2.713 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9182050228118896
Epoch: 10, Steps: 18 | Train Loss: 0.969 Vali Loss: 3.710 Vali Acc: 0.490 Test Loss: 3.710 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9554424285888672
Epoch: 11, Steps: 18 | Train Loss: 1.880 Vali Loss: 4.240 Vali Acc: 0.490 Test Loss: 4.240 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9553828
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7454981803894043
Epoch: 1, Steps: 18 | Train Loss: 1.116 Vali Loss: 0.977 Vali Acc: 0.520 Test Loss: 0.977 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 2.020108699798584
Epoch: 2, Steps: 18 | Train Loss: 1.642 Vali Loss: 2.173 Vali Acc: 0.460 Test Loss: 2.173 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2800045013427734
Epoch: 3, Steps: 18 | Train Loss: 1.553 Vali Loss: 1.194 Vali Acc: 0.540 Test Loss: 1.194 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539988).  Saving model ...
Epoch: 4 cost time: 2.418987512588501
Epoch: 4, Steps: 18 | Train Loss: 1.264 Vali Loss: 1.869 Vali Acc: 0.490 Test Loss: 1.869 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3119163513183594
Epoch: 5, Steps: 18 | Train Loss: 1.212 Vali Loss: 2.052 Vali Acc: 0.470 Test Loss: 2.052 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0593831539154053
Epoch: 6, Steps: 18 | Train Loss: 0.860 Vali Loss: 1.775 Vali Acc: 0.440 Test Loss: 1.775 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0678250789642334
Epoch: 7, Steps: 18 | Train Loss: 1.061 Vali Loss: 1.492 Vali Acc: 0.500 Test Loss: 1.492 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2615013122558594
Epoch: 8, Steps: 18 | Train Loss: 1.002 Vali Loss: 2.461 Vali Acc: 0.420 Test Loss: 2.461 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8560161590576172
Epoch: 9, Steps: 18 | Train Loss: 0.798 Vali Loss: 2.367 Vali Acc: 0.450 Test Loss: 2.367 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0693678855895996
Epoch: 10, Steps: 18 | Train Loss: 1.159 Vali Loss: 2.211 Vali Acc: 0.540 Test Loss: 2.211 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.256540060043335
Epoch: 11, Steps: 18 | Train Loss: 1.174 Vali Loss: 6.145 Vali Acc: 0.490 Test Loss: 6.145 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0967178344726562
Epoch: 12, Steps: 18 | Train Loss: 1.083 Vali Loss: 5.598 Vali Acc: 0.620 Test Loss: 5.598 Test Acc: 0.620
Validation loss decreased (-0.539988 --> -0.619944).  Saving model ...
Epoch: 13 cost time: 1.9112694263458252
Epoch: 13, Steps: 18 | Train Loss: 2.569 Vali Loss: 4.159 Vali Acc: 0.580 Test Loss: 4.159 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0052754878997803
Epoch: 14, Steps: 18 | Train Loss: 1.015 Vali Loss: 3.309 Vali Acc: 0.480 Test Loss: 3.309 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.355433225631714
Epoch: 15, Steps: 18 | Train Loss: 1.136 Vali Loss: 4.182 Vali Acc: 0.500 Test Loss: 4.182 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0915708541870117
Epoch: 16, Steps: 18 | Train Loss: 1.917 Vali Loss: 5.939 Vali Acc: 0.480 Test Loss: 5.939 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0063748359680176
Epoch: 17, Steps: 18 | Train Loss: 1.193 Vali Loss: 7.224 Vali Acc: 0.570 Test Loss: 7.224 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.891026258468628
Epoch: 18, Steps: 18 | Train Loss: 1.515 Vali Loss: 5.764 Vali Acc: 0.440 Test Loss: 5.764 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0737674236297607
Epoch: 19, Steps: 18 | Train Loss: 2.062 Vali Loss: 10.137 Vali Acc: 0.520 Test Loss: 10.137 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9511370658874512
Epoch: 20, Steps: 18 | Train Loss: 2.779 Vali Loss: 13.870 Vali Acc: 0.580 Test Loss: 13.870 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.793480634689331
Epoch: 21, Steps: 18 | Train Loss: 4.188 Vali Loss: 9.504 Vali Acc: 0.520 Test Loss: 9.504 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7733328342437744
Epoch: 22, Steps: 18 | Train Loss: 0.992 Vali Loss: 9.034 Vali Acc: 0.480 Test Loss: 9.034 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9559418
model size : 36.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.202232122421265
Epoch: 1, Steps: 18 | Train Loss: 1.034 Vali Loss: 0.784 Vali Acc: 0.430 Test Loss: 0.784 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 2.163560628890991
Epoch: 2, Steps: 18 | Train Loss: 1.195 Vali Loss: 0.903 Vali Acc: 0.610 Test Loss: 0.903 Test Acc: 0.610
Validation loss decreased (-0.429992 --> -0.609991).  Saving model ...
Epoch: 3 cost time: 1.9961252212524414
Epoch: 3, Steps: 18 | Train Loss: 1.134 Vali Loss: 1.020 Vali Acc: 0.570 Test Loss: 1.020 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3666234016418457
Epoch: 4, Steps: 18 | Train Loss: 1.118 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.212254524230957
Epoch: 5, Steps: 18 | Train Loss: 0.902 Vali Loss: 1.572 Vali Acc: 0.520 Test Loss: 1.572 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.928208589553833
Epoch: 6, Steps: 18 | Train Loss: 0.904 Vali Loss: 1.629 Vali Acc: 0.510 Test Loss: 1.629 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8960020542144775
Epoch: 7, Steps: 18 | Train Loss: 1.228 Vali Loss: 2.123 Vali Acc: 0.470 Test Loss: 2.123 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.065589427947998
Epoch: 8, Steps: 18 | Train Loss: 0.928 Vali Loss: 3.924 Vali Acc: 0.460 Test Loss: 3.924 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.406277894973755
Epoch: 9, Steps: 18 | Train Loss: 0.819 Vali Loss: 3.272 Vali Acc: 0.520 Test Loss: 3.272 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9069976806640625
Epoch: 10, Steps: 18 | Train Loss: 1.449 Vali Loss: 2.576 Vali Acc: 0.540 Test Loss: 2.576 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.764920949935913
Epoch: 11, Steps: 18 | Train Loss: 1.592 Vali Loss: 4.772 Vali Acc: 0.610 Test Loss: 4.772 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4028141498565674
Epoch: 12, Steps: 18 | Train Loss: 1.255 Vali Loss: 3.480 Vali Acc: 0.510 Test Loss: 3.480 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9547524
model size : 36.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.004026174545288
Epoch: 1, Steps: 18 | Train Loss: 0.878 Vali Loss: 1.132 Vali Acc: 0.570 Test Loss: 1.132 Test Acc: 0.570
Validation loss decreased (inf --> -0.569989).  Saving model ...
Epoch: 2 cost time: 1.4555652141571045
Epoch: 2, Steps: 18 | Train Loss: 1.355 Vali Loss: 1.183 Vali Acc: 0.530 Test Loss: 1.183 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.509272575378418
Epoch: 3, Steps: 18 | Train Loss: 1.349 Vali Loss: 1.210 Vali Acc: 0.510 Test Loss: 1.210 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.855658769607544
Epoch: 4, Steps: 18 | Train Loss: 1.282 Vali Loss: 1.764 Vali Acc: 0.520 Test Loss: 1.764 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6770477294921875
Epoch: 5, Steps: 18 | Train Loss: 1.714 Vali Loss: 2.277 Vali Acc: 0.530 Test Loss: 2.277 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0477030277252197
Epoch: 6, Steps: 18 | Train Loss: 1.363 Vali Loss: 3.413 Vali Acc: 0.480 Test Loss: 3.413 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5985727310180664
Epoch: 7, Steps: 18 | Train Loss: 1.331 Vali Loss: 2.106 Vali Acc: 0.500 Test Loss: 2.106 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6019511222839355
Epoch: 8, Steps: 18 | Train Loss: 1.462 Vali Loss: 4.849 Vali Acc: 0.440 Test Loss: 4.849 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7866535186767578
Epoch: 9, Steps: 18 | Train Loss: 1.106 Vali Loss: 2.844 Vali Acc: 0.490 Test Loss: 2.844 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7481896877288818
Epoch: 10, Steps: 18 | Train Loss: 1.377 Vali Loss: 2.291 Vali Acc: 0.470 Test Loss: 2.291 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5195128917694092
Epoch: 11, Steps: 18 | Train Loss: 0.871 Vali Loss: 6.382 Vali Acc: 0.600 Test Loss: 6.382 Test Acc: 0.600
Validation loss decreased (-0.569989 --> -0.599936).  Saving model ...
Epoch: 12 cost time: 1.565016746520996
Epoch: 12, Steps: 18 | Train Loss: 1.159 Vali Loss: 10.825 Vali Acc: 0.450 Test Loss: 10.825 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7634294033050537
Epoch: 13, Steps: 18 | Train Loss: 2.239 Vali Loss: 4.657 Vali Acc: 0.520 Test Loss: 4.657 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.579390048980713
Epoch: 14, Steps: 18 | Train Loss: 1.095 Vali Loss: 3.654 Vali Acc: 0.520 Test Loss: 3.654 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5958313941955566
Epoch: 15, Steps: 18 | Train Loss: 1.693 Vali Loss: 14.176 Vali Acc: 0.380 Test Loss: 14.176 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0903310775756836
Epoch: 16, Steps: 18 | Train Loss: 3.999 Vali Loss: 7.762 Vali Acc: 0.490 Test Loss: 7.762 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.671691656112671
Epoch: 17, Steps: 18 | Train Loss: 5.119 Vali Loss: 8.100 Vali Acc: 0.520 Test Loss: 8.100 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.538383960723877
Epoch: 18, Steps: 18 | Train Loss: 1.953 Vali Loss: 9.082 Vali Acc: 0.540 Test Loss: 9.082 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8306682109832764
Epoch: 19, Steps: 18 | Train Loss: 1.895 Vali Loss: 7.780 Vali Acc: 0.520 Test Loss: 7.780 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7211756706237793
Epoch: 20, Steps: 18 | Train Loss: 1.453 Vali Loss: 15.683 Vali Acc: 0.470 Test Loss: 15.683 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6394269466400146
Epoch: 21, Steps: 18 | Train Loss: 2.275 Vali Loss: 10.761 Vali Acc: 0.460 Test Loss: 10.761 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9554146
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7323575019836426
Epoch: 1, Steps: 18 | Train Loss: 1.128 Vali Loss: 1.764 Vali Acc: 0.430 Test Loss: 1.764 Test Acc: 0.430
Validation loss decreased (inf --> -0.429982).  Saving model ...
Epoch: 2 cost time: 2.169266939163208
Epoch: 2, Steps: 18 | Train Loss: 1.353 Vali Loss: 1.058 Vali Acc: 0.640 Test Loss: 1.058 Test Acc: 0.640
Validation loss decreased (-0.429982 --> -0.639989).  Saving model ...
Epoch: 3 cost time: 1.8922638893127441
Epoch: 3, Steps: 18 | Train Loss: 1.213 Vali Loss: 2.440 Vali Acc: 0.450 Test Loss: 2.440 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.801103115081787
Epoch: 4, Steps: 18 | Train Loss: 1.554 Vali Loss: 1.584 Vali Acc: 0.480 Test Loss: 1.584 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9350974559783936
Epoch: 5, Steps: 18 | Train Loss: 1.160 Vali Loss: 1.427 Vali Acc: 0.500 Test Loss: 1.427 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1314008235931396
Epoch: 6, Steps: 18 | Train Loss: 1.254 Vali Loss: 2.199 Vali Acc: 0.490 Test Loss: 2.199 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.661789894104004
Epoch: 7, Steps: 18 | Train Loss: 1.359 Vali Loss: 2.879 Vali Acc: 0.450 Test Loss: 2.879 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9618356227874756
Epoch: 8, Steps: 18 | Train Loss: 1.017 Vali Loss: 2.078 Vali Acc: 0.470 Test Loss: 2.078 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8305675983428955
Epoch: 9, Steps: 18 | Train Loss: 1.031 Vali Loss: 2.930 Vali Acc: 0.520 Test Loss: 2.930 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.830052137374878
Epoch: 10, Steps: 18 | Train Loss: 1.848 Vali Loss: 3.733 Vali Acc: 0.480 Test Loss: 3.733 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.630291223526001
Epoch: 11, Steps: 18 | Train Loss: 2.066 Vali Loss: 2.473 Vali Acc: 0.470 Test Loss: 2.473 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6851375102996826
Epoch: 12, Steps: 18 | Train Loss: 1.226 Vali Loss: 3.142 Vali Acc: 0.480 Test Loss: 3.142 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 9573156
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.780895471572876
Epoch: 1, Steps: 18 | Train Loss: 1.392 Vali Loss: 2.507 Vali Acc: 0.450 Test Loss: 2.507 Test Acc: 0.450
Validation loss decreased (inf --> -0.449975).  Saving model ...
Epoch: 2 cost time: 1.8051507472991943
Epoch: 2, Steps: 18 | Train Loss: 1.702 Vali Loss: 2.595 Vali Acc: 0.500 Test Loss: 2.595 Test Acc: 0.500
Validation loss decreased (-0.449975 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 2.0273067951202393
Epoch: 3, Steps: 18 | Train Loss: 1.148 Vali Loss: 1.382 Vali Acc: 0.490 Test Loss: 1.382 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.175645351409912
Epoch: 4, Steps: 18 | Train Loss: 1.232 Vali Loss: 1.246 Vali Acc: 0.490 Test Loss: 1.246 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.021939754486084
Epoch: 5, Steps: 18 | Train Loss: 0.855 Vali Loss: 1.439 Vali Acc: 0.500 Test Loss: 1.439 Test Acc: 0.500
Validation loss decreased (-0.499974 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 2.606383800506592
Epoch: 6, Steps: 18 | Train Loss: 1.166 Vali Loss: 1.565 Vali Acc: 0.470 Test Loss: 1.565 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0504157543182373
Epoch: 7, Steps: 18 | Train Loss: 1.035 Vali Loss: 2.181 Vali Acc: 0.420 Test Loss: 2.181 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7303543090820312
Epoch: 8, Steps: 18 | Train Loss: 0.959 Vali Loss: 2.167 Vali Acc: 0.470 Test Loss: 2.167 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8910999298095703
Epoch: 9, Steps: 18 | Train Loss: 1.023 Vali Loss: 3.404 Vali Acc: 0.460 Test Loss: 3.404 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.839632511138916
Epoch: 10, Steps: 18 | Train Loss: 2.242 Vali Loss: 2.037 Vali Acc: 0.540 Test Loss: 2.037 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539980).  Saving model ...
Epoch: 11 cost time: 1.5420842170715332
Epoch: 11, Steps: 18 | Train Loss: 1.111 Vali Loss: 3.458 Vali Acc: 0.460 Test Loss: 3.458 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7682766914367676
Epoch: 12, Steps: 18 | Train Loss: 1.514 Vali Loss: 5.298 Vali Acc: 0.440 Test Loss: 5.298 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8202695846557617
Epoch: 13, Steps: 18 | Train Loss: 2.030 Vali Loss: 3.658 Vali Acc: 0.450 Test Loss: 3.658 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5405480861663818
Epoch: 14, Steps: 18 | Train Loss: 1.213 Vali Loss: 4.706 Vali Acc: 0.500 Test Loss: 4.706 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6594913005828857
Epoch: 15, Steps: 18 | Train Loss: 0.666 Vali Loss: 5.790 Vali Acc: 0.500 Test Loss: 5.790 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7919511795043945
Epoch: 16, Steps: 18 | Train Loss: 1.727 Vali Loss: 6.354 Vali Acc: 0.440 Test Loss: 6.354 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6582491397857666
Epoch: 17, Steps: 18 | Train Loss: 1.528 Vali Loss: 8.827 Vali Acc: 0.500 Test Loss: 8.827 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.798929214477539
Epoch: 18, Steps: 18 | Train Loss: 1.952 Vali Loss: 10.410 Vali Acc: 0.470 Test Loss: 10.410 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.176849603652954
Epoch: 19, Steps: 18 | Train Loss: 1.172 Vali Loss: 6.182 Vali Acc: 0.520 Test Loss: 6.182 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7828428745269775
Epoch: 20, Steps: 18 | Train Loss: 2.050 Vali Loss: 11.268 Vali Acc: 0.500 Test Loss: 11.268 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9541298
model size : 36.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7629129886627197
Epoch: 1, Steps: 18 | Train Loss: 1.412 Vali Loss: 1.570 Vali Acc: 0.480 Test Loss: 1.570 Test Acc: 0.480
Validation loss decreased (inf --> -0.479984).  Saving model ...
Epoch: 2 cost time: 1.8681974411010742
Epoch: 2, Steps: 18 | Train Loss: 1.173 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
Validation loss decreased (-0.479984 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 2.053333044052124
Epoch: 3, Steps: 18 | Train Loss: 1.012 Vali Loss: 2.745 Vali Acc: 0.490 Test Loss: 2.745 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1288230419158936
Epoch: 4, Steps: 18 | Train Loss: 1.310 Vali Loss: 1.337 Vali Acc: 0.520 Test Loss: 1.337 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8604423999786377
Epoch: 5, Steps: 18 | Train Loss: 1.045 Vali Loss: 2.054 Vali Acc: 0.470 Test Loss: 2.054 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0191144943237305
Epoch: 6, Steps: 18 | Train Loss: 1.915 Vali Loss: 2.524 Vali Acc: 0.470 Test Loss: 2.524 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9351789951324463
Epoch: 7, Steps: 18 | Train Loss: 1.228 Vali Loss: 2.319 Vali Acc: 0.460 Test Loss: 2.319 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9309473037719727
Epoch: 8, Steps: 18 | Train Loss: 1.349 Vali Loss: 2.779 Vali Acc: 0.550 Test Loss: 2.779 Test Acc: 0.550
Validation loss decreased (-0.519989 --> -0.549972).  Saving model ...
Epoch: 9 cost time: 2.332444906234741
Epoch: 9, Steps: 18 | Train Loss: 1.686 Vali Loss: 4.319 Vali Acc: 0.430 Test Loss: 4.319 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0889341831207275
Epoch: 10, Steps: 18 | Train Loss: 1.747 Vali Loss: 5.205 Vali Acc: 0.460 Test Loss: 5.205 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5815746784210205
Epoch: 11, Steps: 18 | Train Loss: 1.354 Vali Loss: 3.892 Vali Acc: 0.450 Test Loss: 3.892 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.338125705718994
Epoch: 12, Steps: 18 | Train Loss: 1.627 Vali Loss: 3.003 Vali Acc: 0.510 Test Loss: 3.003 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9812328815460205
Epoch: 13, Steps: 18 | Train Loss: 0.929 Vali Loss: 3.709 Vali Acc: 0.540 Test Loss: 3.709 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7998454570770264
Epoch: 14, Steps: 18 | Train Loss: 1.894 Vali Loss: 4.822 Vali Acc: 0.570 Test Loss: 4.822 Test Acc: 0.570
Validation loss decreased (-0.549972 --> -0.569952).  Saving model ...
Epoch: 15 cost time: 1.689549446105957
Epoch: 15, Steps: 18 | Train Loss: 1.595 Vali Loss: 7.428 Vali Acc: 0.470 Test Loss: 7.428 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8784103393554688
Epoch: 16, Steps: 18 | Train Loss: 1.966 Vali Loss: 6.246 Vali Acc: 0.520 Test Loss: 6.246 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9955761432647705
Epoch: 17, Steps: 18 | Train Loss: 1.250 Vali Loss: 3.933 Vali Acc: 0.510 Test Loss: 3.933 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8340237140655518
Epoch: 18, Steps: 18 | Train Loss: 1.283 Vali Loss: 10.567 Vali Acc: 0.500 Test Loss: 10.567 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7227144241333008
Epoch: 19, Steps: 18 | Train Loss: 6.236 Vali Loss: 9.331 Vali Acc: 0.460 Test Loss: 9.331 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8980402946472168
Epoch: 20, Steps: 18 | Train Loss: 1.837 Vali Loss: 10.034 Vali Acc: 0.530 Test Loss: 10.034 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4365181922912598
Epoch: 21, Steps: 18 | Train Loss: 1.841 Vali Loss: 13.757 Vali Acc: 0.470 Test Loss: 13.757 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2570152282714844
Epoch: 22, Steps: 18 | Train Loss: 1.139 Vali Loss: 8.883 Vali Acc: 0.500 Test Loss: 8.883 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.80772066116333
Epoch: 23, Steps: 18 | Train Loss: 2.446 Vali Loss: 8.311 Vali Acc: 0.520 Test Loss: 8.311 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3686609268188477
Epoch: 24, Steps: 18 | Train Loss: 2.230 Vali Loss: 11.024 Vali Acc: 0.430 Test Loss: 11.024 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9563828
model size : 36.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.056415319442749
Epoch: 1, Steps: 18 | Train Loss: 0.949 Vali Loss: 1.393 Vali Acc: 0.480 Test Loss: 1.393 Test Acc: 0.480
Validation loss decreased (inf --> -0.479986).  Saving model ...
Epoch: 2 cost time: 1.4747734069824219
Epoch: 2, Steps: 18 | Train Loss: 1.316 Vali Loss: 1.518 Vali Acc: 0.390 Test Loss: 1.518 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4803783893585205
Epoch: 3, Steps: 18 | Train Loss: 1.118 Vali Loss: 2.074 Vali Acc: 0.540 Test Loss: 2.074 Test Acc: 0.540
Validation loss decreased (-0.479986 --> -0.539979).  Saving model ...
Epoch: 4 cost time: 1.7466423511505127
Epoch: 4, Steps: 18 | Train Loss: 1.043 Vali Loss: 2.002 Vali Acc: 0.480 Test Loss: 2.002 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3448073863983154
Epoch: 5, Steps: 18 | Train Loss: 1.104 Vali Loss: 1.453 Vali Acc: 0.520 Test Loss: 1.453 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.451733112335205
Epoch: 6, Steps: 18 | Train Loss: 0.988 Vali Loss: 2.920 Vali Acc: 0.490 Test Loss: 2.920 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.762505054473877
Epoch: 7, Steps: 18 | Train Loss: 1.587 Vali Loss: 1.818 Vali Acc: 0.460 Test Loss: 1.818 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5202445983886719
Epoch: 8, Steps: 18 | Train Loss: 1.295 Vali Loss: 1.621 Vali Acc: 0.530 Test Loss: 1.621 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.831312656402588
Epoch: 9, Steps: 18 | Train Loss: 1.272 Vali Loss: 3.180 Vali Acc: 0.560 Test Loss: 3.180 Test Acc: 0.560
Validation loss decreased (-0.539979 --> -0.559968).  Saving model ...
Epoch: 10 cost time: 1.5731158256530762
Epoch: 10, Steps: 18 | Train Loss: 1.507 Vali Loss: 2.171 Vali Acc: 0.520 Test Loss: 2.171 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6361000537872314
Epoch: 11, Steps: 18 | Train Loss: 1.244 Vali Loss: 1.915 Vali Acc: 0.550 Test Loss: 1.915 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2390289306640625
Epoch: 12, Steps: 18 | Train Loss: 1.317 Vali Loss: 3.808 Vali Acc: 0.520 Test Loss: 3.808 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.844740867614746
Epoch: 13, Steps: 18 | Train Loss: 1.166 Vali Loss: 3.190 Vali Acc: 0.500 Test Loss: 3.190 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7301204204559326
Epoch: 14, Steps: 18 | Train Loss: 1.248 Vali Loss: 6.312 Vali Acc: 0.470 Test Loss: 6.312 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0731308460235596
Epoch: 15, Steps: 18 | Train Loss: 1.735 Vali Loss: 5.851 Vali Acc: 0.470 Test Loss: 5.851 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5888769626617432
Epoch: 16, Steps: 18 | Train Loss: 1.444 Vali Loss: 4.235 Vali Acc: 0.530 Test Loss: 4.235 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9385597705841064
Epoch: 17, Steps: 18 | Train Loss: 1.860 Vali Loss: 5.729 Vali Acc: 0.490 Test Loss: 5.729 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1244139671325684
Epoch: 18, Steps: 18 | Train Loss: 1.177 Vali Loss: 7.183 Vali Acc: 0.510 Test Loss: 7.183 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9440124034881592
Epoch: 19, Steps: 18 | Train Loss: 0.896 Vali Loss: 6.653 Vali Acc: 0.510 Test Loss: 6.653 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9565490
model size : 36.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9687108993530273
Epoch: 1, Steps: 18 | Train Loss: 1.023 Vali Loss: 1.982 Vali Acc: 0.430 Test Loss: 1.982 Test Acc: 0.430
Validation loss decreased (inf --> -0.429980).  Saving model ...
Epoch: 2 cost time: 1.4965872764587402
Epoch: 2, Steps: 18 | Train Loss: 0.985 Vali Loss: 0.935 Vali Acc: 0.540 Test Loss: 0.935 Test Acc: 0.540
Validation loss decreased (-0.429980 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 1.7012012004852295
Epoch: 3, Steps: 18 | Train Loss: 0.969 Vali Loss: 2.467 Vali Acc: 0.590 Test Loss: 2.467 Test Acc: 0.590
Validation loss decreased (-0.539991 --> -0.589975).  Saving model ...
Epoch: 4 cost time: 1.5409536361694336
Epoch: 4, Steps: 18 | Train Loss: 0.906 Vali Loss: 1.640 Vali Acc: 0.460 Test Loss: 1.640 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6223704814910889
Epoch: 5, Steps: 18 | Train Loss: 0.971 Vali Loss: 1.476 Vali Acc: 0.510 Test Loss: 1.476 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5459680557250977
Epoch: 6, Steps: 18 | Train Loss: 1.147 Vali Loss: 1.932 Vali Acc: 0.460 Test Loss: 1.932 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8505098819732666
Epoch: 7, Steps: 18 | Train Loss: 1.127 Vali Loss: 1.801 Vali Acc: 0.510 Test Loss: 1.801 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9443104267120361
Epoch: 8, Steps: 18 | Train Loss: 1.248 Vali Loss: 2.458 Vali Acc: 0.510 Test Loss: 2.458 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.536769151687622
Epoch: 9, Steps: 18 | Train Loss: 1.515 Vali Loss: 4.128 Vali Acc: 0.540 Test Loss: 4.128 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6495001316070557
Epoch: 10, Steps: 18 | Train Loss: 1.547 Vali Loss: 5.267 Vali Acc: 0.480 Test Loss: 5.267 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.765209436416626
Epoch: 11, Steps: 18 | Train Loss: 0.833 Vali Loss: 3.202 Vali Acc: 0.500 Test Loss: 3.202 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.658390998840332
Epoch: 12, Steps: 18 | Train Loss: 1.196 Vali Loss: 2.894 Vali Acc: 0.530 Test Loss: 2.894 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.783466100692749
Epoch: 13, Steps: 18 | Train Loss: 2.600 Vali Loss: 6.009 Vali Acc: 0.520 Test Loss: 6.009 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9555284
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9267995357513428
Epoch: 1, Steps: 18 | Train Loss: 1.157 Vali Loss: 1.858 Vali Acc: 0.610 Test Loss: 1.858 Test Acc: 0.610
Validation loss decreased (inf --> -0.609981).  Saving model ...
Epoch: 2 cost time: 2.1428136825561523
Epoch: 2, Steps: 18 | Train Loss: 1.058 Vali Loss: 1.014 Vali Acc: 0.490 Test Loss: 1.014 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5009288787841797
Epoch: 3, Steps: 18 | Train Loss: 0.845 Vali Loss: 1.275 Vali Acc: 0.530 Test Loss: 1.275 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.597745656967163
Epoch: 4, Steps: 18 | Train Loss: 0.974 Vali Loss: 1.194 Vali Acc: 0.570 Test Loss: 1.194 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6165521144866943
Epoch: 5, Steps: 18 | Train Loss: 1.050 Vali Loss: 2.527 Vali Acc: 0.390 Test Loss: 2.527 Test Acc: 0.390
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7485229969024658
Epoch: 6, Steps: 18 | Train Loss: 1.095 Vali Loss: 2.746 Vali Acc: 0.440 Test Loss: 2.746 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6708495616912842
Epoch: 7, Steps: 18 | Train Loss: 1.119 Vali Loss: 2.227 Vali Acc: 0.440 Test Loss: 2.227 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9831657409667969
Epoch: 8, Steps: 18 | Train Loss: 1.119 Vali Loss: 2.546 Vali Acc: 0.490 Test Loss: 2.546 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.674238920211792
Epoch: 9, Steps: 18 | Train Loss: 1.333 Vali Loss: 3.351 Vali Acc: 0.600 Test Loss: 3.351 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.486764907836914
Epoch: 10, Steps: 18 | Train Loss: 0.848 Vali Loss: 3.085 Vali Acc: 0.520 Test Loss: 3.085 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6138525009155273
Epoch: 11, Steps: 18 | Train Loss: 1.100 Vali Loss: 2.584 Vali Acc: 0.520 Test Loss: 2.584 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9542210
model size : 36.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7560269832611084
Epoch: 1, Steps: 18 | Train Loss: 0.985 Vali Loss: 1.450 Vali Acc: 0.630 Test Loss: 1.450 Test Acc: 0.630
Validation loss decreased (inf --> -0.629986).  Saving model ...
Epoch: 2 cost time: 1.8744735717773438
Epoch: 2, Steps: 18 | Train Loss: 1.305 Vali Loss: 2.265 Vali Acc: 0.570 Test Loss: 2.265 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8636655807495117
Epoch: 3, Steps: 18 | Train Loss: 1.381 Vali Loss: 1.350 Vali Acc: 0.580 Test Loss: 1.350 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8827669620513916
Epoch: 4, Steps: 18 | Train Loss: 1.357 Vali Loss: 1.713 Vali Acc: 0.500 Test Loss: 1.713 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5076048374176025
Epoch: 5, Steps: 18 | Train Loss: 1.180 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6514124870300293
Epoch: 6, Steps: 18 | Train Loss: 1.046 Vali Loss: 1.771 Vali Acc: 0.540 Test Loss: 1.771 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7131526470184326
Epoch: 7, Steps: 18 | Train Loss: 0.990 Vali Loss: 2.205 Vali Acc: 0.480 Test Loss: 2.205 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8234329223632812
Epoch: 8, Steps: 18 | Train Loss: 0.912 Vali Loss: 1.785 Vali Acc: 0.540 Test Loss: 1.785 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6325502395629883
Epoch: 9, Steps: 18 | Train Loss: 1.125 Vali Loss: 3.400 Vali Acc: 0.500 Test Loss: 3.400 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7389376163482666
Epoch: 10, Steps: 18 | Train Loss: 1.492 Vali Loss: 2.448 Vali Acc: 0.480 Test Loss: 2.448 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7974412441253662
Epoch: 11, Steps: 18 | Train Loss: 1.289 Vali Loss: 3.110 Vali Acc: 0.530 Test Loss: 3.110 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 9535268
model size : 36.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5818846225738525
Epoch: 1, Steps: 18 | Train Loss: 1.049 Vali Loss: 2.243 Vali Acc: 0.550 Test Loss: 2.243 Test Acc: 0.550
Validation loss decreased (inf --> -0.549978).  Saving model ...
Epoch: 2 cost time: 2.000932216644287
Epoch: 2, Steps: 18 | Train Loss: 1.272 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8083314895629883
Epoch: 3, Steps: 18 | Train Loss: 1.023 Vali Loss: 0.997 Vali Acc: 0.510 Test Loss: 0.997 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8021111488342285
Epoch: 4, Steps: 18 | Train Loss: 1.138 Vali Loss: 2.297 Vali Acc: 0.520 Test Loss: 2.297 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8333532810211182
Epoch: 5, Steps: 18 | Train Loss: 1.518 Vali Loss: 1.634 Vali Acc: 0.520 Test Loss: 1.634 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8773725032806396
Epoch: 6, Steps: 18 | Train Loss: 1.104 Vali Loss: 2.546 Vali Acc: 0.450 Test Loss: 2.546 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7283265590667725
Epoch: 7, Steps: 18 | Train Loss: 1.365 Vali Loss: 2.936 Vali Acc: 0.570 Test Loss: 2.936 Test Acc: 0.570
Validation loss decreased (-0.549978 --> -0.569971).  Saving model ...
Epoch: 8 cost time: 1.8202204704284668
Epoch: 8, Steps: 18 | Train Loss: 1.377 Vali Loss: 2.815 Vali Acc: 0.620 Test Loss: 2.815 Test Acc: 0.620
Validation loss decreased (-0.569971 --> -0.619972).  Saving model ...
Epoch: 9 cost time: 1.8501417636871338
Epoch: 9, Steps: 18 | Train Loss: 1.260 Vali Loss: 3.034 Vali Acc: 0.450 Test Loss: 3.034 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0720016956329346
Epoch: 10, Steps: 18 | Train Loss: 1.050 Vali Loss: 4.066 Vali Acc: 0.480 Test Loss: 4.066 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5940346717834473
Epoch: 11, Steps: 18 | Train Loss: 1.234 Vali Loss: 2.643 Vali Acc: 0.530 Test Loss: 2.643 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7900099754333496
Epoch: 12, Steps: 18 | Train Loss: 1.412 Vali Loss: 8.517 Vali Acc: 0.470 Test Loss: 8.517 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0473854541778564
Epoch: 13, Steps: 18 | Train Loss: 2.191 Vali Loss: 3.419 Vali Acc: 0.500 Test Loss: 3.419 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8626019954681396
Epoch: 14, Steps: 18 | Train Loss: 0.837 Vali Loss: 3.586 Vali Acc: 0.540 Test Loss: 3.586 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7337894439697266
Epoch: 15, Steps: 18 | Train Loss: 1.185 Vali Loss: 4.270 Vali Acc: 0.580 Test Loss: 4.270 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7704167366027832
Epoch: 16, Steps: 18 | Train Loss: 1.658 Vali Loss: 4.217 Vali Acc: 0.530 Test Loss: 4.217 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7711973190307617
Epoch: 17, Steps: 18 | Train Loss: 1.236 Vali Loss: 3.683 Vali Acc: 0.540 Test Loss: 3.683 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9789323806762695
Epoch: 18, Steps: 18 | Train Loss: 1.774 Vali Loss: 7.261 Vali Acc: 0.550 Test Loss: 7.261 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm256_cs143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9543458
model size : 36.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.25844669342041
Epoch: 1, Steps: 18 | Train Loss: 1.126 Vali Loss: 1.154 Vali Acc: 0.510 Test Loss: 1.154 Test Acc: 0.510
Validation loss decreased (inf --> -0.509988).  Saving model ...
Epoch: 2 cost time: 1.7412612438201904
Epoch: 2, Steps: 18 | Train Loss: 1.076 Vali Loss: 0.860 Vali Acc: 0.530 Test Loss: 0.860 Test Acc: 0.530
Validation loss decreased (-0.509988 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 1.6468396186828613
Epoch: 3, Steps: 18 | Train Loss: 1.436 Vali Loss: 2.501 Vali Acc: 0.520 Test Loss: 2.501 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6967175006866455
Epoch: 4, Steps: 18 | Train Loss: 0.925 Vali Loss: 1.974 Vali Acc: 0.520 Test Loss: 1.974 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.812920331954956
Epoch: 5, Steps: 18 | Train Loss: 1.129 Vali Loss: 2.531 Vali Acc: 0.490 Test Loss: 2.531 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.549513339996338
Epoch: 6, Steps: 18 | Train Loss: 1.545 Vali Loss: 1.859 Vali Acc: 0.530 Test Loss: 1.859 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4388461112976074
Epoch: 7, Steps: 18 | Train Loss: 1.157 Vali Loss: 2.317 Vali Acc: 0.540 Test Loss: 2.317 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539977).  Saving model ...
Epoch: 8 cost time: 1.645594596862793
Epoch: 8, Steps: 18 | Train Loss: 0.974 Vali Loss: 3.395 Vali Acc: 0.500 Test Loss: 3.395 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6609396934509277
Epoch: 9, Steps: 18 | Train Loss: 0.973 Vali Loss: 2.472 Vali Acc: 0.510 Test Loss: 2.472 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6739890575408936
Epoch: 10, Steps: 18 | Train Loss: 0.956 Vali Loss: 2.950 Vali Acc: 0.490 Test Loss: 2.950 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.609379529953003
Epoch: 11, Steps: 18 | Train Loss: 1.011 Vali Loss: 3.962 Vali Acc: 0.460 Test Loss: 3.962 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.625514030456543
Epoch: 12, Steps: 18 | Train Loss: 2.320 Vali Loss: 4.455 Vali Acc: 0.500 Test Loss: 4.455 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9101932048797607
Epoch: 13, Steps: 18 | Train Loss: 1.793 Vali Loss: 3.362 Vali Acc: 0.480 Test Loss: 3.362 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8726251125335693
Epoch: 14, Steps: 18 | Train Loss: 1.235 Vali Loss: 3.305 Vali Acc: 0.540 Test Loss: 3.305 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0093939304351807
Epoch: 15, Steps: 18 | Train Loss: 1.328 Vali Loss: 3.706 Vali Acc: 0.570 Test Loss: 3.706 Test Acc: 0.570
Validation loss decreased (-0.539977 --> -0.569963).  Saving model ...
Epoch: 16 cost time: 1.590648889541626
Epoch: 16, Steps: 18 | Train Loss: 1.540 Vali Loss: 7.632 Vali Acc: 0.430 Test Loss: 7.632 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5990660190582275
Epoch: 17, Steps: 18 | Train Loss: 2.002 Vali Loss: 3.717 Vali Acc: 0.550 Test Loss: 3.717 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8252968788146973
Epoch: 18, Steps: 18 | Train Loss: 1.273 Vali Loss: 4.341 Vali Acc: 0.530 Test Loss: 4.341 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.546126127243042
Epoch: 19, Steps: 18 | Train Loss: 0.957 Vali Loss: 7.748 Vali Acc: 0.540 Test Loss: 7.748 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.544905662536621
Epoch: 20, Steps: 18 | Train Loss: 1.952 Vali Loss: 12.579 Vali Acc: 0.470 Test Loss: 12.579 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5569236278533936
Epoch: 21, Steps: 18 | Train Loss: 2.951 Vali Loss: 6.611 Vali Acc: 0.520 Test Loss: 6.611 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.416701316833496
Epoch: 22, Steps: 18 | Train Loss: 1.061 Vali Loss: 8.386 Vali Acc: 0.470 Test Loss: 8.386 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4879322052001953
Epoch: 23, Steps: 18 | Train Loss: 0.873 Vali Loss: 11.051 Vali Acc: 0.520 Test Loss: 11.051 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8238089084625244
Epoch: 24, Steps: 18 | Train Loss: 1.765 Vali Loss: 15.387 Vali Acc: 0.440 Test Loss: 15.387 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6259634494781494
Epoch: 25, Steps: 18 | Train Loss: 5.469 Vali Loss: 21.879 Vali Acc: 0.420 Test Loss: 21.879 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9544548
model size : 36.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.158997297286987
Epoch: 1, Steps: 18 | Train Loss: 0.853 Vali Loss: 1.265 Vali Acc: 0.580 Test Loss: 1.265 Test Acc: 0.580
Validation loss decreased (inf --> -0.579987).  Saving model ...
Epoch: 2 cost time: 2.287912368774414
Epoch: 2, Steps: 18 | Train Loss: 1.187 Vali Loss: 1.443 Vali Acc: 0.580 Test Loss: 1.443 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6522514820098877
Epoch: 3, Steps: 18 | Train Loss: 1.056 Vali Loss: 3.068 Vali Acc: 0.470 Test Loss: 3.068 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2613468170166016
Epoch: 4, Steps: 18 | Train Loss: 1.266 Vali Loss: 1.762 Vali Acc: 0.580 Test Loss: 1.762 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9819066524505615
Epoch: 5, Steps: 18 | Train Loss: 1.531 Vali Loss: 2.563 Vali Acc: 0.580 Test Loss: 2.563 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8042020797729492
Epoch: 6, Steps: 18 | Train Loss: 1.234 Vali Loss: 2.476 Vali Acc: 0.480 Test Loss: 2.476 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.138425350189209
Epoch: 7, Steps: 18 | Train Loss: 1.035 Vali Loss: 2.961 Vali Acc: 0.560 Test Loss: 2.961 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.66741943359375
Epoch: 8, Steps: 18 | Train Loss: 1.895 Vali Loss: 2.736 Vali Acc: 0.610 Test Loss: 2.736 Test Acc: 0.610
Validation loss decreased (-0.579987 --> -0.609973).  Saving model ...
Epoch: 9 cost time: 1.4990556240081787
Epoch: 9, Steps: 18 | Train Loss: 1.102 Vali Loss: 3.436 Vali Acc: 0.570 Test Loss: 3.436 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5226871967315674
Epoch: 10, Steps: 18 | Train Loss: 1.670 Vali Loss: 3.445 Vali Acc: 0.530 Test Loss: 3.445 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9760916233062744
Epoch: 11, Steps: 18 | Train Loss: 2.460 Vali Loss: 4.598 Vali Acc: 0.520 Test Loss: 4.598 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8690810203552246
Epoch: 12, Steps: 18 | Train Loss: 1.380 Vali Loss: 3.706 Vali Acc: 0.500 Test Loss: 3.706 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6617162227630615
Epoch: 13, Steps: 18 | Train Loss: 1.103 Vali Loss: 3.692 Vali Acc: 0.610 Test Loss: 3.692 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.313805341720581
Epoch: 14, Steps: 18 | Train Loss: 1.395 Vali Loss: 5.374 Vali Acc: 0.450 Test Loss: 5.374 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.130525827407837
Epoch: 15, Steps: 18 | Train Loss: 3.395 Vali Loss: 6.047 Vali Acc: 0.590 Test Loss: 6.047 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9030287265777588
Epoch: 16, Steps: 18 | Train Loss: 2.410 Vali Loss: 11.128 Vali Acc: 0.530 Test Loss: 11.128 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5117838382720947
Epoch: 17, Steps: 18 | Train Loss: 4.682 Vali Loss: 10.556 Vali Acc: 0.540 Test Loss: 10.556 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.019669532775879
Epoch: 18, Steps: 18 | Train Loss: 1.691 Vali Loss: 5.159 Vali Acc: 0.440 Test Loss: 5.159 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9512562
model size : 36.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.487776517868042
Epoch: 1, Steps: 18 | Train Loss: 1.204 Vali Loss: 1.124 Vali Acc: 0.550 Test Loss: 1.124 Test Acc: 0.550
Validation loss decreased (inf --> -0.549989).  Saving model ...
Epoch: 2 cost time: 1.7845771312713623
Epoch: 2, Steps: 18 | Train Loss: 1.495 Vali Loss: 1.792 Vali Acc: 0.510 Test Loss: 1.792 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8453152179718018
Epoch: 3, Steps: 18 | Train Loss: 1.547 Vali Loss: 2.584 Vali Acc: 0.450 Test Loss: 2.584 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8471250534057617
Epoch: 4, Steps: 18 | Train Loss: 1.413 Vali Loss: 2.120 Vali Acc: 0.470 Test Loss: 2.120 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.680579423904419
Epoch: 5, Steps: 18 | Train Loss: 1.132 Vali Loss: 2.048 Vali Acc: 0.470 Test Loss: 2.048 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5742595195770264
Epoch: 6, Steps: 18 | Train Loss: 0.917 Vali Loss: 1.634 Vali Acc: 0.500 Test Loss: 1.634 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6945858001708984
Epoch: 7, Steps: 18 | Train Loss: 1.004 Vali Loss: 1.643 Vali Acc: 0.570 Test Loss: 1.643 Test Acc: 0.570
Validation loss decreased (-0.549989 --> -0.569984).  Saving model ...
Epoch: 8 cost time: 1.787196397781372
Epoch: 8, Steps: 18 | Train Loss: 1.191 Vali Loss: 1.850 Vali Acc: 0.490 Test Loss: 1.850 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8185694217681885
Epoch: 9, Steps: 18 | Train Loss: 1.144 Vali Loss: 3.439 Vali Acc: 0.450 Test Loss: 3.439 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5927727222442627
Epoch: 10, Steps: 18 | Train Loss: 1.296 Vali Loss: 2.697 Vali Acc: 0.480 Test Loss: 2.697 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5515222549438477
Epoch: 11, Steps: 18 | Train Loss: 1.128 Vali Loss: 3.433 Vali Acc: 0.420 Test Loss: 3.433 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8579366207122803
Epoch: 12, Steps: 18 | Train Loss: 1.778 Vali Loss: 3.905 Vali Acc: 0.500 Test Loss: 3.905 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5786468982696533
Epoch: 13, Steps: 18 | Train Loss: 1.184 Vali Loss: 3.123 Vali Acc: 0.470 Test Loss: 3.123 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4461839199066162
Epoch: 14, Steps: 18 | Train Loss: 1.772 Vali Loss: 3.894 Vali Acc: 0.470 Test Loss: 3.894 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9161782264709473
Epoch: 15, Steps: 18 | Train Loss: 1.791 Vali Loss: 4.019 Vali Acc: 0.490 Test Loss: 4.019 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8489766120910645
Epoch: 16, Steps: 18 | Train Loss: 1.544 Vali Loss: 4.348 Vali Acc: 0.490 Test Loss: 4.348 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9287397861480713
Epoch: 17, Steps: 18 | Train Loss: 1.746 Vali Loss: 8.321 Vali Acc: 0.530 Test Loss: 8.321 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9496580
model size : 36.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2954587936401367
Epoch: 1, Steps: 18 | Train Loss: 0.923 Vali Loss: 1.208 Vali Acc: 0.660 Test Loss: 1.208 Test Acc: 0.660
Validation loss decreased (inf --> -0.659988).  Saving model ...
Epoch: 2 cost time: 1.5395615100860596
Epoch: 2, Steps: 18 | Train Loss: 1.164 Vali Loss: 1.511 Vali Acc: 0.430 Test Loss: 1.511 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6715619564056396
Epoch: 3, Steps: 18 | Train Loss: 1.289 Vali Loss: 1.313 Vali Acc: 0.550 Test Loss: 1.313 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.533890962600708
Epoch: 4, Steps: 18 | Train Loss: 1.483 Vali Loss: 1.676 Vali Acc: 0.520 Test Loss: 1.676 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.394923448562622
Epoch: 5, Steps: 18 | Train Loss: 1.326 Vali Loss: 2.184 Vali Acc: 0.460 Test Loss: 2.184 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4855360984802246
Epoch: 6, Steps: 18 | Train Loss: 1.452 Vali Loss: 3.278 Vali Acc: 0.490 Test Loss: 3.278 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5768773555755615
Epoch: 7, Steps: 18 | Train Loss: 1.343 Vali Loss: 3.740 Vali Acc: 0.510 Test Loss: 3.740 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.55702805519104
Epoch: 8, Steps: 18 | Train Loss: 1.562 Vali Loss: 5.190 Vali Acc: 0.450 Test Loss: 5.190 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.835608959197998
Epoch: 9, Steps: 18 | Train Loss: 1.342 Vali Loss: 2.933 Vali Acc: 0.480 Test Loss: 2.933 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5682287216186523
Epoch: 10, Steps: 18 | Train Loss: 1.092 Vali Loss: 2.470 Vali Acc: 0.480 Test Loss: 2.470 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.363407850265503
Epoch: 11, Steps: 18 | Train Loss: 1.148 Vali Loss: 4.132 Vali Acc: 0.480 Test Loss: 4.132 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 9487002
model size : 36.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.821303129196167
Epoch: 1, Steps: 18 | Train Loss: 1.098 Vali Loss: 0.829 Vali Acc: 0.570 Test Loss: 0.829 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 1.745229721069336
Epoch: 2, Steps: 18 | Train Loss: 1.881 Vali Loss: 2.280 Vali Acc: 0.610 Test Loss: 2.280 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609977).  Saving model ...
Epoch: 3 cost time: 1.5261526107788086
Epoch: 3, Steps: 18 | Train Loss: 1.360 Vali Loss: 2.080 Vali Acc: 0.550 Test Loss: 2.080 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5275325775146484
Epoch: 4, Steps: 18 | Train Loss: 1.870 Vali Loss: 2.015 Vali Acc: 0.510 Test Loss: 2.015 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.919497013092041
Epoch: 5, Steps: 18 | Train Loss: 1.193 Vali Loss: 2.562 Vali Acc: 0.450 Test Loss: 2.562 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7137165069580078
Epoch: 6, Steps: 18 | Train Loss: 1.354 Vali Loss: 1.831 Vali Acc: 0.540 Test Loss: 1.831 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6098425388336182
Epoch: 7, Steps: 18 | Train Loss: 1.710 Vali Loss: 2.770 Vali Acc: 0.390 Test Loss: 2.770 Test Acc: 0.390
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6149444580078125
Epoch: 8, Steps: 18 | Train Loss: 1.546 Vali Loss: 3.720 Vali Acc: 0.350 Test Loss: 3.720 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7232108116149902
Epoch: 9, Steps: 18 | Train Loss: 1.508 Vali Loss: 2.188 Vali Acc: 0.540 Test Loss: 2.188 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8249471187591553
Epoch: 10, Steps: 18 | Train Loss: 1.346 Vali Loss: 3.846 Vali Acc: 0.490 Test Loss: 3.846 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6441349983215332
Epoch: 11, Steps: 18 | Train Loss: 0.850 Vali Loss: 2.686 Vali Acc: 0.480 Test Loss: 2.686 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.62498140335083
Epoch: 12, Steps: 18 | Train Loss: 0.966 Vali Loss: 4.506 Vali Acc: 0.420 Test Loss: 4.506 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9480628
model size : 36.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.059394598007202
Epoch: 1, Steps: 18 | Train Loss: 1.509 Vali Loss: 1.648 Vali Acc: 0.630 Test Loss: 1.648 Test Acc: 0.630
Validation loss decreased (inf --> -0.629984).  Saving model ...
Epoch: 2 cost time: 1.4050803184509277
Epoch: 2, Steps: 18 | Train Loss: 1.406 Vali Loss: 1.436 Vali Acc: 0.510 Test Loss: 1.436 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.877652645111084
Epoch: 3, Steps: 18 | Train Loss: 1.630 Vali Loss: 1.727 Vali Acc: 0.600 Test Loss: 1.727 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.676239013671875
Epoch: 4, Steps: 18 | Train Loss: 1.330 Vali Loss: 1.978 Vali Acc: 0.530 Test Loss: 1.978 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9636952877044678
Epoch: 5, Steps: 18 | Train Loss: 2.056 Vali Loss: 1.450 Vali Acc: 0.550 Test Loss: 1.450 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9018614292144775
Epoch: 6, Steps: 18 | Train Loss: 1.408 Vali Loss: 2.887 Vali Acc: 0.540 Test Loss: 2.887 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.852829933166504
Epoch: 7, Steps: 18 | Train Loss: 1.113 Vali Loss: 2.392 Vali Acc: 0.390 Test Loss: 2.392 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.4978318214416504
Epoch: 8, Steps: 18 | Train Loss: 0.947 Vali Loss: 3.464 Vali Acc: 0.490 Test Loss: 3.464 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7157373428344727
Epoch: 9, Steps: 18 | Train Loss: 1.188 Vali Loss: 2.236 Vali Acc: 0.510 Test Loss: 2.236 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2522354125976562
Epoch: 10, Steps: 18 | Train Loss: 0.742 Vali Loss: 1.818 Vali Acc: 0.580 Test Loss: 1.818 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.084359884262085
Epoch: 11, Steps: 18 | Train Loss: 1.256 Vali Loss: 6.702 Vali Acc: 0.500 Test Loss: 6.702 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 9485114
model size : 36.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7431721687316895
Epoch: 1, Steps: 18 | Train Loss: 1.197 Vali Loss: 1.155 Vali Acc: 0.610 Test Loss: 1.155 Test Acc: 0.610
Validation loss decreased (inf --> -0.609988).  Saving model ...
Epoch: 2 cost time: 1.926156759262085
Epoch: 2, Steps: 18 | Train Loss: 1.127 Vali Loss: 1.549 Vali Acc: 0.520 Test Loss: 1.549 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5756490230560303
Epoch: 3, Steps: 18 | Train Loss: 1.623 Vali Loss: 1.420 Vali Acc: 0.510 Test Loss: 1.420 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8007466793060303
Epoch: 4, Steps: 18 | Train Loss: 1.239 Vali Loss: 1.493 Vali Acc: 0.490 Test Loss: 1.493 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9149937629699707
Epoch: 5, Steps: 18 | Train Loss: 1.315 Vali Loss: 1.459 Vali Acc: 0.460 Test Loss: 1.459 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7627229690551758
Epoch: 6, Steps: 18 | Train Loss: 0.959 Vali Loss: 2.065 Vali Acc: 0.560 Test Loss: 2.065 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.044196844100952
Epoch: 7, Steps: 18 | Train Loss: 0.983 Vali Loss: 1.912 Vali Acc: 0.540 Test Loss: 1.912 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6835055351257324
Epoch: 8, Steps: 18 | Train Loss: 0.884 Vali Loss: 4.814 Vali Acc: 0.490 Test Loss: 4.814 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7370238304138184
Epoch: 9, Steps: 18 | Train Loss: 1.490 Vali Loss: 7.120 Vali Acc: 0.390 Test Loss: 7.120 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.115126848220825
Epoch: 10, Steps: 18 | Train Loss: 1.821 Vali Loss: 4.067 Vali Acc: 0.460 Test Loss: 4.067 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.207242488861084
Epoch: 11, Steps: 18 | Train Loss: 1.446 Vali Loss: 2.874 Vali Acc: 0.480 Test Loss: 2.874 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9472692
model size : 36.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3070991039276123
Epoch: 1, Steps: 18 | Train Loss: 1.224 Vali Loss: 1.933 Vali Acc: 0.460 Test Loss: 1.933 Test Acc: 0.460
Validation loss decreased (inf --> -0.459981).  Saving model ...
Epoch: 2 cost time: 1.5227937698364258
Epoch: 2, Steps: 18 | Train Loss: 1.145 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.459981 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.8404362201690674
Epoch: 3, Steps: 18 | Train Loss: 1.378 Vali Loss: 1.225 Vali Acc: 0.460 Test Loss: 1.225 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4468083381652832
Epoch: 4, Steps: 18 | Train Loss: 1.482 Vali Loss: 1.881 Vali Acc: 0.530 Test Loss: 1.881 Test Acc: 0.530
Validation loss decreased (-0.499989 --> -0.529981).  Saving model ...
Epoch: 5 cost time: 1.7361462116241455
Epoch: 5, Steps: 18 | Train Loss: 1.302 Vali Loss: 1.453 Vali Acc: 0.520 Test Loss: 1.453 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7139661312103271
Epoch: 6, Steps: 18 | Train Loss: 0.906 Vali Loss: 2.792 Vali Acc: 0.530 Test Loss: 2.792 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.496459722518921
Epoch: 7, Steps: 18 | Train Loss: 0.949 Vali Loss: 2.498 Vali Acc: 0.490 Test Loss: 2.498 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4469094276428223
Epoch: 8, Steps: 18 | Train Loss: 0.847 Vali Loss: 2.362 Vali Acc: 0.530 Test Loss: 2.362 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7586147785186768
Epoch: 9, Steps: 18 | Train Loss: 1.060 Vali Loss: 2.027 Vali Acc: 0.540 Test Loss: 2.027 Test Acc: 0.540
Validation loss decreased (-0.529981 --> -0.539980).  Saving model ...
Epoch: 10 cost time: 1.6339097023010254
Epoch: 10, Steps: 18 | Train Loss: 1.054 Vali Loss: 3.418 Vali Acc: 0.590 Test Loss: 3.418 Test Acc: 0.590
Validation loss decreased (-0.539980 --> -0.589966).  Saving model ...
Epoch: 11 cost time: 1.3965880870819092
Epoch: 11, Steps: 18 | Train Loss: 1.933 Vali Loss: 4.888 Vali Acc: 0.540 Test Loss: 4.888 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5683507919311523
Epoch: 12, Steps: 18 | Train Loss: 2.132 Vali Loss: 4.710 Vali Acc: 0.560 Test Loss: 4.710 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.583380937576294
Epoch: 13, Steps: 18 | Train Loss: 1.710 Vali Loss: 4.331 Vali Acc: 0.470 Test Loss: 4.331 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8485221862792969
Epoch: 14, Steps: 18 | Train Loss: 1.320 Vali Loss: 4.693 Vali Acc: 0.470 Test Loss: 4.693 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5058186054229736
Epoch: 15, Steps: 18 | Train Loss: 1.234 Vali Loss: 8.007 Vali Acc: 0.460 Test Loss: 8.007 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6501457691192627
Epoch: 16, Steps: 18 | Train Loss: 1.673 Vali Loss: 3.331 Vali Acc: 0.530 Test Loss: 3.331 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6864607334136963
Epoch: 17, Steps: 18 | Train Loss: 1.773 Vali Loss: 9.030 Vali Acc: 0.460 Test Loss: 9.030 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5474202632904053
Epoch: 18, Steps: 18 | Train Loss: 1.308 Vali Loss: 6.447 Vali Acc: 0.530 Test Loss: 6.447 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9378933906555176
Epoch: 19, Steps: 18 | Train Loss: 1.004 Vali Loss: 6.061 Vali Acc: 0.550 Test Loss: 6.061 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4255962371826172
Epoch: 20, Steps: 18 | Train Loss: 1.360 Vali Loss: 6.033 Vali Acc: 0.520 Test Loss: 6.033 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9488106
model size : 36.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.2847445011138916
Epoch: 1, Steps: 18 | Train Loss: 1.221 Vali Loss: 0.863 Vali Acc: 0.580 Test Loss: 0.863 Test Acc: 0.580
Validation loss decreased (inf --> -0.579991).  Saving model ...
Epoch: 2 cost time: 1.6724512577056885
Epoch: 2, Steps: 18 | Train Loss: 1.829 Vali Loss: 1.201 Vali Acc: 0.490 Test Loss: 1.201 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.416527271270752
Epoch: 3, Steps: 18 | Train Loss: 1.367 Vali Loss: 0.930 Vali Acc: 0.520 Test Loss: 0.930 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6104614734649658
Epoch: 4, Steps: 18 | Train Loss: 0.943 Vali Loss: 1.246 Vali Acc: 0.430 Test Loss: 1.246 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3888280391693115
Epoch: 5, Steps: 18 | Train Loss: 1.005 Vali Loss: 3.077 Vali Acc: 0.480 Test Loss: 3.077 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7087953090667725
Epoch: 6, Steps: 18 | Train Loss: 0.945 Vali Loss: 2.828 Vali Acc: 0.530 Test Loss: 2.828 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8999598026275635
Epoch: 7, Steps: 18 | Train Loss: 0.972 Vali Loss: 3.092 Vali Acc: 0.500 Test Loss: 3.092 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.481644868850708
Epoch: 8, Steps: 18 | Train Loss: 1.547 Vali Loss: 5.154 Vali Acc: 0.420 Test Loss: 5.154 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7434890270233154
Epoch: 9, Steps: 18 | Train Loss: 1.624 Vali Loss: 3.628 Vali Acc: 0.440 Test Loss: 3.628 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8097431659698486
Epoch: 10, Steps: 18 | Train Loss: 1.432 Vali Loss: 3.371 Vali Acc: 0.500 Test Loss: 3.371 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7573730945587158
Epoch: 11, Steps: 18 | Train Loss: 2.534 Vali Loss: 3.339 Vali Acc: 0.430 Test Loss: 3.339 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9467972
model size : 36.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6531760692596436
Epoch: 1, Steps: 18 | Train Loss: 1.071 Vali Loss: 1.120 Vali Acc: 0.490 Test Loss: 1.120 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 1.8454997539520264
Epoch: 2, Steps: 18 | Train Loss: 1.053 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
Validation loss decreased (-0.489989 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.4868242740631104
Epoch: 3, Steps: 18 | Train Loss: 1.108 Vali Loss: 1.014 Vali Acc: 0.540 Test Loss: 1.014 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539990).  Saving model ...
Epoch: 4 cost time: 1.5231668949127197
Epoch: 4, Steps: 18 | Train Loss: 1.445 Vali Loss: 1.989 Vali Acc: 0.500 Test Loss: 1.989 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.635739803314209
Epoch: 5, Steps: 18 | Train Loss: 1.226 Vali Loss: 3.989 Vali Acc: 0.510 Test Loss: 3.989 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7783482074737549
Epoch: 6, Steps: 18 | Train Loss: 1.077 Vali Loss: 2.320 Vali Acc: 0.470 Test Loss: 2.320 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5573418140411377
Epoch: 7, Steps: 18 | Train Loss: 1.522 Vali Loss: 2.475 Vali Acc: 0.580 Test Loss: 2.475 Test Acc: 0.580
Validation loss decreased (-0.539990 --> -0.579975).  Saving model ...
Epoch: 8 cost time: 1.48712158203125
Epoch: 8, Steps: 18 | Train Loss: 1.349 Vali Loss: 2.752 Vali Acc: 0.510 Test Loss: 2.752 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6155352592468262
Epoch: 9, Steps: 18 | Train Loss: 0.788 Vali Loss: 1.984 Vali Acc: 0.460 Test Loss: 1.984 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.648845911026001
Epoch: 10, Steps: 18 | Train Loss: 1.141 Vali Loss: 1.879 Vali Acc: 0.500 Test Loss: 1.879 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.691133975982666
Epoch: 11, Steps: 18 | Train Loss: 0.858 Vali Loss: 2.387 Vali Acc: 0.540 Test Loss: 2.387 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.635270118713379
Epoch: 12, Steps: 18 | Train Loss: 1.289 Vali Loss: 2.348 Vali Acc: 0.530 Test Loss: 2.348 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6379449367523193
Epoch: 13, Steps: 18 | Train Loss: 1.051 Vali Loss: 3.584 Vali Acc: 0.500 Test Loss: 3.584 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5176570415496826
Epoch: 14, Steps: 18 | Train Loss: 1.116 Vali Loss: 4.711 Vali Acc: 0.450 Test Loss: 4.711 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.840399980545044
Epoch: 15, Steps: 18 | Train Loss: 1.735 Vali Loss: 3.275 Vali Acc: 0.510 Test Loss: 3.275 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.907724380493164
Epoch: 16, Steps: 18 | Train Loss: 1.135 Vali Loss: 4.257 Vali Acc: 0.540 Test Loss: 4.257 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.63376784324646
Epoch: 17, Steps: 18 | Train Loss: 1.162 Vali Loss: 5.042 Vali Acc: 0.510 Test Loss: 5.042 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9475290
model size : 36.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.720473527908325
Epoch: 1, Steps: 18 | Train Loss: 1.022 Vali Loss: 0.971 Vali Acc: 0.410 Test Loss: 0.971 Test Acc: 0.410
Validation loss decreased (inf --> -0.409990).  Saving model ...
Epoch: 2 cost time: 2.135411262512207
Epoch: 2, Steps: 18 | Train Loss: 1.119 Vali Loss: 1.136 Vali Acc: 0.520 Test Loss: 1.136 Test Acc: 0.520
Validation loss decreased (-0.409990 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 1.6729145050048828
Epoch: 3, Steps: 18 | Train Loss: 1.598 Vali Loss: 1.601 Vali Acc: 0.590 Test Loss: 1.601 Test Acc: 0.590
Validation loss decreased (-0.519989 --> -0.589984).  Saving model ...
Epoch: 4 cost time: 2.1593103408813477
Epoch: 4, Steps: 18 | Train Loss: 1.210 Vali Loss: 2.016 Vali Acc: 0.490 Test Loss: 2.016 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5333261489868164
Epoch: 5, Steps: 18 | Train Loss: 1.286 Vali Loss: 2.329 Vali Acc: 0.480 Test Loss: 2.329 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0362367630004883
Epoch: 6, Steps: 18 | Train Loss: 1.326 Vali Loss: 1.711 Vali Acc: 0.520 Test Loss: 1.711 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7059803009033203
Epoch: 7, Steps: 18 | Train Loss: 1.045 Vali Loss: 3.055 Vali Acc: 0.420 Test Loss: 3.055 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9990956783294678
Epoch: 8, Steps: 18 | Train Loss: 1.866 Vali Loss: 3.500 Vali Acc: 0.440 Test Loss: 3.500 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1575675010681152
Epoch: 9, Steps: 18 | Train Loss: 1.601 Vali Loss: 2.846 Vali Acc: 0.460 Test Loss: 2.846 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1577200889587402
Epoch: 10, Steps: 18 | Train Loss: 1.054 Vali Loss: 3.097 Vali Acc: 0.400 Test Loss: 3.097 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.787252426147461
Epoch: 11, Steps: 18 | Train Loss: 0.969 Vali Loss: 3.513 Vali Acc: 0.510 Test Loss: 3.513 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9934625625610352
Epoch: 12, Steps: 18 | Train Loss: 1.832 Vali Loss: 3.443 Vali Acc: 0.560 Test Loss: 3.443 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9617671966552734
Epoch: 13, Steps: 18 | Train Loss: 2.598 Vali Loss: 8.526 Vali Acc: 0.530 Test Loss: 8.526 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9464868
model size : 36.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8292322158813477
Epoch: 1, Steps: 18 | Train Loss: 1.043 Vali Loss: 1.223 Vali Acc: 0.660 Test Loss: 1.223 Test Acc: 0.660
Validation loss decreased (inf --> -0.659988).  Saving model ...
Epoch: 2 cost time: 1.7764689922332764
Epoch: 2, Steps: 18 | Train Loss: 1.691 Vali Loss: 1.400 Vali Acc: 0.540 Test Loss: 1.400 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0527846813201904
Epoch: 3, Steps: 18 | Train Loss: 1.087 Vali Loss: 1.871 Vali Acc: 0.440 Test Loss: 1.871 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.655900239944458
Epoch: 4, Steps: 18 | Train Loss: 1.422 Vali Loss: 2.683 Vali Acc: 0.470 Test Loss: 2.683 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9884426593780518
Epoch: 5, Steps: 18 | Train Loss: 1.249 Vali Loss: 2.661 Vali Acc: 0.570 Test Loss: 2.661 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0634605884552
Epoch: 6, Steps: 18 | Train Loss: 1.518 Vali Loss: 2.003 Vali Acc: 0.520 Test Loss: 2.003 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7388191223144531
Epoch: 7, Steps: 18 | Train Loss: 0.998 Vali Loss: 2.073 Vali Acc: 0.510 Test Loss: 2.073 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5468528270721436
Epoch: 8, Steps: 18 | Train Loss: 1.098 Vali Loss: 2.035 Vali Acc: 0.550 Test Loss: 2.035 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8508572578430176
Epoch: 9, Steps: 18 | Train Loss: 1.277 Vali Loss: 2.411 Vali Acc: 0.500 Test Loss: 2.411 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0158329010009766
Epoch: 10, Steps: 18 | Train Loss: 1.353 Vali Loss: 3.154 Vali Acc: 0.560 Test Loss: 3.154 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9887728691101074
Epoch: 11, Steps: 18 | Train Loss: 1.598 Vali Loss: 5.501 Vali Acc: 0.460 Test Loss: 5.501 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 9472706
model size : 36.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.941030740737915
Epoch: 1, Steps: 18 | Train Loss: 1.679 Vali Loss: 1.044 Vali Acc: 0.550 Test Loss: 1.044 Test Acc: 0.550
Validation loss decreased (inf --> -0.549990).  Saving model ...
Epoch: 2 cost time: 1.78879714012146
Epoch: 2, Steps: 18 | Train Loss: 1.122 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 1.9613134860992432
Epoch: 3, Steps: 18 | Train Loss: 0.999 Vali Loss: 1.090 Vali Acc: 0.530 Test Loss: 1.090 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.54071044921875
Epoch: 4, Steps: 18 | Train Loss: 1.132 Vali Loss: 2.010 Vali Acc: 0.440 Test Loss: 2.010 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5853602886199951
Epoch: 5, Steps: 18 | Train Loss: 1.096 Vali Loss: 1.677 Vali Acc: 0.550 Test Loss: 1.677 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.462095022201538
Epoch: 6, Steps: 18 | Train Loss: 1.341 Vali Loss: 2.277 Vali Acc: 0.430 Test Loss: 2.277 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6737580299377441
Epoch: 7, Steps: 18 | Train Loss: 0.942 Vali Loss: 1.815 Vali Acc: 0.490 Test Loss: 1.815 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.489952802658081
Epoch: 8, Steps: 18 | Train Loss: 1.176 Vali Loss: 1.941 Vali Acc: 0.540 Test Loss: 1.941 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5848746299743652
Epoch: 9, Steps: 18 | Train Loss: 0.992 Vali Loss: 2.607 Vali Acc: 0.450 Test Loss: 2.607 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6798477172851562
Epoch: 10, Steps: 18 | Train Loss: 1.441 Vali Loss: 4.489 Vali Acc: 0.450 Test Loss: 4.489 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9659159183502197
Epoch: 11, Steps: 18 | Train Loss: 1.388 Vali Loss: 3.561 Vali Acc: 0.450 Test Loss: 3.561 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.988191843032837
Epoch: 12, Steps: 18 | Train Loss: 1.701 Vali Loss: 4.004 Vali Acc: 0.570 Test Loss: 4.004 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569960).  Saving model ...
Epoch: 13 cost time: 1.597914457321167
Epoch: 13, Steps: 18 | Train Loss: 1.680 Vali Loss: 3.294 Vali Acc: 0.490 Test Loss: 3.294 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7157747745513916
Epoch: 14, Steps: 18 | Train Loss: 1.623 Vali Loss: 4.107 Vali Acc: 0.470 Test Loss: 4.107 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6596457958221436
Epoch: 15, Steps: 18 | Train Loss: 2.670 Vali Loss: 10.779 Vali Acc: 0.580 Test Loss: 10.779 Test Acc: 0.580
Validation loss decreased (-0.569960 --> -0.579892).  Saving model ...
Epoch: 16 cost time: 1.8717539310455322
Epoch: 16, Steps: 18 | Train Loss: 3.045 Vali Loss: 11.075 Vali Acc: 0.570 Test Loss: 11.075 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6282949447631836
Epoch: 17, Steps: 18 | Train Loss: 3.122 Vali Loss: 6.985 Vali Acc: 0.490 Test Loss: 6.985 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.390129566192627
Epoch: 18, Steps: 18 | Train Loss: 1.995 Vali Loss: 6.297 Vali Acc: 0.530 Test Loss: 6.297 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6147396564483643
Epoch: 19, Steps: 18 | Train Loss: 2.322 Vali Loss: 7.239 Vali Acc: 0.530 Test Loss: 7.239 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4487578868865967
Epoch: 20, Steps: 18 | Train Loss: 2.225 Vali Loss: 12.122 Vali Acc: 0.470 Test Loss: 12.122 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9686858654022217
Epoch: 21, Steps: 18 | Train Loss: 1.642 Vali Loss: 8.186 Vali Acc: 0.440 Test Loss: 8.186 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5692262649536133
Epoch: 22, Steps: 18 | Train Loss: 1.922 Vali Loss: 9.997 Vali Acc: 0.450 Test Loss: 9.997 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8028340339660645
Epoch: 23, Steps: 18 | Train Loss: 1.815 Vali Loss: 8.370 Vali Acc: 0.500 Test Loss: 8.370 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.507524013519287
Epoch: 24, Steps: 18 | Train Loss: 2.719 Vali Loss: 8.309 Vali Acc: 0.470 Test Loss: 8.309 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7026135921478271
Epoch: 25, Steps: 18 | Train Loss: 2.752 Vali Loss: 10.632 Vali Acc: 0.440 Test Loss: 10.632 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9492740
model size : 36.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.024951457977295
Epoch: 1, Steps: 18 | Train Loss: 1.075 Vali Loss: 1.619 Vali Acc: 0.520 Test Loss: 1.619 Test Acc: 0.520
Validation loss decreased (inf --> -0.519984).  Saving model ...
Epoch: 2 cost time: 1.6216747760772705
Epoch: 2, Steps: 18 | Train Loss: 1.134 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
Validation loss decreased (-0.519984 --> -0.519988).  Saving model ...
Epoch: 3 cost time: 1.6587257385253906
Epoch: 3, Steps: 18 | Train Loss: 1.109 Vali Loss: 1.541 Vali Acc: 0.430 Test Loss: 1.541 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6580567359924316
Epoch: 4, Steps: 18 | Train Loss: 0.951 Vali Loss: 2.053 Vali Acc: 0.540 Test Loss: 2.053 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539979).  Saving model ...
Epoch: 5 cost time: 1.686084270477295
Epoch: 5, Steps: 18 | Train Loss: 1.195 Vali Loss: 2.285 Vali Acc: 0.430 Test Loss: 2.285 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.750913381576538
Epoch: 6, Steps: 18 | Train Loss: 1.146 Vali Loss: 2.431 Vali Acc: 0.560 Test Loss: 2.431 Test Acc: 0.560
Validation loss decreased (-0.539979 --> -0.559976).  Saving model ...
Epoch: 7 cost time: 1.6439845561981201
Epoch: 7, Steps: 18 | Train Loss: 0.764 Vali Loss: 2.095 Vali Acc: 0.470 Test Loss: 2.095 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7616751194000244
Epoch: 8, Steps: 18 | Train Loss: 0.860 Vali Loss: 2.942 Vali Acc: 0.460 Test Loss: 2.942 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4795405864715576
Epoch: 9, Steps: 18 | Train Loss: 1.496 Vali Loss: 3.819 Vali Acc: 0.530 Test Loss: 3.819 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5415570735931396
Epoch: 10, Steps: 18 | Train Loss: 1.772 Vali Loss: 4.550 Vali Acc: 0.480 Test Loss: 4.550 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5091500282287598
Epoch: 11, Steps: 18 | Train Loss: 0.918 Vali Loss: 3.249 Vali Acc: 0.490 Test Loss: 3.249 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9448089599609375
Epoch: 12, Steps: 18 | Train Loss: 1.258 Vali Loss: 3.111 Vali Acc: 0.530 Test Loss: 3.111 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.607642650604248
Epoch: 13, Steps: 18 | Train Loss: 0.857 Vali Loss: 3.263 Vali Acc: 0.520 Test Loss: 3.263 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.364743709564209
Epoch: 14, Steps: 18 | Train Loss: 1.722 Vali Loss: 4.644 Vali Acc: 0.590 Test Loss: 4.644 Test Acc: 0.590
Validation loss decreased (-0.559976 --> -0.589954).  Saving model ...
Epoch: 15 cost time: 1.4451327323913574
Epoch: 15, Steps: 18 | Train Loss: 2.214 Vali Loss: 5.807 Vali Acc: 0.560 Test Loss: 5.807 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6887540817260742
Epoch: 16, Steps: 18 | Train Loss: 1.231 Vali Loss: 5.850 Vali Acc: 0.510 Test Loss: 5.850 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8652169704437256
Epoch: 17, Steps: 18 | Train Loss: 0.888 Vali Loss: 5.241 Vali Acc: 0.570 Test Loss: 5.241 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5555267333984375
Epoch: 18, Steps: 18 | Train Loss: 1.073 Vali Loss: 5.138 Vali Acc: 0.520 Test Loss: 5.138 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.590409278869629
Epoch: 19, Steps: 18 | Train Loss: 1.410 Vali Loss: 7.897 Vali Acc: 0.520 Test Loss: 7.897 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.857637882232666
Epoch: 20, Steps: 18 | Train Loss: 1.733 Vali Loss: 14.086 Vali Acc: 0.510 Test Loss: 14.086 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6192548274993896
Epoch: 21, Steps: 18 | Train Loss: 1.454 Vali Loss: 6.512 Vali Acc: 0.550 Test Loss: 6.512 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7845163345336914
Epoch: 22, Steps: 18 | Train Loss: 1.714 Vali Loss: 10.440 Vali Acc: 0.550 Test Loss: 10.440 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7153925895690918
Epoch: 23, Steps: 18 | Train Loss: 1.138 Vali Loss: 15.272 Vali Acc: 0.440 Test Loss: 15.272 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7516462802886963
Epoch: 24, Steps: 18 | Train Loss: 1.468 Vali Loss: 11.178 Vali Acc: 0.440 Test Loss: 11.178 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9461842
model size : 36.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0813231468200684
Epoch: 1, Steps: 18 | Train Loss: 1.181 Vali Loss: 1.128 Vali Acc: 0.540 Test Loss: 1.128 Test Acc: 0.540
Validation loss decreased (inf --> -0.539989).  Saving model ...
Epoch: 2 cost time: 1.5473172664642334
Epoch: 2, Steps: 18 | Train Loss: 1.370 Vali Loss: 1.919 Vali Acc: 0.460 Test Loss: 1.919 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6473770141601562
Epoch: 3, Steps: 18 | Train Loss: 1.530 Vali Loss: 2.410 Vali Acc: 0.490 Test Loss: 2.410 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6897177696228027
Epoch: 4, Steps: 18 | Train Loss: 1.112 Vali Loss: 2.442 Vali Acc: 0.540 Test Loss: 2.442 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6252100467681885
Epoch: 5, Steps: 18 | Train Loss: 1.578 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4684867858886719
Epoch: 6, Steps: 18 | Train Loss: 1.319 Vali Loss: 1.581 Vali Acc: 0.520 Test Loss: 1.581 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5186679363250732
Epoch: 7, Steps: 18 | Train Loss: 1.367 Vali Loss: 3.819 Vali Acc: 0.480 Test Loss: 3.819 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7577970027923584
Epoch: 8, Steps: 18 | Train Loss: 1.990 Vali Loss: 4.362 Vali Acc: 0.570 Test Loss: 4.362 Test Acc: 0.570
Validation loss decreased (-0.539989 --> -0.569956).  Saving model ...
Epoch: 9 cost time: 1.5621514320373535
Epoch: 9, Steps: 18 | Train Loss: 1.289 Vali Loss: 2.363 Vali Acc: 0.520 Test Loss: 2.363 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.516205072402954
Epoch: 10, Steps: 18 | Train Loss: 1.747 Vali Loss: 4.188 Vali Acc: 0.430 Test Loss: 4.188 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7173149585723877
Epoch: 11, Steps: 18 | Train Loss: 1.347 Vali Loss: 3.258 Vali Acc: 0.480 Test Loss: 3.258 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3918647766113281
Epoch: 12, Steps: 18 | Train Loss: 1.086 Vali Loss: 4.031 Vali Acc: 0.530 Test Loss: 4.031 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7830214500427246
Epoch: 13, Steps: 18 | Train Loss: 2.507 Vali Loss: 6.313 Vali Acc: 0.470 Test Loss: 6.313 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6287400722503662
Epoch: 14, Steps: 18 | Train Loss: 0.964 Vali Loss: 11.114 Vali Acc: 0.500 Test Loss: 11.114 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6933355331420898
Epoch: 15, Steps: 18 | Train Loss: 1.780 Vali Loss: 4.326 Vali Acc: 0.560 Test Loss: 4.326 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4175846576690674
Epoch: 16, Steps: 18 | Train Loss: 2.579 Vali Loss: 7.545 Vali Acc: 0.580 Test Loss: 7.545 Test Acc: 0.580
Validation loss decreased (-0.569956 --> -0.579925).  Saving model ...
Epoch: 17 cost time: 1.7465968132019043
Epoch: 17, Steps: 18 | Train Loss: 3.667 Vali Loss: 5.371 Vali Acc: 0.580 Test Loss: 5.371 Test Acc: 0.580
Validation loss decreased (-0.579925 --> -0.579946).  Saving model ...
Epoch: 18 cost time: 1.6302504539489746
Epoch: 18, Steps: 18 | Train Loss: 1.788 Vali Loss: 7.829 Vali Acc: 0.530 Test Loss: 7.829 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7248351573944092
Epoch: 19, Steps: 18 | Train Loss: 3.640 Vali Loss: 14.521 Vali Acc: 0.390 Test Loss: 14.521 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4407646656036377
Epoch: 20, Steps: 18 | Train Loss: 2.719 Vali Loss: 14.169 Vali Acc: 0.480 Test Loss: 14.169 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6179404258728027
Epoch: 21, Steps: 18 | Train Loss: 1.908 Vali Loss: 10.779 Vali Acc: 0.480 Test Loss: 10.779 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6065287590026855
Epoch: 22, Steps: 18 | Train Loss: 1.309 Vali Loss: 8.726 Vali Acc: 0.540 Test Loss: 8.726 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7426807880401611
Epoch: 23, Steps: 18 | Train Loss: 1.913 Vali Loss: 11.511 Vali Acc: 0.500 Test Loss: 11.511 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.593177318572998
Epoch: 24, Steps: 18 | Train Loss: 2.201 Vali Loss: 8.663 Vali Acc: 0.600 Test Loss: 8.663 Test Acc: 0.600
Validation loss decreased (-0.579946 --> -0.599913).  Saving model ...
Epoch: 25 cost time: 1.5321619510650635
Epoch: 25, Steps: 18 | Train Loss: 2.718 Vali Loss: 8.031 Vali Acc: 0.550 Test Loss: 8.031 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5533931255340576
Epoch: 26, Steps: 18 | Train Loss: 2.459 Vali Loss: 13.740 Vali Acc: 0.460 Test Loss: 13.740 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.528008222579956
Epoch: 27, Steps: 18 | Train Loss: 7.405 Vali Loss: 10.850 Vali Acc: 0.490 Test Loss: 10.850 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.549769639968872
Epoch: 28, Steps: 18 | Train Loss: 3.812 Vali Loss: 16.751 Vali Acc: 0.530 Test Loss: 16.751 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6098730564117432
Epoch: 29, Steps: 18 | Train Loss: 1.634 Vali Loss: 14.760 Vali Acc: 0.530 Test Loss: 14.760 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3121442794799805
Epoch: 30, Steps: 18 | Train Loss: 0.714 Vali Loss: 13.078 Vali Acc: 0.520 Test Loss: 13.078 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7999961376190186
Epoch: 31, Steps: 18 | Train Loss: 3.100 Vali Loss: 16.360 Vali Acc: 0.470 Test Loss: 16.360 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.720015525817871
Epoch: 32, Steps: 18 | Train Loss: 1.241 Vali Loss: 18.369 Vali Acc: 0.530 Test Loss: 18.369 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.632338523864746
Epoch: 33, Steps: 18 | Train Loss: 1.173 Vali Loss: 29.230 Vali Acc: 0.510 Test Loss: 29.230 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6197738647460938
Epoch: 34, Steps: 18 | Train Loss: 4.330 Vali Loss: 23.205 Vali Acc: 0.490 Test Loss: 23.205 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9485140
model size : 36.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9755759239196777
Epoch: 1, Steps: 18 | Train Loss: 1.024 Vali Loss: 1.312 Vali Acc: 0.570 Test Loss: 1.312 Test Acc: 0.570
Validation loss decreased (inf --> -0.569987).  Saving model ...
Epoch: 2 cost time: 1.7130403518676758
Epoch: 2, Steps: 18 | Train Loss: 1.168 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0435664653778076
Epoch: 3, Steps: 18 | Train Loss: 1.186 Vali Loss: 1.290 Vali Acc: 0.460 Test Loss: 1.290 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8146185874938965
Epoch: 4, Steps: 18 | Train Loss: 1.330 Vali Loss: 1.646 Vali Acc: 0.570 Test Loss: 1.646 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.740227222442627
Epoch: 5, Steps: 18 | Train Loss: 0.963 Vali Loss: 2.622 Vali Acc: 0.450 Test Loss: 2.622 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8166382312774658
Epoch: 6, Steps: 18 | Train Loss: 1.753 Vali Loss: 5.644 Vali Acc: 0.480 Test Loss: 5.644 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6077523231506348
Epoch: 7, Steps: 18 | Train Loss: 1.887 Vali Loss: 3.236 Vali Acc: 0.480 Test Loss: 3.236 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6194262504577637
Epoch: 8, Steps: 18 | Train Loss: 1.554 Vali Loss: 2.651 Vali Acc: 0.510 Test Loss: 2.651 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7256860733032227
Epoch: 9, Steps: 18 | Train Loss: 1.228 Vali Loss: 2.241 Vali Acc: 0.490 Test Loss: 2.241 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0605971813201904
Epoch: 10, Steps: 18 | Train Loss: 1.118 Vali Loss: 2.771 Vali Acc: 0.510 Test Loss: 2.771 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8479797840118408
Epoch: 11, Steps: 18 | Train Loss: 1.089 Vali Loss: 3.484 Vali Acc: 0.490 Test Loss: 3.484 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9487506
model size : 36.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.752089023590088
Epoch: 1, Steps: 18 | Train Loss: 0.899 Vali Loss: 0.820 Vali Acc: 0.470 Test Loss: 0.820 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.7071418762207031
Epoch: 2, Steps: 18 | Train Loss: 1.374 Vali Loss: 1.932 Vali Acc: 0.590 Test Loss: 1.932 Test Acc: 0.590
Validation loss decreased (-0.469992 --> -0.589981).  Saving model ...
Epoch: 3 cost time: 1.6819875240325928
Epoch: 3, Steps: 18 | Train Loss: 1.485 Vali Loss: 1.564 Vali Acc: 0.460 Test Loss: 1.564 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.048103094100952
Epoch: 4, Steps: 18 | Train Loss: 1.244 Vali Loss: 1.901 Vali Acc: 0.540 Test Loss: 1.901 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.019073009490967
Epoch: 5, Steps: 18 | Train Loss: 1.140 Vali Loss: 1.458 Vali Acc: 0.490 Test Loss: 1.458 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.002676486968994
Epoch: 6, Steps: 18 | Train Loss: 0.776 Vali Loss: 1.224 Vali Acc: 0.530 Test Loss: 1.224 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.895265817642212
Epoch: 7, Steps: 18 | Train Loss: 0.962 Vali Loss: 4.175 Vali Acc: 0.450 Test Loss: 4.175 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8945801258087158
Epoch: 8, Steps: 18 | Train Loss: 1.096 Vali Loss: 2.581 Vali Acc: 0.520 Test Loss: 2.581 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0401833057403564
Epoch: 9, Steps: 18 | Train Loss: 0.902 Vali Loss: 5.380 Vali Acc: 0.450 Test Loss: 5.380 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3314602375030518
Epoch: 10, Steps: 18 | Train Loss: 1.766 Vali Loss: 2.946 Vali Acc: 0.540 Test Loss: 2.946 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7771618366241455
Epoch: 11, Steps: 18 | Train Loss: 1.522 Vali Loss: 4.898 Vali Acc: 0.470 Test Loss: 4.898 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9023191928863525
Epoch: 12, Steps: 18 | Train Loss: 1.067 Vali Loss: 4.020 Vali Acc: 0.520 Test Loss: 4.020 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9477940
model size : 36.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.987466812133789
Epoch: 1, Steps: 18 | Train Loss: 0.952 Vali Loss: 1.188 Vali Acc: 0.610 Test Loss: 1.188 Test Acc: 0.610
Validation loss decreased (inf --> -0.609988).  Saving model ...
Epoch: 2 cost time: 1.9519703388214111
Epoch: 2, Steps: 18 | Train Loss: 1.322 Vali Loss: 1.009 Vali Acc: 0.440 Test Loss: 1.009 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.818021535873413
Epoch: 3, Steps: 18 | Train Loss: 1.396 Vali Loss: 2.348 Vali Acc: 0.450 Test Loss: 2.348 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.068206787109375
Epoch: 4, Steps: 18 | Train Loss: 1.509 Vali Loss: 1.157 Vali Acc: 0.590 Test Loss: 1.157 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0843164920806885
Epoch: 5, Steps: 18 | Train Loss: 1.575 Vali Loss: 1.925 Vali Acc: 0.470 Test Loss: 1.925 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6435675621032715
Epoch: 6, Steps: 18 | Train Loss: 1.508 Vali Loss: 3.338 Vali Acc: 0.450 Test Loss: 3.338 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6628694534301758
Epoch: 7, Steps: 18 | Train Loss: 0.818 Vali Loss: 2.100 Vali Acc: 0.520 Test Loss: 2.100 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5966699123382568
Epoch: 8, Steps: 18 | Train Loss: 1.416 Vali Loss: 6.302 Vali Acc: 0.610 Test Loss: 6.302 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.938589096069336
Epoch: 9, Steps: 18 | Train Loss: 2.282 Vali Loss: 3.360 Vali Acc: 0.450 Test Loss: 3.360 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7270004749298096
Epoch: 10, Steps: 18 | Train Loss: 1.292 Vali Loss: 2.823 Vali Acc: 0.480 Test Loss: 2.823 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9397571086883545
Epoch: 11, Steps: 18 | Train Loss: 0.950 Vali Loss: 4.116 Vali Acc: 0.490 Test Loss: 4.116 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9465442
model size : 36.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.082801580429077
Epoch: 1, Steps: 18 | Train Loss: 0.979 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.037828207015991
Epoch: 2, Steps: 18 | Train Loss: 1.165 Vali Loss: 1.227 Vali Acc: 0.450 Test Loss: 1.227 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8983490467071533
Epoch: 3, Steps: 18 | Train Loss: 1.041 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8443481922149658
Epoch: 4, Steps: 18 | Train Loss: 1.336 Vali Loss: 1.691 Vali Acc: 0.580 Test Loss: 1.691 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579983).  Saving model ...
Epoch: 5 cost time: 1.9958813190460205
Epoch: 5, Steps: 18 | Train Loss: 1.470 Vali Loss: 3.908 Vali Acc: 0.460 Test Loss: 3.908 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5083599090576172
Epoch: 6, Steps: 18 | Train Loss: 2.108 Vali Loss: 2.249 Vali Acc: 0.460 Test Loss: 2.249 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7759790420532227
Epoch: 7, Steps: 18 | Train Loss: 1.406 Vali Loss: 3.334 Vali Acc: 0.440 Test Loss: 3.334 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9772202968597412
Epoch: 8, Steps: 18 | Train Loss: 1.319 Vali Loss: 2.014 Vali Acc: 0.520 Test Loss: 2.014 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.770021915435791
Epoch: 9, Steps: 18 | Train Loss: 1.413 Vali Loss: 2.884 Vali Acc: 0.520 Test Loss: 2.884 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8458964824676514
Epoch: 10, Steps: 18 | Train Loss: 2.102 Vali Loss: 2.593 Vali Acc: 0.470 Test Loss: 2.593 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8846540451049805
Epoch: 11, Steps: 18 | Train Loss: 1.729 Vali Loss: 3.349 Vali Acc: 0.540 Test Loss: 3.349 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0118212699890137
Epoch: 12, Steps: 18 | Train Loss: 1.705 Vali Loss: 2.765 Vali Acc: 0.480 Test Loss: 2.765 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7425875663757324
Epoch: 13, Steps: 18 | Train Loss: 2.170 Vali Loss: 4.189 Vali Acc: 0.530 Test Loss: 4.189 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6962358951568604
Epoch: 14, Steps: 18 | Train Loss: 3.902 Vali Loss: 15.502 Vali Acc: 0.490 Test Loss: 15.502 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9459012
model size : 36.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4522366523742676
Epoch: 1, Steps: 18 | Train Loss: 1.093 Vali Loss: 1.066 Vali Acc: 0.530 Test Loss: 1.066 Test Acc: 0.530
Validation loss decreased (inf --> -0.529989).  Saving model ...
Epoch: 2 cost time: 1.7651398181915283
Epoch: 2, Steps: 18 | Train Loss: 1.127 Vali Loss: 1.294 Vali Acc: 0.600 Test Loss: 1.294 Test Acc: 0.600
Validation loss decreased (-0.529989 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 1.5572004318237305
Epoch: 3, Steps: 18 | Train Loss: 1.115 Vali Loss: 1.101 Vali Acc: 0.490 Test Loss: 1.101 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8268635272979736
Epoch: 4, Steps: 18 | Train Loss: 1.277 Vali Loss: 1.213 Vali Acc: 0.600 Test Loss: 1.213 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.9939320087432861
Epoch: 5, Steps: 18 | Train Loss: 0.951 Vali Loss: 2.043 Vali Acc: 0.490 Test Loss: 2.043 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8989219665527344
Epoch: 6, Steps: 18 | Train Loss: 1.394 Vali Loss: 1.696 Vali Acc: 0.580 Test Loss: 1.696 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.970562219619751
Epoch: 7, Steps: 18 | Train Loss: 1.305 Vali Loss: 1.773 Vali Acc: 0.480 Test Loss: 1.773 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8274836540222168
Epoch: 8, Steps: 18 | Train Loss: 1.305 Vali Loss: 1.917 Vali Acc: 0.500 Test Loss: 1.917 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.758819818496704
Epoch: 9, Steps: 18 | Train Loss: 1.197 Vali Loss: 3.523 Vali Acc: 0.510 Test Loss: 3.523 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8714990615844727
Epoch: 10, Steps: 18 | Train Loss: 1.041 Vali Loss: 2.608 Vali Acc: 0.490 Test Loss: 2.608 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9237451553344727
Epoch: 11, Steps: 18 | Train Loss: 0.993 Vali Loss: 3.339 Vali Acc: 0.480 Test Loss: 3.339 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5714054107666016
Epoch: 12, Steps: 18 | Train Loss: 2.951 Vali Loss: 4.048 Vali Acc: 0.500 Test Loss: 4.048 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7395427227020264
Epoch: 13, Steps: 18 | Train Loss: 2.569 Vali Loss: 8.247 Vali Acc: 0.430 Test Loss: 8.247 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8737432956695557
Epoch: 14, Steps: 18 | Train Loss: 1.440 Vali Loss: 3.826 Vali Acc: 0.520 Test Loss: 3.826 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm128_cs143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9467650
model size : 36.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7503786087036133
Epoch: 1, Steps: 18 | Train Loss: 1.021 Vali Loss: 0.919 Vali Acc: 0.480 Test Loss: 0.919 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 1.9707434177398682
Epoch: 2, Steps: 18 | Train Loss: 1.144 Vali Loss: 1.084 Vali Acc: 0.590 Test Loss: 1.084 Test Acc: 0.590
Validation loss decreased (-0.479991 --> -0.589989).  Saving model ...
Epoch: 3 cost time: 2.1780574321746826
Epoch: 3, Steps: 18 | Train Loss: 1.186 Vali Loss: 1.302 Vali Acc: 0.510 Test Loss: 1.302 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6970186233520508
Epoch: 4, Steps: 18 | Train Loss: 1.363 Vali Loss: 2.744 Vali Acc: 0.500 Test Loss: 2.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.737863302230835
Epoch: 5, Steps: 18 | Train Loss: 1.274 Vali Loss: 1.691 Vali Acc: 0.530 Test Loss: 1.691 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3131775856018066
Epoch: 6, Steps: 18 | Train Loss: 1.087 Vali Loss: 1.205 Vali Acc: 0.570 Test Loss: 1.205 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8848135471343994
Epoch: 7, Steps: 18 | Train Loss: 1.947 Vali Loss: 2.511 Vali Acc: 0.530 Test Loss: 2.511 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.727571725845337
Epoch: 8, Steps: 18 | Train Loss: 1.134 Vali Loss: 2.570 Vali Acc: 0.520 Test Loss: 2.570 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7752141952514648
Epoch: 9, Steps: 18 | Train Loss: 1.005 Vali Loss: 3.433 Vali Acc: 0.640 Test Loss: 3.433 Test Acc: 0.640
Validation loss decreased (-0.589989 --> -0.639966).  Saving model ...
Epoch: 10 cost time: 1.7563042640686035
Epoch: 10, Steps: 18 | Train Loss: 2.088 Vali Loss: 8.771 Vali Acc: 0.450 Test Loss: 8.771 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.901425838470459
Epoch: 11, Steps: 18 | Train Loss: 1.432 Vali Loss: 5.403 Vali Acc: 0.530 Test Loss: 5.403 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7872436046600342
Epoch: 12, Steps: 18 | Train Loss: 1.715 Vali Loss: 8.284 Vali Acc: 0.510 Test Loss: 8.284 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7136204242706299
Epoch: 13, Steps: 18 | Train Loss: 2.509 Vali Loss: 4.406 Vali Acc: 0.530 Test Loss: 4.406 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.234154224395752
Epoch: 14, Steps: 18 | Train Loss: 1.722 Vali Loss: 4.675 Vali Acc: 0.480 Test Loss: 4.675 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9911153316497803
Epoch: 15, Steps: 18 | Train Loss: 1.220 Vali Loss: 3.941 Vali Acc: 0.570 Test Loss: 3.941 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6975610256195068
Epoch: 16, Steps: 18 | Train Loss: 3.473 Vali Loss: 11.578 Vali Acc: 0.460 Test Loss: 11.578 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8246572017669678
Epoch: 17, Steps: 18 | Train Loss: 2.229 Vali Loss: 7.538 Vali Acc: 0.460 Test Loss: 7.538 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.134129285812378
Epoch: 18, Steps: 18 | Train Loss: 1.505 Vali Loss: 9.942 Vali Acc: 0.410 Test Loss: 9.942 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9528412818908691
Epoch: 19, Steps: 18 | Train Loss: 2.079 Vali Loss: 9.505 Vali Acc: 0.500 Test Loss: 9.505 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 9467828
model size : 36.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.117871999740601
Epoch: 1, Steps: 18 | Train Loss: 0.974 Vali Loss: 0.830 Vali Acc: 0.540 Test Loss: 0.830 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 1.6765656471252441
Epoch: 2, Steps: 18 | Train Loss: 1.309 Vali Loss: 1.943 Vali Acc: 0.500 Test Loss: 1.943 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5226283073425293
Epoch: 3, Steps: 18 | Train Loss: 1.574 Vali Loss: 1.273 Vali Acc: 0.470 Test Loss: 1.273 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5901060104370117
Epoch: 4, Steps: 18 | Train Loss: 1.556 Vali Loss: 1.600 Vali Acc: 0.550 Test Loss: 1.600 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 1.8336777687072754
Epoch: 5, Steps: 18 | Train Loss: 1.865 Vali Loss: 3.741 Vali Acc: 0.480 Test Loss: 3.741 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7603483200073242
Epoch: 6, Steps: 18 | Train Loss: 1.974 Vali Loss: 3.727 Vali Acc: 0.520 Test Loss: 3.727 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6642553806304932
Epoch: 7, Steps: 18 | Train Loss: 2.446 Vali Loss: 3.224 Vali Acc: 0.510 Test Loss: 3.224 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4944005012512207
Epoch: 8, Steps: 18 | Train Loss: 1.586 Vali Loss: 2.339 Vali Acc: 0.550 Test Loss: 2.339 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.580216884613037
Epoch: 9, Steps: 18 | Train Loss: 1.549 Vali Loss: 2.644 Vali Acc: 0.450 Test Loss: 2.644 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.527350902557373
Epoch: 10, Steps: 18 | Train Loss: 1.628 Vali Loss: 2.379 Vali Acc: 0.480 Test Loss: 2.379 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.692028522491455
Epoch: 11, Steps: 18 | Train Loss: 1.563 Vali Loss: 5.474 Vali Acc: 0.410 Test Loss: 5.474 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5636675357818604
Epoch: 12, Steps: 18 | Train Loss: 2.387 Vali Loss: 3.945 Vali Acc: 0.510 Test Loss: 3.945 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.572087049484253
Epoch: 13, Steps: 18 | Train Loss: 2.088 Vali Loss: 2.926 Vali Acc: 0.500 Test Loss: 2.926 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7357256412506104
Epoch: 14, Steps: 18 | Train Loss: 1.481 Vali Loss: 3.699 Vali Acc: 0.550 Test Loss: 3.699 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 9451842
model size : 36.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6590707302093506
Epoch: 1, Steps: 18 | Train Loss: 0.837 Vali Loss: 1.538 Vali Acc: 0.460 Test Loss: 1.538 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 1.752455711364746
Epoch: 2, Steps: 18 | Train Loss: 1.379 Vali Loss: 1.533 Vali Acc: 0.570 Test Loss: 1.533 Test Acc: 0.570
Validation loss decreased (-0.459985 --> -0.569985).  Saving model ...
Epoch: 3 cost time: 1.6737515926361084
Epoch: 3, Steps: 18 | Train Loss: 2.202 Vali Loss: 1.627 Vali Acc: 0.500 Test Loss: 1.627 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.956270694732666
Epoch: 4, Steps: 18 | Train Loss: 1.380 Vali Loss: 3.045 Vali Acc: 0.440 Test Loss: 3.045 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6308424472808838
Epoch: 5, Steps: 18 | Train Loss: 1.155 Vali Loss: 2.016 Vali Acc: 0.450 Test Loss: 2.016 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.625871181488037
Epoch: 6, Steps: 18 | Train Loss: 0.860 Vali Loss: 3.942 Vali Acc: 0.470 Test Loss: 3.942 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4966659545898438
Epoch: 7, Steps: 18 | Train Loss: 1.246 Vali Loss: 3.542 Vali Acc: 0.480 Test Loss: 3.542 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.660797119140625
Epoch: 8, Steps: 18 | Train Loss: 1.444 Vali Loss: 1.594 Vali Acc: 0.490 Test Loss: 1.594 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6469526290893555
Epoch: 9, Steps: 18 | Train Loss: 1.775 Vali Loss: 6.571 Vali Acc: 0.470 Test Loss: 6.571 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.613283634185791
Epoch: 10, Steps: 18 | Train Loss: 1.802 Vali Loss: 3.216 Vali Acc: 0.480 Test Loss: 3.216 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5728833675384521
Epoch: 11, Steps: 18 | Train Loss: 1.350 Vali Loss: 3.614 Vali Acc: 0.540 Test Loss: 3.614 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5515830516815186
Epoch: 12, Steps: 18 | Train Loss: 2.528 Vali Loss: 3.991 Vali Acc: 0.530 Test Loss: 3.991 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9443860
model size : 36.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.41426420211792
Epoch: 1, Steps: 18 | Train Loss: 0.837 Vali Loss: 1.166 Vali Acc: 0.540 Test Loss: 1.166 Test Acc: 0.540
Validation loss decreased (inf --> -0.539988).  Saving model ...
Epoch: 2 cost time: 1.6276209354400635
Epoch: 2, Steps: 18 | Train Loss: 1.036 Vali Loss: 1.173 Vali Acc: 0.580 Test Loss: 1.173 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 3 cost time: 1.5844957828521729
Epoch: 3, Steps: 18 | Train Loss: 1.299 Vali Loss: 1.207 Vali Acc: 0.470 Test Loss: 1.207 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3453619480133057
Epoch: 4, Steps: 18 | Train Loss: 1.292 Vali Loss: 3.214 Vali Acc: 0.510 Test Loss: 3.214 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6875922679901123
Epoch: 5, Steps: 18 | Train Loss: 1.579 Vali Loss: 1.667 Vali Acc: 0.540 Test Loss: 1.667 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.676335096359253
Epoch: 6, Steps: 18 | Train Loss: 1.709 Vali Loss: 4.247 Vali Acc: 0.470 Test Loss: 4.247 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.555677890777588
Epoch: 7, Steps: 18 | Train Loss: 1.255 Vali Loss: 2.643 Vali Acc: 0.540 Test Loss: 2.643 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4812588691711426
Epoch: 8, Steps: 18 | Train Loss: 1.198 Vali Loss: 1.523 Vali Acc: 0.550 Test Loss: 1.523 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5735077857971191
Epoch: 9, Steps: 18 | Train Loss: 0.768 Vali Loss: 3.994 Vali Acc: 0.500 Test Loss: 3.994 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5282845497131348
Epoch: 10, Steps: 18 | Train Loss: 1.529 Vali Loss: 1.791 Vali Acc: 0.500 Test Loss: 1.791 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8591358661651611
Epoch: 11, Steps: 18 | Train Loss: 1.157 Vali Loss: 1.965 Vali Acc: 0.550 Test Loss: 1.965 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.417206048965454
Epoch: 12, Steps: 18 | Train Loss: 0.873 Vali Loss: 2.519 Vali Acc: 0.540 Test Loss: 2.519 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9439082
model size : 36.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9581727981567383
Epoch: 1, Steps: 18 | Train Loss: 0.986 Vali Loss: 1.460 Vali Acc: 0.440 Test Loss: 1.460 Test Acc: 0.440
Validation loss decreased (inf --> -0.439985).  Saving model ...
Epoch: 2 cost time: 1.274827241897583
Epoch: 2, Steps: 18 | Train Loss: 1.522 Vali Loss: 1.307 Vali Acc: 0.550 Test Loss: 1.307 Test Acc: 0.550
Validation loss decreased (-0.439985 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 1.6174535751342773
Epoch: 3, Steps: 18 | Train Loss: 1.276 Vali Loss: 2.559 Vali Acc: 0.480 Test Loss: 2.559 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2607073783874512
Epoch: 4, Steps: 18 | Train Loss: 1.113 Vali Loss: 2.652 Vali Acc: 0.530 Test Loss: 2.652 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4481539726257324
Epoch: 5, Steps: 18 | Train Loss: 1.146 Vali Loss: 1.751 Vali Acc: 0.480 Test Loss: 1.751 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.654714822769165
Epoch: 6, Steps: 18 | Train Loss: 1.489 Vali Loss: 4.128 Vali Acc: 0.460 Test Loss: 4.128 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4086503982543945
Epoch: 7, Steps: 18 | Train Loss: 1.471 Vali Loss: 1.776 Vali Acc: 0.530 Test Loss: 1.776 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.485755205154419
Epoch: 8, Steps: 18 | Train Loss: 1.254 Vali Loss: 6.966 Vali Acc: 0.500 Test Loss: 6.966 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.509892225265503
Epoch: 9, Steps: 18 | Train Loss: 1.906 Vali Loss: 2.634 Vali Acc: 0.490 Test Loss: 2.634 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.358593463897705
Epoch: 10, Steps: 18 | Train Loss: 1.363 Vali Loss: 7.274 Vali Acc: 0.590 Test Loss: 7.274 Test Acc: 0.590
Validation loss decreased (-0.549987 --> -0.589927).  Saving model ...
Epoch: 11 cost time: 1.5929453372955322
Epoch: 11, Steps: 18 | Train Loss: 3.366 Vali Loss: 2.497 Vali Acc: 0.540 Test Loss: 2.497 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.590712547302246
Epoch: 12, Steps: 18 | Train Loss: 1.057 Vali Loss: 4.688 Vali Acc: 0.540 Test Loss: 4.688 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4741153717041016
Epoch: 13, Steps: 18 | Train Loss: 2.991 Vali Loss: 6.288 Vali Acc: 0.480 Test Loss: 6.288 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.53995943069458
Epoch: 14, Steps: 18 | Train Loss: 1.942 Vali Loss: 3.854 Vali Acc: 0.560 Test Loss: 3.854 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8104517459869385
Epoch: 15, Steps: 18 | Train Loss: 1.599 Vali Loss: 5.291 Vali Acc: 0.550 Test Loss: 5.291 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.486398458480835
Epoch: 16, Steps: 18 | Train Loss: 1.445 Vali Loss: 7.004 Vali Acc: 0.520 Test Loss: 7.004 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5651166439056396
Epoch: 17, Steps: 18 | Train Loss: 1.282 Vali Loss: 5.830 Vali Acc: 0.450 Test Loss: 5.830 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2883851528167725
Epoch: 18, Steps: 18 | Train Loss: 1.457 Vali Loss: 6.972 Vali Acc: 0.490 Test Loss: 6.972 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6610047817230225
Epoch: 19, Steps: 18 | Train Loss: 1.798 Vali Loss: 5.364 Vali Acc: 0.550 Test Loss: 5.364 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5527303218841553
Epoch: 20, Steps: 18 | Train Loss: 1.572 Vali Loss: 10.543 Vali Acc: 0.590 Test Loss: 10.543 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9435908
model size : 36.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4402663707733154
Epoch: 1, Steps: 18 | Train Loss: 1.047 Vali Loss: 0.882 Vali Acc: 0.530 Test Loss: 0.882 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 1.365471601486206
Epoch: 2, Steps: 18 | Train Loss: 1.330 Vali Loss: 2.048 Vali Acc: 0.490 Test Loss: 2.048 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5447592735290527
Epoch: 3, Steps: 18 | Train Loss: 1.291 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5865440368652344
Epoch: 4, Steps: 18 | Train Loss: 0.936 Vali Loss: 1.471 Vali Acc: 0.490 Test Loss: 1.471 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3948800563812256
Epoch: 5, Steps: 18 | Train Loss: 0.817 Vali Loss: 2.772 Vali Acc: 0.400 Test Loss: 2.772 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.674842119216919
Epoch: 6, Steps: 18 | Train Loss: 1.651 Vali Loss: 1.979 Vali Acc: 0.480 Test Loss: 1.979 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5959179401397705
Epoch: 7, Steps: 18 | Train Loss: 1.143 Vali Loss: 2.149 Vali Acc: 0.560 Test Loss: 2.149 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559979).  Saving model ...
Epoch: 8 cost time: 1.4571278095245361
Epoch: 8, Steps: 18 | Train Loss: 1.182 Vali Loss: 2.476 Vali Acc: 0.470 Test Loss: 2.476 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4098396301269531
Epoch: 9, Steps: 18 | Train Loss: 1.473 Vali Loss: 2.216 Vali Acc: 0.500 Test Loss: 2.216 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6490063667297363
Epoch: 10, Steps: 18 | Train Loss: 0.882 Vali Loss: 3.126 Vali Acc: 0.560 Test Loss: 3.126 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6727862358093262
Epoch: 11, Steps: 18 | Train Loss: 1.579 Vali Loss: 2.955 Vali Acc: 0.530 Test Loss: 2.955 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5520825386047363
Epoch: 12, Steps: 18 | Train Loss: 1.428 Vali Loss: 2.647 Vali Acc: 0.550 Test Loss: 2.647 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.661849021911621
Epoch: 13, Steps: 18 | Train Loss: 0.908 Vali Loss: 4.276 Vali Acc: 0.530 Test Loss: 4.276 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5441944599151611
Epoch: 14, Steps: 18 | Train Loss: 1.374 Vali Loss: 7.405 Vali Acc: 0.520 Test Loss: 7.405 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3750863075256348
Epoch: 15, Steps: 18 | Train Loss: 1.608 Vali Loss: 3.939 Vali Acc: 0.570 Test Loss: 3.939 Test Acc: 0.570
Validation loss decreased (-0.559979 --> -0.569961).  Saving model ...
Epoch: 16 cost time: 1.4981207847595215
Epoch: 16, Steps: 18 | Train Loss: 2.459 Vali Loss: 5.085 Vali Acc: 0.560 Test Loss: 5.085 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6577858924865723
Epoch: 17, Steps: 18 | Train Loss: 1.755 Vali Loss: 4.896 Vali Acc: 0.500 Test Loss: 4.896 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3344659805297852
Epoch: 18, Steps: 18 | Train Loss: 1.117 Vali Loss: 10.700 Vali Acc: 0.440 Test Loss: 10.700 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4124884605407715
Epoch: 19, Steps: 18 | Train Loss: 1.534 Vali Loss: 10.645 Vali Acc: 0.430 Test Loss: 10.645 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4170122146606445
Epoch: 20, Steps: 18 | Train Loss: 5.025 Vali Loss: 14.010 Vali Acc: 0.360 Test Loss: 14.010 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6051552295684814
Epoch: 21, Steps: 18 | Train Loss: 2.108 Vali Loss: 9.661 Vali Acc: 0.470 Test Loss: 9.661 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.451371431350708
Epoch: 22, Steps: 18 | Train Loss: 1.317 Vali Loss: 6.250 Vali Acc: 0.540 Test Loss: 6.250 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4843485355377197
Epoch: 23, Steps: 18 | Train Loss: 1.783 Vali Loss: 8.145 Vali Acc: 0.530 Test Loss: 8.145 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3689751625061035
Epoch: 24, Steps: 18 | Train Loss: 1.981 Vali Loss: 8.979 Vali Acc: 0.570 Test Loss: 8.979 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5593299865722656
Epoch: 25, Steps: 18 | Train Loss: 2.193 Vali Loss: 7.482 Vali Acc: 0.520 Test Loss: 7.482 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9442666
model size : 36.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7032012939453125
Epoch: 1, Steps: 18 | Train Loss: 1.084 Vali Loss: 1.644 Vali Acc: 0.450 Test Loss: 1.644 Test Acc: 0.450
Validation loss decreased (inf --> -0.449984).  Saving model ...
Epoch: 2 cost time: 1.6552724838256836
Epoch: 2, Steps: 18 | Train Loss: 1.392 Vali Loss: 1.502 Vali Acc: 0.570 Test Loss: 1.502 Test Acc: 0.570
Validation loss decreased (-0.449984 --> -0.569985).  Saving model ...
Epoch: 3 cost time: 1.540696620941162
Epoch: 3, Steps: 18 | Train Loss: 1.595 Vali Loss: 2.876 Vali Acc: 0.530 Test Loss: 2.876 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.617854118347168
Epoch: 4, Steps: 18 | Train Loss: 1.927 Vali Loss: 2.430 Vali Acc: 0.510 Test Loss: 2.430 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.406808614730835
Epoch: 5, Steps: 18 | Train Loss: 1.535 Vali Loss: 1.607 Vali Acc: 0.540 Test Loss: 1.607 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4153354167938232
Epoch: 6, Steps: 18 | Train Loss: 1.415 Vali Loss: 2.491 Vali Acc: 0.500 Test Loss: 2.491 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6133005619049072
Epoch: 7, Steps: 18 | Train Loss: 0.960 Vali Loss: 1.959 Vali Acc: 0.420 Test Loss: 1.959 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7449941635131836
Epoch: 8, Steps: 18 | Train Loss: 1.164 Vali Loss: 1.758 Vali Acc: 0.520 Test Loss: 1.758 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3480138778686523
Epoch: 9, Steps: 18 | Train Loss: 1.604 Vali Loss: 6.592 Vali Acc: 0.490 Test Loss: 6.592 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.211881399154663
Epoch: 10, Steps: 18 | Train Loss: 2.569 Vali Loss: 3.947 Vali Acc: 0.560 Test Loss: 3.947 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5453588962554932
Epoch: 11, Steps: 18 | Train Loss: 3.043 Vali Loss: 3.337 Vali Acc: 0.540 Test Loss: 3.337 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4823014736175537
Epoch: 12, Steps: 18 | Train Loss: 1.605 Vali Loss: 6.503 Vali Acc: 0.430 Test Loss: 6.503 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9431972
model size : 35.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.940704584121704
Epoch: 1, Steps: 18 | Train Loss: 0.980 Vali Loss: 0.917 Vali Acc: 0.560 Test Loss: 0.917 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 1.578099012374878
Epoch: 2, Steps: 18 | Train Loss: 1.648 Vali Loss: 0.949 Vali Acc: 0.480 Test Loss: 0.949 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5401077270507812
Epoch: 3, Steps: 18 | Train Loss: 1.554 Vali Loss: 1.882 Vali Acc: 0.510 Test Loss: 1.882 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4445068836212158
Epoch: 4, Steps: 18 | Train Loss: 2.190 Vali Loss: 2.849 Vali Acc: 0.430 Test Loss: 2.849 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4404611587524414
Epoch: 5, Steps: 18 | Train Loss: 1.803 Vali Loss: 2.604 Vali Acc: 0.610 Test Loss: 2.604 Test Acc: 0.610
Validation loss decreased (-0.559991 --> -0.609974).  Saving model ...
Epoch: 6 cost time: 1.540186882019043
Epoch: 6, Steps: 18 | Train Loss: 1.687 Vali Loss: 4.511 Vali Acc: 0.500 Test Loss: 4.511 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6772198677062988
Epoch: 7, Steps: 18 | Train Loss: 1.719 Vali Loss: 2.931 Vali Acc: 0.560 Test Loss: 2.931 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5617055892944336
Epoch: 8, Steps: 18 | Train Loss: 1.337 Vali Loss: 6.308 Vali Acc: 0.460 Test Loss: 6.308 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.513883113861084
Epoch: 9, Steps: 18 | Train Loss: 1.263 Vali Loss: 4.401 Vali Acc: 0.440 Test Loss: 4.401 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6528816223144531
Epoch: 10, Steps: 18 | Train Loss: 1.085 Vali Loss: 3.008 Vali Acc: 0.530 Test Loss: 3.008 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4456682205200195
Epoch: 11, Steps: 18 | Train Loss: 1.090 Vali Loss: 5.357 Vali Acc: 0.470 Test Loss: 5.357 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8726742267608643
Epoch: 12, Steps: 18 | Train Loss: 2.136 Vali Loss: 4.554 Vali Acc: 0.580 Test Loss: 4.554 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.498234748840332
Epoch: 13, Steps: 18 | Train Loss: 1.568 Vali Loss: 8.051 Vali Acc: 0.500 Test Loss: 8.051 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.548588752746582
Epoch: 14, Steps: 18 | Train Loss: 1.361 Vali Loss: 3.561 Vali Acc: 0.560 Test Loss: 3.561 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4540607929229736
Epoch: 15, Steps: 18 | Train Loss: 1.484 Vali Loss: 9.002 Vali Acc: 0.560 Test Loss: 9.002 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9448698
model size : 36.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8122572898864746
Epoch: 1, Steps: 18 | Train Loss: 1.096 Vali Loss: 1.001 Vali Acc: 0.500 Test Loss: 1.001 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 1.4915392398834229
Epoch: 2, Steps: 18 | Train Loss: 1.095 Vali Loss: 1.125 Vali Acc: 0.530 Test Loss: 1.125 Test Acc: 0.530
Validation loss decreased (-0.499990 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 1.4976911544799805
Epoch: 3, Steps: 18 | Train Loss: 1.512 Vali Loss: 2.340 Vali Acc: 0.500 Test Loss: 2.340 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5926952362060547
Epoch: 4, Steps: 18 | Train Loss: 1.333 Vali Loss: 1.226 Vali Acc: 0.530 Test Loss: 1.226 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4894421100616455
Epoch: 5, Steps: 18 | Train Loss: 1.043 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.626288652420044
Epoch: 6, Steps: 18 | Train Loss: 1.554 Vali Loss: 2.859 Vali Acc: 0.540 Test Loss: 2.859 Test Acc: 0.540
Validation loss decreased (-0.529989 --> -0.539971).  Saving model ...
Epoch: 7 cost time: 1.4497106075286865
Epoch: 7, Steps: 18 | Train Loss: 1.223 Vali Loss: 2.965 Vali Acc: 0.510 Test Loss: 2.965 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5848674774169922
Epoch: 8, Steps: 18 | Train Loss: 1.250 Vali Loss: 1.829 Vali Acc: 0.590 Test Loss: 1.829 Test Acc: 0.590
Validation loss decreased (-0.539971 --> -0.589982).  Saving model ...
Epoch: 9 cost time: 1.6337800025939941
Epoch: 9, Steps: 18 | Train Loss: 1.382 Vali Loss: 5.893 Vali Acc: 0.470 Test Loss: 5.893 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6511297225952148
Epoch: 10, Steps: 18 | Train Loss: 2.494 Vali Loss: 6.086 Vali Acc: 0.440 Test Loss: 6.086 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8170084953308105
Epoch: 11, Steps: 18 | Train Loss: 2.682 Vali Loss: 7.318 Vali Acc: 0.430 Test Loss: 7.318 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6115431785583496
Epoch: 12, Steps: 18 | Train Loss: 1.605 Vali Loss: 4.353 Vali Acc: 0.520 Test Loss: 4.353 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4084107875823975
Epoch: 13, Steps: 18 | Train Loss: 1.482 Vali Loss: 7.909 Vali Acc: 0.420 Test Loss: 7.909 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5047202110290527
Epoch: 14, Steps: 18 | Train Loss: 2.008 Vali Loss: 4.279 Vali Acc: 0.550 Test Loss: 4.279 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.71299147605896
Epoch: 15, Steps: 18 | Train Loss: 1.834 Vali Loss: 4.981 Vali Acc: 0.530 Test Loss: 4.981 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5177783966064453
Epoch: 16, Steps: 18 | Train Loss: 2.263 Vali Loss: 7.471 Vali Acc: 0.530 Test Loss: 7.471 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7244622707366943
Epoch: 17, Steps: 18 | Train Loss: 3.210 Vali Loss: 5.526 Vali Acc: 0.540 Test Loss: 5.526 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4403760433197021
Epoch: 18, Steps: 18 | Train Loss: 1.886 Vali Loss: 11.128 Vali Acc: 0.480 Test Loss: 11.128 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9429652
model size : 35.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.990096092224121
Epoch: 1, Steps: 18 | Train Loss: 0.988 Vali Loss: 0.820 Vali Acc: 0.550 Test Loss: 0.820 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.6606242656707764
Epoch: 2, Steps: 18 | Train Loss: 1.197 Vali Loss: 1.643 Vali Acc: 0.490 Test Loss: 1.643 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6448259353637695
Epoch: 3, Steps: 18 | Train Loss: 1.570 Vali Loss: 1.446 Vali Acc: 0.530 Test Loss: 1.446 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6310150623321533
Epoch: 4, Steps: 18 | Train Loss: 1.173 Vali Loss: 1.638 Vali Acc: 0.520 Test Loss: 1.638 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.874483585357666
Epoch: 5, Steps: 18 | Train Loss: 1.350 Vali Loss: 2.475 Vali Acc: 0.470 Test Loss: 2.475 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8016622066497803
Epoch: 6, Steps: 18 | Train Loss: 1.183 Vali Loss: 3.103 Vali Acc: 0.380 Test Loss: 3.103 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5577147006988525
Epoch: 7, Steps: 18 | Train Loss: 1.145 Vali Loss: 2.511 Vali Acc: 0.550 Test Loss: 2.511 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8872203826904297
Epoch: 8, Steps: 18 | Train Loss: 1.084 Vali Loss: 2.059 Vali Acc: 0.470 Test Loss: 2.059 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4697747230529785
Epoch: 9, Steps: 18 | Train Loss: 1.074 Vali Loss: 2.242 Vali Acc: 0.530 Test Loss: 2.242 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4563238620758057
Epoch: 10, Steps: 18 | Train Loss: 1.232 Vali Loss: 3.824 Vali Acc: 0.420 Test Loss: 3.824 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5185623168945312
Epoch: 11, Steps: 18 | Train Loss: 1.209 Vali Loss: 3.841 Vali Acc: 0.580 Test Loss: 3.841 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579962).  Saving model ...
Epoch: 12 cost time: 1.4414129257202148
Epoch: 12, Steps: 18 | Train Loss: 0.920 Vali Loss: 3.330 Vali Acc: 0.580 Test Loss: 3.330 Test Acc: 0.580
Validation loss decreased (-0.579962 --> -0.579967).  Saving model ...
Epoch: 13 cost time: 1.6743276119232178
Epoch: 13, Steps: 18 | Train Loss: 1.301 Vali Loss: 7.852 Vali Acc: 0.490 Test Loss: 7.852 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5423572063446045
Epoch: 14, Steps: 18 | Train Loss: 1.314 Vali Loss: 5.513 Vali Acc: 0.440 Test Loss: 5.513 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3149573802947998
Epoch: 15, Steps: 18 | Train Loss: 1.636 Vali Loss: 5.190 Vali Acc: 0.530 Test Loss: 5.190 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.272352695465088
Epoch: 16, Steps: 18 | Train Loss: 4.520 Vali Loss: 10.185 Vali Acc: 0.620 Test Loss: 10.185 Test Acc: 0.620
Validation loss decreased (-0.579967 --> -0.619898).  Saving model ...
Epoch: 17 cost time: 1.6667366027832031
Epoch: 17, Steps: 18 | Train Loss: 1.836 Vali Loss: 3.646 Vali Acc: 0.490 Test Loss: 3.646 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4858922958374023
Epoch: 18, Steps: 18 | Train Loss: 1.707 Vali Loss: 5.167 Vali Acc: 0.510 Test Loss: 5.167 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5123660564422607
Epoch: 19, Steps: 18 | Train Loss: 2.043 Vali Loss: 8.282 Vali Acc: 0.540 Test Loss: 8.282 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4898600578308105
Epoch: 20, Steps: 18 | Train Loss: 2.118 Vali Loss: 8.247 Vali Acc: 0.490 Test Loss: 8.247 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4271516799926758
Epoch: 21, Steps: 18 | Train Loss: 2.171 Vali Loss: 24.777 Vali Acc: 0.460 Test Loss: 24.777 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5124175548553467
Epoch: 22, Steps: 18 | Train Loss: 3.473 Vali Loss: 10.256 Vali Acc: 0.470 Test Loss: 10.256 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3611934185028076
Epoch: 23, Steps: 18 | Train Loss: 1.386 Vali Loss: 9.930 Vali Acc: 0.530 Test Loss: 9.930 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6125209331512451
Epoch: 24, Steps: 18 | Train Loss: 1.117 Vali Loss: 11.249 Vali Acc: 0.540 Test Loss: 11.249 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.512709617614746
Epoch: 25, Steps: 18 | Train Loss: 5.380 Vali Loss: 11.126 Vali Acc: 0.400 Test Loss: 11.126 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.497288465499878
Epoch: 26, Steps: 18 | Train Loss: 1.856 Vali Loss: 10.142 Vali Acc: 0.510 Test Loss: 10.142 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9437834
model size : 36.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.34568452835083
Epoch: 1, Steps: 18 | Train Loss: 1.019 Vali Loss: 1.008 Vali Acc: 0.460 Test Loss: 1.008 Test Acc: 0.460
Validation loss decreased (inf --> -0.459990).  Saving model ...
Epoch: 2 cost time: 1.6232030391693115
Epoch: 2, Steps: 18 | Train Loss: 1.295 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
Validation loss decreased (-0.459990 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.1916799545288086
Epoch: 3, Steps: 18 | Train Loss: 1.102 Vali Loss: 1.313 Vali Acc: 0.520 Test Loss: 1.313 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7328627109527588
Epoch: 4, Steps: 18 | Train Loss: 1.009 Vali Loss: 2.287 Vali Acc: 0.530 Test Loss: 2.287 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529977).  Saving model ...
Epoch: 5 cost time: 1.6938629150390625
Epoch: 5, Steps: 18 | Train Loss: 1.451 Vali Loss: 2.325 Vali Acc: 0.530 Test Loss: 2.325 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6140480041503906
Epoch: 6, Steps: 18 | Train Loss: 1.412 Vali Loss: 2.809 Vali Acc: 0.430 Test Loss: 2.809 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5050907135009766
Epoch: 7, Steps: 18 | Train Loss: 1.125 Vali Loss: 2.960 Vali Acc: 0.520 Test Loss: 2.960 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7454943656921387
Epoch: 8, Steps: 18 | Train Loss: 1.428 Vali Loss: 2.550 Vali Acc: 0.570 Test Loss: 2.550 Test Acc: 0.570
Validation loss decreased (-0.529977 --> -0.569974).  Saving model ...
Epoch: 9 cost time: 1.5636451244354248
Epoch: 9, Steps: 18 | Train Loss: 0.903 Vali Loss: 2.883 Vali Acc: 0.500 Test Loss: 2.883 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5630900859832764
Epoch: 10, Steps: 18 | Train Loss: 1.719 Vali Loss: 3.361 Vali Acc: 0.520 Test Loss: 3.361 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.805452585220337
Epoch: 11, Steps: 18 | Train Loss: 1.059 Vali Loss: 3.293 Vali Acc: 0.480 Test Loss: 3.293 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8422186374664307
Epoch: 12, Steps: 18 | Train Loss: 1.799 Vali Loss: 3.340 Vali Acc: 0.480 Test Loss: 3.340 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7512304782867432
Epoch: 13, Steps: 18 | Train Loss: 1.637 Vali Loss: 3.291 Vali Acc: 0.540 Test Loss: 3.291 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7009766101837158
Epoch: 14, Steps: 18 | Train Loss: 2.134 Vali Loss: 3.962 Vali Acc: 0.380 Test Loss: 3.962 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8766632080078125
Epoch: 15, Steps: 18 | Train Loss: 1.979 Vali Loss: 6.554 Vali Acc: 0.430 Test Loss: 6.554 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9259555339813232
Epoch: 16, Steps: 18 | Train Loss: 2.184 Vali Loss: 3.868 Vali Acc: 0.500 Test Loss: 3.868 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9152369499206543
Epoch: 17, Steps: 18 | Train Loss: 2.110 Vali Loss: 5.548 Vali Acc: 0.470 Test Loss: 5.548 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6607286930084229
Epoch: 18, Steps: 18 | Train Loss: 1.656 Vali Loss: 9.061 Vali Acc: 0.520 Test Loss: 9.061 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9428148
model size : 35.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.479168653488159
Epoch: 1, Steps: 18 | Train Loss: 1.400 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 1.2270431518554688
Epoch: 2, Steps: 18 | Train Loss: 1.184 Vali Loss: 1.571 Vali Acc: 0.470 Test Loss: 1.571 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5877234935760498
Epoch: 3, Steps: 18 | Train Loss: 1.228 Vali Loss: 1.225 Vali Acc: 0.520 Test Loss: 1.225 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.526031494140625
Epoch: 4, Steps: 18 | Train Loss: 1.395 Vali Loss: 3.442 Vali Acc: 0.520 Test Loss: 3.442 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.360719919204712
Epoch: 5, Steps: 18 | Train Loss: 1.718 Vali Loss: 4.606 Vali Acc: 0.500 Test Loss: 4.606 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2007935047149658
Epoch: 6, Steps: 18 | Train Loss: 1.666 Vali Loss: 2.694 Vali Acc: 0.540 Test Loss: 2.694 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3171055316925049
Epoch: 7, Steps: 18 | Train Loss: 2.146 Vali Loss: 3.122 Vali Acc: 0.480 Test Loss: 3.122 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.596980333328247
Epoch: 8, Steps: 18 | Train Loss: 1.569 Vali Loss: 5.513 Vali Acc: 0.570 Test Loss: 5.513 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5049829483032227
Epoch: 9, Steps: 18 | Train Loss: 1.410 Vali Loss: 2.693 Vali Acc: 0.520 Test Loss: 2.693 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5253520011901855
Epoch: 10, Steps: 18 | Train Loss: 1.165 Vali Loss: 1.838 Vali Acc: 0.560 Test Loss: 1.838 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5248496532440186
Epoch: 11, Steps: 18 | Train Loss: 0.984 Vali Loss: 2.358 Vali Acc: 0.540 Test Loss: 2.358 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9436594
model size : 36.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.5896148681640625
Epoch: 1, Steps: 18 | Train Loss: 1.140 Vali Loss: 1.552 Vali Acc: 0.610 Test Loss: 1.552 Test Acc: 0.610
Validation loss decreased (inf --> -0.609984).  Saving model ...
Epoch: 2 cost time: 1.3442866802215576
Epoch: 2, Steps: 18 | Train Loss: 1.064 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4961133003234863
Epoch: 3, Steps: 18 | Train Loss: 1.120 Vali Loss: 2.527 Vali Acc: 0.450 Test Loss: 2.527 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4110701084136963
Epoch: 4, Steps: 18 | Train Loss: 1.028 Vali Loss: 2.089 Vali Acc: 0.520 Test Loss: 2.089 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4693853855133057
Epoch: 5, Steps: 18 | Train Loss: 1.257 Vali Loss: 1.867 Vali Acc: 0.550 Test Loss: 1.867 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3347055912017822
Epoch: 6, Steps: 18 | Train Loss: 1.393 Vali Loss: 4.386 Vali Acc: 0.510 Test Loss: 4.386 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3549864292144775
Epoch: 7, Steps: 18 | Train Loss: 1.770 Vali Loss: 5.265 Vali Acc: 0.580 Test Loss: 5.265 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3016514778137207
Epoch: 8, Steps: 18 | Train Loss: 1.851 Vali Loss: 5.217 Vali Acc: 0.430 Test Loss: 5.217 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5729660987854004
Epoch: 9, Steps: 18 | Train Loss: 1.262 Vali Loss: 2.954 Vali Acc: 0.610 Test Loss: 2.954 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3915138244628906
Epoch: 10, Steps: 18 | Train Loss: 1.185 Vali Loss: 5.213 Vali Acc: 0.440 Test Loss: 5.213 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2186532020568848
Epoch: 11, Steps: 18 | Train Loss: 1.652 Vali Loss: 4.442 Vali Acc: 0.530 Test Loss: 4.442 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9457140
model size : 36.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5630576610565186
Epoch: 1, Steps: 18 | Train Loss: 1.061 Vali Loss: 0.740 Vali Acc: 0.640 Test Loss: 0.740 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 1.5709624290466309
Epoch: 2, Steps: 18 | Train Loss: 1.299 Vali Loss: 0.971 Vali Acc: 0.490 Test Loss: 0.971 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.445594072341919
Epoch: 3, Steps: 18 | Train Loss: 1.017 Vali Loss: 1.674 Vali Acc: 0.570 Test Loss: 1.674 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.704434871673584
Epoch: 4, Steps: 18 | Train Loss: 1.518 Vali Loss: 1.773 Vali Acc: 0.530 Test Loss: 1.773 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7770955562591553
Epoch: 5, Steps: 18 | Train Loss: 1.052 Vali Loss: 2.306 Vali Acc: 0.500 Test Loss: 2.306 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8483920097351074
Epoch: 6, Steps: 18 | Train Loss: 1.717 Vali Loss: 2.318 Vali Acc: 0.490 Test Loss: 2.318 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6692521572113037
Epoch: 7, Steps: 18 | Train Loss: 1.234 Vali Loss: 1.723 Vali Acc: 0.520 Test Loss: 1.723 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6371722221374512
Epoch: 8, Steps: 18 | Train Loss: 1.302 Vali Loss: 2.625 Vali Acc: 0.440 Test Loss: 2.625 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0402886867523193
Epoch: 9, Steps: 18 | Train Loss: 1.265 Vali Loss: 2.667 Vali Acc: 0.500 Test Loss: 2.667 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6382310390472412
Epoch: 10, Steps: 18 | Train Loss: 1.429 Vali Loss: 2.354 Vali Acc: 0.510 Test Loss: 2.354 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.724381685256958
Epoch: 11, Steps: 18 | Train Loss: 0.764 Vali Loss: 2.085 Vali Acc: 0.490 Test Loss: 2.085 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 9426722
model size : 35.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3005316257476807
Epoch: 1, Steps: 18 | Train Loss: 1.293 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 1.5391182899475098
Epoch: 2, Steps: 18 | Train Loss: 1.471 Vali Loss: 1.031 Vali Acc: 0.490 Test Loss: 1.031 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2611041069030762
Epoch: 3, Steps: 18 | Train Loss: 1.068 Vali Loss: 1.555 Vali Acc: 0.460 Test Loss: 1.555 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.510077714920044
Epoch: 4, Steps: 18 | Train Loss: 1.631 Vali Loss: 1.582 Vali Acc: 0.470 Test Loss: 1.582 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5693376064300537
Epoch: 5, Steps: 18 | Train Loss: 1.152 Vali Loss: 2.599 Vali Acc: 0.470 Test Loss: 2.599 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3606853485107422
Epoch: 6, Steps: 18 | Train Loss: 1.328 Vali Loss: 2.253 Vali Acc: 0.480 Test Loss: 2.253 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3141589164733887
Epoch: 7, Steps: 18 | Train Loss: 1.396 Vali Loss: 1.807 Vali Acc: 0.500 Test Loss: 1.807 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3455531597137451
Epoch: 8, Steps: 18 | Train Loss: 1.346 Vali Loss: 3.719 Vali Acc: 0.550 Test Loss: 3.719 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549963).  Saving model ...
Epoch: 9 cost time: 1.4103164672851562
Epoch: 9, Steps: 18 | Train Loss: 1.390 Vali Loss: 5.440 Vali Acc: 0.440 Test Loss: 5.440 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4582712650299072
Epoch: 10, Steps: 18 | Train Loss: 1.073 Vali Loss: 2.286 Vali Acc: 0.500 Test Loss: 2.286 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.392359733581543
Epoch: 11, Steps: 18 | Train Loss: 1.050 Vali Loss: 2.917 Vali Acc: 0.460 Test Loss: 2.917 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3608818054199219
Epoch: 12, Steps: 18 | Train Loss: 1.061 Vali Loss: 4.702 Vali Acc: 0.550 Test Loss: 4.702 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5831265449523926
Epoch: 13, Steps: 18 | Train Loss: 1.088 Vali Loss: 4.038 Vali Acc: 0.520 Test Loss: 4.038 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.42275071144104
Epoch: 14, Steps: 18 | Train Loss: 1.556 Vali Loss: 5.488 Vali Acc: 0.510 Test Loss: 5.488 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3298945426940918
Epoch: 15, Steps: 18 | Train Loss: 1.391 Vali Loss: 4.637 Vali Acc: 0.520 Test Loss: 4.637 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3947911262512207
Epoch: 16, Steps: 18 | Train Loss: 1.927 Vali Loss: 5.587 Vali Acc: 0.520 Test Loss: 5.587 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3438777923583984
Epoch: 17, Steps: 18 | Train Loss: 1.186 Vali Loss: 5.002 Vali Acc: 0.540 Test Loss: 5.002 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.425487995147705
Epoch: 18, Steps: 18 | Train Loss: 1.341 Vali Loss: 5.305 Vali Acc: 0.550 Test Loss: 5.305 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 9450404
model size : 36.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.006362199783325
Epoch: 1, Steps: 18 | Train Loss: 1.048 Vali Loss: 1.300 Vali Acc: 0.590 Test Loss: 1.300 Test Acc: 0.590
Validation loss decreased (inf --> -0.589987).  Saving model ...
Epoch: 2 cost time: 1.3934693336486816
Epoch: 2, Steps: 18 | Train Loss: 1.242 Vali Loss: 0.940 Vali Acc: 0.500 Test Loss: 0.940 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8135936260223389
Epoch: 3, Steps: 18 | Train Loss: 1.144 Vali Loss: 2.083 Vali Acc: 0.500 Test Loss: 2.083 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.368985891342163
Epoch: 4, Steps: 18 | Train Loss: 1.160 Vali Loss: 3.268 Vali Acc: 0.500 Test Loss: 3.268 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2876689434051514
Epoch: 5, Steps: 18 | Train Loss: 1.628 Vali Loss: 3.621 Vali Acc: 0.470 Test Loss: 3.621 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.375166416168213
Epoch: 6, Steps: 18 | Train Loss: 0.969 Vali Loss: 4.500 Vali Acc: 0.470 Test Loss: 4.500 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4292869567871094
Epoch: 7, Steps: 18 | Train Loss: 1.367 Vali Loss: 2.229 Vali Acc: 0.540 Test Loss: 2.229 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.337015151977539
Epoch: 8, Steps: 18 | Train Loss: 0.876 Vali Loss: 4.853 Vali Acc: 0.500 Test Loss: 4.853 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.321329116821289
Epoch: 9, Steps: 18 | Train Loss: 1.664 Vali Loss: 3.996 Vali Acc: 0.530 Test Loss: 3.996 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3583226203918457
Epoch: 10, Steps: 18 | Train Loss: 1.436 Vali Loss: 3.738 Vali Acc: 0.540 Test Loss: 3.738 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7859866619110107
Epoch: 11, Steps: 18 | Train Loss: 1.188 Vali Loss: 3.668 Vali Acc: 0.510 Test Loss: 3.668 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9453122
model size : 36.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0958707332611084
Epoch: 1, Steps: 18 | Train Loss: 1.263 Vali Loss: 1.833 Vali Acc: 0.420 Test Loss: 1.833 Test Acc: 0.420
Validation loss decreased (inf --> -0.419982).  Saving model ...
Epoch: 2 cost time: 1.6558821201324463
Epoch: 2, Steps: 18 | Train Loss: 1.700 Vali Loss: 1.993 Vali Acc: 0.620 Test Loss: 1.993 Test Acc: 0.620
Validation loss decreased (-0.419982 --> -0.619980).  Saving model ...
Epoch: 3 cost time: 1.6054620742797852
Epoch: 3, Steps: 18 | Train Loss: 2.067 Vali Loss: 0.972 Vali Acc: 0.500 Test Loss: 0.972 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4353556632995605
Epoch: 4, Steps: 18 | Train Loss: 1.157 Vali Loss: 1.302 Vali Acc: 0.420 Test Loss: 1.302 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5551261901855469
Epoch: 5, Steps: 18 | Train Loss: 1.024 Vali Loss: 2.910 Vali Acc: 0.490 Test Loss: 2.910 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.470609426498413
Epoch: 6, Steps: 18 | Train Loss: 1.210 Vali Loss: 1.412 Vali Acc: 0.460 Test Loss: 1.412 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5187063217163086
Epoch: 7, Steps: 18 | Train Loss: 0.976 Vali Loss: 1.479 Vali Acc: 0.540 Test Loss: 1.479 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3394224643707275
Epoch: 8, Steps: 18 | Train Loss: 1.047 Vali Loss: 2.516 Vali Acc: 0.460 Test Loss: 2.516 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2013366222381592
Epoch: 9, Steps: 18 | Train Loss: 1.308 Vali Loss: 2.577 Vali Acc: 0.520 Test Loss: 2.577 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2906386852264404
Epoch: 10, Steps: 18 | Train Loss: 3.403 Vali Loss: 3.216 Vali Acc: 0.470 Test Loss: 3.216 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4038217067718506
Epoch: 11, Steps: 18 | Train Loss: 1.879 Vali Loss: 5.823 Vali Acc: 0.460 Test Loss: 5.823 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6283531188964844
Epoch: 12, Steps: 18 | Train Loss: 1.724 Vali Loss: 5.887 Vali Acc: 0.490 Test Loss: 5.887 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9443876
model size : 36.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.456761121749878
Epoch: 1, Steps: 18 | Train Loss: 1.028 Vali Loss: 1.748 Vali Acc: 0.540 Test Loss: 1.748 Test Acc: 0.540
Validation loss decreased (inf --> -0.539983).  Saving model ...
Epoch: 2 cost time: 1.8679840564727783
Epoch: 2, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.871 Vali Acc: 0.500 Test Loss: 1.871 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.530308723449707
Epoch: 3, Steps: 18 | Train Loss: 1.453 Vali Loss: 1.256 Vali Acc: 0.520 Test Loss: 1.256 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5068812370300293
Epoch: 4, Steps: 18 | Train Loss: 1.399 Vali Loss: 1.697 Vali Acc: 0.560 Test Loss: 1.697 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559983).  Saving model ...
Epoch: 5 cost time: 1.66170334815979
Epoch: 5, Steps: 18 | Train Loss: 1.658 Vali Loss: 3.520 Vali Acc: 0.500 Test Loss: 3.520 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7801132202148438
Epoch: 6, Steps: 18 | Train Loss: 1.986 Vali Loss: 2.883 Vali Acc: 0.470 Test Loss: 2.883 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9699938297271729
Epoch: 7, Steps: 18 | Train Loss: 1.425 Vali Loss: 3.508 Vali Acc: 0.540 Test Loss: 3.508 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.416499137878418
Epoch: 8, Steps: 18 | Train Loss: 1.854 Vali Loss: 3.225 Vali Acc: 0.500 Test Loss: 3.225 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4155282974243164
Epoch: 9, Steps: 18 | Train Loss: 1.056 Vali Loss: 2.115 Vali Acc: 0.490 Test Loss: 2.115 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7039339542388916
Epoch: 10, Steps: 18 | Train Loss: 1.399 Vali Loss: 4.288 Vali Acc: 0.570 Test Loss: 4.288 Test Acc: 0.570
Validation loss decreased (-0.559983 --> -0.569957).  Saving model ...
Epoch: 11 cost time: 1.4969446659088135
Epoch: 11, Steps: 18 | Train Loss: 2.291 Vali Loss: 8.068 Vali Acc: 0.520 Test Loss: 8.068 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3055918216705322
Epoch: 12, Steps: 18 | Train Loss: 3.350 Vali Loss: 4.891 Vali Acc: 0.530 Test Loss: 4.891 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.253333568572998
Epoch: 13, Steps: 18 | Train Loss: 1.994 Vali Loss: 4.511 Vali Acc: 0.460 Test Loss: 4.511 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3684563636779785
Epoch: 14, Steps: 18 | Train Loss: 3.280 Vali Loss: 5.641 Vali Acc: 0.510 Test Loss: 5.641 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5140132904052734
Epoch: 15, Steps: 18 | Train Loss: 1.603 Vali Loss: 4.282 Vali Acc: 0.390 Test Loss: 4.282 Test Acc: 0.390
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7966680526733398
Epoch: 16, Steps: 18 | Train Loss: 1.665 Vali Loss: 7.059 Vali Acc: 0.480 Test Loss: 7.059 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2886755466461182
Epoch: 17, Steps: 18 | Train Loss: 1.990 Vali Loss: 7.613 Vali Acc: 0.590 Test Loss: 7.613 Test Acc: 0.590
Validation loss decreased (-0.569957 --> -0.589924).  Saving model ...
Epoch: 18 cost time: 1.3388986587524414
Epoch: 18, Steps: 18 | Train Loss: 2.036 Vali Loss: 4.315 Vali Acc: 0.560 Test Loss: 4.315 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7092690467834473
Epoch: 19, Steps: 18 | Train Loss: 1.602 Vali Loss: 7.289 Vali Acc: 0.580 Test Loss: 7.289 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.65419602394104
Epoch: 20, Steps: 18 | Train Loss: 3.594 Vali Loss: 8.928 Vali Acc: 0.550 Test Loss: 8.928 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4427459239959717
Epoch: 21, Steps: 18 | Train Loss: 2.189 Vali Loss: 7.684 Vali Acc: 0.480 Test Loss: 7.684 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.446136713027954
Epoch: 22, Steps: 18 | Train Loss: 2.176 Vali Loss: 8.013 Vali Acc: 0.500 Test Loss: 8.013 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.34100341796875
Epoch: 23, Steps: 18 | Train Loss: 1.327 Vali Loss: 10.577 Vali Acc: 0.470 Test Loss: 10.577 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6005496978759766
Epoch: 24, Steps: 18 | Train Loss: 3.882 Vali Loss: 13.156 Vali Acc: 0.470 Test Loss: 13.156 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7457821369171143
Epoch: 25, Steps: 18 | Train Loss: 1.871 Vali Loss: 13.193 Vali Acc: 0.510 Test Loss: 13.193 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.379380464553833
Epoch: 26, Steps: 18 | Train Loss: 2.108 Vali Loss: 12.187 Vali Acc: 0.580 Test Loss: 12.187 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3851723670959473
Epoch: 27, Steps: 18 | Train Loss: 4.741 Vali Loss: 10.426 Vali Acc: 0.510 Test Loss: 10.426 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9431666
model size : 35.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.6767690181732178
Epoch: 1, Steps: 18 | Train Loss: 1.155 Vali Loss: 1.305 Vali Acc: 0.410 Test Loss: 1.305 Test Acc: 0.410
Validation loss decreased (inf --> -0.409987).  Saving model ...
Epoch: 2 cost time: 1.6156141757965088
Epoch: 2, Steps: 18 | Train Loss: 1.673 Vali Loss: 1.536 Vali Acc: 0.510 Test Loss: 1.536 Test Acc: 0.510
Validation loss decreased (-0.409987 --> -0.509985).  Saving model ...
Epoch: 3 cost time: 1.435302495956421
Epoch: 3, Steps: 18 | Train Loss: 1.091 Vali Loss: 1.740 Vali Acc: 0.480 Test Loss: 1.740 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3257148265838623
Epoch: 4, Steps: 18 | Train Loss: 1.383 Vali Loss: 3.650 Vali Acc: 0.460 Test Loss: 3.650 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2107019424438477
Epoch: 5, Steps: 18 | Train Loss: 1.134 Vali Loss: 1.852 Vali Acc: 0.510 Test Loss: 1.852 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4915132522583008
Epoch: 6, Steps: 18 | Train Loss: 1.208 Vali Loss: 2.302 Vali Acc: 0.480 Test Loss: 2.302 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3935763835906982
Epoch: 7, Steps: 18 | Train Loss: 1.226 Vali Loss: 1.765 Vali Acc: 0.520 Test Loss: 1.765 Test Acc: 0.520
Validation loss decreased (-0.509985 --> -0.519982).  Saving model ...
Epoch: 8 cost time: 1.6747734546661377
Epoch: 8, Steps: 18 | Train Loss: 1.335 Vali Loss: 2.226 Vali Acc: 0.450 Test Loss: 2.226 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5851693153381348
Epoch: 9, Steps: 18 | Train Loss: 1.080 Vali Loss: 1.829 Vali Acc: 0.500 Test Loss: 1.829 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3149011135101318
Epoch: 10, Steps: 18 | Train Loss: 0.962 Vali Loss: 6.060 Vali Acc: 0.520 Test Loss: 6.060 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.607224702835083
Epoch: 11, Steps: 18 | Train Loss: 1.792 Vali Loss: 3.631 Vali Acc: 0.500 Test Loss: 3.631 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6129279136657715
Epoch: 12, Steps: 18 | Train Loss: 1.779 Vali Loss: 6.224 Vali Acc: 0.610 Test Loss: 6.224 Test Acc: 0.610
Validation loss decreased (-0.519982 --> -0.609938).  Saving model ...
Epoch: 13 cost time: 1.474442720413208
Epoch: 13, Steps: 18 | Train Loss: 1.350 Vali Loss: 3.949 Vali Acc: 0.560 Test Loss: 3.949 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.477701187133789
Epoch: 14, Steps: 18 | Train Loss: 1.069 Vali Loss: 6.895 Vali Acc: 0.450 Test Loss: 6.895 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5559635162353516
Epoch: 15, Steps: 18 | Train Loss: 1.813 Vali Loss: 5.233 Vali Acc: 0.500 Test Loss: 5.233 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6653997898101807
Epoch: 16, Steps: 18 | Train Loss: 1.895 Vali Loss: 7.403 Vali Acc: 0.560 Test Loss: 7.403 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4979636669158936
Epoch: 17, Steps: 18 | Train Loss: 2.009 Vali Loss: 11.797 Vali Acc: 0.470 Test Loss: 11.797 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6511712074279785
Epoch: 18, Steps: 18 | Train Loss: 1.684 Vali Loss: 5.317 Vali Acc: 0.530 Test Loss: 5.317 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5032169818878174
Epoch: 19, Steps: 18 | Train Loss: 1.582 Vali Loss: 6.379 Vali Acc: 0.490 Test Loss: 6.379 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6194441318511963
Epoch: 20, Steps: 18 | Train Loss: 2.158 Vali Loss: 6.165 Vali Acc: 0.510 Test Loss: 6.165 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5149590969085693
Epoch: 21, Steps: 18 | Train Loss: 1.552 Vali Loss: 6.865 Vali Acc: 0.580 Test Loss: 6.865 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4767053127288818
Epoch: 22, Steps: 18 | Train Loss: 0.833 Vali Loss: 9.077 Vali Acc: 0.530 Test Loss: 9.077 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9425492
model size : 35.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.30954909324646
Epoch: 1, Steps: 18 | Train Loss: 0.976 Vali Loss: 1.791 Vali Acc: 0.560 Test Loss: 1.791 Test Acc: 0.560
Validation loss decreased (inf --> -0.559982).  Saving model ...
Epoch: 2 cost time: 1.3243188858032227
Epoch: 2, Steps: 18 | Train Loss: 1.169 Vali Loss: 0.866 Vali Acc: 0.580 Test Loss: 0.866 Test Acc: 0.580
Validation loss decreased (-0.559982 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 1.4397509098052979
Epoch: 3, Steps: 18 | Train Loss: 1.220 Vali Loss: 1.992 Vali Acc: 0.540 Test Loss: 1.992 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.499345302581787
Epoch: 4, Steps: 18 | Train Loss: 1.708 Vali Loss: 5.161 Vali Acc: 0.500 Test Loss: 5.161 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8821210861206055
Epoch: 5, Steps: 18 | Train Loss: 1.557 Vali Loss: 2.335 Vali Acc: 0.640 Test Loss: 2.335 Test Acc: 0.640
Validation loss decreased (-0.579991 --> -0.639977).  Saving model ...
Epoch: 6 cost time: 1.824831247329712
Epoch: 6, Steps: 18 | Train Loss: 1.223 Vali Loss: 3.097 Vali Acc: 0.470 Test Loss: 3.097 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.472160816192627
Epoch: 7, Steps: 18 | Train Loss: 1.416 Vali Loss: 3.660 Vali Acc: 0.510 Test Loss: 3.660 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4101486206054688
Epoch: 8, Steps: 18 | Train Loss: 1.214 Vali Loss: 2.428 Vali Acc: 0.550 Test Loss: 2.428 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5518834590911865
Epoch: 9, Steps: 18 | Train Loss: 1.530 Vali Loss: 3.538 Vali Acc: 0.490 Test Loss: 3.538 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7832756042480469
Epoch: 10, Steps: 18 | Train Loss: 1.202 Vali Loss: 2.787 Vali Acc: 0.510 Test Loss: 2.787 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6118276119232178
Epoch: 11, Steps: 18 | Train Loss: 1.192 Vali Loss: 3.034 Vali Acc: 0.550 Test Loss: 3.034 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.277513027191162
Epoch: 12, Steps: 18 | Train Loss: 0.960 Vali Loss: 3.984 Vali Acc: 0.460 Test Loss: 3.984 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.402146339416504
Epoch: 13, Steps: 18 | Train Loss: 1.473 Vali Loss: 4.783 Vali Acc: 0.430 Test Loss: 4.783 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5205409526824951
Epoch: 14, Steps: 18 | Train Loss: 1.866 Vali Loss: 4.940 Vali Acc: 0.450 Test Loss: 4.940 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8158578872680664
Epoch: 15, Steps: 18 | Train Loss: 2.308 Vali Loss: 10.657 Vali Acc: 0.490 Test Loss: 10.657 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm64_cs143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 9434354
model size : 36.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7932329177856445
Epoch: 1, Steps: 18 | Train Loss: 1.191 Vali Loss: 0.865 Vali Acc: 0.600 Test Loss: 0.865 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 1.633906602859497
Epoch: 2, Steps: 18 | Train Loss: 1.154 Vali Loss: 1.123 Vali Acc: 0.550 Test Loss: 1.123 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5112440586090088
Epoch: 3, Steps: 18 | Train Loss: 1.179 Vali Loss: 2.510 Vali Acc: 0.520 Test Loss: 2.510 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4257135391235352
Epoch: 4, Steps: 18 | Train Loss: 1.650 Vali Loss: 1.253 Vali Acc: 0.590 Test Loss: 1.253 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4072513580322266
Epoch: 5, Steps: 18 | Train Loss: 1.089 Vali Loss: 1.347 Vali Acc: 0.570 Test Loss: 1.347 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5259406566619873
Epoch: 6, Steps: 18 | Train Loss: 1.069 Vali Loss: 2.322 Vali Acc: 0.550 Test Loss: 2.322 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9347174167633057
Epoch: 7, Steps: 18 | Train Loss: 1.543 Vali Loss: 3.062 Vali Acc: 0.530 Test Loss: 3.062 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.429183006286621
Epoch: 8, Steps: 18 | Train Loss: 1.375 Vali Loss: 2.275 Vali Acc: 0.470 Test Loss: 2.275 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4034993648529053
Epoch: 9, Steps: 18 | Train Loss: 1.673 Vali Loss: 2.030 Vali Acc: 0.460 Test Loss: 2.030 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.535684585571289
Epoch: 10, Steps: 18 | Train Loss: 1.644 Vali Loss: 3.712 Vali Acc: 0.540 Test Loss: 3.712 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.677478313446045
Epoch: 11, Steps: 18 | Train Loss: 1.460 Vali Loss: 5.751 Vali Acc: 0.480 Test Loss: 5.751 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9430620
model size : 35.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.0260767936706543
Epoch: 1, Steps: 18 | Train Loss: 1.170 Vali Loss: 1.893 Vali Acc: 0.620 Test Loss: 1.893 Test Acc: 0.620
Validation loss decreased (inf --> -0.619981).  Saving model ...
Epoch: 2 cost time: 1.3737411499023438
Epoch: 2, Steps: 18 | Train Loss: 1.324 Vali Loss: 1.269 Vali Acc: 0.600 Test Loss: 1.269 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.429626703262329
Epoch: 3, Steps: 18 | Train Loss: 1.350 Vali Loss: 2.115 Vali Acc: 0.580 Test Loss: 2.115 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.32564377784729
Epoch: 4, Steps: 18 | Train Loss: 2.208 Vali Loss: 3.272 Vali Acc: 0.500 Test Loss: 3.272 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4440200328826904
Epoch: 5, Steps: 18 | Train Loss: 1.131 Vali Loss: 2.574 Vali Acc: 0.560 Test Loss: 2.574 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.586639642715454
Epoch: 6, Steps: 18 | Train Loss: 1.562 Vali Loss: 2.614 Vali Acc: 0.520 Test Loss: 2.614 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5438764095306396
Epoch: 7, Steps: 18 | Train Loss: 1.257 Vali Loss: 3.420 Vali Acc: 0.500 Test Loss: 3.420 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3695247173309326
Epoch: 8, Steps: 18 | Train Loss: 1.910 Vali Loss: 3.968 Vali Acc: 0.450 Test Loss: 3.968 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2731177806854248
Epoch: 9, Steps: 18 | Train Loss: 1.210 Vali Loss: 2.600 Vali Acc: 0.570 Test Loss: 2.600 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5997998714447021
Epoch: 10, Steps: 18 | Train Loss: 0.920 Vali Loss: 7.147 Vali Acc: 0.500 Test Loss: 7.147 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4948244094848633
Epoch: 11, Steps: 18 | Train Loss: 1.983 Vali Loss: 3.181 Vali Acc: 0.420 Test Loss: 3.181 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9422634
model size : 35.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.9515340328216553
Epoch: 1, Steps: 18 | Train Loss: 1.186 Vali Loss: 1.140 Vali Acc: 0.580 Test Loss: 1.140 Test Acc: 0.580
Validation loss decreased (inf --> -0.579989).  Saving model ...
Epoch: 2 cost time: 1.5598676204681396
Epoch: 2, Steps: 18 | Train Loss: 1.109 Vali Loss: 1.553 Vali Acc: 0.500 Test Loss: 1.553 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.347644329071045
Epoch: 3, Steps: 18 | Train Loss: 1.535 Vali Loss: 1.408 Vali Acc: 0.520 Test Loss: 1.408 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.386857032775879
Epoch: 4, Steps: 18 | Train Loss: 1.456 Vali Loss: 1.936 Vali Acc: 0.500 Test Loss: 1.936 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.386899709701538
Epoch: 5, Steps: 18 | Train Loss: 1.422 Vali Loss: 2.639 Vali Acc: 0.440 Test Loss: 2.639 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.602099895477295
Epoch: 6, Steps: 18 | Train Loss: 2.034 Vali Loss: 2.972 Vali Acc: 0.500 Test Loss: 2.972 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.585731029510498
Epoch: 7, Steps: 18 | Train Loss: 1.758 Vali Loss: 1.870 Vali Acc: 0.530 Test Loss: 1.870 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5378129482269287
Epoch: 8, Steps: 18 | Train Loss: 1.323 Vali Loss: 4.852 Vali Acc: 0.470 Test Loss: 4.852 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.335329532623291
Epoch: 9, Steps: 18 | Train Loss: 2.496 Vali Loss: 4.429 Vali Acc: 0.490 Test Loss: 4.429 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3885197639465332
Epoch: 10, Steps: 18 | Train Loss: 2.862 Vali Loss: 2.590 Vali Acc: 0.510 Test Loss: 2.590 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8110692501068115
Epoch: 11, Steps: 18 | Train Loss: 1.031 Vali Loss: 3.419 Vali Acc: 0.540 Test Loss: 3.419 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9418652
model size : 35.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4909939765930176
Epoch: 1, Steps: 18 | Train Loss: 1.208 Vali Loss: 1.674 Vali Acc: 0.490 Test Loss: 1.674 Test Acc: 0.490
Validation loss decreased (inf --> -0.489983).  Saving model ...
Epoch: 2 cost time: 1.493196725845337
Epoch: 2, Steps: 18 | Train Loss: 1.194 Vali Loss: 1.589 Vali Acc: 0.470 Test Loss: 1.589 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6217741966247559
Epoch: 3, Steps: 18 | Train Loss: 0.958 Vali Loss: 1.356 Vali Acc: 0.490 Test Loss: 1.356 Test Acc: 0.490
Validation loss decreased (-0.489983 --> -0.489986).  Saving model ...
Epoch: 4 cost time: 1.6087005138397217
Epoch: 4, Steps: 18 | Train Loss: 1.254 Vali Loss: 1.490 Vali Acc: 0.460 Test Loss: 1.490 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8071868419647217
Epoch: 5, Steps: 18 | Train Loss: 0.816 Vali Loss: 2.289 Vali Acc: 0.550 Test Loss: 2.289 Test Acc: 0.550
Validation loss decreased (-0.489986 --> -0.549977).  Saving model ...
Epoch: 6 cost time: 1.6907813549041748
Epoch: 6, Steps: 18 | Train Loss: 1.509 Vali Loss: 1.898 Vali Acc: 0.500 Test Loss: 1.898 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5623250007629395
Epoch: 7, Steps: 18 | Train Loss: 1.025 Vali Loss: 1.912 Vali Acc: 0.470 Test Loss: 1.912 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.376830816268921
Epoch: 8, Steps: 18 | Train Loss: 1.652 Vali Loss: 5.782 Vali Acc: 0.490 Test Loss: 5.782 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2258672714233398
Epoch: 9, Steps: 18 | Train Loss: 1.388 Vali Loss: 2.733 Vali Acc: 0.420 Test Loss: 2.733 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2650001049041748
Epoch: 10, Steps: 18 | Train Loss: 2.283 Vali Loss: 3.504 Vali Acc: 0.480 Test Loss: 3.504 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1812326908111572
Epoch: 11, Steps: 18 | Train Loss: 1.269 Vali Loss: 3.444 Vali Acc: 0.530 Test Loss: 3.444 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2188255786895752
Epoch: 12, Steps: 18 | Train Loss: 1.128 Vali Loss: 3.998 Vali Acc: 0.570 Test Loss: 3.998 Test Acc: 0.570
Validation loss decreased (-0.549977 --> -0.569960).  Saving model ...
Epoch: 13 cost time: 1.3521130084991455
Epoch: 13, Steps: 18 | Train Loss: 1.681 Vali Loss: 6.569 Vali Acc: 0.560 Test Loss: 6.569 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3139328956604004
Epoch: 14, Steps: 18 | Train Loss: 2.245 Vali Loss: 4.313 Vali Acc: 0.570 Test Loss: 4.313 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3630807399749756
Epoch: 15, Steps: 18 | Train Loss: 2.512 Vali Loss: 9.829 Vali Acc: 0.510 Test Loss: 9.829 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.496999740600586
Epoch: 16, Steps: 18 | Train Loss: 2.186 Vali Loss: 4.559 Vali Acc: 0.530 Test Loss: 4.559 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8098721504211426
Epoch: 17, Steps: 18 | Train Loss: 1.222 Vali Loss: 4.062 Vali Acc: 0.510 Test Loss: 4.062 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7100276947021484
Epoch: 18, Steps: 18 | Train Loss: 1.539 Vali Loss: 12.581 Vali Acc: 0.480 Test Loss: 12.581 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9093677997589111
Epoch: 19, Steps: 18 | Train Loss: 2.131 Vali Loss: 6.306 Vali Acc: 0.530 Test Loss: 6.306 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7514967918395996
Epoch: 20, Steps: 18 | Train Loss: 1.828 Vali Loss: 9.993 Vali Acc: 0.490 Test Loss: 9.993 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7284159660339355
Epoch: 21, Steps: 18 | Train Loss: 2.421 Vali Loss: 17.696 Vali Acc: 0.620 Test Loss: 17.696 Test Acc: 0.620
Validation loss decreased (-0.569960 --> -0.619823).  Saving model ...
Epoch: 22 cost time: 1.7753069400787354
Epoch: 22, Steps: 18 | Train Loss: 10.917 Vali Loss: 12.000 Vali Acc: 0.500 Test Loss: 12.000 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6193079948425293
Epoch: 23, Steps: 18 | Train Loss: 2.915 Vali Loss: 10.392 Vali Acc: 0.470 Test Loss: 10.392 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7121391296386719
Epoch: 24, Steps: 18 | Train Loss: 5.673 Vali Loss: 12.442 Vali Acc: 0.590 Test Loss: 12.442 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.759012222290039
Epoch: 25, Steps: 18 | Train Loss: 1.918 Vali Loss: 8.683 Vali Acc: 0.470 Test Loss: 8.683 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6903622150421143
Epoch: 26, Steps: 18 | Train Loss: 1.341 Vali Loss: 18.268 Vali Acc: 0.550 Test Loss: 18.268 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4540762901306152
Epoch: 27, Steps: 18 | Train Loss: 3.126 Vali Loss: 11.380 Vali Acc: 0.490 Test Loss: 11.380 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4380404949188232
Epoch: 28, Steps: 18 | Train Loss: 4.231 Vali Loss: 17.172 Vali Acc: 0.560 Test Loss: 17.172 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6494061946868896
Epoch: 29, Steps: 18 | Train Loss: 3.142 Vali Loss: 19.647 Vali Acc: 0.510 Test Loss: 19.647 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7809078693389893
Epoch: 30, Steps: 18 | Train Loss: 2.883 Vali Loss: 18.477 Vali Acc: 0.530 Test Loss: 18.477 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4517865180969238
Epoch: 31, Steps: 18 | Train Loss: 1.071 Vali Loss: 20.958 Vali Acc: 0.450 Test Loss: 20.958 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9416274
model size : 35.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.623373508453369
Epoch: 1, Steps: 18 | Train Loss: 1.069 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 1.4618332386016846
Epoch: 2, Steps: 18 | Train Loss: 1.075 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3923864364624023
Epoch: 3, Steps: 18 | Train Loss: 1.526 Vali Loss: 2.726 Vali Acc: 0.470 Test Loss: 2.726 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5132861137390137
Epoch: 4, Steps: 18 | Train Loss: 1.401 Vali Loss: 1.802 Vali Acc: 0.460 Test Loss: 1.802 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.487156867980957
Epoch: 5, Steps: 18 | Train Loss: 1.301 Vali Loss: 2.846 Vali Acc: 0.440 Test Loss: 2.846 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6831755638122559
Epoch: 6, Steps: 18 | Train Loss: 1.131 Vali Loss: 1.934 Vali Acc: 0.470 Test Loss: 1.934 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.43519926071167
Epoch: 7, Steps: 18 | Train Loss: 1.202 Vali Loss: 1.686 Vali Acc: 0.500 Test Loss: 1.686 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5110878944396973
Epoch: 8, Steps: 18 | Train Loss: 1.046 Vali Loss: 2.756 Vali Acc: 0.560 Test Loss: 2.756 Test Acc: 0.560
Validation loss decreased (-0.499989 --> -0.559972).  Saving model ...
Epoch: 9 cost time: 1.699552059173584
Epoch: 9, Steps: 18 | Train Loss: 1.488 Vali Loss: 3.051 Vali Acc: 0.430 Test Loss: 3.051 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.563952922821045
Epoch: 10, Steps: 18 | Train Loss: 1.323 Vali Loss: 4.778 Vali Acc: 0.530 Test Loss: 4.778 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6966187953948975
Epoch: 11, Steps: 18 | Train Loss: 1.776 Vali Loss: 5.018 Vali Acc: 0.400 Test Loss: 5.018 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4768078327178955
Epoch: 12, Steps: 18 | Train Loss: 3.554 Vali Loss: 9.921 Vali Acc: 0.480 Test Loss: 9.921 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5449824333190918
Epoch: 13, Steps: 18 | Train Loss: 3.852 Vali Loss: 7.018 Vali Acc: 0.490 Test Loss: 7.018 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3878722190856934
Epoch: 14, Steps: 18 | Train Loss: 2.939 Vali Loss: 3.162 Vali Acc: 0.510 Test Loss: 3.162 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.655836582183838
Epoch: 15, Steps: 18 | Train Loss: 1.600 Vali Loss: 11.560 Vali Acc: 0.490 Test Loss: 11.560 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5673248767852783
Epoch: 16, Steps: 18 | Train Loss: 2.039 Vali Loss: 4.527 Vali Acc: 0.510 Test Loss: 4.527 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3754687309265137
Epoch: 17, Steps: 18 | Train Loss: 2.974 Vali Loss: 13.430 Vali Acc: 0.530 Test Loss: 13.430 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2708415985107422
Epoch: 18, Steps: 18 | Train Loss: 3.954 Vali Loss: 7.313 Vali Acc: 0.600 Test Loss: 7.313 Test Acc: 0.600
Validation loss decreased (-0.559972 --> -0.599927).  Saving model ...
Epoch: 19 cost time: 1.3701629638671875
Epoch: 19, Steps: 18 | Train Loss: 1.755 Vali Loss: 22.303 Vali Acc: 0.500 Test Loss: 22.303 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5342133045196533
Epoch: 20, Steps: 18 | Train Loss: 2.484 Vali Loss: 9.197 Vali Acc: 0.520 Test Loss: 9.197 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.268022060394287
Epoch: 21, Steps: 18 | Train Loss: 1.749 Vali Loss: 9.916 Vali Acc: 0.490 Test Loss: 9.916 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3304309844970703
Epoch: 22, Steps: 18 | Train Loss: 2.962 Vali Loss: 9.050 Vali Acc: 0.510 Test Loss: 9.050 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.258789300918579
Epoch: 23, Steps: 18 | Train Loss: 2.371 Vali Loss: 8.807 Vali Acc: 0.410 Test Loss: 8.807 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3092265129089355
Epoch: 24, Steps: 18 | Train Loss: 0.804 Vali Loss: 6.235 Vali Acc: 0.460 Test Loss: 6.235 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.560312032699585
Epoch: 25, Steps: 18 | Train Loss: 1.555 Vali Loss: 10.870 Vali Acc: 0.530 Test Loss: 10.870 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.608553409576416
Epoch: 26, Steps: 18 | Train Loss: 1.323 Vali Loss: 17.362 Vali Acc: 0.480 Test Loss: 17.362 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.285529375076294
Epoch: 27, Steps: 18 | Train Loss: 1.985 Vali Loss: 9.444 Vali Acc: 0.460 Test Loss: 9.444 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4314277172088623
Epoch: 28, Steps: 18 | Train Loss: 1.973 Vali Loss: 14.721 Vali Acc: 0.440 Test Loss: 14.721 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9414700
model size : 35.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.880229949951172
Epoch: 1, Steps: 18 | Train Loss: 1.030 Vali Loss: 1.818 Vali Acc: 0.500 Test Loss: 1.818 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 1.526848554611206
Epoch: 2, Steps: 18 | Train Loss: 1.615 Vali Loss: 1.161 Vali Acc: 0.520 Test Loss: 1.161 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519988).  Saving model ...
Epoch: 3 cost time: 1.306872844696045
Epoch: 3, Steps: 18 | Train Loss: 1.091 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 4 cost time: 1.2762925624847412
Epoch: 4, Steps: 18 | Train Loss: 1.527 Vali Loss: 2.712 Vali Acc: 0.500 Test Loss: 2.712 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6869945526123047
Epoch: 5, Steps: 18 | Train Loss: 1.327 Vali Loss: 2.504 Vali Acc: 0.510 Test Loss: 2.504 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.495286464691162
Epoch: 6, Steps: 18 | Train Loss: 1.904 Vali Loss: 5.172 Vali Acc: 0.570 Test Loss: 5.172 Test Acc: 0.570
Validation loss decreased (-0.519989 --> -0.569948).  Saving model ...
Epoch: 7 cost time: 1.4398612976074219
Epoch: 7, Steps: 18 | Train Loss: 2.029 Vali Loss: 2.197 Vali Acc: 0.500 Test Loss: 2.197 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.493058443069458
Epoch: 8, Steps: 18 | Train Loss: 1.427 Vali Loss: 2.569 Vali Acc: 0.450 Test Loss: 2.569 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5057566165924072
Epoch: 9, Steps: 18 | Train Loss: 1.282 Vali Loss: 7.530 Vali Acc: 0.480 Test Loss: 7.530 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6331770420074463
Epoch: 10, Steps: 18 | Train Loss: 2.677 Vali Loss: 5.190 Vali Acc: 0.530 Test Loss: 5.190 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3987555503845215
Epoch: 11, Steps: 18 | Train Loss: 1.566 Vali Loss: 4.025 Vali Acc: 0.490 Test Loss: 4.025 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.476916790008545
Epoch: 12, Steps: 18 | Train Loss: 2.017 Vali Loss: 3.887 Vali Acc: 0.450 Test Loss: 3.887 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4284958839416504
Epoch: 13, Steps: 18 | Train Loss: 1.870 Vali Loss: 5.253 Vali Acc: 0.470 Test Loss: 5.253 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3079931735992432
Epoch: 14, Steps: 18 | Train Loss: 2.463 Vali Loss: 6.374 Vali Acc: 0.470 Test Loss: 6.374 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3996312618255615
Epoch: 15, Steps: 18 | Train Loss: 2.174 Vali Loss: 4.263 Vali Acc: 0.470 Test Loss: 4.263 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4267463684082031
Epoch: 16, Steps: 18 | Train Loss: 1.397 Vali Loss: 5.130 Vali Acc: 0.490 Test Loss: 5.130 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9422594
model size : 35.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.312683582305908
Epoch: 1, Steps: 18 | Train Loss: 1.235 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.8971917629241943
Epoch: 2, Steps: 18 | Train Loss: 1.033 Vali Loss: 1.604 Vali Acc: 0.590 Test Loss: 1.604 Test Acc: 0.590
Validation loss decreased (-0.489992 --> -0.589984).  Saving model ...
Epoch: 3 cost time: 1.4951698780059814
Epoch: 3, Steps: 18 | Train Loss: 1.597 Vali Loss: 1.277 Vali Acc: 0.480 Test Loss: 1.277 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3279244899749756
Epoch: 4, Steps: 18 | Train Loss: 1.201 Vali Loss: 1.764 Vali Acc: 0.430 Test Loss: 1.764 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5625600814819336
Epoch: 5, Steps: 18 | Train Loss: 1.077 Vali Loss: 1.185 Vali Acc: 0.440 Test Loss: 1.185 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7396132946014404
Epoch: 6, Steps: 18 | Train Loss: 1.077 Vali Loss: 1.822 Vali Acc: 0.610 Test Loss: 1.822 Test Acc: 0.610
Validation loss decreased (-0.589984 --> -0.609982).  Saving model ...
Epoch: 7 cost time: 1.454267978668213
Epoch: 7, Steps: 18 | Train Loss: 1.196 Vali Loss: 1.838 Vali Acc: 0.570 Test Loss: 1.838 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4050264358520508
Epoch: 8, Steps: 18 | Train Loss: 0.887 Vali Loss: 2.602 Vali Acc: 0.610 Test Loss: 2.602 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.508378505706787
Epoch: 9, Steps: 18 | Train Loss: 2.342 Vali Loss: 3.722 Vali Acc: 0.550 Test Loss: 3.722 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6114721298217773
Epoch: 10, Steps: 18 | Train Loss: 1.586 Vali Loss: 4.314 Vali Acc: 0.550 Test Loss: 4.314 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3981003761291504
Epoch: 11, Steps: 18 | Train Loss: 1.427 Vali Loss: 5.941 Vali Acc: 0.470 Test Loss: 5.941 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3624093532562256
Epoch: 12, Steps: 18 | Train Loss: 3.715 Vali Loss: 3.213 Vali Acc: 0.530 Test Loss: 3.213 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.429149866104126
Epoch: 13, Steps: 18 | Train Loss: 1.595 Vali Loss: 6.371 Vali Acc: 0.520 Test Loss: 6.371 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5094456672668457
Epoch: 14, Steps: 18 | Train Loss: 1.949 Vali Loss: 3.471 Vali Acc: 0.520 Test Loss: 3.471 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.45023775100708
Epoch: 15, Steps: 18 | Train Loss: 2.039 Vali Loss: 5.440 Vali Acc: 0.490 Test Loss: 5.440 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3596384525299072
Epoch: 16, Steps: 18 | Train Loss: 2.870 Vali Loss: 8.828 Vali Acc: 0.450 Test Loss: 8.828 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9412764
model size : 35.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs334_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.8851168155670166
Epoch: 1, Steps: 18 | Train Loss: 1.334 Vali Loss: 1.111 Vali Acc: 0.480 Test Loss: 1.111 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 1.2123126983642578
Epoch: 2, Steps: 18 | Train Loss: 1.391 Vali Loss: 1.959 Vali Acc: 0.490 Test Loss: 1.959 Test Acc: 0.490
Validation loss decreased (-0.479989 --> -0.489980).  Saving model ...
Epoch: 3 cost time: 1.2843775749206543
Epoch: 3, Steps: 18 | Train Loss: 1.526 Vali Loss: 1.224 Vali Acc: 0.520 Test Loss: 1.224 Test Acc: 0.520
Validation loss decreased (-0.489980 --> -0.519988).  Saving model ...
Epoch: 4 cost time: 1.441828727722168
Epoch: 4, Steps: 18 | Train Loss: 1.137 Vali Loss: 2.799 Vali Acc: 0.410 Test Loss: 2.799 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3005375862121582
Epoch: 5, Steps: 18 | Train Loss: 1.981 Vali Loss: 2.196 Vali Acc: 0.490 Test Loss: 2.196 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3186187744140625
Epoch: 6, Steps: 18 | Train Loss: 1.776 Vali Loss: 2.437 Vali Acc: 0.540 Test Loss: 2.437 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539976).  Saving model ...
Epoch: 7 cost time: 1.3744628429412842
Epoch: 7, Steps: 18 | Train Loss: 1.399 Vali Loss: 2.453 Vali Acc: 0.470 Test Loss: 2.453 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4251134395599365
Epoch: 8, Steps: 18 | Train Loss: 1.531 Vali Loss: 2.667 Vali Acc: 0.530 Test Loss: 2.667 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.534719705581665
Epoch: 9, Steps: 18 | Train Loss: 1.980 Vali Loss: 2.330 Vali Acc: 0.470 Test Loss: 2.330 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1185154914855957
Epoch: 10, Steps: 18 | Train Loss: 1.251 Vali Loss: 4.976 Vali Acc: 0.440 Test Loss: 4.976 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.179638147354126
Epoch: 11, Steps: 18 | Train Loss: 1.312 Vali Loss: 3.308 Vali Acc: 0.500 Test Loss: 3.308 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3168625831604004
Epoch: 12, Steps: 18 | Train Loss: 1.357 Vali Loss: 3.558 Vali Acc: 0.520 Test Loss: 3.558 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3662922382354736
Epoch: 13, Steps: 18 | Train Loss: 1.704 Vali Loss: 6.420 Vali Acc: 0.570 Test Loss: 6.420 Test Acc: 0.570
Validation loss decreased (-0.539976 --> -0.569936).  Saving model ...
Epoch: 14 cost time: 1.103926658630371
Epoch: 14, Steps: 18 | Train Loss: 2.916 Vali Loss: 7.136 Vali Acc: 0.590 Test Loss: 7.136 Test Acc: 0.590
Validation loss decreased (-0.569936 --> -0.589929).  Saving model ...
Epoch: 15 cost time: 1.1967968940734863
Epoch: 15, Steps: 18 | Train Loss: 2.234 Vali Loss: 5.439 Vali Acc: 0.510 Test Loss: 5.439 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2946934700012207
Epoch: 16, Steps: 18 | Train Loss: 3.097 Vali Loss: 7.622 Vali Acc: 0.500 Test Loss: 7.622 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.244359016418457
Epoch: 17, Steps: 18 | Train Loss: 2.328 Vali Loss: 9.940 Vali Acc: 0.480 Test Loss: 9.940 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3722872734069824
Epoch: 18, Steps: 18 | Train Loss: 1.968 Vali Loss: 6.172 Vali Acc: 0.520 Test Loss: 6.172 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3102972507476807
Epoch: 19, Steps: 18 | Train Loss: 3.166 Vali Loss: 13.710 Vali Acc: 0.450 Test Loss: 13.710 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.252108097076416
Epoch: 20, Steps: 18 | Train Loss: 1.692 Vali Loss: 17.821 Vali Acc: 0.610 Test Loss: 17.821 Test Acc: 0.610
Validation loss decreased (-0.589929 --> -0.609822).  Saving model ...
Epoch: 21 cost time: 1.673055648803711
Epoch: 21, Steps: 18 | Train Loss: 4.631 Vali Loss: 17.621 Vali Acc: 0.490 Test Loss: 17.621 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3143424987792969
Epoch: 22, Steps: 18 | Train Loss: 4.395 Vali Loss: 13.365 Vali Acc: 0.600 Test Loss: 13.365 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4252939224243164
Epoch: 23, Steps: 18 | Train Loss: 3.899 Vali Loss: 20.145 Vali Acc: 0.490 Test Loss: 20.145 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2775993347167969
Epoch: 24, Steps: 18 | Train Loss: 3.133 Vali Loss: 19.616 Vali Acc: 0.560 Test Loss: 19.616 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3136274814605713
Epoch: 25, Steps: 18 | Train Loss: 3.771 Vali Loss: 32.784 Vali Acc: 0.530 Test Loss: 32.784 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.598951816558838
Epoch: 26, Steps: 18 | Train Loss: 11.832 Vali Loss: 40.488 Vali Acc: 0.480 Test Loss: 40.488 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.343506097793579
Epoch: 27, Steps: 18 | Train Loss: 7.381 Vali Loss: 16.999 Vali Acc: 0.520 Test Loss: 16.999 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.748412847518921
Epoch: 28, Steps: 18 | Train Loss: 6.218 Vali Loss: 22.424 Vali Acc: 0.560 Test Loss: 22.424 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5022673606872559
Epoch: 29, Steps: 18 | Train Loss: 4.110 Vali Loss: 16.594 Vali Acc: 0.500 Test Loss: 16.594 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2607877254486084
Epoch: 30, Steps: 18 | Train Loss: 1.731 Vali Loss: 21.087 Vali Acc: 0.440 Test Loss: 21.087 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs334_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9430146
model size : 35.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.3917465209960938
Epoch: 1, Steps: 18 | Train Loss: 1.238 Vali Loss: 0.867 Vali Acc: 0.640 Test Loss: 0.867 Test Acc: 0.640
Validation loss decreased (inf --> -0.639991).  Saving model ...
Epoch: 2 cost time: 1.1311349868774414
Epoch: 2, Steps: 18 | Train Loss: 1.505 Vali Loss: 0.952 Vali Acc: 0.550 Test Loss: 0.952 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2603037357330322
Epoch: 3, Steps: 18 | Train Loss: 1.298 Vali Loss: 1.504 Vali Acc: 0.510 Test Loss: 1.504 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3796510696411133
Epoch: 4, Steps: 18 | Train Loss: 1.183 Vali Loss: 1.560 Vali Acc: 0.460 Test Loss: 1.560 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.457061529159546
Epoch: 5, Steps: 18 | Train Loss: 1.388 Vali Loss: 2.913 Vali Acc: 0.450 Test Loss: 2.913 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1404740810394287
Epoch: 6, Steps: 18 | Train Loss: 1.761 Vali Loss: 2.704 Vali Acc: 0.440 Test Loss: 2.704 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.399414300918579
Epoch: 7, Steps: 18 | Train Loss: 1.374 Vali Loss: 2.712 Vali Acc: 0.550 Test Loss: 2.712 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4100868701934814
Epoch: 8, Steps: 18 | Train Loss: 1.754 Vali Loss: 3.452 Vali Acc: 0.570 Test Loss: 3.452 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4462087154388428
Epoch: 9, Steps: 18 | Train Loss: 1.516 Vali Loss: 3.663 Vali Acc: 0.540 Test Loss: 3.663 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5031065940856934
Epoch: 10, Steps: 18 | Train Loss: 0.817 Vali Loss: 4.238 Vali Acc: 0.520 Test Loss: 4.238 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3556466102600098
Epoch: 11, Steps: 18 | Train Loss: 1.490 Vali Loss: 5.839 Vali Acc: 0.460 Test Loss: 5.839 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 9411644
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs273_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.78098201751709
Epoch: 1, Steps: 18 | Train Loss: 0.993 Vali Loss: 1.299 Vali Acc: 0.540 Test Loss: 1.299 Test Acc: 0.540
Validation loss decreased (inf --> -0.539987).  Saving model ...
Epoch: 2 cost time: 1.2171432971954346
Epoch: 2, Steps: 18 | Train Loss: 1.372 Vali Loss: 1.515 Vali Acc: 0.450 Test Loss: 1.515 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4275054931640625
Epoch: 3, Steps: 18 | Train Loss: 1.027 Vali Loss: 2.127 Vali Acc: 0.490 Test Loss: 2.127 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6157238483428955
Epoch: 4, Steps: 18 | Train Loss: 1.160 Vali Loss: 1.501 Vali Acc: 0.510 Test Loss: 1.501 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.373673439025879
Epoch: 5, Steps: 18 | Train Loss: 1.285 Vali Loss: 2.162 Vali Acc: 0.540 Test Loss: 2.162 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.257948637008667
Epoch: 6, Steps: 18 | Train Loss: 1.056 Vali Loss: 2.870 Vali Acc: 0.410 Test Loss: 2.870 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2923262119293213
Epoch: 7, Steps: 18 | Train Loss: 1.648 Vali Loss: 2.709 Vali Acc: 0.540 Test Loss: 2.709 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7339107990264893
Epoch: 8, Steps: 18 | Train Loss: 2.269 Vali Loss: 2.775 Vali Acc: 0.440 Test Loss: 2.775 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5622258186340332
Epoch: 9, Steps: 18 | Train Loss: 2.208 Vali Loss: 4.249 Vali Acc: 0.460 Test Loss: 4.249 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5043718814849854
Epoch: 10, Steps: 18 | Train Loss: 2.027 Vali Loss: 4.706 Vali Acc: 0.520 Test Loss: 4.706 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.347181797027588
Epoch: 11, Steps: 18 | Train Loss: 3.873 Vali Loss: 6.253 Vali Acc: 0.520 Test Loss: 6.253 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs273_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9420258
model size : 35.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.1098179817199707
Epoch: 1, Steps: 18 | Train Loss: 0.971 Vali Loss: 1.019 Vali Acc: 0.530 Test Loss: 1.019 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 1.3420531749725342
Epoch: 2, Steps: 18 | Train Loss: 1.676 Vali Loss: 1.800 Vali Acc: 0.510 Test Loss: 1.800 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3085088729858398
Epoch: 3, Steps: 18 | Train Loss: 2.263 Vali Loss: 1.691 Vali Acc: 0.600 Test Loss: 1.691 Test Acc: 0.600
Validation loss decreased (-0.529990 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 1.39021635055542
Epoch: 4, Steps: 18 | Train Loss: 1.458 Vali Loss: 1.363 Vali Acc: 0.560 Test Loss: 1.363 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.327164649963379
Epoch: 5, Steps: 18 | Train Loss: 1.880 Vali Loss: 2.273 Vali Acc: 0.530 Test Loss: 2.273 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3156437873840332
Epoch: 6, Steps: 18 | Train Loss: 1.959 Vali Loss: 4.575 Vali Acc: 0.560 Test Loss: 4.575 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3103594779968262
Epoch: 7, Steps: 18 | Train Loss: 2.014 Vali Loss: 5.307 Vali Acc: 0.530 Test Loss: 5.307 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2397048473358154
Epoch: 8, Steps: 18 | Train Loss: 1.114 Vali Loss: 3.429 Vali Acc: 0.440 Test Loss: 3.429 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.276606559753418
Epoch: 9, Steps: 18 | Train Loss: 1.634 Vali Loss: 2.753 Vali Acc: 0.570 Test Loss: 2.753 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3151874542236328
Epoch: 10, Steps: 18 | Train Loss: 2.066 Vali Loss: 3.537 Vali Acc: 0.510 Test Loss: 3.537 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2991101741790771
Epoch: 11, Steps: 18 | Train Loss: 1.608 Vali Loss: 3.000 Vali Acc: 0.530 Test Loss: 3.000 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4031987190246582
Epoch: 12, Steps: 18 | Train Loss: 2.068 Vali Loss: 8.670 Vali Acc: 0.520 Test Loss: 8.670 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5358164310455322
Epoch: 13, Steps: 18 | Train Loss: 2.012 Vali Loss: 4.297 Vali Acc: 0.500 Test Loss: 4.297 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9410940
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.775388479232788
Epoch: 1, Steps: 18 | Train Loss: 1.160 Vali Loss: 0.899 Vali Acc: 0.530 Test Loss: 0.899 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 1.4737629890441895
Epoch: 2, Steps: 18 | Train Loss: 1.648 Vali Loss: 2.767 Vali Acc: 0.520 Test Loss: 2.767 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3765969276428223
Epoch: 3, Steps: 18 | Train Loss: 2.106 Vali Loss: 1.792 Vali Acc: 0.520 Test Loss: 1.792 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1280395984649658
Epoch: 4, Steps: 18 | Train Loss: 1.348 Vali Loss: 3.933 Vali Acc: 0.470 Test Loss: 3.933 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1415650844573975
Epoch: 5, Steps: 18 | Train Loss: 1.622 Vali Loss: 1.389 Vali Acc: 0.500 Test Loss: 1.389 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.228818416595459
Epoch: 6, Steps: 18 | Train Loss: 1.085 Vali Loss: 3.416 Vali Acc: 0.560 Test Loss: 3.416 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559966).  Saving model ...
Epoch: 7 cost time: 1.2713005542755127
Epoch: 7, Steps: 18 | Train Loss: 1.467 Vali Loss: 2.258 Vali Acc: 0.600 Test Loss: 2.258 Test Acc: 0.600
Validation loss decreased (-0.559966 --> -0.599977).  Saving model ...
Epoch: 8 cost time: 1.1961264610290527
Epoch: 8, Steps: 18 | Train Loss: 1.074 Vali Loss: 2.731 Vali Acc: 0.500 Test Loss: 2.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2358343601226807
Epoch: 9, Steps: 18 | Train Loss: 0.876 Vali Loss: 2.234 Vali Acc: 0.580 Test Loss: 2.234 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.331270456314087
Epoch: 10, Steps: 18 | Train Loss: 1.336 Vali Loss: 2.411 Vali Acc: 0.500 Test Loss: 2.411 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6582999229431152
Epoch: 11, Steps: 18 | Train Loss: 1.699 Vali Loss: 3.954 Vali Acc: 0.430 Test Loss: 3.954 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3743822574615479
Epoch: 12, Steps: 18 | Train Loss: 0.935 Vali Loss: 3.208 Vali Acc: 0.510 Test Loss: 3.208 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3803131580352783
Epoch: 13, Steps: 18 | Train Loss: 1.513 Vali Loss: 5.620 Vali Acc: 0.470 Test Loss: 5.620 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3858537673950195
Epoch: 14, Steps: 18 | Train Loss: 1.547 Vali Loss: 3.700 Vali Acc: 0.500 Test Loss: 3.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3596856594085693
Epoch: 15, Steps: 18 | Train Loss: 1.477 Vali Loss: 3.247 Vali Acc: 0.510 Test Loss: 3.247 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4944307804107666
Epoch: 16, Steps: 18 | Train Loss: 1.078 Vali Loss: 5.302 Vali Acc: 0.510 Test Loss: 5.302 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.550438404083252
Epoch: 17, Steps: 18 | Train Loss: 1.456 Vali Loss: 3.947 Vali Acc: 0.490 Test Loss: 3.947 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9419690
model size : 35.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.7618534564971924
Epoch: 1, Steps: 18 | Train Loss: 1.024 Vali Loss: 0.994 Vali Acc: 0.590 Test Loss: 0.994 Test Acc: 0.590
Validation loss decreased (inf --> -0.589990).  Saving model ...
Epoch: 2 cost time: 1.6019210815429688
Epoch: 2, Steps: 18 | Train Loss: 0.910 Vali Loss: 1.569 Vali Acc: 0.520 Test Loss: 1.569 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.445772409439087
Epoch: 3, Steps: 18 | Train Loss: 1.087 Vali Loss: 1.579 Vali Acc: 0.530 Test Loss: 1.579 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2869343757629395
Epoch: 4, Steps: 18 | Train Loss: 1.264 Vali Loss: 3.561 Vali Acc: 0.440 Test Loss: 3.561 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3919625282287598
Epoch: 5, Steps: 18 | Train Loss: 1.683 Vali Loss: 2.181 Vali Acc: 0.490 Test Loss: 2.181 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5526809692382812
Epoch: 6, Steps: 18 | Train Loss: 1.504 Vali Loss: 2.612 Vali Acc: 0.460 Test Loss: 2.612 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7157025337219238
Epoch: 7, Steps: 18 | Train Loss: 1.218 Vali Loss: 3.034 Vali Acc: 0.530 Test Loss: 3.034 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.439558982849121
Epoch: 8, Steps: 18 | Train Loss: 0.950 Vali Loss: 3.124 Vali Acc: 0.480 Test Loss: 3.124 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6972148418426514
Epoch: 9, Steps: 18 | Train Loss: 1.594 Vali Loss: 4.791 Vali Acc: 0.520 Test Loss: 4.791 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6745212078094482
Epoch: 10, Steps: 18 | Train Loss: 1.754 Vali Loss: 8.436 Vali Acc: 0.460 Test Loss: 8.436 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4624385833740234
Epoch: 11, Steps: 18 | Train Loss: 2.341 Vali Loss: 3.913 Vali Acc: 0.490 Test Loss: 3.913 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9440492
model size : 36.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.755479335784912
Epoch: 1, Steps: 18 | Train Loss: 1.160 Vali Loss: 1.223 Vali Acc: 0.480 Test Loss: 1.223 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 1.3085591793060303
Epoch: 2, Steps: 18 | Train Loss: 1.420 Vali Loss: 1.005 Vali Acc: 0.620 Test Loss: 1.005 Test Acc: 0.620
Validation loss decreased (-0.479988 --> -0.619990).  Saving model ...
Epoch: 3 cost time: 1.2510416507720947
Epoch: 3, Steps: 18 | Train Loss: 1.316 Vali Loss: 1.817 Vali Acc: 0.610 Test Loss: 1.817 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2532391548156738
Epoch: 4, Steps: 18 | Train Loss: 2.008 Vali Loss: 2.636 Vali Acc: 0.530 Test Loss: 2.636 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3574738502502441
Epoch: 5, Steps: 18 | Train Loss: 2.017 Vali Loss: 1.927 Vali Acc: 0.550 Test Loss: 1.927 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4047248363494873
Epoch: 6, Steps: 18 | Train Loss: 1.631 Vali Loss: 3.605 Vali Acc: 0.470 Test Loss: 3.605 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1780903339385986
Epoch: 7, Steps: 18 | Train Loss: 1.396 Vali Loss: 1.731 Vali Acc: 0.590 Test Loss: 1.731 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2493407726287842
Epoch: 8, Steps: 18 | Train Loss: 1.197 Vali Loss: 2.282 Vali Acc: 0.530 Test Loss: 2.282 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.34726881980896
Epoch: 9, Steps: 18 | Train Loss: 1.320 Vali Loss: 2.519 Vali Acc: 0.600 Test Loss: 2.519 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3500676155090332
Epoch: 10, Steps: 18 | Train Loss: 1.364 Vali Loss: 7.455 Vali Acc: 0.530 Test Loss: 7.455 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4049367904663086
Epoch: 11, Steps: 18 | Train Loss: 1.783 Vali Loss: 4.585 Vali Acc: 0.590 Test Loss: 4.585 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5076329708099365
Epoch: 12, Steps: 18 | Train Loss: 3.301 Vali Loss: 5.791 Vali Acc: 0.550 Test Loss: 5.791 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9410314
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.12605881690979
Epoch: 1, Steps: 18 | Train Loss: 1.215 Vali Loss: 0.932 Vali Acc: 0.450 Test Loss: 0.932 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 1.3922340869903564
Epoch: 2, Steps: 18 | Train Loss: 1.351 Vali Loss: 1.607 Vali Acc: 0.540 Test Loss: 1.607 Test Acc: 0.540
Validation loss decreased (-0.449991 --> -0.539984).  Saving model ...
Epoch: 3 cost time: 1.4581525325775146
Epoch: 3, Steps: 18 | Train Loss: 1.411 Vali Loss: 1.438 Vali Acc: 0.540 Test Loss: 1.438 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539986).  Saving model ...
Epoch: 4 cost time: 1.365936517715454
Epoch: 4, Steps: 18 | Train Loss: 1.195 Vali Loss: 1.401 Vali Acc: 0.560 Test Loss: 1.401 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559986).  Saving model ...
Epoch: 5 cost time: 1.3209717273712158
Epoch: 5, Steps: 18 | Train Loss: 1.139 Vali Loss: 1.398 Vali Acc: 0.510 Test Loss: 1.398 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5245132446289062
Epoch: 6, Steps: 18 | Train Loss: 1.816 Vali Loss: 3.407 Vali Acc: 0.580 Test Loss: 3.407 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579966).  Saving model ...
Epoch: 7 cost time: 1.490342617034912
Epoch: 7, Steps: 18 | Train Loss: 1.280 Vali Loss: 2.586 Vali Acc: 0.520 Test Loss: 2.586 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3441736698150635
Epoch: 8, Steps: 18 | Train Loss: 1.294 Vali Loss: 4.208 Vali Acc: 0.520 Test Loss: 4.208 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6825463771820068
Epoch: 9, Steps: 18 | Train Loss: 1.269 Vali Loss: 1.752 Vali Acc: 0.520 Test Loss: 1.752 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7667510509490967
Epoch: 10, Steps: 18 | Train Loss: 1.338 Vali Loss: 4.061 Vali Acc: 0.460 Test Loss: 4.061 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.87286376953125
Epoch: 11, Steps: 18 | Train Loss: 1.525 Vali Loss: 3.466 Vali Acc: 0.500 Test Loss: 3.466 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5849666595458984
Epoch: 12, Steps: 18 | Train Loss: 1.420 Vali Loss: 4.231 Vali Acc: 0.450 Test Loss: 4.231 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.613527536392212
Epoch: 13, Steps: 18 | Train Loss: 0.659 Vali Loss: 4.440 Vali Acc: 0.420 Test Loss: 4.440 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6959807872772217
Epoch: 14, Steps: 18 | Train Loss: 1.551 Vali Loss: 4.007 Vali Acc: 0.530 Test Loss: 4.007 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.68440842628479
Epoch: 15, Steps: 18 | Train Loss: 1.357 Vali Loss: 3.272 Vali Acc: 0.510 Test Loss: 3.272 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6827783584594727
Epoch: 16, Steps: 18 | Train Loss: 1.698 Vali Loss: 3.530 Vali Acc: 0.520 Test Loss: 3.530 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9434188
model size : 36.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs177_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.851519823074341
Epoch: 1, Steps: 18 | Train Loss: 1.052 Vali Loss: 1.486 Vali Acc: 0.530 Test Loss: 1.486 Test Acc: 0.530
Validation loss decreased (inf --> -0.529985).  Saving model ...
Epoch: 2 cost time: 1.3786468505859375
Epoch: 2, Steps: 18 | Train Loss: 1.505 Vali Loss: 1.576 Vali Acc: 0.580 Test Loss: 1.576 Test Acc: 0.580
Validation loss decreased (-0.529985 --> -0.579984).  Saving model ...
Epoch: 3 cost time: 1.3980979919433594
Epoch: 3, Steps: 18 | Train Loss: 1.307 Vali Loss: 1.137 Vali Acc: 0.490 Test Loss: 1.137 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.528869867324829
Epoch: 4, Steps: 18 | Train Loss: 1.475 Vali Loss: 2.729 Vali Acc: 0.580 Test Loss: 2.729 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9156041145324707
Epoch: 5, Steps: 18 | Train Loss: 1.638 Vali Loss: 2.941 Vali Acc: 0.490 Test Loss: 2.941 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.730396032333374
Epoch: 6, Steps: 18 | Train Loss: 1.094 Vali Loss: 2.089 Vali Acc: 0.510 Test Loss: 2.089 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.498711347579956
Epoch: 7, Steps: 18 | Train Loss: 1.465 Vali Loss: 7.040 Vali Acc: 0.500 Test Loss: 7.040 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4256525039672852
Epoch: 8, Steps: 18 | Train Loss: 1.965 Vali Loss: 1.887 Vali Acc: 0.510 Test Loss: 1.887 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7991433143615723
Epoch: 9, Steps: 18 | Train Loss: 1.029 Vali Loss: 5.930 Vali Acc: 0.410 Test Loss: 5.930 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.667499303817749
Epoch: 10, Steps: 18 | Train Loss: 1.673 Vali Loss: 4.469 Vali Acc: 0.510 Test Loss: 4.469 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.412060022354126
Epoch: 11, Steps: 18 | Train Loss: 1.102 Vali Loss: 2.648 Vali Acc: 0.490 Test Loss: 2.648 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3962898254394531
Epoch: 12, Steps: 18 | Train Loss: 2.131 Vali Loss: 10.012 Vali Acc: 0.490 Test Loss: 10.012 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs177_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9437082
model size : 36.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.706024646759033
Epoch: 1, Steps: 18 | Train Loss: 1.491 Vali Loss: 1.038 Vali Acc: 0.510 Test Loss: 1.038 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 1.127539873123169
Epoch: 2, Steps: 18 | Train Loss: 2.743 Vali Loss: 1.018 Vali Acc: 0.580 Test Loss: 1.018 Test Acc: 0.580
Validation loss decreased (-0.509990 --> -0.579990).  Saving model ...
Epoch: 3 cost time: 1.498530387878418
Epoch: 3, Steps: 18 | Train Loss: 1.574 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5500481128692627
Epoch: 4, Steps: 18 | Train Loss: 1.855 Vali Loss: 1.449 Vali Acc: 0.590 Test Loss: 1.449 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589986).  Saving model ...
Epoch: 5 cost time: 1.3723375797271729
Epoch: 5, Steps: 18 | Train Loss: 1.413 Vali Loss: 1.493 Vali Acc: 0.570 Test Loss: 1.493 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4785964488983154
Epoch: 6, Steps: 18 | Train Loss: 1.161 Vali Loss: 3.873 Vali Acc: 0.470 Test Loss: 3.873 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4166486263275146
Epoch: 7, Steps: 18 | Train Loss: 2.137 Vali Loss: 2.507 Vali Acc: 0.490 Test Loss: 2.507 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3894374370574951
Epoch: 8, Steps: 18 | Train Loss: 2.137 Vali Loss: 5.515 Vali Acc: 0.460 Test Loss: 5.515 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3850746154785156
Epoch: 9, Steps: 18 | Train Loss: 1.619 Vali Loss: 4.124 Vali Acc: 0.580 Test Loss: 4.124 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.349513292312622
Epoch: 10, Steps: 18 | Train Loss: 1.261 Vali Loss: 4.669 Vali Acc: 0.440 Test Loss: 4.669 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5459833145141602
Epoch: 11, Steps: 18 | Train Loss: 1.430 Vali Loss: 4.046 Vali Acc: 0.490 Test Loss: 4.046 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5682017803192139
Epoch: 12, Steps: 18 | Train Loss: 1.801 Vali Loss: 4.364 Vali Acc: 0.550 Test Loss: 4.364 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7011208534240723
Epoch: 13, Steps: 18 | Train Loss: 1.615 Vali Loss: 3.756 Vali Acc: 0.480 Test Loss: 3.756 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5484123229980469
Epoch: 14, Steps: 18 | Train Loss: 1.441 Vali Loss: 7.873 Vali Acc: 0.520 Test Loss: 7.873 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9427996
model size : 35.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs158_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.938678026199341
Epoch: 1, Steps: 18 | Train Loss: 1.262 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.5839409828186035
Epoch: 2, Steps: 18 | Train Loss: 1.442 Vali Loss: 1.145 Vali Acc: 0.490 Test Loss: 1.145 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4040446281433105
Epoch: 3, Steps: 18 | Train Loss: 1.399 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
Validation loss decreased (-0.499991 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 1.6847798824310303
Epoch: 4, Steps: 18 | Train Loss: 1.733 Vali Loss: 2.101 Vali Acc: 0.630 Test Loss: 2.101 Test Acc: 0.630
Validation loss decreased (-0.539991 --> -0.629979).  Saving model ...
Epoch: 5 cost time: 1.4327881336212158
Epoch: 5, Steps: 18 | Train Loss: 1.278 Vali Loss: 1.725 Vali Acc: 0.450 Test Loss: 1.725 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3757879734039307
Epoch: 6, Steps: 18 | Train Loss: 1.374 Vali Loss: 2.630 Vali Acc: 0.500 Test Loss: 2.630 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6140339374542236
Epoch: 7, Steps: 18 | Train Loss: 1.489 Vali Loss: 3.773 Vali Acc: 0.570 Test Loss: 3.773 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6278555393218994
Epoch: 8, Steps: 18 | Train Loss: 2.570 Vali Loss: 3.092 Vali Acc: 0.540 Test Loss: 3.092 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7285490036010742
Epoch: 9, Steps: 18 | Train Loss: 2.486 Vali Loss: 4.134 Vali Acc: 0.540 Test Loss: 4.134 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6051304340362549
Epoch: 10, Steps: 18 | Train Loss: 1.651 Vali Loss: 3.952 Vali Acc: 0.500 Test Loss: 3.952 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3724052906036377
Epoch: 11, Steps: 18 | Train Loss: 1.641 Vali Loss: 3.318 Vali Acc: 0.450 Test Loss: 3.318 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7223012447357178
Epoch: 12, Steps: 18 | Train Loss: 1.548 Vali Loss: 4.964 Vali Acc: 0.530 Test Loss: 4.964 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9472074508666992
Epoch: 13, Steps: 18 | Train Loss: 3.201 Vali Loss: 4.619 Vali Acc: 0.470 Test Loss: 4.619 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5203194618225098
Epoch: 14, Steps: 18 | Train Loss: 2.406 Vali Loss: 11.750 Vali Acc: 0.540 Test Loss: 11.750 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs158_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 9415930
model size : 35.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.133776903152466
Epoch: 1, Steps: 18 | Train Loss: 0.841 Vali Loss: 1.620 Vali Acc: 0.520 Test Loss: 1.620 Test Acc: 0.520
Validation loss decreased (inf --> -0.519984).  Saving model ...
Epoch: 2 cost time: 1.6236836910247803
Epoch: 2, Steps: 18 | Train Loss: 1.409 Vali Loss: 1.163 Vali Acc: 0.510 Test Loss: 1.163 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2388229370117188
Epoch: 3, Steps: 18 | Train Loss: 1.376 Vali Loss: 2.494 Vali Acc: 0.460 Test Loss: 2.494 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2967004776000977
Epoch: 4, Steps: 18 | Train Loss: 1.774 Vali Loss: 1.943 Vali Acc: 0.520 Test Loss: 1.943 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5194313526153564
Epoch: 5, Steps: 18 | Train Loss: 2.548 Vali Loss: 4.214 Vali Acc: 0.520 Test Loss: 4.214 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.471719741821289
Epoch: 6, Steps: 18 | Train Loss: 1.701 Vali Loss: 2.760 Vali Acc: 0.520 Test Loss: 2.760 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.290238857269287
Epoch: 7, Steps: 18 | Train Loss: 1.298 Vali Loss: 4.072 Vali Acc: 0.500 Test Loss: 4.072 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2093305587768555
Epoch: 8, Steps: 18 | Train Loss: 1.855 Vali Loss: 1.753 Vali Acc: 0.510 Test Loss: 1.753 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3552803993225098
Epoch: 9, Steps: 18 | Train Loss: 1.408 Vali Loss: 2.816 Vali Acc: 0.570 Test Loss: 2.816 Test Acc: 0.570
Validation loss decreased (-0.519984 --> -0.569972).  Saving model ...
Epoch: 10 cost time: 1.702012538909912
Epoch: 10, Steps: 18 | Train Loss: 1.312 Vali Loss: 2.079 Vali Acc: 0.550 Test Loss: 2.079 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5781314373016357
Epoch: 11, Steps: 18 | Train Loss: 1.934 Vali Loss: 3.958 Vali Acc: 0.460 Test Loss: 3.958 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4469516277313232
Epoch: 12, Steps: 18 | Train Loss: 1.610 Vali Loss: 7.912 Vali Acc: 0.530 Test Loss: 7.912 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3469688892364502
Epoch: 13, Steps: 18 | Train Loss: 2.276 Vali Loss: 6.609 Vali Acc: 0.520 Test Loss: 6.609 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4605247974395752
Epoch: 14, Steps: 18 | Train Loss: 2.616 Vali Loss: 7.162 Vali Acc: 0.470 Test Loss: 7.162 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6667098999023438
Epoch: 15, Steps: 18 | Train Loss: 1.744 Vali Loss: 6.841 Vali Acc: 0.550 Test Loss: 6.841 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.575021505355835
Epoch: 16, Steps: 18 | Train Loss: 1.810 Vali Loss: 6.416 Vali Acc: 0.500 Test Loss: 6.416 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3185069561004639
Epoch: 17, Steps: 18 | Train Loss: 2.277 Vali Loss: 6.688 Vali Acc: 0.520 Test Loss: 6.688 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3030743598937988
Epoch: 18, Steps: 18 | Train Loss: 2.334 Vali Loss: 6.397 Vali Acc: 0.440 Test Loss: 6.397 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.425809383392334
Epoch: 19, Steps: 18 | Train Loss: 1.625 Vali Loss: 8.524 Vali Acc: 0.460 Test Loss: 8.524 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9409884
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs143_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 2.817666530609131
Epoch: 1, Steps: 18 | Train Loss: 1.144 Vali Loss: 2.290 Vali Acc: 0.490 Test Loss: 2.290 Test Acc: 0.490
Validation loss decreased (inf --> -0.489977).  Saving model ...
Epoch: 2 cost time: 1.5962960720062256
Epoch: 2, Steps: 18 | Train Loss: 1.422 Vali Loss: 1.758 Vali Acc: 0.610 Test Loss: 1.758 Test Acc: 0.610
Validation loss decreased (-0.489977 --> -0.609982).  Saving model ...
Epoch: 3 cost time: 1.6132304668426514
Epoch: 3, Steps: 18 | Train Loss: 1.613 Vali Loss: 2.936 Vali Acc: 0.440 Test Loss: 2.936 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5572938919067383
Epoch: 4, Steps: 18 | Train Loss: 1.795 Vali Loss: 4.430 Vali Acc: 0.430 Test Loss: 4.430 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6902694702148438
Epoch: 5, Steps: 18 | Train Loss: 1.685 Vali Loss: 2.074 Vali Acc: 0.440 Test Loss: 2.074 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3639483451843262
Epoch: 6, Steps: 18 | Train Loss: 0.926 Vali Loss: 2.348 Vali Acc: 0.590 Test Loss: 2.348 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.366668701171875
Epoch: 7, Steps: 18 | Train Loss: 1.118 Vali Loss: 1.759 Vali Acc: 0.470 Test Loss: 1.759 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4542083740234375
Epoch: 8, Steps: 18 | Train Loss: 0.905 Vali Loss: 3.798 Vali Acc: 0.500 Test Loss: 3.798 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4561474323272705
Epoch: 9, Steps: 18 | Train Loss: 1.624 Vali Loss: 5.864 Vali Acc: 0.490 Test Loss: 5.864 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4592680931091309
Epoch: 10, Steps: 18 | Train Loss: 2.017 Vali Loss: 3.013 Vali Acc: 0.550 Test Loss: 3.013 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3754076957702637
Epoch: 11, Steps: 18 | Train Loss: 3.636 Vali Loss: 5.773 Vali Acc: 0.580 Test Loss: 5.773 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5131118297576904
Epoch: 12, Steps: 18 | Train Loss: 1.651 Vali Loss: 5.405 Vali Acc: 0.500 Test Loss: 5.405 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_LightTS_UEA_ftM_sl3000_ll0_pl0_dm32_cs143_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9418858
model size : 35.94MB
